{"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/app.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.9:development":{"value":{"code":"import \"express-async-errors\";\nimport { ExtractJwt, Strategy as JwtStrategy } from \"passport-jwt\";\nimport dotenv from \"dotenv\";\nimport config from \"../src/config\";\nimport express from \"express\";\nimport logger from \"morgan\";\nimport fs from \"fs\";\nimport https from \"https\";\nimport path from \"path\";\nimport GenericErrorHandler from \"./middlewares/GenericErrorHandler\";\nimport ApiError from \"./errors/ApiError\";\nimport helmet from \"helmet\";\nimport cors from \"cors\";\nimport mongoose from \"mongoose\";\nimport passport from \"passport\";\nimport Session from \"./middlewares/Session\";\nimport routes from \"./routes/index\";\nimport DBModels from \"./db/index\";\nimport Users from \"./db/users\";\nconst envPath = config?.production ? \"./env/.prod\" : \"./env/.dev\";\ndotenv.config({\n  path: envPath\n});\nmongoose.connect(process.env.MONGO_URI, {\n  useNewUrlParser: true,\n  useUnifiedTopology: true\n}).then(() => {\n  console.log(\"connected on mongoDB\");\n}).catch(err => {\n  console.log(err);\n});\nconst app = express();\nconst router = express.Router();\napp.use(logger(process.env.LOGGER));\napp.use(helmet());\napp.use(cors({\n  origin: \"*\"\n}));\napp.use(express.json({\n  limit: \"1mb\"\n}));\napp.use(express.urlencoded({\n  extended: true\n}));\npassport.serializeUser((user, done) => {\n  done(null, user);\n});\npassport.deserializeUser((id, done) => {\n  done(null, id);\n});\napp.use(passport.initialize());\nconst jwtOps = {\n  jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),\n  secretOrKey: process.env.JWT_SECRET\n};\npassport.use(new JwtStrategy(jwtOps, async (jwtPayload, done) => {\n  try {\n    const user = await Users.findOne({\n      _id: jwtPayload._id\n    });\n    if (user) {\n      done(null, user.toJSON());\n    } else {\n      done(new ApiError(\"Authorization is not valid\", 401, \"authorizationInvalid\"), false);\n    }\n  } catch (err) {\n    return done(err, false);\n  }\n}));\nroutes.forEach((routeFunc, index) => {\n  routeFunc(router);\n});\napp.use(\"/api\", router);\napp.all(\"/test-auth\", Session, (req, res) => {\n  res.json({\n    test: true\n  });\n});\napp.use(GenericErrorHandler);\nif (process.env.HTTPS_ENABLED === \"true\") {\n  const key = fs.readFileSync(path.join(__dirname, \"./certs/key.pem\")).toString();\n  const cert = fs.readFileSync(path.join(__dirname, \"./certs/cert.pem\")).toString();\n  const server = https.createServer({\n    key: key,\n    cert: cert\n  }, app);\n  server.listen(process.env.PORT, () => {\n    console.log(`Application is running on port =  ${process.env.PORT}`);\n  });\n} else {\n  app.listen(process.env.PORT, () => {\n    console.log(`Application is running on port =  ${process.env.PORT}`);\n  });\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJFeHRyYWN0Snd0IiwiU3RyYXRlZ3kiLCJKd3RTdHJhdGVneSIsImRvdGVudiIsImNvbmZpZyIsImV4cHJlc3MiLCJsb2dnZXIiLCJmcyIsImh0dHBzIiwicGF0aCIsIkdlbmVyaWNFcnJvckhhbmRsZXIiLCJBcGlFcnJvciIsImhlbG1ldCIsImNvcnMiLCJtb25nb29zZSIsInBhc3Nwb3J0IiwiU2Vzc2lvbiIsInJvdXRlcyIsIkRCTW9kZWxzIiwiVXNlcnMiLCJlbnZQYXRoIiwicHJvZHVjdGlvbiIsImNvbm5lY3QiLCJwcm9jZXNzIiwiZW52IiwiTU9OR09fVVJJIiwidXNlTmV3VXJsUGFyc2VyIiwidXNlVW5pZmllZFRvcG9sb2d5IiwidGhlbiIsImNvbnNvbGUiLCJsb2ciLCJjYXRjaCIsImVyciIsImFwcCIsInJvdXRlciIsIlJvdXRlciIsInVzZSIsIkxPR0dFUiIsIm9yaWdpbiIsImpzb24iLCJsaW1pdCIsInVybGVuY29kZWQiLCJleHRlbmRlZCIsInNlcmlhbGl6ZVVzZXIiLCJ1c2VyIiwiZG9uZSIsImRlc2VyaWFsaXplVXNlciIsImlkIiwiaW5pdGlhbGl6ZSIsImp3dE9wcyIsImp3dEZyb21SZXF1ZXN0IiwiZnJvbUF1dGhIZWFkZXJBc0JlYXJlclRva2VuIiwic2VjcmV0T3JLZXkiLCJKV1RfU0VDUkVUIiwiand0UGF5bG9hZCIsImZpbmRPbmUiLCJfaWQiLCJ0b0pTT04iLCJmb3JFYWNoIiwicm91dGVGdW5jIiwiaW5kZXgiLCJhbGwiLCJyZXEiLCJyZXMiLCJ0ZXN0IiwiSFRUUFNfRU5BQkxFRCIsImtleSIsInJlYWRGaWxlU3luYyIsImpvaW4iLCJfX2Rpcm5hbWUiLCJ0b1N0cmluZyIsImNlcnQiLCJzZXJ2ZXIiLCJjcmVhdGVTZXJ2ZXIiLCJsaXN0ZW4iLCJQT1JUIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvIiwic291cmNlcyI6WyJhcHAuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFwiZXhwcmVzcy1hc3luYy1lcnJvcnNcIjtcbmltcG9ydCB7IEV4dHJhY3RKd3QsIFN0cmF0ZWd5IGFzIEp3dFN0cmF0ZWd5IH0gZnJvbSBcInBhc3Nwb3J0LWp3dFwiO1xuaW1wb3J0IGRvdGVudiBmcm9tIFwiZG90ZW52XCI7XG5pbXBvcnQgY29uZmlnIGZyb20gXCIuLi9zcmMvY29uZmlnXCI7XG5pbXBvcnQgZXhwcmVzcyBmcm9tIFwiZXhwcmVzc1wiO1xuaW1wb3J0IGxvZ2dlciBmcm9tIFwibW9yZ2FuXCI7XG5pbXBvcnQgZnMgZnJvbSBcImZzXCI7XG5pbXBvcnQgaHR0cHMgZnJvbSBcImh0dHBzXCI7XG5pbXBvcnQgcGF0aCBmcm9tIFwicGF0aFwiO1xuaW1wb3J0IEdlbmVyaWNFcnJvckhhbmRsZXIgZnJvbSBcIi4vbWlkZGxld2FyZXMvR2VuZXJpY0Vycm9ySGFuZGxlclwiO1xuaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuL2Vycm9ycy9BcGlFcnJvclwiO1xuaW1wb3J0IGhlbG1ldCBmcm9tIFwiaGVsbWV0XCI7XG5pbXBvcnQgY29ycyBmcm9tIFwiY29yc1wiO1xuaW1wb3J0IG1vbmdvb3NlIGZyb20gXCJtb25nb29zZVwiO1xuaW1wb3J0IHBhc3Nwb3J0IGZyb20gXCJwYXNzcG9ydFwiO1xuaW1wb3J0IFNlc3Npb24gZnJvbSBcIi4vbWlkZGxld2FyZXMvU2Vzc2lvblwiO1xuaW1wb3J0IHJvdXRlcyBmcm9tIFwiLi9yb3V0ZXMvaW5kZXhcIjtcbmltcG9ydCBEQk1vZGVscyBmcm9tIFwiLi9kYi9pbmRleFwiO1xuaW1wb3J0IFVzZXJzIGZyb20gXCIuL2RiL3VzZXJzXCI7XG5cbmNvbnN0IGVudlBhdGggPSBjb25maWc/LnByb2R1Y3Rpb24gPyBcIi4vZW52Ly5wcm9kXCIgOiBcIi4vZW52Ly5kZXZcIjtcbmRvdGVudi5jb25maWcoe1xuICBwYXRoOiBlbnZQYXRoLFxufSk7XG5cbm1vbmdvb3NlXG4gIC5jb25uZWN0KHByb2Nlc3MuZW52Lk1PTkdPX1VSSSwge1xuICAgIHVzZU5ld1VybFBhcnNlcjogdHJ1ZSxcbiAgICB1c2VVbmlmaWVkVG9wb2xvZ3k6IHRydWUsXG4gIH0pXG4gIC50aGVuKCgpID0+IHtcbiAgICBjb25zb2xlLmxvZyhcImNvbm5lY3RlZCBvbiBtb25nb0RCXCIpO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4ge1xuICAgIGNvbnNvbGUubG9nKGVycik7XG4gIH0pO1xuXG5jb25zdCBhcHAgPSBleHByZXNzKCk7XG5jb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xuXG5hcHAudXNlKGxvZ2dlcihwcm9jZXNzLmVudi5MT0dHRVIpKTtcbmFwcC51c2UoaGVsbWV0KCkpO1xuYXBwLnVzZShcbiAgY29ycyh7XG4gICAgb3JpZ2luOiBcIipcIixcbiAgfSlcbik7XG5hcHAudXNlKFxuICBleHByZXNzLmpzb24oe1xuICAgIGxpbWl0OiBcIjFtYlwiLFxuICB9KVxuKTtcbmFwcC51c2UoXG4gIGV4cHJlc3MudXJsZW5jb2RlZCh7XG4gICAgZXh0ZW5kZWQ6IHRydWUsXG4gIH0pXG4pO1xuXG5wYXNzcG9ydC5zZXJpYWxpemVVc2VyKCh1c2VyLCBkb25lKSA9PiB7XG4gIGRvbmUobnVsbCwgdXNlcik7XG59KTtcbnBhc3Nwb3J0LmRlc2VyaWFsaXplVXNlcigoaWQsIGRvbmUpID0+IHtcbiAgZG9uZShudWxsLCBpZCk7XG59KTtcblxuYXBwLnVzZShwYXNzcG9ydC5pbml0aWFsaXplKCkpO1xuXG5jb25zdCBqd3RPcHMgPSB7XG4gIGp3dEZyb21SZXF1ZXN0OiBFeHRyYWN0Snd0LmZyb21BdXRoSGVhZGVyQXNCZWFyZXJUb2tlbigpLFxuICBzZWNyZXRPcktleTogcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCxcbn07XG5cbnBhc3Nwb3J0LnVzZShcbiAgbmV3IEp3dFN0cmF0ZWd5KGp3dE9wcywgYXN5bmMgKGp3dFBheWxvYWQsIGRvbmUpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXJzLmZpbmRPbmUoeyBfaWQ6IGp3dFBheWxvYWQuX2lkIH0pO1xuICAgICAgaWYgKHVzZXIpIHtcbiAgICAgICAgZG9uZShudWxsLCB1c2VyLnRvSlNPTigpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRvbmUoXG4gICAgICAgICAgbmV3IEFwaUVycm9yKFxuICAgICAgICAgICAgXCJBdXRob3JpemF0aW9uIGlzIG5vdCB2YWxpZFwiLFxuICAgICAgICAgICAgNDAxLFxuICAgICAgICAgICAgXCJhdXRob3JpemF0aW9uSW52YWxpZFwiXG4gICAgICAgICAgKSxcbiAgICAgICAgICBmYWxzZVxuICAgICAgICApO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgcmV0dXJuIGRvbmUoZXJyLCBmYWxzZSk7XG4gICAgfVxuICB9KVxuKTtcbnJvdXRlcy5mb3JFYWNoKChyb3V0ZUZ1bmMsIGluZGV4KSA9PiB7XG4gIHJvdXRlRnVuYyhyb3V0ZXIpO1xufSk7XG5cbmFwcC51c2UoXCIvYXBpXCIsIHJvdXRlcik7XG5cbmFwcC5hbGwoXCIvdGVzdC1hdXRoXCIsIFNlc3Npb24sIChyZXEsIHJlcykgPT4ge1xuICByZXMuanNvbih7XG4gICAgdGVzdDogdHJ1ZSxcbiAgfSk7XG59KTtcblxuYXBwLnVzZShHZW5lcmljRXJyb3JIYW5kbGVyKTtcblxuaWYgKHByb2Nlc3MuZW52LkhUVFBTX0VOQUJMRUQgPT09IFwidHJ1ZVwiKSB7XG4gIGNvbnN0IGtleSA9IGZzXG4gICAgLnJlYWRGaWxlU3luYyhwYXRoLmpvaW4oX19kaXJuYW1lLCBcIi4vY2VydHMva2V5LnBlbVwiKSlcbiAgICAudG9TdHJpbmcoKTtcbiAgY29uc3QgY2VydCA9IGZzXG4gICAgLnJlYWRGaWxlU3luYyhwYXRoLmpvaW4oX19kaXJuYW1lLCBcIi4vY2VydHMvY2VydC5wZW1cIikpXG4gICAgLnRvU3RyaW5nKCk7XG4gIGNvbnN0IHNlcnZlciA9IGh0dHBzLmNyZWF0ZVNlcnZlcih7IGtleToga2V5LCBjZXJ0OiBjZXJ0IH0sIGFwcCk7XG5cbiAgc2VydmVyLmxpc3Rlbihwcm9jZXNzLmVudi5QT1JULCAoKSA9PiB7XG4gICAgY29uc29sZS5sb2coYEFwcGxpY2F0aW9uIGlzIHJ1bm5pbmcgb24gcG9ydCA9ICAke3Byb2Nlc3MuZW52LlBPUlR9YCk7XG4gIH0pO1xufSBlbHNlIHtcbiAgYXBwLmxpc3Rlbihwcm9jZXNzLmVudi5QT1JULCAoKSA9PiB7XG4gICAgY29uc29sZS5sb2coYEFwcGxpY2F0aW9uIGlzIHJ1bm5pbmcgb24gcG9ydCA9ICAke3Byb2Nlc3MuZW52LlBPUlR9YCk7XG4gIH0pO1xufVxuIl0sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLHNCQUFzQjtBQUM3QixTQUFTQSxVQUFVLEVBQUVDLFFBQVEsSUFBSUMsV0FBVyxRQUFRLGNBQWM7QUFDbEUsT0FBT0MsTUFBTSxNQUFNLFFBQVE7QUFDM0IsT0FBT0MsTUFBTSxNQUFNLGVBQWU7QUFDbEMsT0FBT0MsT0FBTyxNQUFNLFNBQVM7QUFDN0IsT0FBT0MsTUFBTSxNQUFNLFFBQVE7QUFDM0IsT0FBT0MsRUFBRSxNQUFNLElBQUk7QUFDbkIsT0FBT0MsS0FBSyxNQUFNLE9BQU87QUFDekIsT0FBT0MsSUFBSSxNQUFNLE1BQU07QUFDdkIsT0FBT0MsbUJBQW1CLE1BQU0sbUNBQW1DO0FBQ25FLE9BQU9DLFFBQVEsTUFBTSxtQkFBbUI7QUFDeEMsT0FBT0MsTUFBTSxNQUFNLFFBQVE7QUFDM0IsT0FBT0MsSUFBSSxNQUFNLE1BQU07QUFDdkIsT0FBT0MsUUFBUSxNQUFNLFVBQVU7QUFDL0IsT0FBT0MsUUFBUSxNQUFNLFVBQVU7QUFDL0IsT0FBT0MsT0FBTyxNQUFNLHVCQUF1QjtBQUMzQyxPQUFPQyxNQUFNLE1BQU0sZ0JBQWdCO0FBQ25DLE9BQU9DLFFBQVEsTUFBTSxZQUFZO0FBQ2pDLE9BQU9DLEtBQUssTUFBTSxZQUFZO0FBRTlCLE1BQU1DLE9BQU8sR0FBR2hCLE1BQU0sRUFBRWlCLFVBQVUsR0FBRyxhQUFhLEdBQUcsWUFBWTtBQUNqRWxC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","map":{"version":3,"names":["ExtractJwt","Strategy","JwtStrategy","dotenv","config","express","logger","fs","https","path","GenericErrorHandler","ApiError","helmet","cors","mongoose","passport","Session","routes","DBModels","Users","envPath","production","connect","process","env","MONGO_URI","useNewUrlParser","useUnifiedTopology","then","console","log","catch","err","app","router","Router","use","LOGGER","origin","json","limit","urlencoded","extended","serializeUser","user","done","deserializeUser","id","initialize","jwtOps","jwtFromRequest","fromAuthHeaderAsBearerToken","secretOrKey","JWT_SECRET","jwtPayload","findOne","_id","toJSON","forEach","routeFunc","index","all","req","res","test","HTTPS_ENABLED","key","readFileSync","join","__dirname","toString","cert","server","createServer","listen","PORT"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/","sources":["app.js"],"sourcesContent":["import \"express-async-errors\";\nimport { ExtractJwt, Strategy as JwtStrategy } from \"passport-jwt\";\nimport dotenv from \"dotenv\";\nimport config from \"../src/config\";\nimport express from \"express\";\nimport logger from \"morgan\";\nimport fs from \"fs\";\nimport https from \"https\";\nimport path from \"path\";\nimport GenericErrorHandler from \"./middlewares/GenericErrorHandler\";\nimport ApiError from \"./errors/ApiError\";\nimport helmet from \"helmet\";\nimport cors from \"cors\";\nimport mongoose from \"mongoose\";\nimport passport from \"passport\";\nimport Session from \"./middlewares/Session\";\nimport routes from \"./routes/index\";\nimport DBModels from \"./db/index\";\nimport Users from \"./db/users\";\n\nconst envPath = config?.production ? \"./env/.prod\" : \"./env/.dev\";\ndotenv.config({\n  path: envPath,\n});\n\nmongoose\n  .connect(process.env.MONGO_URI, {\n    useNewUrlParser: true,\n    useUnifiedTopology: true,\n  })\n  .then(() => {\n    console.log(\"connected on mongoDB\");\n  })\n  .catch((err) => {\n    console.log(err);\n  });\n\nconst app = express();\nconst router = express.Router();\n\napp.use(logger(process.env.LOGGER));\napp.use(helmet());\napp.use(\n  cors({\n    origin: \"*\",\n  })\n);\napp.use(\n  express.json({\n    limit: \"1mb\",\n  })\n);\napp.use(\n  express.urlencoded({\n    extended: true,\n  })\n);\n\npassport.serializeUser((user, done) => {\n  done(null, user);\n});\npassport.deserializeUser((id, done) => {\n  done(null, id);\n});\n\napp.use(passport.initialize());\n\nconst jwtOps = {\n  jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),\n  secretOrKey: process.env.JWT_SECRET,\n};\n\npassport.use(\n  new JwtStrategy(jwtOps, async (jwtPayload, done) => {\n    try {\n      const user = await Users.findOne({ _id: jwtPayload._id });\n      if (user) {\n        done(null, user.toJSON());\n      } else {\n        done(\n          new ApiError(\n            \"Authorization is not valid\",\n            401,\n            \"authorizationInvalid\"\n          ),\n          false\n        );\n      }\n    } catch (err) {\n      return done(err, false);\n    }\n  })\n);\nroutes.forEach((routeFunc, index) => {\n  routeFunc(router);\n});\n\napp.use(\"/api\", router);\n\napp.all(\"/test-auth\", Session, (req, res) => {\n  res.json({\n    test: true,\n  });\n});\n\napp.use(GenericErrorHandler);\n\nif (process.env.HTTPS_ENABLED === \"true\") {\n  const key = fs\n    .readFileSync(path.join(__dirname, \"./certs/key.pem\"))\n    .toString();\n  const cert = fs\n    .readFileSync(path.join(__dirname, \"./certs/cert.pem\"))\n    .toString();\n  const server = https.createServer({ key: key, cert: cert }, app);\n\n  server.listen(process.env.PORT, () => {\n    console.log(`Application is running on port =  ${process.env.PORT}`);\n  });\n} else {\n  app.listen(process.env.PORT, () => {\n    console.log(`Application is running on port =  ${process.env.PORT}`);\n  });\n}\n"],"mappings":"AAAA,OAAO,sBAAsB;AAC7B,SAASA,UAAU,EAAEC,QAAQ,IAAIC,WAAW,QAAQ,cAAc;AAClE,OAAOC,MAAM,MAAM,QAAQ;AAC3B,OAAOC,MAAM,MAAM,eAAe;AAClC,OAAOC,OAAO,MAAM,SAAS;AAC7B,OAAOC,MAAM,MAAM,QAAQ;AAC3B,OAAOC,EAAE,MAAM,IAAI;AACnB,OAAOC,KAAK,MAAM,OAAO;AACzB,OAAOC,IAAI,MAAM,MAAM;AACvB,OAAOC,mBAAmB,MAAM,mCAAmC;AACnE,OAAOC,QAAQ,MAAM,mBAAmB;AACxC,OAAOC,MAAM,MAAM,QAAQ;AAC3B,OAAOC,IAAI,MAAM,MAAM;AACvB,OAAOC,QAAQ,MAAM,UAAU;AAC/B,OAAOC,QAAQ,MAAM,UAAU;AAC/B,OAAOC,OAAO,MAAM,uBAAuB;AAC3C,OAAOC,MAAM,MAAM,gBAAgB;AACnC,OAAOC,QAAQ,MAAM,YAAY;AACjC,OAAOC,KAAK,MAAM,YAAY;AAE9B,MAAMC,OAAO,GAAGhB,MAAM,EAAEiB,UAAU,GAAG,aAAa,GAAG,YAAY;AACjElB,MAAM,CAACC,MAAM,CAAC;EACZK,IAAI,EAAEW;AACR,CAAC,CAAC;AAEFN,QAAQ,CACLQ,OAAO,CAACC,OAAO,CAACC,GAAG,CAACC,SAAS,EAAE;EAC9BC,eAAe,EAAE,IAAI;EACrBC,kBAAkB,EAAE;AACtB,CAAC,CAAC,CACDC,IAAI,CAAC,MAAM;EACVC,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAC;AACrC,CAAC,CAAC,CACDC,KAAK,CAAEC,GAAG,IAAK;EACdH,OAAO,CAACC,GAAG,CAACE,GAAG,CAAC;AAClB,CAAC,CAAC;AAEJ,MAAMC,GAAG,GAAG5B,OAAO,CAAC,CAAC;AACrB,MAAM6B,MAAM,GAAG7B,OAAO,CAAC8B,MAAM,CAAC,CAAC;AAE/BF,GAAG,CAACG,GAAG,CAAC9B,MAAM,CAACiB,OAAO,CAACC,GAAG,CAACa,MAAM,CAAC,CAAC;AACnCJ,GAAG,CAACG,GAAG,CAACxB,MAAM,CAAC,CAAC,CAAC;AACjBqB,GAAG,CAACG,GAAG,CACLvB,IAAI,CAAC;EACHyB,MAAM,EAAE;AACV,CAAC,CACH,CAAC;AACDL,GAAG,CAACG,GAAG,CACL/B,OAAO,CAACkC,IAAI,CAAC;EACXC,KAAK,EAAE;AACT,CAAC,CACH,CAAC;AACDP,GAAG,CAACG,GAAG,CACL/B,OAAO,CAACoC,UAAU,CAAC;EACjBC,QAAQ,EAAE;AACZ,CAAC,CACH,CAAC;AAED3B,QAAQ,CAAC4B,aAAa,CAAC,CAACC,IAAI,EAAEC,IAAI,KAAK;EACrCA,IAAI,CAAC,IAAI,EAAED,IAAI,CAAC;AAClB,CAAC,CAAC;AACF7B,QAAQ,CAAC+B,eAAe,CAAC,CAACC,EAAE,EAAEF,IAAI,KAAK;EACrCA,IAAI,CAAC,IAAI,EAAEE,EAAE,CAAC;AAChB,CAAC,CAAC;AAEFd,GAAG,CAACG,GAAG,CAACrB,QAAQ,CAACiC,UAAU,CAAC,CAAC,CAAC;AAE9B,MAAMC,MAAM,GAAG;EACbC,cAAc,EAAElD,UAAU,CAACmD,2BAA2B,CAAC,CAAC;EACxDC,WAAW,EAAE7B,OAAO,CAACC,GAAG,CAAC6B;AAC3B,CAAC;AAEDtC,QAAQ,CAACqB,GAAG,CACV,IAAIlC,WAAW,CAAC+C,MAAM,EAAE,OAAOK,UAAU,EAAET,IAAI,KAAK;EAClD,IAAI;IACF,MAAMD,IAAI,GAAG,MAAMzB,KAAK,CAACoC,OAAO,CAAC;MAAEC,GAAG,EAAEF,UAAU,CAACE;IAAI,CAAC,CAAC;IACzD,IAAIZ,IAAI,EAAE;MACRC,IAAI,CAAC,IAAI,EAAED,IAAI,CAACa,MAAM,CAAC,CAAC,CAAC;IAC3B,CAAC,MAAM;MACLZ,IAAI,CACF,IAAIlC,QAAQ,CACV,4BAA4B,EAC5B,GAAG,EACH,sBACF,CAAC,EACD,KACF,CAAC;IACH;EACF,CAAC,CAAC,OAAOqB,GAAG,EAAE;IACZ,OAAOa,IAAI,CAACb,GAAG,EAAE,KAAK,CAAC;EACzB;AACF,CAAC,CACH,CAAC;AACDf,MAAM,CAACyC,OAAO,CAAC,CAACC,SAAS,EAAEC,KAAK,KAAK;EACnCD,SAAS,CAACzB,MAAM,CAAC;AACnB,CAAC,CAAC;AAEFD,GAAG,CAACG,GAAG,CAAC,MAAM,EAAEF,MAAM,CAAC;AAEvBD,GAAG,CAAC4B,GAAG,CAAC,YAAY,EAAE7C,OAAO,EAAE,CAAC8C,GAAG,EAAEC,GAAG,KAAK;EAC3CA,GAAG,CAACxB,IAAI,CAAC;IACPyB,IAAI,EAAE;EACR,CAAC,CAAC;AACJ,CAAC,CAAC;AAEF/B,GAAG,CAACG,GAAG,CAAC1B,mBAAmB,CAAC;AAE5B,IAAIa,OAAO,CAACC,GAAG,CAACyC,aAAa,KAAK,MAAM,EAAE;EACxC,MAAMC,GAAG,GAAG3D,EAAE,CACX4D,YAAY,CAAC1D,IAAI,CAAC2D,IAAI,CAACC,SAAS,EAAE,iBAAiB,CAAC,CAAC,CACrDC,QAAQ,CAAC,CAAC;EACb,MAAMC,IAAI,GAAGhE,EAAE,CACZ4D,YAAY,CAAC1D,IAAI,CAAC2D,IAAI,CAACC,SAAS,EAAE,kBAAkB,CAAC,CAAC,CACtDC,QAAQ,CAAC,CAAC;EACb,MAAME,MAAM,GAAGhE,KAAK,CAACiE,YAAY,CAAC;IAAEP,GAAG,EAAEA,GAAG;IAAEK,IAAI,EAAEA;EAAK,CAAC,EAAEtC,GAAG,CAAC;EAEhEuC,MAAM,CAACE,MAAM,CAACnD,OAAO,CAACC,GAAG,CAACmD,IAAI,EAAE,MAAM;IACpC9C,OAAO,CAACC,GAAG,CAAC,qCAAqCP,OAAO,CAACC,GAAG,CAACmD,IAAI,EAAE,CAAC;EACtE,CAAC,CAAC;AACJ,CAAC,MAAM;EACL1C,GAAG,CAACyC,MAAM,CAACnD,OAAO,CAACC,GAAG,CAACmD,IAAI,EAAE,MAAM;IACjC9C,OAAO,CAACC,GAAG,CAAC,qCAAqCP,OAAO,CAACC,GAAG,CAACmD,IAAI,EAAE,CAAC;EACtE,CAAC,CAAC;AACJ","ignoreList":[]}},"mtime":1721043478445},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/app.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nrequire(\"express-async-errors\");\nvar _passportJwt = require(\"passport-jwt\");\nvar _dotenv = _interopRequireDefault(require(\"dotenv\"));\nvar _config = _interopRequireDefault(require(\"../src/config\"));\nvar _express = _interopRequireDefault(require(\"express\"));\nvar _morgan = _interopRequireDefault(require(\"morgan\"));\nvar _fs = _interopRequireDefault(require(\"fs\"));\nvar _https = _interopRequireDefault(require(\"https\"));\nvar _path = _interopRequireDefault(require(\"path\"));\nvar _GenericErrorHandler = _interopRequireDefault(require(\"./middlewares/GenericErrorHandler\"));\nvar _ApiError = _interopRequireDefault(require(\"./errors/ApiError\"));\nvar _helmet = _interopRequireDefault(require(\"helmet\"));\nvar _cors = _interopRequireDefault(require(\"cors\"));\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _passport = _interopRequireDefault(require(\"passport\"));\nvar _Session = _interopRequireDefault(require(\"./middlewares/Session\"));\nvar _index = _interopRequireDefault(require(\"./routes/index\"));\nvar _index2 = _interopRequireDefault(require(\"./db/index\"));\nvar _users = _interopRequireDefault(require(\"./db/users\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst envPath = _config.default?.production ? \"./env/.prod\" : \"./env/.dev\";\n_dotenv.default.config({\n  path: envPath\n});\n_mongoose.default.connect(process.env.MONGO_URI, {\n  useNewUrlParser: true,\n  useUnifiedTopology: true\n}).then(() => {\n  console.log(\"connected on mongoDB\");\n}).catch(err => {\n  console.log(err);\n});\nconst app = (0, _express.default)();\nconst router = _express.default.Router();\n\n// app.use(express.static(\"images\"));\napp.use(\"/public\", _express.default.static(_path.default.join(__dirname, \"public\")));\napp.use((0, _morgan.default)(process.env.LOGGER));\napp.use((0, _helmet.default)());\napp.use((0, _cors.default)({\n  origin: \"*\"\n}));\napp.use(_express.default.json({\n  limit: \"1mb\"\n}));\napp.use(_express.default.urlencoded({\n  extended: true\n}));\n_passport.default.serializeUser((user, done) => {\n  done(null, user);\n});\n_passport.default.deserializeUser((id, done) => {\n  done(null, id);\n});\napp.use(_passport.default.initialize());\nconst jwtOps = {\n  jwtFromRequest: _passportJwt.ExtractJwt.fromAuthHeaderAsBearerToken(),\n  secretOrKey: process.env.JWT_SECRET\n};\n_passport.default.use(new _passportJwt.Strategy(jwtOps, async (jwtPayload, done) => {\n  try {\n    const user = await _users.default.findOne({\n      _id: jwtPayload._id\n    });\n    if (user) {\n      done(null, user.toJSON());\n    } else {\n      done(new _ApiError.default(\"Authorization is not valid\", 401, \"authorizationInvalid\"), false);\n    }\n  } catch (err) {\n    return done(err, false);\n  }\n}));\n_index.default.forEach((routeFunc, index) => {\n  routeFunc(router);\n});\napp.use(\"/api\", router);\napp.all(\"/test-auth\", _Session.default, (req, res) => {\n  res.json({\n    test: true\n  });\n});\napp.use(_GenericErrorHandler.default);\nif (process.env.HTTPS_ENABLED === \"true\") {\n  const key = _fs.default.readFileSync(_path.default.join(__dirname, \"./certs/key.pem\")).toString();\n  const cert = _fs.default.readFileSync(_path.default.join(__dirname, \"./certs/cert.pem\")).toString();\n  const server = _https.default.createServer({\n    key: key,\n    cert: cert\n  }, app);\n  server.listen(process.env.PORT, () => {\n    console.log(`Application is running on port =  ${process.env.PORT}`);\n  });\n} else {\n  app.listen(process.env.PORT, () => {\n    console.log(`Application is running on port =  ${process.env.PORT}`);\n  });\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJyZXF1aXJlIiwiX3Bhc3Nwb3J0Snd0IiwiX2RvdGVudiIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJfY29uZmlnIiwiX2V4cHJlc3MiLCJfbW9yZ2FuIiwiX2ZzIiwiX2h0dHBzIiwiX3BhdGgiLCJfR2VuZXJpY0Vycm9ySGFuZGxlciIsIl9BcGlFcnJvciIsIl9oZWxtZXQiLCJfY29ycyIsIl9tb25nb29zZSIsIl9wYXNzcG9ydCIsIl9TZXNzaW9uIiwiX2luZGV4IiwiX2luZGV4MiIsIl91c2VycyIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImVudlBhdGgiLCJjb25maWciLCJwcm9kdWN0aW9uIiwiZG90ZW52IiwicGF0aCIsIm1vbmdvb3NlIiwiY29ubmVjdCIsInByb2Nlc3MiLCJlbnYiLCJNT05HT19VUkkiLCJ1c2VOZXdVcmxQYXJzZXIiLCJ1c2VVbmlmaWVkVG9wb2xvZ3kiLCJ0aGVuIiwiY29uc29sZSIsImxvZyIsImNhdGNoIiwiZXJyIiwiYXBwIiwiZXhwcmVzcyIsInJvdXRlciIsIlJvdXRlciIsInVzZSIsInN0YXRpYyIsImpvaW4iLCJfX2Rpcm5hbWUiLCJsb2dnZXIiLCJMT0dHRVIiLCJoZWxtZXQiLCJjb3JzIiwib3JpZ2luIiwianNvbiIsImxpbWl0IiwidXJsZW5jb2RlZCIsImV4dGVuZGVkIiwicGFzc3BvcnQiLCJzZXJpYWxpemVVc2VyIiwidXNlciIsImRvbmUiLCJkZXNlcmlhbGl6ZVVzZXIiLCJpZCIsImluaXRpYWxpemUiLCJqd3RPcHMiLCJqd3RGcm9tUmVxdWVzdCIsIkV4dHJhY3RKd3QiLCJmcm9tQXV0aEhlYWRlckFzQmVhcmVyVG9rZW4iLCJzZWNyZXRPcktleSIsIkpXVF9TRUNSRVQiLCJKd3RTdHJhdGVneSIsImp3dFBheWxvYWQiLCJVc2VycyIsImZpbmRPbmUiLCJfaWQiLCJ0b0pTT04iLCJBcGlFcnJvciIsInJvdXRlcyIsImZvckVhY2giLCJyb3V0ZUZ1bmMiLCJpbmRleCIsImFsbCIsIlNlc3Npb24iLCJyZXEiLCJyZXMiLCJ0ZXN0IiwiR2VuZXJpY0Vycm9ySGFuZGxlciIsIkhUVFBTX0VOQUJMRUQiLCJrZXkiLCJmcyIsInJlYWRGaWxlU3luYyIsInRvU3RyaW5nIiwiY2VydCIsInNlcnZlciIsImh0dHBzIiwiY3JlYXRlU2VydmVyIiwibGlzdGVuIiwiUE9SVCJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjLyIsInNvdXJjZXMiOlsiYXBwLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBcImV4cHJlc3MtYXN5bmMtZXJyb3JzXCI7XG5pbXBvcnQgeyBFeHRyYWN0Snd0LCBTdHJhdGVneSBhcyBKd3RTdHJhdGVneSB9IGZyb20gXCJwYXNzcG9ydC1qd3RcIjtcbmltcG9ydCBkb3RlbnYgZnJvbSBcImRvdGVudlwiO1xuaW1wb3J0IGNvbmZpZyBmcm9tIFwiLi4vc3JjL2NvbmZpZ1wiO1xuaW1wb3J0IGV4cHJlc3MgZnJvbSBcImV4cHJlc3NcIjtcbmltcG9ydCBsb2dnZXIgZnJvbSBcIm1vcmdhblwiO1xuaW1wb3J0IGZzIGZyb20gXCJmc1wiO1xuaW1wb3J0IGh0dHBzIGZyb20gXCJodHRwc1wiO1xuaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcbmltcG9ydCBHZW5lcmljRXJyb3JIYW5kbGVyIGZyb20gXCIuL21pZGRsZXdhcmVzL0dlbmVyaWNFcnJvckhhbmRsZXJcIjtcbmltcG9ydCBBcGlFcnJvciBmcm9tIFwiLi9lcnJvcnMvQXBpRXJyb3JcIjtcbmltcG9ydCBoZWxtZXQgZnJvbSBcImhlbG1ldFwiO1xuaW1wb3J0IGNvcnMgZnJvbSBcImNvcnNcIjtcbmltcG9ydCBtb25nb29zZSBmcm9tIFwibW9uZ29vc2VcIjtcbmltcG9ydCBwYXNzcG9ydCBmcm9tIFwicGFzc3BvcnRcIjtcbmltcG9ydCBTZXNzaW9uIGZyb20gXCIuL21pZGRsZXdhcmVzL1Nlc3Npb25cIjtcbmltcG9ydCByb3V0ZXMgZnJvbSBcIi4vcm91dGVzL2luZGV4XCI7XG5pbXBvcnQgREJNb2RlbHMgZnJvbSBcIi4vZGIvaW5kZXhcIjtcbmltcG9ydCBVc2VycyBmcm9tIFwiLi9kYi91c2Vyc1wiO1xuXG5jb25zdCBlbnZQYXRoID0gY29uZmlnPy5wcm9kdWN0aW9uID8gXCIuL2Vudi8ucHJvZFwiIDogXCIuL2Vudi8uZGV2XCI7XG5kb3RlbnYuY29uZmlnKHtcbiAgcGF0aDogZW52UGF0aCxcbn0pO1xuXG5tb25nb29zZVxuICAuY29ubmVjdChwcm9jZXNzLmVudi5NT05HT19VUkksIHtcbiAgICB1c2VOZXdVcmxQYXJzZXI6IHRydWUsXG4gICAgdXNlVW5pZmllZFRvcG9sb2d5OiB0cnVlLFxuICB9KVxuICAudGhlbigoKSA9PiB7XG4gICAgY29uc29sZS5sb2coXCJjb25uZWN0ZWQgb24gbW9uZ29EQlwiKTtcbiAgfSlcbiAgLmNhdGNoKChlcnIpID0+IHtcbiAgICBjb25zb2xlLmxvZyhlcnIpO1xuICB9KTtcblxuY29uc3QgYXBwID0gZXhwcmVzcygpO1xuY29uc3Qgcm91dGVyID0gZXhwcmVzcy5Sb3V0ZXIoKTtcblxuLy8gYXBwLnVzZShleHByZXNzLnN0YXRpYyhcImltYWdlc1wiKSk7XG5hcHAudXNlKFwiL3B1YmxpY1wiLCBleHByZXNzLnN0YXRpYyhwYXRoLmpvaW4oX19kaXJuYW1lLCBcInB1YmxpY1wiKSkpO1xuYXBwLnVzZShsb2dnZXIocHJvY2Vzcy5lbnYuTE9HR0VSKSk7XG5hcHAudXNlKGhlbG1ldCgpKTtcbmFwcC51c2UoXG4gIGNvcnMoe1xuICAgIG9yaWdpbjogXCIqXCIsXG4gIH0pXG4pO1xuYXBwLnVzZShcbiAgZXhwcmVzcy5qc29uKHtcbiAgICBsaW1pdDogXCIxbWJcIixcbiAgfSlcbik7XG5hcHAudXNlKFxuICBleHByZXNzLnVybGVuY29kZWQoe1xuICAgIGV4dGVuZGVkOiB0cnVlLFxuICB9KVxuKTtcblxucGFzc3BvcnQuc2VyaWFsaXplVXNlcigodXNlciwgZG9uZSkgPT4ge1xuICBkb25lKG51bGwsIHVzZXIpO1xufSk7XG5wYXNzcG9ydC5kZXNlcmlhbGl6ZVVzZXIoKGlkLCBkb25lKSA9PiB7XG4gIGRvbmUobnVsbCwgaWQpO1xufSk7XG5cbmFwcC51c2UocGFzc3BvcnQuaW5pdGlhbGl6ZSgpKTtcblxuY29uc3Qgand0T3BzID0ge1xuICBqd3RGcm9tUmVxdWVzdDogRXh0cmFjdEp3dC5mcm9tQXV0aEhlYWRlckFzQmVhcmVyVG9rZW4oKSxcbiAgc2VjcmV0T3JLZXk6IHByb2Nlc3MuZW52LkpXVF9TRUNSRVQsXG59O1xuXG5wYXNzcG9ydC51c2UoXG4gIG5ldyBKd3RTdHJhdGVneShqd3RPcHMsIGFzeW5jIChqd3RQYXlsb2FkLCBkb25lKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2Vycy5maW5kT25lKHsgX2lkOiBqd3RQYXlsb2FkLl9pZCB9KTtcbiAgICAgIGlmICh1c2VyKSB7XG4gICAgICAgIGRvbmUobnVsbCwgdXNlci50b0pTT04oKSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBkb25lKFxuICAgICAgICAgIG5ldyBBcGlFcnJvcihcbiAgICAgICAgICAgIFwiQXV0aG9yaXphdGlvbiBpcyBub3QgdmFsaWRcIixcbiAgICAgICAgICAgIDQwMSxcbiAgICAgICAgICAgIFwiYXV0aG9yaXphdGlvbkludmFsaWRcIlxuICAgICAgICAgICksXG4gICAgICAgICAgZmFsc2VcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIHJldHVybiBkb25lKGVyciwgZmFsc2UpO1xuICAgIH1cbiAgfSlcbik7XG5yb3V0ZXMuZm9yRWFjaCgocm91dGVGdW5jLCBpbmRleCkgPT4ge1xuICByb3V0ZUZ1bmMocm91dGVyKTtcbn0pO1xuXG5hcHAudXNlKFwiL2FwaVwiLCByb3V0ZXIpO1xuXG5hcHAuYWxsKFwiL3Rlc3QtYXV0aFwiLCBTZXNzaW9uLCAocmVxLCByZXMpID0+IHtcbiAgcmVzLmpzb24oe1xuICAgIHRlc3Q6IHRydWUsXG4gIH0pO1xufSk7XG5cbmFwcC51c2UoR2VuZXJpY0Vycm9ySGFuZGxlcik7XG5cbmlmIChwcm9jZXNzLmVudi5IVFRQU19FTkFCTEVEID09PSBcInRydWVcIikge1xuICBjb25zdCBrZXkgPSBmc1xuICAgIC5yZWFkRmlsZVN5bmMocGF0aC5qb2luKF9fZGlybmFtZSwgXCIuL2NlcnRzL2tleS5wZW1cIikpXG4gICAgLnRvU3RyaW5nKCk7XG4gIGNvbnN0IGNlcnQgPSBmc1xuICAgIC5yZWFkRmlsZVN5bmMocGF0aC5qb2luKF9fZGlybmFtZSwgXCIuL2NlcnRzL2NlcnQucGVtXCIpKVxuICAgIC50b1N0cmluZygpO1xuICBjb25zdCBzZXJ2ZXIgPSBodHRwcy5jcmVhdGVTZXJ2ZXIoeyBrZXk6IGtleSwgY2VydDogY2VydCB9LCBhcHApO1xuXG4gIHNlcnZlci5saXN0ZW4ocHJvY2Vzcy5lbnYuUE9SVCwgKCkgPT4ge1xuICAgIGNvbnNvbGUubG9nKGBBcHBsaWNhdGlvbiBpcyBydW5uaW5nIG9uIHBvcnQgPSAgJHtwcm9jZXNzLmVudi5QT1JUfWApO1xuICB9KTtcbn0gZWxzZSB7XG4gIGFwcC5saXN0ZW4ocHJvY2Vzcy5lbnYuUE9SVCwgKCkgPT4ge1xuICAgIGNvbnNvbGUubG9nKGBBcHBsaWNhdGlvbiBpcyBydW5uaW5nIG9uIHBvcnQgPSAgJHtwcm9jZXNzLmVudi5QT1JUfWApO1xuICB9KTtcbn1cbiJdLCJtYXBwaW5ncyI6Ijs7QUFBQUEsT0FBQTtBQUNBLElBQUFDLFlBQUEsR0FBQUQsT0FBQTtBQUNBLElBQUFFLE9BQUEsR0FBQUMsc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFJLE9BQUEsR0FBQUQsc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFLLFFBQUEsR0FBQUYsc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFNLE9BQUEsR0FBQUgsc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFPLEdBQUEsR0FBQUosc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFR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","map":{"version":3,"names":["require","_passportJwt","_dotenv","_interopRequireDefault","_config","_express","_morgan","_fs","_https","_path","_GenericErrorHandler","_ApiError","_helmet","_cors","_mongoose","_passport","_Session","_index","_index2","_users","e","__esModule","default","envPath","config","production","dotenv","path","mongoose","connect","process","env","MONGO_URI","useNewUrlParser","useUnifiedTopology","then","console","log","catch","err","app","express","router","Router","use","static","join","__dirname","logger","LOGGER","helmet","cors","origin","json","limit","urlencoded","extended","passport","serializeUser","user","done","deserializeUser","id","initialize","jwtOps","jwtFromRequest","ExtractJwt","fromAuthHeaderAsBearerToken","secretOrKey","JWT_SECRET","JwtStrategy","jwtPayload","Users","findOne","_id","toJSON","ApiError","routes","forEach","routeFunc","index","all","Session","req","res","test","GenericErrorHandler","HTTPS_ENABLED","key","fs","readFileSync","toString","cert","server","https","createServer","listen","PORT"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/","sources":["app.js"],"sourcesContent":["import \"express-async-errors\";\nimport { ExtractJwt, Strategy as JwtStrategy } from \"passport-jwt\";\nimport dotenv from \"dotenv\";\nimport config from \"../src/config\";\nimport express from \"express\";\nimport logger from \"morgan\";\nimport fs from \"fs\";\nimport https from \"https\";\nimport path from \"path\";\nimport GenericErrorHandler from \"./middlewares/GenericErrorHandler\";\nimport ApiError from \"./errors/ApiError\";\nimport helmet from \"helmet\";\nimport cors from \"cors\";\nimport mongoose from \"mongoose\";\nimport passport from \"passport\";\nimport Session from \"./middlewares/Session\";\nimport routes from \"./routes/index\";\nimport DBModels from \"./db/index\";\nimport Users from \"./db/users\";\n\nconst envPath = config?.production ? \"./env/.prod\" : \"./env/.dev\";\ndotenv.config({\n  path: envPath,\n});\n\nmongoose\n  .connect(process.env.MONGO_URI, {\n    useNewUrlParser: true,\n    useUnifiedTopology: true,\n  })\n  .then(() => {\n    console.log(\"connected on mongoDB\");\n  })\n  .catch((err) => {\n    console.log(err);\n  });\n\nconst app = express();\nconst router = express.Router();\n\n// app.use(express.static(\"images\"));\napp.use(\"/public\", express.static(path.join(__dirname, \"public\")));\napp.use(logger(process.env.LOGGER));\napp.use(helmet());\napp.use(\n  cors({\n    origin: \"*\",\n  })\n);\napp.use(\n  express.json({\n    limit: \"1mb\",\n  })\n);\napp.use(\n  express.urlencoded({\n    extended: true,\n  })\n);\n\npassport.serializeUser((user, done) => {\n  done(null, user);\n});\npassport.deserializeUser((id, done) => {\n  done(null, id);\n});\n\napp.use(passport.initialize());\n\nconst jwtOps = {\n  jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),\n  secretOrKey: process.env.JWT_SECRET,\n};\n\npassport.use(\n  new JwtStrategy(jwtOps, async (jwtPayload, done) => {\n    try {\n      const user = await Users.findOne({ _id: jwtPayload._id });\n      if (user) {\n        done(null, user.toJSON());\n      } else {\n        done(\n          new ApiError(\n            \"Authorization is not valid\",\n            401,\n            \"authorizationInvalid\"\n          ),\n          false\n        );\n      }\n    } catch (err) {\n      return done(err, false);\n    }\n  })\n);\nroutes.forEach((routeFunc, index) => {\n  routeFunc(router);\n});\n\napp.use(\"/api\", router);\n\napp.all(\"/test-auth\", Session, (req, res) => {\n  res.json({\n    test: true,\n  });\n});\n\napp.use(GenericErrorHandler);\n\nif (process.env.HTTPS_ENABLED === \"true\") {\n  const key = fs\n    .readFileSync(path.join(__dirname, \"./certs/key.pem\"))\n    .toString();\n  const cert = fs\n    .readFileSync(path.join(__dirname, \"./certs/cert.pem\"))\n    .toString();\n  const server = https.createServer({ key: key, cert: cert }, app);\n\n  server.listen(process.env.PORT, () => {\n    console.log(`Application is running on port =  ${process.env.PORT}`);\n  });\n} else {\n  app.listen(process.env.PORT, () => {\n    console.log(`Application is running on port =  ${process.env.PORT}`);\n  });\n}\n"],"mappings":";;AAAAA,OAAA;AACA,IAAAC,YAAA,GAAAD,OAAA;AACA,IAAAE,OAAA,GAAAC,sBAAA,CAAAH,OAAA;AACA,IAAAI,OAAA,GAAAD,sBAAA,CAAAH,OAAA;AACA,IAAAK,QAAA,GAAAF,sBAAA,CAAAH,OAAA;AACA,IAAAM,OAAA,GAAAH,sBAAA,CAAAH,OAAA;AACA,IAAAO,GAAA,GAAAJ,sBAAA,CAAAH,OAAA;AACA,IAAAQ,MAAA,GAAAL,sBAAA,CAAAH,OAAA;AACA,IAAAS,KAAA,GAAAN,sBAAA,CAAAH,OAAA;AACA,IAAAU,oBAAA,GAAAP,sBAAA,CAAAH,OAAA;AACA,IAAAW,SAAA,GAAAR,sBAAA,CAAAH,OAAA;AACA,IAAAY,OAAA,GAAAT,sBAAA,CAAAH,OAAA;AACA,IAAAa,KAAA,GAAAV,sBAAA,CAAAH,OAAA;AACA,IAAAc,SAAA,GAAAX,sBAAA,CAAAH,OAAA;AACA,IAAAe,SAAA,GAAAZ,sBAAA,CAAAH,OAAA;AACA,IAAAgB,QAAA,GAAAb,sBAAA,CAAAH,OAAA;AACA,IAAAiB,MAAA,GAAAd,sBAAA,CAAAH,OAAA;AACA,IAAAkB,OAAA,GAAAf,sBAAA,CAAAH,OAAA;AACA,IAAAmB,MAAA,GAAAhB,sBAAA,CAAAH,OAAA;AAA+B,SAAAG,uBAAAiB,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE/B,MAAMG,OAAO,GAAGC,eAAM,EAAEC,UAAU,GAAG,aAAa,GAAG,YAAY;AACjEC,eAAM,CAACF,MAAM,CAAC;EACZG,IAAI,EAAEJ;AACR,CAAC,CAAC;AAEFK,iBAAQ,CACLC,OAAO,CAACC,OAAO,CAACC,GAAG,CAACC,SAAS,EAAE;EAC9BC,eAAe,EAAE,IAAI;EACrBC,kBAAkB,EAAE;AACtB,CAAC,CAAC,CACDC,IAAI,CAAC,MAAM;EACVC,OAAO,CAACC,GAAG,CAAC,sBAAsB,CAAC;AACrC,CAAC,CAAC,CACDC,KAAK,CAAEC,GAAG,IAAK;EACdH,OAAO,CAACC,GAAG,CAACE,GAAG,CAAC;AAClB,CAAC,CAAC;AAEJ,MAAMC,GAAG,GAAG,IAAAC,gBAAO,EAAC,CAAC;AACrB,MAAMC,MAAM,GAAGD,gBAAO,CAACE,MAAM,CAAC,CAAC;;AAE/B;AACAH,GAAG,CAACI,GAAG,CAAC,SAAS,EAAEH,gBAAO,CAACI,MAAM,CAAClB,aAAI,CAACmB,IAAI,CAACC,SAAS,EAAE,QAAQ,CAAC,CAAC,CAAC;AAClEP,GAAG,CAACI,GAAG,CAAC,IAAAI,eAAM,EAAClB,OAAO,CAACC,GAAG,CAACkB,MAAM,CAAC,CAAC;AACnCT,GAAG,CAACI,GAAG,CAAC,IAAAM,eAAM,EAAC,CAAC,CAAC;AACjBV,GAAG,CAACI,GAAG,CACL,IAAAO,aAAI,EAAC;EACHC,MAAM,EAAE;AACV,CAAC,CACH,CAAC;AACDZ,GAAG,CAACI,GAAG,CACLH,gBAAO,CAACY,IAAI,CAAC;EACXC,KAAK,EAAE;AACT,CAAC,CACH,CAAC;AACDd,GAAG,CAACI,GAAG,CACLH,gBAAO,CAACc,UAAU,CAAC;EACjBC,QAAQ,EAAE;AACZ,CAAC,CACH,CAAC;AAEDC,iBAAQ,CAACC,aAAa,CAAC,CAACC,IAAI,EAAEC,IAAI,KAAK;EACrCA,IAAI,CAAC,IAAI,EAAED,IAAI,CAAC;AAClB,CAAC,CAAC;AACFF,iBAAQ,CAACI,eAAe,CAAC,CAACC,EAAE,EAAEF,IAAI,KAAK;EACrCA,IAAI,CAAC,IAAI,EAAEE,EAAE,CAAC;AAChB,CAAC,CAAC;AAEFtB,GAAG,CAACI,GAAG,CAACa,iBAAQ,CAACM,UAAU,CAAC,CAAC,CAAC;AAE9B,MAAMC,MAAM,GAAG;EACbC,cAAc,EAAEC,uBAAU,CAACC,2BAA2B,CAAC,CAAC;EACxDC,WAAW,EAAEtC,OAAO,CAACC,GAAG,CAACsC;AAC3B,CAAC;AAEDZ,iBAAQ,CAACb,GAAG,CACV,IAAI0B,qBAAW,CAACN,MAAM,EAAE,OAAOO,UAAU,EAAEX,IAAI,KAAK;EAClD,IAAI;IACF,MAAMD,IAAI,GAAG,MAAMa,cAAK,CAACC,OAAO,CAAC;MAAEC,GAAG,EAAEH,UAAU,CAACG;IAAI,CAAC,CAAC;IACzD,IAAIf,IAAI,EAAE;MACRC,IAAI,CAAC,IAAI,EAAED,IAAI,CAACgB,MAAM,CAAC,CAAC,CAAC;IAC3B,CAAC,MAAM;MACLf,IAAI,CACF,IAAIgB,iBAAQ,CACV,4BAA4B,EAC5B,GAAG,EACH,sBACF,CAAC,EACD,KACF,CAAC;IACH;EACF,CAAC,CAAC,OAAOrC,GAAG,EAAE;IACZ,OAAOqB,IAAI,CAACrB,GAAG,EAAE,KAAK,CAAC;EACzB;AACF,CAAC,CACH,CAAC;AACDsC,cAAM,CAACC,OAAO,CAAC,CAACC,SAAS,EAAEC,KAAK,KAAK;EACnCD,SAAS,CAACrC,MAAM,CAAC;AACnB,CAAC,CAAC;AAEFF,GAAG,CAACI,GAAG,CAAC,MAAM,EAAEF,MAAM,CAAC;AAEvBF,GAAG,CAACyC,GAAG,CAAC,YAAY,EAAEC,gBAAO,EAAE,CAACC,GAAG,EAAEC,GAAG,KAAK;EAC3CA,GAAG,CAAC/B,IAAI,CAAC;IACPgC,IAAI,EAAE;EACR,CAAC,CAAC;AACJ,CAAC,CAAC;AAEF7C,GAAG,CAACI,GAAG,CAAC0C,4BAAmB,CAAC;AAE5B,IAAIxD,OAAO,CAACC,GAAG,CAACwD,aAAa,KAAK,MAAM,EAAE;EACxC,MAAMC,GAAG,GAAGC,WAAE,CACXC,YAAY,CAAC/D,aAAI,CAACmB,IAAI,CAACC,SAAS,EAAE,iBAAiB,CAAC,CAAC,CACrD4C,QAAQ,CAAC,CAAC;EACb,MAAMC,IAAI,GAAGH,WAAE,CACZC,YAAY,CAAC/D,aAAI,CAACmB,IAAI,CAACC,SAAS,EAAE,kBAAkB,CAAC,CAAC,CACtD4C,QAAQ,CAAC,CAAC;EACb,MAAME,MAAM,GAAGC,cAAK,CAACC,YAAY,CAAC;IAAEP,GAAG,EAAEA,GAAG;IAAEI,IAAI,EAAEA;EAAK,CAAC,EAAEpD,GAAG,CAAC;EAEhEqD,MAAM,CAACG,MAAM,CAAClE,OAAO,CAACC,GAAG,CAACkE,IAAI,EAAE,MAAM;IACpC7D,OAAO,CAACC,GAAG,CAAC,qCAAqCP,OAAO,CAACC,GAAG,CAACkE,IAAI,EAAE,CAAC;EACtE,CAAC,CAAC;AACJ,CAAC,MAAM;EACLzD,GAAG,CAACwD,MAAM,CAAClE,OAAO,CAACC,GAAG,CAACkE,IAAI,EAAE,MAAM;IACjC7D,OAAO,CAACC,GAAG,CAAC,qCAAqCP,OAAO,CAACC,GAAG,CAACkE,IAAI,EAAE,CAAC;EACtE,CAAC,CAAC;AACJ","ignoreList":[]}},"mtime":1723461845411},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/config.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nconst production = process.argv.slice(2).includes(\"dev\") ? false : true;\nconst config = {\n  development: !production,\n  production: production,\n  deployment: production ? \"PRODUCTION\" : \"DEVELOPMENT\"\n};\nvar _default = exports.default = config;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJwcm9kdWN0aW9uIiwicHJvY2VzcyIsImFyZ3YiLCJzbGljZSIsImluY2x1ZGVzIiwiY29uZmlnIiwiZGV2ZWxvcG1lbnQiLCJkZXBsb3ltZW50IiwiX2RlZmF1bHQiLCJleHBvcnRzIiwiZGVmYXVsdCJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjLyIsInNvdXJjZXMiOlsiY29uZmlnLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHByb2R1Y3Rpb24gPSBwcm9jZXNzLmFyZ3Yuc2xpY2UoMikuaW5jbHVkZXMoXCJkZXZcIikgPyBmYWxzZSA6IHRydWU7XG5cbmNvbnN0IGNvbmZpZyA9IHtcbiAgZGV2ZWxvcG1lbnQ6ICFwcm9kdWN0aW9uLFxuICBwcm9kdWN0aW9uOiBwcm9kdWN0aW9uLFxuICBkZXBsb3ltZW50OiBwcm9kdWN0aW9uID8gXCJQUk9EVUNUSU9OXCIgOiBcIkRFVkVMT1BNRU5UXCIsXG59O1xuZXhwb3J0IGRlZmF1bHQgY29uZmlnO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxNQUFNQSxVQUFVLEdBQUdDLE9BQU8sQ0FBQ0MsSUFBSSxDQUFDQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUNDLFFBQVEsQ0FBQyxLQUFLLENBQUMsR0FBRyxLQUFLLEdBQUcsSUFBSTtBQUV2RSxNQUFNQyxNQUFNLEdBQUc7RUFDYkMsV0FBVyxFQUFFLENBQUNOLFVBQVU7RUFDeEJBLFVBQVUsRUFBRUEsVUFBVTtFQUN0Qk8sVUFBVSxFQUFFUCxVQUFVLEdBQUcsWUFBWSxHQUFHO0FBQzFDLENBQUM7QUFBQyxJQUFBUSxRQUFBLEdBQUFDLE9BQUEsQ0FBQUMsT0FBQSxHQUNhTCxNQUFNIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["production","process","argv","slice","includes","config","development","deployment","_default","exports","default"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/","sources":["config.js"],"sourcesContent":["const production = process.argv.slice(2).includes(\"dev\") ? false : true;\n\nconst config = {\n  development: !production,\n  production: production,\n  deployment: production ? \"PRODUCTION\" : \"DEVELOPMENT\",\n};\nexport default config;\n"],"mappings":";;;;;;AAAA,MAAMA,UAAU,GAAGC,OAAO,CAACC,IAAI,CAACC,KAAK,CAAC,CAAC,CAAC,CAACC,QAAQ,CAAC,KAAK,CAAC,GAAG,KAAK,GAAG,IAAI;AAEvE,MAAMC,MAAM,GAAG;EACbC,WAAW,EAAE,CAACN,UAAU;EACxBA,UAAU,EAAEA,UAAU;EACtBO,UAAU,EAAEP,UAAU,GAAG,YAAY,GAAG;AAC1C,CAAC;AAAC,IAAAQ,QAAA,GAAAC,OAAA,CAAAC,OAAA,GACaL,MAAM","ignoreList":[]}},"mtime":1721043478449},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/GenericErrorHandler.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst GenericErrorHandler = (err, req, res, next) => {\n  if (!(err instanceof _ApiError.default)) {\n    console.error(err);\n  }\n  if (/\\w+ validation failed: \\w+/i.test(err.message)) {\n    err.message = err.message.replace(/\\w+ validation failed: \\w+/i, \"\");\n  }\n  res.status(err.status || 500).json({\n    status: err?.status,\n    error: err?.message,\n    code: err.code\n  });\n};\nvar _default = exports.default = GenericErrorHandler;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQXBpRXJyb3IiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIkdlbmVyaWNFcnJvckhhbmRsZXIiLCJlcnIiLCJyZXEiLCJyZXMiLCJuZXh0IiwiQXBpRXJyb3IiLCJjb25zb2xlIiwiZXJyb3IiLCJ0ZXN0IiwibWVzc2FnZSIsInJlcGxhY2UiLCJzdGF0dXMiLCJqc29uIiwiY29kZSIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL21pZGRsZXdhcmVzLyIsInNvdXJjZXMiOlsiR2VuZXJpY0Vycm9ySGFuZGxlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQXBpRXJyb3IgZnJvbSBcIi4uL2Vycm9ycy9BcGlFcnJvclwiO1xuXG5jb25zdCBHZW5lcmljRXJyb3JIYW5kbGVyID0gKGVyciwgcmVxLCByZXMsIG5leHQpID0+IHtcbiAgaWYgKCEoZXJyIGluc3RhbmNlb2YgQXBpRXJyb3IpKSB7XG4gICAgY29uc29sZS5lcnJvcihlcnIpO1xuICB9XG4gIGlmICgvXFx3KyB2YWxpZGF0aW9uIGZhaWxlZDogXFx3Ky9pLnRlc3QoZXJyLm1lc3NhZ2UpKSB7XG4gICAgZXJyLm1lc3NhZ2UgPSBlcnIubWVzc2FnZS5yZXBsYWNlKC9cXHcrIHZhbGlkYXRpb24gZmFpbGVkOiBcXHcrL2ksIFwiXCIpO1xuICB9XG4gIHJlcy5zdGF0dXMoZXJyLnN0YXR1cyB8fCA1MDApLmpzb24oe1xuICAgIHN0YXR1czogZXJyPy5zdGF0dXMsXG4gICAgZXJyb3I6IGVycj8ubWVzc2FnZSxcbiAgICBjb2RlOiBlcnIuY29kZSxcbiAgfSk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBHZW5lcmljRXJyb3JIYW5kbGVyO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxTQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFBMEMsU0FBQUQsdUJBQUFFLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFMUMsTUFBTUcsbUJBQW1CLEdBQUdBLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksS0FBSztFQUNuRCxJQUFJLEVBQUVILEdBQUcsWUFBWUksaUJBQVEsQ0FBQyxFQUFFO0lBQzlCQyxPQUFPLENBQUNDLEtBQUssQ0FBQ04sR0FBRyxDQUFDO0VBQ3BCO0VBQ0EsSUFBSSw2QkFBNkIsQ0FBQ08sSUFBSSxDQUFDUCxHQUFHLENBQUNRLE9BQU8sQ0FBQyxFQUFFO0lBQ25EUixHQUFHLENBQUNRLE9BQU8sR0FBR1IsR0FBRyxDQUFDUSxPQUFPLENBQUNDLE9BQU8sQ0FBQyw2QkFBNkIsRUFBRSxFQUFFLENBQUM7RUFDdEU7RUFDQVAsR0FBRyxDQUFDUSxNQUFNLENBQUNWLEdBQUcsQ0FBQ1UsTUFBTSxJQUFJLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7SUFDakNELE1BQU0sRUFBRVYsR0FBRyxFQUFFVSxNQUFNO0lBQ25CSixLQUFLLEVBQUVOLEdBQUcsRUFBRVEsT0FBTztJQUNuQkksSUFBSSxFQUFFWixHQUFHLENBQUNZO0VBQ1osQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUFDLElBQUFDLFFBQUEsR0FBQUMsT0FBQSxDQUFBaEIsT0FBQSxHQUVhQyxtQkFBbUIiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_ApiError","_interopRequireDefault","require","e","__esModule","default","GenericErrorHandler","err","req","res","next","ApiError","console","error","test","message","replace","status","json","code","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["GenericErrorHandler.js"],"sourcesContent":["import ApiError from \"../errors/ApiError\";\n\nconst GenericErrorHandler = (err, req, res, next) => {\n  if (!(err instanceof ApiError)) {\n    console.error(err);\n  }\n  if (/\\w+ validation failed: \\w+/i.test(err.message)) {\n    err.message = err.message.replace(/\\w+ validation failed: \\w+/i, \"\");\n  }\n  res.status(err.status || 500).json({\n    status: err?.status,\n    error: err?.message,\n    code: err.code,\n  });\n};\n\nexport default GenericErrorHandler;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA0C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE1C,MAAMG,mBAAmB,GAAGA,CAACC,GAAG,EAAEC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EACnD,IAAI,EAAEH,GAAG,YAAYI,iBAAQ,CAAC,EAAE;IAC9BC,OAAO,CAACC,KAAK,CAACN,GAAG,CAAC;EACpB;EACA,IAAI,6BAA6B,CAACO,IAAI,CAACP,GAAG,CAACQ,OAAO,CAAC,EAAE;IACnDR,GAAG,CAACQ,OAAO,GAAGR,GAAG,CAACQ,OAAO,CAACC,OAAO,CAAC,6BAA6B,EAAE,EAAE,CAAC;EACtE;EACAP,GAAG,CAACQ,MAAM,CAACV,GAAG,CAACU,MAAM,IAAI,GAAG,CAAC,CAACC,IAAI,CAAC;IACjCD,MAAM,EAAEV,GAAG,EAAEU,MAAM;IACnBJ,KAAK,EAAEN,GAAG,EAAEQ,OAAO;IACnBI,IAAI,EAAEZ,GAAG,CAACY;EACZ,CAAC,CAAC;AACJ,CAAC;AAAC,IAAAC,QAAA,GAAAC,OAAA,CAAAhB,OAAA,GAEaC,mBAAmB","ignoreList":[]}},"mtime":1721043695378},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/GenericErrorHandler.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst GenericErrorHandler = (err, req, res, next) => {\n  if (!(err instanceof _ApiError.default)) {\n    console.error(err);\n  }\n  if (/\\w+ validation failed: \\w+/i.test(err.message)) {\n    err.message = err.message.replace(/\\w+ validation failed: \\w+/i, \"\");\n  }\n  res.status(err.status || 500).json({\n    status: err?.status,\n    error: err?.message,\n    code: err.code\n  });\n};\nvar _default = exports.default = GenericErrorHandler;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQXBpRXJyb3IiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIkdlbmVyaWNFcnJvckhhbmRsZXIiLCJlcnIiLCJyZXEiLCJyZXMiLCJuZXh0IiwiQXBpRXJyb3IiLCJjb25zb2xlIiwiZXJyb3IiLCJ0ZXN0IiwibWVzc2FnZSIsInJlcGxhY2UiLCJzdGF0dXMiLCJqc29uIiwiY29kZSIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL21pZGRsZXdhcmVzLyIsInNvdXJjZXMiOlsiR2VuZXJpY0Vycm9ySGFuZGxlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQXBpRXJyb3IgZnJvbSBcIi4uL2Vycm9ycy9BcGlFcnJvclwiO1xuXG5jb25zdCBHZW5lcmljRXJyb3JIYW5kbGVyID0gKGVyciwgcmVxLCByZXMsIG5leHQpID0+IHtcbiAgaWYgKCEoZXJyIGluc3RhbmNlb2YgQXBpRXJyb3IpKSB7XG4gICAgY29uc29sZS5lcnJvcihlcnIpO1xuICB9XG4gIGlmICgvXFx3KyB2YWxpZGF0aW9uIGZhaWxlZDogXFx3Ky9pLnRlc3QoZXJyLm1lc3NhZ2UpKSB7XG4gICAgZXJyLm1lc3NhZ2UgPSBlcnIubWVzc2FnZS5yZXBsYWNlKC9cXHcrIHZhbGlkYXRpb24gZmFpbGVkOiBcXHcrL2ksIFwiXCIpO1xuICB9XG4gIHJlcy5zdGF0dXMoZXJyLnN0YXR1cyB8fCA1MDApLmpzb24oe1xuICAgIHN0YXR1czogZXJyPy5zdGF0dXMsXG4gICAgZXJyb3I6IGVycj8ubWVzc2FnZSxcbiAgICBjb2RlOiBlcnIuY29kZSxcbiAgfSk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBHZW5lcmljRXJyb3JIYW5kbGVyO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxTQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFBMEMsU0FBQUQsdUJBQUFFLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFMUMsTUFBTUcsbUJBQW1CLEdBQUdBLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksS0FBSztFQUNuRCxJQUFJLEVBQUVILEdBQUcsWUFBWUksaUJBQVEsQ0FBQyxFQUFFO0lBQzlCQyxPQUFPLENBQUNDLEtBQUssQ0FBQ04sR0FBRyxDQUFDO0VBQ3BCO0VBQ0EsSUFBSSw2QkFBNkIsQ0FBQ08sSUFBSSxDQUFDUCxHQUFHLENBQUNRLE9BQU8sQ0FBQyxFQUFFO0lBQ25EUixHQUFHLENBQUNRLE9BQU8sR0FBR1IsR0FBRyxDQUFDUSxPQUFPLENBQUNDLE9BQU8sQ0FBQyw2QkFBNkIsRUFBRSxFQUFFLENBQUM7RUFDdEU7RUFDQVAsR0FBRyxDQUFDUSxNQUFNLENBQUNWLEdBQUcsQ0FBQ1UsTUFBTSxJQUFJLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7SUFDakNELE1BQU0sRUFBRVYsR0FBRyxFQUFFVSxNQUFNO0lBQ25CSixLQUFLLEVBQUVOLEdBQUcsRUFBRVEsT0FBTztJQUNuQkksSUFBSSxFQUFFWixHQUFHLENBQUNZO0VBQ1osQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUFDLElBQUFDLFFBQUEsR0FBQUMsT0FBQSxDQUFBaEIsT0FBQSxHQUVhQyxtQkFBbUIiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_ApiError","_interopRequireDefault","require","e","__esModule","default","GenericErrorHandler","err","req","res","next","ApiError","console","error","test","message","replace","status","json","code","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["GenericErrorHandler.js"],"sourcesContent":["import ApiError from \"../errors/ApiError\";\n\nconst GenericErrorHandler = (err, req, res, next) => {\n  if (!(err instanceof ApiError)) {\n    console.error(err);\n  }\n  if (/\\w+ validation failed: \\w+/i.test(err.message)) {\n    err.message = err.message.replace(/\\w+ validation failed: \\w+/i, \"\");\n  }\n  res.status(err.status || 500).json({\n    status: err?.status,\n    error: err?.message,\n    code: err.code,\n  });\n};\n\nexport default GenericErrorHandler;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA0C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE1C,MAAMG,mBAAmB,GAAGA,CAACC,GAAG,EAAEC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EACnD,IAAI,EAAEH,GAAG,YAAYI,iBAAQ,CAAC,EAAE;IAC9BC,OAAO,CAACC,KAAK,CAACN,GAAG,CAAC;EACpB;EACA,IAAI,6BAA6B,CAACO,IAAI,CAACP,GAAG,CAACQ,OAAO,CAAC,EAAE;IACnDR,GAAG,CAACQ,OAAO,GAAGR,GAAG,CAACQ,OAAO,CAACC,OAAO,CAAC,6BAA6B,EAAE,EAAE,CAAC;EACtE;EACAP,GAAG,CAACQ,MAAM,CAACV,GAAG,CAACU,MAAM,IAAI,GAAG,CAAC,CAACC,IAAI,CAAC;IACjCD,MAAM,EAAEV,GAAG,EAAEU,MAAM;IACnBJ,KAAK,EAAEN,GAAG,EAAEQ,OAAO;IACnBI,IAAI,EAAEZ,GAAG,CAACY;EACZ,CAAC,CAAC;AACJ,CAAC;AAAC,IAAAC,QAAA,GAAAC,OAAA,CAAAhB,OAAA,GAEaC,mBAAmB","ignoreList":[]}},"mtime":1721043695378},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/errors/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/errors/ApiError.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nclass ApiError extends Error {\n  constructor(message, status = 500, code) {\n    super(message);\n    this.status = status;\n    this.code = code;\n    this.name = this.constructor.name;\n    Error.captureStackTrace(this, this.constructor);\n  }\n}\nvar _default = exports.default = ApiError;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJBcGlFcnJvciIsIkVycm9yIiwiY29uc3RydWN0b3IiLCJtZXNzYWdlIiwic3RhdHVzIiwiY29kZSIsIm5hbWUiLCJjYXB0dXJlU3RhY2tUcmFjZSIsIl9kZWZhdWx0IiwiZXhwb3J0cyIsImRlZmF1bHQiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9lcnJvcnMvIiwic291cmNlcyI6WyJBcGlFcnJvci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBBcGlFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3IobWVzc2FnZSwgc3RhdHVzID0gNTAwLCBjb2RlKSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG4gICAgdGhpcy5zdGF0dXMgPSBzdGF0dXM7XG4gICAgdGhpcy5jb2RlID0gY29kZTtcbiAgICB0aGlzLm5hbWUgPSB0aGlzLmNvbnN0cnVjdG9yLm5hbWU7XG4gICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UodGhpcywgdGhpcy5jb25zdHJ1Y3Rvcik7XG4gIH1cbn1cbmV4cG9ydCBkZWZhdWx0IEFwaUVycm9yO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxNQUFNQSxRQUFRLFNBQVNDLEtBQUssQ0FBQztFQUMzQkMsV0FBV0EsQ0FBQ0MsT0FBTyxFQUFFQyxNQUFNLEdBQUcsR0FBRyxFQUFFQyxJQUFJLEVBQUU7SUFDdkMsS0FBSyxDQUFDRixPQUFPLENBQUM7SUFDZCxJQUFJLENBQUNDLE1BQU0sR0FBR0EsTUFBTTtJQUNwQixJQUFJLENBQUNDLElBQUksR0FBR0EsSUFBSTtJQUNoQixJQUFJLENBQUNDLElBQUksR0FBRyxJQUFJLENBQUNKLFdBQVcsQ0FBQ0ksSUFBSTtJQUNqQ0wsS0FBSyxDQUFDTSxpQkFBaUIsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDTCxXQUFXLENBQUM7RUFDakQ7QUFDRjtBQUFDLElBQUFNLFFBQUEsR0FBQUMsT0FBQSxDQUFBQyxPQUFBLEdBQ2NWLFFBQVEiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["ApiError","Error","constructor","message","status","code","name","captureStackTrace","_default","exports","default"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/errors/","sources":["ApiError.js"],"sourcesContent":["class ApiError extends Error {\n  constructor(message, status = 500, code) {\n    super(message);\n    this.status = status;\n    this.code = code;\n    this.name = this.constructor.name;\n    Error.captureStackTrace(this, this.constructor);\n  }\n}\nexport default ApiError;\n"],"mappings":";;;;;;AAAA,MAAMA,QAAQ,SAASC,KAAK,CAAC;EAC3BC,WAAWA,CAACC,OAAO,EAAEC,MAAM,GAAG,GAAG,EAAEC,IAAI,EAAE;IACvC,KAAK,CAACF,OAAO,CAAC;IACd,IAAI,CAACC,MAAM,GAAGA,MAAM;IACpB,IAAI,CAACC,IAAI,GAAGA,IAAI;IAChB,IAAI,CAACC,IAAI,GAAG,IAAI,CAACJ,WAAW,CAACI,IAAI;IACjCL,KAAK,CAACM,iBAAiB,CAAC,IAAI,EAAE,IAAI,CAACL,WAAW,CAAC;EACjD;AACF;AAAC,IAAAM,QAAA,GAAAC,OAAA,CAAAC,OAAA,GACcV,QAAQ","ignoreList":[]}},"mtime":1721043478453},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/Session.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _passport = _interopRequireDefault(require(\"passport\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Session = _passport.default.authenticate(\"jwt\", {\n  session: false\n});\nvar _default = exports.default = Session;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcGFzc3BvcnQiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIlNlc3Npb24iLCJwYXNzcG9ydCIsImF1dGhlbnRpY2F0ZSIsInNlc3Npb24iLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9taWRkbGV3YXJlcy8iLCJzb3VyY2VzIjpbIlNlc3Npb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHBhc3Nwb3J0IGZyb20gXCJwYXNzcG9ydFwiO1xuXG5jb25zdCBTZXNzaW9uID0gcGFzc3BvcnQuYXV0aGVudGljYXRlKFwiand0XCIsIHsgc2Vzc2lvbjogZmFsc2UgfSk7XG5cbmV4cG9ydCBkZWZhdWx0IFNlc3Npb247XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUFnQyxTQUFBRCx1QkFBQUUsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUVoQyxNQUFNRyxPQUFPLEdBQUdDLGlCQUFRLENBQUNDLFlBQVksQ0FBQyxLQUFLLEVBQUU7RUFBRUMsT0FBTyxFQUFFO0FBQU0sQ0FBQyxDQUFDO0FBQUMsSUFBQUMsUUFBQSxHQUFBQyxPQUFBLENBQUFOLE9BQUEsR0FFbERDLE9BQU8iLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_passport","_interopRequireDefault","require","e","__esModule","default","Session","passport","authenticate","session","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["Session.js"],"sourcesContent":["import passport from \"passport\";\n\nconst Session = passport.authenticate(\"jwt\", { session: false });\n\nexport default Session;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AAAgC,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEhC,MAAMG,OAAO,GAAGC,iBAAQ,CAACC,YAAY,CAAC,KAAK,EAAE;EAAEC,OAAO,EAAE;AAAM,CAAC,CAAC;AAAC,IAAAC,QAAA,GAAAC,OAAA,CAAAN,OAAA,GAElDC,OAAO","ignoreList":[]}},"mtime":1722848733624},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _Users = _interopRequireDefault(require(\"./Users\"));\nvar _Products = _interopRequireDefault(require(\"./Products\"));\nvar _cart = _interopRequireDefault(require(\"./cart\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = exports.default = [_Users.default, _Products.default, _cart.default];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfVXNlcnMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9Qcm9kdWN0cyIsIl9jYXJ0IiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiX2RlZmF1bHQiLCJleHBvcnRzIiwidXNlcnMiLCJQcm9kdWN0cyIsImNhcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvcm91dGVzLyIsInNvdXJjZXMiOlsiaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHVzZXJzIGZyb20gXCIuL1VzZXJzXCI7XG5pbXBvcnQgUHJvZHVjdHMgZnJvbSBcIi4vUHJvZHVjdHNcIjtcbmltcG9ydCBjYXJ0cyBmcm9tIFwiLi9jYXJ0XCI7XG5cbmV4cG9ydCBkZWZhdWx0IFt1c2VycywgUHJvZHVjdHMsIGNhcnRzXTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsTUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsU0FBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsS0FBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBO0FBQTJCLFNBQUFELHVCQUFBSSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBQUEsSUFBQUcsUUFBQSxHQUFBQyxPQUFBLENBQUFGLE9BQUEsR0FFWixDQUFDRyxjQUFLLEVBQUVDLGlCQUFRLEVBQUVDLGFBQUssQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_Users","_interopRequireDefault","require","_Products","_cart","e","__esModule","default","_default","exports","users","Products","carts"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["index.js"],"sourcesContent":["import users from \"./Users\";\nimport Products from \"./Products\";\nimport carts from \"./cart\";\n\nexport default [users, Products, carts];\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,KAAA,GAAAH,sBAAA,CAAAC,OAAA;AAA2B,SAAAD,uBAAAI,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAAA,IAAAG,QAAA,GAAAC,OAAA,CAAAF,OAAA,GAEZ,CAACG,cAAK,EAAEC,iBAAQ,EAAEC,aAAK,CAAC","ignoreList":[]}},"mtime":1723194779748},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/Users.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\nvar _getUserIP = _interopRequireDefault(require(\"../middlewares/getUserIP\"));\nvar _VerificationEmail = _interopRequireDefault(require(\"../middlewares/VerificationEmail\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\n//silinebilir çalışmazsa\nvar _default = router => {\n  router.post(\"/register\", _getUserIP.default, async (req, res, next) => {\n    const {\n      email,\n      name,\n      surname,\n      phoneNumber,\n      password,\n      address,\n      city,\n      country,\n      zipCode\n    } = req.body;\n    if (!email) {\n      return res.status(400).send(new _ApiError.default(400, \"E-posta gereklidir\"));\n    }\n    const existingUser = await _users.default.findOne({\n      email\n    });\n    if (existingUser) {\n      return res.status(400).send(new _ApiError.default(400, \"Bu e-posta zaten kullanılıyor\"));\n    }\n    const user = new _users.default({\n      email,\n      name,\n      surname,\n      phoneNumber,\n      password,\n      address,\n      city,\n      country,\n      zipCode,\n      ip: req.userIp // Kullanıcı IP'sini ekle\n    });\n    try {\n      await user.save();\n      req.user = user;\n      next();\n      // return res\n      //   .status(200)\n      //   .json(`${email} mail adresi ile kullanıcı oluşturuldu.`);\n    } catch (error) {\n      console.log(error);\n      return res.status(500).send(new _ApiError.default(500, \"Kayıt işlemi sırasında hata oluştu\"));\n    }\n  }, _VerificationEmail.default,\n  //silinebilir çalışmazsa\n  (req, res) => {\n    return res.status(200).json(`${req.user.email} mail adresi ile kullanıcı oluşturuldu. Lütfen E-postanızı doğrulayınız.` //middlewaredeki üretilen jwtyi konsola yazdır\n    );\n  });\n\n  //silinebilir çalışmazsa\n  router.get(\"/verify-email/\", async (req, res) => {\n    const {\n      token\n    } = req.query;\n    if (!token) {\n      return res.status(400).send(new _ApiError.default(400, \"Token gereklidir\"));\n    }\n    try {\n      const decoded = _jsonwebtoken.default.verify(token, process.env.JWT_SECRET);\n      const user = await _users.default.findById(decoded.id);\n      if (!user) {\n        return res.status(400).send(new _ApiError.default(400, \"Kullanıcı bulunamadı\"));\n      }\n      if (user.isVerified) {\n        return res.status(400).send(new _ApiError.default(400, \"Kullanıcı zaten doğrulanmış\"));\n      }\n      user.isVerified = true;\n      await user.save();\n      return res.sendFile(\"verification-success.html\", {\n        root: \"public\"\n      });\n    } catch (error) {\n      console.log(error);\n      return res.status(500).send(new _ApiError.default(500, \"Doğrulama işlemi sırasında hata oluştu\"));\n    }\n  });\n  router.post(\"/login\", async (req, res) => {\n    const {\n      email,\n      password\n    } = req.body;\n    const user = await _users.default.findOne({\n      email\n    });\n    if (!email || !password) {\n      throw new _ApiError.default(\"Email and Password is required\", 401, \"requiredEmailAndPassword\");\n    }\n    if (!user) {\n      throw new _ApiError.default(\"Incorrect Password or email2\", 401, \"userOrPasswordIncorrect\");\n    }\n    if (user.isVerified == false) {\n      throw new _ApiError.default(\"You have to verificate your account.\", 401, \"accountNotVerified\");\n    }\n    const passwordConfirmed = await _bcryptjs.default.compare(password, user.password);\n    // console.log(\"kullanıcı girdisi:\", password); silinecekler\n    // console.log(\"hashlenmiş hali:\", user.password);\n\n    if (passwordConfirmed) {\n      const userJson = user.toJSON();\n      const token = _jsonwebtoken.default.sign(userJson, process.env.JWT_SECRET);\n      res.json({\n        token: `Bearer ${token}`,\n        user: userJson\n      });\n    } else {\n      throw new _ApiError.default(\"Incorrect Password or email\", 401, \"userOrPasswordIncorrect\");\n    }\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfdXNlcnMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9BcGlFcnJvciIsIl9iY3J5cHRqcyIsIl9qc29ud2VidG9rZW4iLCJfZ2V0VXNlcklQIiwiX1ZlcmlmaWNhdGlvbkVtYWlsIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiX2RlZmF1bHQiLCJyb3V0ZXIiLCJwb3N0IiwiZ2V0VXNlcklwIiwicmVxIiwicmVzIiwibmV4dCIsImVtYWlsIiwibmFtZSIsInN1cm5hbWUiLCJwaG9uZU51bWJlciIsInBhc3N3b3JkIiwiYWRkcmVzcyIsImNpdHkiLCJjb3VudHJ5IiwiemlwQ29kZSIsImJvZHkiLCJzdGF0dXMiLCJzZW5kIiwiQXBpRXJyb3IiLCJleGlzdGluZ1VzZXIiLCJVc2VycyIsImZpbmRPbmUiLCJ1c2VyIiwiaXAiLCJ1c2VySXAiLCJzYXZlIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwic2VuZFZlcmlmaWNhdGlvbkVtYWlsIiwianNvbiIsImdldCIsInRva2VuIiwicXVlcnkiLCJkZWNvZGVkIiwiand0IiwidmVyaWZ5IiwicHJvY2VzcyIsImVudiIsIkpXVF9TRUNSRVQiLCJmaW5kQnlJZCIsImlkIiwiaXNWZXJpZmllZCIsInNlbmRGaWxlIiwicm9vdCIsInBhc3N3b3JkQ29uZmlybWVkIiwiYmNyeXB0IiwiY29tcGFyZSIsInVzZXJKc29uIiwidG9KU09OIiwic2lnbiIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9yb3V0ZXMvIiwic291cmNlcyI6WyJVc2Vycy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgVXNlcnMgZnJvbSBcIi4uL2RiL3VzZXJzXCI7XG5pbXBvcnQgQXBpRXJyb3IgZnJvbSBcIi4uL2Vycm9ycy9BcGlFcnJvclwiO1xuaW1wb3J0IGJjcnlwdCBmcm9tIFwiYmNyeXB0anNcIjtcbmltcG9ydCBqd3QgZnJvbSBcImpzb253ZWJ0b2tlblwiO1xuaW1wb3J0IGdldFVzZXJJcCBmcm9tIFwiLi4vbWlkZGxld2FyZXMvZ2V0VXNlcklQXCI7XG5pbXBvcnQgc2VuZFZlcmlmaWNhdGlvbkVtYWlsIGZyb20gXCIuLi9taWRkbGV3YXJlcy9WZXJpZmljYXRpb25FbWFpbFwiOyAvL3NpbGluZWJpbGlyIMOnYWzEscWfbWF6c2FcblxuZXhwb3J0IGRlZmF1bHQgKHJvdXRlcikgPT4ge1xuICByb3V0ZXIucG9zdChcbiAgICBcIi9yZWdpc3RlclwiLFxuICAgIGdldFVzZXJJcCxcbiAgICBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgZW1haWwsXG4gICAgICAgIG5hbWUsXG4gICAgICAgIHN1cm5hbWUsXG4gICAgICAgIHBob25lTnVtYmVyLFxuICAgICAgICBwYXNzd29yZCxcbiAgICAgICAgYWRkcmVzcyxcbiAgICAgICAgY2l0eSxcbiAgICAgICAgY291bnRyeSxcbiAgICAgICAgemlwQ29kZSxcbiAgICAgIH0gPSByZXEuYm9keTtcblxuICAgICAgaWYgKCFlbWFpbCkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQobmV3IEFwaUVycm9yKDQwMCwgXCJFLXBvc3RhIGdlcmVrbGlkaXJcIikpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBleGlzdGluZ1VzZXIgPSBhd2FpdCBVc2Vycy5maW5kT25lKHsgZW1haWwgfSk7XG4gICAgICBpZiAoZXhpc3RpbmdVc2VyKSB7XG4gICAgICAgIHJldHVybiByZXNcbiAgICAgICAgICAuc3RhdHVzKDQwMClcbiAgICAgICAgICAuc2VuZChuZXcgQXBpRXJyb3IoNDAwLCBcIkJ1IGUtcG9zdGEgemF0ZW4ga3VsbGFuxLFsxLF5b3JcIikpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB1c2VyID0gbmV3IFVzZXJzKHtcbiAgICAgICAgZW1haWwsXG4gICAgICAgIG5hbWUsXG4gICAgICAgIHN1cm5hbWUsXG4gICAgICAgIHBob25lTnVtYmVyLFxuICAgICAgICBwYXNzd29yZCxcbiAgICAgICAgYWRkcmVzcyxcbiAgICAgICAgY2l0eSxcbiAgICAgICAgY291bnRyeSxcbiAgICAgICAgemlwQ29kZSxcbiAgICAgICAgaXA6IHJlcS51c2VySXAsIC8vIEt1bGxhbsSxY8SxIElQJ3NpbmkgZWtsZVxuICAgICAgfSk7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHVzZXIuc2F2ZSgpO1xuICAgICAgICByZXEudXNlciA9IHVzZXI7XG4gICAgICAgIG5leHQoKTtcbiAgICAgICAgLy8gcmV0dXJuIHJlc1xuICAgICAgICAvLyAgIC5zdGF0dXMoMjAwKVxuICAgICAgICAvLyAgIC5qc29uKGAke2VtYWlsfSBtYWlsIGFkcmVzaSBpbGUga3VsbGFuxLFjxLEgb2x1xZ90dXJ1bGR1LmApO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICByZXR1cm4gcmVzXG4gICAgICAgICAgLnN0YXR1cyg1MDApXG4gICAgICAgICAgLnNlbmQobmV3IEFwaUVycm9yKDUwMCwgXCJLYXnEsXQgacWfbGVtaSBzxLFyYXPEsW5kYSBoYXRhIG9sdcWfdHVcIikpO1xuICAgICAgfVxuICAgIH0sXG4gICAgc2VuZFZlcmlmaWNhdGlvbkVtYWlsLCAvL3NpbGluZWJpbGlyIMOnYWzEscWfbWF6c2FcbiAgICAocmVxLCByZXMpID0+IHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbihcbiAgICAgICAgYCR7cmVxLnVzZXIuZW1haWx9IG1haWwgYWRyZXNpIGlsZSBrdWxsYW7EsWPEsSBvbHXFn3R1cnVsZHUuIEzDvHRmZW4gRS1wb3N0YW7EsXrEsSBkb8SfcnVsYXnEsW7EsXouYCAvL21pZGRsZXdhcmVkZWtpIMO8cmV0aWxlbiBqd3R5aSBrb25zb2xhIHlhemTEsXJcbiAgICAgICk7XG4gICAgfVxuICApO1xuXG4gIC8vc2lsaW5lYmlsaXIgw6dhbMSxxZ9tYXpzYVxuICByb3V0ZXIuZ2V0KFwiL3ZlcmlmeS1lbWFpbC9cIiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyB0b2tlbiB9ID0gcmVxLnF1ZXJ5O1xuXG4gICAgaWYgKCF0b2tlbikge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKG5ldyBBcGlFcnJvcig0MDAsIFwiVG9rZW4gZ2VyZWtsaWRpclwiKSk7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGRlY29kZWQgPSBqd3QudmVyaWZ5KHRva2VuLCBwcm9jZXNzLmVudi5KV1RfU0VDUkVUKTtcbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2Vycy5maW5kQnlJZChkZWNvZGVkLmlkKTtcbiAgICAgIGlmICghdXNlcikge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQobmV3IEFwaUVycm9yKDQwMCwgXCJLdWxsYW7EsWPEsSBidWx1bmFtYWTEsVwiKSk7XG4gICAgICB9XG5cbiAgICAgIGlmICh1c2VyLmlzVmVyaWZpZWQpIHtcbiAgICAgICAgcmV0dXJuIHJlc1xuICAgICAgICAgIC5zdGF0dXMoNDAwKVxuICAgICAgICAgIC5zZW5kKG5ldyBBcGlFcnJvcig0MDAsIFwiS3VsbGFuxLFjxLEgemF0ZW4gZG/En3J1bGFubcSxxZ9cIikpO1xuICAgICAgfVxuXG4gICAgICB1c2VyLmlzVmVyaWZpZWQgPSB0cnVlO1xuICAgICAgYXdhaXQgdXNlci5zYXZlKCk7XG5cbiAgICAgIHJldHVybiByZXMuc2VuZEZpbGUoXCJ2ZXJpZmljYXRpb24tc3VjY2Vzcy5odG1sXCIsIHsgcm9vdDogXCJwdWJsaWNcIiB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgcmV0dXJuIHJlc1xuICAgICAgICAuc3RhdHVzKDUwMClcbiAgICAgICAgLnNlbmQobmV3IEFwaUVycm9yKDUwMCwgXCJEb8SfcnVsYW1hIGnFn2xlbWkgc8SxcmFzxLFuZGEgaGF0YSBvbHXFn3R1XCIpKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJvdXRlci5wb3N0KFwiL2xvZ2luXCIsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGNvbnN0IHsgZW1haWwsIHBhc3N3b3JkIH0gPSByZXEuYm9keTtcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlcnMuZmluZE9uZSh7IGVtYWlsIH0pO1xuXG4gICAgaWYgKCFlbWFpbCB8fCAhcGFzc3dvcmQpIHtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgXCJFbWFpbCBhbmQgUGFzc3dvcmQgaXMgcmVxdWlyZWRcIixcbiAgICAgICAgNDAxLFxuICAgICAgICBcInJlcXVpcmVkRW1haWxBbmRQYXNzd29yZFwiXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmICghdXNlcikge1xuICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICBcIkluY29ycmVjdCBQYXNzd29yZCBvciBlbWFpbDJcIixcbiAgICAgICAgNDAxLFxuICAgICAgICBcInVzZXJPclBhc3N3b3JkSW5jb3JyZWN0XCJcbiAgICAgICk7XG4gICAgfVxuICAgIGlmICh1c2VyLmlzVmVyaWZpZWQgPT0gZmFsc2UpIHtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgXCJZb3UgaGF2ZSB0byB2ZXJpZmljYXRlIHlvdXIgYWNjb3VudC5cIixcbiAgICAgICAgNDAxLFxuICAgICAgICBcImFjY291bnROb3RWZXJpZmllZFwiXG4gICAgICApO1xuICAgIH1cbiAgICBjb25zdCBwYXNzd29yZENvbmZpcm1lZCA9IGF3YWl0IGJjcnlwdC5jb21wYXJlKHBhc3N3b3JkLCB1c2VyLnBhc3N3b3JkKTtcbiAgICAvLyBjb25zb2xlLmxvZyhcImt1bGxhbsSxY8SxIGdpcmRpc2k6XCIsIHBhc3N3b3JkKTsgc2lsaW5lY2VrbGVyXG4gICAgLy8gY29uc29sZS5sb2coXCJoYXNobGVubWnFnyBoYWxpOlwiLCB1c2VyLnBhc3N3b3JkKTtcblxuICAgIGlmIChwYXNzd29yZENvbmZpcm1lZCkge1xuICAgICAgY29uc3QgdXNlckpzb24gPSB1c2VyLnRvSlNPTigpO1xuICAgICAgY29uc3QgdG9rZW4gPSBqd3Quc2lnbih1c2VySnNvbiwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCk7XG4gICAgICByZXMuanNvbih7XG4gICAgICAgIHRva2VuOiBgQmVhcmVyICR7dG9rZW59YCxcbiAgICAgICAgdXNlcjogdXNlckpzb24sXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICBcIkluY29ycmVjdCBQYXNzd29yZCBvciBlbWFpbFwiLFxuICAgICAgICA0MDEsXG4gICAgICAgIFwidXNlck9yUGFzc3dvcmRJbmNvcnJlY3RcIlxuICAgICAgKTtcbiAgICB9XG4gIH0pO1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsTUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsU0FBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsU0FBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUcsYUFBQSxHQUFBSixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUksVUFBQSxHQUFBTCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUssa0JBQUEsR0FBQU4sc0JBQUEsQ0FBQUMsT0FBQTtBQUFxRSxTQUFBRCx1QkFBQU8sQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUFDO0FBQUEsSUFBQUcsUUFBQSxHQUV0REMsTUFBTSxJQUFLO0VBQ3pCQSxNQUFNLENBQUNDLElBQUksQ0FDVCxXQUFXLEVBQ1hDLGtCQUFTLEVBQ1QsT0FBT0MsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksS0FBSztJQUN4QixNQUFNO01BQ0pDLEtB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","map":{"version":3,"names":["_users","_interopRequireDefault","require","_ApiError","_bcryptjs","_jsonwebtoken","_getUserIP","_VerificationEmail","e","__esModule","default","_default","router","post","getUserIp","req","res","next","email","name","surname","phoneNumber","password","address","city","country","zipCode","body","status","send","ApiError","existingUser","Users","findOne","user","ip","userIp","save","error","console","log","sendVerificationEmail","json","get","token","query","decoded","jwt","verify","process","env","JWT_SECRET","findById","id","isVerified","sendFile","root","passwordConfirmed","bcrypt","compare","userJson","toJSON","sign","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["Users.js"],"sourcesContent":["import Users from \"../db/users\";\nimport ApiError from \"../errors/ApiError\";\nimport bcrypt from \"bcryptjs\";\nimport jwt from \"jsonwebtoken\";\nimport getUserIp from \"../middlewares/getUserIP\";\nimport sendVerificationEmail from \"../middlewares/VerificationEmail\"; //silinebilir çalışmazsa\n\nexport default (router) => {\n  router.post(\n    \"/register\",\n    getUserIp,\n    async (req, res, next) => {\n      const {\n        email,\n        name,\n        surname,\n        phoneNumber,\n        password,\n        address,\n        city,\n        country,\n        zipCode,\n      } = req.body;\n\n      if (!email) {\n        return res.status(400).send(new ApiError(400, \"E-posta gereklidir\"));\n      }\n\n      const existingUser = await Users.findOne({ email });\n      if (existingUser) {\n        return res\n          .status(400)\n          .send(new ApiError(400, \"Bu e-posta zaten kullanılıyor\"));\n      }\n\n      const user = new Users({\n        email,\n        name,\n        surname,\n        phoneNumber,\n        password,\n        address,\n        city,\n        country,\n        zipCode,\n        ip: req.userIp, // Kullanıcı IP'sini ekle\n      });\n\n      try {\n        await user.save();\n        req.user = user;\n        next();\n        // return res\n        //   .status(200)\n        //   .json(`${email} mail adresi ile kullanıcı oluşturuldu.`);\n      } catch (error) {\n        console.log(error);\n        return res\n          .status(500)\n          .send(new ApiError(500, \"Kayıt işlemi sırasında hata oluştu\"));\n      }\n    },\n    sendVerificationEmail, //silinebilir çalışmazsa\n    (req, res) => {\n      return res.status(200).json(\n        `${req.user.email} mail adresi ile kullanıcı oluşturuldu. Lütfen E-postanızı doğrulayınız.` //middlewaredeki üretilen jwtyi konsola yazdır\n      );\n    }\n  );\n\n  //silinebilir çalışmazsa\n  router.get(\"/verify-email/\", async (req, res) => {\n    const { token } = req.query;\n\n    if (!token) {\n      return res.status(400).send(new ApiError(400, \"Token gereklidir\"));\n    }\n\n    try {\n      const decoded = jwt.verify(token, process.env.JWT_SECRET);\n      const user = await Users.findById(decoded.id);\n      if (!user) {\n        return res.status(400).send(new ApiError(400, \"Kullanıcı bulunamadı\"));\n      }\n\n      if (user.isVerified) {\n        return res\n          .status(400)\n          .send(new ApiError(400, \"Kullanıcı zaten doğrulanmış\"));\n      }\n\n      user.isVerified = true;\n      await user.save();\n\n      return res.sendFile(\"verification-success.html\", { root: \"public\" });\n    } catch (error) {\n      console.log(error);\n      return res\n        .status(500)\n        .send(new ApiError(500, \"Doğrulama işlemi sırasında hata oluştu\"));\n    }\n  });\n\n  router.post(\"/login\", async (req, res) => {\n    const { email, password } = req.body;\n    const user = await Users.findOne({ email });\n\n    if (!email || !password) {\n      throw new ApiError(\n        \"Email and Password is required\",\n        401,\n        \"requiredEmailAndPassword\"\n      );\n    }\n\n    if (!user) {\n      throw new ApiError(\n        \"Incorrect Password or email2\",\n        401,\n        \"userOrPasswordIncorrect\"\n      );\n    }\n    if (user.isVerified == false) {\n      throw new ApiError(\n        \"You have to verificate your account.\",\n        401,\n        \"accountNotVerified\"\n      );\n    }\n    const passwordConfirmed = await bcrypt.compare(password, user.password);\n    // console.log(\"kullanıcı girdisi:\", password); silinecekler\n    // console.log(\"hashlenmiş hali:\", user.password);\n\n    if (passwordConfirmed) {\n      const userJson = user.toJSON();\n      const token = jwt.sign(userJson, process.env.JWT_SECRET);\n      res.json({\n        token: `Bearer ${token}`,\n        user: userJson,\n      });\n    } else {\n      throw new ApiError(\n        \"Incorrect Password or email\",\n        401,\n        \"userOrPasswordIncorrect\"\n      );\n    }\n  });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,SAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,aAAA,GAAAJ,sBAAA,CAAAC,OAAA;AACA,IAAAI,UAAA,GAAAL,sBAAA,CAAAC,OAAA;AACA,IAAAK,kBAAA,GAAAN,sBAAA,CAAAC,OAAA;AAAqE,SAAAD,uBAAAO,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAAC;AAAA,IAAAG,QAAA,GAEtDC,MAAM,IAAK;EACzBA,MAAM,CAACC,IAAI,CACT,WAAW,EACXC,kBAAS,EACT,OAAOC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;IACxB,MAAM;MACJC,KAAK;MACLC,IAAI;MACJC,OAAO;MACPC,WAAW;MACXC,QAAQ;MACRC,OAAO;MACPC,IAAI;MACJC,OAAO;MACPC;IACF,CAAC,GAAGX,GAAG,CAACY,IAAI;IAEZ,IAAI,CAACT,KAAK,EAAE;MACV,OAAOF,GAAG,CAACY,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,IAAIC,iBAAQ,CAAC,GAAG,EAAE,oBAAoB,CAAC,CAAC;IACtE;IAEA,MAAMC,YAAY,GAAG,MAAMC,cAAK,CAACC,OAAO,CAAC;MAAEf;IAAM,CAAC,CAAC;IACnD,IAAIa,YAAY,EAAE;MAChB,OAAOf,GAAG,CACPY,MAAM,CAAC,GAAG,CAAC,CACXC,IAAI,CAAC,IAAIC,iBAAQ,CAAC,GAAG,EAAE,+BAA+B,CAAC,CAAC;IAC7D;IAEA,MAAMI,IAAI,GAAG,IAAIF,cAAK,CAAC;MACrBd,KAAK;MACLC,IAAI;MACJC,OAAO;MACPC,WAAW;MACXC,QAAQ;MACRC,OAAO;MACPC,IAAI;MACJC,OAAO;MACPC,OAAO;MACPS,EAAE,EAAEpB,GAAG,CAACqB,MAAM,CAAE;IAClB,CAAC,CAAC;IAEF,IAAI;MACF,MAAMF,IAAI,CAACG,IAAI,CAAC,CAAC;MACjBtB,GAAG,CAACmB,IAAI,GAAGA,IAAI;MACfjB,IAAI,CAAC,CAAC;MACN;MACA;MACA;IACF,CAAC,CAAC,OAAOqB,KAAK,EAAE;MACdC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;MAClB,OAAOtB,GAAG,CACPY,MAAM,CAAC,GAAG,CAAC,CACXC,IAAI,CAAC,IAAIC,iBAAQ,CAAC,GAAG,EAAE,oCAAoC,CAAC,CAAC;IAClE;EACF,CAAC,EACDW,0BAAqB;EAAE;EACvB,CAAC1B,GAAG,EAAEC,GAAG,KAAK;IACZ,OAAOA,GAAG,CAACY,MAAM,CAAC,GAAG,CAAC,CAACc,IAAI,CACzB,GAAG3B,GAAG,CAACmB,IAAI,CAAChB,KAAK,0EAA0E,CAAC;IAC9F,CAAC;EACH,CACF,CAAC;;EAED;EACAN,MAAM,CAAC+B,GAAG,CAAC,gBAAgB,EAAE,OAAO5B,GAAG,EAAEC,GAAG,KAAK;IAC/C,MAAM;MAAE4B;IAAM,CAAC,GAAG7B,GAAG,CAAC8B,KAAK;IAE3B,IAAI,CAACD,KAAK,EAAE;MACV,OAAO5B,GAAG,CAACY,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,IAAIC,iBAAQ,CAAC,GAAG,EAAE,kBAAkB,CAAC,CAAC;IACpE;IAEA,IAAI;MACF,MAAMgB,OAAO,GAAGC,qBAAG,CAACC,MAAM,CAACJ,KAAK,EAAEK,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC;MACzD,MAAMjB,IAAI,GAAG,MAAMF,cAAK,CAACoB,QAAQ,CAACN,OAAO,CAACO,EAAE,CAAC;MAC7C,IAAI,CAACnB,IAAI,EAAE;QACT,OAAOlB,GAAG,CAACY,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,IAAIC,iBAAQ,CAAC,GAAG,EAAE,sBAAsB,CAAC,CAAC;MACxE;MAEA,IAAII,IAAI,CAACoB,UAAU,EAAE;QACnB,OAAOtC,GAAG,CACPY,MAAM,CAAC,GAAG,CAAC,CACXC,IAAI,CAAC,IAAIC,iBAAQ,CAAC,GAAG,EAAE,6BAA6B,CAAC,CAAC;MAC3D;MAEAI,IAAI,CAACoB,UAAU,GAAG,IAAI;MACtB,MAAMpB,IAAI,CAACG,IAAI,CAAC,CAAC;MAEjB,OAAOrB,GAAG,CAACuC,QAAQ,CAAC,2BAA2B,EAAE;QAAEC,IAAI,EAAE;MAAS,CAAC,CAAC;IACtE,CAAC,CAAC,OAAOlB,KAAK,EAAE;MACdC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;MAClB,OAAOtB,GAAG,CACPY,MAAM,CAAC,GAAG,CAAC,CACXC,IAAI,CAAC,IAAIC,iBAAQ,CAAC,GAAG,EAAE,wCAAwC,CAAC,CAAC;IACtE;EACF,CAAC,CAAC;EAEFlB,MAAM,CAACC,IAAI,CAAC,QAAQ,EAAE,OAAOE,GAAG,EAAEC,GAAG,KAAK;IACxC,MAAM;MAAEE,KAAK;MAAEI;IAAS,CAAC,GAAGP,GAAG,CAACY,IAAI;IACpC,MAAMO,IAAI,GAAG,MAAMF,cAAK,CAACC,OAAO,CAAC;MAAEf;IAAM,CAAC,CAAC;IAE3C,IAAI,CAACA,KAAK,IAAI,CAACI,QAAQ,EAAE;MACvB,MAAM,IAAIQ,iBAAQ,CAChB,gCAAgC,EAChC,GAAG,EACH,0BACF,CAAC;IACH;IAEA,IAAI,CAACI,IAAI,EAAE;MACT,MAAM,IAAIJ,iBAAQ,CAChB,8BAA8B,EAC9B,GAAG,EACH,yBACF,CAAC;IACH;IACA,IAAII,IAAI,CAACoB,UAAU,IAAI,KAAK,EAAE;MAC5B,MAAM,IAAIxB,iBAAQ,CAChB,sCAAsC,EACtC,GAAG,EACH,oBACF,CAAC;IACH;IACA,MAAM2B,iBAAiB,GAAG,MAAMC,iBAAM,CAACC,OAAO,CAACrC,QAAQ,EAAEY,IAAI,CAACZ,QAAQ,CAAC;IACvE;IACA;;IAEA,IAAImC,iBAAiB,EAAE;MACrB,MAAMG,QAAQ,GAAG1B,IAAI,CAAC2B,MAAM,CAAC,CAAC;MAC9B,MAAMjB,KAAK,GAAGG,qBAAG,CAACe,IAAI,CAACF,QAAQ,EAAEX,OAAO,CAACC,GAAG,CAACC,UAAU,CAAC;MACxDnC,GAAG,CAAC0B,IAAI,CAAC;QACPE,KAAK,EAAE,UAAUA,KAAK,EAAE;QACxBV,IAAI,EAAE0B;MACR,CAAC,CAAC;IACJ,CAAC,MAAM;MACL,MAAM,IAAI9B,iBAAQ,CAChB,6BAA6B,EAC7B,GAAG,EACH,yBACF,CAAC;IACH;EACF,CAAC,CAAC;AACJ,CAAC;AAAAiC,OAAA,CAAArD,OAAA,GAAAC,QAAA","ignoreList":[]}},"mtime":1722793365186},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/users.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst randomColorGenerator = () => {\n  return Math.floor(Math.random() * 16777215).toString(16);\n};\nconst UserSchema = new Schema({\n  uuid: {\n    type: String,\n    default: (0, _uuid.default)(),\n    unique: true,\n    required: true\n  },\n  locale: {\n    type: String,\n    required: true,\n    default: \"tr\",\n    enum: [\"tr\", \"en\"]\n  },\n  role: {\n    type: String,\n    required: true,\n    default: \"user\",\n    enum: [\"user\", \"admin\"]\n  },\n  name: {\n    type: String,\n    required: true\n  },\n  surname: {\n    type: String,\n    required: true\n  },\n  email: {\n    type: String,\n    required: true,\n    unique: true\n  },\n  phoneNumber: {\n    type: String,\n    required: true,\n    unique: true\n  },\n  identityNumber: {\n    type: String,\n    required: true,\n    default: \"00000000000\"\n  },\n  password: {\n    type: String,\n    required: true\n  },\n  avatarColor: {\n    type: String,\n    default: randomColorGenerator(),\n    required: true\n  },\n  address: {\n    //fatura ve sipariş adresi diye ikiye ayrılabilir\n    type: String,\n    required: true\n  },\n  city: {\n    type: String,\n    required: true\n  },\n  country: {\n    type: String,\n    required: true,\n    default: \"Turkey\"\n  },\n  zipCode: {\n    type: String,\n    required: true\n  },\n  ip: {\n    type: String,\n    required: true\n    //default: \"85.34.78.112\", //cihazın ip'sini alır\n  },\n  isVerified: {\n    type: Boolean,\n    default: false\n  },\n  cardUserKey: {\n    type: String,\n    required: false,\n    unique: true\n  }\n}, {\n  _id: true,\n  collection: \"users\",\n  timestamps: true,\n  toJSON: {\n    transform: (doc, ret) => {\n      delete ret.__v;\n      delete ret.password;\n      return {\n        ...ret\n      };\n    }\n  }\n});\nUserSchema.pre(\"save\", async function (next) {\n  try {\n    // this.password = await bcrypt.hash(this.password, 10);\n    if (this.isModified(\"password\")) {\n      //password incorrect hatasını böyle çözdük\n      this.password = await _bcryptjs.default.hash(this.password, 10);\n    }\n    return next();\n  } catch (err) {\n    return next(err);\n  }\n  next();\n});\nconst Users = _mongoose.default.model(\"Users\", UserSchema);\nvar _default = exports.default = Users;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9iY3J5cHRqcyIsIl91dWlkIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiU2NoZW1hIiwibW9uZ29vc2UiLCJPYmplY3RJZCIsIlR5cGVzIiwicmFuZG9tQ29sb3JHZW5lcmF0b3IiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJ0b1N0cmluZyIsIlVzZXJTY2hlbWEiLCJ1dWlkIiwidHlwZSIsIlN0cmluZyIsImdlbmVyYXRlZElkIiwidW5pcXVlIiwicmVxdWlyZWQiLCJsb2NhbGUiLCJlbnVtIiwicm9sZSIsIm5hbWUiLCJzdXJuYW1lIiwiZW1haWwiLCJwaG9uZU51bWJlciIsImlkZW50aXR5TnVtYmVyIiwicGFzc3dvcmQiLCJhdmF0YXJDb2xvciIsImFkZHJlc3MiLCJjaXR5IiwiY291bnRyeSIsInppcENvZGUiLCJpcCIsImlzVmVyaWZpZWQiLCJCb29sZWFuIiwiY2FyZFVzZXJLZXkiLCJfaWQiLCJjb2xsZWN0aW9uIiwidGltZXN0YW1wcyIsInRvSlNPTiIsInRyYW5zZm9ybSIsImRvYyIsInJldCIsIl9fdiIsInByZSIsIm5leHQiLCJpc01vZGlmaWVkIiwiYmNyeXB0IiwiaGFzaCIsImVyciIsIlVzZXJzIiwibW9kZWwiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9kYi8iLCJzb3VyY2VzIjpbInVzZXJzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSBmcm9tIFwibW9uZ29vc2VcIjtcbmltcG9ydCBiY3J5cHQgZnJvbSBcImJjcnlwdGpzXCI7XG5pbXBvcnQgZ2VuZXJhdGVkSWQgZnJvbSBcIi4uL3V0aWxzL3V1aWRcIjtcblxuY29uc3QgU2NoZW1hID0gbW9uZ29vc2UuU2NoZW1hO1xuY29uc3QgeyBPYmplY3RJZCB9ID0gU2NoZW1hLlR5cGVzO1xuY29uc3QgcmFuZG9tQ29sb3JHZW5lcmF0b3IgPSAoKSA9PiB7XG4gIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxNjc3NzIxNSkudG9TdHJpbmcoMTYpO1xufTtcblxuY29uc3QgVXNlclNjaGVtYSA9IG5ldyBTY2hlbWEoXG4gIHtcbiAgICB1dWlkOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICBkZWZhdWx0OiBnZW5lcmF0ZWRJZCgpLFxuICAgICAgdW5pcXVlOiB0cnVlLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBsb2NhbGU6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgZGVmYXVsdDogXCJ0clwiLFxuICAgICAgZW51bTogW1widHJcIiwgXCJlblwiXSxcbiAgICB9LFxuICAgIHJvbGU6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgZGVmYXVsdDogXCJ1c2VyXCIsXG4gICAgICBlbnVtOiBbXCJ1c2VyXCIsIFwiYWRtaW5cIl0sXG4gICAgfSxcbiAgICBuYW1lOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIHN1cm5hbWU6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgZW1haWw6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgdW5pcXVlOiB0cnVlLFxuICAgIH0sXG4gICAgcGhvbmVOdW1iZXI6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgdW5pcXVlOiB0cnVlLFxuICAgIH0sXG4gICAgaWRlbnRpdHlOdW1iZXI6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgZGVmYXVsdDogXCIwMDAwMDAwMDAwMFwiLFxuICAgIH0sXG4gICAgcGFzc3dvcmQ6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgYXZhdGFyQ29sb3I6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIGRlZmF1bHQ6IHJhbmRvbUNvbG9yR2VuZXJhdG9yKCksXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGFkZHJlc3M6IHtcbiAgICAgIC8vZmF0dXJhIHZlIHNpcGFyacWfIGFkcmVzaSBkaXllIGlraXllIGF5csSxbGFiaWxpclxuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBjaXR5OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGNvdW50cnk6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgZGVmYXVsdDogXCJUdXJrZXlcIixcbiAgICB9LFxuICAgIHppcENvZGU6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgaXA6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgLy9kZWZhdWx0OiBcIjg1LjM0Ljc4LjExMlwiLCAvL2NpaGF6xLFuIGlwJ3NpbmkgYWzEsXJcbiAgICB9LFxuICAgIGlzVmVyaWZpZWQ6IHtcbiAgICAgIHR5cGU6IEJvb2xlYW4sXG4gICAgICBkZWZhdWx0OiBmYWxzZSxcbiAgICB9LFxuICAgIGNhcmRVc2VyS2V5OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICB1bmlxdWU6IHRydWUsXG4gICAgfSxcbiAgfSxcbiAge1xuICAgIF9pZDogdHJ1ZSxcbiAgICBjb2xsZWN0aW9uOiBcInVzZXJzXCIsXG4gICAgdGltZXN0YW1wczogdHJ1ZSxcbiAgICB0b0pTT046IHtcbiAgICAgIHRyYW5zZm9ybTogKGRvYywgcmV0KSA9PiB7XG4gICAgICAgIGRlbGV0ZSByZXQuX192O1xuICAgICAgICBkZWxldGUgcmV0LnBhc3N3b3JkO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLnJldCxcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgfSxcbiAgfVxuKTtcblxuVXNlclNjaGVtYS5wcmUoXCJzYXZlXCIsIGFzeW5jIGZ1bmN0aW9uIChuZXh0KSB7XG4gIHRyeSB7XG4gICAgLy8gdGhpcy5wYXNzd29yZCA9IGF3YWl0IGJjcnlwdC5oYXNoKHRoaXMucGFzc3dvcmQsIDEwKTtcbiAgICBpZiAodGhpcy5pc01vZGlmaWVkKFwicGFzc3dvcmRcIikpIHtcbiAgICAgIC8vcGFzc3dvcmQgaW5jb3JyZWN0IGhhdGFzxLFuxLEgYsO2eWxlIMOnw7Z6ZMO8a1xuICAgICAgdGhpcy5wYXNzd29yZCA9IGF3YWl0IGJjcnlwdC5oYXNoKHRoaXMucGFzc3dvcmQsIDEwKTtcbiAgICB9XG4gICAgcmV0dXJuIG5leHQoKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgcmV0dXJuIG5leHQoZXJyKTtcbiAgfVxuICBuZXh0KCk7XG59KTtcbmNvbnN0IFVzZXJzID0gbW9uZ29vc2UubW9kZWwoXCJVc2Vyc1wiLCBVc2VyU2NoZW1hKTtcblxuZXhwb3J0IGRlZmF1bHQgVXNlcnM7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFNBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLEtBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUF3QyxTQUFBRCx1QkFBQUksQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFB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","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","_bcryptjs","_uuid","e","__esModule","default","Schema","mongoose","ObjectId","Types","randomColorGenerator","Math","floor","random","toString","UserSchema","uuid","type","String","generatedId","unique","required","locale","enum","role","name","surname","email","phoneNumber","identityNumber","password","avatarColor","address","city","country","zipCode","ip","isVerified","Boolean","cardUserKey","_id","collection","timestamps","toJSON","transform","doc","ret","__v","pre","next","isModified","bcrypt","hash","err","Users","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["users.js"],"sourcesContent":["import mongoose from \"mongoose\";\nimport bcrypt from \"bcryptjs\";\nimport generatedId from \"../utils/uuid\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\nconst randomColorGenerator = () => {\n  return Math.floor(Math.random() * 16777215).toString(16);\n};\n\nconst UserSchema = new Schema(\n  {\n    uuid: {\n      type: String,\n      default: generatedId(),\n      unique: true,\n      required: true,\n    },\n    locale: {\n      type: String,\n      required: true,\n      default: \"tr\",\n      enum: [\"tr\", \"en\"],\n    },\n    role: {\n      type: String,\n      required: true,\n      default: \"user\",\n      enum: [\"user\", \"admin\"],\n    },\n    name: {\n      type: String,\n      required: true,\n    },\n    surname: {\n      type: String,\n      required: true,\n    },\n    email: {\n      type: String,\n      required: true,\n      unique: true,\n    },\n    phoneNumber: {\n      type: String,\n      required: true,\n      unique: true,\n    },\n    identityNumber: {\n      type: String,\n      required: true,\n      default: \"00000000000\",\n    },\n    password: {\n      type: String,\n      required: true,\n    },\n    avatarColor: {\n      type: String,\n      default: randomColorGenerator(),\n      required: true,\n    },\n    address: {\n      //fatura ve sipariş adresi diye ikiye ayrılabilir\n      type: String,\n      required: true,\n    },\n    city: {\n      type: String,\n      required: true,\n    },\n    country: {\n      type: String,\n      required: true,\n      default: \"Turkey\",\n    },\n    zipCode: {\n      type: String,\n      required: true,\n    },\n    ip: {\n      type: String,\n      required: true,\n      //default: \"85.34.78.112\", //cihazın ip'sini alır\n    },\n    isVerified: {\n      type: Boolean,\n      default: false,\n    },\n    cardUserKey: {\n      type: String,\n      required: false,\n      unique: true,\n    },\n  },\n  {\n    _id: true,\n    collection: \"users\",\n    timestamps: true,\n    toJSON: {\n      transform: (doc, ret) => {\n        delete ret.__v;\n        delete ret.password;\n        return {\n          ...ret,\n        };\n      },\n    },\n  }\n);\n\nUserSchema.pre(\"save\", async function (next) {\n  try {\n    // this.password = await bcrypt.hash(this.password, 10);\n    if (this.isModified(\"password\")) {\n      //password incorrect hatasını böyle çözdük\n      this.password = await bcrypt.hash(this.password, 10);\n    }\n    return next();\n  } catch (err) {\n    return next(err);\n  }\n  next();\n});\nconst Users = mongoose.model(\"Users\", UserSchema);\n\nexport default Users;\n"],"mappings":"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","ignoreList":[]}},"mtime":1721312705756},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/errors/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/errors/ApiError.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nclass ApiError extends Error {\n  constructor(message, status = 500, code) {\n    super(message);\n    this.status = status;\n    this.code = code;\n    this.name = this.constructor.name;\n    Error.captureStackTrace(this, this.constructor);\n  }\n}\nvar _default = exports.default = ApiError;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJBcGlFcnJvciIsIkVycm9yIiwiY29uc3RydWN0b3IiLCJtZXNzYWdlIiwic3RhdHVzIiwiY29kZSIsIm5hbWUiLCJjYXB0dXJlU3RhY2tUcmFjZSIsIl9kZWZhdWx0IiwiZXhwb3J0cyIsImRlZmF1bHQiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9lcnJvcnMvIiwic291cmNlcyI6WyJBcGlFcnJvci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBBcGlFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3IobWVzc2FnZSwgc3RhdHVzID0gNTAwLCBjb2RlKSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG4gICAgdGhpcy5zdGF0dXMgPSBzdGF0dXM7XG4gICAgdGhpcy5jb2RlID0gY29kZTtcbiAgICB0aGlzLm5hbWUgPSB0aGlzLmNvbnN0cnVjdG9yLm5hbWU7XG4gICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UodGhpcywgdGhpcy5jb25zdHJ1Y3Rvcik7XG4gIH1cbn1cbmV4cG9ydCBkZWZhdWx0IEFwaUVycm9yO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxNQUFNQSxRQUFRLFNBQVNDLEtBQUssQ0FBQztFQUMzQkMsV0FBV0EsQ0FBQ0MsT0FBTyxFQUFFQyxNQUFNLEdBQUcsR0FBRyxFQUFFQyxJQUFJLEVBQUU7SUFDdkMsS0FBSyxDQUFDRixPQUFPLENBQUM7SUFDZCxJQUFJLENBQUNDLE1BQU0sR0FBR0EsTUFBTTtJQUNwQixJQUFJLENBQUNDLElBQUksR0FBR0EsSUFBSTtJQUNoQixJQUFJLENBQUNDLElBQUksR0FBRyxJQUFJLENBQUNKLFdBQVcsQ0FBQ0ksSUFBSTtJQUNqQ0wsS0FBSyxDQUFDTSxpQkFBaUIsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDTCxXQUFXLENBQUM7RUFDakQ7QUFDRjtBQUFDLElBQUFNLFFBQUEsR0FBQUMsT0FBQSxDQUFBQyxPQUFBLEdBQ2NWLFFBQVEiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["ApiError","Error","constructor","message","status","code","name","captureStackTrace","_default","exports","default"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/errors/","sources":["ApiError.js"],"sourcesContent":["class ApiError extends Error {\n  constructor(message, status = 500, code) {\n    super(message);\n    this.status = status;\n    this.code = code;\n    this.name = this.constructor.name;\n    Error.captureStackTrace(this, this.constructor);\n  }\n}\nexport default ApiError;\n"],"mappings":";;;;;;AAAA,MAAMA,QAAQ,SAASC,KAAK,CAAC;EAC3BC,WAAWA,CAACC,OAAO,EAAEC,MAAM,GAAG,GAAG,EAAEC,IAAI,EAAE;IACvC,KAAK,CAACF,OAAO,CAAC;IACd,IAAI,CAACC,MAAM,GAAGA,MAAM;IACpB,IAAI,CAACC,IAAI,GAAGA,IAAI;IAChB,IAAI,CAACC,IAAI,GAAG,IAAI,CAACJ,WAAW,CAACI,IAAI;IACjCL,KAAK,CAACM,iBAAiB,CAAC,IAAI,EAAE,IAAI,CAACL,WAAW,CAAC;EACjD;AACF;AAAC,IAAAM,QAAA,GAAAC,OAAA,CAAAC,OAAA,GACcV,QAAQ","ignoreList":[]}},"mtime":1721043478453},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/utils/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/utils/uuid.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _uuid = require(\"uuid\");\n//burada modellerdeki uuid verisini dolduracak id üretilir(iyzipay için gerekli)\nconst id = () => (0, _uuid.v4)();\nvar _default = exports.default = id;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfdXVpZCIsInJlcXVpcmUiLCJpZCIsInV1aWR2NCIsIl9kZWZhdWx0IiwiZXhwb3J0cyIsImRlZmF1bHQiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy91dGlscy8iLCJzb3VyY2VzIjpbInV1aWQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdjQgYXMgdXVpZHY0IH0gZnJvbSBcInV1aWRcIjtcbi8vYnVyYWRhIG1vZGVsbGVyZGVraSB1dWlkIHZlcmlzaW5pIGRvbGR1cmFjYWsgaWQgw7xyZXRpbGlyKGl5emlwYXkgacOnaW4gZ2VyZWtsaSlcbmNvbnN0IGlkID0gKCkgPT4gdXVpZHY0KCk7XG5cbmV4cG9ydCBkZWZhdWx0IGlkO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxLQUFBLEdBQUFDLE9BQUE7QUFDQTtBQUNBLE1BQU1DLEVBQUUsR0FBR0EsQ0FBQSxLQUFNLElBQUFDLFFBQU0sRUFBQyxDQUFDO0FBQUMsSUFBQUMsUUFBQSxHQUFBQyxPQUFBLENBQUFDLE9BQUEsR0FFWEosRUFBRSIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_uuid","require","id","uuidv4","_default","exports","default"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/utils/","sources":["uuid.js"],"sourcesContent":["import { v4 as uuidv4 } from \"uuid\";\n//burada modellerdeki uuid verisini dolduracak id üretilir(iyzipay için gerekli)\nconst id = () => uuidv4();\n\nexport default id;\n"],"mappings":";;;;;;AAAA,IAAAA,KAAA,GAAAC,OAAA;AACA;AACA,MAAMC,EAAE,GAAGA,CAAA,KAAM,IAAAC,QAAM,EAAC,CAAC;AAAC,IAAAC,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEXJ,EAAE","ignoreList":[]}},"mtime":1721312705758},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _users = _interopRequireDefault(require(\"./users\"));\nvar _products = _interopRequireDefault(require(\"./products\"));\nvar _cart = _interopRequireDefault(require(\"./cart\"));\nvar _paymentSuccess = _interopRequireDefault(require(\"./payment-success\"));\nvar _paymentFailed = _interopRequireDefault(require(\"./payment-failed\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = exports.default = [_users.default, _products.default, _cart.default, _paymentFailed.default, _paymentSuccess.default];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfdXNlcnMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9wcm9kdWN0cyIsIl9jYXJ0IiwiX3BheW1lbnRTdWNjZXNzIiwiX3BheW1lbnRGYWlsZWQiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfZGVmYXVsdCIsImV4cG9ydHMiLCJVc2VycyIsIlByb2R1Y3RzIiwiQ2FydCIsIlBheW1lbnRGYWlsZWQiLCJQYXltZW50U3VjY2VzcyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL2RiLyIsInNvdXJjZXMiOlsiaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFVzZXJzIGZyb20gXCIuL3VzZXJzXCI7XG5pbXBvcnQgUHJvZHVjdHMgZnJvbSBcIi4vcHJvZHVjdHNcIjtcbmltcG9ydCBDYXJ0IGZyb20gXCIuL2NhcnRcIjtcbmltcG9ydCBQYXltZW50U3VjY2VzcyBmcm9tIFwiLi9wYXltZW50LXN1Y2Nlc3NcIjtcbmltcG9ydCBQYXltZW50RmFpbGVkIGZyb20gXCIuL3BheW1lbnQtZmFpbGVkXCI7XG5cbmV4cG9ydCBkZWZhdWx0IFtVc2VycywgUHJvZHVjdHMsIENhcnQsIFBheW1lbnRGYWlsZWQsIFBheW1lbnRTdWNjZXNzXTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsTUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsU0FBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsS0FBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUcsZUFBQSxHQUFBSixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUksY0FBQSxHQUFBTCxzQkFBQSxDQUFBQyxPQUFBO0FBQTZDLFNBQUFELHVCQUFBTSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBQUEsSUFBQUcsUUFBQSxHQUFBQyxPQUFBLENBQUFGLE9BQUEsR0FFOUIsQ0FBQ0csY0FBSyxFQUFFQyxpQkFBUSxFQUFFQyxhQUFJLEVBQUVDLHNCQUFhLEVBQUVDLHVCQUFjLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_users","_interopRequireDefault","require","_products","_cart","_paymentSuccess","_paymentFailed","e","__esModule","default","_default","exports","Users","Products","Cart","PaymentFailed","PaymentSuccess"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["index.js"],"sourcesContent":["import Users from \"./users\";\nimport Products from \"./products\";\nimport Cart from \"./cart\";\nimport PaymentSuccess from \"./payment-success\";\nimport PaymentFailed from \"./payment-failed\";\n\nexport default [Users, Products, Cart, PaymentFailed, PaymentSuccess];\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,KAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,eAAA,GAAAJ,sBAAA,CAAAC,OAAA;AACA,IAAAI,cAAA,GAAAL,sBAAA,CAAAC,OAAA;AAA6C,SAAAD,uBAAAM,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAAA,IAAAG,QAAA,GAAAC,OAAA,CAAAF,OAAA,GAE9B,CAACG,cAAK,EAAEC,iBAAQ,EAAEC,aAAI,EAAEC,sBAAa,EAAEC,uBAAc,CAAC","ignoreList":[]}},"mtime":1723544062250},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/Session.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _passport = _interopRequireDefault(require(\"passport\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Session = _passport.default.authenticate(\"jwt\", {\n  session: false\n});\nvar _default = exports.default = Session;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcGFzc3BvcnQiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIlNlc3Npb24iLCJwYXNzcG9ydCIsImF1dGhlbnRpY2F0ZSIsInNlc3Npb24iLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9taWRkbGV3YXJlcy8iLCJzb3VyY2VzIjpbIlNlc3Npb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHBhc3Nwb3J0IGZyb20gXCJwYXNzcG9ydFwiO1xuXG5jb25zdCBTZXNzaW9uID0gcGFzc3BvcnQuYXV0aGVudGljYXRlKFwiand0XCIsIHsgc2Vzc2lvbjogZmFsc2UgfSk7XG5cbmV4cG9ydCBkZWZhdWx0IFNlc3Npb247XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUFnQyxTQUFBRCx1QkFBQUUsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUVoQyxNQUFNRyxPQUFPLEdBQUdDLGlCQUFRLENBQUNDLFlBQVksQ0FBQyxLQUFLLEVBQUU7RUFBRUMsT0FBTyxFQUFFO0FBQU0sQ0FBQyxDQUFDO0FBQUMsSUFBQUMsUUFBQSxHQUFBQyxPQUFBLENBQUFOLE9BQUEsR0FFbERDLE9BQU8iLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_passport","_interopRequireDefault","require","e","__esModule","default","Session","passport","authenticate","session","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["Session.js"],"sourcesContent":["import passport from \"passport\";\n\nconst Session = passport.authenticate(\"jwt\", { session: false });\n\nexport default Session;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AAAgC,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEhC,MAAMG,OAAO,GAAGC,iBAAQ,CAACC,YAAY,CAAC,KAAK,EAAE;EAAEC,OAAO,EAAE;AAAM,CAAC,CAAC;AAAC,IAAAC,QAAA,GAAAC,OAAA,CAAAN,OAAA,GAElDC,OAAO","ignoreList":[]}},"mtime":1722848733624},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _Users = _interopRequireDefault(require(\"./Users\"));\nvar _Products = _interopRequireDefault(require(\"./Products\"));\nvar _cart = _interopRequireDefault(require(\"./cart\"));\nvar _payments = _interopRequireDefault(require(\"./payments\"));\nvar _cards = _interopRequireDefault(require(\"./cards\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = exports.default = [_Users.default, _Products.default, _cart.default, _payments.default, _cards.default];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfVXNlcnMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9Qcm9kdWN0cyIsIl9jYXJ0IiwiX3BheW1lbnRzIiwiX2NhcmRzIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiX2RlZmF1bHQiLCJleHBvcnRzIiwidXNlcnMiLCJQcm9kdWN0cyIsImNhcnRzIiwiUGF5bWVudHMiLCJDYXJkcyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3JvdXRlcy8iLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB1c2VycyBmcm9tIFwiLi9Vc2Vyc1wiO1xuaW1wb3J0IFByb2R1Y3RzIGZyb20gXCIuL1Byb2R1Y3RzXCI7XG5pbXBvcnQgY2FydHMgZnJvbSBcIi4vY2FydFwiO1xuaW1wb3J0IFBheW1lbnRzIGZyb20gXCIuL3BheW1lbnRzXCI7XG5pbXBvcnQgQ2FyZHMgZnJvbSBcIi4vY2FyZHNcIjtcbmV4cG9ydCBkZWZhdWx0IFt1c2VycywgUHJvZHVjdHMsIGNhcnRzLCBQYXltZW50cywgQ2FyZHNdO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxNQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxTQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxLQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRyxTQUFBLEdBQUFKLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSSxNQUFBLEdBQUFMLHNCQUFBLENBQUFDLE9BQUE7QUFBNEIsU0FBQUQsdUJBQUFNLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFBQSxJQUFBRyxRQUFBLEdBQUFDLE9BQUEsQ0FBQUYsT0FBQSxHQUNiLENBQUNHLGNBQUssRUFBRUMsaUJBQVEsRUFBRUMsYUFBSyxFQUFFQyxpQkFBUSxFQUFFQyxjQUFLLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_Users","_interopRequireDefault","require","_Products","_cart","_payments","_cards","e","__esModule","default","_default","exports","users","Products","carts","Payments","Cards"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["index.js"],"sourcesContent":["import users from \"./Users\";\nimport Products from \"./Products\";\nimport carts from \"./cart\";\nimport Payments from \"./payments\";\nimport Cards from \"./cards\";\nexport default [users, Products, carts, Payments, Cards];\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,KAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,SAAA,GAAAJ,sBAAA,CAAAC,OAAA;AACA,IAAAI,MAAA,GAAAL,sBAAA,CAAAC,OAAA;AAA4B,SAAAD,uBAAAM,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAAA,IAAAG,QAAA,GAAAC,OAAA,CAAAF,OAAA,GACb,CAACG,cAAK,EAAEC,iBAAQ,EAAEC,aAAK,EAAEC,iBAAQ,EAAEC,cAAK,CAAC","ignoreList":[]}},"mtime":1723548998209},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/Users.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\nvar _getUserIP = _interopRequireDefault(require(\"../middlewares/getUserIP\"));\nvar _VerificationEmail = _interopRequireDefault(require(\"../middlewares/VerificationEmail\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\n//silinebilir çalışmazsa\nvar _default = router => {\n  router.post(\"/register\", _getUserIP.default, async (req, res, next) => {\n    const {\n      email,\n      name,\n      surname,\n      phoneNumber,\n      password,\n      address,\n      city,\n      country,\n      zipCode\n    } = req.body;\n    if (!email) {\n      return res.status(400).send(new _ApiError.default(400, \"E-posta gereklidir\"));\n    }\n    const existingUser = await _users.default.findOne({\n      email\n    });\n    if (existingUser) {\n      return res.status(400).send(new _ApiError.default(400, \"Bu e-posta zaten kullanılıyor\"));\n    }\n    const user = new _users.default({\n      email,\n      name,\n      surname,\n      phoneNumber,\n      password,\n      address,\n      city,\n      country,\n      zipCode,\n      ip: req.userIp // Kullanıcı IP'sini ekle\n    });\n    try {\n      await user.save();\n      req.user = user;\n      next();\n      // return res\n      //   .status(200)\n      //   .json(`${email} mail adresi ile kullanıcı oluşturuldu.`);\n    } catch (error) {\n      console.log(error);\n      return res.status(500).send(new _ApiError.default(500, \"Kayıt işlemi sırasında hata oluştu\"));\n    }\n  }, _VerificationEmail.default,\n  //silinebilir çalışmazsa\n  (req, res) => {\n    return res.status(200).json(`${req.user.email} mail adresi ile kullanıcı oluşturuldu. Lütfen E-postanızı doğrulayınız.` //middlewaredeki üretilen jwtyi konsola yazdır\n    );\n  });\n\n  //silinebilir çalışmazsa\n  router.get(\"/verify-email/\", async (req, res) => {\n    const {\n      token\n    } = req.query;\n    if (!token) {\n      return res.status(400).send(new _ApiError.default(400, \"Token gereklidir\"));\n    }\n    try {\n      const decoded = _jsonwebtoken.default.verify(token, process.env.JWT_SECRET);\n      const user = await _users.default.findById(decoded.id);\n      if (!user) {\n        return res.status(400).send(new _ApiError.default(400, \"Kullanıcı bulunamadı\"));\n      }\n      if (user.isVerified) {\n        return res.status(400).send(new _ApiError.default(400, \"Kullanıcı zaten doğrulanmış\"));\n      }\n      user.isVerified = true;\n      await user.save();\n      return res.sendFile(\"verification-success.html\", {\n        root: \"public\"\n      });\n    } catch (error) {\n      console.log(error);\n      return res.status(500).send(new _ApiError.default(500, \"Doğrulama işlemi sırasında hata oluştu\"));\n    }\n  });\n  router.post(\"/login\", async (req, res) => {\n    const {\n      email,\n      password\n    } = req.body;\n    const user = await _users.default.findOne({\n      email\n    });\n    if (!email || !password) {\n      throw new _ApiError.default(\"Email and Password is required\", 401, \"requiredEmailAndPassword\");\n    }\n    if (!user) {\n      throw new _ApiError.default(\"Incorrect Password or email2\", 401, \"userOrPasswordIncorrect\");\n    }\n    if (user.isVerified == false) {\n      throw new _ApiError.default(\"You have to verificate your account.\", 401, \"accountNotVerified\");\n    }\n    const passwordConfirmed = await _bcryptjs.default.compare(password, user.password);\n    // console.log(\"kullanıcı girdisi:\", password); silinecekler\n    // console.log(\"hashlenmiş hali:\", user.password);\n\n    if (passwordConfirmed) {\n      const userJson = user.toJSON();\n      const token = _jsonwebtoken.default.sign(userJson, process.env.JWT_SECRET);\n      res.json({\n        token: `Bearer ${token}`,\n        user: userJson\n      });\n    } else {\n      throw new _ApiError.default(\"Incorrect Password or email\", 401, \"userOrPasswordIncorrect\");\n    }\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfdXNlcnMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9BcGlFcnJvciIsIl9iY3J5cHRqcyIsIl9qc29ud2VidG9rZW4iLCJfZ2V0VXNlcklQIiwiX1ZlcmlmaWNhdGlvbkVtYWlsIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiX2RlZmF1bHQiLCJyb3V0ZXIiLCJwb3N0IiwiZ2V0VXNlcklwIiwicmVxIiwicmVzIiwibmV4dCIsImVtYWlsIiwibmFtZSIsInN1cm5hbWUiLCJwaG9uZU51bWJlciIsInBhc3N3b3JkIiwiYWRkcmVzcyIsImNpdHkiLCJjb3VudHJ5IiwiemlwQ29kZSIsImJvZHkiLCJzdGF0dXMiLCJzZW5kIiwiQXBpRXJyb3IiLCJleGlzdGluZ1VzZXIiLCJVc2VycyIsImZpbmRPbmUiLCJ1c2VyIiwiaXAiLCJ1c2VySXAiLCJzYXZlIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwic2VuZFZlcmlmaWNhdGlvbkVtYWlsIiwianNvbiIsImdldCIsInRva2VuIiwicXVlcnkiLCJkZWNvZGVkIiwiand0IiwidmVyaWZ5IiwicHJvY2VzcyIsImVudiIsIkpXVF9TRUNSRVQiLCJmaW5kQnlJZCIsImlkIiwiaXNWZXJpZmllZCIsInNlbmRGaWxlIiwicm9vdCIsInBhc3N3b3JkQ29uZmlybWVkIiwiYmNyeXB0IiwiY29tcGFyZSIsInVzZXJKc29uIiwidG9KU09OIiwic2lnbiIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9yb3V0ZXMvIiwic291cmNlcyI6WyJVc2Vycy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgVXNlcnMgZnJvbSBcIi4uL2RiL3VzZXJzXCI7XG5pbXBvcnQgQXBpRXJyb3IgZnJvbSBcIi4uL2Vycm9ycy9BcGlFcnJvclwiO1xuaW1wb3J0IGJjcnlwdCBmcm9tIFwiYmNyeXB0anNcIjtcbmltcG9ydCBqd3QgZnJvbSBcImpzb253ZWJ0b2tlblwiO1xuaW1wb3J0IGdldFVzZXJJcCBmcm9tIFwiLi4vbWlkZGxld2FyZXMvZ2V0VXNlcklQXCI7XG5pbXBvcnQgc2VuZFZlcmlmaWNhdGlvbkVtYWlsIGZyb20gXCIuLi9taWRkbGV3YXJlcy9WZXJpZmljYXRpb25FbWFpbFwiOyAvL3NpbGluZWJpbGlyIMOnYWzEscWfbWF6c2FcblxuZXhwb3J0IGRlZmF1bHQgKHJvdXRlcikgPT4ge1xuICByb3V0ZXIucG9zdChcbiAgICBcIi9yZWdpc3RlclwiLFxuICAgIGdldFVzZXJJcCxcbiAgICBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgZW1haWwsXG4gICAgICAgIG5hbWUsXG4gICAgICAgIHN1cm5hbWUsXG4gICAgICAgIHBob25lTnVtYmVyLFxuICAgICAgICBwYXNzd29yZCxcbiAgICAgICAgYWRkcmVzcyxcbiAgICAgICAgY2l0eSxcbiAgICAgICAgY291bnRyeSxcbiAgICAgICAgemlwQ29kZSxcbiAgICAgIH0gPSByZXEuYm9keTtcblxuICAgICAgaWYgKCFlbWFpbCkge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQobmV3IEFwaUVycm9yKDQwMCwgXCJFLXBvc3RhIGdlcmVrbGlkaXJcIikpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBleGlzdGluZ1VzZXIgPSBhd2FpdCBVc2Vycy5maW5kT25lKHsgZW1haWwgfSk7XG4gICAgICBpZiAoZXhpc3RpbmdVc2VyKSB7XG4gICAgICAgIHJldHVybiByZXNcbiAgICAgICAgICAuc3RhdHVzKDQwMClcbiAgICAgICAgICAuc2VuZChuZXcgQXBpRXJyb3IoNDAwLCBcIkJ1IGUtcG9zdGEgemF0ZW4ga3VsbGFuxLFsxLF5b3JcIikpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB1c2VyID0gbmV3IFVzZXJzKHtcbiAgICAgICAgZW1haWwsXG4gICAgICAgIG5hbWUsXG4gICAgICAgIHN1cm5hbWUsXG4gICAgICAgIHBob25lTnVtYmVyLFxuICAgICAgICBwYXNzd29yZCxcbiAgICAgICAgYWRkcmVzcyxcbiAgICAgICAgY2l0eSxcbiAgICAgICAgY291bnRyeSxcbiAgICAgICAgemlwQ29kZSxcbiAgICAgICAgaXA6IHJlcS51c2VySXAsIC8vIEt1bGxhbsSxY8SxIElQJ3NpbmkgZWtsZVxuICAgICAgfSk7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHVzZXIuc2F2ZSgpO1xuICAgICAgICByZXEudXNlciA9IHVzZXI7XG4gICAgICAgIG5leHQoKTtcbiAgICAgICAgLy8gcmV0dXJuIHJlc1xuICAgICAgICAvLyAgIC5zdGF0dXMoMjAwKVxuICAgICAgICAvLyAgIC5qc29uKGAke2VtYWlsfSBtYWlsIGFkcmVzaSBpbGUga3VsbGFuxLFjxLEgb2x1xZ90dXJ1bGR1LmApO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICByZXR1cm4gcmVzXG4gICAgICAgICAgLnN0YXR1cyg1MDApXG4gICAgICAgICAgLnNlbmQobmV3IEFwaUVycm9yKDUwMCwgXCJLYXnEsXQgacWfbGVtaSBzxLFyYXPEsW5kYSBoYXRhIG9sdcWfdHVcIikpO1xuICAgICAgfVxuICAgIH0sXG4gICAgc2VuZFZlcmlmaWNhdGlvbkVtYWlsLCAvL3NpbGluZWJpbGlyIMOnYWzEscWfbWF6c2FcbiAgICAocmVxLCByZXMpID0+IHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbihcbiAgICAgICAgYCR7cmVxLnVzZXIuZW1haWx9IG1haWwgYWRyZXNpIGlsZSBrdWxsYW7EsWPEsSBvbHXFn3R1cnVsZHUuIEzDvHRmZW4gRS1wb3N0YW7EsXrEsSBkb8SfcnVsYXnEsW7EsXouYCAvL21pZGRsZXdhcmVkZWtpIMO8cmV0aWxlbiBqd3R5aSBrb25zb2xhIHlhemTEsXJcbiAgICAgICk7XG4gICAgfVxuICApO1xuXG4gIC8vc2lsaW5lYmlsaXIgw6dhbMSxxZ9tYXpzYVxuICByb3V0ZXIuZ2V0KFwiL3ZlcmlmeS1lbWFpbC9cIiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyB0b2tlbiB9ID0gcmVxLnF1ZXJ5O1xuXG4gICAgaWYgKCF0b2tlbikge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKG5ldyBBcGlFcnJvcig0MDAsIFwiVG9rZW4gZ2VyZWtsaWRpclwiKSk7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGRlY29kZWQgPSBqd3QudmVyaWZ5KHRva2VuLCBwcm9jZXNzLmVudi5KV1RfU0VDUkVUKTtcbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2Vycy5maW5kQnlJZChkZWNvZGVkLmlkKTtcbiAgICAgIGlmICghdXNlcikge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQobmV3IEFwaUVycm9yKDQwMCwgXCJLdWxsYW7EsWPEsSBidWx1bmFtYWTEsVwiKSk7XG4gICAgICB9XG5cbiAgICAgIGlmICh1c2VyLmlzVmVyaWZpZWQpIHtcbiAgICAgICAgcmV0dXJuIHJlc1xuICAgICAgICAgIC5zdGF0dXMoNDAwKVxuICAgICAgICAgIC5zZW5kKG5ldyBBcGlFcnJvcig0MDAsIFwiS3VsbGFuxLFjxLEgemF0ZW4gZG/En3J1bGFubcSxxZ9cIikpO1xuICAgICAgfVxuXG4gICAgICB1c2VyLmlzVmVyaWZpZWQgPSB0cnVlO1xuICAgICAgYXdhaXQgdXNlci5zYXZlKCk7XG5cbiAgICAgIHJldHVybiByZXMuc2VuZEZpbGUoXCJ2ZXJpZmljYXRpb24tc3VjY2Vzcy5odG1sXCIsIHsgcm9vdDogXCJwdWJsaWNcIiB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgcmV0dXJuIHJlc1xuICAgICAgICAuc3RhdHVzKDUwMClcbiAgICAgICAgLnNlbmQobmV3IEFwaUVycm9yKDUwMCwgXCJEb8SfcnVsYW1hIGnFn2xlbWkgc8SxcmFzxLFuZGEgaGF0YSBvbHXFn3R1XCIpKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJvdXRlci5wb3N0KFwiL2xvZ2luXCIsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGNvbnN0IHsgZW1haWwsIHBhc3N3b3JkIH0gPSByZXEuYm9keTtcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlcnMuZmluZE9uZSh7IGVtYWlsIH0pO1xuXG4gICAgaWYgKCFlbWFpbCB8fCAhcGFzc3dvcmQpIHtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgXCJFbWFpbCBhbmQgUGFzc3dvcmQgaXMgcmVxdWlyZWRcIixcbiAgICAgICAgNDAxLFxuICAgICAgICBcInJlcXVpcmVkRW1haWxBbmRQYXNzd29yZFwiXG4gICAgICApO1xuICAgIH1cblxuICAgIGlmICghdXNlcikge1xuICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICBcIkluY29ycmVjdCBQYXNzd29yZCBvciBlbWFpbDJcIixcbiAgICAgICAgNDAxLFxuICAgICAgICBcInVzZXJPclBhc3N3b3JkSW5jb3JyZWN0XCJcbiAgICAgICk7XG4gICAgfVxuICAgIGlmICh1c2VyLmlzVmVyaWZpZWQgPT0gZmFsc2UpIHtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgXCJZb3UgaGF2ZSB0byB2ZXJpZmljYXRlIHlvdXIgYWNjb3VudC5cIixcbiAgICAgICAgNDAxLFxuICAgICAgICBcImFjY291bnROb3RWZXJpZmllZFwiXG4gICAgICApO1xuICAgIH1cbiAgICBjb25zdCBwYXNzd29yZENvbmZpcm1lZCA9IGF3YWl0IGJjcnlwdC5jb21wYXJlKHBhc3N3b3JkLCB1c2VyLnBhc3N3b3JkKTtcbiAgICAvLyBjb25zb2xlLmxvZyhcImt1bGxhbsSxY8SxIGdpcmRpc2k6XCIsIHBhc3N3b3JkKTsgc2lsaW5lY2VrbGVyXG4gICAgLy8gY29uc29sZS5sb2coXCJoYXNobGVubWnFnyBoYWxpOlwiLCB1c2VyLnBhc3N3b3JkKTtcblxuICAgIGlmIChwYXNzd29yZENvbmZpcm1lZCkge1xuICAgICAgY29uc3QgdXNlckpzb24gPSB1c2VyLnRvSlNPTigpO1xuICAgICAgY29uc3QgdG9rZW4gPSBqd3Quc2lnbih1c2VySnNvbiwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCk7XG4gICAgICByZXMuanNvbih7XG4gICAgICAgIHRva2VuOiBgQmVhcmVyICR7dG9rZW59YCxcbiAgICAgICAgdXNlcjogdXNlckpzb24sXG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICBcIkluY29ycmVjdCBQYXNzd29yZCBvciBlbWFpbFwiLFxuICAgICAgICA0MDEsXG4gICAgICAgIFwidXNlck9yUGFzc3dvcmRJbmNvcnJlY3RcIlxuICAgICAgKTtcbiAgICB9XG4gIH0pO1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsTUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsU0FBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsU0FBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUcsYUFBQSxHQUFBSixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUksVUFBQSxHQUFBTCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUssa0JBQUEsR0FBQU4sc0JBQUEsQ0FBQUMsT0FBQTtBQUFxRSxTQUFBRCx1QkFBQU8sQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUFDO0FBQUEsSUFBQUcsUUFBQSxHQUV0REMsTUFBTSxJQUFLO0VBQ3pCQSxNQUFNLENBQUNDLElBQUksQ0FDVCxXQUFXLEVBQ1hDLGtCQUFTLEVBQ1QsT0FBT0MsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksS0FBSztJQUN4QixNQUFNO01BQ0pDLEtB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","map":{"version":3,"names":["_users","_interopRequireDefault","require","_ApiError","_bcryptjs","_jsonwebtoken","_getUserIP","_VerificationEmail","e","__esModule","default","_default","router","post","getUserIp","req","res","next","email","name","surname","phoneNumber","password","address","city","country","zipCode","body","status","send","ApiError","existingUser","Users","findOne","user","ip","userIp","save","error","console","log","sendVerificationEmail","json","get","token","query","decoded","jwt","verify","process","env","JWT_SECRET","findById","id","isVerified","sendFile","root","passwordConfirmed","bcrypt","compare","userJson","toJSON","sign","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["Users.js"],"sourcesContent":["import Users from \"../db/users\";\nimport ApiError from \"../errors/ApiError\";\nimport bcrypt from \"bcryptjs\";\nimport jwt from \"jsonwebtoken\";\nimport getUserIp from \"../middlewares/getUserIP\";\nimport sendVerificationEmail from \"../middlewares/VerificationEmail\"; //silinebilir çalışmazsa\n\nexport default (router) => {\n  router.post(\n    \"/register\",\n    getUserIp,\n    async (req, res, next) => {\n      const {\n        email,\n        name,\n        surname,\n        phoneNumber,\n        password,\n        address,\n        city,\n        country,\n        zipCode,\n      } = req.body;\n\n      if (!email) {\n        return res.status(400).send(new ApiError(400, \"E-posta gereklidir\"));\n      }\n\n      const existingUser = await Users.findOne({ email });\n      if (existingUser) {\n        return res\n          .status(400)\n          .send(new ApiError(400, \"Bu e-posta zaten kullanılıyor\"));\n      }\n\n      const user = new Users({\n        email,\n        name,\n        surname,\n        phoneNumber,\n        password,\n        address,\n        city,\n        country,\n        zipCode,\n        ip: req.userIp, // Kullanıcı IP'sini ekle\n      });\n\n      try {\n        await user.save();\n        req.user = user;\n        next();\n        // return res\n        //   .status(200)\n        //   .json(`${email} mail adresi ile kullanıcı oluşturuldu.`);\n      } catch (error) {\n        console.log(error);\n        return res\n          .status(500)\n          .send(new ApiError(500, \"Kayıt işlemi sırasında hata oluştu\"));\n      }\n    },\n    sendVerificationEmail, //silinebilir çalışmazsa\n    (req, res) => {\n      return res.status(200).json(\n        `${req.user.email} mail adresi ile kullanıcı oluşturuldu. Lütfen E-postanızı doğrulayınız.` //middlewaredeki üretilen jwtyi konsola yazdır\n      );\n    }\n  );\n\n  //silinebilir çalışmazsa\n  router.get(\"/verify-email/\", async (req, res) => {\n    const { token } = req.query;\n\n    if (!token) {\n      return res.status(400).send(new ApiError(400, \"Token gereklidir\"));\n    }\n\n    try {\n      const decoded = jwt.verify(token, process.env.JWT_SECRET);\n      const user = await Users.findById(decoded.id);\n      if (!user) {\n        return res.status(400).send(new ApiError(400, \"Kullanıcı bulunamadı\"));\n      }\n\n      if (user.isVerified) {\n        return res\n          .status(400)\n          .send(new ApiError(400, \"Kullanıcı zaten doğrulanmış\"));\n      }\n\n      user.isVerified = true;\n      await user.save();\n\n      return res.sendFile(\"verification-success.html\", { root: \"public\" });\n    } catch (error) {\n      console.log(error);\n      return res\n        .status(500)\n        .send(new ApiError(500, \"Doğrulama işlemi sırasında hata oluştu\"));\n    }\n  });\n\n  router.post(\"/login\", async (req, res) => {\n    const { email, password } = req.body;\n    const user = await Users.findOne({ email });\n\n    if (!email || !password) {\n      throw new ApiError(\n        \"Email and Password is required\",\n        401,\n        \"requiredEmailAndPassword\"\n      );\n    }\n\n    if (!user) {\n      throw new ApiError(\n        \"Incorrect Password or email2\",\n        401,\n        \"userOrPasswordIncorrect\"\n      );\n    }\n    if (user.isVerified == false) {\n      throw new ApiError(\n        \"You have to verificate your account.\",\n        401,\n        \"accountNotVerified\"\n      );\n    }\n    const passwordConfirmed = await bcrypt.compare(password, user.password);\n    // console.log(\"kullanıcı girdisi:\", password); silinecekler\n    // console.log(\"hashlenmiş hali:\", user.password);\n\n    if (passwordConfirmed) {\n      const userJson = user.toJSON();\n      const token = jwt.sign(userJson, process.env.JWT_SECRET);\n      res.json({\n        token: `Bearer ${token}`,\n        user: userJson,\n      });\n    } else {\n      throw new ApiError(\n        \"Incorrect Password or email\",\n        401,\n        \"userOrPasswordIncorrect\"\n      );\n    }\n  });\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1722793365186},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/users.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst randomColorGenerator = () => {\n  return Math.floor(Math.random() * 16777215).toString(16);\n};\nconst UserSchema = new Schema({\n  uuid: {\n    type: String,\n    default: (0, _uuid.default)(),\n    unique: true,\n    required: true\n  },\n  locale: {\n    type: String,\n    required: true,\n    default: \"tr\",\n    enum: [\"tr\", \"en\"]\n  },\n  role: {\n    type: String,\n    required: true,\n    default: \"user\",\n    enum: [\"user\", \"admin\"]\n  },\n  name: {\n    type: String,\n    required: true\n  },\n  surname: {\n    type: String,\n    required: true\n  },\n  email: {\n    type: String,\n    required: true,\n    unique: true\n  },\n  phoneNumber: {\n    type: String,\n    required: true,\n    unique: true\n  },\n  identityNumber: {\n    type: String,\n    required: true,\n    default: \"00000000000\"\n  },\n  password: {\n    type: String,\n    required: true\n  },\n  avatarColor: {\n    type: String,\n    default: randomColorGenerator(),\n    required: true\n  },\n  address: {\n    //fatura ve sipariş adresi diye ikiye ayrılabilir\n    type: String,\n    required: true\n  },\n  city: {\n    type: String,\n    required: true\n  },\n  country: {\n    type: String,\n    required: true,\n    default: \"Turkey\"\n  },\n  zipCode: {\n    type: String,\n    required: true\n  },\n  ip: {\n    type: String,\n    required: true\n    //default: \"85.34.78.112\", //cihazın ip'sini alır\n  },\n  isVerified: {\n    type: Boolean,\n    default: false\n  },\n  cardUserKey: {\n    type: String,\n    required: false,\n    unique: true\n  }\n}, {\n  _id: true,\n  collection: \"users\",\n  timestamps: true,\n  toJSON: {\n    transform: (doc, ret) => {\n      delete ret.__v;\n      delete ret.password;\n      return {\n        ...ret\n      };\n    }\n  }\n});\nUserSchema.pre(\"save\", async function (next) {\n  try {\n    // this.password = await bcrypt.hash(this.password, 10);\n    if (this.isModified(\"password\")) {\n      //password incorrect hatasını böyle çözdük\n      this.password = await _bcryptjs.default.hash(this.password, 10);\n    }\n    return next();\n  } catch (err) {\n    return next(err);\n  }\n  next();\n});\nconst Users = _mongoose.default.model(\"Users\", UserSchema);\nvar _default = exports.default = Users;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9iY3J5cHRqcyIsIl91dWlkIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiU2NoZW1hIiwibW9uZ29vc2UiLCJPYmplY3RJZCIsIlR5cGVzIiwicmFuZG9tQ29sb3JHZW5lcmF0b3IiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJ0b1N0cmluZyIsIlVzZXJTY2hlbWEiLCJ1dWlkIiwidHlwZSIsIlN0cmluZyIsImdlbmVyYXRlZElkIiwidW5pcXVlIiwicmVxdWlyZWQiLCJsb2NhbGUiLCJlbnVtIiwicm9sZSIsIm5hbWUiLCJzdXJuYW1lIiwiZW1haWwiLCJwaG9uZU51bWJlciIsImlkZW50aXR5TnVtYmVyIiwicGFzc3dvcmQiLCJhdmF0YXJDb2xvciIsImFkZHJlc3MiLCJjaXR5IiwiY291bnRyeSIsInppcENvZGUiLCJpcCIsImlzVmVyaWZpZWQiLCJCb29sZWFuIiwiY2FyZFVzZXJLZXkiLCJfaWQiLCJjb2xsZWN0aW9uIiwidGltZXN0YW1wcyIsInRvSlNPTiIsInRyYW5zZm9ybSIsImRvYyIsInJldCIsIl9fdiIsInByZSIsIm5leHQiLCJpc01vZGlmaWVkIiwiYmNyeXB0IiwiaGFzaCIsImVyciIsIlVzZXJzIiwibW9kZWwiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9kYi8iLCJzb3VyY2VzIjpbInVzZXJzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSBmcm9tIFwibW9uZ29vc2VcIjtcbmltcG9ydCBiY3J5cHQgZnJvbSBcImJjcnlwdGpzXCI7XG5pbXBvcnQgZ2VuZXJhdGVkSWQgZnJvbSBcIi4uL3V0aWxzL3V1aWRcIjtcblxuY29uc3QgU2NoZW1hID0gbW9uZ29vc2UuU2NoZW1hO1xuY29uc3QgeyBPYmplY3RJZCB9ID0gU2NoZW1hLlR5cGVzO1xuY29uc3QgcmFuZG9tQ29sb3JHZW5lcmF0b3IgPSAoKSA9PiB7XG4gIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAxNjc3NzIxNSkudG9TdHJpbmcoMTYpO1xufTtcblxuY29uc3QgVXNlclNjaGVtYSA9IG5ldyBTY2hlbWEoXG4gIHtcbiAgICB1dWlkOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICBkZWZhdWx0OiBnZW5lcmF0ZWRJZCgpLFxuICAgICAgdW5pcXVlOiB0cnVlLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBsb2NhbGU6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgZGVmYXVsdDogXCJ0clwiLFxuICAgICAgZW51bTogW1widHJcIiwgXCJlblwiXSxcbiAgICB9LFxuICAgIHJvbGU6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgZGVmYXVsdDogXCJ1c2VyXCIsXG4gICAgICBlbnVtOiBbXCJ1c2VyXCIsIFwiYWRtaW5cIl0sXG4gICAgfSxcbiAgICBuYW1lOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIHN1cm5hbWU6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgZW1haWw6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgdW5pcXVlOiB0cnVlLFxuICAgIH0sXG4gICAgcGhvbmVOdW1iZXI6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgdW5pcXVlOiB0cnVlLFxuICAgIH0sXG4gICAgaWRlbnRpdHlOdW1iZXI6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgZGVmYXVsdDogXCIwMDAwMDAwMDAwMFwiLFxuICAgIH0sXG4gICAgcGFzc3dvcmQ6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgYXZhdGFyQ29sb3I6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIGRlZmF1bHQ6IHJhbmRvbUNvbG9yR2VuZXJhdG9yKCksXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGFkZHJlc3M6IHtcbiAgICAgIC8vZmF0dXJhIHZlIHNpcGFyacWfIGFkcmVzaSBkaXllIGlraXllIGF5csSxbGFiaWxpclxuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBjaXR5OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGNvdW50cnk6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgZGVmYXVsdDogXCJUdXJrZXlcIixcbiAgICB9LFxuICAgIHppcENvZGU6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgaXA6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgLy9kZWZhdWx0OiBcIjg1LjM0Ljc4LjExMlwiLCAvL2NpaGF6xLFuIGlwJ3NpbmkgYWzEsXJcbiAgICB9LFxuICAgIGlzVmVyaWZpZWQ6IHtcbiAgICAgIHR5cGU6IEJvb2xlYW4sXG4gICAgICBkZWZhdWx0OiBmYWxzZSxcbiAgICB9LFxuICAgIGNhcmRVc2VyS2V5OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICB1bmlxdWU6IHRydWUsXG4gICAgfSxcbiAgfSxcbiAge1xuICAgIF9pZDogdHJ1ZSxcbiAgICBjb2xsZWN0aW9uOiBcInVzZXJzXCIsXG4gICAgdGltZXN0YW1wczogdHJ1ZSxcbiAgICB0b0pTT046IHtcbiAgICAgIHRyYW5zZm9ybTogKGRvYywgcmV0KSA9PiB7XG4gICAgICAgIGRlbGV0ZSByZXQuX192O1xuICAgICAgICBkZWxldGUgcmV0LnBhc3N3b3JkO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLnJldCxcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgfSxcbiAgfVxuKTtcblxuVXNlclNjaGVtYS5wcmUoXCJzYXZlXCIsIGFzeW5jIGZ1bmN0aW9uIChuZXh0KSB7XG4gIHRyeSB7XG4gICAgLy8gdGhpcy5wYXNzd29yZCA9IGF3YWl0IGJjcnlwdC5oYXNoKHRoaXMucGFzc3dvcmQsIDEwKTtcbiAgICBpZiAodGhpcy5pc01vZGlmaWVkKFwicGFzc3dvcmRcIikpIHtcbiAgICAgIC8vcGFzc3dvcmQgaW5jb3JyZWN0IGhhdGFzxLFuxLEgYsO2eWxlIMOnw7Z6ZMO8a1xuICAgICAgdGhpcy5wYXNzd29yZCA9IGF3YWl0IGJjcnlwdC5oYXNoKHRoaXMucGFzc3dvcmQsIDEwKTtcbiAgICB9XG4gICAgcmV0dXJuIG5leHQoKTtcbiAgfSBjYXRjaCAoZXJyKSB7XG4gICAgcmV0dXJuIG5leHQoZXJyKTtcbiAgfVxuICBuZXh0KCk7XG59KTtcbmNvbnN0IFVzZXJzID0gbW9uZ29vc2UubW9kZWwoXCJVc2Vyc1wiLCBVc2VyU2NoZW1hKTtcblxuZXhwb3J0IGRlZmF1bHQgVXNlcnM7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFNBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLEtBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUF3QyxTQUFBRCx1QkFBQUksQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFB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","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","_bcryptjs","_uuid","e","__esModule","default","Schema","mongoose","ObjectId","Types","randomColorGenerator","Math","floor","random","toString","UserSchema","uuid","type","String","generatedId","unique","required","locale","enum","role","name","surname","email","phoneNumber","identityNumber","password","avatarColor","address","city","country","zipCode","ip","isVerified","Boolean","cardUserKey","_id","collection","timestamps","toJSON","transform","doc","ret","__v","pre","next","isModified","bcrypt","hash","err","Users","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["users.js"],"sourcesContent":["import mongoose from \"mongoose\";\nimport bcrypt from \"bcryptjs\";\nimport generatedId from \"../utils/uuid\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\nconst randomColorGenerator = () => {\n  return Math.floor(Math.random() * 16777215).toString(16);\n};\n\nconst UserSchema = new Schema(\n  {\n    uuid: {\n      type: String,\n      default: generatedId(),\n      unique: true,\n      required: true,\n    },\n    locale: {\n      type: String,\n      required: true,\n      default: \"tr\",\n      enum: [\"tr\", \"en\"],\n    },\n    role: {\n      type: String,\n      required: true,\n      default: \"user\",\n      enum: [\"user\", \"admin\"],\n    },\n    name: {\n      type: String,\n      required: true,\n    },\n    surname: {\n      type: String,\n      required: true,\n    },\n    email: {\n      type: String,\n      required: true,\n      unique: true,\n    },\n    phoneNumber: {\n      type: String,\n      required: true,\n      unique: true,\n    },\n    identityNumber: {\n      type: String,\n      required: true,\n      default: \"00000000000\",\n    },\n    password: {\n      type: String,\n      required: true,\n    },\n    avatarColor: {\n      type: String,\n      default: randomColorGenerator(),\n      required: true,\n    },\n    address: {\n      //fatura ve sipariş adresi diye ikiye ayrılabilir\n      type: String,\n      required: true,\n    },\n    city: {\n      type: String,\n      required: true,\n    },\n    country: {\n      type: String,\n      required: true,\n      default: \"Turkey\",\n    },\n    zipCode: {\n      type: String,\n      required: true,\n    },\n    ip: {\n      type: String,\n      required: true,\n      //default: \"85.34.78.112\", //cihazın ip'sini alır\n    },\n    isVerified: {\n      type: Boolean,\n      default: false,\n    },\n    cardUserKey: {\n      type: String,\n      required: false,\n      unique: true,\n    },\n  },\n  {\n    _id: true,\n    collection: \"users\",\n    timestamps: true,\n    toJSON: {\n      transform: (doc, ret) => {\n        delete ret.__v;\n        delete ret.password;\n        return {\n          ...ret,\n        };\n      },\n    },\n  }\n);\n\nUserSchema.pre(\"save\", async function (next) {\n  try {\n    // this.password = await bcrypt.hash(this.password, 10);\n    if (this.isModified(\"password\")) {\n      //password incorrect hatasını böyle çözdük\n      this.password = await bcrypt.hash(this.password, 10);\n    }\n    return next();\n  } catch (err) {\n    return next(err);\n  }\n  next();\n});\nconst Users = mongoose.model(\"Users\", UserSchema);\n\nexport default Users;\n"],"mappings":"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","ignoreList":[]}},"mtime":1721312705756},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/utils/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/utils/uuid.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _uuid = require(\"uuid\");\n//burada modellerdeki uuid verisini dolduracak id üretilir(iyzipay için gerekli)\nconst id = () => (0, _uuid.v4)();\nvar _default = exports.default = id;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfdXVpZCIsInJlcXVpcmUiLCJpZCIsInV1aWR2NCIsIl9kZWZhdWx0IiwiZXhwb3J0cyIsImRlZmF1bHQiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy91dGlscy8iLCJzb3VyY2VzIjpbInV1aWQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdjQgYXMgdXVpZHY0IH0gZnJvbSBcInV1aWRcIjtcbi8vYnVyYWRhIG1vZGVsbGVyZGVraSB1dWlkIHZlcmlzaW5pIGRvbGR1cmFjYWsgaWQgw7xyZXRpbGlyKGl5emlwYXkgacOnaW4gZ2VyZWtsaSlcbmNvbnN0IGlkID0gKCkgPT4gdXVpZHY0KCk7XG5cbmV4cG9ydCBkZWZhdWx0IGlkO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxLQUFBLEdBQUFDLE9BQUE7QUFDQTtBQUNBLE1BQU1DLEVBQUUsR0FBR0EsQ0FBQSxLQUFNLElBQUFDLFFBQU0sRUFBQyxDQUFDO0FBQUMsSUFBQUMsUUFBQSxHQUFBQyxPQUFBLENBQUFDLE9BQUEsR0FFWEosRUFBRSIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_uuid","require","id","uuidv4","_default","exports","default"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/utils/","sources":["uuid.js"],"sourcesContent":["import { v4 as uuidv4 } from \"uuid\";\n//burada modellerdeki uuid verisini dolduracak id üretilir(iyzipay için gerekli)\nconst id = () => uuidv4();\n\nexport default id;\n"],"mappings":";;;;;;AAAA,IAAAA,KAAA,GAAAC,OAAA;AACA;AACA,MAAMC,EAAE,GAAGA,CAAA,KAAM,IAAAC,QAAM,EAAC,CAAC;AAAC,IAAAC,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEXJ,EAAE","ignoreList":[]}},"mtime":1721312705758},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/getUserIP.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nconst getUserIp = async (req, res, next) => {\n  const ipAddress = req.ip || req.connection.remoteAddress || req.headers[\"x-forwarded-for\"];\n  req.userIp = ipAddress;\n  next();\n};\nvar _default = exports.default = getUserIp;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJnZXRVc2VySXAiLCJyZXEiLCJyZXMiLCJuZXh0IiwiaXBBZGRyZXNzIiwiaXAiLCJjb25uZWN0aW9uIiwicmVtb3RlQWRkcmVzcyIsImhlYWRlcnMiLCJ1c2VySXAiLCJfZGVmYXVsdCIsImV4cG9ydHMiLCJkZWZhdWx0Il0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvbWlkZGxld2FyZXMvIiwic291cmNlcyI6WyJnZXRVc2VySVAuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZ2V0VXNlcklwID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIGNvbnN0IGlwQWRkcmVzcyA9XG4gICAgcmVxLmlwIHx8IHJlcS5jb25uZWN0aW9uLnJlbW90ZUFkZHJlc3MgfHwgcmVxLmhlYWRlcnNbXCJ4LWZvcndhcmRlZC1mb3JcIl07XG4gIHJlcS51c2VySXAgPSBpcEFkZHJlc3M7XG4gIG5leHQoKTtcbn07XG5leHBvcnQgZGVmYXVsdCBnZXRVc2VySXA7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLE1BQU1BLFNBQVMsR0FBRyxNQUFBQSxDQUFPQyxHQUFHLEVBQUVDLEdBQUcsRUFBRUMsSUFBSSxLQUFLO0VBQzFDLE1BQU1DLFNBQVMsR0FDYkgsR0FBRyxDQUFDSSxFQUFFLElBQUlKLEdBQUcsQ0FBQ0ssVUFBVSxDQUFDQyxhQUFhLElBQUlOLEdBQUcsQ0FBQ08sT0FBTyxDQUFDLGlCQUFpQixDQUFDO0VBQzFFUCxHQUFHLENBQUNRLE1BQU0sR0FBR0wsU0FBUztFQUN0QkQsSUFBSSxDQUFDLENBQUM7QUFDUixDQUFDO0FBQUMsSUFBQU8sUUFBQSxHQUFBQyxPQUFBLENBQUFDLE9BQUEsR0FDYVosU0FBUyIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["getUserIp","req","res","next","ipAddress","ip","connection","remoteAddress","headers","userIp","_default","exports","default"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["getUserIP.js"],"sourcesContent":["const getUserIp = async (req, res, next) => {\n  const ipAddress =\n    req.ip || req.connection.remoteAddress || req.headers[\"x-forwarded-for\"];\n  req.userIp = ipAddress;\n  next();\n};\nexport default getUserIp;\n"],"mappings":";;;;;;AAAA,MAAMA,SAAS,GAAG,MAAAA,CAAOC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EAC1C,MAAMC,SAAS,GACbH,GAAG,CAACI,EAAE,IAAIJ,GAAG,CAACK,UAAU,CAACC,aAAa,IAAIN,GAAG,CAACO,OAAO,CAAC,iBAAiB,CAAC;EAC1EP,GAAG,CAACQ,MAAM,GAAGL,SAAS;EACtBD,IAAI,CAAC,CAAC;AACR,CAAC;AAAC,IAAAO,QAAA,GAAAC,OAAA,CAAAC,OAAA,GACaZ,SAAS","ignoreList":[]}},"mtime":1721312705757},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/getUserIP.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nconst getUserIp = async (req, res, next) => {\n  const ipAddress = req.ip || req.connection.remoteAddress || req.headers[\"x-forwarded-for\"];\n  req.userIp = ipAddress;\n  next();\n};\nvar _default = exports.default = getUserIp;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJnZXRVc2VySXAiLCJyZXEiLCJyZXMiLCJuZXh0IiwiaXBBZGRyZXNzIiwiaXAiLCJjb25uZWN0aW9uIiwicmVtb3RlQWRkcmVzcyIsImhlYWRlcnMiLCJ1c2VySXAiLCJfZGVmYXVsdCIsImV4cG9ydHMiLCJkZWZhdWx0Il0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvbWlkZGxld2FyZXMvIiwic291cmNlcyI6WyJnZXRVc2VySVAuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZ2V0VXNlcklwID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIGNvbnN0IGlwQWRkcmVzcyA9XG4gICAgcmVxLmlwIHx8IHJlcS5jb25uZWN0aW9uLnJlbW90ZUFkZHJlc3MgfHwgcmVxLmhlYWRlcnNbXCJ4LWZvcndhcmRlZC1mb3JcIl07XG4gIHJlcS51c2VySXAgPSBpcEFkZHJlc3M7XG4gIG5leHQoKTtcbn07XG5leHBvcnQgZGVmYXVsdCBnZXRVc2VySXA7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLE1BQU1BLFNBQVMsR0FBRyxNQUFBQSxDQUFPQyxHQUFHLEVBQUVDLEdBQUcsRUFBRUMsSUFBSSxLQUFLO0VBQzFDLE1BQU1DLFNBQVMsR0FDYkgsR0FBRyxDQUFDSSxFQUFFLElBQUlKLEdBQUcsQ0FBQ0ssVUFBVSxDQUFDQyxhQUFhLElBQUlOLEdBQUcsQ0FBQ08sT0FBTyxDQUFDLGlCQUFpQixDQUFDO0VBQzFFUCxHQUFHLENBQUNRLE1BQU0sR0FBR0wsU0FBUztFQUN0QkQsSUFBSSxDQUFDLENBQUM7QUFDUixDQUFDO0FBQUMsSUFBQU8sUUFBQSxHQUFBQyxPQUFBLENBQUFDLE9BQUEsR0FDYVosU0FBUyIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["getUserIp","req","res","next","ipAddress","ip","connection","remoteAddress","headers","userIp","_default","exports","default"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["getUserIP.js"],"sourcesContent":["const getUserIp = async (req, res, next) => {\n  const ipAddress =\n    req.ip || req.connection.remoteAddress || req.headers[\"x-forwarded-for\"];\n  req.userIp = ipAddress;\n  next();\n};\nexport default getUserIp;\n"],"mappings":";;;;;;AAAA,MAAMA,SAAS,GAAG,MAAAA,CAAOC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EAC1C,MAAMC,SAAS,GACbH,GAAG,CAACI,EAAE,IAAIJ,GAAG,CAACK,UAAU,CAACC,aAAa,IAAIN,GAAG,CAACO,OAAO,CAAC,iBAAiB,CAAC;EAC1EP,GAAG,CAACQ,MAAM,GAAGL,SAAS;EACtBD,IAAI,CAAC,CAAC;AACR,CAAC;AAAC,IAAAO,QAAA,GAAAC,OAAA,CAAAC,OAAA,GACaZ,SAAS","ignoreList":[]}},"mtime":1721312705757},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/config.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nconst production = process.argv.slice(2).includes(\"dev\") ? false : true;\nconst config = {\n  development: !production,\n  production: production,\n  deployment: production ? \"PRODUCTION\" : \"DEVELOPMENT\"\n};\nvar _default = exports.default = config;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJwcm9kdWN0aW9uIiwicHJvY2VzcyIsImFyZ3YiLCJzbGljZSIsImluY2x1ZGVzIiwiY29uZmlnIiwiZGV2ZWxvcG1lbnQiLCJkZXBsb3ltZW50IiwiX2RlZmF1bHQiLCJleHBvcnRzIiwiZGVmYXVsdCJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjLyIsInNvdXJjZXMiOlsiY29uZmlnLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHByb2R1Y3Rpb24gPSBwcm9jZXNzLmFyZ3Yuc2xpY2UoMikuaW5jbHVkZXMoXCJkZXZcIikgPyBmYWxzZSA6IHRydWU7XG5cbmNvbnN0IGNvbmZpZyA9IHtcbiAgZGV2ZWxvcG1lbnQ6ICFwcm9kdWN0aW9uLFxuICBwcm9kdWN0aW9uOiBwcm9kdWN0aW9uLFxuICBkZXBsb3ltZW50OiBwcm9kdWN0aW9uID8gXCJQUk9EVUNUSU9OXCIgOiBcIkRFVkVMT1BNRU5UXCIsXG59O1xuZXhwb3J0IGRlZmF1bHQgY29uZmlnO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxNQUFNQSxVQUFVLEdBQUdDLE9BQU8sQ0FBQ0MsSUFBSSxDQUFDQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUNDLFFBQVEsQ0FBQyxLQUFLLENBQUMsR0FBRyxLQUFLLEdBQUcsSUFBSTtBQUV2RSxNQUFNQyxNQUFNLEdBQUc7RUFDYkMsV0FBVyxFQUFFLENBQUNOLFVBQVU7RUFDeEJBLFVBQVUsRUFBRUEsVUFBVTtFQUN0Qk8sVUFBVSxFQUFFUCxVQUFVLEdBQUcsWUFBWSxHQUFHO0FBQzFDLENBQUM7QUFBQyxJQUFBUSxRQUFBLEdBQUFDLE9BQUEsQ0FBQUMsT0FBQSxHQUNhTCxNQUFNIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["production","process","argv","slice","includes","config","development","deployment","_default","exports","default"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/","sources":["config.js"],"sourcesContent":["const production = process.argv.slice(2).includes(\"dev\") ? false : true;\n\nconst config = {\n  development: !production,\n  production: production,\n  deployment: production ? \"PRODUCTION\" : \"DEVELOPMENT\",\n};\nexport default config;\n"],"mappings":";;;;;;AAAA,MAAMA,UAAU,GAAGC,OAAO,CAACC,IAAI,CAACC,KAAK,CAAC,CAAC,CAAC,CAACC,QAAQ,CAAC,KAAK,CAAC,GAAG,KAAK,GAAG,IAAI;AAEvE,MAAMC,MAAM,GAAG;EACbC,WAAW,EAAE,CAACN,UAAU;EACxBA,UAAU,EAAEA,UAAU;EACtBO,UAAU,EAAEP,UAAU,GAAG,YAAY,GAAG;AAC1C,CAAC;AAAC,IAAAQ,QAAA,GAAAC,OAAA,CAAAC,OAAA,GACaL,MAAM","ignoreList":[]}},"mtime":1721043478449},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _users = _interopRequireDefault(require(\"./users\"));\nvar _products = _interopRequireDefault(require(\"./products\"));\nvar _cart = _interopRequireDefault(require(\"./cart\"));\nvar _paymentSuccess = _interopRequireDefault(require(\"./payment-success\"));\nvar _paymentFailed = _interopRequireDefault(require(\"./payment-failed\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = exports.default = [_users.default, _products.default, _cart.default, _paymentFailed.default, _paymentSuccess.default];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfdXNlcnMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9wcm9kdWN0cyIsIl9jYXJ0IiwiX3BheW1lbnRTdWNjZXNzIiwiX3BheW1lbnRGYWlsZWQiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfZGVmYXVsdCIsImV4cG9ydHMiLCJVc2VycyIsIlByb2R1Y3RzIiwiQ2FydCIsIlBheW1lbnRGYWlsZWQiLCJQYXltZW50U3VjY2VzcyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL2RiLyIsInNvdXJjZXMiOlsiaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFVzZXJzIGZyb20gXCIuL3VzZXJzXCI7XG5pbXBvcnQgUHJvZHVjdHMgZnJvbSBcIi4vcHJvZHVjdHNcIjtcbmltcG9ydCBDYXJ0IGZyb20gXCIuL2NhcnRcIjtcbmltcG9ydCBQYXltZW50U3VjY2VzcyBmcm9tIFwiLi9wYXltZW50LXN1Y2Nlc3NcIjtcbmltcG9ydCBQYXltZW50RmFpbGVkIGZyb20gXCIuL3BheW1lbnQtZmFpbGVkXCI7XG5cbmV4cG9ydCBkZWZhdWx0IFtVc2VycywgUHJvZHVjdHMsIENhcnQsIFBheW1lbnRGYWlsZWQsIFBheW1lbnRTdWNjZXNzXTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsTUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsU0FBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsS0FBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUcsZUFBQSxHQUFBSixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUksY0FBQSxHQUFBTCxzQkFBQSxDQUFBQyxPQUFBO0FBQTZDLFNBQUFELHVCQUFBTSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBQUEsSUFBQUcsUUFBQSxHQUFBQyxPQUFBLENBQUFGLE9BQUEsR0FFOUIsQ0FBQ0csY0FBSyxFQUFFQyxpQkFBUSxFQUFFQyxhQUFJLEVBQUVDLHNCQUFhLEVBQUVDLHVCQUFjLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_users","_interopRequireDefault","require","_products","_cart","_paymentSuccess","_paymentFailed","e","__esModule","default","_default","exports","Users","Products","Cart","PaymentFailed","PaymentSuccess"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["index.js"],"sourcesContent":["import Users from \"./users\";\nimport Products from \"./products\";\nimport Cart from \"./cart\";\nimport PaymentSuccess from \"./payment-success\";\nimport PaymentFailed from \"./payment-failed\";\n\nexport default [Users, Products, Cart, PaymentFailed, PaymentSuccess];\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,KAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,eAAA,GAAAJ,sBAAA,CAAAC,OAAA;AACA,IAAAI,cAAA,GAAAL,sBAAA,CAAAC,OAAA;AAA6C,SAAAD,uBAAAM,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAAA,IAAAG,QAAA,GAAAC,OAAA,CAAAF,OAAA,GAE9B,CAACG,cAAK,EAAEC,iBAAQ,EAAEC,aAAI,EAAEC,sBAAa,EAAEC,uBAAc,CAAC","ignoreList":[]}},"mtime":1723544062250},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/VerificationEmail.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _nodemailer = _interopRequireDefault(require(\"nodemailer\"));\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _getUserIP = _interopRequireDefault(require(\"../middlewares/getUserIP\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst sendVerificationEmail = async (req, res, next) => {\n  const {\n    email\n  } = req.body;\n  const user = await _users.default.findOne({\n    email\n  });\n  if (!user) {\n    return next(new _ApiError.default(400, \"Kullanıcı bulunamadı\"));\n  }\n  const token = _jsonwebtoken.default.sign({\n    id: user._id\n  }, process.env.JWT_SECRET, {\n    expiresIn: \"1h\"\n  });\n  const verificationUrl = `https://localhost:3000/api/verify-email?token=${token}`;\n  const transporter = _nodemailer.default.createTransport({\n    service: \"gmail\",\n    auth: {\n      user: \"atkahmed9924@gmail.com\",\n      //yandex mail yazılacak\n      pass: \"pwyh yojo pdaw welz\" // gmail uygulama şifresi bölümünden alındı\n    }\n  });\n  const mailOptions = {\n    from: \"atkahmed9924@gmail.com\",\n    to: email,\n    subject: \"Email Verification\",\n    html: `<p>Please verify your email by clicking the link below:</p>\n           <a href=\"${verificationUrl}\">Verify Email</a>`\n  };\n  try {\n    await transporter.sendMail(mailOptions);\n    console.log(`JWT Token: ${token}`); //bitince silinecek\n    next();\n  } catch (error) {\n    console.log(error);\n    return next(new _ApiError.default(500, \"Doğrulama e-postası gönderilemedi\"));\n  }\n};\nvar _default = exports.default = sendVerificationEmail;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbm9kZW1haWxlciIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2JjcnlwdGpzIiwiX2pzb253ZWJ0b2tlbiIsIl91c2VycyIsIl9BcGlFcnJvciIsIl9nZXRVc2VySVAiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJzZW5kVmVyaWZpY2F0aW9uRW1haWwiLCJyZXEiLCJyZXMiLCJuZXh0IiwiZW1haWwiLCJib2R5IiwidXNlciIsIlVzZXJzIiwiZmluZE9uZSIsIkFwaUVycm9yIiwidG9rZW4iLCJqd3QiLCJzaWduIiwiaWQiLCJfaWQiLCJwcm9jZXNzIiwiZW52IiwiSldUX1NFQ1JFVCIsImV4cGlyZXNJbiIsInZlcmlmaWNhdGlvblVybCIsInRyYW5zcG9ydGVyIiwibm9kZW1haWxlciIsImNyZWF0ZVRyYW5zcG9ydCIsInNlcnZpY2UiLCJhdXRoIiwicGFzcyIsIm1haWxPcHRpb25zIiwiZnJvbSIsInRvIiwic3ViamVjdCIsImh0bWwiLCJzZW5kTWFpbCIsImNvbnNvbGUiLCJsb2ciLCJlcnJvciIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL21pZGRsZXdhcmVzLyIsInNvdXJjZXMiOlsiVmVyaWZpY2F0aW9uRW1haWwuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG5vZGVtYWlsZXIgZnJvbSBcIm5vZGVtYWlsZXJcIjtcbmltcG9ydCBiY3J5cHQgZnJvbSBcImJjcnlwdGpzXCI7XG5pbXBvcnQgand0IGZyb20gXCJqc29ud2VidG9rZW5cIjtcbmltcG9ydCBVc2VycyBmcm9tIFwiLi4vZGIvdXNlcnNcIjtcbmltcG9ydCBBcGlFcnJvciBmcm9tIFwiLi4vZXJyb3JzL0FwaUVycm9yXCI7XG5pbXBvcnQgZ2V0VXNlcklwIGZyb20gXCIuLi9taWRkbGV3YXJlcy9nZXRVc2VySVBcIjtcblxuY29uc3Qgc2VuZFZlcmlmaWNhdGlvbkVtYWlsID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIGNvbnN0IHsgZW1haWwgfSA9IHJlcS5ib2R5O1xuICBjb25zdCB1c2VyID0gYXdhaXQgVXNlcnMuZmluZE9uZSh7IGVtYWlsIH0pO1xuXG4gIGlmICghdXNlcikge1xuICAgIHJldHVybiBuZXh0KG5ldyBBcGlFcnJvcig0MDAsIFwiS3VsbGFuxLFjxLEgYnVsdW5hbWFkxLFcIikpO1xuICB9XG5cbiAgY29uc3QgdG9rZW4gPSBqd3Quc2lnbih7IGlkOiB1c2VyLl9pZCB9LCBwcm9jZXNzLmVudi5KV1RfU0VDUkVULCB7XG4gICAgZXhwaXJlc0luOiBcIjFoXCIsXG4gIH0pO1xuICBjb25zdCB2ZXJpZmljYXRpb25VcmwgPSBgaHR0cHM6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvdmVyaWZ5LWVtYWlsP3Rva2VuPSR7dG9rZW59YDtcblxuICBjb25zdCB0cmFuc3BvcnRlciA9IG5vZGVtYWlsZXIuY3JlYXRlVHJhbnNwb3J0KHtcbiAgICBzZXJ2aWNlOiBcImdtYWlsXCIsXG4gICAgYXV0aDoge1xuICAgICAgdXNlcjogXCJhdGthaG1lZDk5MjRAZ21haWwuY29tXCIsIC8veWFuZGV4IG1haWwgeWF6xLFsYWNha1xuICAgICAgcGFzczogXCJwd3loIHlvam8gcGRhdyB3ZWx6XCIsIC8vIGdtYWlsIHV5Z3VsYW1hIMWfaWZyZXNpIGLDtmzDvG3DvG5kZW4gYWzEsW5kxLFcbiAgICB9LFxuICB9KTtcblxuICBjb25zdCBtYWlsT3B0aW9ucyA9IHtcbiAgICBmcm9tOiBcImF0a2FobWVkOTkyNEBnbWFpbC5jb21cIixcbiAgICB0bzogZW1haWwsXG4gICAgc3ViamVjdDogXCJFbWFpbCBWZXJpZmljYXRpb25cIixcbiAgICBodG1sOiBgPHA+UGxlYXNlIHZlcmlmeSB5b3VyIGVtYWlsIGJ5IGNsaWNraW5nIHRoZSBsaW5rIGJlbG93OjwvcD5cbiAgICAgICAgICAgPGEgaHJlZj1cIiR7dmVyaWZpY2F0aW9uVXJsfVwiPlZlcmlmeSBFbWFpbDwvYT5gLFxuICB9O1xuXG4gIHRyeSB7XG4gICAgYXdhaXQgdHJhbnNwb3J0ZXIuc2VuZE1haWwobWFpbE9wdGlvbnMpO1xuICAgIGNvbnNvbGUubG9nKGBKV1QgVG9rZW46ICR7dG9rZW59YCk7IC8vYml0aW5jZSBzaWxpbmVjZWtcbiAgICBuZXh0KCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgIHJldHVybiBuZXh0KG5ldyBBcGlFcnJvcig1MDAsIFwiRG/En3J1bGFtYSBlLXBvc3Rhc8SxIGfDtm5kZXJpbGVtZWRpXCIpKTtcbiAgfVxufTtcblxuZXhwb3J0IGRlZmF1bHQgc2VuZFZlcmlmaWNhdGlvbkVtYWlsO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxXQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxTQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxhQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRyxNQUFBLEdBQUFKLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSSxTQUFBLEdBQUFMLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSyxVQUFBLEdBQUFOLHNCQUFBLENBQUFDLE9BQUE7QUFBaUQsU0FBQUQsdUJBQUFPLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFakQsTUFBTUcscUJBQXFCLEdBQUcsTUFBQUEsQ0FBT0MsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksS0FBSztFQUN0RCxNQUFNO0lBQUVDO0VBQU0sQ0FBQyxHQUFHSCxHQUFHLENBQUNJLElBQUk7RUFDMUIsTUFBTUMsSUFBSSxHQUFHLE1BQU1DLGNBQUssQ0FBQ0MsT0FBTyxDQUFDO0lBQUVKO0VBQU0sQ0FBQyxDQUFDO0VBRTNDLElBQUksQ0FBQ0UsSUFBSSxFQUFFO0lBQ1QsT0FBT0gsSUFBSSxDQUFDLElBQUlNLGlCQUFRLENBQUMsR0FBRyxFQUFFLHNCQUFzQixDQUFDLENBQUM7RUFDeEQ7RUFFQSxNQUFNQyxLQUFLLEdBQUdDLHFCQUFHLENBQUNDLElBQUksQ0FBQztJQUFFQyxFQUFFLEVBQUVQLElBQUksQ0FBQ1E7RUFBSSxDQUFDLEVBQUVDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxVQUFVLEVBQUU7SUFDL0RDLFNBQVMsRUFBRTtFQUNiLENBQUMsQ0FBQztFQUNGLE1BQU1DLGVBQWUsR0FBRyxpREFBaURULEtBQUssRUFBRTtFQUVoRixNQUFNVSxXQUFXLEdBQUdDLG1CQUFVLENBQUNDLGVBQWUsQ0FBQztJQUM3Q0MsT0FBTyxFQUFFLE9BQU87SUFDaEJDLElBQUksRUFBRTtNQUNKbEIsSUFBSSxFQUFFLHdCQUF3QjtNQUFFO01BQ2hDbUIsSUFBSSxFQUFFLHFCQUFxQixDQUFFO0lBQy9CO0VBQ0YsQ0FBQyxDQUFDO0VBRUYsTUFBTUMsV0FBVyxHQUFHO0lBQ2xCQyxJQUFJLEVBQUUsd0JBQXdCO0lBQzlCQyxFQUFFLEVBQUV4QixLQUFLO0lBQ1R5QixPQUFPLEVBQUUsb0JBQW9CO0lBQzdCQyxJQUFJLEVBQUU7QUFDVixzQkFBc0JYLGVBQWU7RUFDbkMsQ0FBQztFQUVELElBQUk7SUFDRixNQUFNQyxXQUFXLENBQUNXLFFBQVEsQ0FBQ0wsV0FBVyxDQUFDO0lBQ3ZDTSxPQUFPLENBQUNDLEdBQUcsQ0FBQyxjQUFjdkIsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ3BDUCxJQUFJLENBQUMsQ0FBQztFQUNSLENBQUMsQ0FBQyxPQUFPK0IsS0FBSyxFQUFFO0lBQ2RGLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxLQUFLLENBQUM7SUFDbEIsT0FBTy9CLElBQUksQ0FBQyxJQUFJTSxpQkFBUSxDQUFDLEdBQUcsRUFBRSxtQ0FBbUMsQ0FBQyxDQUFDO0VBQ3JFO0FBQ0YsQ0FBQztBQUFDLElBQUEwQixRQUFBLEdBQUFDLE9BQUEsQ0FBQXJDLE9BQUEsR0FFYUMscUJBQXFCIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["_nodemailer","_interopRequireDefault","require","_bcryptjs","_jsonwebtoken","_users","_ApiError","_getUserIP","e","__esModule","default","sendVerificationEmail","req","res","next","email","body","user","Users","findOne","ApiError","token","jwt","sign","id","_id","process","env","JWT_SECRET","expiresIn","verificationUrl","transporter","nodemailer","createTransport","service","auth","pass","mailOptions","from","to","subject","html","sendMail","console","log","error","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["VerificationEmail.js"],"sourcesContent":["import nodemailer from \"nodemailer\";\nimport bcrypt from \"bcryptjs\";\nimport jwt from \"jsonwebtoken\";\nimport Users from \"../db/users\";\nimport ApiError from \"../errors/ApiError\";\nimport getUserIp from \"../middlewares/getUserIP\";\n\nconst sendVerificationEmail = async (req, res, next) => {\n  const { email } = req.body;\n  const user = await Users.findOne({ email });\n\n  if (!user) {\n    return next(new ApiError(400, \"Kullanıcı bulunamadı\"));\n  }\n\n  const token = jwt.sign({ id: user._id }, process.env.JWT_SECRET, {\n    expiresIn: \"1h\",\n  });\n  const verificationUrl = `https://localhost:3000/api/verify-email?token=${token}`;\n\n  const transporter = nodemailer.createTransport({\n    service: \"gmail\",\n    auth: {\n      user: \"atkahmed9924@gmail.com\", //yandex mail yazılacak\n      pass: \"pwyh yojo pdaw welz\", // gmail uygulama şifresi bölümünden alındı\n    },\n  });\n\n  const mailOptions = {\n    from: \"atkahmed9924@gmail.com\",\n    to: email,\n    subject: \"Email Verification\",\n    html: `<p>Please verify your email by clicking the link below:</p>\n           <a href=\"${verificationUrl}\">Verify Email</a>`,\n  };\n\n  try {\n    await transporter.sendMail(mailOptions);\n    console.log(`JWT Token: ${token}`); //bitince silinecek\n    next();\n  } catch (error) {\n    console.log(error);\n    return next(new ApiError(500, \"Doğrulama e-postası gönderilemedi\"));\n  }\n};\n\nexport default sendVerificationEmail;\n"],"mappings":";;;;;;AAAA,IAAAA,WAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,aAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,MAAA,GAAAJ,sBAAA,CAAAC,OAAA;AACA,IAAAI,SAAA,GAAAL,sBAAA,CAAAC,OAAA;AACA,IAAAK,UAAA,GAAAN,sBAAA,CAAAC,OAAA;AAAiD,SAAAD,uBAAAO,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEjD,MAAMG,qBAAqB,GAAG,MAAAA,CAAOC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EACtD,MAAM;IAAEC;EAAM,CAAC,GAAGH,GAAG,CAACI,IAAI;EAC1B,MAAMC,IAAI,GAAG,MAAMC,cAAK,CAACC,OAAO,CAAC;IAAEJ;EAAM,CAAC,CAAC;EAE3C,IAAI,CAACE,IAAI,EAAE;IACT,OAAOH,IAAI,CAAC,IAAIM,iBAAQ,CAAC,GAAG,EAAE,sBAAsB,CAAC,CAAC;EACxD;EAEA,MAAMC,KAAK,GAAGC,qBAAG,CAACC,IAAI,CAAC;IAAEC,EAAE,EAAEP,IAAI,CAACQ;EAAI,CAAC,EAAEC,OAAO,CAACC,GAAG,CAACC,UAAU,EAAE;IAC/DC,SAAS,EAAE;EACb,CAAC,CAAC;EACF,MAAMC,eAAe,GAAG,iDAAiDT,KAAK,EAAE;EAEhF,MAAMU,WAAW,GAAGC,mBAAU,CAACC,eAAe,CAAC;IAC7CC,OAAO,EAAE,OAAO;IAChBC,IAAI,EAAE;MACJlB,IAAI,EAAE,wBAAwB;MAAE;MAChCmB,IAAI,EAAE,qBAAqB,CAAE;IAC/B;EACF,CAAC,CAAC;EAEF,MAAMC,WAAW,GAAG;IAClBC,IAAI,EAAE,wBAAwB;IAC9BC,EAAE,EAAExB,KAAK;IACTyB,OAAO,EAAE,oBAAoB;IAC7BC,IAAI,EAAE;AACV,sBAAsBX,eAAe;EACnC,CAAC;EAED,IAAI;IACF,MAAMC,WAAW,CAACW,QAAQ,CAACL,WAAW,CAAC;IACvCM,OAAO,CAACC,GAAG,CAAC,cAAcvB,KAAK,EAAE,CAAC,CAAC,CAAC;IACpCP,IAAI,CAAC,CAAC;EACR,CAAC,CAAC,OAAO+B,KAAK,EAAE;IACdF,OAAO,CAACC,GAAG,CAACC,KAAK,CAAC;IAClB,OAAO/B,IAAI,CAAC,IAAIM,iBAAQ,CAAC,GAAG,EAAE,mCAAmC,CAAC,CAAC;EACrE;AACF,CAAC;AAAC,IAAA0B,QAAA,GAAAC,OAAA,CAAArC,OAAA,GAEaC,qBAAqB","ignoreList":[]}},"mtime":1721312705757},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/VerificationEmail.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _nodemailer = _interopRequireDefault(require(\"nodemailer\"));\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _getUserIP = _interopRequireDefault(require(\"../middlewares/getUserIP\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst sendVerificationEmail = async (req, res, next) => {\n  const {\n    email\n  } = req.body;\n  const user = await _users.default.findOne({\n    email\n  });\n  if (!user) {\n    return next(new _ApiError.default(400, \"Kullanıcı bulunamadı\"));\n  }\n  const token = _jsonwebtoken.default.sign({\n    id: user._id\n  }, process.env.JWT_SECRET, {\n    expiresIn: \"1h\"\n  });\n  const verificationUrl = `https://localhost:3000/api/verify-email?token=${token}`;\n  const transporter = _nodemailer.default.createTransport({\n    service: \"gmail\",\n    auth: {\n      user: \"atkahmed9924@gmail.com\",\n      //yandex mail yazılacak\n      pass: \"pwyh yojo pdaw welz\" // gmail uygulama şifresi bölümünden alındı\n    }\n  });\n  const mailOptions = {\n    from: \"atkahmed9924@gmail.com\",\n    to: email,\n    subject: \"Email Verification\",\n    html: `<p>Please verify your email by clicking the link below:</p>\n           <a href=\"${verificationUrl}\">Verify Email</a>`\n  };\n  try {\n    await transporter.sendMail(mailOptions);\n    console.log(`JWT Token: ${token}`); //bitince silinecek\n    next();\n  } catch (error) {\n    console.log(error);\n    return next(new _ApiError.default(500, \"Doğrulama e-postası gönderilemedi\"));\n  }\n};\nvar _default = exports.default = sendVerificationEmail;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbm9kZW1haWxlciIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2JjcnlwdGpzIiwiX2pzb253ZWJ0b2tlbiIsIl91c2VycyIsIl9BcGlFcnJvciIsIl9nZXRVc2VySVAiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJzZW5kVmVyaWZpY2F0aW9uRW1haWwiLCJyZXEiLCJyZXMiLCJuZXh0IiwiZW1haWwiLCJib2R5IiwidXNlciIsIlVzZXJzIiwiZmluZE9uZSIsIkFwaUVycm9yIiwidG9rZW4iLCJqd3QiLCJzaWduIiwiaWQiLCJfaWQiLCJwcm9jZXNzIiwiZW52IiwiSldUX1NFQ1JFVCIsImV4cGlyZXNJbiIsInZlcmlmaWNhdGlvblVybCIsInRyYW5zcG9ydGVyIiwibm9kZW1haWxlciIsImNyZWF0ZVRyYW5zcG9ydCIsInNlcnZpY2UiLCJhdXRoIiwicGFzcyIsIm1haWxPcHRpb25zIiwiZnJvbSIsInRvIiwic3ViamVjdCIsImh0bWwiLCJzZW5kTWFpbCIsImNvbnNvbGUiLCJsb2ciLCJlcnJvciIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL21pZGRsZXdhcmVzLyIsInNvdXJjZXMiOlsiVmVyaWZpY2F0aW9uRW1haWwuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG5vZGVtYWlsZXIgZnJvbSBcIm5vZGVtYWlsZXJcIjtcbmltcG9ydCBiY3J5cHQgZnJvbSBcImJjcnlwdGpzXCI7XG5pbXBvcnQgand0IGZyb20gXCJqc29ud2VidG9rZW5cIjtcbmltcG9ydCBVc2VycyBmcm9tIFwiLi4vZGIvdXNlcnNcIjtcbmltcG9ydCBBcGlFcnJvciBmcm9tIFwiLi4vZXJyb3JzL0FwaUVycm9yXCI7XG5pbXBvcnQgZ2V0VXNlcklwIGZyb20gXCIuLi9taWRkbGV3YXJlcy9nZXRVc2VySVBcIjtcblxuY29uc3Qgc2VuZFZlcmlmaWNhdGlvbkVtYWlsID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIGNvbnN0IHsgZW1haWwgfSA9IHJlcS5ib2R5O1xuICBjb25zdCB1c2VyID0gYXdhaXQgVXNlcnMuZmluZE9uZSh7IGVtYWlsIH0pO1xuXG4gIGlmICghdXNlcikge1xuICAgIHJldHVybiBuZXh0KG5ldyBBcGlFcnJvcig0MDAsIFwiS3VsbGFuxLFjxLEgYnVsdW5hbWFkxLFcIikpO1xuICB9XG5cbiAgY29uc3QgdG9rZW4gPSBqd3Quc2lnbih7IGlkOiB1c2VyLl9pZCB9LCBwcm9jZXNzLmVudi5KV1RfU0VDUkVULCB7XG4gICAgZXhwaXJlc0luOiBcIjFoXCIsXG4gIH0pO1xuICBjb25zdCB2ZXJpZmljYXRpb25VcmwgPSBgaHR0cHM6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvdmVyaWZ5LWVtYWlsP3Rva2VuPSR7dG9rZW59YDtcblxuICBjb25zdCB0cmFuc3BvcnRlciA9IG5vZGVtYWlsZXIuY3JlYXRlVHJhbnNwb3J0KHtcbiAgICBzZXJ2aWNlOiBcImdtYWlsXCIsXG4gICAgYXV0aDoge1xuICAgICAgdXNlcjogXCJhdGthaG1lZDk5MjRAZ21haWwuY29tXCIsIC8veWFuZGV4IG1haWwgeWF6xLFsYWNha1xuICAgICAgcGFzczogXCJwd3loIHlvam8gcGRhdyB3ZWx6XCIsIC8vIGdtYWlsIHV5Z3VsYW1hIMWfaWZyZXNpIGLDtmzDvG3DvG5kZW4gYWzEsW5kxLFcbiAgICB9LFxuICB9KTtcblxuICBjb25zdCBtYWlsT3B0aW9ucyA9IHtcbiAgICBmcm9tOiBcImF0a2FobWVkOTkyNEBnbWFpbC5jb21cIixcbiAgICB0bzogZW1haWwsXG4gICAgc3ViamVjdDogXCJFbWFpbCBWZXJpZmljYXRpb25cIixcbiAgICBodG1sOiBgPHA+UGxlYXNlIHZlcmlmeSB5b3VyIGVtYWlsIGJ5IGNsaWNraW5nIHRoZSBsaW5rIGJlbG93OjwvcD5cbiAgICAgICAgICAgPGEgaHJlZj1cIiR7dmVyaWZpY2F0aW9uVXJsfVwiPlZlcmlmeSBFbWFpbDwvYT5gLFxuICB9O1xuXG4gIHRyeSB7XG4gICAgYXdhaXQgdHJhbnNwb3J0ZXIuc2VuZE1haWwobWFpbE9wdGlvbnMpO1xuICAgIGNvbnNvbGUubG9nKGBKV1QgVG9rZW46ICR7dG9rZW59YCk7IC8vYml0aW5jZSBzaWxpbmVjZWtcbiAgICBuZXh0KCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgIHJldHVybiBuZXh0KG5ldyBBcGlFcnJvcig1MDAsIFwiRG/En3J1bGFtYSBlLXBvc3Rhc8SxIGfDtm5kZXJpbGVtZWRpXCIpKTtcbiAgfVxufTtcblxuZXhwb3J0IGRlZmF1bHQgc2VuZFZlcmlmaWNhdGlvbkVtYWlsO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxXQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxTQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxhQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRyxNQUFBLEdBQUFKLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSSxTQUFBLEdBQUFMLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSyxVQUFBLEdBQUFOLHNCQUFBLENBQUFDLE9BQUE7QUFBaUQsU0FBQUQsdUJBQUFPLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFakQsTUFBTUcscUJBQXFCLEdBQUcsTUFBQUEsQ0FBT0MsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksS0FBSztFQUN0RCxNQUFNO0lBQUVDO0VBQU0sQ0FBQyxHQUFHSCxHQUFHLENBQUNJLElBQUk7RUFDMUIsTUFBTUMsSUFBSSxHQUFHLE1BQU1DLGNBQUssQ0FBQ0MsT0FBTyxDQUFDO0lBQUVKO0VBQU0sQ0FBQyxDQUFDO0VBRTNDLElBQUksQ0FBQ0UsSUFBSSxFQUFFO0lBQ1QsT0FBT0gsSUFBSSxDQUFDLElBQUlNLGlCQUFRLENBQUMsR0FBRyxFQUFFLHNCQUFzQixDQUFDLENBQUM7RUFDeEQ7RUFFQSxNQUFNQyxLQUFLLEdBQUdDLHFCQUFHLENBQUNDLElBQUksQ0FBQztJQUFFQyxFQUFFLEVBQUVQLElBQUksQ0FBQ1E7RUFBSSxDQUFDLEVBQUVDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxVQUFVLEVBQUU7SUFDL0RDLFNBQVMsRUFBRTtFQUNiLENBQUMsQ0FBQztFQUNGLE1BQU1DLGVBQWUsR0FBRyxpREFBaURULEtBQUssRUFBRTtFQUVoRixNQUFNVSxXQUFXLEdBQUdDLG1CQUFVLENBQUNDLGVBQWUsQ0FBQztJQUM3Q0MsT0FBTyxFQUFFLE9BQU87SUFDaEJDLElBQUksRUFBRTtNQUNKbEIsSUFBSSxFQUFFLHdCQUF3QjtNQUFFO01BQ2hDbUIsSUFBSSxFQUFFLHFCQUFxQixDQUFFO0lBQy9CO0VBQ0YsQ0FBQyxDQUFDO0VBRUYsTUFBTUMsV0FBVyxHQUFHO0lBQ2xCQyxJQUFJLEVBQUUsd0JBQXdCO0lBQzlCQyxFQUFFLEVBQUV4QixLQUFLO0lBQ1R5QixPQUFPLEVBQUUsb0JBQW9CO0lBQzdCQyxJQUFJLEVBQUU7QUFDVixzQkFBc0JYLGVBQWU7RUFDbkMsQ0FBQztFQUVELElBQUk7SUFDRixNQUFNQyxXQUFXLENBQUNXLFFBQVEsQ0FBQ0wsV0FBVyxDQUFDO0lBQ3ZDTSxPQUFPLENBQUNDLEdBQUcsQ0FBQyxjQUFjdkIsS0FBSyxFQUFFLENBQUMsQ0FBQyxDQUFDO0lBQ3BDUCxJQUFJLENBQUMsQ0FBQztFQUNSLENBQUMsQ0FBQyxPQUFPK0IsS0FBSyxFQUFFO0lBQ2RGLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxLQUFLLENBQUM7SUFDbEIsT0FBTy9CLElBQUksQ0FBQyxJQUFJTSxpQkFBUSxDQUFDLEdBQUcsRUFBRSxtQ0FBbUMsQ0FBQyxDQUFDO0VBQ3JFO0FBQ0YsQ0FBQztBQUFDLElBQUEwQixRQUFBLEdBQUFDLE9BQUEsQ0FBQXJDLE9BQUEsR0FFYUMscUJBQXFCIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["_nodemailer","_interopRequireDefault","require","_bcryptjs","_jsonwebtoken","_users","_ApiError","_getUserIP","e","__esModule","default","sendVerificationEmail","req","res","next","email","body","user","Users","findOne","ApiError","token","jwt","sign","id","_id","process","env","JWT_SECRET","expiresIn","verificationUrl","transporter","nodemailer","createTransport","service","auth","pass","mailOptions","from","to","subject","html","sendMail","console","log","error","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["VerificationEmail.js"],"sourcesContent":["import nodemailer from \"nodemailer\";\nimport bcrypt from \"bcryptjs\";\nimport jwt from \"jsonwebtoken\";\nimport Users from \"../db/users\";\nimport ApiError from \"../errors/ApiError\";\nimport getUserIp from \"../middlewares/getUserIP\";\n\nconst sendVerificationEmail = async (req, res, next) => {\n  const { email } = req.body;\n  const user = await Users.findOne({ email });\n\n  if (!user) {\n    return next(new ApiError(400, \"Kullanıcı bulunamadı\"));\n  }\n\n  const token = jwt.sign({ id: user._id }, process.env.JWT_SECRET, {\n    expiresIn: \"1h\",\n  });\n  const verificationUrl = `https://localhost:3000/api/verify-email?token=${token}`;\n\n  const transporter = nodemailer.createTransport({\n    service: \"gmail\",\n    auth: {\n      user: \"atkahmed9924@gmail.com\", //yandex mail yazılacak\n      pass: \"pwyh yojo pdaw welz\", // gmail uygulama şifresi bölümünden alındı\n    },\n  });\n\n  const mailOptions = {\n    from: \"atkahmed9924@gmail.com\",\n    to: email,\n    subject: \"Email Verification\",\n    html: `<p>Please verify your email by clicking the link below:</p>\n           <a href=\"${verificationUrl}\">Verify Email</a>`,\n  };\n\n  try {\n    await transporter.sendMail(mailOptions);\n    console.log(`JWT Token: ${token}`); //bitince silinecek\n    next();\n  } catch (error) {\n    console.log(error);\n    return next(new ApiError(500, \"Doğrulama e-postası gönderilemedi\"));\n  }\n};\n\nexport default sendVerificationEmail;\n"],"mappings":";;;;;;AAAA,IAAAA,WAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,aAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,MAAA,GAAAJ,sBAAA,CAAAC,OAAA;AACA,IAAAI,SAAA,GAAAL,sBAAA,CAAAC,OAAA;AACA,IAAAK,UAAA,GAAAN,sBAAA,CAAAC,OAAA;AAAiD,SAAAD,uBAAAO,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEjD,MAAMG,qBAAqB,GAAG,MAAAA,CAAOC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EACtD,MAAM;IAAEC;EAAM,CAAC,GAAGH,GAAG,CAACI,IAAI;EAC1B,MAAMC,IAAI,GAAG,MAAMC,cAAK,CAACC,OAAO,CAAC;IAAEJ;EAAM,CAAC,CAAC;EAE3C,IAAI,CAACE,IAAI,EAAE;IACT,OAAOH,IAAI,CAAC,IAAIM,iBAAQ,CAAC,GAAG,EAAE,sBAAsB,CAAC,CAAC;EACxD;EAEA,MAAMC,KAAK,GAAGC,qBAAG,CAACC,IAAI,CAAC;IAAEC,EAAE,EAAEP,IAAI,CAACQ;EAAI,CAAC,EAAEC,OAAO,CAACC,GAAG,CAACC,UAAU,EAAE;IAC/DC,SAAS,EAAE;EACb,CAAC,CAAC;EACF,MAAMC,eAAe,GAAG,iDAAiDT,KAAK,EAAE;EAEhF,MAAMU,WAAW,GAAGC,mBAAU,CAACC,eAAe,CAAC;IAC7CC,OAAO,EAAE,OAAO;IAChBC,IAAI,EAAE;MACJlB,IAAI,EAAE,wBAAwB;MAAE;MAChCmB,IAAI,EAAE,qBAAqB,CAAE;IAC/B;EACF,CAAC,CAAC;EAEF,MAAMC,WAAW,GAAG;IAClBC,IAAI,EAAE,wBAAwB;IAC9BC,EAAE,EAAExB,KAAK;IACTyB,OAAO,EAAE,oBAAoB;IAC7BC,IAAI,EAAE;AACV,sBAAsBX,eAAe;EACnC,CAAC;EAED,IAAI;IACF,MAAMC,WAAW,CAACW,QAAQ,CAACL,WAAW,CAAC;IACvCM,OAAO,CAACC,GAAG,CAAC,cAAcvB,KAAK,EAAE,CAAC,CAAC,CAAC;IACpCP,IAAI,CAAC,CAAC;EACR,CAAC,CAAC,OAAO+B,KAAK,EAAE;IACdF,OAAO,CAACC,GAAG,CAACC,KAAK,CAAC;IAClB,OAAO/B,IAAI,CAAC,IAAIM,iBAAQ,CAAC,GAAG,EAAE,mCAAmC,CAAC,CAAC;EACrE;AACF,CAAC;AAAC,IAAA0B,QAAA,GAAAC,OAAA,CAAArC,OAAA,GAEaC,qBAAqB","ignoreList":[]}},"mtime":1721312705757},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/products.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst ProductsSchema = new Schema({\n  uuid: {\n    type: String,\n    default: (0, _uuid.default)(),\n    unique: false,\n    required: true\n  },\n  name: {\n    type: String,\n    required: true\n  },\n  definition: {\n    type: String,\n    required: true\n  },\n  images: {\n    type: [String],\n    //text array olacak\n    required: true\n  },\n  categories: {\n    type: [String]\n  },\n  brand: {\n    type: String,\n    required: true\n  },\n  price: {\n    type: Number,\n    required: true\n  },\n  currency: {\n    type: String,\n    required: true,\n    default: \"TRY\",\n    enum: [\"TRY\", \"USD\", \"EUR\"]\n  },\n  stock: {\n    type: Number,\n    default: 1,\n    required: true\n  },\n  itemType: {\n    type: String,\n    required: true,\n    default: \"PHYSICAL\",\n    enum: [\"PHYSICAL\", \"VIRTUAL\"]\n  }\n}, {\n  _id: true,\n  collection: \"products\",\n  timestamps: true,\n  toJSON: {\n    transform: (doc, ret) => {\n      delete ret.__v;\n      return {\n        ...ret\n      };\n    }\n  }\n});\nconst Products = _mongoose.default.model(\"Products\", ProductsSchema);\nvar _default = exports.default = Products;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9iY3J5cHRqcyIsIl91dWlkIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiU2NoZW1hIiwibW9uZ29vc2UiLCJPYmplY3RJZCIsIlR5cGVzIiwiUHJvZHVjdHNTY2hlbWEiLCJ1dWlkIiwidHlwZSIsIlN0cmluZyIsImlkIiwidW5pcXVlIiwicmVxdWlyZWQiLCJuYW1lIiwiZGVmaW5pdGlvbiIsImltYWdlcyIsImNhdGVnb3JpZXMiLCJicmFuZCIsInByaWNlIiwiTnVtYmVyIiwiY3VycmVuY3kiLCJlbnVtIiwic3RvY2siLCJpdGVtVHlwZSIsIl9pZCIsImNvbGxlY3Rpb24iLCJ0aW1lc3RhbXBzIiwidG9KU09OIiwidHJhbnNmb3JtIiwiZG9jIiwicmV0IiwiX192IiwiUHJvZHVjdHMiLCJtb2RlbCIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL2RiLyIsInNvdXJjZXMiOlsicHJvZHVjdHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlIGZyb20gXCJtb25nb29zZVwiO1xuaW1wb3J0IGJjcnlwdCBmcm9tIFwiYmNyeXB0anNcIjtcbmltcG9ydCBpZCBmcm9tIFwiLi4vdXRpbHMvdXVpZFwiO1xuXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWE7XG5jb25zdCB7IE9iamVjdElkIH0gPSBTY2hlbWEuVHlwZXM7XG5cbmNvbnN0IFByb2R1Y3RzU2NoZW1hID0gbmV3IFNjaGVtYShcbiAge1xuICAgIHV1aWQ6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIGRlZmF1bHQ6IGlkKCksXG4gICAgICB1bmlxdWU6IGZhbHNlLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBuYW1lOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGRlZmluaXRpb246IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgaW1hZ2VzOiB7XG4gICAgICB0eXBlOiBbU3RyaW5nXSwgLy90ZXh0IGFycmF5IG9sYWNha1xuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBjYXRlZ29yaWVzOiB7XG4gICAgICB0eXBlOiBbU3RyaW5nXSxcbiAgICB9LFxuICAgIGJyYW5kOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIHByaWNlOiB7XG4gICAgICB0eXBlOiBOdW1iZXIsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGN1cnJlbmN5OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIGRlZmF1bHQ6IFwiVFJZXCIsXG4gICAgICBlbnVtOiBbXCJUUllcIiwgXCJVU0RcIiwgXCJFVVJcIl0sXG4gICAgfSxcbiAgICBzdG9jazoge1xuICAgICAgdHlwZTogTnVtYmVyLFxuICAgICAgZGVmYXVsdDogMSxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgaXRlbVR5cGU6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgZGVmYXVsdDogXCJQSFlTSUNBTFwiLFxuICAgICAgZW51bTogW1wiUEhZU0lDQUxcIiwgXCJWSVJUVUFMXCJdLFxuICAgIH0sXG4gIH0sXG4gIHtcbiAgICBfaWQ6IHRydWUsXG4gICAgY29sbGVjdGlvbjogXCJwcm9kdWN0c1wiLFxuICAgIHRpbWVzdGFtcHM6IHRydWUsXG4gICAgdG9KU09OOiB7XG4gICAgICB0cmFuc2Zvcm06IChkb2MsIHJldCkgPT4ge1xuICAgICAgICBkZWxldGUgcmV0Ll9fdjtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAuLi5yZXQsXG4gICAgICAgIH07XG4gICAgICB9LFxuICAgIH0sXG4gIH1cbik7XG5cbmNvbnN0IFByb2R1Y3RzID0gbW9uZ29vc2UubW9kZWwoXCJQcm9kdWN0c1wiLCBQcm9kdWN0c1NjaGVtYSk7XG5cbmV4cG9ydCBkZWZhdWx0IFByb2R1Y3RzO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxTQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxTQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxLQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFBK0IsU0FBQUQsdUJBQUFJLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFL0IsTUFBTUcsTUFBTSxHQUFHQyxpQkFBUSxDQUFDRCxNQUFNO0FBQzlCLE1BQU07RUFBRUU7QUFBUyxDQUFDLEdBQUdGLE1BQU0sQ0FBQ0csS0FBSztBQUVqQyxNQUFNQyxjQUFjLEdBQUcsSUFBSUosTUFBTSxDQUMvQjtFQUNFSyxJQUFJLEVBQUU7SUFDSkMsSUFBSSxFQUFFQyxNQUFNO0lBQ1pSLE9BQU8sRUFBRSxJQUFBUyxhQUFFLEVBQUMsQ0FBQztJQUNiQyxNQUFNLEVBQUUsS0FBSztJQUNiQyxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RDLElBQUksRUFBRTtJQUNKTCxJQUFJLEVBQUVDLE1BQU07SUFDWkcsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNERSxVQUFVLEVBQUU7SUFDVk4sSUFBSSxFQUFFQyxNQUFNO0lBQ1pHLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDREcsTUFBTSxFQUFFO0lBQ05QLElBQUksRUFBRSxDQUFDQyxNQUFNLENBQUM7SUFBRTtJQUNoQkcsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNESSxVQUFVLEVBQUU7SUFDVlIsSUFBSSxFQUFFLENBQUNDLE1BQU07RUFDZixDQUFDO0VBQ0RRLEtBQUssRUFBRTtJQUNMVCxJQUFJLEVBQUVDLE1BQU07SUFDWkcsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNETSxLQUFLLEVBQUU7SUFDTFYsSUFBSSxFQUFFVyxNQUFNO0lBQ1pQLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDRFEsUUFBUSxFQUFFO0lBQ1JaLElBQUksRUFBRUMsTUFBTTtJQUNaRyxRQUFRLEVBQUUsSUFBSTtJQUNkWCxPQUFPLEVBQUUsS0FBSztJQUNkb0IsSUFBSSxFQUFFLENBQUMsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLO0VBQzVCLENBQUM7RUFDREMsS0FBSyxFQUFFO0lBQ0xkLElBQUksRUFBRVcsTUFBTTtJQUNabEIsT0FBTyxFQUFFLENBQUM7SUFDVlcsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNEVyxRQUFRLEVBQUU7SUFDUmYsSUFBSSxFQUFFQyxNQUFNO0lBQ1pHLFFBQVEsRUFBRSxJQUFJO0lBQ2RYLE9BQU8sRUFBRSxVQUFVO0lBQ25Cb0IsSUFBSSxFQUFFLENBQUMsVUFBVSxFQUFFLFNBQVM7RUFDOUI7QUFDRixDQUFDLEVBQ0Q7RUFDRUcsR0FBRyxFQUFFLElBQUk7RUFDVEMsVUFBVSxFQUFFLFVBQVU7RUFDdEJDLFVBQVUsRUFBRSxJQUFJO0VBQ2hCQyxNQUFNLEVBQUU7SUFDTkMsU0FBUyxFQUFFQSxDQUFDQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztNQUN2QixPQUFPQSxHQUFHLENBQUNDLEdBQUc7TUFDZCxPQUFPO1FBQ0wsR0FBR0Q7TUFDTCxDQUFDO0lBQ0g7RUFDRjtBQUNGLENBQ0YsQ0FBQztBQUVELE1BQU1FLFFBQVEsR0FBRzdCLGlCQUFRLENBQUM4QixLQUFLLENBQUMsVUFBVSxFQUFFM0IsY0FBYyxDQUFDO0FBQUMsSUFBQTRCLFFBQUEsR0FBQUMsT0FBQSxDQUFBbEMsT0FBQSxHQUU3QytCLFFBQVEiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","_bcryptjs","_uuid","e","__esModule","default","Schema","mongoose","ObjectId","Types","ProductsSchema","uuid","type","String","id","unique","required","name","definition","images","categories","brand","price","Number","currency","enum","stock","itemType","_id","collection","timestamps","toJSON","transform","doc","ret","__v","Products","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["products.js"],"sourcesContent":["import mongoose from \"mongoose\";\nimport bcrypt from \"bcryptjs\";\nimport id from \"../utils/uuid\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\n\nconst ProductsSchema = new Schema(\n  {\n    uuid: {\n      type: String,\n      default: id(),\n      unique: false,\n      required: true,\n    },\n    name: {\n      type: String,\n      required: true,\n    },\n    definition: {\n      type: String,\n      required: true,\n    },\n    images: {\n      type: [String], //text array olacak\n      required: true,\n    },\n    categories: {\n      type: [String],\n    },\n    brand: {\n      type: String,\n      required: true,\n    },\n    price: {\n      type: Number,\n      required: true,\n    },\n    currency: {\n      type: String,\n      required: true,\n      default: \"TRY\",\n      enum: [\"TRY\", \"USD\", \"EUR\"],\n    },\n    stock: {\n      type: Number,\n      default: 1,\n      required: true,\n    },\n    itemType: {\n      type: String,\n      required: true,\n      default: \"PHYSICAL\",\n      enum: [\"PHYSICAL\", \"VIRTUAL\"],\n    },\n  },\n  {\n    _id: true,\n    collection: \"products\",\n    timestamps: true,\n    toJSON: {\n      transform: (doc, ret) => {\n        delete ret.__v;\n        return {\n          ...ret,\n        };\n      },\n    },\n  }\n);\n\nconst Products = mongoose.model(\"Products\", ProductsSchema);\n\nexport default Products;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,KAAA,GAAAH,sBAAA,CAAAC,OAAA;AAA+B,SAAAD,uBAAAI,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE/B,MAAMG,MAAM,GAAGC,iBAAQ,CAACD,MAAM;AAC9B,MAAM;EAAEE;AAAS,CAAC,GAAGF,MAAM,CAACG,KAAK;AAEjC,MAAMC,cAAc,GAAG,IAAIJ,MAAM,CAC/B;EACEK,IAAI,EAAE;IACJC,IAAI,EAAEC,MAAM;IACZR,OAAO,EAAE,IAAAS,aAAE,EAAC,CAAC;IACbC,MAAM,EAAE,KAAK;IACbC,QAAQ,EAAE;EACZ,CAAC;EACDC,IAAI,EAAE;IACJL,IAAI,EAAEC,MAAM;IACZG,QAAQ,EAAE;EACZ,CAAC;EACDE,UAAU,EAAE;IACVN,IAAI,EAAEC,MAAM;IACZG,QAAQ,EAAE;EACZ,CAAC;EACDG,MAAM,EAAE;IACNP,IAAI,EAAE,CAACC,MAAM,CAAC;IAAE;IAChBG,QAAQ,EAAE;EACZ,CAAC;EACDI,UAAU,EAAE;IACVR,IAAI,EAAE,CAACC,MAAM;EACf,CAAC;EACDQ,KAAK,EAAE;IACLT,IAAI,EAAEC,MAAM;IACZG,QAAQ,EAAE;EACZ,CAAC;EACDM,KAAK,EAAE;IACLV,IAAI,EAAEW,MAAM;IACZP,QAAQ,EAAE;EACZ,CAAC;EACDQ,QAAQ,EAAE;IACRZ,IAAI,EAAEC,MAAM;IACZG,QAAQ,EAAE,IAAI;IACdX,OAAO,EAAE,KAAK;IACdoB,IAAI,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK;EAC5B,CAAC;EACDC,KAAK,EAAE;IACLd,IAAI,EAAEW,MAAM;IACZlB,OAAO,EAAE,CAAC;IACVW,QAAQ,EAAE;EACZ,CAAC;EACDW,QAAQ,EAAE;IACRf,IAAI,EAAEC,MAAM;IACZG,QAAQ,EAAE,IAAI;IACdX,OAAO,EAAE,UAAU;IACnBoB,IAAI,EAAE,CAAC,UAAU,EAAE,SAAS;EAC9B;AACF,CAAC,EACD;EACEG,GAAG,EAAE,IAAI;EACTC,UAAU,EAAE,UAAU;EACtBC,UAAU,EAAE,IAAI;EAChBC,MAAM,EAAE;IACNC,SAAS,EAAEA,CAACC,GAAG,EAAEC,GAAG,KAAK;MACvB,OAAOA,GAAG,CAACC,GAAG;MACd,OAAO;QACL,GAAGD;MACL,CAAC;IACH;EACF;AACF,CACF,CAAC;AAED,MAAME,QAAQ,GAAG7B,iBAAQ,CAAC8B,KAAK,CAAC,UAAU,EAAE3B,cAAc,CAAC;AAAC,IAAA4B,QAAA,GAAAC,OAAA,CAAAlC,OAAA,GAE7C+B,QAAQ","ignoreList":[]}},"mtime":1722424936372},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/Products.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nvar _products = _interopRequireDefault(require(\"../db/products\"));\nvar _multer = _interopRequireDefault(require(\"multer\"));\nvar _path = _interopRequireDefault(require(\"path\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst upload = (0, _multer.default)({\n  storage: _multer.default.diskStorage({\n    destination: (req, file, cb) => {\n      cb(null, \"public/images\");\n    },\n    filename: (req, file, cb) => {\n      //const uniqueSuffix = Date.now() + \"-\" + Math.round(Math.random() * 1e9);\n      const originalName = file.originalname;\n      cb(null, originalName);\n    }\n  }),\n  fileFilter: (req, file, cb) => {\n    // İzin verilen dosya türleri\n    const fileTypes = /jpeg|jpg|png/;\n    // Dosya uzantısı\n    const extname = fileTypes.test(_path.default.extname(file.originalname).toLowerCase());\n    // MIME türü\n    const mimetype = fileTypes.test(file.mimetype);\n    if (mimetype && extname) {\n      return cb(null, true);\n    } else {\n      cb(new _ApiError.default(\"Invalid file type. Only JPEG, JPG, and PNG are allowed.\", 400, \"InvalidFileType\"));\n    }\n  }\n});\nvar _default = router => {\n  router.post(\"/create-product\", _Session.default, upload.array(\"images\", 10), async (req, res, next) => {\n    try {\n      if (req.user.role !== \"admin\") {\n        //user role admin değilse burası değilde ekleme esnasındaki hata veriyor, buna bir bakalım(kod sorunsuz çalışıyor)\n        throw new _ApiError.default(\"Forbidden: Insufficient permissions\", 403, \"InsufficientPermissions\");\n      }\n      const {\n        name,\n        categories,\n        brand,\n        definition,\n        price,\n        stock\n      } = req.body;\n      const imagePaths = req.files.map(file => file.path);\n      const product = new _products.default({\n        name,\n        images: imagePaths,\n        categories,\n        brand,\n        definition,\n        price,\n        stock\n      });\n      await product.save();\n      res.status(201).json(product);\n    } catch (error) {\n      next(new _ApiError.default(\"Product could not be added\", 401, \"DoesNotAddedProduct\"));\n    }\n  });\n  router.get(\"/get-all-products\", async (req, res) => {\n    try {\n      const getAllProducts = await _products.default.find();\n      if (getAllProducts.length === 0) {\n        throw new _ApiError.default(\"There are no products available\", 404, \"noFindProduct\");\n      }\n      res.status(200).json(getAllProducts);\n    } catch (error) {\n      // Hata ApiError ise, hata kodunu ve mesajını kullan\n      if (error instanceof _ApiError.default) {\n        res.status(error.status).json({\n          message: error.message,\n          errorCode: error.code\n        });\n      } else {\n        // Eğer hata ApiError değilse, genel bir hata mesajı döndür\n        res.status(500).json({\n          message: \"An unexpected error occurred\",\n          errorCode: \"InternalServerError\"\n        });\n      }\n    }\n  });\n  router.get(\"/get-products-by-category\", async (req, res) => {\n    const category = req.query.category;\n    if (!category) {\n      return res.status(400).json(new _ApiError.default(\"Category is required\", 401, \"RequiredCategory\"));\n    }\n    try {\n      const products = await _products.default.find({\n        categories: category\n      });\n      res.status(200).json(products);\n    } catch (error) {\n      console.error(error);\n      res.status(500).json(new _ApiError.default(\"Products cannot be retrieved by category\", 401, \"CannotGetProductsByCategory\"));\n    }\n  });\n  router.get(\"/get-product-by-id/:id\", async (req, res) => {\n    const {\n      id\n    } = req.params;\n    try {\n      const product = await _products.default.findById(id);\n      if (!product) {\n        return res.status(404).json(new _ApiError.default(\"Product not found\", 404, \"ProductNotFound\"));\n      }\n      res.status(200).json(product);\n    } catch (error) {\n      console.error(error);\n      res.status(500).json(new _ApiError.default(\"Product cannot be retrieved\", 500, \"CannotGetProduct\"));\n    }\n  });\n  router.delete(\"/delete-product/:id\", _Session.default, async (req, res) => {\n    const id = req.params.id;\n    try {\n      const product = await _products.default.findOneAndDelete({\n        _id: id\n      });\n      if (product) {\n        res.status(200).json(`Product number ${id} was deleted`);\n      } else {\n        res.status(404).json(`Product with ID ${id} not found`);\n      }\n    } catch (error) {\n      res.status(500).json(new _ApiError.default(\"Cannot delete product\", 401, \"cannotDeleteProduct\"));\n    }\n  });\n  router.get(\"/get-categories\", async (req, res) => {\n    try {\n      const products = await _products.default.find({});\n      const categories = {};\n      products.forEach(product => {\n        product.categories.forEach(cat => {\n          if (!categories[cat]) {\n            categories[cat] = [];\n          }\n          categories[cat].push(product);\n        });\n      });\n      res.json(categories);\n    } catch (err) {\n      console.error(err);\n      res.status(500).json(new _ApiError.default(\"Cannot get categories\", 401, \"cannotGetCategories\"));\n    }\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQXBpRXJyb3IiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9TZXNzaW9uIiwiX3Byb2R1Y3RzIiwiX211bHRlciIsIl9wYXRoIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwidXBsb2FkIiwibXVsdGVyIiwic3RvcmFnZSIsImRpc2tTdG9yYWdlIiwiZGVzdGluYXRpb24iLCJyZXEiLCJmaWxlIiwiY2IiLCJmaWxlbmFtZSIsIm9yaWdpbmFsTmFtZSIsIm9yaWdpbmFsbmFtZSIsImZpbGVGaWx0ZXIiLCJmaWxlVHlwZXMiLCJleHRuYW1lIiwidGVzdCIsInBhdGgiLCJ0b0xvd2VyQ2FzZSIsIm1pbWV0eXBlIiwiQXBpRXJyb3IiLCJfZGVmYXVsdCIsInJvdXRlciIsInBvc3QiLCJTZXNzaW9uIiwiYXJyYXkiLCJyZXMiLCJuZXh0IiwidXNlciIsInJvbGUiLCJuYW1lIiwiY2F0ZWdvcmllcyIsImJyYW5kIiwiZGVmaW5pdGlvbiIsInByaWNlIiwic3RvY2siLCJib2R5IiwiaW1hZ2VQYXRocyIsImZpbGVzIiwibWFwIiwicHJvZHVjdCIsIlByb2R1Y3RzIiwiaW1hZ2VzIiwic2F2ZSIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsImdldCIsImdldEFsbFByb2R1Y3RzIiwiZmluZCIsImxlbmd0aCIsIm1lc3NhZ2UiLCJlcnJvckNvZGUiLCJjb2RlIiwiY2F0ZWdvcnkiLCJxdWVyeSIsInByb2R1Y3RzIiwiY29uc29sZSIsImlkIiwicGFyYW1zIiwiZmluZEJ5SWQiLCJkZWxldGUiLCJmaW5kT25lQW5kRGVsZXRlIiwiX2lkIiwiZm9yRWFjaCIsImNhdCIsInB1c2giLCJlcnIiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvcm91dGVzLyIsInNvdXJjZXMiOlsiUHJvZHVjdHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuLi9lcnJvcnMvQXBpRXJyb3JcIjtcbmltcG9ydCBTZXNzaW9uIGZyb20gXCIuLi9taWRkbGV3YXJlcy9TZXNzaW9uXCI7XG5pbXBvcnQgUHJvZHVjdHMgZnJvbSBcIi4uL2RiL3Byb2R1Y3RzXCI7XG5pbXBvcnQgbXVsdGVyIGZyb20gXCJtdWx0ZXJcIjtcbmltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XG5cbmNvbnN0IHVwbG9hZCA9IG11bHRlcih7XG4gIHN0b3JhZ2U6IG11bHRlci5kaXNrU3RvcmFnZSh7XG4gICAgZGVzdGluYXRpb246IChyZXEsIGZpbGUsIGNiKSA9PiB7XG4gICAgICBjYihudWxsLCBcInB1YmxpYy9pbWFnZXNcIik7XG4gICAgfSxcbiAgICBmaWxlbmFtZTogKHJlcSwgZmlsZSwgY2IpID0+IHtcbiAgICAgIC8vY29uc3QgdW5pcXVlU3VmZml4ID0gRGF0ZS5ub3coKSArIFwiLVwiICsgTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogMWU5KTtcbiAgICAgIGNvbnN0IG9yaWdpbmFsTmFtZSA9IGZpbGUub3JpZ2luYWxuYW1lO1xuICAgICAgY2IobnVsbCwgb3JpZ2luYWxOYW1lKTtcbiAgICB9LFxuICB9KSxcbiAgZmlsZUZpbHRlcjogKHJlcSwgZmlsZSwgY2IpID0+IHtcbiAgICAvLyDEsHppbiB2ZXJpbGVuIGRvc3lhIHTDvHJsZXJpXG4gICAgY29uc3QgZmlsZVR5cGVzID0gL2pwZWd8anBnfHBuZy87XG4gICAgLy8gRG9zeWEgdXphbnTEsXPEsVxuICAgIGNvbnN0IGV4dG5hbWUgPSBmaWxlVHlwZXMudGVzdChcbiAgICAgIHBhdGguZXh0bmFtZShmaWxlLm9yaWdpbmFsbmFtZSkudG9Mb3dlckNhc2UoKVxuICAgICk7XG4gICAgLy8gTUlNRSB0w7xyw7xcbiAgICBjb25zdCBtaW1ldHlwZSA9IGZpbGVUeXBlcy50ZXN0KGZpbGUubWltZXR5cGUpO1xuXG4gICAgaWYgKG1pbWV0eXBlICYmIGV4dG5hbWUpIHtcbiAgICAgIHJldHVybiBjYihudWxsLCB0cnVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY2IoXG4gICAgICAgIG5ldyBBcGlFcnJvcihcbiAgICAgICAgICBcIkludmFsaWQgZmlsZSB0eXBlLiBPbmx5IEpQRUcsIEpQRywgYW5kIFBORyBhcmUgYWxsb3dlZC5cIixcbiAgICAgICAgICA0MDAsXG4gICAgICAgICAgXCJJbnZhbGlkRmlsZVR5cGVcIlxuICAgICAgICApXG4gICAgICApO1xuICAgIH1cbiAgfSxcbn0pO1xuXG5leHBvcnQgZGVmYXVsdCAocm91dGVyKSA9PiB7XG4gIHJvdXRlci5wb3N0KFxuICAgIFwiL2NyZWF0ZS1wcm9kdWN0XCIsXG4gICAgU2Vzc2lvbixcbiAgICB1cGxvYWQuYXJyYXkoXCJpbWFnZXNcIiwgMTApLFxuICAgIGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgaWYgKHJlcS51c2VyLnJvbGUgIT09IFwiYWRtaW5cIikge1xuICAgICAgICAgIC8vdXNlciByb2xlIGFkbWluIGRlxJ9pbHNlIGJ1cmFzxLEgZGXEn2lsZGUgZWtsZW1lIGVzbmFzxLFuZGFraSBoYXRhIHZlcml5b3IsIGJ1bmEgYmlyIGJha2FsxLFtKGtvZCBzb3J1bnN1eiDDp2FsxLHFn8SxeW9yKVxuICAgICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgICAgIFwiRm9yYmlkZGVuOiBJbnN1ZmZpY2llbnQgcGVybWlzc2lvbnNcIixcbiAgICAgICAgICAgIDQwMyxcbiAgICAgICAgICAgIFwiSW5zdWZmaWNpZW50UGVybWlzc2lvbnNcIlxuICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB7IG5hbWUsIGNhdGVnb3JpZXMsIGJyYW5kLCBkZWZpbml0aW9uLCBwcmljZSwgc3RvY2sgfSA9IHJlcS5ib2R5O1xuICAgICAgICBjb25zdCBpbWFnZVBhdGhzID0gcmVxLmZpbGVzLm1hcCgoZmlsZSkgPT4gZmlsZS5wYXRoKTtcblxuICAgICAgICBjb25zdCBwcm9kdWN0ID0gbmV3IFByb2R1Y3RzKHtcbiAgICAgICAgICBuYW1lLFxuICAgICAgICAgIGltYWdlczogaW1hZ2VQYXRocyxcbiAgICAgICAgICBjYXRlZ29yaWVzLFxuICAgICAgICAgIGJyYW5kLFxuICAgICAgICAgIGRlZmluaXRpb24sXG4gICAgICAgICAgcHJpY2UsXG4gICAgICAgICAgc3RvY2ssXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGF3YWl0IHByb2R1Y3Quc2F2ZSgpO1xuICAgICAgICByZXMuc3RhdHVzKDIwMSkuanNvbihwcm9kdWN0KTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIG5leHQoXG4gICAgICAgICAgbmV3IEFwaUVycm9yKFwiUHJvZHVjdCBjb3VsZCBub3QgYmUgYWRkZWRcIiwgNDAxLCBcIkRvZXNOb3RBZGRlZFByb2R1Y3RcIilcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG4gICk7XG5cbiAgcm91dGVyLmdldChcIi9nZXQtYWxsLXByb2R1Y3RzXCIsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBnZXRBbGxQcm9kdWN0cyA9IGF3YWl0IFByb2R1Y3RzLmZpbmQoKTtcblxuICAgICAgaWYgKGdldEFsbFByb2R1Y3RzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgXCJUaGVyZSBhcmUgbm8gcHJvZHVjdHMgYXZhaWxhYmxlXCIsXG4gICAgICAgICAgNDA0LFxuICAgICAgICAgIFwibm9GaW5kUHJvZHVjdFwiXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKGdldEFsbFByb2R1Y3RzKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gSGF0YSBBcGlFcnJvciBpc2UsIGhhdGEga29kdW51IHZlIG1lc2FqxLFuxLEga3VsbGFuXG4gICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBBcGlFcnJvcikge1xuICAgICAgICByZXMuc3RhdHVzKGVycm9yLnN0YXR1cykuanNvbih7XG4gICAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgICBlcnJvckNvZGU6IGVycm9yLmNvZGUsXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRcSfZXIgaGF0YSBBcGlFcnJvciBkZcSfaWxzZSwgZ2VuZWwgYmlyIGhhdGEgbWVzYWrEsSBkw7ZuZMO8clxuICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XG4gICAgICAgICAgbWVzc2FnZTogXCJBbiB1bmV4cGVjdGVkIGVycm9yIG9jY3VycmVkXCIsXG4gICAgICAgICAgZXJyb3JDb2RlOiBcIkludGVybmFsU2VydmVyRXJyb3JcIixcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICByb3V0ZXIuZ2V0KFwiL2dldC1wcm9kdWN0cy1ieS1jYXRlZ29yeVwiLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICBjb25zdCBjYXRlZ29yeSA9IHJlcS5xdWVyeS5jYXRlZ29yeTtcbiAgICBpZiAoIWNhdGVnb3J5KSB7XG4gICAgICByZXR1cm4gcmVzXG4gICAgICAgIC5zdGF0dXMoNDAwKVxuICAgICAgICAuanNvbihuZXcgQXBpRXJyb3IoXCJDYXRlZ29yeSBpcyByZXF1aXJlZFwiLCA0MDEsIFwiUmVxdWlyZWRDYXRlZ29yeVwiKSk7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgUHJvZHVjdHMuZmluZCh7XG4gICAgICAgIGNhdGVnb3JpZXM6IGNhdGVnb3J5LFxuICAgICAgfSk7XG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbihwcm9kdWN0cyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgcmVzXG4gICAgICAgIC5zdGF0dXMoNTAwKVxuICAgICAgICAuanNvbihcbiAgICAgICAgICBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgICBcIlByb2R1Y3RzIGNhbm5vdCBiZSByZXRyaWV2ZWQgYnkgY2F0ZWdvcnlcIixcbiAgICAgICAgICAgIDQwMSxcbiAgICAgICAgICAgIFwiQ2Fubm90R2V0UHJvZHVjdHNCeUNhdGVnb3J5XCJcbiAgICAgICAgICApXG4gICAgICAgICk7XG4gICAgfVxuICB9KTtcblxuICByb3V0ZXIuZ2V0KFwiL2dldC1wcm9kdWN0LWJ5LWlkLzppZFwiLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICBjb25zdCB7IGlkIH0gPSByZXEucGFyYW1zO1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBQcm9kdWN0cy5maW5kQnlJZChpZCk7XG4gICAgICBpZiAoIXByb2R1Y3QpIHtcbiAgICAgICAgcmV0dXJuIHJlc1xuICAgICAgICAgIC5zdGF0dXMoNDA0KVxuICAgICAgICAgIC5qc29uKG5ldyBBcGlFcnJvcihcIlByb2R1Y3Qgbm90IGZvdW5kXCIsIDQwNCwgXCJQcm9kdWN0Tm90Rm91bmRcIikpO1xuICAgICAgfVxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24ocHJvZHVjdCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgcmVzXG4gICAgICAgIC5zdGF0dXMoNTAwKVxuICAgICAgICAuanNvbihcbiAgICAgICAgICBuZXcgQXBpRXJyb3IoXCJQcm9kdWN0IGNhbm5vdCBiZSByZXRyaWV2ZWRcIiwgNTAwLCBcIkNhbm5vdEdldFByb2R1Y3RcIilcbiAgICAgICAgKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJvdXRlci5kZWxldGUoXCIvZGVsZXRlLXByb2R1Y3QvOmlkXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGNvbnN0IGlkID0gcmVxLnBhcmFtcy5pZDtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcHJvZHVjdCA9IGF3YWl0IFByb2R1Y3RzLmZpbmRPbmVBbmREZWxldGUoeyBfaWQ6IGlkIH0pO1xuICAgICAgaWYgKHByb2R1Y3QpIHtcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oYFByb2R1Y3QgbnVtYmVyICR7aWR9IHdhcyBkZWxldGVkYCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXMuc3RhdHVzKDQwNCkuanNvbihgUHJvZHVjdCB3aXRoIElEICR7aWR9IG5vdCBmb3VuZGApO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXNcbiAgICAgICAgLnN0YXR1cyg1MDApXG4gICAgICAgIC5qc29uKFxuICAgICAgICAgIG5ldyBBcGlFcnJvcihcIkNhbm5vdCBkZWxldGUgcHJvZHVjdFwiLCA0MDEsIFwiY2Fubm90RGVsZXRlUHJvZHVjdFwiKVxuICAgICAgICApO1xuICAgIH1cbiAgfSk7XG5cbiAgcm91dGVyLmdldChcIi9nZXQtY2F0ZWdvcmllc1wiLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBQcm9kdWN0cy5maW5kKHt9KTtcbiAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSB7fTtcblxuICAgICAgcHJvZHVjdHMuZm9yRWFjaCgocHJvZHVjdCkgPT4ge1xuICAgICAgICBwcm9kdWN0LmNhdGVnb3JpZXMuZm9yRWFjaCgoY2F0KSA9PiB7XG4gICAgICAgICAgaWYgKCFjYXRlZ29yaWVzW2NhdF0pIHtcbiAgICAgICAgICAgIGNhdGVnb3JpZXNbY2F0XSA9IFtdO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjYXRlZ29yaWVzW2NhdF0ucHVzaChwcm9kdWN0KTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgcmVzLmpzb24oY2F0ZWdvcmllcyk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICByZXNcbiAgICAgICAgLnN0YXR1cyg1MDApXG4gICAgICAgIC5qc29uKFxuICAgICAgICAgIG5ldyBBcGlFcnJvcihcIkNhbm5vdCBnZXQgY2F0ZWdvcmllc1wiLCA0MDEsIFwiY2Fubm90R2V0Q2F0ZWdvcmllc1wiKVxuICAgICAgICApO1xuICAgIH1cbiAgfSk7XG59O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxTQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxRQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxTQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRyxPQUFBLEdBQUFKLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSSxLQUFBLEdBQUFMLHNCQUFBLENBQUFDLE9BQUE7QUFBd0IsU0FBQUQsdUJBQUFNLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFeEIsTUFBTUcsTUFBTSxHQUFHLElBQUFDLGVBQU0sRUFBQztFQUNwQkMsT0FBTyxFQUFFRCxlQUFNLENBQUNFLFdBQVcsQ0FBQztJQUMxQkMsV0FBVyxFQUFFQSxDQUFDQyxHQUFHLEVBQUVDLElBQUksRUFBRUMsRUFBRSxLQUFLO01BQzlCQSxFQUFFLENBQUMsSUFBSSxFQUFFLGVBQWUsQ0FBQztJQUMzQixDQUFDO0lBQ0RDLFFBQVEsRUFBRUEsQ0FBQ0gsR0FBRyxFQUFFQyxJQUFJLEVBQUVDLEVBQUUsS0FBSztNQUMzQjtNQUNBLE1BQU1FLFlBQVksR0FBR0gsSUFBSSxDQUFDSSxZQUFZO01BQ3RDSCxFQUFFLENBQUMsSUFBSSxFQUFFRSxZQUFZLENBQUM7SUFDeEI7RUFDRixDQUFDLENBQUM7RUFDRkUsVUFBVSxFQUFFQSxDQUFDTixHQUFHLEVBQUVDLElBQUksRUFBRUMsRUFBRSxLQUFLO0lBQzdCO0lBQ0EsTUFBTUssU0FBUyxHQUFHLGNBQWM7SUFDaEM7SUFDQSxNQUFNQyxPQUFPLEdBQUdELFNBQVMsQ0FBQ0UsSUFBSSxD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","map":{"version":3,"names":["_ApiError","_interopRequireDefault","require","_Session","_products","_multer","_path","e","__esModule","default","upload","multer","storage","diskStorage","destination","req","file","cb","filename","originalName","originalname","fileFilter","fileTypes","extname","test","path","toLowerCase","mimetype","ApiError","_default","router","post","Session","array","res","next","user","role","name","categories","brand","definition","price","stock","body","imagePaths","files","map","product","Products","images","save","status","json","error","get","getAllProducts","find","length","message","errorCode","code","category","query","products","console","id","params","findById","delete","findOneAndDelete","_id","forEach","cat","push","err","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["Products.js"],"sourcesContent":["import ApiError from \"../errors/ApiError\";\nimport Session from \"../middlewares/Session\";\nimport Products from \"../db/products\";\nimport multer from \"multer\";\nimport path from \"path\";\n\nconst upload = multer({\n  storage: multer.diskStorage({\n    destination: (req, file, cb) => {\n      cb(null, \"public/images\");\n    },\n    filename: (req, file, cb) => {\n      //const uniqueSuffix = Date.now() + \"-\" + Math.round(Math.random() * 1e9);\n      const originalName = file.originalname;\n      cb(null, originalName);\n    },\n  }),\n  fileFilter: (req, file, cb) => {\n    // İzin verilen dosya türleri\n    const fileTypes = /jpeg|jpg|png/;\n    // Dosya uzantısı\n    const extname = fileTypes.test(\n      path.extname(file.originalname).toLowerCase()\n    );\n    // MIME türü\n    const mimetype = fileTypes.test(file.mimetype);\n\n    if (mimetype && extname) {\n      return cb(null, true);\n    } else {\n      cb(\n        new ApiError(\n          \"Invalid file type. Only JPEG, JPG, and PNG are allowed.\",\n          400,\n          \"InvalidFileType\"\n        )\n      );\n    }\n  },\n});\n\nexport default (router) => {\n  router.post(\n    \"/create-product\",\n    Session,\n    upload.array(\"images\", 10),\n    async (req, res, next) => {\n      try {\n        if (req.user.role !== \"admin\") {\n          //user role admin değilse burası değilde ekleme esnasındaki hata veriyor, buna bir bakalım(kod sorunsuz çalışıyor)\n          throw new ApiError(\n            \"Forbidden: Insufficient permissions\",\n            403,\n            \"InsufficientPermissions\"\n          );\n        }\n\n        const { name, categories, brand, definition, price, stock } = req.body;\n        const imagePaths = req.files.map((file) => file.path);\n\n        const product = new Products({\n          name,\n          images: imagePaths,\n          categories,\n          brand,\n          definition,\n          price,\n          stock,\n        });\n\n        await product.save();\n        res.status(201).json(product);\n      } catch (error) {\n        next(\n          new ApiError(\"Product could not be added\", 401, \"DoesNotAddedProduct\")\n        );\n      }\n    }\n  );\n\n  router.get(\"/get-all-products\", async (req, res) => {\n    try {\n      const getAllProducts = await Products.find();\n\n      if (getAllProducts.length === 0) {\n        throw new ApiError(\n          \"There are no products available\",\n          404,\n          \"noFindProduct\"\n        );\n      }\n\n      res.status(200).json(getAllProducts);\n    } catch (error) {\n      // Hata ApiError ise, hata kodunu ve mesajını kullan\n      if (error instanceof ApiError) {\n        res.status(error.status).json({\n          message: error.message,\n          errorCode: error.code,\n        });\n      } else {\n        // Eğer hata ApiError değilse, genel bir hata mesajı döndür\n        res.status(500).json({\n          message: \"An unexpected error occurred\",\n          errorCode: \"InternalServerError\",\n        });\n      }\n    }\n  });\n\n  router.get(\"/get-products-by-category\", async (req, res) => {\n    const category = req.query.category;\n    if (!category) {\n      return res\n        .status(400)\n        .json(new ApiError(\"Category is required\", 401, \"RequiredCategory\"));\n    }\n\n    try {\n      const products = await Products.find({\n        categories: category,\n      });\n      res.status(200).json(products);\n    } catch (error) {\n      console.error(error);\n      res\n        .status(500)\n        .json(\n          new ApiError(\n            \"Products cannot be retrieved by category\",\n            401,\n            \"CannotGetProductsByCategory\"\n          )\n        );\n    }\n  });\n\n  router.get(\"/get-product-by-id/:id\", async (req, res) => {\n    const { id } = req.params;\n\n    try {\n      const product = await Products.findById(id);\n      if (!product) {\n        return res\n          .status(404)\n          .json(new ApiError(\"Product not found\", 404, \"ProductNotFound\"));\n      }\n      res.status(200).json(product);\n    } catch (error) {\n      console.error(error);\n      res\n        .status(500)\n        .json(\n          new ApiError(\"Product cannot be retrieved\", 500, \"CannotGetProduct\")\n        );\n    }\n  });\n\n  router.delete(\"/delete-product/:id\", Session, async (req, res) => {\n    const id = req.params.id;\n    try {\n      const product = await Products.findOneAndDelete({ _id: id });\n      if (product) {\n        res.status(200).json(`Product number ${id} was deleted`);\n      } else {\n        res.status(404).json(`Product with ID ${id} not found`);\n      }\n    } catch (error) {\n      res\n        .status(500)\n        .json(\n          new ApiError(\"Cannot delete product\", 401, \"cannotDeleteProduct\")\n        );\n    }\n  });\n\n  router.get(\"/get-categories\", async (req, res) => {\n    try {\n      const products = await Products.find({});\n      const categories = {};\n\n      products.forEach((product) => {\n        product.categories.forEach((cat) => {\n          if (!categories[cat]) {\n            categories[cat] = [];\n          }\n          categories[cat].push(product);\n        });\n      });\n\n      res.json(categories);\n    } catch (err) {\n      console.error(err);\n      res\n        .status(500)\n        .json(\n          new ApiError(\"Cannot get categories\", 401, \"cannotGetCategories\")\n        );\n    }\n  });\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1723467324171},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/Products.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nvar _products = _interopRequireDefault(require(\"../db/products\"));\nvar _multer = _interopRequireDefault(require(\"multer\"));\nvar _path = _interopRequireDefault(require(\"path\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst upload = (0, _multer.default)({\n  storage: _multer.default.diskStorage({\n    destination: (req, file, cb) => {\n      cb(null, \"public/images\");\n    },\n    filename: (req, file, cb) => {\n      //const uniqueSuffix = Date.now() + \"-\" + Math.round(Math.random() * 1e9);\n      const originalName = file.originalname;\n      cb(null, originalName);\n    }\n  }),\n  fileFilter: (req, file, cb) => {\n    // İzin verilen dosya türleri\n    const fileTypes = /jpeg|jpg|png/;\n    // Dosya uzantısı\n    const extname = fileTypes.test(_path.default.extname(file.originalname).toLowerCase());\n    // MIME türü\n    const mimetype = fileTypes.test(file.mimetype);\n    if (mimetype && extname) {\n      return cb(null, true);\n    } else {\n      cb(new _ApiError.default(\"Invalid file type. Only JPEG, JPG, and PNG are allowed.\", 400, \"InvalidFileType\"));\n    }\n  }\n});\nvar _default = router => {\n  router.post(\"/create-product\", _Session.default, upload.array(\"images\", 10), async (req, res, next) => {\n    try {\n      if (req.user.role !== \"admin\") {\n        //user role admin değilse burası değilde ekleme esnasındaki hata veriyor, buna bir bakalım(kod sorunsuz çalışıyor)\n        throw new _ApiError.default(\"Forbidden: Insufficient permissions\", 403, \"InsufficientPermissions\");\n      }\n      const {\n        name,\n        categories,\n        brand,\n        definition,\n        price,\n        stock\n      } = req.body;\n      const imagePaths = req.files.map(file => file.path);\n      const product = new _products.default({\n        name,\n        images: imagePaths,\n        categories,\n        brand,\n        definition,\n        price,\n        stock\n      });\n      await product.save();\n      res.status(201).json(product);\n    } catch (error) {\n      next(new _ApiError.default(\"Product could not be added\", 401, \"DoesNotAddedProduct\"));\n    }\n  });\n  router.get(\"/get-all-products\", async (req, res) => {\n    try {\n      const getAllProducts = await _products.default.find();\n      if (getAllProducts.length === 0) {\n        throw new _ApiError.default(\"There are no products available\", 404, \"noFindProduct\");\n      }\n      res.status(200).json(getAllProducts);\n    } catch (error) {\n      // Hata ApiError ise, hata kodunu ve mesajını kullan\n      if (error instanceof _ApiError.default) {\n        res.status(error.status).json({\n          message: error.message,\n          errorCode: error.code\n        });\n      } else {\n        // Eğer hata ApiError değilse, genel bir hata mesajı döndür\n        res.status(500).json({\n          message: \"An unexpected error occurred\",\n          errorCode: \"InternalServerError\"\n        });\n      }\n    }\n  });\n  router.get(\"/get-products-by-category\", async (req, res) => {\n    const category = req.query.category;\n    if (!category) {\n      return res.status(400).json(new _ApiError.default(\"Category is required\", 401, \"RequiredCategory\"));\n    }\n    try {\n      const products = await _products.default.find({\n        categories: category\n      });\n      res.status(200).json(products);\n    } catch (error) {\n      console.error(error);\n      res.status(500).json(new _ApiError.default(\"Products cannot be retrieved by category\", 401, \"CannotGetProductsByCategory\"));\n    }\n  });\n  router.get(\"/get-product-by-id/:id\", async (req, res) => {\n    const {\n      id\n    } = req.params;\n    try {\n      const product = await _products.default.findById(id);\n      if (!product) {\n        return res.status(404).json(new _ApiError.default(\"Product not found\", 404, \"ProductNotFound\"));\n      }\n      res.status(200).json(product);\n    } catch (error) {\n      console.error(error);\n      res.status(500).json(new _ApiError.default(\"Product cannot be retrieved\", 500, \"CannotGetProduct\"));\n    }\n  });\n  router.delete(\"/delete-product/:id\", _Session.default, async (req, res) => {\n    const id = req.params.id;\n    try {\n      const product = await _products.default.findOneAndDelete({\n        _id: id\n      });\n      if (product) {\n        res.status(200).json(`Product number ${id} was deleted`);\n      } else {\n        res.status(404).json(`Product with ID ${id} not found`);\n      }\n    } catch (error) {\n      res.status(500).json(new _ApiError.default(\"Cannot delete product\", 401, \"cannotDeleteProduct\"));\n    }\n  });\n  router.get(\"/get-categories\", async (req, res) => {\n    try {\n      const products = await _products.default.find({});\n      const categories = {};\n      products.forEach(product => {\n        product.categories.forEach(cat => {\n          if (!categories[cat]) {\n            categories[cat] = [];\n          }\n          categories[cat].push(product);\n        });\n      });\n      res.json(categories);\n    } catch (err) {\n      console.error(err);\n      res.status(500).json(new _ApiError.default(\"Cannot get categories\", 401, \"cannotGetCategories\"));\n    }\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQXBpRXJyb3IiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9TZXNzaW9uIiwiX3Byb2R1Y3RzIiwiX211bHRlciIsIl9wYXRoIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwidXBsb2FkIiwibXVsdGVyIiwic3RvcmFnZSIsImRpc2tTdG9yYWdlIiwiZGVzdGluYXRpb24iLCJyZXEiLCJmaWxlIiwiY2IiLCJmaWxlbmFtZSIsIm9yaWdpbmFsTmFtZSIsIm9yaWdpbmFsbmFtZSIsImZpbGVGaWx0ZXIiLCJmaWxlVHlwZXMiLCJleHRuYW1lIiwidGVzdCIsInBhdGgiLCJ0b0xvd2VyQ2FzZSIsIm1pbWV0eXBlIiwiQXBpRXJyb3IiLCJfZGVmYXVsdCIsInJvdXRlciIsInBvc3QiLCJTZXNzaW9uIiwiYXJyYXkiLCJyZXMiLCJuZXh0IiwidXNlciIsInJvbGUiLCJuYW1lIiwiY2F0ZWdvcmllcyIsImJyYW5kIiwiZGVmaW5pdGlvbiIsInByaWNlIiwic3RvY2siLCJib2R5IiwiaW1hZ2VQYXRocyIsImZpbGVzIiwibWFwIiwicHJvZHVjdCIsIlByb2R1Y3RzIiwiaW1hZ2VzIiwic2F2ZSIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsImdldCIsImdldEFsbFByb2R1Y3RzIiwiZmluZCIsImxlbmd0aCIsIm1lc3NhZ2UiLCJlcnJvckNvZGUiLCJjb2RlIiwiY2F0ZWdvcnkiLCJxdWVyeSIsInByb2R1Y3RzIiwiY29uc29sZSIsImlkIiwicGFyYW1zIiwiZmluZEJ5SWQiLCJkZWxldGUiLCJmaW5kT25lQW5kRGVsZXRlIiwiX2lkIiwiZm9yRWFjaCIsImNhdCIsInB1c2giLCJlcnIiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvcm91dGVzLyIsInNvdXJjZXMiOlsiUHJvZHVjdHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuLi9lcnJvcnMvQXBpRXJyb3JcIjtcbmltcG9ydCBTZXNzaW9uIGZyb20gXCIuLi9taWRkbGV3YXJlcy9TZXNzaW9uXCI7XG5pbXBvcnQgUHJvZHVjdHMgZnJvbSBcIi4uL2RiL3Byb2R1Y3RzXCI7XG5pbXBvcnQgbXVsdGVyIGZyb20gXCJtdWx0ZXJcIjtcbmltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XG5cbmNvbnN0IHVwbG9hZCA9IG11bHRlcih7XG4gIHN0b3JhZ2U6IG11bHRlci5kaXNrU3RvcmFnZSh7XG4gICAgZGVzdGluYXRpb246IChyZXEsIGZpbGUsIGNiKSA9PiB7XG4gICAgICBjYihudWxsLCBcInB1YmxpYy9pbWFnZXNcIik7XG4gICAgfSxcbiAgICBmaWxlbmFtZTogKHJlcSwgZmlsZSwgY2IpID0+IHtcbiAgICAgIC8vY29uc3QgdW5pcXVlU3VmZml4ID0gRGF0ZS5ub3coKSArIFwiLVwiICsgTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpICogMWU5KTtcbiAgICAgIGNvbnN0IG9yaWdpbmFsTmFtZSA9IGZpbGUub3JpZ2luYWxuYW1lO1xuICAgICAgY2IobnVsbCwgb3JpZ2luYWxOYW1lKTtcbiAgICB9LFxuICB9KSxcbiAgZmlsZUZpbHRlcjogKHJlcSwgZmlsZSwgY2IpID0+IHtcbiAgICAvLyDEsHppbiB2ZXJpbGVuIGRvc3lhIHTDvHJsZXJpXG4gICAgY29uc3QgZmlsZVR5cGVzID0gL2pwZWd8anBnfHBuZy87XG4gICAgLy8gRG9zeWEgdXphbnTEsXPEsVxuICAgIGNvbnN0IGV4dG5hbWUgPSBmaWxlVHlwZXMudGVzdChcbiAgICAgIHBhdGguZXh0bmFtZShmaWxlLm9yaWdpbmFsbmFtZSkudG9Mb3dlckNhc2UoKVxuICAgICk7XG4gICAgLy8gTUlNRSB0w7xyw7xcbiAgICBjb25zdCBtaW1ldHlwZSA9IGZpbGVUeXBlcy50ZXN0KGZpbGUubWltZXR5cGUpO1xuXG4gICAgaWYgKG1pbWV0eXBlICYmIGV4dG5hbWUpIHtcbiAgICAgIHJldHVybiBjYihudWxsLCB0cnVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgY2IoXG4gICAgICAgIG5ldyBBcGlFcnJvcihcbiAgICAgICAgICBcIkludmFsaWQgZmlsZSB0eXBlLiBPbmx5IEpQRUcsIEpQRywgYW5kIFBORyBhcmUgYWxsb3dlZC5cIixcbiAgICAgICAgICA0MDAsXG4gICAgICAgICAgXCJJbnZhbGlkRmlsZVR5cGVcIlxuICAgICAgICApXG4gICAgICApO1xuICAgIH1cbiAgfSxcbn0pO1xuXG5leHBvcnQgZGVmYXVsdCAocm91dGVyKSA9PiB7XG4gIHJvdXRlci5wb3N0KFxuICAgIFwiL2NyZWF0ZS1wcm9kdWN0XCIsXG4gICAgU2Vzc2lvbixcbiAgICB1cGxvYWQuYXJyYXkoXCJpbWFnZXNcIiwgMTApLFxuICAgIGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgaWYgKHJlcS51c2VyLnJvbGUgIT09IFwiYWRtaW5cIikge1xuICAgICAgICAgIC8vdXNlciByb2xlIGFkbWluIGRlxJ9pbHNlIGJ1cmFzxLEgZGXEn2lsZGUgZWtsZW1lIGVzbmFzxLFuZGFraSBoYXRhIHZlcml5b3IsIGJ1bmEgYmlyIGJha2FsxLFtKGtvZCBzb3J1bnN1eiDDp2FsxLHFn8SxeW9yKVxuICAgICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgICAgIFwiRm9yYmlkZGVuOiBJbnN1ZmZpY2llbnQgcGVybWlzc2lvbnNcIixcbiAgICAgICAgICAgIDQwMyxcbiAgICAgICAgICAgIFwiSW5zdWZmaWNpZW50UGVybWlzc2lvbnNcIlxuICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCB7IG5hbWUsIGNhdGVnb3JpZXMsIGJyYW5kLCBkZWZpbml0aW9uLCBwcmljZSwgc3RvY2sgfSA9IHJlcS5ib2R5O1xuICAgICAgICBjb25zdCBpbWFnZVBhdGhzID0gcmVxLmZpbGVzLm1hcCgoZmlsZSkgPT4gZmlsZS5wYXRoKTtcblxuICAgICAgICBjb25zdCBwcm9kdWN0ID0gbmV3IFByb2R1Y3RzKHtcbiAgICAgICAgICBuYW1lLFxuICAgICAgICAgIGltYWdlczogaW1hZ2VQYXRocyxcbiAgICAgICAgICBjYXRlZ29yaWVzLFxuICAgICAgICAgIGJyYW5kLFxuICAgICAgICAgIGRlZmluaXRpb24sXG4gICAgICAgICAgcHJpY2UsXG4gICAgICAgICAgc3RvY2ssXG4gICAgICAgIH0pO1xuXG4gICAgICAgIGF3YWl0IHByb2R1Y3Quc2F2ZSgpO1xuICAgICAgICByZXMuc3RhdHVzKDIwMSkuanNvbihwcm9kdWN0KTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIG5leHQoXG4gICAgICAgICAgbmV3IEFwaUVycm9yKFwiUHJvZHVjdCBjb3VsZCBub3QgYmUgYWRkZWRcIiwgNDAxLCBcIkRvZXNOb3RBZGRlZFByb2R1Y3RcIilcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG4gICk7XG5cbiAgcm91dGVyLmdldChcIi9nZXQtYWxsLXByb2R1Y3RzXCIsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBnZXRBbGxQcm9kdWN0cyA9IGF3YWl0IFByb2R1Y3RzLmZpbmQoKTtcblxuICAgICAgaWYgKGdldEFsbFByb2R1Y3RzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgXCJUaGVyZSBhcmUgbm8gcHJvZHVjdHMgYXZhaWxhYmxlXCIsXG4gICAgICAgICAgNDA0LFxuICAgICAgICAgIFwibm9GaW5kUHJvZHVjdFwiXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKGdldEFsbFByb2R1Y3RzKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgLy8gSGF0YSBBcGlFcnJvciBpc2UsIGhhdGEga29kdW51IHZlIG1lc2FqxLFuxLEga3VsbGFuXG4gICAgICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBBcGlFcnJvcikge1xuICAgICAgICByZXMuc3RhdHVzKGVycm9yLnN0YXR1cykuanNvbih7XG4gICAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgICBlcnJvckNvZGU6IGVycm9yLmNvZGUsXG4gICAgICAgIH0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gRcSfZXIgaGF0YSBBcGlFcnJvciBkZcSfaWxzZSwgZ2VuZWwgYmlyIGhhdGEgbWVzYWrEsSBkw7ZuZMO8clxuICAgICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XG4gICAgICAgICAgbWVzc2FnZTogXCJBbiB1bmV4cGVjdGVkIGVycm9yIG9jY3VycmVkXCIsXG4gICAgICAgICAgZXJyb3JDb2RlOiBcIkludGVybmFsU2VydmVyRXJyb3JcIixcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9KTtcblxuICByb3V0ZXIuZ2V0KFwiL2dldC1wcm9kdWN0cy1ieS1jYXRlZ29yeVwiLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICBjb25zdCBjYXRlZ29yeSA9IHJlcS5xdWVyeS5jYXRlZ29yeTtcbiAgICBpZiAoIWNhdGVnb3J5KSB7XG4gICAgICByZXR1cm4gcmVzXG4gICAgICAgIC5zdGF0dXMoNDAwKVxuICAgICAgICAuanNvbihuZXcgQXBpRXJyb3IoXCJDYXRlZ29yeSBpcyByZXF1aXJlZFwiLCA0MDEsIFwiUmVxdWlyZWRDYXRlZ29yeVwiKSk7XG4gICAgfVxuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgUHJvZHVjdHMuZmluZCh7XG4gICAgICAgIGNhdGVnb3JpZXM6IGNhdGVnb3J5LFxuICAgICAgfSk7XG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbihwcm9kdWN0cyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgcmVzXG4gICAgICAgIC5zdGF0dXMoNTAwKVxuICAgICAgICAuanNvbihcbiAgICAgICAgICBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgICBcIlByb2R1Y3RzIGNhbm5vdCBiZSByZXRyaWV2ZWQgYnkgY2F0ZWdvcnlcIixcbiAgICAgICAgICAgIDQwMSxcbiAgICAgICAgICAgIFwiQ2Fubm90R2V0UHJvZHVjdHNCeUNhdGVnb3J5XCJcbiAgICAgICAgICApXG4gICAgICAgICk7XG4gICAgfVxuICB9KTtcblxuICByb3V0ZXIuZ2V0KFwiL2dldC1wcm9kdWN0LWJ5LWlkLzppZFwiLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICBjb25zdCB7IGlkIH0gPSByZXEucGFyYW1zO1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBQcm9kdWN0cy5maW5kQnlJZChpZCk7XG4gICAgICBpZiAoIXByb2R1Y3QpIHtcbiAgICAgICAgcmV0dXJuIHJlc1xuICAgICAgICAgIC5zdGF0dXMoNDA0KVxuICAgICAgICAgIC5qc29uKG5ldyBBcGlFcnJvcihcIlByb2R1Y3Qgbm90IGZvdW5kXCIsIDQwNCwgXCJQcm9kdWN0Tm90Rm91bmRcIikpO1xuICAgICAgfVxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24ocHJvZHVjdCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgcmVzXG4gICAgICAgIC5zdGF0dXMoNTAwKVxuICAgICAgICAuanNvbihcbiAgICAgICAgICBuZXcgQXBpRXJyb3IoXCJQcm9kdWN0IGNhbm5vdCBiZSByZXRyaWV2ZWRcIiwgNTAwLCBcIkNhbm5vdEdldFByb2R1Y3RcIilcbiAgICAgICAgKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJvdXRlci5kZWxldGUoXCIvZGVsZXRlLXByb2R1Y3QvOmlkXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGNvbnN0IGlkID0gcmVxLnBhcmFtcy5pZDtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcHJvZHVjdCA9IGF3YWl0IFByb2R1Y3RzLmZpbmRPbmVBbmREZWxldGUoeyBfaWQ6IGlkIH0pO1xuICAgICAgaWYgKHByb2R1Y3QpIHtcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oYFByb2R1Y3QgbnVtYmVyICR7aWR9IHdhcyBkZWxldGVkYCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXMuc3RhdHVzKDQwNCkuanNvbihgUHJvZHVjdCB3aXRoIElEICR7aWR9IG5vdCBmb3VuZGApO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXNcbiAgICAgICAgLnN0YXR1cyg1MDApXG4gICAgICAgIC5qc29uKFxuICAgICAgICAgIG5ldyBBcGlFcnJvcihcIkNhbm5vdCBkZWxldGUgcHJvZHVjdFwiLCA0MDEsIFwiY2Fubm90RGVsZXRlUHJvZHVjdFwiKVxuICAgICAgICApO1xuICAgIH1cbiAgfSk7XG5cbiAgcm91dGVyLmdldChcIi9nZXQtY2F0ZWdvcmllc1wiLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBQcm9kdWN0cy5maW5kKHt9KTtcbiAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSB7fTtcblxuICAgICAgcHJvZHVjdHMuZm9yRWFjaCgocHJvZHVjdCkgPT4ge1xuICAgICAgICBwcm9kdWN0LmNhdGVnb3JpZXMuZm9yRWFjaCgoY2F0KSA9PiB7XG4gICAgICAgICAgaWYgKCFjYXRlZ29yaWVzW2NhdF0pIHtcbiAgICAgICAgICAgIGNhdGVnb3JpZXNbY2F0XSA9IFtdO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjYXRlZ29yaWVzW2NhdF0ucHVzaChwcm9kdWN0KTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcblxuICAgICAgcmVzLmpzb24oY2F0ZWdvcmllcyk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICByZXNcbiAgICAgICAgLnN0YXR1cyg1MDApXG4gICAgICAgIC5qc29uKFxuICAgICAgICAgIG5ldyBBcGlFcnJvcihcIkNhbm5vdCBnZXQgY2F0ZWdvcmllc1wiLCA0MDEsIFwiY2Fubm90R2V0Q2F0ZWdvcmllc1wiKVxuICAgICAgICApO1xuICAgIH1cbiAgfSk7XG59O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxTQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxRQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxTQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRyxPQUFBLEdBQUFKLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSSxLQUFBLEdBQUFMLHNCQUFBLENBQUFDLE9BQUE7QUFBd0IsU0FBQUQsdUJBQUFNLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFeEIsTUFBTUcsTUFBTSxHQUFHLElBQUFDLGVBQU0sRUFBQztFQUNwQkMsT0FBTyxFQUFFRCxlQUFNLENBQUNFLFdBQVcsQ0FBQztJQUMxQkMsV0FBVyxFQUFFQSxDQUFDQyxHQUFHLEVBQUVDLElBQUksRUFBRUMsRUFBRSxLQUFLO01BQzlCQSxFQUFFLENBQUMsSUFBSSxFQUFFLGVBQWUsQ0FBQztJQUMzQixDQUFDO0lBQ0RDLFFBQVEsRUFBRUEsQ0FBQ0gsR0FBRyxFQUFFQyxJQUFJLEVBQUVDLEVBQUUsS0FBSztNQUMzQjtNQUNBLE1BQU1FLFlBQVksR0FBR0gsSUFBSSxDQUFDSSxZQUFZO01BQ3RDSCxFQUFFLENBQUMsSUFBSSxFQUFFRSxZQUFZLENBQUM7SUFDeEI7RUFDRixDQUFDLENBQUM7RUFDRkUsVUFBVSxFQUFFQSxDQUFDTixHQUFHLEVBQUVDLElBQUksRUFBRUMsRUFBRSxLQUFLO0lBQzdCO0lBQ0EsTUFBTUssU0FBUyxHQUFHLGNBQWM7SUFDaEM7SUFDQSxNQUFNQyxPQUFPLEdBQUdELFNBQVMsQ0FBQ0UsSUFBSSxD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","map":{"version":3,"names":["_ApiError","_interopRequireDefault","require","_Session","_products","_multer","_path","e","__esModule","default","upload","multer","storage","diskStorage","destination","req","file","cb","filename","originalName","originalname","fileFilter","fileTypes","extname","test","path","toLowerCase","mimetype","ApiError","_default","router","post","Session","array","res","next","user","role","name","categories","brand","definition","price","stock","body","imagePaths","files","map","product","Products","images","save","status","json","error","get","getAllProducts","find","length","message","errorCode","code","category","query","products","console","id","params","findById","delete","findOneAndDelete","_id","forEach","cat","push","err","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["Products.js"],"sourcesContent":["import ApiError from \"../errors/ApiError\";\nimport Session from \"../middlewares/Session\";\nimport Products from \"../db/products\";\nimport multer from \"multer\";\nimport path from \"path\";\n\nconst upload = multer({\n  storage: multer.diskStorage({\n    destination: (req, file, cb) => {\n      cb(null, \"public/images\");\n    },\n    filename: (req, file, cb) => {\n      //const uniqueSuffix = Date.now() + \"-\" + Math.round(Math.random() * 1e9);\n      const originalName = file.originalname;\n      cb(null, originalName);\n    },\n  }),\n  fileFilter: (req, file, cb) => {\n    // İzin verilen dosya türleri\n    const fileTypes = /jpeg|jpg|png/;\n    // Dosya uzantısı\n    const extname = fileTypes.test(\n      path.extname(file.originalname).toLowerCase()\n    );\n    // MIME türü\n    const mimetype = fileTypes.test(file.mimetype);\n\n    if (mimetype && extname) {\n      return cb(null, true);\n    } else {\n      cb(\n        new ApiError(\n          \"Invalid file type. Only JPEG, JPG, and PNG are allowed.\",\n          400,\n          \"InvalidFileType\"\n        )\n      );\n    }\n  },\n});\n\nexport default (router) => {\n  router.post(\n    \"/create-product\",\n    Session,\n    upload.array(\"images\", 10),\n    async (req, res, next) => {\n      try {\n        if (req.user.role !== \"admin\") {\n          //user role admin değilse burası değilde ekleme esnasındaki hata veriyor, buna bir bakalım(kod sorunsuz çalışıyor)\n          throw new ApiError(\n            \"Forbidden: Insufficient permissions\",\n            403,\n            \"InsufficientPermissions\"\n          );\n        }\n\n        const { name, categories, brand, definition, price, stock } = req.body;\n        const imagePaths = req.files.map((file) => file.path);\n\n        const product = new Products({\n          name,\n          images: imagePaths,\n          categories,\n          brand,\n          definition,\n          price,\n          stock,\n        });\n\n        await product.save();\n        res.status(201).json(product);\n      } catch (error) {\n        next(\n          new ApiError(\"Product could not be added\", 401, \"DoesNotAddedProduct\")\n        );\n      }\n    }\n  );\n\n  router.get(\"/get-all-products\", async (req, res) => {\n    try {\n      const getAllProducts = await Products.find();\n\n      if (getAllProducts.length === 0) {\n        throw new ApiError(\n          \"There are no products available\",\n          404,\n          \"noFindProduct\"\n        );\n      }\n\n      res.status(200).json(getAllProducts);\n    } catch (error) {\n      // Hata ApiError ise, hata kodunu ve mesajını kullan\n      if (error instanceof ApiError) {\n        res.status(error.status).json({\n          message: error.message,\n          errorCode: error.code,\n        });\n      } else {\n        // Eğer hata ApiError değilse, genel bir hata mesajı döndür\n        res.status(500).json({\n          message: \"An unexpected error occurred\",\n          errorCode: \"InternalServerError\",\n        });\n      }\n    }\n  });\n\n  router.get(\"/get-products-by-category\", async (req, res) => {\n    const category = req.query.category;\n    if (!category) {\n      return res\n        .status(400)\n        .json(new ApiError(\"Category is required\", 401, \"RequiredCategory\"));\n    }\n\n    try {\n      const products = await Products.find({\n        categories: category,\n      });\n      res.status(200).json(products);\n    } catch (error) {\n      console.error(error);\n      res\n        .status(500)\n        .json(\n          new ApiError(\n            \"Products cannot be retrieved by category\",\n            401,\n            \"CannotGetProductsByCategory\"\n          )\n        );\n    }\n  });\n\n  router.get(\"/get-product-by-id/:id\", async (req, res) => {\n    const { id } = req.params;\n\n    try {\n      const product = await Products.findById(id);\n      if (!product) {\n        return res\n          .status(404)\n          .json(new ApiError(\"Product not found\", 404, \"ProductNotFound\"));\n      }\n      res.status(200).json(product);\n    } catch (error) {\n      console.error(error);\n      res\n        .status(500)\n        .json(\n          new ApiError(\"Product cannot be retrieved\", 500, \"CannotGetProduct\")\n        );\n    }\n  });\n\n  router.delete(\"/delete-product/:id\", Session, async (req, res) => {\n    const id = req.params.id;\n    try {\n      const product = await Products.findOneAndDelete({ _id: id });\n      if (product) {\n        res.status(200).json(`Product number ${id} was deleted`);\n      } else {\n        res.status(404).json(`Product with ID ${id} not found`);\n      }\n    } catch (error) {\n      res\n        .status(500)\n        .json(\n          new ApiError(\"Cannot delete product\", 401, \"cannotDeleteProduct\")\n        );\n    }\n  });\n\n  router.get(\"/get-categories\", async (req, res) => {\n    try {\n      const products = await Products.find({});\n      const categories = {};\n\n      products.forEach((product) => {\n        product.categories.forEach((cat) => {\n          if (!categories[cat]) {\n            categories[cat] = [];\n          }\n          categories[cat].push(product);\n        });\n      });\n\n      res.json(categories);\n    } catch (err) {\n      console.error(err);\n      res\n        .status(500)\n        .json(\n          new ApiError(\"Cannot get categories\", 401, \"cannotGetCategories\")\n        );\n    }\n  });\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1723467324171},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/products.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst ProductsSchema = new Schema({\n  uuid: {\n    type: String,\n    default: (0, _uuid.default)(),\n    unique: false,\n    required: true\n  },\n  name: {\n    type: String,\n    required: true\n  },\n  definition: {\n    type: String,\n    required: true\n  },\n  images: {\n    type: [String],\n    //text array olacak\n    required: true\n  },\n  categories: {\n    type: [String]\n  },\n  brand: {\n    type: String,\n    required: true\n  },\n  price: {\n    type: Number,\n    required: true\n  },\n  currency: {\n    type: String,\n    required: true,\n    default: \"TRY\",\n    enum: [\"TRY\", \"USD\", \"EUR\"]\n  },\n  stock: {\n    type: Number,\n    default: 1,\n    required: true\n  },\n  itemType: {\n    type: String,\n    required: true,\n    default: \"PHYSICAL\",\n    enum: [\"PHYSICAL\", \"VIRTUAL\"]\n  }\n}, {\n  _id: true,\n  collection: \"products\",\n  timestamps: true,\n  toJSON: {\n    transform: (doc, ret) => {\n      delete ret.__v;\n      return {\n        ...ret\n      };\n    }\n  }\n});\nconst Products = _mongoose.default.model(\"Products\", ProductsSchema);\nvar _default = exports.default = Products;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9iY3J5cHRqcyIsIl91dWlkIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiU2NoZW1hIiwibW9uZ29vc2UiLCJPYmplY3RJZCIsIlR5cGVzIiwiUHJvZHVjdHNTY2hlbWEiLCJ1dWlkIiwidHlwZSIsIlN0cmluZyIsImlkIiwidW5pcXVlIiwicmVxdWlyZWQiLCJuYW1lIiwiZGVmaW5pdGlvbiIsImltYWdlcyIsImNhdGVnb3JpZXMiLCJicmFuZCIsInByaWNlIiwiTnVtYmVyIiwiY3VycmVuY3kiLCJlbnVtIiwic3RvY2siLCJpdGVtVHlwZSIsIl9pZCIsImNvbGxlY3Rpb24iLCJ0aW1lc3RhbXBzIiwidG9KU09OIiwidHJhbnNmb3JtIiwiZG9jIiwicmV0IiwiX192IiwiUHJvZHVjdHMiLCJtb2RlbCIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL2RiLyIsInNvdXJjZXMiOlsicHJvZHVjdHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlIGZyb20gXCJtb25nb29zZVwiO1xuaW1wb3J0IGJjcnlwdCBmcm9tIFwiYmNyeXB0anNcIjtcbmltcG9ydCBpZCBmcm9tIFwiLi4vdXRpbHMvdXVpZFwiO1xuXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWE7XG5jb25zdCB7IE9iamVjdElkIH0gPSBTY2hlbWEuVHlwZXM7XG5cbmNvbnN0IFByb2R1Y3RzU2NoZW1hID0gbmV3IFNjaGVtYShcbiAge1xuICAgIHV1aWQ6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIGRlZmF1bHQ6IGlkKCksXG4gICAgICB1bmlxdWU6IGZhbHNlLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBuYW1lOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGRlZmluaXRpb246IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgaW1hZ2VzOiB7XG4gICAgICB0eXBlOiBbU3RyaW5nXSwgLy90ZXh0IGFycmF5IG9sYWNha1xuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBjYXRlZ29yaWVzOiB7XG4gICAgICB0eXBlOiBbU3RyaW5nXSxcbiAgICB9LFxuICAgIGJyYW5kOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIHByaWNlOiB7XG4gICAgICB0eXBlOiBOdW1iZXIsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGN1cnJlbmN5OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIGRlZmF1bHQ6IFwiVFJZXCIsXG4gICAgICBlbnVtOiBbXCJUUllcIiwgXCJVU0RcIiwgXCJFVVJcIl0sXG4gICAgfSxcbiAgICBzdG9jazoge1xuICAgICAgdHlwZTogTnVtYmVyLFxuICAgICAgZGVmYXVsdDogMSxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgaXRlbVR5cGU6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgZGVmYXVsdDogXCJQSFlTSUNBTFwiLFxuICAgICAgZW51bTogW1wiUEhZU0lDQUxcIiwgXCJWSVJUVUFMXCJdLFxuICAgIH0sXG4gIH0sXG4gIHtcbiAgICBfaWQ6IHRydWUsXG4gICAgY29sbGVjdGlvbjogXCJwcm9kdWN0c1wiLFxuICAgIHRpbWVzdGFtcHM6IHRydWUsXG4gICAgdG9KU09OOiB7XG4gICAgICB0cmFuc2Zvcm06IChkb2MsIHJldCkgPT4ge1xuICAgICAgICBkZWxldGUgcmV0Ll9fdjtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAuLi5yZXQsXG4gICAgICAgIH07XG4gICAgICB9LFxuICAgIH0sXG4gIH1cbik7XG5cbmNvbnN0IFByb2R1Y3RzID0gbW9uZ29vc2UubW9kZWwoXCJQcm9kdWN0c1wiLCBQcm9kdWN0c1NjaGVtYSk7XG5cbmV4cG9ydCBkZWZhdWx0IFByb2R1Y3RzO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxTQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxTQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxLQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFBK0IsU0FBQUQsdUJBQUFJLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFL0IsTUFBTUcsTUFBTSxHQUFHQyxpQkFBUSxDQUFDRCxNQUFNO0FBQzlCLE1BQU07RUFBRUU7QUFBUyxDQUFDLEdBQUdGLE1BQU0sQ0FBQ0csS0FBSztBQUVqQyxNQUFNQyxjQUFjLEdBQUcsSUFBSUosTUFBTSxDQUMvQjtFQUNFSyxJQUFJLEVBQUU7SUFDSkMsSUFBSSxFQUFFQyxNQUFNO0lBQ1pSLE9BQU8sRUFBRSxJQUFBUyxhQUFFLEVBQUMsQ0FBQztJQUNiQyxNQUFNLEVBQUUsS0FBSztJQUNiQyxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RDLElBQUksRUFBRTtJQUNKTCxJQUFJLEVBQUVDLE1BQU07SUFDWkcsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNERSxVQUFVLEVBQUU7SUFDVk4sSUFBSSxFQUFFQyxNQUFNO0lBQ1pHLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDREcsTUFBTSxFQUFFO0lBQ05QLElBQUksRUFBRSxDQUFDQyxNQUFNLENBQUM7SUFBRTtJQUNoQkcsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNESSxVQUFVLEVBQUU7SUFDVlIsSUFBSSxFQUFFLENBQUNDLE1BQU07RUFDZixDQUFDO0VBQ0RRLEtBQUssRUFBRTtJQUNMVCxJQUFJLEVBQUVDLE1BQU07SUFDWkcsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNETSxLQUFLLEVBQUU7SUFDTFYsSUFBSSxFQUFFVyxNQUFNO0lBQ1pQLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDRFEsUUFBUSxFQUFFO0lBQ1JaLElBQUksRUFBRUMsTUFBTTtJQUNaRyxRQUFRLEVBQUUsSUFBSTtJQUNkWCxPQUFPLEVBQUUsS0FBSztJQUNkb0IsSUFBSSxFQUFFLENBQUMsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLO0VBQzVCLENBQUM7RUFDREMsS0FBSyxFQUFFO0lBQ0xkLElBQUksRUFBRVcsTUFBTTtJQUNabEIsT0FBTyxFQUFFLENBQUM7SUFDVlcsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNEVyxRQUFRLEVBQUU7SUFDUmYsSUFBSSxFQUFFQyxNQUFNO0lBQ1pHLFFBQVEsRUFBRSxJQUFJO0lBQ2RYLE9BQU8sRUFBRSxVQUFVO0lBQ25Cb0IsSUFBSSxFQUFFLENBQUMsVUFBVSxFQUFFLFNBQVM7RUFDOUI7QUFDRixDQUFDLEVBQ0Q7RUFDRUcsR0FBRyxFQUFFLElBQUk7RUFDVEMsVUFBVSxFQUFFLFVBQVU7RUFDdEJDLFVBQVUsRUFBRSxJQUFJO0VBQ2hCQyxNQUFNLEVBQUU7SUFDTkMsU0FBUyxFQUFFQSxDQUFDQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztNQUN2QixPQUFPQSxHQUFHLENBQUNDLEdBQUc7TUFDZCxPQUFPO1FBQ0wsR0FBR0Q7TUFDTCxDQUFDO0lBQ0g7RUFDRjtBQUNGLENBQ0YsQ0FBQztBQUVELE1BQU1FLFFBQVEsR0FBRzdCLGlCQUFRLENBQUM4QixLQUFLLENBQUMsVUFBVSxFQUFFM0IsY0FBYyxDQUFDO0FBQUMsSUFBQTRCLFFBQUEsR0FBQUMsT0FBQSxDQUFBbEMsT0FBQSxHQUU3QytCLFFBQVEiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","_bcryptjs","_uuid","e","__esModule","default","Schema","mongoose","ObjectId","Types","ProductsSchema","uuid","type","String","id","unique","required","name","definition","images","categories","brand","price","Number","currency","enum","stock","itemType","_id","collection","timestamps","toJSON","transform","doc","ret","__v","Products","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["products.js"],"sourcesContent":["import mongoose from \"mongoose\";\nimport bcrypt from \"bcryptjs\";\nimport id from \"../utils/uuid\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\n\nconst ProductsSchema = new Schema(\n  {\n    uuid: {\n      type: String,\n      default: id(),\n      unique: false,\n      required: true,\n    },\n    name: {\n      type: String,\n      required: true,\n    },\n    definition: {\n      type: String,\n      required: true,\n    },\n    images: {\n      type: [String], //text array olacak\n      required: true,\n    },\n    categories: {\n      type: [String],\n    },\n    brand: {\n      type: String,\n      required: true,\n    },\n    price: {\n      type: Number,\n      required: true,\n    },\n    currency: {\n      type: String,\n      required: true,\n      default: \"TRY\",\n      enum: [\"TRY\", \"USD\", \"EUR\"],\n    },\n    stock: {\n      type: Number,\n      default: 1,\n      required: true,\n    },\n    itemType: {\n      type: String,\n      required: true,\n      default: \"PHYSICAL\",\n      enum: [\"PHYSICAL\", \"VIRTUAL\"],\n    },\n  },\n  {\n    _id: true,\n    collection: \"products\",\n    timestamps: true,\n    toJSON: {\n      transform: (doc, ret) => {\n        delete ret.__v;\n        return {\n          ...ret,\n        };\n      },\n    },\n  }\n);\n\nconst Products = mongoose.model(\"Products\", ProductsSchema);\n\nexport default Products;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,KAAA,GAAAH,sBAAA,CAAAC,OAAA;AAA+B,SAAAD,uBAAAI,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE/B,MAAMG,MAAM,GAAGC,iBAAQ,CAACD,MAAM;AAC9B,MAAM;EAAEE;AAAS,CAAC,GAAGF,MAAM,CAACG,KAAK;AAEjC,MAAMC,cAAc,GAAG,IAAIJ,MAAM,CAC/B;EACEK,IAAI,EAAE;IACJC,IAAI,EAAEC,MAAM;IACZR,OAAO,EAAE,IAAAS,aAAE,EAAC,CAAC;IACbC,MAAM,EAAE,KAAK;IACbC,QAAQ,EAAE;EACZ,CAAC;EACDC,IAAI,EAAE;IACJL,IAAI,EAAEC,MAAM;IACZG,QAAQ,EAAE;EACZ,CAAC;EACDE,UAAU,EAAE;IACVN,IAAI,EAAEC,MAAM;IACZG,QAAQ,EAAE;EACZ,CAAC;EACDG,MAAM,EAAE;IACNP,IAAI,EAAE,CAACC,MAAM,CAAC;IAAE;IAChBG,QAAQ,EAAE;EACZ,CAAC;EACDI,UAAU,EAAE;IACVR,IAAI,EAAE,CAACC,MAAM;EACf,CAAC;EACDQ,KAAK,EAAE;IACLT,IAAI,EAAEC,MAAM;IACZG,QAAQ,EAAE;EACZ,CAAC;EACDM,KAAK,EAAE;IACLV,IAAI,EAAEW,MAAM;IACZP,QAAQ,EAAE;EACZ,CAAC;EACDQ,QAAQ,EAAE;IACRZ,IAAI,EAAEC,MAAM;IACZG,QAAQ,EAAE,IAAI;IACdX,OAAO,EAAE,KAAK;IACdoB,IAAI,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK;EAC5B,CAAC;EACDC,KAAK,EAAE;IACLd,IAAI,EAAEW,MAAM;IACZlB,OAAO,EAAE,CAAC;IACVW,QAAQ,EAAE;EACZ,CAAC;EACDW,QAAQ,EAAE;IACRf,IAAI,EAAEC,MAAM;IACZG,QAAQ,EAAE,IAAI;IACdX,OAAO,EAAE,UAAU;IACnBoB,IAAI,EAAE,CAAC,UAAU,EAAE,SAAS;EAC9B;AACF,CAAC,EACD;EACEG,GAAG,EAAE,IAAI;EACTC,UAAU,EAAE,UAAU;EACtBC,UAAU,EAAE,IAAI;EAChBC,MAAM,EAAE;IACNC,SAAS,EAAEA,CAACC,GAAG,EAAEC,GAAG,KAAK;MACvB,OAAOA,GAAG,CAACC,GAAG;MACd,OAAO;QACL,GAAGD;MACL,CAAC;IACH;EACF;AACF,CACF,CAAC;AAED,MAAME,QAAQ,GAAG7B,iBAAQ,CAAC8B,KAAK,CAAC,UAAU,EAAE3B,cAAc,CAAC;AAAC,IAAA4B,QAAA,GAAAC,OAAA,CAAAlC,OAAA,GAE7C+B,QAAQ","ignoreList":[]}},"mtime":1722424936372},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/RoleMiddleware.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst checkRole = roles => {\n  return async (req, res, next) => {\n    try {\n      // Assuming the user ID is stored in req.user.id by the authentication middleware\n      const userId = req.user.id;\n\n      // Fetch the user from the database\n      const user = await _users.default.findById(userId);\n      if (!user) {\n        return res.status(404).json(\"User not found.\");\n      }\n\n      // Check if the user's role is in the allowed roles\n      if (roles.includes(user.role)) {\n        next();\n      } else {\n        return res.status(401).json(\"You cannot get in.\");\n      }\n    } catch (error) {\n      return res.status(500).json({\n        message: \"Internal server error\",\n        error\n      });\n    }\n  };\n};\nvar _default = exports.default = checkRole;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfdXNlcnMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImNoZWNrUm9sZSIsInJvbGVzIiwicmVxIiwicmVzIiwibmV4dCIsInVzZXJJZCIsInVzZXIiLCJpZCIsIlVzZXIiLCJmaW5kQnlJZCIsInN0YXR1cyIsImpzb24iLCJpbmNsdWRlcyIsInJvbGUiLCJlcnJvciIsIm1lc3NhZ2UiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9taWRkbGV3YXJlcy8iLCJzb3VyY2VzIjpbIlJvbGVNaWRkbGV3YXJlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBVc2VyIGZyb20gXCIuLi9kYi91c2Vyc1wiO1xuXG5jb25zdCBjaGVja1JvbGUgPSAocm9sZXMpID0+IHtcbiAgcmV0dXJuIGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBBc3N1bWluZyB0aGUgdXNlciBJRCBpcyBzdG9yZWQgaW4gcmVxLnVzZXIuaWQgYnkgdGhlIGF1dGhlbnRpY2F0aW9uIG1pZGRsZXdhcmVcbiAgICAgIGNvbnN0IHVzZXJJZCA9IHJlcS51c2VyLmlkO1xuXG4gICAgICAvLyBGZXRjaCB0aGUgdXNlciBmcm9tIHRoZSBkYXRhYmFzZVxuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZEJ5SWQodXNlcklkKTtcblxuICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbihcIlVzZXIgbm90IGZvdW5kLlwiKTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgaWYgdGhlIHVzZXIncyByb2xlIGlzIGluIHRoZSBhbGxvd2VkIHJvbGVzXG4gICAgICBpZiAocm9sZXMuaW5jbHVkZXModXNlci5yb2xlKSkge1xuICAgICAgICBuZXh0KCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oXCJZb3UgY2Fubm90IGdldCBpbi5cIik7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IG1lc3NhZ2U6IFwiSW50ZXJuYWwgc2VydmVyIGVycm9yXCIsIGVycm9yIH0pO1xuICAgIH1cbiAgfTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGNoZWNrUm9sZTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsTUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQStCLFNBQUFELHVCQUFBRSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBRS9CLE1BQU1HLFNBQVMsR0FBSUMsS0FBSyxJQUFLO0VBQzNCLE9BQU8sT0FBT0MsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksS0FBSztJQUMvQixJQUFJO01BQ0Y7TUFDQSxNQUFNQyxNQUFNLEdBQUdILEdBQUcsQ0FBQ0ksSUFBSSxDQUFDQyxFQUFFOztNQUUxQjtNQUNBLE1BQU1ELElBQUksR0FBRyxNQUFNRSxjQUFJLENBQUNDLFFBQVEsQ0FBQ0osTUFBTSxDQUFDO01BRXhDLElBQUksQ0FBQ0MsSUFBSSxFQUFFO1FBQ1QsT0FBT0gsR0FBRyxDQUFDTyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQztNQUNoRDs7TUFFQTtNQUNBLElBQUlWLEtBQUssQ0FBQ1csUUFBUSxDQUFDTixJQUFJLENBQUNPLElBQUksQ0FBQyxFQUFFO1FBQzdCVCxJQUFJLENBQUMsQ0FBQztNQUNSLENBQUMsTUFBTTtRQUNMLE9BQU9ELEdBQUcsQ0FBQ08sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMsb0JBQW9CLENBQUM7TUFDbkQ7SUFDRixDQUFDLENBQUMsT0FBT0csS0FBSyxFQUFFO01BQ2QsT0FBT1gsR0FBRyxDQUFDTyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztRQUFFSSxPQUFPLEVBQUUsdUJBQXVCO1FBQUVEO01BQU0sQ0FBQyxDQUFDO0lBQzFFO0VBQ0YsQ0FBQztBQUNILENBQUM7QUFBQyxJQUFBRSxRQUFBLEdBQUFDLE9BQUEsQ0FBQWxCLE9BQUEsR0FFYUMsU0FBUyIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_users","_interopRequireDefault","require","e","__esModule","default","checkRole","roles","req","res","next","userId","user","id","User","findById","status","json","includes","role","error","message","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["RoleMiddleware.js"],"sourcesContent":["import User from \"../db/users\";\n\nconst checkRole = (roles) => {\n  return async (req, res, next) => {\n    try {\n      // Assuming the user ID is stored in req.user.id by the authentication middleware\n      const userId = req.user.id;\n\n      // Fetch the user from the database\n      const user = await User.findById(userId);\n\n      if (!user) {\n        return res.status(404).json(\"User not found.\");\n      }\n\n      // Check if the user's role is in the allowed roles\n      if (roles.includes(user.role)) {\n        next();\n      } else {\n        return res.status(401).json(\"You cannot get in.\");\n      }\n    } catch (error) {\n      return res.status(500).json({ message: \"Internal server error\", error });\n    }\n  };\n};\n\nexport default checkRole;\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA+B,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE/B,MAAMG,SAAS,GAAIC,KAAK,IAAK;EAC3B,OAAO,OAAOC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;IAC/B,IAAI;MACF;MACA,MAAMC,MAAM,GAAGH,GAAG,CAACI,IAAI,CAACC,EAAE;;MAE1B;MACA,MAAMD,IAAI,GAAG,MAAME,cAAI,CAACC,QAAQ,CAACJ,MAAM,CAAC;MAExC,IAAI,CAACC,IAAI,EAAE;QACT,OAAOH,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,iBAAiB,CAAC;MAChD;;MAEA;MACA,IAAIV,KAAK,CAACW,QAAQ,CAACN,IAAI,CAACO,IAAI,CAAC,EAAE;QAC7BT,IAAI,CAAC,CAAC;MACR,CAAC,MAAM;QACL,OAAOD,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,oBAAoB,CAAC;MACnD;IACF,CAAC,CAAC,OAAOG,KAAK,EAAE;MACd,OAAOX,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEI,OAAO,EAAE,uBAAuB;QAAED;MAAM,CAAC,CAAC;IAC1E;EACF,CAAC;AACH,CAAC;AAAC,IAAAE,QAAA,GAAAC,OAAA,CAAAlB,OAAA,GAEaC,SAAS","ignoreList":[]}},"mtime":1722424936373},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/RoleMiddleware.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst checkRole = roles => {\n  return async (req, res, next) => {\n    try {\n      // Assuming the user ID is stored in req.user.id by the authentication middleware\n      const userId = req.user.id;\n\n      // Fetch the user from the database\n      const user = await _users.default.findById(userId);\n      if (!user) {\n        return res.status(404).json(\"User not found.\");\n      }\n\n      // Check if the user's role is in the allowed roles\n      if (roles.includes(user.role)) {\n        next();\n      } else {\n        return res.status(401).json(\"You cannot get in.\");\n      }\n    } catch (error) {\n      return res.status(500).json({\n        message: \"Internal server error\",\n        error\n      });\n    }\n  };\n};\nvar _default = exports.default = checkRole;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfdXNlcnMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImNoZWNrUm9sZSIsInJvbGVzIiwicmVxIiwicmVzIiwibmV4dCIsInVzZXJJZCIsInVzZXIiLCJpZCIsIlVzZXIiLCJmaW5kQnlJZCIsInN0YXR1cyIsImpzb24iLCJpbmNsdWRlcyIsInJvbGUiLCJlcnJvciIsIm1lc3NhZ2UiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9taWRkbGV3YXJlcy8iLCJzb3VyY2VzIjpbIlJvbGVNaWRkbGV3YXJlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBVc2VyIGZyb20gXCIuLi9kYi91c2Vyc1wiO1xuXG5jb25zdCBjaGVja1JvbGUgPSAocm9sZXMpID0+IHtcbiAgcmV0dXJuIGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBBc3N1bWluZyB0aGUgdXNlciBJRCBpcyBzdG9yZWQgaW4gcmVxLnVzZXIuaWQgYnkgdGhlIGF1dGhlbnRpY2F0aW9uIG1pZGRsZXdhcmVcbiAgICAgIGNvbnN0IHVzZXJJZCA9IHJlcS51c2VyLmlkO1xuXG4gICAgICAvLyBGZXRjaCB0aGUgdXNlciBmcm9tIHRoZSBkYXRhYmFzZVxuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZEJ5SWQodXNlcklkKTtcblxuICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbihcIlVzZXIgbm90IGZvdW5kLlwiKTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgaWYgdGhlIHVzZXIncyByb2xlIGlzIGluIHRoZSBhbGxvd2VkIHJvbGVzXG4gICAgICBpZiAocm9sZXMuaW5jbHVkZXModXNlci5yb2xlKSkge1xuICAgICAgICBuZXh0KCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oXCJZb3UgY2Fubm90IGdldCBpbi5cIik7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IG1lc3NhZ2U6IFwiSW50ZXJuYWwgc2VydmVyIGVycm9yXCIsIGVycm9yIH0pO1xuICAgIH1cbiAgfTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGNoZWNrUm9sZTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsTUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQStCLFNBQUFELHVCQUFBRSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBRS9CLE1BQU1HLFNBQVMsR0FBSUMsS0FBSyxJQUFLO0VBQzNCLE9BQU8sT0FBT0MsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksS0FBSztJQUMvQixJQUFJO01BQ0Y7TUFDQSxNQUFNQyxNQUFNLEdBQUdILEdBQUcsQ0FBQ0ksSUFBSSxDQUFDQyxFQUFFOztNQUUxQjtNQUNBLE1BQU1ELElBQUksR0FBRyxNQUFNRSxjQUFJLENBQUNDLFFBQVEsQ0FBQ0osTUFBTSxDQUFDO01BRXhDLElBQUksQ0FBQ0MsSUFBSSxFQUFFO1FBQ1QsT0FBT0gsR0FBRyxDQUFDTyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQztNQUNoRDs7TUFFQTtNQUNBLElBQUlWLEtBQUssQ0FBQ1csUUFBUSxDQUFDTixJQUFJLENBQUNPLElBQUksQ0FBQyxFQUFFO1FBQzdCVCxJQUFJLENBQUMsQ0FBQztNQUNSLENBQUMsTUFBTTtRQUNMLE9BQU9ELEdBQUcsQ0FBQ08sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMsb0JBQW9CLENBQUM7TUFDbkQ7SUFDRixDQUFDLENBQUMsT0FBT0csS0FBSyxFQUFFO01BQ2QsT0FBT1gsR0FBRyxDQUFDTyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztRQUFFSSxPQUFPLEVBQUUsdUJBQXVCO1FBQUVEO01BQU0sQ0FBQyxDQUFDO0lBQzFFO0VBQ0YsQ0FBQztBQUNILENBQUM7QUFBQyxJQUFBRSxRQUFBLEdBQUFDLE9BQUEsQ0FBQWxCLE9BQUEsR0FFYUMsU0FBUyIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_users","_interopRequireDefault","require","e","__esModule","default","checkRole","roles","req","res","next","userId","user","id","User","findById","status","json","includes","role","error","message","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["RoleMiddleware.js"],"sourcesContent":["import User from \"../db/users\";\n\nconst checkRole = (roles) => {\n  return async (req, res, next) => {\n    try {\n      // Assuming the user ID is stored in req.user.id by the authentication middleware\n      const userId = req.user.id;\n\n      // Fetch the user from the database\n      const user = await User.findById(userId);\n\n      if (!user) {\n        return res.status(404).json(\"User not found.\");\n      }\n\n      // Check if the user's role is in the allowed roles\n      if (roles.includes(user.role)) {\n        next();\n      } else {\n        return res.status(401).json(\"You cannot get in.\");\n      }\n    } catch (error) {\n      return res.status(500).json({ message: \"Internal server error\", error });\n    }\n  };\n};\n\nexport default checkRole;\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA+B,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE/B,MAAMG,SAAS,GAAIC,KAAK,IAAK;EAC3B,OAAO,OAAOC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;IAC/B,IAAI;MACF;MACA,MAAMC,MAAM,GAAGH,GAAG,CAACI,IAAI,CAACC,EAAE;;MAE1B;MACA,MAAMD,IAAI,GAAG,MAAME,cAAI,CAACC,QAAQ,CAACJ,MAAM,CAAC;MAExC,IAAI,CAACC,IAAI,EAAE;QACT,OAAOH,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,iBAAiB,CAAC;MAChD;;MAEA;MACA,IAAIV,KAAK,CAACW,QAAQ,CAACN,IAAI,CAACO,IAAI,CAAC,EAAE;QAC7BT,IAAI,CAAC,CAAC;MACR,CAAC,MAAM;QACL,OAAOD,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,oBAAoB,CAAC;MACnD;IACF,CAAC,CAAC,OAAOG,KAAK,EAAE;MACd,OAAOX,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEI,OAAO,EAAE,uBAAuB;QAAED;MAAM,CAAC,CAAC;IAC1E;EACF,CAAC;AACH,CAAC;AAAC,IAAAE,QAAA,GAAAC,OAAA,CAAAlB,OAAA,GAEaC,SAAS","ignoreList":[]}},"mtime":1722424936373},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/cart.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst CartsSchema = new Schema({\n  uuid: {\n    type: String,\n    default: (0, _uuid.default)(),\n    unique: true,\n    required: true\n  },\n  completed: {\n    type: Boolean,\n    default: false,\n    required: true\n  },\n  buyer: {\n    type: ObjectId,\n    ref: \"Users\",\n    required: true\n  },\n  products: {\n    type: [ObjectId],\n    ref: \"Products\",\n    required: true\n  },\n  currency: {\n    type: String,\n    required: true,\n    default: \"TRY\",\n    enum: [\"TRY\", \"USD\", \"EUR\"]\n  }\n}, {\n  _id: true,\n  collection: \"carts\",\n  timestamps: true,\n  toJSON: {\n    transform: (doc, ret) => {\n      delete ret.__v;\n      return {\n        ...ret\n      };\n    }\n  }\n});\nconst Carts = _mongoose.default.model(\"Carts\", CartsSchema);\nvar _default = exports.default = Carts;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9iY3J5cHRqcyIsIl91dWlkIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiU2NoZW1hIiwibW9uZ29vc2UiLCJPYmplY3RJZCIsIlR5cGVzIiwiQ2FydHNTY2hlbWEiLCJ1dWlkIiwidHlwZSIsIlN0cmluZyIsInVuaXF1ZSIsInJlcXVpcmVkIiwiY29tcGxldGVkIiwiQm9vbGVhbiIsImJ1eWVyIiwicmVmIiwicHJvZHVjdHMiLCJjdXJyZW5jeSIsImVudW0iLCJfaWQiLCJjb2xsZWN0aW9uIiwidGltZXN0YW1wcyIsInRvSlNPTiIsInRyYW5zZm9ybSIsImRvYyIsInJldCIsIl9fdiIsIkNhcnRzIiwibW9kZWwiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9kYi8iLCJzb3VyY2VzIjpbImNhcnQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlIGZyb20gXCJtb25nb29zZVwiO1xuaW1wb3J0IGJjcnlwdCBmcm9tIFwiYmNyeXB0anNcIjtcbmltcG9ydCB1dWlkIGZyb20gXCIuLi91dGlscy91dWlkXCI7XG5cbmNvbnN0IFNjaGVtYSA9IG1vbmdvb3NlLlNjaGVtYTtcbmNvbnN0IHsgT2JqZWN0SWQgfSA9IFNjaGVtYS5UeXBlcztcblxuY29uc3QgQ2FydHNTY2hlbWEgPSBuZXcgU2NoZW1hKFxuICB7XG4gICAgdXVpZDoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgZGVmYXVsdDogdXVpZCgpLFxuICAgICAgdW5pcXVlOiB0cnVlLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBjb21wbGV0ZWQ6IHtcbiAgICAgIHR5cGU6IEJvb2xlYW4sXG4gICAgICBkZWZhdWx0OiBmYWxzZSxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgYnV5ZXI6IHtcbiAgICAgIHR5cGU6IE9iamVjdElkLFxuICAgICAgcmVmOiBcIlVzZXJzXCIsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIHByb2R1Y3RzOiB7XG4gICAgICB0eXBlOiBbT2JqZWN0SWRdLFxuICAgICAgcmVmOiBcIlByb2R1Y3RzXCIsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGN1cnJlbmN5OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIGRlZmF1bHQ6IFwiVFJZXCIsXG4gICAgICBlbnVtOiBbXCJUUllcIiwgXCJVU0RcIiwgXCJFVVJcIl0sXG4gICAgfSxcbiAgfSxcbiAge1xuICAgIF9pZDogdHJ1ZSxcbiAgICBjb2xsZWN0aW9uOiBcImNhcnRzXCIsXG4gICAgdGltZXN0YW1wczogdHJ1ZSxcbiAgICB0b0pTT046IHtcbiAgICAgIHRyYW5zZm9ybTogKGRvYywgcmV0KSA9PiB7XG4gICAgICAgIGRlbGV0ZSByZXQuX192O1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLnJldCxcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgfSxcbiAgfVxuKTtcblxuY29uc3QgQ2FydHMgPSBtb25nb29zZS5tb2RlbChcIkNhcnRzXCIsIENhcnRzU2NoZW1hKTtcblxuZXhwb3J0IGRlZmF1bHQgQ2FydHM7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFNBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLEtBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUFpQyxTQUFBRCx1QkFBQUksQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUVqQyxNQUFNRyxNQUFNLEdBQUdDLGlCQUFRLENBQUNELE1BQU07QUFDOUIsTUFBTTtFQUFFRTtBQUFTLENBQUMsR0FBR0YsTUFBTSxDQUFDRyxLQUFLO0FBRWpDLE1BQU1DLFdBQVcsR0FBRyxJQUFJSixNQUFNLENBQzVCO0VBQ0VLLElBQUksRUFBRTtJQUNKQyxJQUFJLEVBQUVDLE1BQU07SUFDWlIsT0FBTyxFQUFFLElBQUFNLGFBQUksRUFBQyxDQUFDO0lBQ2ZHLE1BQU0sRUFBRSxJQUFJO0lBQ1pDLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDREMsU0FBUyxFQUFFO0lBQ1RKLElBQUksRUFBRUssT0FBTztJQUNiWixPQUFPLEVBQUUsS0FBSztJQUNkVSxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RHLEtBQUssRUFBRTtJQUNMTixJQUFJLEVBQUVKLFFBQVE7SUFDZFcsR0FBRyxFQUFFLE9BQU87SUFDWkosUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNESyxRQUFRLEVBQUU7SUFDUlIsSUFBSSxFQUFFLENBQUNKLFFBQVEsQ0FBQztJQUNoQlcsR0FBRyxFQUFFLFVBQVU7SUFDZkosUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNETSxRQUFRLEVBQUU7SUFDUlQsSUFBSSxFQUFFQyxNQUFNO0lBQ1pFLFFBQVEsRUFBRSxJQUFJO0lBQ2RWLE9BQU8sRUFBRSxLQUFLO0lBQ2RpQixJQUFJLEVBQUUsQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUs7RUFDNUI7QUFDRixDQUFDLEVBQ0Q7RUFDRUMsR0FBRyxFQUFFLElBQUk7RUFDVEMsVUFBVSxFQUFFLE9BQU87RUFDbkJDLFVBQVUsRUFBRSxJQUFJO0VBQ2hCQyxNQUFNLEVBQUU7SUFDTkMsU0FBUyxFQUFFQSxDQUFDQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztNQUN2QixPQUFPQSxHQUFHLENBQUNDLEdBQUc7TUFDZCxPQUFPO1FBQ0wsR0FBR0Q7TUFDTCxDQUFDO0lBQ0g7RUFDRjtBQUNGLENBQ0YsQ0FBQztBQUVELE1BQU1FLEtBQUssR0FBR3hCLGlCQUFRLENBQUN5QixLQUFLLENBQUMsT0FBTyxFQUFFdEIsV0FBVyxDQUFDO0FBQUMsSUFBQXVCLFFBQUEsR0FBQUMsT0FBQSxDQUFBN0IsT0FBQSxHQUVwQzBCLEtBQUsiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","_bcryptjs","_uuid","e","__esModule","default","Schema","mongoose","ObjectId","Types","CartsSchema","uuid","type","String","unique","required","completed","Boolean","buyer","ref","products","currency","enum","_id","collection","timestamps","toJSON","transform","doc","ret","__v","Carts","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["cart.js"],"sourcesContent":["import mongoose from \"mongoose\";\nimport bcrypt from \"bcryptjs\";\nimport uuid from \"../utils/uuid\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\n\nconst CartsSchema = new Schema(\n  {\n    uuid: {\n      type: String,\n      default: uuid(),\n      unique: true,\n      required: true,\n    },\n    completed: {\n      type: Boolean,\n      default: false,\n      required: true,\n    },\n    buyer: {\n      type: ObjectId,\n      ref: \"Users\",\n      required: true,\n    },\n    products: {\n      type: [ObjectId],\n      ref: \"Products\",\n      required: true,\n    },\n    currency: {\n      type: String,\n      required: true,\n      default: \"TRY\",\n      enum: [\"TRY\", \"USD\", \"EUR\"],\n    },\n  },\n  {\n    _id: true,\n    collection: \"carts\",\n    timestamps: true,\n    toJSON: {\n      transform: (doc, ret) => {\n        delete ret.__v;\n        return {\n          ...ret,\n        };\n      },\n    },\n  }\n);\n\nconst Carts = mongoose.model(\"Carts\", CartsSchema);\n\nexport default Carts;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,KAAA,GAAAH,sBAAA,CAAAC,OAAA;AAAiC,SAAAD,uBAAAI,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEjC,MAAMG,MAAM,GAAGC,iBAAQ,CAACD,MAAM;AAC9B,MAAM;EAAEE;AAAS,CAAC,GAAGF,MAAM,CAACG,KAAK;AAEjC,MAAMC,WAAW,GAAG,IAAIJ,MAAM,CAC5B;EACEK,IAAI,EAAE;IACJC,IAAI,EAAEC,MAAM;IACZR,OAAO,EAAE,IAAAM,aAAI,EAAC,CAAC;IACfG,MAAM,EAAE,IAAI;IACZC,QAAQ,EAAE;EACZ,CAAC;EACDC,SAAS,EAAE;IACTJ,IAAI,EAAEK,OAAO;IACbZ,OAAO,EAAE,KAAK;IACdU,QAAQ,EAAE;EACZ,CAAC;EACDG,KAAK,EAAE;IACLN,IAAI,EAAEJ,QAAQ;IACdW,GAAG,EAAE,OAAO;IACZJ,QAAQ,EAAE;EACZ,CAAC;EACDK,QAAQ,EAAE;IACRR,IAAI,EAAE,CAACJ,QAAQ,CAAC;IAChBW,GAAG,EAAE,UAAU;IACfJ,QAAQ,EAAE;EACZ,CAAC;EACDM,QAAQ,EAAE;IACRT,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE,IAAI;IACdV,OAAO,EAAE,KAAK;IACdiB,IAAI,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK;EAC5B;AACF,CAAC,EACD;EACEC,GAAG,EAAE,IAAI;EACTC,UAAU,EAAE,OAAO;EACnBC,UAAU,EAAE,IAAI;EAChBC,MAAM,EAAE;IACNC,SAAS,EAAEA,CAACC,GAAG,EAAEC,GAAG,KAAK;MACvB,OAAOA,GAAG,CAACC,GAAG;MACd,OAAO;QACL,GAAGD;MACL,CAAC;IACH;EACF;AACF,CACF,CAAC;AAED,MAAME,KAAK,GAAGxB,iBAAQ,CAACyB,KAAK,CAAC,OAAO,EAAEtB,WAAW,CAAC;AAAC,IAAAuB,QAAA,GAAAC,OAAA,CAAA7B,OAAA,GAEpC0B,KAAK","ignoreList":[]}},"mtime":1723193628564},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/cart.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst CartsSchema = new Schema({\n  uuid: {\n    type: String,\n    default: (0, _uuid.default)(),\n    unique: true,\n    required: true\n  },\n  completed: {\n    type: Boolean,\n    default: false,\n    required: true\n  },\n  buyer: {\n    type: ObjectId,\n    ref: \"Users\",\n    required: true\n  },\n  products: {\n    type: [ObjectId],\n    ref: \"Products\",\n    required: true\n  },\n  currency: {\n    type: String,\n    required: true,\n    default: \"TRY\",\n    enum: [\"TRY\", \"USD\", \"EUR\"]\n  }\n}, {\n  _id: true,\n  collection: \"carts\",\n  timestamps: true,\n  toJSON: {\n    transform: (doc, ret) => {\n      delete ret.__v;\n      return {\n        ...ret\n      };\n    }\n  }\n});\nconst Carts = _mongoose.default.model(\"Carts\", CartsSchema);\nvar _default = exports.default = Carts;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9iY3J5cHRqcyIsIl91dWlkIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiU2NoZW1hIiwibW9uZ29vc2UiLCJPYmplY3RJZCIsIlR5cGVzIiwiQ2FydHNTY2hlbWEiLCJ1dWlkIiwidHlwZSIsIlN0cmluZyIsInVuaXF1ZSIsInJlcXVpcmVkIiwiY29tcGxldGVkIiwiQm9vbGVhbiIsImJ1eWVyIiwicmVmIiwicHJvZHVjdHMiLCJjdXJyZW5jeSIsImVudW0iLCJfaWQiLCJjb2xsZWN0aW9uIiwidGltZXN0YW1wcyIsInRvSlNPTiIsInRyYW5zZm9ybSIsImRvYyIsInJldCIsIl9fdiIsIkNhcnRzIiwibW9kZWwiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9kYi8iLCJzb3VyY2VzIjpbImNhcnQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlIGZyb20gXCJtb25nb29zZVwiO1xuaW1wb3J0IGJjcnlwdCBmcm9tIFwiYmNyeXB0anNcIjtcbmltcG9ydCB1dWlkIGZyb20gXCIuLi91dGlscy91dWlkXCI7XG5cbmNvbnN0IFNjaGVtYSA9IG1vbmdvb3NlLlNjaGVtYTtcbmNvbnN0IHsgT2JqZWN0SWQgfSA9IFNjaGVtYS5UeXBlcztcblxuY29uc3QgQ2FydHNTY2hlbWEgPSBuZXcgU2NoZW1hKFxuICB7XG4gICAgdXVpZDoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgZGVmYXVsdDogdXVpZCgpLFxuICAgICAgdW5pcXVlOiB0cnVlLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBjb21wbGV0ZWQ6IHtcbiAgICAgIHR5cGU6IEJvb2xlYW4sXG4gICAgICBkZWZhdWx0OiBmYWxzZSxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgYnV5ZXI6IHtcbiAgICAgIHR5cGU6IE9iamVjdElkLFxuICAgICAgcmVmOiBcIlVzZXJzXCIsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIHByb2R1Y3RzOiB7XG4gICAgICB0eXBlOiBbT2JqZWN0SWRdLFxuICAgICAgcmVmOiBcIlByb2R1Y3RzXCIsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGN1cnJlbmN5OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIGRlZmF1bHQ6IFwiVFJZXCIsXG4gICAgICBlbnVtOiBbXCJUUllcIiwgXCJVU0RcIiwgXCJFVVJcIl0sXG4gICAgfSxcbiAgfSxcbiAge1xuICAgIF9pZDogdHJ1ZSxcbiAgICBjb2xsZWN0aW9uOiBcImNhcnRzXCIsXG4gICAgdGltZXN0YW1wczogdHJ1ZSxcbiAgICB0b0pTT046IHtcbiAgICAgIHRyYW5zZm9ybTogKGRvYywgcmV0KSA9PiB7XG4gICAgICAgIGRlbGV0ZSByZXQuX192O1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLnJldCxcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgfSxcbiAgfVxuKTtcblxuY29uc3QgQ2FydHMgPSBtb25nb29zZS5tb2RlbChcIkNhcnRzXCIsIENhcnRzU2NoZW1hKTtcblxuZXhwb3J0IGRlZmF1bHQgQ2FydHM7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFNBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLEtBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUFpQyxTQUFBRCx1QkFBQUksQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUVqQyxNQUFNRyxNQUFNLEdBQUdDLGlCQUFRLENBQUNELE1BQU07QUFDOUIsTUFBTTtFQUFFRTtBQUFTLENBQUMsR0FBR0YsTUFBTSxDQUFDRyxLQUFLO0FBRWpDLE1BQU1DLFdBQVcsR0FBRyxJQUFJSixNQUFNLENBQzVCO0VBQ0VLLElBQUksRUFBRTtJQUNKQyxJQUFJLEVBQUVDLE1BQU07SUFDWlIsT0FBTyxFQUFFLElBQUFNLGFBQUksRUFBQyxDQUFDO0lBQ2ZHLE1BQU0sRUFBRSxJQUFJO0lBQ1pDLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDREMsU0FBUyxFQUFFO0lBQ1RKLElBQUksRUFBRUssT0FBTztJQUNiWixPQUFPLEVBQUUsS0FBSztJQUNkVSxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RHLEtBQUssRUFBRTtJQUNMTixJQUFJLEVBQUVKLFFBQVE7SUFDZFcsR0FBRyxFQUFFLE9BQU87SUFDWkosUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNESyxRQUFRLEVBQUU7SUFDUlIsSUFBSSxFQUFFLENBQUNKLFFBQVEsQ0FBQztJQUNoQlcsR0FBRyxFQUFFLFVBQVU7SUFDZkosUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNETSxRQUFRLEVBQUU7SUFDUlQsSUFBSSxFQUFFQyxNQUFNO0lBQ1pFLFFBQVEsRUFBRSxJQUFJO0lBQ2RWLE9BQU8sRUFBRSxLQUFLO0lBQ2RpQixJQUFJLEVBQUUsQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUs7RUFDNUI7QUFDRixDQUFDLEVBQ0Q7RUFDRUMsR0FBRyxFQUFFLElBQUk7RUFDVEMsVUFBVSxFQUFFLE9BQU87RUFDbkJDLFVBQVUsRUFBRSxJQUFJO0VBQ2hCQyxNQUFNLEVBQUU7SUFDTkMsU0FBUyxFQUFFQSxDQUFDQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztNQUN2QixPQUFPQSxHQUFHLENBQUNDLEdBQUc7TUFDZCxPQUFPO1FBQ0wsR0FBR0Q7TUFDTCxDQUFDO0lBQ0g7RUFDRjtBQUNGLENBQ0YsQ0FBQztBQUVELE1BQU1FLEtBQUssR0FBR3hCLGlCQUFRLENBQUN5QixLQUFLLENBQUMsT0FBTyxFQUFFdEIsV0FBVyxDQUFDO0FBQUMsSUFBQXVCLFFBQUEsR0FBQUMsT0FBQSxDQUFBN0IsT0FBQSxHQUVwQzBCLEtBQUsiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","_bcryptjs","_uuid","e","__esModule","default","Schema","mongoose","ObjectId","Types","CartsSchema","uuid","type","String","unique","required","completed","Boolean","buyer","ref","products","currency","enum","_id","collection","timestamps","toJSON","transform","doc","ret","__v","Carts","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["cart.js"],"sourcesContent":["import mongoose from \"mongoose\";\nimport bcrypt from \"bcryptjs\";\nimport uuid from \"../utils/uuid\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\n\nconst CartsSchema = new Schema(\n  {\n    uuid: {\n      type: String,\n      default: uuid(),\n      unique: true,\n      required: true,\n    },\n    completed: {\n      type: Boolean,\n      default: false,\n      required: true,\n    },\n    buyer: {\n      type: ObjectId,\n      ref: \"Users\",\n      required: true,\n    },\n    products: {\n      type: [ObjectId],\n      ref: \"Products\",\n      required: true,\n    },\n    currency: {\n      type: String,\n      required: true,\n      default: \"TRY\",\n      enum: [\"TRY\", \"USD\", \"EUR\"],\n    },\n  },\n  {\n    _id: true,\n    collection: \"carts\",\n    timestamps: true,\n    toJSON: {\n      transform: (doc, ret) => {\n        delete ret.__v;\n        return {\n          ...ret,\n        };\n      },\n    },\n  }\n);\n\nconst Carts = mongoose.model(\"Carts\", CartsSchema);\n\nexport default Carts;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,KAAA,GAAAH,sBAAA,CAAAC,OAAA;AAAiC,SAAAD,uBAAAI,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEjC,MAAMG,MAAM,GAAGC,iBAAQ,CAACD,MAAM;AAC9B,MAAM;EAAEE;AAAS,CAAC,GAAGF,MAAM,CAACG,KAAK;AAEjC,MAAMC,WAAW,GAAG,IAAIJ,MAAM,CAC5B;EACEK,IAAI,EAAE;IACJC,IAAI,EAAEC,MAAM;IACZR,OAAO,EAAE,IAAAM,aAAI,EAAC,CAAC;IACfG,MAAM,EAAE,IAAI;IACZC,QAAQ,EAAE;EACZ,CAAC;EACDC,SAAS,EAAE;IACTJ,IAAI,EAAEK,OAAO;IACbZ,OAAO,EAAE,KAAK;IACdU,QAAQ,EAAE;EACZ,CAAC;EACDG,KAAK,EAAE;IACLN,IAAI,EAAEJ,QAAQ;IACdW,GAAG,EAAE,OAAO;IACZJ,QAAQ,EAAE;EACZ,CAAC;EACDK,QAAQ,EAAE;IACRR,IAAI,EAAE,CAACJ,QAAQ,CAAC;IAChBW,GAAG,EAAE,UAAU;IACfJ,QAAQ,EAAE;EACZ,CAAC;EACDM,QAAQ,EAAE;IACRT,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE,IAAI;IACdV,OAAO,EAAE,KAAK;IACdiB,IAAI,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK;EAC5B;AACF,CAAC,EACD;EACEC,GAAG,EAAE,IAAI;EACTC,UAAU,EAAE,OAAO;EACnBC,UAAU,EAAE,IAAI;EAChBC,MAAM,EAAE;IACNC,SAAS,EAAEA,CAACC,GAAG,EAAEC,GAAG,KAAK;MACvB,OAAOA,GAAG,CAACC,GAAG;MACd,OAAO;QACL,GAAGD;MACL,CAAC;IACH;EACF;AACF,CACF,CAAC;AAED,MAAME,KAAK,GAAGxB,iBAAQ,CAACyB,KAAK,CAAC,OAAO,EAAEtB,WAAW,CAAC;AAAC,IAAAuB,QAAA,GAAAC,OAAA,CAAA7B,OAAA,GAEpC0B,KAAK","ignoreList":[]}},"mtime":1723193628564},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/cart.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nvar _products = _interopRequireDefault(require(\"../db/products\"));\nvar _cart = _interopRequireDefault(require(\"../db/cart\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = router => {\n  router.post(\"/carts\", _Session.default, async (req, res, next) => {\n    try {\n      const {\n        productId\n      } = req.body;\n\n      // Ürünün geçerli olup olmadığını kontrol et\n      const product = await _products.default.findById(productId);\n      if (!product) {\n        throw new _ApiError.default(\"Product not found\", 404, \"ProductNotFound\");\n      }\n\n      // Kullanıcının mevcut bir sepeti var mı kontrol et (Tamamlanmamış bir sepet)\n      let cart = await _cart.default.findOne({\n        buyer: req.user._id,\n        completed: false\n      });\n\n      // Eğer mevcut bir sepet yoksa yeni bir sepet oluştur\n      if (!cart) {\n        cart = new _cart.default({\n          buyer: new _mongoose.default.Types.ObjectId(req.user._id)\n        });\n      }\n\n      // Ürünü sepete ekle\n      cart.products.push(new _mongoose.default.Types.ObjectId(productId));\n\n      // Sepeti kaydet\n      await cart.save();\n      res.status(200).json({\n        message: \"Product added on cart.\",\n        cart\n      });\n    } catch (error) {\n      console.log(error);\n      throw new _ApiError.default(\"Cart could not be created\", 400, \"cartCreationFailed\");\n    }\n  });\n  router.get(\"/getCart\", _Session.default, async (req, res) => {\n    try {\n      const cart = await _cart.default.findOne({\n        buyer: req.user._id,\n        completed: false\n      }).populate(\"products\");\n      if (!cart) {\n        throw new _ApiError.default(\"No active Cart found\", 401, \"cartNotFound\");\n      }\n      res.status(200).json(cart);\n    } catch (error) {\n      console.log(error);\n      throw new _ApiError.default(\"Could not retrieve cart\", 400, \"getCartFailed\");\n    }\n  });\n  router.post(\"/delete-product-in-cart/:cartId\", _Session.default, async (req, res) => {\n    try {\n      const {\n        cartId\n      } = req.params;\n      const {\n        productId\n      } = req.body;\n      const cart = await _cart.default.findById(cartId);\n      if (!cart) {\n        throw new _ApiError.default(\"Cart not found\", 404, \"CartNotFound\");\n      }\n\n      // if (cart.buyer.toString() !== req.user._id.toString()) {\n      //   throw new ApiError(\n      //     \" You are not the owner of this cart\",\n      //     403,\n      //     \"youAreNotTheOwnerOfThisCart\"\n      //   );\n      // }\n\n      const productIndex = cart.products.indexOf(new _mongoose.default.Types.ObjectId(productId));\n      if (productIndex > -1) {\n        cart.products.splice(productIndex, 1);\n      } else {\n        throw new _ApiError.default(\"Product not found in cart\", 404, \"ProductNotFoundInCart\");\n      }\n      await cart.save();\n      res.status(200).json({\n        message: \"Product has been removed.\",\n        cart\n      });\n    } catch (error) {\n      console.log(error);\n      throw new _ApiError.default(\"Could not delete product from cart\", 400, \"DeleteProductFailed\");\n    }\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQXBpRXJyb3IiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9tb25nb29zZSIsIl9TZXNzaW9uIiwiX3Byb2R1Y3RzIiwiX2NhcnQiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfZGVmYXVsdCIsInJvdXRlciIsInBvc3QiLCJTZXNzaW9uIiwicmVxIiwicmVzIiwibmV4dCIsInByb2R1Y3RJZCIsImJvZHkiLCJwcm9kdWN0IiwiUHJvZHVjdHMiLCJmaW5kQnlJZCIsIkFwaUVycm9yIiwiY2FydCIsIkNhcnQiLCJmaW5kT25lIiwiYnV5ZXIiLCJ1c2VyIiwiX2lkIiwiY29tcGxldGVkIiwibW9uZ29vc2UiLCJUeXBlcyIsIk9iamVjdElkIiwicHJvZHVjdHMiLCJwdXNoIiwic2F2ZSIsInN0YXR1cyIsImpzb24iLCJtZXNzYWdlIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwiZ2V0IiwicG9wdWxhdGUiLCJjYXJ0SWQiLCJwYXJhbXMiLCJwcm9kdWN0SW5kZXgiLCJpbmRleE9mIiwic3BsaWNlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3JvdXRlcy8iLCJzb3VyY2VzIjpbImNhcnQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuLi9lcnJvcnMvQXBpRXJyb3JcIjtcbmltcG9ydCBtb25nb29zZSBmcm9tIFwibW9uZ29vc2VcIjtcbmltcG9ydCBTZXNzaW9uIGZyb20gXCIuLi9taWRkbGV3YXJlcy9TZXNzaW9uXCI7XG5pbXBvcnQgUHJvZHVjdHMgZnJvbSBcIi4uL2RiL3Byb2R1Y3RzXCI7XG5pbXBvcnQgQ2FydCBmcm9tIFwiLi4vZGIvY2FydFwiO1xuXG5leHBvcnQgZGVmYXVsdCAocm91dGVyKSA9PiB7XG4gIHJvdXRlci5wb3N0KFwiL2NhcnRzXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IHByb2R1Y3RJZCB9ID0gcmVxLmJvZHk7XG5cbiAgICAgIC8vIMOccsO8bsO8biBnZcOnZXJsaSBvbHVwIG9sbWFkxLHEn8SxbsSxIGtvbnRyb2wgZXRcbiAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBQcm9kdWN0cy5maW5kQnlJZChwcm9kdWN0SWQpO1xuICAgICAgaWYgKCFwcm9kdWN0KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIlByb2R1Y3Qgbm90IGZvdW5kXCIsIDQwNCwgXCJQcm9kdWN0Tm90Rm91bmRcIik7XG4gICAgICB9XG5cbiAgICAgIC8vIEt1bGxhbsSxY8SxbsSxbiBtZXZjdXQgYmlyIHNlcGV0aSB2YXIgbcSxIGtvbnRyb2wgZXQgKFRhbWFtbGFubWFtxLHFnyBiaXIgc2VwZXQpXG4gICAgICBsZXQgY2FydCA9IGF3YWl0IENhcnQuZmluZE9uZSh7XG4gICAgICAgIGJ1eWVyOiByZXEudXNlci5faWQsXG4gICAgICAgIGNvbXBsZXRlZDogZmFsc2UsXG4gICAgICB9KTtcblxuICAgICAgLy8gRcSfZXIgbWV2Y3V0IGJpciBzZXBldCB5b2tzYSB5ZW5pIGJpciBzZXBldCBvbHXFn3R1clxuICAgICAgaWYgKCFjYXJ0KSB7XG4gICAgICAgIGNhcnQgPSBuZXcgQ2FydCh7XG4gICAgICAgICAgYnV5ZXI6IG5ldyBtb25nb29zZS5UeXBlcy5PYmplY3RJZChyZXEudXNlci5faWQpLFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gw5xyw7xuw7wgc2VwZXRlIGVrbGVcbiAgICAgIGNhcnQucHJvZHVjdHMucHVzaChuZXcgbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQocHJvZHVjdElkKSk7XG5cbiAgICAgIC8vIFNlcGV0aSBrYXlkZXRcbiAgICAgIGF3YWl0IGNhcnQuc2F2ZSgpO1xuXG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gICAgICAgIG1lc3NhZ2U6IFwiUHJvZHVjdCBhZGRlZCBvbiBjYXJ0LlwiLFxuICAgICAgICBjYXJ0LFxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgXCJDYXJ0IGNvdWxkIG5vdCBiZSBjcmVhdGVkXCIsXG4gICAgICAgIDQwMCxcbiAgICAgICAgXCJjYXJ0Q3JlYXRpb25GYWlsZWRcIlxuICAgICAgKTtcbiAgICB9XG4gIH0pO1xuICByb3V0ZXIuZ2V0KFwiL2dldENhcnRcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNhcnQgPSBhd2FpdCBDYXJ0LmZpbmRPbmUoe1xuICAgICAgICBidXllcjogcmVxLnVzZXIuX2lkLFxuICAgICAgICBjb21wbGV0ZWQ6IGZhbHNlLFxuICAgICAgfSkucG9wdWxhdGUoXCJwcm9kdWN0c1wiKTtcbiAgICAgIGlmICghY2FydCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJObyBhY3RpdmUgQ2FydCBmb3VuZFwiLCA0MDEsIFwiY2FydE5vdEZvdW5kXCIpO1xuICAgICAgfVxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oY2FydCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNvdWxkIG5vdCByZXRyaWV2ZSBjYXJ0XCIsIDQwMCwgXCJnZXRDYXJ0RmFpbGVkXCIpO1xuICAgIH1cbiAgfSk7XG4gIHJvdXRlci5wb3N0KFwiL2RlbGV0ZS1wcm9kdWN0LWluLWNhcnQvOmNhcnRJZFwiLCBTZXNzaW9uLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBjYXJ0SWQgfSA9IHJlcS5wYXJhbXM7XG4gICAgICBjb25zdCB7IHByb2R1Y3RJZCB9ID0gcmVxLmJvZHk7XG5cbiAgICAgIGNvbnN0IGNhcnQgPSBhd2FpdCBDYXJ0LmZpbmRCeUlkKGNhcnRJZCk7XG4gICAgICBpZiAoIWNhcnQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FydCBub3QgZm91bmRcIiwgNDA0LCBcIkNhcnROb3RGb3VuZFwiKTtcbiAgICAgIH1cblxuICAgICAgLy8gaWYgKGNhcnQuYnV5ZXIudG9TdHJpbmcoKSAhPT0gcmVxLnVzZXIuX2lkLnRvU3RyaW5nKCkpIHtcbiAgICAgIC8vICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgLy8gICAgIFwiIFlvdSBhcmUgbm90IHRoZSBvd25lciBvZiB0aGlzIGNhcnRcIixcbiAgICAgIC8vICAgICA0MDMsXG4gICAgICAvLyAgICAgXCJ5b3VBcmVOb3RUaGVPd25lck9mVGhpc0NhcnRcIlxuICAgICAgLy8gICApO1xuICAgICAgLy8gfVxuXG4gICAgICBjb25zdCBwcm9kdWN0SW5kZXggPSBjYXJ0LnByb2R1Y3RzLmluZGV4T2YoXG4gICAgICAgIG5ldyBtb25nb29zZS5UeXBlcy5PYmplY3RJZChwcm9kdWN0SWQpXG4gICAgICApO1xuICAgICAgaWYgKHByb2R1Y3RJbmRleCA+IC0xKSB7XG4gICAgICAgIGNhcnQucHJvZHVjdHMuc3BsaWNlKHByb2R1Y3RJbmRleCwgMSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgXCJQcm9kdWN0IG5vdCBmb3VuZCBpbiBjYXJ0XCIsXG4gICAgICAgICAgNDA0LFxuICAgICAgICAgIFwiUHJvZHVjdE5vdEZvdW5kSW5DYXJ0XCJcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgYXdhaXQgY2FydC5zYXZlKCk7XG5cbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICAgICAgbWVzc2FnZTogXCJQcm9kdWN0IGhhcyBiZWVuIHJlbW92ZWQuXCIsXG4gICAgICAgIGNhcnQsXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICBcIkNvdWxkIG5vdCBkZWxldGUgcHJvZHVjdCBmcm9tIGNhcnRcIixcbiAgICAgICAgNDAwLFxuICAgICAgICBcIkRlbGV0ZVByb2R1Y3RGYWlsZWRcIlxuICAgICAgKTtcbiAgICB9XG4gIH0pO1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsU0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsU0FBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsUUFBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUcsU0FBQSxHQUFBSixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUksS0FBQSxHQUFBTCxzQkFBQSxDQUFBQyxPQUFBO0FBQThCLFNBQUFELHVCQUFBTSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBQUEsSUFBQUcsUUFBQSxHQUVkQyxNQUFNLElBQUs7RUFDekJBLE1BQU0sQ0FBQ0MsSUFBSSxDQUFDLFFBQVEsRUFBRUMsZ0JBQU8sRUFBRSxPQUFPQyxHQUFHLEVBQUVDLEdBQUcsRUFBRUMsSUFBSSxLQUFLO0lBQ3ZELElBQUk7TUFDRixNQUFNO1FBQUVDO01BQVUsQ0FBQyxHQUFHSCxHQUFHLENBQUNJLElBQUk7O01BRTlCO01BQ0EsTUFBTUMsT0FBTyxHQUFHLE1BQU1DLGlCQUFRLENBQUNDLFFBQVEsQ0FBQ0osU0FBUyxDQUFDO01BQ2xELElBQUksQ0FBQ0UsT0FBTyxFQUFFO1FBQ1osTUFBTSxJQUFJRyxpQkFBUSxDQUFDLG1CQUFtQixFQUFFLEdBQUcsRUFBRSxpQkFBaUIsQ0FBQztNQUNqRTs7TUFFQTtNQUNBLElBQUlDLElBQUksR0FBRyxNQUFNQyxhQUFJLENBQUNDLE9BQU8sQ0FBQztRQUM1QkMs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","map":{"version":3,"names":["_ApiError","_interopRequireDefault","require","_mongoose","_Session","_products","_cart","e","__esModule","default","_default","router","post","Session","req","res","next","productId","body","product","Products","findById","ApiError","cart","Cart","findOne","buyer","user","_id","completed","mongoose","Types","ObjectId","products","push","save","status","json","message","error","console","log","get","populate","cartId","params","productIndex","indexOf","splice","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["cart.js"],"sourcesContent":["import ApiError from \"../errors/ApiError\";\nimport mongoose from \"mongoose\";\nimport Session from \"../middlewares/Session\";\nimport Products from \"../db/products\";\nimport Cart from \"../db/cart\";\n\nexport default (router) => {\n  router.post(\"/carts\", Session, async (req, res, next) => {\n    try {\n      const { productId } = req.body;\n\n      // Ürünün geçerli olup olmadığını kontrol et\n      const product = await Products.findById(productId);\n      if (!product) {\n        throw new ApiError(\"Product not found\", 404, \"ProductNotFound\");\n      }\n\n      // Kullanıcının mevcut bir sepeti var mı kontrol et (Tamamlanmamış bir sepet)\n      let cart = await Cart.findOne({\n        buyer: req.user._id,\n        completed: false,\n      });\n\n      // Eğer mevcut bir sepet yoksa yeni bir sepet oluştur\n      if (!cart) {\n        cart = new Cart({\n          buyer: new mongoose.Types.ObjectId(req.user._id),\n        });\n      }\n\n      // Ürünü sepete ekle\n      cart.products.push(new mongoose.Types.ObjectId(productId));\n\n      // Sepeti kaydet\n      await cart.save();\n\n      res.status(200).json({\n        message: \"Product added on cart.\",\n        cart,\n      });\n    } catch (error) {\n      console.log(error);\n      throw new ApiError(\n        \"Cart could not be created\",\n        400,\n        \"cartCreationFailed\"\n      );\n    }\n  });\n  router.get(\"/getCart\", Session, async (req, res) => {\n    try {\n      const cart = await Cart.findOne({\n        buyer: req.user._id,\n        completed: false,\n      }).populate(\"products\");\n      if (!cart) {\n        throw new ApiError(\"No active Cart found\", 401, \"cartNotFound\");\n      }\n      res.status(200).json(cart);\n    } catch (error) {\n      console.log(error);\n      throw new ApiError(\"Could not retrieve cart\", 400, \"getCartFailed\");\n    }\n  });\n  router.post(\"/delete-product-in-cart/:cartId\", Session, async (req, res) => {\n    try {\n      const { cartId } = req.params;\n      const { productId } = req.body;\n\n      const cart = await Cart.findById(cartId);\n      if (!cart) {\n        throw new ApiError(\"Cart not found\", 404, \"CartNotFound\");\n      }\n\n      // if (cart.buyer.toString() !== req.user._id.toString()) {\n      //   throw new ApiError(\n      //     \" You are not the owner of this cart\",\n      //     403,\n      //     \"youAreNotTheOwnerOfThisCart\"\n      //   );\n      // }\n\n      const productIndex = cart.products.indexOf(\n        new mongoose.Types.ObjectId(productId)\n      );\n      if (productIndex > -1) {\n        cart.products.splice(productIndex, 1);\n      } else {\n        throw new ApiError(\n          \"Product not found in cart\",\n          404,\n          \"ProductNotFoundInCart\"\n        );\n      }\n\n      await cart.save();\n\n      res.status(200).json({\n        message: \"Product has been removed.\",\n        cart,\n      });\n    } catch (error) {\n      console.log(error);\n      throw new ApiError(\n        \"Could not delete product from cart\",\n        400,\n        \"DeleteProductFailed\"\n      );\n    }\n  });\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1723544825935},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/cart.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nvar _products = _interopRequireDefault(require(\"../db/products\"));\nvar _cart = _interopRequireDefault(require(\"../db/cart\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = router => {\n  router.post(\"/carts\", _Session.default, async (req, res, next) => {\n    try {\n      const {\n        productId\n      } = req.body;\n\n      // Ürünün geçerli olup olmadığını kontrol et\n      const product = await _products.default.findById(productId);\n      if (!product) {\n        throw new _ApiError.default(\"Product not found\", 404, \"ProductNotFound\");\n      }\n\n      // Kullanıcının mevcut bir sepeti var mı kontrol et (Tamamlanmamış bir sepet)\n      let cart = await _cart.default.findOne({\n        buyer: req.user._id,\n        completed: false\n      });\n\n      // Eğer mevcut bir sepet yoksa yeni bir sepet oluştur\n      if (!cart) {\n        cart = new _cart.default({\n          buyer: new _mongoose.default.Types.ObjectId(req.user._id)\n        });\n      }\n\n      // Ürünü sepete ekle\n      cart.products.push(new _mongoose.default.Types.ObjectId(productId));\n\n      // Sepeti kaydet\n      await cart.save();\n      res.status(200).json({\n        message: \"Product added on cart.\",\n        cart\n      });\n    } catch (error) {\n      console.log(error);\n      throw new _ApiError.default(\"Cart could not be created\", 400, \"cartCreationFailed\");\n    }\n  });\n  router.get(\"/getCart\", _Session.default, async (req, res) => {\n    try {\n      const cart = await _cart.default.findOne({\n        buyer: req.user._id,\n        completed: false\n      }).populate(\"products\");\n      if (!cart) {\n        throw new _ApiError.default(\"No active Cart found\", 401, \"cartNotFound\");\n      }\n      res.status(200).json(cart);\n    } catch (error) {\n      console.log(error);\n      throw new _ApiError.default(\"Could not retrieve cart\", 400, \"getCartFailed\");\n    }\n  });\n  router.post(\"/delete-product-in-cart/:cartId\", _Session.default, async (req, res) => {\n    try {\n      const {\n        cartId\n      } = req.params;\n      const {\n        productId\n      } = req.body;\n      const cart = await _cart.default.findById(cartId);\n      if (!cart) {\n        throw new _ApiError.default(\"Cart not found\", 404, \"CartNotFound\");\n      }\n\n      // if (cart.buyer.toString() !== req.user._id.toString()) {\n      //   throw new ApiError(\n      //     \" You are not the owner of this cart\",\n      //     403,\n      //     \"youAreNotTheOwnerOfThisCart\"\n      //   );\n      // }\n\n      const productIndex = cart.products.indexOf(new _mongoose.default.Types.ObjectId(productId));\n      if (productIndex > -1) {\n        cart.products.splice(productIndex, 1);\n      } else {\n        throw new _ApiError.default(\"Product not found in cart\", 404, \"ProductNotFoundInCart\");\n      }\n      await cart.save();\n      res.status(200).json({\n        message: \"Product has been removed.\",\n        cart\n      });\n    } catch (error) {\n      console.log(error);\n      throw new _ApiError.default(\"Could not delete product from cart\", 400, \"DeleteProductFailed\");\n    }\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQXBpRXJyb3IiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9tb25nb29zZSIsIl9TZXNzaW9uIiwiX3Byb2R1Y3RzIiwiX2NhcnQiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfZGVmYXVsdCIsInJvdXRlciIsInBvc3QiLCJTZXNzaW9uIiwicmVxIiwicmVzIiwibmV4dCIsInByb2R1Y3RJZCIsImJvZHkiLCJwcm9kdWN0IiwiUHJvZHVjdHMiLCJmaW5kQnlJZCIsIkFwaUVycm9yIiwiY2FydCIsIkNhcnQiLCJmaW5kT25lIiwiYnV5ZXIiLCJ1c2VyIiwiX2lkIiwiY29tcGxldGVkIiwibW9uZ29vc2UiLCJUeXBlcyIsIk9iamVjdElkIiwicHJvZHVjdHMiLCJwdXNoIiwic2F2ZSIsInN0YXR1cyIsImpzb24iLCJtZXNzYWdlIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwiZ2V0IiwicG9wdWxhdGUiLCJjYXJ0SWQiLCJwYXJhbXMiLCJwcm9kdWN0SW5kZXgiLCJpbmRleE9mIiwic3BsaWNlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3JvdXRlcy8iLCJzb3VyY2VzIjpbImNhcnQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuLi9lcnJvcnMvQXBpRXJyb3JcIjtcbmltcG9ydCBtb25nb29zZSBmcm9tIFwibW9uZ29vc2VcIjtcbmltcG9ydCBTZXNzaW9uIGZyb20gXCIuLi9taWRkbGV3YXJlcy9TZXNzaW9uXCI7XG5pbXBvcnQgUHJvZHVjdHMgZnJvbSBcIi4uL2RiL3Byb2R1Y3RzXCI7XG5pbXBvcnQgQ2FydCBmcm9tIFwiLi4vZGIvY2FydFwiO1xuXG5leHBvcnQgZGVmYXVsdCAocm91dGVyKSA9PiB7XG4gIHJvdXRlci5wb3N0KFwiL2NhcnRzXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IHByb2R1Y3RJZCB9ID0gcmVxLmJvZHk7XG5cbiAgICAgIC8vIMOccsO8bsO8biBnZcOnZXJsaSBvbHVwIG9sbWFkxLHEn8SxbsSxIGtvbnRyb2wgZXRcbiAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBQcm9kdWN0cy5maW5kQnlJZChwcm9kdWN0SWQpO1xuICAgICAgaWYgKCFwcm9kdWN0KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIlByb2R1Y3Qgbm90IGZvdW5kXCIsIDQwNCwgXCJQcm9kdWN0Tm90Rm91bmRcIik7XG4gICAgICB9XG5cbiAgICAgIC8vIEt1bGxhbsSxY8SxbsSxbiBtZXZjdXQgYmlyIHNlcGV0aSB2YXIgbcSxIGtvbnRyb2wgZXQgKFRhbWFtbGFubWFtxLHFnyBiaXIgc2VwZXQpXG4gICAgICBsZXQgY2FydCA9IGF3YWl0IENhcnQuZmluZE9uZSh7XG4gICAgICAgIGJ1eWVyOiByZXEudXNlci5faWQsXG4gICAgICAgIGNvbXBsZXRlZDogZmFsc2UsXG4gICAgICB9KTtcblxuICAgICAgLy8gRcSfZXIgbWV2Y3V0IGJpciBzZXBldCB5b2tzYSB5ZW5pIGJpciBzZXBldCBvbHXFn3R1clxuICAgICAgaWYgKCFjYXJ0KSB7XG4gICAgICAgIGNhcnQgPSBuZXcgQ2FydCh7XG4gICAgICAgICAgYnV5ZXI6IG5ldyBtb25nb29zZS5UeXBlcy5PYmplY3RJZChyZXEudXNlci5faWQpLFxuICAgICAgICB9KTtcbiAgICAgIH1cblxuICAgICAgLy8gw5xyw7xuw7wgc2VwZXRlIGVrbGVcbiAgICAgIGNhcnQucHJvZHVjdHMucHVzaChuZXcgbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQocHJvZHVjdElkKSk7XG5cbiAgICAgIC8vIFNlcGV0aSBrYXlkZXRcbiAgICAgIGF3YWl0IGNhcnQuc2F2ZSgpO1xuXG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gICAgICAgIG1lc3NhZ2U6IFwiUHJvZHVjdCBhZGRlZCBvbiBjYXJ0LlwiLFxuICAgICAgICBjYXJ0LFxuICAgICAgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgXCJDYXJ0IGNvdWxkIG5vdCBiZSBjcmVhdGVkXCIsXG4gICAgICAgIDQwMCxcbiAgICAgICAgXCJjYXJ0Q3JlYXRpb25GYWlsZWRcIlxuICAgICAgKTtcbiAgICB9XG4gIH0pO1xuICByb3V0ZXIuZ2V0KFwiL2dldENhcnRcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGNhcnQgPSBhd2FpdCBDYXJ0LmZpbmRPbmUoe1xuICAgICAgICBidXllcjogcmVxLnVzZXIuX2lkLFxuICAgICAgICBjb21wbGV0ZWQ6IGZhbHNlLFxuICAgICAgfSkucG9wdWxhdGUoXCJwcm9kdWN0c1wiKTtcbiAgICAgIGlmICghY2FydCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJObyBhY3RpdmUgQ2FydCBmb3VuZFwiLCA0MDEsIFwiY2FydE5vdEZvdW5kXCIpO1xuICAgICAgfVxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oY2FydCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNvdWxkIG5vdCByZXRyaWV2ZSBjYXJ0XCIsIDQwMCwgXCJnZXRDYXJ0RmFpbGVkXCIpO1xuICAgIH1cbiAgfSk7XG4gIHJvdXRlci5wb3N0KFwiL2RlbGV0ZS1wcm9kdWN0LWluLWNhcnQvOmNhcnRJZFwiLCBTZXNzaW9uLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBjYXJ0SWQgfSA9IHJlcS5wYXJhbXM7XG4gICAgICBjb25zdCB7IHByb2R1Y3RJZCB9ID0gcmVxLmJvZHk7XG5cbiAgICAgIGNvbnN0IGNhcnQgPSBhd2FpdCBDYXJ0LmZpbmRCeUlkKGNhcnRJZCk7XG4gICAgICBpZiAoIWNhcnQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FydCBub3QgZm91bmRcIiwgNDA0LCBcIkNhcnROb3RGb3VuZFwiKTtcbiAgICAgIH1cblxuICAgICAgLy8gaWYgKGNhcnQuYnV5ZXIudG9TdHJpbmcoKSAhPT0gcmVxLnVzZXIuX2lkLnRvU3RyaW5nKCkpIHtcbiAgICAgIC8vICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgLy8gICAgIFwiIFlvdSBhcmUgbm90IHRoZSBvd25lciBvZiB0aGlzIGNhcnRcIixcbiAgICAgIC8vICAgICA0MDMsXG4gICAgICAvLyAgICAgXCJ5b3VBcmVOb3RUaGVPd25lck9mVGhpc0NhcnRcIlxuICAgICAgLy8gICApO1xuICAgICAgLy8gfVxuXG4gICAgICBjb25zdCBwcm9kdWN0SW5kZXggPSBjYXJ0LnByb2R1Y3RzLmluZGV4T2YoXG4gICAgICAgIG5ldyBtb25nb29zZS5UeXBlcy5PYmplY3RJZChwcm9kdWN0SWQpXG4gICAgICApO1xuICAgICAgaWYgKHByb2R1Y3RJbmRleCA+IC0xKSB7XG4gICAgICAgIGNhcnQucHJvZHVjdHMuc3BsaWNlKHByb2R1Y3RJbmRleCwgMSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgXCJQcm9kdWN0IG5vdCBmb3VuZCBpbiBjYXJ0XCIsXG4gICAgICAgICAgNDA0LFxuICAgICAgICAgIFwiUHJvZHVjdE5vdEZvdW5kSW5DYXJ0XCJcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgYXdhaXQgY2FydC5zYXZlKCk7XG5cbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICAgICAgbWVzc2FnZTogXCJQcm9kdWN0IGhhcyBiZWVuIHJlbW92ZWQuXCIsXG4gICAgICAgIGNhcnQsXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICBcIkNvdWxkIG5vdCBkZWxldGUgcHJvZHVjdCBmcm9tIGNhcnRcIixcbiAgICAgICAgNDAwLFxuICAgICAgICBcIkRlbGV0ZVByb2R1Y3RGYWlsZWRcIlxuICAgICAgKTtcbiAgICB9XG4gIH0pO1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsU0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsU0FBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsUUFBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUcsU0FBQSxHQUFBSixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUksS0FBQSxHQUFBTCxzQkFBQSxDQUFBQyxPQUFBO0FBQThCLFNBQUFELHVCQUFBTSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBQUEsSUFBQUcsUUFBQSxHQUVkQyxNQUFNLElBQUs7RUFDekJBLE1BQU0sQ0FBQ0MsSUFBSSxDQUFDLFFBQVEsRUFBRUMsZ0JBQU8sRUFBRSxPQUFPQyxHQUFHLEVBQUVDLEdBQUcsRUFBRUMsSUFBSSxLQUFLO0lBQ3ZELElBQUk7TUFDRixNQUFNO1FBQUVDO01BQVUsQ0FBQyxHQUFHSCxHQUFHLENBQUNJLElBQUk7O01BRTlCO01BQ0EsTUFBTUMsT0FBTyxHQUFHLE1BQU1DLGlCQUFRLENBQUNDLFFBQVEsQ0FBQ0osU0FBUyxDQUFDO01BQ2xELElBQUksQ0FBQ0UsT0FBTyxFQUFFO1FBQ1osTUFBTSxJQUFJRyxpQkFBUSxDQUFDLG1CQUFtQixFQUFFLEdBQUcsRUFBRSxpQkFBaUIsQ0FBQztNQUNqRTs7TUFFQTtNQUNBLElBQUlDLElBQUksR0FBRyxNQUFNQyxhQUFJLENBQUNDLE9BQU8sQ0FBQztRQUM1QkMs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","map":{"version":3,"names":["_ApiError","_interopRequireDefault","require","_mongoose","_Session","_products","_cart","e","__esModule","default","_default","router","post","Session","req","res","next","productId","body","product","Products","findById","ApiError","cart","Cart","findOne","buyer","user","_id","completed","mongoose","Types","ObjectId","products","push","save","status","json","message","error","console","log","get","populate","cartId","params","productIndex","indexOf","splice","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["cart.js"],"sourcesContent":["import ApiError from \"../errors/ApiError\";\nimport mongoose from \"mongoose\";\nimport Session from \"../middlewares/Session\";\nimport Products from \"../db/products\";\nimport Cart from \"../db/cart\";\n\nexport default (router) => {\n  router.post(\"/carts\", Session, async (req, res, next) => {\n    try {\n      const { productId } = req.body;\n\n      // Ürünün geçerli olup olmadığını kontrol et\n      const product = await Products.findById(productId);\n      if (!product) {\n        throw new ApiError(\"Product not found\", 404, \"ProductNotFound\");\n      }\n\n      // Kullanıcının mevcut bir sepeti var mı kontrol et (Tamamlanmamış bir sepet)\n      let cart = await Cart.findOne({\n        buyer: req.user._id,\n        completed: false,\n      });\n\n      // Eğer mevcut bir sepet yoksa yeni bir sepet oluştur\n      if (!cart) {\n        cart = new Cart({\n          buyer: new mongoose.Types.ObjectId(req.user._id),\n        });\n      }\n\n      // Ürünü sepete ekle\n      cart.products.push(new mongoose.Types.ObjectId(productId));\n\n      // Sepeti kaydet\n      await cart.save();\n\n      res.status(200).json({\n        message: \"Product added on cart.\",\n        cart,\n      });\n    } catch (error) {\n      console.log(error);\n      throw new ApiError(\n        \"Cart could not be created\",\n        400,\n        \"cartCreationFailed\"\n      );\n    }\n  });\n  router.get(\"/getCart\", Session, async (req, res) => {\n    try {\n      const cart = await Cart.findOne({\n        buyer: req.user._id,\n        completed: false,\n      }).populate(\"products\");\n      if (!cart) {\n        throw new ApiError(\"No active Cart found\", 401, \"cartNotFound\");\n      }\n      res.status(200).json(cart);\n    } catch (error) {\n      console.log(error);\n      throw new ApiError(\"Could not retrieve cart\", 400, \"getCartFailed\");\n    }\n  });\n  router.post(\"/delete-product-in-cart/:cartId\", Session, async (req, res) => {\n    try {\n      const { cartId } = req.params;\n      const { productId } = req.body;\n\n      const cart = await Cart.findById(cartId);\n      if (!cart) {\n        throw new ApiError(\"Cart not found\", 404, \"CartNotFound\");\n      }\n\n      // if (cart.buyer.toString() !== req.user._id.toString()) {\n      //   throw new ApiError(\n      //     \" You are not the owner of this cart\",\n      //     403,\n      //     \"youAreNotTheOwnerOfThisCart\"\n      //   );\n      // }\n\n      const productIndex = cart.products.indexOf(\n        new mongoose.Types.ObjectId(productId)\n      );\n      if (productIndex > -1) {\n        cart.products.splice(productIndex, 1);\n      } else {\n        throw new ApiError(\n          \"Product not found in cart\",\n          404,\n          \"ProductNotFoundInCart\"\n        );\n      }\n\n      await cart.save();\n\n      res.status(200).json({\n        message: \"Product has been removed.\",\n        cart,\n      });\n    } catch (error) {\n      console.log(error);\n      throw new ApiError(\n        \"Could not delete product from cart\",\n        400,\n        \"DeleteProductFailed\"\n      );\n    }\n  });\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1723544825935},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/payment-success.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst ItemTransactionSchema = new Schema({\n  uuid: {\n    type: String,\n    default: (0, _uuid.default)(),\n    //hata alırsak tüm dblerdeki uuidlere bi bak\n    unique: true,\n    required: true\n  },\n  itemId: {\n    type: ObjectId,\n    required: true,\n    ref: \"Products\"\n  },\n  paymentTransactionId: {\n    type: String,\n    required: true\n  },\n  price: {\n    type: Number,\n    required: true\n  },\n  paidPrice: {\n    type: Number,\n    required: true\n  }\n});\nconst PaymentsSuccessSchema = new Schema({\n  uuid: {\n    type: String,\n    default: _uuid.default,\n    unique: true,\n    required: true\n  },\n  status: {\n    type: String,\n    required: true,\n    enum: [\"success\"]\n  },\n  cartId: {\n    type: ObjectId,\n    ref: \"Carts\",\n    required: true\n  },\n  conversationId: {\n    type: String,\n    required: true\n  },\n  currency: {\n    type: String,\n    required: true,\n    enum: [\"TRY\", \"USD\", \"EUR\"]\n  },\n  paymentId: {\n    type: String,\n    required: true,\n    unique: true\n  },\n  price: {\n    type: Number,\n    required: true\n  },\n  paidPrice: {\n    type: Number,\n    required: true\n  },\n  itemTransactions: {\n    type: [ItemTransactionSchema]\n  },\n  log: {\n    type: Schema.Types.Mixed,\n    required: true\n  }\n}, {\n  _id: true,\n  collection: \"payment-success\",\n  timestamps: true,\n  toJSON: {\n    transform: (doc, ret) => {\n      delete ret.__v;\n      return {\n        ...ret\n      };\n    }\n  }\n});\nconst PaymentsSuccess = _mongoose.default.model(\"PaymentSuccess\", PaymentsSuccessSchema);\nvar _default = exports.default = PaymentsSuccess;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9iY3J5cHRqcyIsIl91dWlkIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiU2NoZW1hIiwibW9uZ29vc2UiLCJPYmplY3RJZCIsIlR5cGVzIiwiSXRlbVRyYW5zYWN0aW9uU2NoZW1hIiwidXVpZCIsInR5cGUiLCJTdHJpbmciLCJ1bmlxdWUiLCJyZXF1aXJlZCIsIml0ZW1JZCIsInJlZiIsInBheW1lbnRUcmFuc2FjdGlvbklkIiwicHJpY2UiLCJOdW1iZXIiLCJwYWlkUHJpY2UiLCJQYXltZW50c1N1Y2Nlc3NTY2hlbWEiLCJzdGF0dXMiLCJlbnVtIiwiY2FydElkIiwiY29udmVyc2F0aW9uSWQiLCJjdXJyZW5jeSIsInBheW1lbnRJZCIsIml0ZW1UcmFuc2FjdGlvbnMiLCJsb2ciLCJNaXhlZCIsIl9pZCIsImNvbGxlY3Rpb24iLCJ0aW1lc3RhbXBzIiwidG9KU09OIiwidHJhbnNmb3JtIiwiZG9jIiwicmV0IiwiX192IiwiUGF5bWVudHNTdWNjZXNzIiwibW9kZWwiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9kYi8iLCJzb3VyY2VzIjpbInBheW1lbnQtc3VjY2Vzcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UgZnJvbSBcIm1vbmdvb3NlXCI7XG5pbXBvcnQgYmNyeXB0IGZyb20gXCJiY3J5cHRqc1wiO1xuaW1wb3J0IHV1aWQgZnJvbSBcIi4uL3V0aWxzL3V1aWRcIjtcblxuY29uc3QgU2NoZW1hID0gbW9uZ29vc2UuU2NoZW1hO1xuY29uc3QgeyBPYmplY3RJZCB9ID0gU2NoZW1hLlR5cGVzO1xuXG5jb25zdCBJdGVtVHJhbnNhY3Rpb25TY2hlbWEgPSBuZXcgU2NoZW1hKHtcbiAgdXVpZDoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICBkZWZhdWx0OiB1dWlkKCksIC8vaGF0YSBhbMSxcnNhayB0w7xtIGRibGVyZGVraSB1dWlkbGVyZSBiaSBiYWtcbiAgICB1bmlxdWU6IHRydWUsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gIH0sXG4gIGl0ZW1JZDoge1xuICAgIHR5cGU6IE9iamVjdElkLFxuICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIHJlZjogXCJQcm9kdWN0c1wiLFxuICB9LFxuICBwYXltZW50VHJhbnNhY3Rpb25JZDoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgcHJpY2U6IHtcbiAgICB0eXBlOiBOdW1iZXIsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gIH0sXG4gIHBhaWRQcmljZToge1xuICAgIHR5cGU6IE51bWJlcixcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbn0pO1xuXG5jb25zdCBQYXltZW50c1N1Y2Nlc3NTY2hlbWEgPSBuZXcgU2NoZW1hKFxuICB7XG4gICAgdXVpZDoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgZGVmYXVsdDogdXVpZCxcbiAgICAgIHVuaXF1ZTogdHJ1ZSxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgc3RhdHVzOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIGVudW06IFtcInN1Y2Nlc3NcIl0sXG4gICAgfSxcbiAgICBjYXJ0SWQ6IHtcbiAgICAgIHR5cGU6IE9iamVjdElkLFxuICAgICAgcmVmOiBcIkNhcnRzXCIsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGNvbnZlcnNhdGlvbklkOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGN1cnJlbmN5OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIGVudW06IFtcIlRSWVwiLCBcIlVTRFwiLCBcIkVVUlwiXSxcbiAgICB9LFxuICAgIHBheW1lbnRJZDoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICB1bmlxdWU6IHRydWUsXG4gICAgfSxcbiAgICBwcmljZToge1xuICAgICAgdHlwZTogTnVtYmVyLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBwYWlkUHJpY2U6IHtcbiAgICAgIHR5cGU6IE51bWJlcixcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgaXRlbVRyYW5zYWN0aW9uczoge1xuICAgICAgdHlwZTogW0l0ZW1UcmFuc2FjdGlvblNjaGVtYV0sXG4gICAgfSxcbiAgICBsb2c6IHtcbiAgICAgIHR5cGU6IFNjaGVtYS5UeXBlcy5NaXhlZCxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gIH0sXG4gIHtcbiAgICBfaWQ6IHRydWUsXG4gICAgY29sbGVjdGlvbjogXCJwYXltZW50LXN1Y2Nlc3NcIixcbiAgICB0aW1lc3RhbXBzOiB0cnVlLFxuICAgIHRvSlNPTjoge1xuICAgICAgdHJhbnNmb3JtOiAoZG9jLCByZXQpID0+IHtcbiAgICAgICAgZGVsZXRlIHJldC5fX3Y7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgLi4ucmV0LFxuICAgICAgICB9O1xuICAgICAgfSxcbiAgICB9LFxuICB9XG4pO1xuXG5jb25zdCBQYXltZW50c1N1Y2Nlc3MgPSBtb25nb29zZS5tb2RlbChcIlBheW1lbnRTdWNjZXNzXCIsIFBheW1lbnRzU3VjY2Vzc1NjaGVtYSk7XG5leHBvcnQgZGVmYXVsdCBQYXltZW50c1N1Y2Nlc3M7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFNBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLEtBQUEsR0FBQUgsc0JB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","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","_bcryptjs","_uuid","e","__esModule","default","Schema","mongoose","ObjectId","Types","ItemTransactionSchema","uuid","type","String","unique","required","itemId","ref","paymentTransactionId","price","Number","paidPrice","PaymentsSuccessSchema","status","enum","cartId","conversationId","currency","paymentId","itemTransactions","log","Mixed","_id","collection","timestamps","toJSON","transform","doc","ret","__v","PaymentsSuccess","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["payment-success.js"],"sourcesContent":["import mongoose from \"mongoose\";\nimport bcrypt from \"bcryptjs\";\nimport uuid from \"../utils/uuid\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\n\nconst ItemTransactionSchema = new Schema({\n  uuid: {\n    type: String,\n    default: uuid(), //hata alırsak tüm dblerdeki uuidlere bi bak\n    unique: true,\n    required: true,\n  },\n  itemId: {\n    type: ObjectId,\n    required: true,\n    ref: \"Products\",\n  },\n  paymentTransactionId: {\n    type: String,\n    required: true,\n  },\n  price: {\n    type: Number,\n    required: true,\n  },\n  paidPrice: {\n    type: Number,\n    required: true,\n  },\n});\n\nconst PaymentsSuccessSchema = new Schema(\n  {\n    uuid: {\n      type: String,\n      default: uuid,\n      unique: true,\n      required: true,\n    },\n    status: {\n      type: String,\n      required: true,\n      enum: [\"success\"],\n    },\n    cartId: {\n      type: ObjectId,\n      ref: \"Carts\",\n      required: true,\n    },\n    conversationId: {\n      type: String,\n      required: true,\n    },\n    currency: {\n      type: String,\n      required: true,\n      enum: [\"TRY\", \"USD\", \"EUR\"],\n    },\n    paymentId: {\n      type: String,\n      required: true,\n      unique: true,\n    },\n    price: {\n      type: Number,\n      required: true,\n    },\n    paidPrice: {\n      type: Number,\n      required: true,\n    },\n    itemTransactions: {\n      type: [ItemTransactionSchema],\n    },\n    log: {\n      type: Schema.Types.Mixed,\n      required: true,\n    },\n  },\n  {\n    _id: true,\n    collection: \"payment-success\",\n    timestamps: true,\n    toJSON: {\n      transform: (doc, ret) => {\n        delete ret.__v;\n        return {\n          ...ret,\n        };\n      },\n    },\n  }\n);\n\nconst PaymentsSuccess = mongoose.model(\"PaymentSuccess\", PaymentsSuccessSchema);\nexport default PaymentsSuccess;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,KAAA,GAAAH,sBAAA,CAAAC,OAAA;AAAiC,SAAAD,uBAAAI,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEjC,MAAMG,MAAM,GAAGC,iBAAQ,CAACD,MAAM;AAC9B,MAAM;EAAEE;AAAS,CAAC,GAAGF,MAAM,CAACG,KAAK;AAEjC,MAAMC,qBAAqB,GAAG,IAAIJ,MAAM,CAAC;EACvCK,IAAI,EAAE;IACJC,IAAI,EAAEC,MAAM;IACZR,OAAO,EAAE,IAAAM,aAAI,EAAC,CAAC;IAAE;IACjBG,MAAM,EAAE,IAAI;IACZC,QAAQ,EAAE;EACZ,CAAC;EACDC,MAAM,EAAE;IACNJ,IAAI,EAAEJ,QAAQ;IACdO,QAAQ,EAAE,IAAI;IACdE,GAAG,EAAE;EACP,CAAC;EACDC,oBAAoB,EAAE;IACpBN,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE;EACZ,CAAC;EACDI,KAAK,EAAE;IACLP,IAAI,EAAEQ,MAAM;IACZL,QAAQ,EAAE;EACZ,CAAC;EACDM,SAAS,EAAE;IACTT,IAAI,EAAEQ,MAAM;IACZL,QAAQ,EAAE;EACZ;AACF,CAAC,CAAC;AAEF,MAAMO,qBAAqB,GAAG,IAAIhB,MAAM,CACtC;EACEK,IAAI,EAAE;IACJC,IAAI,EAAEC,MAAM;IACZR,OAAO,EAAEM,aAAI;IACbG,MAAM,EAAE,IAAI;IACZC,QAAQ,EAAE;EACZ,CAAC;EACDQ,MAAM,EAAE;IACNX,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE,IAAI;IACdS,IAAI,EAAE,CAAC,SAAS;EAClB,CAAC;EACDC,MAAM,EAAE;IACNb,IAAI,EAAEJ,QAAQ;IACdS,GAAG,EAAE,OAAO;IACZF,QAAQ,EAAE;EACZ,CAAC;EACDW,cAAc,EAAE;IACdd,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE;EACZ,CAAC;EACDY,QAAQ,EAAE;IACRf,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE,IAAI;IACdS,IAAI,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK;EAC5B,CAAC;EACDI,SAAS,EAAE;IACThB,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE,IAAI;IACdD,MAAM,EAAE;EACV,CAAC;EACDK,KAAK,EAAE;IACLP,IAAI,EAAEQ,MAAM;IACZL,QAAQ,EAAE;EACZ,CAAC;EACDM,SAAS,EAAE;IACTT,IAAI,EAAEQ,MAAM;IACZL,QAAQ,EAAE;EACZ,CAAC;EACDc,gBAAgB,EAAE;IAChBjB,IAAI,EAAE,CAACF,qBAAqB;EAC9B,CAAC;EACDoB,GAAG,EAAE;IACHlB,IAAI,EAAEN,MAAM,CAACG,KAAK,CAACsB,KAAK;IACxBhB,QAAQ,EAAE;EACZ;AACF,CAAC,EACD;EACEiB,GAAG,EAAE,IAAI;EACTC,UAAU,EAAE,iBAAiB;EAC7BC,UAAU,EAAE,IAAI;EAChBC,MAAM,EAAE;IACNC,SAAS,EAAEA,CAACC,GAAG,EAAEC,GAAG,KAAK;MACvB,OAAOA,GAAG,CAACC,GAAG;MACd,OAAO;QACL,GAAGD;MACL,CAAC;IACH;EACF;AACF,CACF,CAAC;AAED,MAAME,eAAe,GAAGjC,iBAAQ,CAACkC,KAAK,CAAC,gBAAgB,EAAEnB,qBAAqB,CAAC;AAAC,IAAAoB,QAAA,GAAAC,OAAA,CAAAtC,OAAA,GACjEmC,eAAe","ignoreList":[]}},"mtime":1723544026098},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/payment-failed.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst PaymentsFailedSchema = new Schema({\n  uuid: {\n    type: String,\n    default: (0, _uuid.default)(),\n    unique: true,\n    required: true\n  },\n  status: {\n    type: String,\n    required: true,\n    enum: [\"failure\"]\n  },\n  conversationId: {\n    type: String,\n    required: true\n  },\n  errorCode: {\n    type: String,\n    required: true\n  },\n  errorMessage: {\n    type: String,\n    required: true\n  },\n  log: {\n    type: Schema.Types.Mixed,\n    required: true\n  }\n}, {\n  _id: true,\n  collection: \"payment-failed\",\n  timestamps: true,\n  toJSON: {\n    transform: (doc, ret) => {\n      delete ret.__v;\n      return {\n        ...ret\n      };\n    }\n  }\n});\nconst PaymentsFailed = _mongoose.default.model(\"PaymentsFailed\", PaymentsFailedSchema);\nvar _default = exports.default = PaymentsFailed;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9iY3J5cHRqcyIsIl91dWlkIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiU2NoZW1hIiwibW9uZ29vc2UiLCJPYmplY3RJZCIsIlR5cGVzIiwiUGF5bWVudHNGYWlsZWRTY2hlbWEiLCJ1dWlkIiwidHlwZSIsIlN0cmluZyIsInVuaXF1ZSIsInJlcXVpcmVkIiwic3RhdHVzIiwiZW51bSIsImNvbnZlcnNhdGlvbklkIiwiZXJyb3JDb2RlIiwiZXJyb3JNZXNzYWdlIiwibG9nIiwiTWl4ZWQiLCJfaWQiLCJjb2xsZWN0aW9uIiwidGltZXN0YW1wcyIsInRvSlNPTiIsInRyYW5zZm9ybSIsImRvYyIsInJldCIsIl9fdiIsIlBheW1lbnRzRmFpbGVkIiwibW9kZWwiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9kYi8iLCJzb3VyY2VzIjpbInBheW1lbnQtZmFpbGVkLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSBmcm9tIFwibW9uZ29vc2VcIjtcbmltcG9ydCBiY3J5cHQgZnJvbSBcImJjcnlwdGpzXCI7XG5pbXBvcnQgdXVpZCBmcm9tIFwiLi4vdXRpbHMvdXVpZFwiO1xuXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWE7XG5jb25zdCB7IE9iamVjdElkIH0gPSBTY2hlbWEuVHlwZXM7XG5cbmNvbnN0IFBheW1lbnRzRmFpbGVkU2NoZW1hID0gbmV3IFNjaGVtYShcbiAge1xuICAgIHV1aWQ6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIGRlZmF1bHQ6IHV1aWQoKSxcbiAgICAgIHVuaXF1ZTogdHJ1ZSxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgc3RhdHVzOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIGVudW06IFtcImZhaWx1cmVcIl0sXG4gICAgfSxcbiAgICBjb252ZXJzYXRpb25JZDoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBlcnJvckNvZGU6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgZXJyb3JNZXNzYWdlOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGxvZzoge1xuICAgICAgdHlwZTogU2NoZW1hLlR5cGVzLk1peGVkLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgfSxcbiAge1xuICAgIF9pZDogdHJ1ZSxcbiAgICBjb2xsZWN0aW9uOiBcInBheW1lbnQtZmFpbGVkXCIsXG4gICAgdGltZXN0YW1wczogdHJ1ZSxcbiAgICB0b0pTT046IHtcbiAgICAgIHRyYW5zZm9ybTogKGRvYywgcmV0KSA9PiB7XG4gICAgICAgIGRlbGV0ZSByZXQuX192O1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLnJldCxcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgfSxcbiAgfVxuKTtcblxuY29uc3QgUGF5bWVudHNGYWlsZWQgPSBtb25nb29zZS5tb2RlbChcIlBheW1lbnRzRmFpbGVkXCIsIFBheW1lbnRzRmFpbGVkU2NoZW1hKTtcbmV4cG9ydCBkZWZhdWx0IFBheW1lbnRzRmFpbGVkO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxTQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxTQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxLQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFBaUMsU0FBQUQsdUJBQUFJLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFakMsTUFBTUcsTUFBTSxHQUFHQyxpQkFBUSxDQUFDRCxNQUFNO0FBQzlCLE1BQU07RUFBRUU7QUFBUyxDQUFDLEdBQUdGLE1BQU0sQ0FBQ0csS0FBSztBQUVqQyxNQUFNQyxvQkFBb0IsR0FBRyxJQUFJSixNQUFNLENBQ3JDO0VBQ0VLLElBQUksRUFBRTtJQUNKQyxJQUFJLEVBQUVDLE1BQU07SUFDWlIsT0FBTyxFQUFFLElBQUFNLGFBQUksRUFBQyxDQUFDO0lBQ2ZHLE1BQU0sRUFBRSxJQUFJO0lBQ1pDLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDREMsTUFBTSxFQUFFO0lBQ05KLElBQUksRUFBRUMsTUFBTTtJQUNaRSxRQUFRLEVBQUUsSUFBSTtJQUNkRSxJQUFJLEVBQUUsQ0FBQyxTQUFTO0VBQ2xCLENBQUM7RUFDREMsY0FBYyxFQUFFO0lBQ2ROLElBQUksRUFBRUMsTUFBTTtJQUNaRSxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RJLFNBQVMsRUFBRTtJQUNUUCxJQUFJLEVBQUVDLE1BQU07SUFDWkUsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNESyxZQUFZLEVBQUU7SUFDWlIsSUFBSSxFQUFFQyxNQUFNO0lBQ1pFLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDRE0sR0FBRyxFQUFFO0lBQ0hULElBQUksRUFBRU4sTUFBTSxDQUFDRyxLQUFLLENBQUNhLEtBQUs7SUFDeEJQLFFBQVEsRUFBRTtFQUNaO0FBQ0YsQ0FBQyxFQUNEO0VBQ0VRLEdBQUcsRUFBRSxJQUFJO0VBQ1RDLFVBQVUsRUFBRSxnQkFBZ0I7RUFDNUJDLFVBQVUsRUFBRSxJQUFJO0VBQ2hCQyxNQUFNLEVBQUU7SUFDTkMsU0FBUyxFQUFFQSxDQUFDQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztNQUN2QixPQUFPQSxHQUFHLENBQUNDLEdBQUc7TUFDZCxPQUFPO1FBQ0wsR0FBR0Q7TUFDTCxDQUFDO0lBQ0g7RUFDRjtBQUNGLENBQ0YsQ0FBQztBQUVELE1BQU1FLGNBQWMsR0FBR3hCLGlCQUFRLENBQUN5QixLQUFLLENBQUMsZ0JBQWdCLEVBQUV0QixvQkFBb0IsQ0FBQztBQUFDLElBQUF1QixRQUFBLEdBQUFDLE9BQUEsQ0FBQTdCLE9BQUEsR0FDL0QwQixjQUFjIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","_bcryptjs","_uuid","e","__esModule","default","Schema","mongoose","ObjectId","Types","PaymentsFailedSchema","uuid","type","String","unique","required","status","enum","conversationId","errorCode","errorMessage","log","Mixed","_id","collection","timestamps","toJSON","transform","doc","ret","__v","PaymentsFailed","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["payment-failed.js"],"sourcesContent":["import mongoose from \"mongoose\";\nimport bcrypt from \"bcryptjs\";\nimport uuid from \"../utils/uuid\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\n\nconst PaymentsFailedSchema = new Schema(\n  {\n    uuid: {\n      type: String,\n      default: uuid(),\n      unique: true,\n      required: true,\n    },\n    status: {\n      type: String,\n      required: true,\n      enum: [\"failure\"],\n    },\n    conversationId: {\n      type: String,\n      required: true,\n    },\n    errorCode: {\n      type: String,\n      required: true,\n    },\n    errorMessage: {\n      type: String,\n      required: true,\n    },\n    log: {\n      type: Schema.Types.Mixed,\n      required: true,\n    },\n  },\n  {\n    _id: true,\n    collection: \"payment-failed\",\n    timestamps: true,\n    toJSON: {\n      transform: (doc, ret) => {\n        delete ret.__v;\n        return {\n          ...ret,\n        };\n      },\n    },\n  }\n);\n\nconst PaymentsFailed = mongoose.model(\"PaymentsFailed\", PaymentsFailedSchema);\nexport default PaymentsFailed;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,KAAA,GAAAH,sBAAA,CAAAC,OAAA;AAAiC,SAAAD,uBAAAI,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEjC,MAAMG,MAAM,GAAGC,iBAAQ,CAACD,MAAM;AAC9B,MAAM;EAAEE;AAAS,CAAC,GAAGF,MAAM,CAACG,KAAK;AAEjC,MAAMC,oBAAoB,GAAG,IAAIJ,MAAM,CACrC;EACEK,IAAI,EAAE;IACJC,IAAI,EAAEC,MAAM;IACZR,OAAO,EAAE,IAAAM,aAAI,EAAC,CAAC;IACfG,MAAM,EAAE,IAAI;IACZC,QAAQ,EAAE;EACZ,CAAC;EACDC,MAAM,EAAE;IACNJ,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE,IAAI;IACdE,IAAI,EAAE,CAAC,SAAS;EAClB,CAAC;EACDC,cAAc,EAAE;IACdN,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE;EACZ,CAAC;EACDI,SAAS,EAAE;IACTP,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE;EACZ,CAAC;EACDK,YAAY,EAAE;IACZR,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE;EACZ,CAAC;EACDM,GAAG,EAAE;IACHT,IAAI,EAAEN,MAAM,CAACG,KAAK,CAACa,KAAK;IACxBP,QAAQ,EAAE;EACZ;AACF,CAAC,EACD;EACEQ,GAAG,EAAE,IAAI;EACTC,UAAU,EAAE,gBAAgB;EAC5BC,UAAU,EAAE,IAAI;EAChBC,MAAM,EAAE;IACNC,SAAS,EAAEA,CAACC,GAAG,EAAEC,GAAG,KAAK;MACvB,OAAOA,GAAG,CAACC,GAAG;MACd,OAAO;QACL,GAAGD;MACL,CAAC;IACH;EACF;AACF,CACF,CAAC;AAED,MAAME,cAAc,GAAGxB,iBAAQ,CAACyB,KAAK,CAAC,gBAAgB,EAAEtB,oBAAoB,CAAC;AAAC,IAAAuB,QAAA,GAAAC,OAAA,CAAA7B,OAAA,GAC/D0B,cAAc","ignoreList":[]}},"mtime":1723544026050},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/payment-success.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst ItemTransactionSchema = new Schema({\n  uuid: {\n    type: String,\n    default: (0, _uuid.default)(),\n    //hata alırsak tüm dblerdeki uuidlere bi bak\n    unique: true,\n    required: true\n  },\n  itemId: {\n    type: ObjectId,\n    required: true,\n    ref: \"Products\"\n  },\n  paymentTransactionId: {\n    type: String,\n    required: true\n  },\n  price: {\n    type: Number,\n    required: true\n  },\n  paidPrice: {\n    type: Number,\n    required: true\n  }\n});\nconst PaymentsSuccessSchema = new Schema({\n  uuid: {\n    type: String,\n    default: _uuid.default,\n    unique: true,\n    required: true\n  },\n  status: {\n    type: String,\n    required: true,\n    enum: [\"success\"]\n  },\n  cartId: {\n    type: ObjectId,\n    ref: \"Carts\",\n    required: true\n  },\n  conversationId: {\n    type: String,\n    required: true\n  },\n  currency: {\n    type: String,\n    required: true,\n    enum: [\"TRY\", \"USD\", \"EUR\"]\n  },\n  paymentId: {\n    type: String,\n    required: true,\n    unique: true\n  },\n  price: {\n    type: Number,\n    required: true\n  },\n  paidPrice: {\n    type: Number,\n    required: true\n  },\n  itemTransactions: {\n    type: [ItemTransactionSchema]\n  },\n  log: {\n    type: Schema.Types.Mixed,\n    required: true\n  }\n}, {\n  _id: true,\n  collection: \"payment-success\",\n  timestamps: true,\n  toJSON: {\n    transform: (doc, ret) => {\n      delete ret.__v;\n      return {\n        ...ret\n      };\n    }\n  }\n});\nconst PaymentsSuccess = _mongoose.default.model(\"PaymentSuccess\", PaymentsSuccessSchema);\nvar _default = exports.default = PaymentsSuccess;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9iY3J5cHRqcyIsIl91dWlkIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiU2NoZW1hIiwibW9uZ29vc2UiLCJPYmplY3RJZCIsIlR5cGVzIiwiSXRlbVRyYW5zYWN0aW9uU2NoZW1hIiwidXVpZCIsInR5cGUiLCJTdHJpbmciLCJ1bmlxdWUiLCJyZXF1aXJlZCIsIml0ZW1JZCIsInJlZiIsInBheW1lbnRUcmFuc2FjdGlvbklkIiwicHJpY2UiLCJOdW1iZXIiLCJwYWlkUHJpY2UiLCJQYXltZW50c1N1Y2Nlc3NTY2hlbWEiLCJzdGF0dXMiLCJlbnVtIiwiY2FydElkIiwiY29udmVyc2F0aW9uSWQiLCJjdXJyZW5jeSIsInBheW1lbnRJZCIsIml0ZW1UcmFuc2FjdGlvbnMiLCJsb2ciLCJNaXhlZCIsIl9pZCIsImNvbGxlY3Rpb24iLCJ0aW1lc3RhbXBzIiwidG9KU09OIiwidHJhbnNmb3JtIiwiZG9jIiwicmV0IiwiX192IiwiUGF5bWVudHNTdWNjZXNzIiwibW9kZWwiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9kYi8iLCJzb3VyY2VzIjpbInBheW1lbnQtc3VjY2Vzcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UgZnJvbSBcIm1vbmdvb3NlXCI7XG5pbXBvcnQgYmNyeXB0IGZyb20gXCJiY3J5cHRqc1wiO1xuaW1wb3J0IHV1aWQgZnJvbSBcIi4uL3V0aWxzL3V1aWRcIjtcblxuY29uc3QgU2NoZW1hID0gbW9uZ29vc2UuU2NoZW1hO1xuY29uc3QgeyBPYmplY3RJZCB9ID0gU2NoZW1hLlR5cGVzO1xuXG5jb25zdCBJdGVtVHJhbnNhY3Rpb25TY2hlbWEgPSBuZXcgU2NoZW1hKHtcbiAgdXVpZDoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICBkZWZhdWx0OiB1dWlkKCksIC8vaGF0YSBhbMSxcnNhayB0w7xtIGRibGVyZGVraSB1dWlkbGVyZSBiaSBiYWtcbiAgICB1bmlxdWU6IHRydWUsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gIH0sXG4gIGl0ZW1JZDoge1xuICAgIHR5cGU6IE9iamVjdElkLFxuICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIHJlZjogXCJQcm9kdWN0c1wiLFxuICB9LFxuICBwYXltZW50VHJhbnNhY3Rpb25JZDoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgcHJpY2U6IHtcbiAgICB0eXBlOiBOdW1iZXIsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gIH0sXG4gIHBhaWRQcmljZToge1xuICAgIHR5cGU6IE51bWJlcixcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbn0pO1xuXG5jb25zdCBQYXltZW50c1N1Y2Nlc3NTY2hlbWEgPSBuZXcgU2NoZW1hKFxuICB7XG4gICAgdXVpZDoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgZGVmYXVsdDogdXVpZCxcbiAgICAgIHVuaXF1ZTogdHJ1ZSxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgc3RhdHVzOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIGVudW06IFtcInN1Y2Nlc3NcIl0sXG4gICAgfSxcbiAgICBjYXJ0SWQ6IHtcbiAgICAgIHR5cGU6IE9iamVjdElkLFxuICAgICAgcmVmOiBcIkNhcnRzXCIsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGNvbnZlcnNhdGlvbklkOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGN1cnJlbmN5OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIGVudW06IFtcIlRSWVwiLCBcIlVTRFwiLCBcIkVVUlwiXSxcbiAgICB9LFxuICAgIHBheW1lbnRJZDoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICB1bmlxdWU6IHRydWUsXG4gICAgfSxcbiAgICBwcmljZToge1xuICAgICAgdHlwZTogTnVtYmVyLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBwYWlkUHJpY2U6IHtcbiAgICAgIHR5cGU6IE51bWJlcixcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgaXRlbVRyYW5zYWN0aW9uczoge1xuICAgICAgdHlwZTogW0l0ZW1UcmFuc2FjdGlvblNjaGVtYV0sXG4gICAgfSxcbiAgICBsb2c6IHtcbiAgICAgIHR5cGU6IFNjaGVtYS5UeXBlcy5NaXhlZCxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gIH0sXG4gIHtcbiAgICBfaWQ6IHRydWUsXG4gICAgY29sbGVjdGlvbjogXCJwYXltZW50LXN1Y2Nlc3NcIixcbiAgICB0aW1lc3RhbXBzOiB0cnVlLFxuICAgIHRvSlNPTjoge1xuICAgICAgdHJhbnNmb3JtOiAoZG9jLCByZXQpID0+IHtcbiAgICAgICAgZGVsZXRlIHJldC5fX3Y7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgLi4ucmV0LFxuICAgICAgICB9O1xuICAgICAgfSxcbiAgICB9LFxuICB9XG4pO1xuXG5jb25zdCBQYXltZW50c1N1Y2Nlc3MgPSBtb25nb29zZS5tb2RlbChcIlBheW1lbnRTdWNjZXNzXCIsIFBheW1lbnRzU3VjY2Vzc1NjaGVtYSk7XG5leHBvcnQgZGVmYXVsdCBQYXltZW50c1N1Y2Nlc3M7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFNBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLEtBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUFpQyxTQUFBRCx1QkFBQUksQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUVqQyxNQUFNRyxNQUFNLEdBQUdDLGlCQUFRLENBQUNELE1BQU07QUFDOUIsTUFBTTtFQUFFRTtBQUFTLENBQUMsR0FBR0YsTUFBTSxDQUFDRyxLQUFLO0FBRWpDLE1BQU1DLHFCQUFxQixHQUFHLElBQUlKLE1BQU0sQ0FBQztFQUN2Q0ssSUFBSSxFQUFFO0lBQ0pDLElBQUksRUFBRUMsTUFBTTtJQUNaUixPQUFPLEVBQUUsSUFBQU0sYUFBSSxFQUFDLENBQUM7SUFBRTtJQUNqQkcsTUFBTSxFQUFFLElBQUk7SUFDWkMsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNEQyxNQUFNLEVBQUU7SUFDTkosSUFBSSxFQUFFSixRQUFRO0lBQ2RPLFFBQVEsRUFBRSxJQUFJO0lBQ2RFLEdBQUcsRUFBRTtFQUNQLENBQUM7RUFDREMsb0JBQW9CLEVBQUU7SUFDcEJOLElBQUksRUFBRUMsTUFBTTtJQUNaRSxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RJLEtBQUssRUFBRTtJQUNMUCxJQUFJLEVBQUVRLE1BQU07SUFDWkwsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNETSxTQUFTLEVBQUU7SUFDVFQsSUFBSSxFQUFFUSxNQUFNO0lBQ1pMLFFBQVEsRUFBRTtFQUNaO0FBQ0YsQ0FBQyxDQUFDO0FBRUYsTUFBTU8scUJBQXFCLEdBQUcsSUFBSWhCLE1BQU0sQ0FDdEM7RUFDRUssSUFBSSxFQUFFO0lBQ0pDLElBQUksRUFBRUMsTUFBTTtJQUNaUixPQUFPLEVBQUVNLGFBQUk7SUFDYkcsTUFBTSxFQUFFLElBQUk7SUFDWkMsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNEUSxNQUFNLEVBQUU7SUFDTlgsSUFBSSxFQUFFQyxNQUFNO0lBQ1pFLFFBQVEsRUFBRSxJQUFJO0lBQ2RTLElBQUksRUFBRSxDQUFDLFNBQVM7RUFDbEIsQ0FBQztFQUNEQyxNQUFNLEVBQUU7SUFDTmIsSUFBSSxFQUFFSixRQUFRO0lBQ2RTLEdBQUcsRUFBRSxPQUFPO0lBQ1pGLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDRFcsY0FBYyxFQUFFO0lBQ2RkLElBQUksRUFBRUMsTUFBTTtJQUNaRSxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RZLFFBQVEsRUFBRTtJQUNSZixJQUFJLEVBQUVDLE1BQU07SUFDWkUsUUFBUSxFQUFFLElBQUk7SUFDZFMsSUFBSSxFQUFFLENBQUMsS0FBSyxFQUFFLEtBQUssRUFBRSxLQUFLO0VBQzVCLENBQUM7RUFDREksU0FBUyxFQUFFO0lBQ1RoQixJQUFJLEVBQUVDLE1BQU07SUFDWkUsUUFBUSxFQUFFLElBQUk7SUFDZEQsTUFBTSxFQUFFO0VBQ1YsQ0FBQztFQUNESyxLQUFLLEVBQUU7SUFDTFAsSUFBSSxFQUFFUSxNQUFNO0lBQ1pMLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDRE0sU0FBUyxFQUFFO0lBQ1RULElBQUksRUFBRVEsTUFBTTtJQUNaTCxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RjLGdCQUFnQixFQUFFO0lBQ2hCakIsSUFBSSxFQUFFLENBQUNGLHFCQUFxQjtFQUM5QixDQUFDO0VBQ0RvQixHQUFHLEVBQUU7SUFDSGxCLElBQUksRUFBRU4sTUFBTSxDQUFDRyxLQUFLLENBQUNzQixLQUFLO0lBQ3hCaEIsUUFBUSxFQUFFO0VBQ1o7QUFDRixDQUFDLEVBQ0Q7RUFDRWlCLEdBQUcsRUFBRSxJQUFJO0VBQ1RDLFVBQVUsRUFBRSxpQkFBaUI7RUFDN0JDLFVBQVUsRUFBRSxJQUFJO0VBQ2hCQyxNQUFNLEVBQUU7SUFDTkMsU0FBUyxFQUFFQSxDQUFDQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztNQUN2QixPQUFPQSxHQUFHLENBQUNDLEdBQUc7TUFDZCxPQUFPO1FBQ0wsR0FBR0Q7TUFDTCxDQUFDO0lBQ0g7RUFDRjtBQUNGLENBQ0YsQ0FBQztBQUVELE1BQU1FLGVBQWUsR0FBR2pDLGlCQUFRLENBQUNrQyxLQUFLLENBQUMsZ0JBQWdCLEVBQUVuQixxQkFBcUIsQ0FBQztBQUFDLElBQUFvQixRQUFBLEdBQUFDLE9BQUEsQ0FBQXRDLE9BQUEsR0FDakVtQyxlQUFlIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","_bcryptjs","_uuid","e","__esModule","default","Schema","mongoose","ObjectId","Types","ItemTransactionSchema","uuid","type","String","unique","required","itemId","ref","paymentTransactionId","price","Number","paidPrice","PaymentsSuccessSchema","status","enum","cartId","conversationId","currency","paymentId","itemTransactions","log","Mixed","_id","collection","timestamps","toJSON","transform","doc","ret","__v","PaymentsSuccess","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["payment-success.js"],"sourcesContent":["import mongoose from \"mongoose\";\nimport bcrypt from \"bcryptjs\";\nimport uuid from \"../utils/uuid\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\n\nconst ItemTransactionSchema = new Schema({\n  uuid: {\n    type: String,\n    default: uuid(), //hata alırsak tüm dblerdeki uuidlere bi bak\n    unique: true,\n    required: true,\n  },\n  itemId: {\n    type: ObjectId,\n    required: true,\n    ref: \"Products\",\n  },\n  paymentTransactionId: {\n    type: String,\n    required: true,\n  },\n  price: {\n    type: Number,\n    required: true,\n  },\n  paidPrice: {\n    type: Number,\n    required: true,\n  },\n});\n\nconst PaymentsSuccessSchema = new Schema(\n  {\n    uuid: {\n      type: String,\n      default: uuid,\n      unique: true,\n      required: true,\n    },\n    status: {\n      type: String,\n      required: true,\n      enum: [\"success\"],\n    },\n    cartId: {\n      type: ObjectId,\n      ref: \"Carts\",\n      required: true,\n    },\n    conversationId: {\n      type: String,\n      required: true,\n    },\n    currency: {\n      type: String,\n      required: true,\n      enum: [\"TRY\", \"USD\", \"EUR\"],\n    },\n    paymentId: {\n      type: String,\n      required: true,\n      unique: true,\n    },\n    price: {\n      type: Number,\n      required: true,\n    },\n    paidPrice: {\n      type: Number,\n      required: true,\n    },\n    itemTransactions: {\n      type: [ItemTransactionSchema],\n    },\n    log: {\n      type: Schema.Types.Mixed,\n      required: true,\n    },\n  },\n  {\n    _id: true,\n    collection: \"payment-success\",\n    timestamps: true,\n    toJSON: {\n      transform: (doc, ret) => {\n        delete ret.__v;\n        return {\n          ...ret,\n        };\n      },\n    },\n  }\n);\n\nconst PaymentsSuccess = mongoose.model(\"PaymentSuccess\", PaymentsSuccessSchema);\nexport default PaymentsSuccess;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,KAAA,GAAAH,sBAAA,CAAAC,OAAA;AAAiC,SAAAD,uBAAAI,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEjC,MAAMG,MAAM,GAAGC,iBAAQ,CAACD,MAAM;AAC9B,MAAM;EAAEE;AAAS,CAAC,GAAGF,MAAM,CAACG,KAAK;AAEjC,MAAMC,qBAAqB,GAAG,IAAIJ,MAAM,CAAC;EACvCK,IAAI,EAAE;IACJC,IAAI,EAAEC,MAAM;IACZR,OAAO,EAAE,IAAAM,aAAI,EAAC,CAAC;IAAE;IACjBG,MAAM,EAAE,IAAI;IACZC,QAAQ,EAAE;EACZ,CAAC;EACDC,MAAM,EAAE;IACNJ,IAAI,EAAEJ,QAAQ;IACdO,QAAQ,EAAE,IAAI;IACdE,GAAG,EAAE;EACP,CAAC;EACDC,oBAAoB,EAAE;IACpBN,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE;EACZ,CAAC;EACDI,KAAK,EAAE;IACLP,IAAI,EAAEQ,MAAM;IACZL,QAAQ,EAAE;EACZ,CAAC;EACDM,SAAS,EAAE;IACTT,IAAI,EAAEQ,MAAM;IACZL,QAAQ,EAAE;EACZ;AACF,CAAC,CAAC;AAEF,MAAMO,qBAAqB,GAAG,IAAIhB,MAAM,CACtC;EACEK,IAAI,EAAE;IACJC,IAAI,EAAEC,MAAM;IACZR,OAAO,EAAEM,aAAI;IACbG,MAAM,EAAE,IAAI;IACZC,QAAQ,EAAE;EACZ,CAAC;EACDQ,MAAM,EAAE;IACNX,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE,IAAI;IACdS,IAAI,EAAE,CAAC,SAAS;EAClB,CAAC;EACDC,MAAM,EAAE;IACNb,IAAI,EAAEJ,QAAQ;IACdS,GAAG,EAAE,OAAO;IACZF,QAAQ,EAAE;EACZ,CAAC;EACDW,cAAc,EAAE;IACdd,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE;EACZ,CAAC;EACDY,QAAQ,EAAE;IACRf,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE,IAAI;IACdS,IAAI,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK;EAC5B,CAAC;EACDI,SAAS,EAAE;IACThB,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE,IAAI;IACdD,MAAM,EAAE;EACV,CAAC;EACDK,KAAK,EAAE;IACLP,IAAI,EAAEQ,MAAM;IACZL,QAAQ,EAAE;EACZ,CAAC;EACDM,SAAS,EAAE;IACTT,IAAI,EAAEQ,MAAM;IACZL,QAAQ,EAAE;EACZ,CAAC;EACDc,gBAAgB,EAAE;IAChBjB,IAAI,EAAE,CAACF,qBAAqB;EAC9B,CAAC;EACDoB,GAAG,EAAE;IACHlB,IAAI,EAAEN,MAAM,CAACG,KAAK,CAACsB,KAAK;IACxBhB,QAAQ,EAAE;EACZ;AACF,CAAC,EACD;EACEiB,GAAG,EAAE,IAAI;EACTC,UAAU,EAAE,iBAAiB;EAC7BC,UAAU,EAAE,IAAI;EAChBC,MAAM,EAAE;IACNC,SAAS,EAAEA,CAACC,GAAG,EAAEC,GAAG,KAAK;MACvB,OAAOA,GAAG,CAACC,GAAG;MACd,OAAO;QACL,GAAGD;MACL,CAAC;IACH;EACF;AACF,CACF,CAAC;AAED,MAAME,eAAe,GAAGjC,iBAAQ,CAACkC,KAAK,CAAC,gBAAgB,EAAEnB,qBAAqB,CAAC;AAAC,IAAAoB,QAAA,GAAAC,OAAA,CAAAtC,OAAA,GACjEmC,eAAe","ignoreList":[]}},"mtime":1723544026098},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/payment-failed.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst PaymentsFailedSchema = new Schema({\n  uuid: {\n    type: String,\n    default: (0, _uuid.default)(),\n    unique: true,\n    required: true\n  },\n  status: {\n    type: String,\n    required: true,\n    enum: [\"failure\"]\n  },\n  conversationId: {\n    type: String,\n    required: true\n  },\n  errorCode: {\n    type: String,\n    required: true\n  },\n  errorMessage: {\n    type: String,\n    required: true\n  },\n  log: {\n    type: Schema.Types.Mixed,\n    required: true\n  }\n}, {\n  _id: true,\n  collection: \"payment-failed\",\n  timestamps: true,\n  toJSON: {\n    transform: (doc, ret) => {\n      delete ret.__v;\n      return {\n        ...ret\n      };\n    }\n  }\n});\nconst PaymentsFailed = _mongoose.default.model(\"PaymentsFailed\", PaymentsFailedSchema);\nvar _default = exports.default = PaymentsFailed;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9iY3J5cHRqcyIsIl91dWlkIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiU2NoZW1hIiwibW9uZ29vc2UiLCJPYmplY3RJZCIsIlR5cGVzIiwiUGF5bWVudHNGYWlsZWRTY2hlbWEiLCJ1dWlkIiwidHlwZSIsIlN0cmluZyIsInVuaXF1ZSIsInJlcXVpcmVkIiwic3RhdHVzIiwiZW51bSIsImNvbnZlcnNhdGlvbklkIiwiZXJyb3JDb2RlIiwiZXJyb3JNZXNzYWdlIiwibG9nIiwiTWl4ZWQiLCJfaWQiLCJjb2xsZWN0aW9uIiwidGltZXN0YW1wcyIsInRvSlNPTiIsInRyYW5zZm9ybSIsImRvYyIsInJldCIsIl9fdiIsIlBheW1lbnRzRmFpbGVkIiwibW9kZWwiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9kYi8iLCJzb3VyY2VzIjpbInBheW1lbnQtZmFpbGVkLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSBmcm9tIFwibW9uZ29vc2VcIjtcbmltcG9ydCBiY3J5cHQgZnJvbSBcImJjcnlwdGpzXCI7XG5pbXBvcnQgdXVpZCBmcm9tIFwiLi4vdXRpbHMvdXVpZFwiO1xuXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWE7XG5jb25zdCB7IE9iamVjdElkIH0gPSBTY2hlbWEuVHlwZXM7XG5cbmNvbnN0IFBheW1lbnRzRmFpbGVkU2NoZW1hID0gbmV3IFNjaGVtYShcbiAge1xuICAgIHV1aWQ6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIGRlZmF1bHQ6IHV1aWQoKSxcbiAgICAgIHVuaXF1ZTogdHJ1ZSxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgc3RhdHVzOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIGVudW06IFtcImZhaWx1cmVcIl0sXG4gICAgfSxcbiAgICBjb252ZXJzYXRpb25JZDoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBlcnJvckNvZGU6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgZXJyb3JNZXNzYWdlOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGxvZzoge1xuICAgICAgdHlwZTogU2NoZW1hLlR5cGVzLk1peGVkLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgfSxcbiAge1xuICAgIF9pZDogdHJ1ZSxcbiAgICBjb2xsZWN0aW9uOiBcInBheW1lbnQtZmFpbGVkXCIsXG4gICAgdGltZXN0YW1wczogdHJ1ZSxcbiAgICB0b0pTT046IHtcbiAgICAgIHRyYW5zZm9ybTogKGRvYywgcmV0KSA9PiB7XG4gICAgICAgIGRlbGV0ZSByZXQuX192O1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLnJldCxcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgfSxcbiAgfVxuKTtcblxuY29uc3QgUGF5bWVudHNGYWlsZWQgPSBtb25nb29zZS5tb2RlbChcIlBheW1lbnRzRmFpbGVkXCIsIFBheW1lbnRzRmFpbGVkU2NoZW1hKTtcbmV4cG9ydCBkZWZhdWx0IFBheW1lbnRzRmFpbGVkO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxTQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxTQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxLQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFBaUMsU0FBQUQsdUJBQUFJLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFakMsTUFBTUcsTUFBTSxHQUFHQyxpQkFBUSxDQUFDRCxNQUFNO0FBQzlCLE1BQU07RUFBRUU7QUFBUyxDQUFDLEdBQUdGLE1BQU0sQ0FBQ0csS0FBSztBQUVqQyxNQUFNQyxvQkFBb0IsR0FBRyxJQUFJSixNQUFNLENBQ3JDO0VBQ0VLLElBQUksRUFBRTtJQUNKQyxJQUFJLEVBQUVDLE1BQU07SUFDWlIsT0FBTyxFQUFFLElBQUFNLGFBQUksRUFBQyxDQUFDO0lBQ2ZHLE1BQU0sRUFBRSxJQUFJO0lBQ1pDLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDREMsTUFBTSxFQUFFO0lBQ05KLElBQUksRUFBRUMsTUFBTTtJQUNaRSxRQUFRLEVBQUUsSUFBSTtJQUNkRSxJQUFJLEVBQUUsQ0FBQyxTQUFTO0VBQ2xCLENBQUM7RUFDREMsY0FBYyxFQUFFO0lBQ2ROLElBQUksRUFBRUMsTUFBTTtJQUNaRSxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RJLFNBQVMsRUFBRTtJQUNUUCxJQUFJLEVBQUVDLE1BQU07SUFDWkUsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNESyxZQUFZLEVBQUU7SUFDWlIsSUFBSSxFQUFFQyxNQUFNO0lBQ1pFLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDRE0sR0FBRyxFQUFFO0lBQ0hULElBQUksRUFBRU4sTUFBTSxDQUFDRyxLQUFLLENBQUNhLEtBQUs7SUFDeEJQLFFBQVEsRUFBRTtFQUNaO0FBQ0YsQ0FBQyxFQUNEO0VBQ0VRLEdBQUcsRUFBRSxJQUFJO0VBQ1RDLFVBQVUsRUFBRSxnQkFBZ0I7RUFDNUJDLFVBQVUsRUFBRSxJQUFJO0VBQ2hCQyxNQUFNLEVBQUU7SUFDTkMsU0FBUyxFQUFFQSxDQUFDQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztNQUN2QixPQUFPQSxHQUFHLENBQUNDLEdBQUc7TUFDZCxPQUFPO1FBQ0wsR0FBR0Q7TUFDTCxDQUFDO0lBQ0g7RUFDRjtBQUNGLENBQ0YsQ0FBQztBQUVELE1BQU1FLGNBQWMsR0FBR3hCLGlCQUFRLENBQUN5QixLQUFLLENBQUMsZ0JBQWdCLEVBQUV0QixvQkFBb0IsQ0FBQztBQUFDLElBQUF1QixRQUFBLEdBQUFDLE9BQUEsQ0FBQTdCLE9BQUEsR0FDL0QwQixjQUFjIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","_bcryptjs","_uuid","e","__esModule","default","Schema","mongoose","ObjectId","Types","PaymentsFailedSchema","uuid","type","String","unique","required","status","enum","conversationId","errorCode","errorMessage","log","Mixed","_id","collection","timestamps","toJSON","transform","doc","ret","__v","PaymentsFailed","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["payment-failed.js"],"sourcesContent":["import mongoose from \"mongoose\";\nimport bcrypt from \"bcryptjs\";\nimport uuid from \"../utils/uuid\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\n\nconst PaymentsFailedSchema = new Schema(\n  {\n    uuid: {\n      type: String,\n      default: uuid(),\n      unique: true,\n      required: true,\n    },\n    status: {\n      type: String,\n      required: true,\n      enum: [\"failure\"],\n    },\n    conversationId: {\n      type: String,\n      required: true,\n    },\n    errorCode: {\n      type: String,\n      required: true,\n    },\n    errorMessage: {\n      type: String,\n      required: true,\n    },\n    log: {\n      type: Schema.Types.Mixed,\n      required: true,\n    },\n  },\n  {\n    _id: true,\n    collection: \"payment-failed\",\n    timestamps: true,\n    toJSON: {\n      transform: (doc, ret) => {\n        delete ret.__v;\n        return {\n          ...ret,\n        };\n      },\n    },\n  }\n);\n\nconst PaymentsFailed = mongoose.model(\"PaymentsFailed\", PaymentsFailedSchema);\nexport default PaymentsFailed;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,KAAA,GAAAH,sBAAA,CAAAC,OAAA;AAAiC,SAAAD,uBAAAI,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEjC,MAAMG,MAAM,GAAGC,iBAAQ,CAACD,MAAM;AAC9B,MAAM;EAAEE;AAAS,CAAC,GAAGF,MAAM,CAACG,KAAK;AAEjC,MAAMC,oBAAoB,GAAG,IAAIJ,MAAM,CACrC;EACEK,IAAI,EAAE;IACJC,IAAI,EAAEC,MAAM;IACZR,OAAO,EAAE,IAAAM,aAAI,EAAC,CAAC;IACfG,MAAM,EAAE,IAAI;IACZC,QAAQ,EAAE;EACZ,CAAC;EACDC,MAAM,EAAE;IACNJ,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE,IAAI;IACdE,IAAI,EAAE,CAAC,SAAS;EAClB,CAAC;EACDC,cAAc,EAAE;IACdN,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE;EACZ,CAAC;EACDI,SAAS,EAAE;IACTP,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE;EACZ,CAAC;EACDK,YAAY,EAAE;IACZR,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE;EACZ,CAAC;EACDM,GAAG,EAAE;IACHT,IAAI,EAAEN,MAAM,CAACG,KAAK,CAACa,KAAK;IACxBP,QAAQ,EAAE;EACZ;AACF,CAAC,EACD;EACEQ,GAAG,EAAE,IAAI;EACTC,UAAU,EAAE,gBAAgB;EAC5BC,UAAU,EAAE,IAAI;EAChBC,MAAM,EAAE;IACNC,SAAS,EAAEA,CAACC,GAAG,EAAEC,GAAG,KAAK;MACvB,OAAOA,GAAG,CAACC,GAAG;MACd,OAAO;QACL,GAAGD;MACL,CAAC;IACH;EACF;AACF,CACF,CAAC;AAED,MAAME,cAAc,GAAGxB,iBAAQ,CAACyB,KAAK,CAAC,gBAAgB,EAAEtB,oBAAoB,CAAC;AAAC,IAAAuB,QAAA,GAAAC,OAAA,CAAA7B,OAAA,GAC/D0B,cAAc","ignoreList":[]}},"mtime":1723544026050},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/payments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _moment = _interopRequireDefault(require(\"moment\"));\nvar _iyzipay = _interopRequireDefault(require(\"iyzipay\"));\nvar _cart = _interopRequireDefault(require(\"../db/cart\"));\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nvar Payments = _interopRequireWildcard(require(\"../services/iyzico/methods/payments\"));\nvar Cards = _interopRequireWildcard(require(\"../services/iyzico/methods/cards\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nvar _payments2 = require(\"../utils/payments\");\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function (e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = router => {\n  //yeni bir kartla ödeme oluştur ve kartı kaydetme\n  router.post(\"/payments/:cartId/with-new-card\", _Session.default, async (req, res) => {\n    const {\n      card\n    } = req.body;\n    if (!card) {\n      throw new _ApiError.default(\"Card is required\", 400, \"cardRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _cart.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    card.registerCard = \"0\"; //methodslarda registerCard:1 yani kartı kaydet demek ama şuan kaydetme dediğim için 0 yaptım\n\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    let result = await Payments.createPayment(data);\n    await (0, _payments2.CompletePayment)(result);\n    res.json(result);\n  });\n\n  //yeni bir ödeme oluştur ve kart kaydet\n  router.post(\"/payments/:cartId/with-new-card/register-card\", _Session.default, async (req, res) => {\n    const {\n      card\n    } = req.body;\n    if (!card) {\n      throw new _ApiError.default(\"Card is required\", 400, \"cardRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _cart.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    if (req.user?.cardUserKey) {\n      card.cardUserKey = req.user?.cardUserKey;\n    }\n    card.registerCard = \"1\"; //methodslarda registerCard:1 yani kartı kaydet\n\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    let result = await Payments.createPayment(data);\n    if (req.user?.cardUserKey) {\n      const user = await _users.default.findOne({\n        _id: req.user?._id\n      });\n      user.cardUserKey = result?.cardUserKey;\n      await user.save();\n    }\n    await (0, _payments2.CompletePayment)(result);\n    res.json(result);\n  });\n\n  //hali hazırda bulunan kart ile ödeme\n  router.post(\"/payments/:cartId/:cardIndex/with-registered-card-index\", _Session.default, async (req, res) => {\n    let {\n      cardIndex\n    } = req.params;\n    if (!cardIndex) {\n      throw new _ApiError.default(\"Card index is required\", 400, \"cardIndexRequired\");\n    }\n    if (!req.user?.cardUserKey) {\n      throw new _ApiError.default(\"No registered card available\", 400, \"cardUserKeyRequired\");\n    }\n    const cards = await Cards.getUserCards({\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      cardUserKey: req.user?.cardUserKey\n    });\n    const index = parseInt(cardIndex);\n    if (index >= cards?.cardDetails?.length) {\n      throw new _ApiError.default(\"Card does not exist\", 400, \"cardIndexInvalid\");\n    }\n    const {\n      cardToken\n    } = cards?.cardDetails[index];\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _cart.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const card = {\n      cardToken,\n      cardUserKey: req.user?.cardUserKey\n    };\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    let result = await Payments.createPayment(data);\n    await (0, _payments2.CompletePayment)(result);\n    res.json(result);\n  });\n  router.post(\"/payments/:cartId/with-registered-card-token\", _Session.default, async (req, res) => {\n    let {\n      cardToken\n    } = req.body;\n    if (!cardToken) {\n      throw new _ApiError.default(\"Card Token is required\", 400, \"cardTokenRequired\");\n    }\n    if (!req.user?.cardUserKey) {\n      throw new _ApiError.default(\"No registered card available\", 400, \"cardUserKeyRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _cart.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const card = {\n      cardToken,\n      cardUserKey: req.user?.cardUserKey\n    };\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    let result = await Payments.createPayment(data);\n    await (0, _payments2.CompletePayment)(result);\n    res.json(result);\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9tZW50IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfaXl6aXBheSIsIl9jYXJ0IiwiX3VzZXJzIiwiX0FwaUVycm9yIiwiX1Nlc3Npb24iLCJQYXltZW50cyIsIl9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkIiwiQ2FyZHMiLCJfdXVpZCIsIl9wYXltZW50czIiLCJfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUiLCJlIiwiV2Vha01hcCIsInIiLCJ0IiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJoYXMiLCJnZXQiLCJuIiwiX19wcm90b19fIiwiYSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwidSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImkiLCJzZXQiLCJfZGVmYXVsdCIsInJvdXRlciIsInBvc3QiLCJTZXNzaW9uIiwicmVxIiwicmVzIiwiY2FyZCIsImJvZHkiLCJBcGlFcnJvciIsInBhcmFtcyIsImNhcnRJZCIsImNhcnQiLCJDYXJ0cyIsImZpbmRPbmUiLCJfaWQiLCJwb3B1bGF0ZSIsImNvbXBsZXRlZCIsInJlZ2lzdGVyQ2FyZCIsInBhaWRQcmljZSIsInByb2R1Y3RzIiwibWFwIiwicHJvZHVjdCIsInByaWNlIiwicmVkdWNlIiwiYiIsImRhdGEiLCJsb2NhbGUiLCJ1c2VyIiwiY29udmVyc2F0aW9uSWQiLCJpZCIsImN1cnJlbmN5IiwiSXl6aXBheSIsIkNVUlJFTkNZIiwiVFJZIiwiaW5zdGFsbG1lbnRzIiwiYmFza2V0SWQiLCJTdHJpbmciLCJwYXltZW50Q2hhbm5lbCIsIlBBWU1FTlRfQ0hBTk5FTCIsIldFQiIsInBheW1lbnRHcm91cCIsIlBBWU1FTlRfR1JPVVAiLCJQUk9EVUNUIiwicGF5bWVudENhcmQiLCJidXllciIsIm5hbWUiLCJzdXJuYW1lIiwiZ3NtTnVtYmVyIiwicGhvbmVOdW1iZXIiLCJlbWFpbCIsImlkZW50aXR5TnVtYmVyIiwibGFzdExvZ2luRGF0ZSIsIm1vbWVudCIsInVwZGF0ZWRBdCIsImZvcm1hdCIsInJlZ2lzdHJhdGlvbkRhdGUiLCJyZWdpc3RyYXRpb25BZGRyZXNzIiwiYWRkcmVzcyIsImlwIiwiY2l0eSIsImNvdW50cnkiLCJ6aXBDb2RlIiwic2hpcHBpbmdBZGRyZXNzIiwiY29udGFjdE5hbWUiLCJiaWxsaW5nQWRkcmVzcyIsImJhc2tldEl0ZW1zIiwiaW5kZXgiLCJjYXRlZ29yeTEiLCJjYXRlZ29yaWVzIiwiY2F0ZWdvcnkyIiwiaXRlbVR5cGUiLCJCQVNLRVRfSVRFTV9UWVBFIiwicmVzdWx0IiwiY3JlYXRlUGF5bWVudCIsIkNvbXBsZXRlUGF5bWVudCIsImpzb24iLCJjYXJkVXNlcktleSIsIlVzZXJzIiwic2F2ZSIsImNhcmRJbmRleCIsImNhcmRzIiwiZ2V0VXNlckNhcmRzIiwicGFyc2VJbnQiLCJjYXJkRGV0YWlscyIsImxlbmd0aCIsImNhcmRUb2tlbiIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9yb3V0ZXMvIiwic291cmNlcyI6WyJwYXltZW50cy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9tZW50IGZyb20gXCJtb21lbnRcIjtcbmltcG9ydCBJeXppcGF5IGZyb20gXCJpeXppcGF5XCI7XG5pbXBvcnQgQ2FydHMgZnJvbSBcIi4uL2RiL2NhcnRcIjtcbmltcG9ydCBVc2VycyBmcm9tIFwiLi4vZGIvdXNlcnNcIjtcbmltcG9ydCBBcGlFcnJvciBmcm9tIFwiLi4vZXJyb3JzL0FwaUVycm9yXCI7XG5pbXBvcnQgU2Vzc2lvbiBmcm9tIFwiLi4vbWlkZGxld2FyZXMvU2Vzc2lvblwiO1xuaW1wb3J0ICogYXMgUGF5bWVudHMgZnJvbSBcIi4uL3NlcnZpY2VzL2l5emljby9tZXRob2RzL3BheW1lbnRzXCI7XG5pbXBvcnQgKiBhcyBDYXJkcyBmcm9tIFwiLi4vc2VydmljZXMvaXl6aWNvL21ldGhvZHMvY2FyZHNcIjtcbmltcG9ydCBpZCBmcm9tIFwiLi4vdXRpbHMvdXVpZFwiO1xuaW1wb3J0IHsgQ29tcGxldGVQYXltZW50IH0gZnJvbSBcIi4uL3V0aWxzL3BheW1lbnRzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IChyb3V0ZXIpID0+IHtcbiAgLy95ZW5pIGJpciBrYXJ0bGEgw7ZkZW1lIG9sdcWfdHVyIHZlIGthcnTEsSBrYXlkZXRtZVxuICByb3V0ZXIucG9zdChcIi9wYXltZW50cy86Y2FydElkL3dpdGgtbmV3LWNhcmRcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyBjYXJkIH0gPSByZXEuYm9keTtcbiAgICBpZiAoIWNhcmQpIHtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgaXMgcmVxdWlyZWRcIiwgNDAwLCBcImNhcmRSZXF1aXJlZFwiKTtcbiAgICB9XG4gICAgaWYgKCFyZXEucGFyYW1zPy5jYXJ0SWQpIHtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnRJRCBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FydElkUmVxdWlyZWRcIik7XG4gICAgfVxuICAgIGNvbnN0IGNhcnQgPSBhd2FpdCBDYXJ0cy5maW5kT25lKHsgX2lkOiByZXEucGFyYW1zPy5jYXJ0SWQgfSlcbiAgICAgIC5wb3B1bGF0ZShcImJ1eWVyXCIpXG4gICAgICAucG9wdWxhdGUoXCJwcm9kdWN0c1wiKTtcbiAgICBpZiAoIWNhcnQpIHtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgbm90IGZvdW5kXCIsIDQwNCwgXCJjYXJkTm90Rm91bmRcIik7XG4gICAgfVxuICAgIGlmIChjYXJ0Py5jb21wbGV0ZWQpIHtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgaXMgY29tcGxldGVkXCIsIDQwMCwgXCJjYXJ0Q29tcGxldGVkXCIpO1xuICAgIH1cblxuICAgIGNhcmQucmVnaXN0ZXJDYXJkID0gXCIwXCI7IC8vbWV0aG9kc2xhcmRhIHJlZ2lzdGVyQ2FyZDoxIHlhbmkga2FydMSxIGtheWRldCBkZW1layBhbWEgxZ91YW4ga2F5ZGV0bWUgZGVkacSfaW0gacOnaW4gMCB5YXB0xLFtXG5cbiAgICBjb25zdCBwYWlkUHJpY2UgPSBjYXJ0LnByb2R1Y3RzXG4gICAgICAubWFwKChwcm9kdWN0KSA9PiBwcm9kdWN0LnByaWNlKVxuICAgICAgLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApOyAvL8O2ZGVuZWNlayBtaWt0YXJsYXLEsW4gdG9wbGFtxLFcblxuICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICBsb2NhbGU6IHJlcS51c2VyLmxvY2FsZSxcbiAgICAgIGNvbnZlcnNhdGlvbklkOiBpZCgpLFxuICAgICAgcHJpY2U6IHBhaWRQcmljZSxcbiAgICAgIHBhaWRQcmljZTogcGFpZFByaWNlLFxuICAgICAgY3VycmVuY3k6IEl5emlwYXkuQ1VSUkVOQ1kuVFJZLFxuICAgICAgaW5zdGFsbG1lbnRzOiBcIjFcIixcbiAgICAgIGJhc2tldElkOiBTdHJpbmcoY2FydD8uX2lkKSxcbiAgICAgIHBheW1lbnRDaGFubmVsOiBJeXppcGF5LlBBWU1FTlRfQ0hBTk5FTC5XRUIsXG4gICAgICBwYXltZW50R3JvdXA6IEl5emlwYXkuUEFZTUVOVF9HUk9VUC5QUk9EVUNULFxuICAgICAgcGF5bWVudENhcmQ6IGNhcmQsXG4gICAgICBidXllcjoge1xuICAgICAgICBpZDogU3RyaW5nKHJlcS51c2VyLl9pZCksXG4gICAgICAgIG5hbWU6IHJlcS51c2VyPy5uYW1lLFxuICAgICAgICBzdXJuYW1lOiByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgZ3NtTnVtYmVyOiByZXEudXNlcj8ucGhvbmVOdW1iZXIsXG4gICAgICAgIGVtYWlsOiByZXEudXNlcj8uZW1haWwsXG4gICAgICAgIGlkZW50aXR5TnVtYmVyOiByZXEudXNlcj8uaWRlbnRpdHlOdW1iZXIsXG4gICAgICAgIGxhc3RMb2dpbkRhdGU6IG1vbWVudChyZXEudXNlcj8udXBkYXRlZEF0KS5mb3JtYXQoXG4gICAgICAgICAgXCJZWVlZLU1NLUREIEhIOm1tOnNzXCJcbiAgICAgICAgKSwgLy9peWl6cGF5IHRhcmloIGZvcm1hdMSxbmEgw6dldmlybWVrIGnDp2luIHlhcMSxbGTEsVxuICAgICAgICByZWdpc3RyYXRpb25EYXRlOiBtb21lbnQocmVxLnVzZXI/LnVwZGF0ZWRBdCkuZm9ybWF0KFxuICAgICAgICAgIFwiWVlZWS1NTS1ERCBISDptbTpzc1wiXG4gICAgICAgICksXG4gICAgICAgIHJlZ2lzdHJhdGlvbkFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICBpcDogcmVxLnVzZXI/LmlwLFxuICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgfSxcbiAgICAgIHNoaXBwaW5nQWRkcmVzczoge1xuICAgICAgICBjb250YWN0TmFtZTogcmVxLnVzZXI/Lm5hbWUgKyBcIlwiICsgcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgYWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgfSxcbiAgICAgIGJpbGxpbmdBZGRyZXNzOiB7XG4gICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiXCIgKyByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICBhZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICB9LFxuICAgICAgYmFza2V0SXRlbXM6IGNhcnQucHJvZHVjdHMubWFwKChwcm9kdWN0LCBpbmRleCkgPT4ge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGlkOiBTdHJpbmcocHJvZHVjdD8uX2lkKSxcbiAgICAgICAgICBuYW1lOiBwcm9kdWN0Py5uYW1lLFxuICAgICAgICAgIGNhdGVnb3J5MTogcHJvZHVjdC5jYXRlZ29yaWVzWzBdLFxuICAgICAgICAgIGNhdGVnb3J5MjogcHJvZHVjdC5jYXRlZ29yaWVzWzFdLFxuICAgICAgICAgIGl0ZW1UeXBlOiBJeXppcGF5LkJBU0tFVF9JVEVNX1RZUEVbcHJvZHVjdD8uaXRlbVR5cGVdLFxuICAgICAgICAgIHByaWNlOiBwcm9kdWN0Py5wcmljZSxcbiAgICAgICAgfTtcbiAgICAgIH0pLFxuICAgIH07XG5cbiAgICBsZXQgcmVzdWx0ID0gYXdhaXQgUGF5bWVudHMuY3JlYXRlUGF5bWVudChkYXRhKTtcbiAgICBhd2FpdCBDb21wbGV0ZVBheW1lbnQocmVzdWx0KTtcbiAgICByZXMuanNvbihyZXN1bHQpO1xuICB9KTtcblxuICAvL3llbmkgYmlyIMO2ZGVtZSBvbHXFn3R1ciB2ZSBrYXJ0IGtheWRldFxuICByb3V0ZXIucG9zdChcbiAgICBcIi9wYXltZW50cy86Y2FydElkL3dpdGgtbmV3LWNhcmQvcmVnaXN0ZXItY2FyZFwiLFxuICAgIFNlc3Npb24sXG4gICAgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgICBjb25zdCB7IGNhcmQgfSA9IHJlcS5ib2R5O1xuICAgICAgaWYgKCFjYXJkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgaXMgcmVxdWlyZWRcIiwgNDAwLCBcImNhcmRSZXF1aXJlZFwiKTtcbiAgICAgIH1cbiAgICAgIGlmICghcmVxLnBhcmFtcz8uY2FydElkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnRJRCBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FydElkUmVxdWlyZWRcIik7XG4gICAgICB9XG4gICAgICBjb25zdCBjYXJ0ID0gYXdhaXQgQ2FydHMuZmluZE9uZSh7IF9pZDogcmVxLnBhcmFtcz8uY2FydElkIH0pXG4gICAgICAgIC5wb3B1bGF0ZShcImJ1eWVyXCIpXG4gICAgICAgIC5wb3B1bGF0ZShcInByb2R1Y3RzXCIpO1xuICAgICAgaWYgKCFjYXJ0KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgbm90IGZvdW5kXCIsIDQwNCwgXCJjYXJkTm90Rm91bmRcIik7XG4gICAgICB9XG4gICAgICBpZiAoY2FydD8uY29tcGxldGVkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgaXMgY29tcGxldGVkXCIsIDQwMCwgXCJjYXJ0Q29tcGxldGVkXCIpO1xuICAgICAgfVxuXG4gICAgICBpZiAocmVxLnVzZXI/LmNhcmRVc2VyS2V5KSB7XG4gICAgICAgIGNhcmQuY2FyZFVzZXJLZXkgPSByZXEudXNlcj8uY2FyZFVzZXJLZXk7XG4gICAgICB9XG4gICAgICBjYXJkLnJlZ2lzdGVyQ2FyZCA9IFwiMVwiOyAvL21ldGhvZHNsYXJkYSByZWdpc3RlckNhcmQ6MSB5YW5pIGthcnTEsSBrYXlkZXRcblxuICAgICAgY29uc3QgcGFpZFByaWNlID0gY2FydC5wcm9kdWN0c1xuICAgICAgICAubWFwKChwcm9kdWN0KSA9PiBwcm9kdWN0LnByaWNlKVxuICAgICAgICAucmVkdWNlKChhLCBiKSA9PiBhICsgYiwgMCk7IC8vw7ZkZW5lY2VrIG1pa3RhcmxhcsSxbiB0b3BsYW3EsVxuXG4gICAgICBjb25zdCBkYXRhID0ge1xuICAgICAgICBsb2NhbGU6IHJlcS51c2VyLmxvY2FsZSxcbiAgICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICAgIHByaWNlOiBwYWlkUHJpY2UsXG4gICAgICAgIHBhaWRQcmljZTogcGFpZFByaWNlLFxuICAgICAgICBjdXJyZW5jeTogSXl6aXBheS5DVVJSRU5DWS5UUlksXG4gICAgICAgIGluc3RhbGxtZW50czogXCIxXCIsXG4gICAgICAgIGJhc2tldElkOiBTdHJpbmcoY2FydD8uX2lkKSxcbiAgICAgICAgcGF5bWVudENoYW5uZWw6IEl5emlwYXkuUEFZTUVOVF9DSEFOTkVMLldFQixcbiAgICAgICAgcGF5bWVudEdyb3VwOiBJeXppcGF5LlBBWU1FTlRfR1JPVVAuUFJPRFVDVCxcbiAgICAgICAgcGF5bWVudENhcmQ6IGNhcmQsXG4gICAgICAgIGJ1eWVyOiB7XG4gICAgICAgICAgaWQ6IFN0cmluZyhyZXEudXNlci5faWQpLFxuICAgICAgICAgIG5hbWU6IHJlcS51c2VyPy5uYW1lLFxuICAgICAgICAgIHN1cm5hbWU6IHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICAgIGdzbU51bWJlcjogcmVxLnVzZXI/LnBob25lTnVtYmVyLFxuICAgICAgICAgIGVtYWlsOiByZXEudXNlcj8uZW1haWwsXG4gICAgICAgICAgaWRlbnRpdHlOdW1iZXI6IHJlcS51c2VyPy5pZGVudGl0eU51bWJlcixcbiAgICAgICAgICBsYXN0TG9naW5EYXRlOiBtb21lbnQocmVxLnVzZXI/LnVwZGF0ZWRBdCkuZm9ybWF0KFxuICAgICAgICAgICAgXCJZWVlZLU1NLUREIEhIOm1tOnNzXCJcbiAgICAgICAgICApLCAvL2l5aXpwYXkgdGFyaWggZm9ybWF0xLFuYSDDp2V2aXJtZWsgacOnaW4geWFwxLFsZMSxXG4gICAgICAgICAgcmVnaXN0cmF0aW9uRGF0ZTogbW9tZW50KHJlcS51c2VyPy51cGRhdGVkQXQpLmZvcm1hdChcbiAgICAgICAgICAgIFwiWVlZWS1NTS1ERCBISDptbTpzc1wiXG4gICAgICAgICAgKSxcbiAgICAgICAgICByZWdpc3RyYXRpb25BZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICBpcDogcmVxLnVzZXI/LmlwLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBzaGlwcGluZ0FkZHJlc3M6IHtcbiAgICAgICAgICBjb250YWN0TmFtZTogcmVxLnVzZXI/Lm5hbWUgKyBcIlwiICsgcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgYWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIGJpbGxpbmdBZGRyZXNzOiB7XG4gICAgICAgICAgY29udGFjdE5hbWU6IHJlcS51c2VyPy5uYW1lICsgXCJcIiArIHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIGFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBiYXNrZXRJdGVtczogY2FydC5wcm9kdWN0cy5tYXAoKHByb2R1Y3QsIGluZGV4KSA9PiB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlkOiBTdHJpbmcocHJvZHVjdD8uX2lkKSxcbiAgICAgICAgICAgIG5hbWU6IHByb2R1Y3Q/Lm5hbWUsXG4gICAgICAgICAgICBjYXRlZ29yeTE6IHByb2R1Y3QuY2F0ZWdvcmllc1swXSxcbiAgICAgICAgICAgIGNhdGVnb3J5MjogcHJvZHVjdC5jYXRlZ29yaWVzWzFdLFxuICAgICAgICAgICAgaXRlbVR5cGU6IEl5emlwYXkuQkFTS0VUX0lURU1fVFlQRVtwcm9kdWN0Py5pdGVtVHlwZV0sXG4gICAgICAgICAgICBwcmljZTogcHJvZHVjdD8ucHJpY2UsXG4gICAgICAgICAgfTtcbiAgICAgICAgfSksXG4gICAgICB9O1xuXG4gICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgUGF5bWVudHMuY3JlYXRlUGF5bWVudChkYXRhKTtcbiAgICAgIGlmIChyZXEudXNlcj8uY2FyZFVzZXJLZXkpIHtcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXJzLmZpbmRPbmUoeyBfaWQ6IHJlcS51c2VyPy5faWQgfSk7XG4gICAgICAgIHVzZXIuY2FyZFVzZXJLZXkgPSByZXN1bHQ/LmNhcmRVc2VyS2V5O1xuICAgICAgICBhd2FpdCB1c2VyLnNhdmUoKTtcbiAgICAgIH1cbiAgICAgIGF3YWl0IENvbXBsZXRlUGF5bWVudChyZXN1bHQpO1xuICAgICAgcmVzLmpzb24ocmVzdWx0KTtcbiAgICB9XG4gICk7XG5cbiAgLy9oYWxpIGhhesSxcmRhIGJ1bHVuYW4ga2FydCBpbGUgw7ZkZW1lXG4gIHJvdXRlci5wb3N0KFxuICAgIFwiL3BheW1lbnRzLzpjYXJ0SWQvOmNhcmRJbmRleC93aXRoLXJlZ2lzdGVyZWQtY2FyZC1pbmRleFwiLFxuICAgIFNlc3Npb24sXG4gICAgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgICBsZXQgeyBjYXJkSW5kZXggfSA9IHJlcS5wYXJhbXM7XG4gICAgICBpZiAoIWNhcmRJbmRleCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIGluZGV4IGlzIHJlcXVpcmVkXCIsIDQwMCwgXCJjYXJkSW5kZXhSZXF1aXJlZFwiKTtcbiAgICAgIH1cbiAgICAgIGlmICghcmVxLnVzZXI/LmNhcmRVc2VyS2V5KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgICBcIk5vIHJlZ2lzdGVyZWQgY2FyZCBhdmFpbGFibGVcIixcbiAgICAgICAgICA0MDAsXG4gICAgICAgICAgXCJjYXJkVXNlcktleVJlcXVpcmVkXCJcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgY2FyZHMgPSBhd2FpdCBDYXJkcy5nZXRVc2VyQ2FyZHMoe1xuICAgICAgICBsb2NhbGU6IHJlcS51c2VyLmxvY2FsZSxcbiAgICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICAgIGNhcmRVc2VyS2V5OiByZXEudXNlcj8uY2FyZFVzZXJLZXksXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IGluZGV4ID0gcGFyc2VJbnQoY2FyZEluZGV4KTtcbiAgICAgIGlmIChpbmRleCA+PSBjYXJkcz8uY2FyZERldGFpbHM/Lmxlbmd0aCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIGRvZXMgbm90IGV4aXN0XCIsIDQwMCwgXCJjYXJkSW5kZXhJbnZhbGlkXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBjYXJkVG9rZW4gfSA9IGNhcmRzPy5jYXJkRGV0YWlsc1tpbmRleF07XG4gICAgICBpZiAoIXJlcS5wYXJhbXM/LmNhcnRJZCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJ0SUQgaXMgcmVxdWlyZWRcIiwgNDAwLCBcImNhcnRJZFJlcXVpcmVkXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgY2FydCA9IGF3YWl0IENhcnRzLmZpbmRPbmUoeyBfaWQ6IHJlcS5wYXJhbXM/LmNhcnRJZCB9KVxuICAgICAgICAucG9wdWxhdGUoXCJidXllclwiKVxuICAgICAgICAucG9wdWxhdGUoXCJwcm9kdWN0c1wiKTtcbiAgICAgIGlmICghY2FydCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIG5vdCBmb3VuZFwiLCA0MDQsIFwiY2FyZE5vdEZvdW5kXCIpO1xuICAgICAgfVxuICAgICAgaWYgKGNhcnQ/LmNvbXBsZXRlZCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJ0IGlzIGNvbXBsZXRlZFwiLCA0MDAsIFwiY2FydENvbXBsZXRlZFwiKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcGFpZFByaWNlID0gY2FydC5wcm9kdWN0c1xuICAgICAgICAubWFwKChwcm9kdWN0KSA9PiBwcm9kdWN0LnByaWNlKVxuICAgICAgICAucmVkdWNlKChhLCBiKSA9PiBhICsgYiwgMCk7IC8vw7ZkZW5lY2VrIG1pa3RhcmxhcsSxbiB0b3BsYW3EsVxuXG4gICAgICBjb25zdCBjYXJkID0ge1xuICAgICAgICBjYXJkVG9rZW4sXG4gICAgICAgIGNhcmRVc2VyS2V5OiByZXEudXNlcj8uY2FyZFVzZXJLZXksXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBkYXRhID0ge1xuICAgICAgICBsb2NhbGU6IHJlcS51c2VyLmxvY2FsZSxcbiAgICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICAgIHByaWNlOiBwYWlkUHJpY2UsXG4gICAgICAgIHBhaWRQcmljZTogcGFpZFByaWNlLFxuICAgICAgICBjdXJyZW5jeTogSXl6aXBheS5DVVJSRU5DWS5UUlksXG4gICAgICAgIGluc3RhbGxtZW50czogXCIxXCIsXG4gICAgICAgIGJhc2tldElkOiBTdHJpbmcoY2FydD8uX2lkKSxcbiAgICAgICAgcGF5bWVudENoYW5uZWw6IEl5emlwYXkuUEFZTUVOVF9DSEFOTkVMLldFQixcbiAgICAgICAgcGF5bWVudEdyb3VwOiBJeXppcGF5LlBBWU1FTlRfR1JPVVAuUFJPRFVDVCxcbiAgICAgICAgcGF5bWVudENhcmQ6IGNhcmQsXG4gICAgICAgIGJ1eWVyOiB7XG4gICAgICAgICAgaWQ6IFN0cmluZyhyZXEudXNlci5faWQpLFxuICAgICAgICAgIG5hbWU6IHJlcS51c2VyPy5uYW1lLFxuICAgICAgICAgIHN1cm5hbWU6IHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICAgIGdzbU51bWJlcjogcmVxLnVzZXI/LnBob25lTnVtYmVyLFxuICAgICAgICAgIGVtYWlsOiByZXEudXNlcj8uZW1haWwsXG4gICAgICAgICAgaWRlbnRpdHlOdW1iZXI6IHJlcS51c2VyPy5pZGVudGl0eU51bWJlcixcbiAgICAgICAgICBsYXN0TG9naW5EYXRlOiBtb21lbnQocmVxLnVzZXI/LnVwZGF0ZWRBdCkuZm9ybWF0KFxuICAgICAgICAgICAgXCJZWVlZLU1NLUREIEhIOm1tOnNzXCJcbiAgICAgICAgICApLCAvL2l5aXpwYXkgdGFyaWggZm9ybWF0xLFuYSDDp2V2aXJtZWsgacOnaW4geWFwxLFsZMSxXG4gICAgICAgICAgcmVnaXN0cmF0aW9uRGF0ZTogbW9tZW50KHJlcS51c2VyPy51cGRhdGVkQXQpLmZvcm1hdChcbiAgICAgICAgICAgIFwiWVlZWS1NTS1ERCBISDptbTpzc1wiXG4gICAgICAgICAgKSxcbiAgICAgICAgICByZWdpc3RyYXRpb25BZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICBpcDogcmVxLnVzZXI/LmlwLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBzaGlwcGluZ0FkZHJlc3M6IHtcbiAgICAgICAgICBjb250YWN0TmFtZTogcmVxLnVzZXI/Lm5hbWUgKyBcIlwiICsgcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgYWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIGJpbGxpbmdBZGRyZXNzOiB7XG4gICAgICAgICAgY29udGFjdE5hbWU6IHJlcS51c2VyPy5uYW1lICsgXCJcIiArIHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIGFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBiYXNrZXRJdGVtczogY2FydC5wcm9kdWN0cy5tYXAoKHByb2R1Y3QsIGluZGV4KSA9PiB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlkOiBTdHJpbmcocHJvZHVjdD8uX2lkKSxcbiAgICAgICAgICAgIG5hbWU6IHByb2R1Y3Q/Lm5hbWUsXG4gICAgICAgICAgICBjYXRlZ29yeTE6IHByb2R1Y3QuY2F0ZWdvcmllc1swXSxcbiAgICAgICAgICAgIGNhdGVnb3J5MjogcHJvZHVjdC5jYXRlZ29yaWVzWzFdLFxuICAgICAgICAgICAgaXRlbVR5cGU6IEl5emlwYXkuQkFTS0VUX0lURU1fVFlQRVtwcm9kdWN0Py5pdGVtVHlwZV0sXG4gICAgICAgICAgICBwcmljZTogcHJvZHVjdD8ucHJpY2UsXG4gICAgICAgICAgfTtcbiAgICAgICAgfSksXG4gICAgICB9O1xuXG4gICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgUGF5bWVudHMuY3JlYXRlUGF5bWVudChkYXRhKTtcbiAgICAgIGF3YWl0IENvbXBsZXRlUGF5bWVudChyZXN1bHQpO1xuICAgICAgcmVzLmpzb24ocmVzdWx0KTtcbiAgICB9XG4gICk7XG5cbiAgcm91dGVyLnBvc3QoXG4gICAgXCIvcGF5bWVudHMvOmNhcnRJZC93aXRoLXJlZ2lzdGVyZWQtY2FyZC10b2tlblwiLFxuICAgIFNlc3Npb24sXG4gICAgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgICBsZXQgeyBjYXJkVG9rZW4gfSA9IHJlcS5ib2R5O1xuICAgICAgaWYgKCFjYXJkVG9rZW4pIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FyZCBUb2tlbiBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FyZFRva2VuUmVxdWlyZWRcIik7XG4gICAgICB9XG4gICAgICBpZiAoIXJlcS51c2VyPy5jYXJkVXNlcktleSkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgXCJObyByZWdpc3RlcmVkIGNhcmQgYXZhaWxhYmxlXCIsXG4gICAgICAgICAgNDAwLFxuICAgICAgICAgIFwiY2FyZFVzZXJLZXlSZXF1aXJlZFwiXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGlmICghcmVxLnBhcmFtcz8uY2FydElkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnRJRCBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FydElkUmVxdWlyZWRcIik7XG4gICAgICB9XG4gICAgICBjb25zdCBjYXJ0ID0gYXdhaXQgQ2FydHMuZmluZE9uZSh7IF9pZDogcmVxLnBhcmFtcz8uY2FydElkIH0pXG4gICAgICAgIC5wb3B1bGF0ZShcImJ1eWVyXCIpXG4gICAgICAgIC5wb3B1bGF0ZShcInByb2R1Y3RzXCIpO1xuICAgICAgaWYgKCFjYXJ0KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgbm90IGZvdW5kXCIsIDQwNCwgXCJjYXJkTm90Rm91bmRcIik7XG4gICAgICB9XG4gICAgICBpZiAoY2FydD8uY29tcGxldGVkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgaXMgY29tcGxldGVkXCIsIDQwMCwgXCJjYXJ0Q29tcGxldGVkXCIpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBwYWlkUHJpY2UgPSBjYXJ0LnByb2R1Y3RzXG4gICAgICAgIC5tYXAoKHByb2R1Y3QpID0+IHByb2R1Y3QucHJpY2UpXG4gICAgICAgIC5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiLCAwKTsgLy/DtmRlbmVjZWsgbWlrdGFybGFyxLFuIHRvcGxhbcSxXG5cbiAgICAgIGNvbnN0IGNhcmQgPSB7XG4gICAgICAgIGNhcmRUb2tlbixcbiAgICAgICAgY2FyZFVzZXJLZXk6IHJlcS51c2VyPy5jYXJkVXNlcktleSxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgICBjb252ZXJzYXRpb25JZDogaWQoKSxcbiAgICAgICAgcHJpY2U6IHBhaWRQcmljZSxcbiAgICAgICAgcGFpZFByaWNlOiBwYWlkUHJpY2UsXG4gICAgICAgIGN1cnJlbmN5OiBJeXppcGF5LkNVUlJFTkNZLlRSWSxcbiAgICAgICAgaW5zdGFsbG1lbnRzOiBcIjFcIixcbiAgICAgICAgYmFza2V0SWQ6IFN0cmluZyhjYXJ0Py5faWQpLFxuICAgICAgICBwYXltZW50Q2hhbm5lbDogSXl6aXBheS5QQVlNRU5UX0NIQU5ORUwuV0VCLFxuICAgICAgICBwYXltZW50R3JvdXA6IEl5emlwYXkuUEFZTUVOVF9HUk9VUC5QUk9EVUNULFxuICAgICAgICBwYXltZW50Q2FyZDogY2FyZCxcbiAgICAgICAgYnV5ZXI6IHtcbiAgICAgICAgICBpZDogU3RyaW5nKHJlcS51c2VyLl9pZCksXG4gICAgICAgICAgbmFtZTogcmVxLnVzZXI/Lm5hbWUsXG4gICAgICAgICAgc3VybmFtZTogcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgZ3NtTnVtYmVyOiByZXEudXNlcj8ucGhvbmVOdW1iZXIsXG4gICAgICAgICAgZW1haWw6IHJlcS51c2VyPy5lbWFpbCxcbiAgICAgICAgICBpZGVudGl0eU51bWJlcjogcmVxLnVzZXI/LmlkZW50aXR5TnVtYmVyLFxuICAgICAgICAgIGxhc3RMb2dpbkRhdGU6IG1vbWVudChyZXEudXNlcj8udXBkYXRlZEF0KS5mb3JtYXQoXG4gICAgICAgICAgICBcIllZWVktTU0tREQgSEg6bW06c3NcIlxuICAgICAgICAgICksIC8vaXlpenBheSB0YXJpaCBmb3JtYXTEsW5hIMOnZXZpcm1layBpw6dpbiB5YXDEsWxkxLFcbiAgICAgICAgICByZWdpc3RyYXRpb25EYXRlOiBtb21lbnQocmVxLnVzZXI/LnVwZGF0ZWRBdCkuZm9ybWF0KFxuICAgICAgICAgICAgXCJZWVlZLU1NLUREIEhIOm1tOnNzXCJcbiAgICAgICAgICApLFxuICAgICAgICAgIHJlZ2lzdHJhdGlvbkFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIGlwOiByZXEudXNlcj8uaXAsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIHNoaXBwaW5nQWRkcmVzczoge1xuICAgICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiXCIgKyByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgICBhZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgICAgfSxcbiAgICAgICAgYmlsbGluZ0FkZHJlc3M6IHtcbiAgICAgICAgICBjb250YWN0TmFtZTogcmVxLnVzZXI/Lm5hbWUgKyBcIlwiICsgcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgYWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIGJhc2tldEl0ZW1zOiBjYXJ0LnByb2R1Y3RzLm1hcCgocHJvZHVjdCwgaW5kZXgpID0+IHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaWQ6IFN0cmluZyhwcm9kdWN0Py5faWQpLFxuICAgICAgICAgICAgbmFtZTogcHJvZHVjdD8ubmFtZSxcbiAgICAgICAgICAgIGNhdGVnb3J5MTogcHJvZHVjdC5jYXRlZ29yaWVzWzBdLFxuICAgICAgICAgICAgY2F0ZWdvcnkyOiBwcm9kdWN0LmNhdGVnb3JpZXNbMV0sXG4gICAgICAgICAgICBpdGVtVHlwZTogSXl6aXBheS5CQVNLRVRfSVRFTV9UWVBFW3Byb2R1Y3Q/Lml0ZW1UeXBlXSxcbiAgICAgICAgICAgIHByaWNlOiBwcm9kdWN0Py5wcmljZSxcbiAgICAgICAgICB9O1xuICAgICAgICB9KSxcbiAgICAgIH07XG5cbiAgICAgIGxldCByZXN1bHQgPSBhd2FpdCBQYXltZW50cy5jcmVhdGVQYXltZW50KGRhdGEpO1xuICAgICAgYXdhaXQgQ29tcGxldGVQYXltZW50KHJlc3VsdCk7XG4gICAgICByZXMuanNvbihyZXN1bHQpO1xuICAgIH1cbiAgKTtcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLE9BQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFFBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLEtBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFHLE1BQUEsR0FBQUosc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFJLFNBQUEsR0FBQUwsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFLLFFBQUEsR0FBQU4sc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFNLFFBQUEsR0FBQUMsdUJBQUEsQ0FBQVAsT0FBQTtBQUNBLElBQUFRLEtBQUEsR0FBQUQsdUJBQUEsQ0FBQVAsT0FBQTtBQUNBLElBQUFTLEtBQUEsR0FBQVYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFVLFVBQUEsR0FBQVYsT0FBQTtBQUFvRCxTQUFBVyx5QkFBQUMsQ0FBQSw2QkFBQUMsT0FBQSxtQkFBQUMsQ0FBQSxPQUFBRCxPQUFBLElBQUFFLENBQUEsT0FBQUYsT0FBQSxZQUFBRix3QkFBQSxZQUFBQSxDQUFBQyxDQUFBLFdBQUFBLENBQUEsR0FBQUcsQ0FBQSxHQUFBRCxDQUFBLEtBQUFGLENBQUE7QUFBQSxTQUFBTCx3QkFBQUss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","map":{"version":3,"names":["_moment","_interopRequireDefault","require","_iyzipay","_cart","_users","_ApiError","_Session","Payments","_interopRequireWildcard","Cards","_uuid","_payments2","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","_default","router","post","Session","req","res","card","body","ApiError","params","cartId","cart","Carts","findOne","_id","populate","completed","registerCard","paidPrice","products","map","product","price","reduce","b","data","locale","user","conversationId","id","currency","Iyzipay","CURRENCY","TRY","installments","basketId","String","paymentChannel","PAYMENT_CHANNEL","WEB","paymentGroup","PAYMENT_GROUP","PRODUCT","paymentCard","buyer","name","surname","gsmNumber","phoneNumber","email","identityNumber","lastLoginDate","moment","updatedAt","format","registrationDate","registrationAddress","address","ip","city","country","zipCode","shippingAddress","contactName","billingAddress","basketItems","index","category1","categories","category2","itemType","BASKET_ITEM_TYPE","result","createPayment","CompletePayment","json","cardUserKey","Users","save","cardIndex","cards","getUserCards","parseInt","cardDetails","length","cardToken","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["payments.js"],"sourcesContent":["import moment from \"moment\";\nimport Iyzipay from \"iyzipay\";\nimport Carts from \"../db/cart\";\nimport Users from \"../db/users\";\nimport ApiError from \"../errors/ApiError\";\nimport Session from \"../middlewares/Session\";\nimport * as Payments from \"../services/iyzico/methods/payments\";\nimport * as Cards from \"../services/iyzico/methods/cards\";\nimport id from \"../utils/uuid\";\nimport { CompletePayment } from \"../utils/payments\";\n\nexport default (router) => {\n  //yeni bir kartla ödeme oluştur ve kartı kaydetme\n  router.post(\"/payments/:cartId/with-new-card\", Session, async (req, res) => {\n    const { card } = req.body;\n    if (!card) {\n      throw new ApiError(\"Card is required\", 400, \"cardRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await Carts.findOne({ _id: req.params?.cartId })\n      .populate(\"buyer\")\n      .populate(\"products\");\n    if (!cart) {\n      throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n\n    card.registerCard = \"0\"; //methodslarda registerCard:1 yani kartı kaydet demek ama şuan kaydetme dediğim için 0 yaptım\n\n    const paidPrice = cart.products\n      .map((product) => product.price)\n      .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const data = {\n      locale: req.user.locale,\n      conversationId: id(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: Iyzipay.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n      paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: moment(req.user?.updatedAt).format(\n          \"YYYY-MM-DD HH:mm:ss\"\n        ), //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: moment(req.user?.updatedAt).format(\n          \"YYYY-MM-DD HH:mm:ss\"\n        ),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode,\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode,\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode,\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price,\n        };\n      }),\n    };\n\n    let result = await Payments.createPayment(data);\n    await CompletePayment(result);\n    res.json(result);\n  });\n\n  //yeni bir ödeme oluştur ve kart kaydet\n  router.post(\n    \"/payments/:cartId/with-new-card/register-card\",\n    Session,\n    async (req, res) => {\n      const { card } = req.body;\n      if (!card) {\n        throw new ApiError(\"Card is required\", 400, \"cardRequired\");\n      }\n      if (!req.params?.cartId) {\n        throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      }\n      const cart = await Carts.findOne({ _id: req.params?.cartId })\n        .populate(\"buyer\")\n        .populate(\"products\");\n      if (!cart) {\n        throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n      }\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      if (req.user?.cardUserKey) {\n        card.cardUserKey = req.user?.cardUserKey;\n      }\n      card.registerCard = \"1\"; //methodslarda registerCard:1 yani kartı kaydet\n\n      const paidPrice = cart.products\n        .map((product) => product.price)\n        .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: paidPrice,\n        paidPrice: paidPrice,\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        paymentCard: card,\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ), //iyizpay tarih formatına çevirmek için yapıldı\n          registrationDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems: cart.products.map((product, index) => {\n          return {\n            id: String(product?._id),\n            name: product?.name,\n            category1: product.categories[0],\n            category2: product.categories[1],\n            itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n            price: product?.price,\n          };\n        }),\n      };\n\n      let result = await Payments.createPayment(data);\n      if (req.user?.cardUserKey) {\n        const user = await Users.findOne({ _id: req.user?._id });\n        user.cardUserKey = result?.cardUserKey;\n        await user.save();\n      }\n      await CompletePayment(result);\n      res.json(result);\n    }\n  );\n\n  //hali hazırda bulunan kart ile ödeme\n  router.post(\n    \"/payments/:cartId/:cardIndex/with-registered-card-index\",\n    Session,\n    async (req, res) => {\n      let { cardIndex } = req.params;\n      if (!cardIndex) {\n        throw new ApiError(\"Card index is required\", 400, \"cardIndexRequired\");\n      }\n      if (!req.user?.cardUserKey) {\n        throw new ApiError(\n          \"No registered card available\",\n          400,\n          \"cardUserKeyRequired\"\n        );\n      }\n\n      const cards = await Cards.getUserCards({\n        locale: req.user.locale,\n        conversationId: id(),\n        cardUserKey: req.user?.cardUserKey,\n      });\n      const index = parseInt(cardIndex);\n      if (index >= cards?.cardDetails?.length) {\n        throw new ApiError(\"Card does not exist\", 400, \"cardIndexInvalid\");\n      }\n      const { cardToken } = cards?.cardDetails[index];\n      if (!req.params?.cartId) {\n        throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      }\n      const cart = await Carts.findOne({ _id: req.params?.cartId })\n        .populate(\"buyer\")\n        .populate(\"products\");\n      if (!cart) {\n        throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n      }\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      const paidPrice = cart.products\n        .map((product) => product.price)\n        .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n      const card = {\n        cardToken,\n        cardUserKey: req.user?.cardUserKey,\n      };\n\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: paidPrice,\n        paidPrice: paidPrice,\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        paymentCard: card,\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ), //iyizpay tarih formatına çevirmek için yapıldı\n          registrationDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems: cart.products.map((product, index) => {\n          return {\n            id: String(product?._id),\n            name: product?.name,\n            category1: product.categories[0],\n            category2: product.categories[1],\n            itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n            price: product?.price,\n          };\n        }),\n      };\n\n      let result = await Payments.createPayment(data);\n      await CompletePayment(result);\n      res.json(result);\n    }\n  );\n\n  router.post(\n    \"/payments/:cartId/with-registered-card-token\",\n    Session,\n    async (req, res) => {\n      let { cardToken } = req.body;\n      if (!cardToken) {\n        throw new ApiError(\"Card Token is required\", 400, \"cardTokenRequired\");\n      }\n      if (!req.user?.cardUserKey) {\n        throw new ApiError(\n          \"No registered card available\",\n          400,\n          \"cardUserKeyRequired\"\n        );\n      }\n\n      if (!req.params?.cartId) {\n        throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      }\n      const cart = await Carts.findOne({ _id: req.params?.cartId })\n        .populate(\"buyer\")\n        .populate(\"products\");\n      if (!cart) {\n        throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n      }\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      const paidPrice = cart.products\n        .map((product) => product.price)\n        .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n      const card = {\n        cardToken,\n        cardUserKey: req.user?.cardUserKey,\n      };\n\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: paidPrice,\n        paidPrice: paidPrice,\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        paymentCard: card,\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ), //iyizpay tarih formatına çevirmek için yapıldı\n          registrationDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems: cart.products.map((product, index) => {\n          return {\n            id: String(product?._id),\n            name: product?.name,\n            category1: product.categories[0],\n            category2: product.categories[1],\n            itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n            price: product?.price,\n          };\n        }),\n      };\n\n      let result = await Payments.createPayment(data);\n      await CompletePayment(result);\n      res.json(result);\n    }\n  );\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1723544810375},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/payments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _moment = _interopRequireDefault(require(\"moment\"));\nvar _iyzipay = _interopRequireDefault(require(\"iyzipay\"));\nvar _cart = _interopRequireDefault(require(\"../db/cart\"));\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nvar Payments = _interopRequireWildcard(require(\"../services/iyzico/methods/payments\"));\nvar Cards = _interopRequireWildcard(require(\"../services/iyzico/methods/cards\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nvar _payments2 = require(\"../utils/payments\");\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function (e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = router => {\n  //yeni bir kartla ödeme oluştur ve kartı kaydetme\n  router.post(\"/payments/:cartId/with-new-card\", _Session.default, async (req, res) => {\n    const {\n      card\n    } = req.body;\n    if (!card) {\n      throw new _ApiError.default(\"Card is required\", 400, \"cardRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _cart.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    card.registerCard = \"0\"; //methodslarda registerCard:1 yani kartı kaydet demek ama şuan kaydetme dediğim için 0 yaptım\n\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    let result = await Payments.createPayment(data);\n    await (0, _payments2.CompletePayment)(result);\n    res.json(result);\n  });\n\n  //yeni bir ödeme oluştur ve kart kaydet\n  router.post(\"/payments/:cartId/with-new-card/register-card\", _Session.default, async (req, res) => {\n    const {\n      card\n    } = req.body;\n    if (!card) {\n      throw new _ApiError.default(\"Card is required\", 400, \"cardRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _cart.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    if (req.user?.cardUserKey) {\n      card.cardUserKey = req.user?.cardUserKey;\n    }\n    card.registerCard = \"1\"; //methodslarda registerCard:1 yani kartı kaydet\n\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    let result = await Payments.createPayment(data);\n    if (req.user?.cardUserKey) {\n      const user = await _users.default.findOne({\n        _id: req.user?._id\n      });\n      user.cardUserKey = result?.cardUserKey;\n      await user.save();\n    }\n    await (0, _payments2.CompletePayment)(result);\n    res.json(result);\n  });\n\n  //hali hazırda bulunan kart ile ödeme\n  router.post(\"/payments/:cartId/:cardIndex/with-registered-card-index\", _Session.default, async (req, res) => {\n    let {\n      cardIndex\n    } = req.params;\n    if (!cardIndex) {\n      throw new _ApiError.default(\"Card index is required\", 400, \"cardIndexRequired\");\n    }\n    if (!req.user?.cardUserKey) {\n      throw new _ApiError.default(\"No registered card available\", 400, \"cardUserKeyRequired\");\n    }\n    const cards = await Cards.getUserCards({\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      cardUserKey: req.user?.cardUserKey\n    });\n    const index = parseInt(cardIndex);\n    if (index >= cards?.cardDetails?.length) {\n      throw new _ApiError.default(\"Card does not exist\", 400, \"cardIndexInvalid\");\n    }\n    const {\n      cardToken\n    } = cards?.cardDetails[index];\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _cart.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const card = {\n      cardToken,\n      cardUserKey: req.user?.cardUserKey\n    };\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    let result = await Payments.createPayment(data);\n    await (0, _payments2.CompletePayment)(result);\n    res.json(result);\n  });\n  router.post(\"/payments/:cartId/with-registered-card-token\", _Session.default, async (req, res) => {\n    let {\n      cardToken\n    } = req.body;\n    if (!cardToken) {\n      throw new _ApiError.default(\"Card Token is required\", 400, \"cardTokenRequired\");\n    }\n    if (!req.user?.cardUserKey) {\n      throw new _ApiError.default(\"No registered card available\", 400, \"cardUserKeyRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _cart.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const card = {\n      cardToken,\n      cardUserKey: req.user?.cardUserKey\n    };\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    let result = await Payments.createPayment(data);\n    await (0, _payments2.CompletePayment)(result);\n    res.json(result);\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9tZW50IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfaXl6aXBheSIsIl9jYXJ0IiwiX3VzZXJzIiwiX0FwaUVycm9yIiwiX1Nlc3Npb24iLCJQYXltZW50cyIsIl9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkIiwiQ2FyZHMiLCJfdXVpZCIsIl9wYXltZW50czIiLCJfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUiLCJlIiwiV2Vha01hcCIsInIiLCJ0IiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJoYXMiLCJnZXQiLCJuIiwiX19wcm90b19fIiwiYSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwidSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImkiLCJzZXQiLCJfZGVmYXVsdCIsInJvdXRlciIsInBvc3QiLCJTZXNzaW9uIiwicmVxIiwicmVzIiwiY2FyZCIsImJvZHkiLCJBcGlFcnJvciIsInBhcmFtcyIsImNhcnRJZCIsImNhcnQiLCJDYXJ0cyIsImZpbmRPbmUiLCJfaWQiLCJwb3B1bGF0ZSIsImNvbXBsZXRlZCIsInJlZ2lzdGVyQ2FyZCIsInBhaWRQcmljZSIsInByb2R1Y3RzIiwibWFwIiwicHJvZHVjdCIsInByaWNlIiwicmVkdWNlIiwiYiIsImRhdGEiLCJsb2NhbGUiLCJ1c2VyIiwiY29udmVyc2F0aW9uSWQiLCJpZCIsImN1cnJlbmN5IiwiSXl6aXBheSIsIkNVUlJFTkNZIiwiVFJZIiwiaW5zdGFsbG1lbnRzIiwiYmFza2V0SWQiLCJTdHJpbmciLCJwYXltZW50Q2hhbm5lbCIsIlBBWU1FTlRfQ0hBTk5FTCIsIldFQiIsInBheW1lbnRHcm91cCIsIlBBWU1FTlRfR1JPVVAiLCJQUk9EVUNUIiwicGF5bWVudENhcmQiLCJidXllciIsIm5hbWUiLCJzdXJuYW1lIiwiZ3NtTnVtYmVyIiwicGhvbmVOdW1iZXIiLCJlbWFpbCIsImlkZW50aXR5TnVtYmVyIiwibGFzdExvZ2luRGF0ZSIsIm1vbWVudCIsInVwZGF0ZWRBdCIsImZvcm1hdCIsInJlZ2lzdHJhdGlvbkRhdGUiLCJyZWdpc3RyYXRpb25BZGRyZXNzIiwiYWRkcmVzcyIsImlwIiwiY2l0eSIsImNvdW50cnkiLCJ6aXBDb2RlIiwic2hpcHBpbmdBZGRyZXNzIiwiY29udGFjdE5hbWUiLCJiaWxsaW5nQWRkcmVzcyIsImJhc2tldEl0ZW1zIiwiaW5kZXgiLCJjYXRlZ29yeTEiLCJjYXRlZ29yaWVzIiwiY2F0ZWdvcnkyIiwiaXRlbVR5cGUiLCJCQVNLRVRfSVRFTV9UWVBFIiwicmVzdWx0IiwiY3JlYXRlUGF5bWVudCIsIkNvbXBsZXRlUGF5bWVudCIsImpzb24iLCJjYXJkVXNlcktleSIsIlVzZXJzIiwic2F2ZSIsImNhcmRJbmRleCIsImNhcmRzIiwiZ2V0VXNlckNhcmRzIiwicGFyc2VJbnQiLCJjYXJkRGV0YWlscyIsImxlbmd0aCIsImNhcmRUb2tlbiIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9yb3V0ZXMvIiwic291cmNlcyI6WyJwYXltZW50cy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9tZW50IGZyb20gXCJtb21lbnRcIjtcbmltcG9ydCBJeXppcGF5IGZyb20gXCJpeXppcGF5XCI7XG5pbXBvcnQgQ2FydHMgZnJvbSBcIi4uL2RiL2NhcnRcIjtcbmltcG9ydCBVc2VycyBmcm9tIFwiLi4vZGIvdXNlcnNcIjtcbmltcG9ydCBBcGlFcnJvciBmcm9tIFwiLi4vZXJyb3JzL0FwaUVycm9yXCI7XG5pbXBvcnQgU2Vzc2lvbiBmcm9tIFwiLi4vbWlkZGxld2FyZXMvU2Vzc2lvblwiO1xuaW1wb3J0ICogYXMgUGF5bWVudHMgZnJvbSBcIi4uL3NlcnZpY2VzL2l5emljby9tZXRob2RzL3BheW1lbnRzXCI7XG5pbXBvcnQgKiBhcyBDYXJkcyBmcm9tIFwiLi4vc2VydmljZXMvaXl6aWNvL21ldGhvZHMvY2FyZHNcIjtcbmltcG9ydCBpZCBmcm9tIFwiLi4vdXRpbHMvdXVpZFwiO1xuaW1wb3J0IHsgQ29tcGxldGVQYXltZW50IH0gZnJvbSBcIi4uL3V0aWxzL3BheW1lbnRzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IChyb3V0ZXIpID0+IHtcbiAgLy95ZW5pIGJpciBrYXJ0bGEgw7ZkZW1lIG9sdcWfdHVyIHZlIGthcnTEsSBrYXlkZXRtZVxuICByb3V0ZXIucG9zdChcIi9wYXltZW50cy86Y2FydElkL3dpdGgtbmV3LWNhcmRcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyBjYXJkIH0gPSByZXEuYm9keTtcbiAgICBpZiAoIWNhcmQpIHtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgaXMgcmVxdWlyZWRcIiwgNDAwLCBcImNhcmRSZXF1aXJlZFwiKTtcbiAgICB9XG4gICAgaWYgKCFyZXEucGFyYW1zPy5jYXJ0SWQpIHtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnRJRCBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FydElkUmVxdWlyZWRcIik7XG4gICAgfVxuICAgIGNvbnN0IGNhcnQgPSBhd2FpdCBDYXJ0cy5maW5kT25lKHsgX2lkOiByZXEucGFyYW1zPy5jYXJ0SWQgfSlcbiAgICAgIC5wb3B1bGF0ZShcImJ1eWVyXCIpXG4gICAgICAucG9wdWxhdGUoXCJwcm9kdWN0c1wiKTtcbiAgICBpZiAoIWNhcnQpIHtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgbm90IGZvdW5kXCIsIDQwNCwgXCJjYXJkTm90Rm91bmRcIik7XG4gICAgfVxuICAgIGlmIChjYXJ0Py5jb21wbGV0ZWQpIHtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgaXMgY29tcGxldGVkXCIsIDQwMCwgXCJjYXJ0Q29tcGxldGVkXCIpO1xuICAgIH1cblxuICAgIGNhcmQucmVnaXN0ZXJDYXJkID0gXCIwXCI7IC8vbWV0aG9kc2xhcmRhIHJlZ2lzdGVyQ2FyZDoxIHlhbmkga2FydMSxIGtheWRldCBkZW1layBhbWEgxZ91YW4ga2F5ZGV0bWUgZGVkacSfaW0gacOnaW4gMCB5YXB0xLFtXG5cbiAgICBjb25zdCBwYWlkUHJpY2UgPSBjYXJ0LnByb2R1Y3RzXG4gICAgICAubWFwKChwcm9kdWN0KSA9PiBwcm9kdWN0LnByaWNlKVxuICAgICAgLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApOyAvL8O2ZGVuZWNlayBtaWt0YXJsYXLEsW4gdG9wbGFtxLFcblxuICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICBsb2NhbGU6IHJlcS51c2VyLmxvY2FsZSxcbiAgICAgIGNvbnZlcnNhdGlvbklkOiBpZCgpLFxuICAgICAgcHJpY2U6IHBhaWRQcmljZSxcbiAgICAgIHBhaWRQcmljZTogcGFpZFByaWNlLFxuICAgICAgY3VycmVuY3k6IEl5emlwYXkuQ1VSUkVOQ1kuVFJZLFxuICAgICAgaW5zdGFsbG1lbnRzOiBcIjFcIixcbiAgICAgIGJhc2tldElkOiBTdHJpbmcoY2FydD8uX2lkKSxcbiAgICAgIHBheW1lbnRDaGFubmVsOiBJeXppcGF5LlBBWU1FTlRfQ0hBTk5FTC5XRUIsXG4gICAgICBwYXltZW50R3JvdXA6IEl5emlwYXkuUEFZTUVOVF9HUk9VUC5QUk9EVUNULFxuICAgICAgcGF5bWVudENhcmQ6IGNhcmQsXG4gICAgICBidXllcjoge1xuICAgICAgICBpZDogU3RyaW5nKHJlcS51c2VyLl9pZCksXG4gICAgICAgIG5hbWU6IHJlcS51c2VyPy5uYW1lLFxuICAgICAgICBzdXJuYW1lOiByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgZ3NtTnVtYmVyOiByZXEudXNlcj8ucGhvbmVOdW1iZXIsXG4gICAgICAgIGVtYWlsOiByZXEudXNlcj8uZW1haWwsXG4gICAgICAgIGlkZW50aXR5TnVtYmVyOiByZXEudXNlcj8uaWRlbnRpdHlOdW1iZXIsXG4gICAgICAgIGxhc3RMb2dpbkRhdGU6IG1vbWVudChyZXEudXNlcj8udXBkYXRlZEF0KS5mb3JtYXQoXG4gICAgICAgICAgXCJZWVlZLU1NLUREIEhIOm1tOnNzXCJcbiAgICAgICAgKSwgLy9peWl6cGF5IHRhcmloIGZvcm1hdMSxbmEgw6dldmlybWVrIGnDp2luIHlhcMSxbGTEsVxuICAgICAgICByZWdpc3RyYXRpb25EYXRlOiBtb21lbnQocmVxLnVzZXI/LnVwZGF0ZWRBdCkuZm9ybWF0KFxuICAgICAgICAgIFwiWVlZWS1NTS1ERCBISDptbTpzc1wiXG4gICAgICAgICksXG4gICAgICAgIHJlZ2lzdHJhdGlvbkFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICBpcDogcmVxLnVzZXI/LmlwLFxuICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgfSxcbiAgICAgIHNoaXBwaW5nQWRkcmVzczoge1xuICAgICAgICBjb250YWN0TmFtZTogcmVxLnVzZXI/Lm5hbWUgKyBcIlwiICsgcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgYWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgfSxcbiAgICAgIGJpbGxpbmdBZGRyZXNzOiB7XG4gICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiXCIgKyByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICBhZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICB9LFxuICAgICAgYmFza2V0SXRlbXM6IGNhcnQucHJvZHVjdHMubWFwKChwcm9kdWN0LCBpbmRleCkgPT4ge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGlkOiBTdHJpbmcocHJvZHVjdD8uX2lkKSxcbiAgICAgICAgICBuYW1lOiBwcm9kdWN0Py5uYW1lLFxuICAgICAgICAgIGNhdGVnb3J5MTogcHJvZHVjdC5jYXRlZ29yaWVzWzBdLFxuICAgICAgICAgIGNhdGVnb3J5MjogcHJvZHVjdC5jYXRlZ29yaWVzWzFdLFxuICAgICAgICAgIGl0ZW1UeXBlOiBJeXppcGF5LkJBU0tFVF9JVEVNX1RZUEVbcHJvZHVjdD8uaXRlbVR5cGVdLFxuICAgICAgICAgIHByaWNlOiBwcm9kdWN0Py5wcmljZSxcbiAgICAgICAgfTtcbiAgICAgIH0pLFxuICAgIH07XG5cbiAgICBsZXQgcmVzdWx0ID0gYXdhaXQgUGF5bWVudHMuY3JlYXRlUGF5bWVudChkYXRhKTtcbiAgICBhd2FpdCBDb21wbGV0ZVBheW1lbnQocmVzdWx0KTtcbiAgICByZXMuanNvbihyZXN1bHQpO1xuICB9KTtcblxuICAvL3llbmkgYmlyIMO2ZGVtZSBvbHXFn3R1ciB2ZSBrYXJ0IGtheWRldFxuICByb3V0ZXIucG9zdChcbiAgICBcIi9wYXltZW50cy86Y2FydElkL3dpdGgtbmV3LWNhcmQvcmVnaXN0ZXItY2FyZFwiLFxuICAgIFNlc3Npb24sXG4gICAgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgICBjb25zdCB7IGNhcmQgfSA9IHJlcS5ib2R5O1xuICAgICAgaWYgKCFjYXJkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgaXMgcmVxdWlyZWRcIiwgNDAwLCBcImNhcmRSZXF1aXJlZFwiKTtcbiAgICAgIH1cbiAgICAgIGlmICghcmVxLnBhcmFtcz8uY2FydElkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnRJRCBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FydElkUmVxdWlyZWRcIik7XG4gICAgICB9XG4gICAgICBjb25zdCBjYXJ0ID0gYXdhaXQgQ2FydHMuZmluZE9uZSh7IF9pZDogcmVxLnBhcmFtcz8uY2FydElkIH0pXG4gICAgICAgIC5wb3B1bGF0ZShcImJ1eWVyXCIpXG4gICAgICAgIC5wb3B1bGF0ZShcInByb2R1Y3RzXCIpO1xuICAgICAgaWYgKCFjYXJ0KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgbm90IGZvdW5kXCIsIDQwNCwgXCJjYXJkTm90Rm91bmRcIik7XG4gICAgICB9XG4gICAgICBpZiAoY2FydD8uY29tcGxldGVkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgaXMgY29tcGxldGVkXCIsIDQwMCwgXCJjYXJ0Q29tcGxldGVkXCIpO1xuICAgICAgfVxuXG4gICAgICBpZiAocmVxLnVzZXI/LmNhcmRVc2VyS2V5KSB7XG4gICAgICAgIGNhcmQuY2FyZFVzZXJLZXkgPSByZXEudXNlcj8uY2FyZFVzZXJLZXk7XG4gICAgICB9XG4gICAgICBjYXJkLnJlZ2lzdGVyQ2FyZCA9IFwiMVwiOyAvL21ldGhvZHNsYXJkYSByZWdpc3RlckNhcmQ6MSB5YW5pIGthcnTEsSBrYXlkZXRcblxuICAgICAgY29uc3QgcGFpZFByaWNlID0gY2FydC5wcm9kdWN0c1xuICAgICAgICAubWFwKChwcm9kdWN0KSA9PiBwcm9kdWN0LnByaWNlKVxuICAgICAgICAucmVkdWNlKChhLCBiKSA9PiBhICsgYiwgMCk7IC8vw7ZkZW5lY2VrIG1pa3RhcmxhcsSxbiB0b3BsYW3EsVxuXG4gICAgICBjb25zdCBkYXRhID0ge1xuICAgICAgICBsb2NhbGU6IHJlcS51c2VyLmxvY2FsZSxcbiAgICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICAgIHByaWNlOiBwYWlkUHJpY2UsXG4gICAgICAgIHBhaWRQcmljZTogcGFpZFByaWNlLFxuICAgICAgICBjdXJyZW5jeTogSXl6aXBheS5DVVJSRU5DWS5UUlksXG4gICAgICAgIGluc3RhbGxtZW50czogXCIxXCIsXG4gICAgICAgIGJhc2tldElkOiBTdHJpbmcoY2FydD8uX2lkKSxcbiAgICAgICAgcGF5bWVudENoYW5uZWw6IEl5emlwYXkuUEFZTUVOVF9DSEFOTkVMLldFQixcbiAgICAgICAgcGF5bWVudEdyb3VwOiBJeXppcGF5LlBBWU1FTlRfR1JPVVAuUFJPRFVDVCxcbiAgICAgICAgcGF5bWVudENhcmQ6IGNhcmQsXG4gICAgICAgIGJ1eWVyOiB7XG4gICAgICAgICAgaWQ6IFN0cmluZyhyZXEudXNlci5faWQpLFxuICAgICAgICAgIG5hbWU6IHJlcS51c2VyPy5uYW1lLFxuICAgICAgICAgIHN1cm5hbWU6IHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICAgIGdzbU51bWJlcjogcmVxLnVzZXI/LnBob25lTnVtYmVyLFxuICAgICAgICAgIGVtYWlsOiByZXEudXNlcj8uZW1haWwsXG4gICAgICAgICAgaWRlbnRpdHlOdW1iZXI6IHJlcS51c2VyPy5pZGVudGl0eU51bWJlcixcbiAgICAgICAgICBsYXN0TG9naW5EYXRlOiBtb21lbnQocmVxLnVzZXI/LnVwZGF0ZWRBdCkuZm9ybWF0KFxuICAgICAgICAgICAgXCJZWVlZLU1NLUREIEhIOm1tOnNzXCJcbiAgICAgICAgICApLCAvL2l5aXpwYXkgdGFyaWggZm9ybWF0xLFuYSDDp2V2aXJtZWsgacOnaW4geWFwxLFsZMSxXG4gICAgICAgICAgcmVnaXN0cmF0aW9uRGF0ZTogbW9tZW50KHJlcS51c2VyPy51cGRhdGVkQXQpLmZvcm1hdChcbiAgICAgICAgICAgIFwiWVlZWS1NTS1ERCBISDptbTpzc1wiXG4gICAgICAgICAgKSxcbiAgICAgICAgICByZWdpc3RyYXRpb25BZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICBpcDogcmVxLnVzZXI/LmlwLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBzaGlwcGluZ0FkZHJlc3M6IHtcbiAgICAgICAgICBjb250YWN0TmFtZTogcmVxLnVzZXI/Lm5hbWUgKyBcIlwiICsgcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgYWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIGJpbGxpbmdBZGRyZXNzOiB7XG4gICAgICAgICAgY29udGFjdE5hbWU6IHJlcS51c2VyPy5uYW1lICsgXCJcIiArIHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIGFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBiYXNrZXRJdGVtczogY2FydC5wcm9kdWN0cy5tYXAoKHByb2R1Y3QsIGluZGV4KSA9PiB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlkOiBTdHJpbmcocHJvZHVjdD8uX2lkKSxcbiAgICAgICAgICAgIG5hbWU6IHByb2R1Y3Q/Lm5hbWUsXG4gICAgICAgICAgICBjYXRlZ29yeTE6IHByb2R1Y3QuY2F0ZWdvcmllc1swXSxcbiAgICAgICAgICAgIGNhdGVnb3J5MjogcHJvZHVjdC5jYXRlZ29yaWVzWzFdLFxuICAgICAgICAgICAgaXRlbVR5cGU6IEl5emlwYXkuQkFTS0VUX0lURU1fVFlQRVtwcm9kdWN0Py5pdGVtVHlwZV0sXG4gICAgICAgICAgICBwcmljZTogcHJvZHVjdD8ucHJpY2UsXG4gICAgICAgICAgfTtcbiAgICAgICAgfSksXG4gICAgICB9O1xuXG4gICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgUGF5bWVudHMuY3JlYXRlUGF5bWVudChkYXRhKTtcbiAgICAgIGlmIChyZXEudXNlcj8uY2FyZFVzZXJLZXkpIHtcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXJzLmZpbmRPbmUoeyBfaWQ6IHJlcS51c2VyPy5faWQgfSk7XG4gICAgICAgIHVzZXIuY2FyZFVzZXJLZXkgPSByZXN1bHQ/LmNhcmRVc2VyS2V5O1xuICAgICAgICBhd2FpdCB1c2VyLnNhdmUoKTtcbiAgICAgIH1cbiAgICAgIGF3YWl0IENvbXBsZXRlUGF5bWVudChyZXN1bHQpO1xuICAgICAgcmVzLmpzb24ocmVzdWx0KTtcbiAgICB9XG4gICk7XG5cbiAgLy9oYWxpIGhhesSxcmRhIGJ1bHVuYW4ga2FydCBpbGUgw7ZkZW1lXG4gIHJvdXRlci5wb3N0KFxuICAgIFwiL3BheW1lbnRzLzpjYXJ0SWQvOmNhcmRJbmRleC93aXRoLXJlZ2lzdGVyZWQtY2FyZC1pbmRleFwiLFxuICAgIFNlc3Npb24sXG4gICAgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgICBsZXQgeyBjYXJkSW5kZXggfSA9IHJlcS5wYXJhbXM7XG4gICAgICBpZiAoIWNhcmRJbmRleCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIGluZGV4IGlzIHJlcXVpcmVkXCIsIDQwMCwgXCJjYXJkSW5kZXhSZXF1aXJlZFwiKTtcbiAgICAgIH1cbiAgICAgIGlmICghcmVxLnVzZXI/LmNhcmRVc2VyS2V5KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgICBcIk5vIHJlZ2lzdGVyZWQgY2FyZCBhdmFpbGFibGVcIixcbiAgICAgICAgICA0MDAsXG4gICAgICAgICAgXCJjYXJkVXNlcktleVJlcXVpcmVkXCJcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgY2FyZHMgPSBhd2FpdCBDYXJkcy5nZXRVc2VyQ2FyZHMoe1xuICAgICAgICBsb2NhbGU6IHJlcS51c2VyLmxvY2FsZSxcbiAgICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICAgIGNhcmRVc2VyS2V5OiByZXEudXNlcj8uY2FyZFVzZXJLZXksXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IGluZGV4ID0gcGFyc2VJbnQoY2FyZEluZGV4KTtcbiAgICAgIGlmIChpbmRleCA+PSBjYXJkcz8uY2FyZERldGFpbHM/Lmxlbmd0aCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIGRvZXMgbm90IGV4aXN0XCIsIDQwMCwgXCJjYXJkSW5kZXhJbnZhbGlkXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBjYXJkVG9rZW4gfSA9IGNhcmRzPy5jYXJkRGV0YWlsc1tpbmRleF07XG4gICAgICBpZiAoIXJlcS5wYXJhbXM/LmNhcnRJZCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJ0SUQgaXMgcmVxdWlyZWRcIiwgNDAwLCBcImNhcnRJZFJlcXVpcmVkXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgY2FydCA9IGF3YWl0IENhcnRzLmZpbmRPbmUoeyBfaWQ6IHJlcS5wYXJhbXM/LmNhcnRJZCB9KVxuICAgICAgICAucG9wdWxhdGUoXCJidXllclwiKVxuICAgICAgICAucG9wdWxhdGUoXCJwcm9kdWN0c1wiKTtcbiAgICAgIGlmICghY2FydCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIG5vdCBmb3VuZFwiLCA0MDQsIFwiY2FyZE5vdEZvdW5kXCIpO1xuICAgICAgfVxuICAgICAgaWYgKGNhcnQ/LmNvbXBsZXRlZCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJ0IGlzIGNvbXBsZXRlZFwiLCA0MDAsIFwiY2FydENvbXBsZXRlZFwiKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcGFpZFByaWNlID0gY2FydC5wcm9kdWN0c1xuICAgICAgICAubWFwKChwcm9kdWN0KSA9PiBwcm9kdWN0LnByaWNlKVxuICAgICAgICAucmVkdWNlKChhLCBiKSA9PiBhICsgYiwgMCk7IC8vw7ZkZW5lY2VrIG1pa3RhcmxhcsSxbiB0b3BsYW3EsVxuXG4gICAgICBjb25zdCBjYXJkID0ge1xuICAgICAgICBjYXJkVG9rZW4sXG4gICAgICAgIGNhcmRVc2VyS2V5OiByZXEudXNlcj8uY2FyZFVzZXJLZXksXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBkYXRhID0ge1xuICAgICAgICBsb2NhbGU6IHJlcS51c2VyLmxvY2FsZSxcbiAgICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICAgIHByaWNlOiBwYWlkUHJpY2UsXG4gICAgICAgIHBhaWRQcmljZTogcGFpZFByaWNlLFxuICAgICAgICBjdXJyZW5jeTogSXl6aXBheS5DVVJSRU5DWS5UUlksXG4gICAgICAgIGluc3RhbGxtZW50czogXCIxXCIsXG4gICAgICAgIGJhc2tldElkOiBTdHJpbmcoY2FydD8uX2lkKSxcbiAgICAgICAgcGF5bWVudENoYW5uZWw6IEl5emlwYXkuUEFZTUVOVF9DSEFOTkVMLldFQixcbiAgICAgICAgcGF5bWVudEdyb3VwOiBJeXppcGF5LlBBWU1FTlRfR1JPVVAuUFJPRFVDVCxcbiAgICAgICAgcGF5bWVudENhcmQ6IGNhcmQsXG4gICAgICAgIGJ1eWVyOiB7XG4gICAgICAgICAgaWQ6IFN0cmluZyhyZXEudXNlci5faWQpLFxuICAgICAgICAgIG5hbWU6IHJlcS51c2VyPy5uYW1lLFxuICAgICAgICAgIHN1cm5hbWU6IHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICAgIGdzbU51bWJlcjogcmVxLnVzZXI/LnBob25lTnVtYmVyLFxuICAgICAgICAgIGVtYWlsOiByZXEudXNlcj8uZW1haWwsXG4gICAgICAgICAgaWRlbnRpdHlOdW1iZXI6IHJlcS51c2VyPy5pZGVudGl0eU51bWJlcixcbiAgICAgICAgICBsYXN0TG9naW5EYXRlOiBtb21lbnQocmVxLnVzZXI/LnVwZGF0ZWRBdCkuZm9ybWF0KFxuICAgICAgICAgICAgXCJZWVlZLU1NLUREIEhIOm1tOnNzXCJcbiAgICAgICAgICApLCAvL2l5aXpwYXkgdGFyaWggZm9ybWF0xLFuYSDDp2V2aXJtZWsgacOnaW4geWFwxLFsZMSxXG4gICAgICAgICAgcmVnaXN0cmF0aW9uRGF0ZTogbW9tZW50KHJlcS51c2VyPy51cGRhdGVkQXQpLmZvcm1hdChcbiAgICAgICAgICAgIFwiWVlZWS1NTS1ERCBISDptbTpzc1wiXG4gICAgICAgICAgKSxcbiAgICAgICAgICByZWdpc3RyYXRpb25BZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICBpcDogcmVxLnVzZXI/LmlwLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBzaGlwcGluZ0FkZHJlc3M6IHtcbiAgICAgICAgICBjb250YWN0TmFtZTogcmVxLnVzZXI/Lm5hbWUgKyBcIlwiICsgcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgYWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIGJpbGxpbmdBZGRyZXNzOiB7XG4gICAgICAgICAgY29udGFjdE5hbWU6IHJlcS51c2VyPy5uYW1lICsgXCJcIiArIHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIGFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBiYXNrZXRJdGVtczogY2FydC5wcm9kdWN0cy5tYXAoKHByb2R1Y3QsIGluZGV4KSA9PiB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlkOiBTdHJpbmcocHJvZHVjdD8uX2lkKSxcbiAgICAgICAgICAgIG5hbWU6IHByb2R1Y3Q/Lm5hbWUsXG4gICAgICAgICAgICBjYXRlZ29yeTE6IHByb2R1Y3QuY2F0ZWdvcmllc1swXSxcbiAgICAgICAgICAgIGNhdGVnb3J5MjogcHJvZHVjdC5jYXRlZ29yaWVzWzFdLFxuICAgICAgICAgICAgaXRlbVR5cGU6IEl5emlwYXkuQkFTS0VUX0lURU1fVFlQRVtwcm9kdWN0Py5pdGVtVHlwZV0sXG4gICAgICAgICAgICBwcmljZTogcHJvZHVjdD8ucHJpY2UsXG4gICAgICAgICAgfTtcbiAgICAgICAgfSksXG4gICAgICB9O1xuXG4gICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgUGF5bWVudHMuY3JlYXRlUGF5bWVudChkYXRhKTtcbiAgICAgIGF3YWl0IENvbXBsZXRlUGF5bWVudChyZXN1bHQpO1xuICAgICAgcmVzLmpzb24ocmVzdWx0KTtcbiAgICB9XG4gICk7XG5cbiAgcm91dGVyLnBvc3QoXG4gICAgXCIvcGF5bWVudHMvOmNhcnRJZC93aXRoLXJlZ2lzdGVyZWQtY2FyZC10b2tlblwiLFxuICAgIFNlc3Npb24sXG4gICAgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgICBsZXQgeyBjYXJkVG9rZW4gfSA9IHJlcS5ib2R5O1xuICAgICAgaWYgKCFjYXJkVG9rZW4pIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FyZCBUb2tlbiBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FyZFRva2VuUmVxdWlyZWRcIik7XG4gICAgICB9XG4gICAgICBpZiAoIXJlcS51c2VyPy5jYXJkVXNlcktleSkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgXCJObyByZWdpc3RlcmVkIGNhcmQgYXZhaWxhYmxlXCIsXG4gICAgICAgICAgNDAwLFxuICAgICAgICAgIFwiY2FyZFVzZXJLZXlSZXF1aXJlZFwiXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGlmICghcmVxLnBhcmFtcz8uY2FydElkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnRJRCBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FydElkUmVxdWlyZWRcIik7XG4gICAgICB9XG4gICAgICBjb25zdCBjYXJ0ID0gYXdhaXQgQ2FydHMuZmluZE9uZSh7IF9pZDogcmVxLnBhcmFtcz8uY2FydElkIH0pXG4gICAgICAgIC5wb3B1bGF0ZShcImJ1eWVyXCIpXG4gICAgICAgIC5wb3B1bGF0ZShcInByb2R1Y3RzXCIpO1xuICAgICAgaWYgKCFjYXJ0KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgbm90IGZvdW5kXCIsIDQwNCwgXCJjYXJkTm90Rm91bmRcIik7XG4gICAgICB9XG4gICAgICBpZiAoY2FydD8uY29tcGxldGVkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgaXMgY29tcGxldGVkXCIsIDQwMCwgXCJjYXJ0Q29tcGxldGVkXCIpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBwYWlkUHJpY2UgPSBjYXJ0LnByb2R1Y3RzXG4gICAgICAgIC5tYXAoKHByb2R1Y3QpID0+IHByb2R1Y3QucHJpY2UpXG4gICAgICAgIC5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiLCAwKTsgLy/DtmRlbmVjZWsgbWlrdGFybGFyxLFuIHRvcGxhbcSxXG5cbiAgICAgIGNvbnN0IGNhcmQgPSB7XG4gICAgICAgIGNhcmRUb2tlbixcbiAgICAgICAgY2FyZFVzZXJLZXk6IHJlcS51c2VyPy5jYXJkVXNlcktleSxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgICBjb252ZXJzYXRpb25JZDogaWQoKSxcbiAgICAgICAgcHJpY2U6IHBhaWRQcmljZSxcbiAgICAgICAgcGFpZFByaWNlOiBwYWlkUHJpY2UsXG4gICAgICAgIGN1cnJlbmN5OiBJeXppcGF5LkNVUlJFTkNZLlRSWSxcbiAgICAgICAgaW5zdGFsbG1lbnRzOiBcIjFcIixcbiAgICAgICAgYmFza2V0SWQ6IFN0cmluZyhjYXJ0Py5faWQpLFxuICAgICAgICBwYXltZW50Q2hhbm5lbDogSXl6aXBheS5QQVlNRU5UX0NIQU5ORUwuV0VCLFxuICAgICAgICBwYXltZW50R3JvdXA6IEl5emlwYXkuUEFZTUVOVF9HUk9VUC5QUk9EVUNULFxuICAgICAgICBwYXltZW50Q2FyZDogY2FyZCxcbiAgICAgICAgYnV5ZXI6IHtcbiAgICAgICAgICBpZDogU3RyaW5nKHJlcS51c2VyLl9pZCksXG4gICAgICAgICAgbmFtZTogcmVxLnVzZXI/Lm5hbWUsXG4gICAgICAgICAgc3VybmFtZTogcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgZ3NtTnVtYmVyOiByZXEudXNlcj8ucGhvbmVOdW1iZXIsXG4gICAgICAgICAgZW1haWw6IHJlcS51c2VyPy5lbWFpbCxcbiAgICAgICAgICBpZGVudGl0eU51bWJlcjogcmVxLnVzZXI/LmlkZW50aXR5TnVtYmVyLFxuICAgICAgICAgIGxhc3RMb2dpbkRhdGU6IG1vbWVudChyZXEudXNlcj8udXBkYXRlZEF0KS5mb3JtYXQoXG4gICAgICAgICAgICBcIllZWVktTU0tREQgSEg6bW06c3NcIlxuICAgICAgICAgICksIC8vaXlpenBheSB0YXJpaCBmb3JtYXTEsW5hIMOnZXZpcm1layBpw6dpbiB5YXDEsWxkxLFcbiAgICAgICAgICByZWdpc3RyYXRpb25EYXRlOiBtb21lbnQocmVxLnVzZXI/LnVwZGF0ZWRBdCkuZm9ybWF0KFxuICAgICAgICAgICAgXCJZWVlZLU1NLUREIEhIOm1tOnNzXCJcbiAgICAgICAgICApLFxuICAgICAgICAgIHJlZ2lzdHJhdGlvbkFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIGlwOiByZXEudXNlcj8uaXAsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIHNoaXBwaW5nQWRkcmVzczoge1xuICAgICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiXCIgKyByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgICBhZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgICAgfSxcbiAgICAgICAgYmlsbGluZ0FkZHJlc3M6IHtcbiAgICAgICAgICBjb250YWN0TmFtZTogcmVxLnVzZXI/Lm5hbWUgKyBcIlwiICsgcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgYWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIGJhc2tldEl0ZW1zOiBjYXJ0LnByb2R1Y3RzLm1hcCgocHJvZHVjdCwgaW5kZXgpID0+IHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaWQ6IFN0cmluZyhwcm9kdWN0Py5faWQpLFxuICAgICAgICAgICAgbmFtZTogcHJvZHVjdD8ubmFtZSxcbiAgICAgICAgICAgIGNhdGVnb3J5MTogcHJvZHVjdC5jYXRlZ29yaWVzWzBdLFxuICAgICAgICAgICAgY2F0ZWdvcnkyOiBwcm9kdWN0LmNhdGVnb3JpZXNbMV0sXG4gICAgICAgICAgICBpdGVtVHlwZTogSXl6aXBheS5CQVNLRVRfSVRFTV9UWVBFW3Byb2R1Y3Q/Lml0ZW1UeXBlXSxcbiAgICAgICAgICAgIHByaWNlOiBwcm9kdWN0Py5wcmljZSxcbiAgICAgICAgICB9O1xuICAgICAgICB9KSxcbiAgICAgIH07XG5cbiAgICAgIGxldCByZXN1bHQgPSBhd2FpdCBQYXltZW50cy5jcmVhdGVQYXltZW50KGRhdGEpO1xuICAgICAgYXdhaXQgQ29tcGxldGVQYXltZW50KHJlc3VsdCk7XG4gICAgICByZXMuanNvbihyZXN1bHQpO1xuICAgIH1cbiAgKTtcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLE9BQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFFBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLEtBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFHLE1BQUEsR0FBQUosc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFJLFNBQUEsR0FBQUwsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFLLFFBQUEsR0FBQU4sc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFNLFFBQUEsR0FBQUMsdUJBQUEsQ0FBQVAsT0FBQTtBQUNBLElBQUFRLEtBQUEsR0FBQUQsdUJBQUEsQ0FBQVAsT0FBQTtBQUNBLElBQUFTLEtBQUEsR0FBQVYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFVLFVBQUEsR0FBQVYsT0FBQTtBQUFvRCxTQUFBVyx5QkFBQUMsQ0FBQSw2QkFBQUMsT0FBQSxtQkFBQUMsQ0FBQSxPQUFBRCxPQUFBLElBQUFFLENBQUEsT0FBQUYsT0FBQSxZQUFBRix3QkFBQSxZQUFBQSxDQUFBQyxDQUFBLFdBQUFBLENBQUEsR0FBQUcsQ0FBQSxHQUFBRCxDQUFBLEtBQUFGLENBQUE7QUFBQSxTQUFBTCx3QkFBQUssQ0FBQSxFQUFBRSxDQUFBLFNBQUFBLENBQUEsSUFBQUYsQ0FBQSxJQUFBQSxDQUFBLENBQUFJLFVBQUEsU0FBQUosQ0FBQSxlQUFBQSxDQUFBLHVCQUFBQSxDQUFBLHlCQUFBQSxDQUFBLFdBQUFLLE9BQUEsRUFBQUwsQ0FBQSxRQUFBRyxDQUFBLEdBQUFKLHdCQUFBLENBQUFHLENBQUEsT0FBQUMsQ0FBQSxJQUFBQSxDQUFBLENBQUFHLEdBQUEsQ0FBQU4sQ0FBQSxVQUFBRyxDQUFBLENBQUFJLEdBQUEsQ0FBQVAsQ0FBQSxPQUFBUSxDQUFBLEtBQUFDLFNBQUEsVUFBQUMsQ0FBQSxHQUFBQyxNQUFBLENBQUFDLGNBQUEsSUFBQUQsTUFBQSxDQUFBRSx3QkFBQSxXQUFBQyxDQUFBLElBQUFkLENBQUEsb0JBQUFjLENBQUEsT0FBQUMsY0FBQSxDQUFBQyxJQUFBLENBQUFoQixDQUFBLEVBQUFjLENBQUEsU0FBQUcsQ0FBQSxHQUFBUCxDQUFBLEdBQUFDLE1BQUEsQ0FBQUUsd0JBQUEsQ0FBQWIsQ0FBQSxFQUFBYyxDQUFBLFVBQUFHLENBQUEsS0FBQUEsQ0FBQSxDQUFBVixHQUFBLElBQUFVLENBQUEsQ0FBQUMsR0FBQSxJQUFBUCxNQUFBLENBQUFDLGNBQUEsQ0FBQUosQ0FBQSxFQUFBTSxDQUFBLEVBQUFHLENBQUEsSUFBQVQsQ0FBQSxDQUFBTSxDQUFBLElBQUFkLENBQUEsQ0FBQWMsQ0FBQSxZQUFBTixDQUFBLENBQUFILE9BQUEsR0FBQUwsQ0FBQSxFQUFBRyxDQUFBLElBQUFBLENBQUEsQ0FBQWUsR0FBQSxDQUFBbEIsQ0FBQSxFQUFBUSxDQUFBLEdBQUFBLENBQUE7QUFBQSxTQUFBckIsdUJBQUFhLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFJLFVBQUEsR0FBQUosQ0FBQSxLQUFBSyxPQUFBLEVBQUFMLENBQUE7QUFBQSxJQUFBbUIsUUFBQSxHQUVwQ0MsTUFBTSxJQUFLO0VBQ3pCO0VBQ0FBLE1BQU0sQ0FBQ0MsSUFBSSxDQUFDLGlDQUFpQyxFQUFFQyxnQkFBTyxFQUFFLE9BQU9DLEdBQUcsRUFBRUMsR0FBRyxLQUFLO0lBQzFFLE1BQU07TUFBRUM7SUFBSyxDQUFDLEdBQUdGLEdBQUcsQ0FBQ0csSUFBSTtJQUN6QixJQUFJLENBQUNELElBQUksRUFBRTtNQUNULE1BQU0sSUFBSUUsaUJBQVEsQ0FBQyxrQkFBa0IsRUFBRSxHQUFHLEVBQUUsY0FBYyxDQUFDO0lBQzdEO0lBQ0EsSUFBSSxDQUFDSixHQUFHLENBQUNLLE1BQU0sRUFBRUMsTUFBTSxFQUFFO01BQ3ZCLE1BQU0sSUFBSUYsaUJBQVEsQ0FBQyxvQkFBb0IsRUFBRSxHQUFHLEVBQUUsZ0JBQWdCLENBQUM7SUFDakU7SUFDQSxNQUFNRyxJQUFJLEdBQUcsTUFBTUMsYUFBSyxDQUFDQyxPQUFPLENBQUM7TUFBRUMsR0FBRyxFQUFFVixHQUFHLENBQUNLLE1BQU0sRUFBRUM7SUFBTyxDQUFDLENBQUMsQ0FDMURLLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FDakJBLFFBQVEsQ0FBQyxVQUFVLENBQUM7SUFDdkIsSUFBSSxDQUFDSixJQUFJLEVBQUU7TUFDVCxNQUFNLElBQUlILGlCQUFRLENBQUMsZ0JBQWdCLEVBQUUsR0FBRyxFQUFFLGNBQWMsQ0FBQztJQUMzRDtJQUNBLElBQUlHLElBQUksRUFBRUssU0FBUyxFQUFFO01BQ25CLE1BQU0sSUFBSVIsaUJBQVEsQ0FBQyxtQkFBbUIsRUFBRSxHQUFHLEVBQUUsZUFBZSxDQUFDO0lBQy9EO0lBRUFGLElBQUksQ0FBQ1csWUFBWSxHQUFHLEdBQUcsQ0FBQyxDQUFDOztJQUV6QixNQUFNQyxTQUFTLEdBQUdQLElBQUksQ0FBQ1EsUUFBUSxDQUM1QkMsR0FBRyxDQUFFQyxPQUFPLElBQUtBLE9BQU8sQ0FBQ0MsS0FBSyxDQUFDLENBQy9CQyxNQUFNLENBQUMsQ0FBQ2hDLENBQUMsRUFBRWlDLENBQUMsS0FBS2pDLENBQUMsR0FBR2lDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDOztJQUUvQixNQUFNQyxJQUFJLEdBQUc7TUFDWEMsTUFBTSxFQUFFdEIsR0FBRyxDQUFDdUIsSUFBSSxDQUFDRCxNQUFNO01BQ3ZCRSxjQUFjLEVBQUUsSUFBQUMsYUFBRSxFQUFDLENBQUM7TUFDcEJQLEtBQUssRUFBRUosU0FBUztNQUNoQkEsU0FBUyxFQUFFQSxTQUFTO01BQ3BCWSxRQUFRLEVBQUVDLGdCQUFPLENBQUNDLFFBQVEsQ0FBQ0MsR0FBRztNQUM5QkMsWUFBWSxFQUFFLEdBQUc7TUFDakJDLFFBQVEsRUFBRUMsTUFBTSxDQUFDekIsSUFBSSxFQUFFRyxHQUFHLENBQUM7TUFDM0J1QixjQUFjLEVBQUVOLGdCQUFPLENBQUNPLGVBQWUsQ0FBQ0MsR0FBRztNQUMzQ0MsWUFBWSxFQUFFVCxnQkFBTyxDQUFDVSxhQUFhLENBQUNDLE9BQU87TUFDM0NDLFdBQVcsRUFBRXJDLElBQUk7TUFDakJzQyxLQUFLLEVBQUU7UUFDTGYsRUFBRSxFQUFFTyxNQUFNLENBQUNoQyxHQUFHLENBQUN1QixJQUFJLENBQUNiLEdBQUcsQ0FBQztRQUN4QitCLElBQUksRUFBRXpDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRWtCLElBQUk7UUFDcEJDLE9BQU8sRUFBRTFDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRW1CLE9BQU87UUFDMUJDLFNBQVMsRUFBRTNDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRXFCLFdBQVc7UUFDaENDLEtBQUssRUFBRTdDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRXNCLEtBQUs7UUFDdEJDLGNBQWMsRUFBRTlDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRXVCLGNBQWM7UUFDeENDLGFBQWEsRUFBRSxJQUFBQyxlQUFNLEVBQUNoRCxHQUFHLENBQUN1QixJQUFJLEVBQUUwQixTQUFTLENBQUMsQ0FBQ0MsTUFBTSxDQUMvQyxxQkFDRixDQUFDO1FBQUU7UUFDSEMsZ0JBQWdCLEVBQUUsSUFBQUgsZUFBTSxFQUFDaEQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFMEIsU0FBUyxDQUFDLENBQUNDLE1BQU0sQ0FDbEQscUJBQ0YsQ0FBQztRQUNERSxtQkFBbUIsRUFBRXBELEdBQUcsQ0FBQ3VCLElBQUksRUFBRThCLE9BQU87UUFDdENDLEVBQUUsRUFBRXRELEdBQUcsQ0FBQ3VCLElBQUksRUFBRStCLEVBQUU7UUFDaEJDLElBQUksRUFBRXZELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWdDLElBQUk7UUFDcEJDLE9BQU8sRUFBRXhELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWlDLE9BQU87UUFDMUJDLE9BQU8sRUFBRXpELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWtDO01BQ3JCLENBQUM7TUFDREMsZUFBZSxFQUFFO1FBQ2ZDLFdBQVcsRUFBRTNELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWtCLElBQUksR0FBRyxFQUFFLEdBQUd6QyxHQUFHLENBQUN1QixJQUFJLEVBQUVtQixPQUFPO1FBQ3BEYSxJQUFJLEVBQUV2RCxHQUFHLENBQUN1QixJQUFJLEVBQUVnQyxJQUFJO1FBQ3BCQyxPQUFPLEVBQUV4RCxHQUFHLENBQUN1QixJQUFJLEVBQUVpQyxPQUFPO1FBQzFCSCxPQUFPLEVBQUVyRCxHQUFHLENBQUN1QixJQUFJLEVBQUU4QixPQUFPO1FBQzFCSSxPQUFPLEVBQUV6RCxHQUFHLENBQUN1QixJQUFJLEVBQUVrQztNQUNyQixDQUFDO01BQ0RHLGNBQWMsRUFBRTtRQUNkRCxXQUFXLEVBQUUzRCxHQUFHLENBQUN1QixJQUFJLEVBQUVrQixJQUFJLEdBQUcsRUFBRSxHQUFHekMsR0FBRyxDQUFDdUIsSUFBSSxFQUFFbUIsT0FBTztRQUNwRGEsSUFBSSxFQUFFdkQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFZ0MsSUFBSTtRQUNwQkMsT0FBTyxFQUFFeEQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFaUMsT0FBTztRQUMxQkgsT0FBTyxFQUFFckQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFOEIsT0FBTztRQUMxQkksT0FBTyxFQUFFekQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFa0M7TUFDckIsQ0FBQztNQUNESSxXQUFXLEVBQUV0RCxJQUFJLENBQUNRLFFBQVEsQ0FBQ0MsR0FBRyxDQUFDLENBQUNDLE9BQU8sRUFBRTZDLEtBQUssS0FBSztRQUNqRCxPQUFPO1VBQ0xyQyxFQUFFLEVBQUVPLE1BQU0sQ0FBQ2YsT0FBTyxFQUFFUCxHQUFHLENBQUM7VUFDeEIrQixJQUFJLEVBQUV4QixPQUFPLEVBQUV3QixJQUFJO1VBQ25Cc0IsU0FBUyxFQUFFOUMsT0FBTyxDQUFDK0MsVUFBVSxDQUFDLENBQUMsQ0FBQztVQUNoQ0MsU0FBUyxFQUFFaEQsT0FBTyxDQUFDK0MsVUFBVSxDQUFDLENBQUMsQ0FBQztVQUNoQ0UsUUFBUSxFQUFFdkMsZ0JBQU8sQ0FBQ3dDLGdCQUFnQixDQUFDbEQsT0FBTyxFQUFFaUQsUUFBUSxDQUFDO1VBQ3JEaEQsS0FBSyxFQUFFRCxPQUFPLEVBQUVDO1FBQ2xCLENBQUM7TUFDSCxDQUFDO0lBQ0gsQ0FBQztJQUVELElBQUlrRCxNQUFNLEdBQUcsTUFBTWpHLFFBQVEsQ0FBQ2tHLGFBQWEsQ0FBQ2hELElBQUksQ0FBQztJQUMvQyxNQUFNLElBQUFpRCwwQkFBZSxFQUFDRixNQUFNLENBQUM7SUFDN0JuRSxHQUFHLENBQUNzRSxJQUFJLENBQUNILE1BQU0sQ0FBQztFQUNsQixDQUFDLENBQUM7O0VBRUY7RUFDQXZFLE1BQU0sQ0FBQ0MsSUFBSSxDQUNULCtDQUErQyxFQUMvQ0MsZ0JBQU8sRUFDUCxPQUFPQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztJQUNsQixNQUFNO01BQUVDO0lBQUssQ0FBQyxHQUFHRixHQUFHLENBQUNHLElBQUk7SUFDekIsSUFBSSxDQUFDRCxJQUFJLEVBQUU7TUFDVCxNQUFNLElBQUlFLGlCQUFRLENBQUMsa0JBQWtCLEVBQUUsR0FBRyxFQUFFLGNBQWMsQ0FBQztJQUM3RDtJQUNBLElBQUksQ0FBQ0osR0FBRyxDQUFDSyxNQUFNLEVBQUVDLE1BQU0sRUFBRTtNQUN2QixNQUFNLElBQUlGLGlCQUFRLENBQUMsb0JBQW9CLEVBQUUsR0FBRyxFQUFFLGdCQUFnQixDQUFDO0lBQ2pFO0lBQ0EsTUFBTUcsSUFBSSxHQUFHLE1BQU1DLGFBQUssQ0FBQ0MsT0FBTyxDQUFDO01BQUVDLEdBQUcsRUFBRVYsR0FBRyxDQUFDSyxNQUFNLEVBQUVDO0lBQU8sQ0FBQyxDQUFDLENBQzFESyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQ2pCQSxRQUFRLENBQUMsVUFBVSxDQUFDO0lBQ3ZCLElBQUksQ0FBQ0osSUFBSSxFQUFFO01BQ1QsTUFBTSxJQUFJSCxpQkFBUSxDQUFDLGdCQUFnQixFQUFFLEdBQUcsRUFBRSxjQUFjLENBQUM7SUFDM0Q7SUFDQSxJQUFJRyxJQUFJLEVBQUVLLFNBQVMsRUFBRTtNQUNuQixNQUFNLElBQUlSLGlCQUFRLENBQUMsbUJBQW1CLEVBQUUsR0FBRyxFQUFFLGVBQWUsQ0FBQztJQUMvRDtJQUVBLElBQUlKLEdBQUcsQ0FBQ3VCLElBQUksRUFBRWlELFdBQVcsRUFBRTtNQUN6QnRFLElBQUksQ0FBQ3NFLFdBQVcsR0FBR3hFLEdBQUcsQ0FBQ3VCLElBQUksRUFBRWlELFdBQVc7SUFDMUM7SUFDQXRFLElBQUksQ0FBQ1csWUFBWSxHQUFHLEdBQUcsQ0FBQyxDQUFDOztJQUV6QixNQUFNQyxTQUFTLEdBQUdQLElBQUksQ0FBQ1EsUUFBUSxDQUM1QkMsR0FBRyxDQUFFQyxPQUFPLElBQUtBLE9BQU8sQ0FBQ0MsS0FBSyxDQUFDLENBQy9CQyxNQUFNLENBQUMsQ0FBQ2hDLENBQUMsRUFBRWlDLENBQUMsS0FBS2pDLENBQUMsR0FBR2lDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDOztJQUUvQixNQUFNQyxJQUFJLEdBQUc7TUFDWEMsTUFBTSxFQUFFdEIsR0FBRyxDQUFDdUIsSUFBSSxDQUFDRCxNQUFNO01BQ3ZCRSxjQUFjLEVBQUUsSUFBQUMsYUFBRSxFQUFDLENBQUM7TUFDcEJQLEtBQUssRUFBRUosU0FBUztNQUNoQkEsU0FBUyxFQUFFQSxTQUFTO01BQ3BCWSxRQUFRLEVBQUVDLGdCQUFPLENBQUNDLFFBQVEsQ0FBQ0MsR0FBRztNQUM5QkMsWUFBWSxFQUFFLEdBQUc7TUFDakJDLFFBQVEsRUFBRUMsTUFBTSxDQUFDekIsSUFBSSxFQUFFRyxHQUFHLENBQUM7TUFDM0J1QixjQUFjLEVBQUVOLGdCQUFPLENBQUNPLGVBQWUsQ0FBQ0MsR0FBRztNQUMzQ0MsWUFBWSxFQUFFVCxnQkFBTyxDQUFDVSxhQUFhLENBQUNDLE9BQU87TUFDM0NDLFdBQVcsRUFBRXJDLElBQUk7TUFDakJzQyxLQUFLLEVBQUU7UUFDTGYsRUFBRSxFQUFFTyxNQUFNLENBQUNoQyxHQUFHLENBQUN1QixJQUFJLENBQUNiLEdBQUcsQ0FBQztRQUN4QitCLElBQUksRUFBRXpDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRWtCLElBQUk7UUFDcEJDLE9BQU8sRUFBRTFDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRW1CLE9BQU87UUFDMUJDLFNBQVMsRUFBRTNDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRXFCLFdBQVc7UUFDaENDLEtBQUssRUFBRTdDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRXNCLEtBQUs7UUFDdEJDLGNBQWMsRUFBRTlDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRXVCLGNBQWM7UUFDeENDLGFBQWEsRUFBRSxJQUFBQyxlQUFNLEVBQUNoRCxHQUFHLENBQUN1QixJQUFJLEVBQUUwQixTQUFTLENBQUMsQ0FBQ0MsTUFBTSxDQUMvQyxxQkFDRixDQUFDO1FBQUU7UUFDSEMsZ0JBQWdCLEVBQUUsSUFBQUgsZUFBTSxFQUFDaEQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFMEIsU0FBUyxDQUFDLENBQUNDLE1BQU0sQ0FDbEQscUJBQ0YsQ0FBQztRQUNERSxtQkFBbUIsRUFBRXBELEdBQUcsQ0FBQ3VCLElBQUksRUFBRThCLE9BQU87UUFDdENDLEVBQUUsRUFBRXRELEdBQUcsQ0FBQ3VCLElBQUksRUFBRStCLEVBQUU7UUFDaEJDLElBQUksRUFBRXZELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWdDLElBQUk7UUFDcEJDLE9BQU8sRUFBRXhELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWlDLE9BQU87UUFDMUJDLE9BQU8sRUFBRXpELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWtDO01BQ3JCLENBQUM7TUFDREMsZUFBZSxFQUFFO1FBQ2ZDLFdBQVcsRUFBRTNELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWtCLElBQUksR0FBRyxFQUFFLEdBQUd6QyxHQUFHLENBQUN1QixJQUFJLEVBQUVtQixPQUFPO1FBQ3BEYSxJQUFJLEVBQUV2RCxHQUFHLENBQUN1QixJQUFJLEVBQUVnQyxJQUFJO1FBQ3BCQyxPQUFPLEVBQUV4RCxHQUFHLENBQUN1QixJQUFJLEVBQUVpQyxPQUFPO1FBQzFCSCxPQUFPLEVBQUVyRCxHQUFHLENBQUN1QixJQUFJLEVBQUU4QixPQUFPO1FBQzFCSSxPQUFPLEVBQUV6RCxHQUFHLENBQUN1QixJQUFJLEVBQUVrQztNQUNyQixDQUFDO01BQ0RHLGNBQWMsRUFBRTtRQUNkRCxXQUFXLEVBQUUzRCxHQUFHLENBQUN1QixJQUFJLEVBQUVrQixJQUFJLEdBQUcsRUFBRSxHQUFHekMsR0FBRyxDQUFDdUIsSUFBSSxFQUFFbUIsT0FBTztRQUNwRGEsSUFBSSxFQUFFdkQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFZ0MsSUFBSTtRQUNwQkMsT0FBTyxFQUFFeEQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFaUMsT0FBTztRQUMxQkgsT0FBTyxFQUFFckQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFOEIsT0FBTztRQUMxQkksT0FBTyxFQUFFekQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFa0M7TUFDckIsQ0FBQztNQUNESSxXQUFXLEVBQUV0RCxJQUFJLENBQUNRLFFBQVEsQ0FBQ0MsR0FBRyxDQUFDLENBQUNDLE9BQU8sRUFBRTZDLEtBQUssS0FBSztRQUNqRCxPQUFPO1VBQ0xyQyxFQUFFLEVBQUVPLE1BQU0sQ0FBQ2YsT0FBTyxFQUFFUCxHQUFHLENBQUM7VUFDeEIrQixJQUFJLEVBQUV4QixPQUFPLEVBQUV3QixJQUFJO1VBQ25Cc0IsU0FBUyxFQUFFOUMsT0FBTyxDQUFDK0MsVUFBVSxDQUFDLENBQUMsQ0FBQztVQUNoQ0MsU0FBUyxFQUFFaEQsT0FBTyxDQUFDK0MsVUFBVSxDQUFDLENBQUMsQ0FBQztVQUNoQ0UsUUFBUSxFQUFFdkMsZ0JBQU8sQ0FBQ3dDLGdCQUFnQixDQUFDbEQsT0FBTyxFQUFFaUQsUUFBUSxDQUFDO1VBQ3JEaEQsS0FBSyxFQUFFRCxPQUFPLEVBQUVDO1FBQ2xCLENBQUM7TUFDSCxDQUFDO0lBQ0gsQ0FBQztJQUVELElBQUlrRCxNQUFNLEdBQUcsTUFBTWpHLFFBQVEsQ0FBQ2tHLGFBQWEsQ0FBQ2hELElBQUksQ0FBQztJQUMvQyxJQUFJckIsR0FBRyxDQUFDdUIsSUFBSSxFQUFFaUQsV0FBVyxFQUFFO01BQ3pCLE1BQU1qRCxJQUFJLEdBQUcsTUFBTWtELGNBQUssQ0FBQ2hFLE9BQU8sQ0FBQztRQUFFQyxHQUFHLEVBQUVWLEdBQUcsQ0FBQ3VCLElBQUksRUFBRWI7TUFBSSxDQUFDLENBQUM7TUFDeERhLElBQUksQ0FBQ2lELFdBQVcsR0FBR0osTUFBTSxFQUFFSSxXQUFXO01BQ3RDLE1BQU1qRCxJQUFJLENBQUNtRCxJQUFJLENBQUMsQ0FBQztJQUNuQjtJQUNBLE1BQU0sSUFBQUosMEJBQWUsRUFBQ0YsTUFBTSxDQUFDO0lBQzdCbkUsR0FBRyxDQUFDc0UsSUFBSSxDQUFDSCxNQUFNLENBQUM7RUFDbEIsQ0FDRixDQUFDOztFQUVEO0VBQ0F2RSxNQUFNLENBQUNDLElBQUksQ0FDVCx5REFBeUQsRUFDekRDLGdCQUFPLEVBQ1AsT0FBT0MsR0FBRyxFQUFFQyxHQUFHLEtBQUs7SUFDbEIsSUFBSTtNQUFFMEU7SUFBVSxDQUFDLEdBQUczRSxHQUFHLENBQUNLLE1BQU07SUFDOUIsSUFBSSxDQUFDc0UsU0FBUyxFQUFFO01BQ2QsTUFBTSxJQUFJdkUsaUJBQVEsQ0FBQyx3QkFBd0IsRUFBRSxHQUFHLEVBQUUsbUJBQW1CLENBQUM7SUFDeEU7SUFDQSxJQUFJLENBQUNKLEdBQUcsQ0FBQ3VCLElBQUksRUFBRWlELFdBQVcsRUFBRTtNQUMxQixNQUFNLElBQUlwRSxpQkFBUSxDQUNoQiw4QkFBOEIsRUFDOUIsR0FBRyxFQUNILHFCQUNGLENBQUM7SUFDSDtJQUVBLE1BQU13RSxLQUFLLEdBQUcsTUFBTXZHLEtBQUssQ0FBQ3dHLFlBQVksQ0FBQztNQUNyQ3ZELE1BQU0sRUFBRXRCLEdBQUcsQ0FBQ3VCLElBQUksQ0FBQ0QsTUFBTTtNQUN2QkUsY0FBYyxFQUFFLElBQUFDLGFBQUUsRUFBQyxDQUFDO01BQ3BCK0MsV0FBVyxFQUFFeEUsR0FBRyxDQUFDdUIsSUFBSSxFQUFFaUQ7SUFDekIsQ0FBQyxDQUFDO0lBQ0YsTUFBTVYsS0FBSyxHQUFHZ0IsUUFBUSxDQUFDSCxTQUFTLENBQUM7SUFDakMsSUFBSWIsS0FBSyxJQUFJYyxLQUFLLEVBQUVHLFdBQVcsRUFBRUMsTUFBTSxFQUFFO01BQ3ZDLE1BQU0sSUFBSTVFLGlCQUFRLENBQUMscUJBQXFCLEVBQUUsR0FBRyxFQUFFLGtCQUFrQixDQUFDO0lBQ3BFO0lBQ0EsTUFBTTtNQUFFNkU7SUFBVSxDQUFDLEdBQUdMLEtBQUssRUFBRUcsV0FBVyxDQUFDakIsS0FBSyxDQUFDO0lBQy9DLElBQUksQ0FBQzlELEdBQUcsQ0FBQ0ssTUFBTSxFQUFFQyxNQUFNLEVBQUU7TUFDdkIsTUFBTSxJQUFJRixpQkFBUSxDQUFDLG9CQUFvQixFQUFFLEdBQUcsRUFBRSxnQkFBZ0IsQ0FBQztJQUNqRTtJQUNBLE1BQU1HLElBQUksR0FBRyxNQUFNQyxhQUFLLENBQUNDLE9BQU8sQ0FBQztNQUFFQyxHQUFHLEVBQUVWLEdBQUcsQ0FBQ0ssTUFBTSxFQUFFQztJQUFPLENBQUMsQ0FBQyxDQUMxREssUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUNqQkEsUUFBUSxDQUFDLFVBQVUsQ0FBQztJQUN2QixJQUFJLENBQUNKLElBQUksRUFBRTtNQUNULE1BQU0sSUFBSUgsaUJBQVEsQ0FBQyxnQkFBZ0IsRUFBRSxHQUFHLEVBQUUsY0FBYyxDQUFDO0lBQzNEO0lBQ0EsSUFBSUcsSUFBSSxFQUFFSyxTQUFTLEVBQUU7TUFDbkIsTUFBTSxJQUFJUixpQkFBUSxDQUFDLG1CQUFtQixFQUFFLEdBQUcsRUFBRSxlQUFlLENBQUM7SUFDL0Q7SUFFQSxNQUFNVSxTQUFTLEdBQUdQLElBQUksQ0FBQ1EsUUFBUSxDQUM1QkMsR0FBRyxDQUFFQyxPQUFPLElBQUtBLE9BQU8sQ0FBQ0MsS0FBSyxDQUFDLENBQy9CQyxNQUFNLENBQUMsQ0FBQ2hDLENBQUMsRUFBRWlDLENBQUMsS0FBS2pDLENBQUMsR0FBR2lDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDOztJQUUvQixNQUFNbEIsSUFBSSxHQUFHO01BQ1grRSxTQUFTO01BQ1RULFdBQVcsRUFBRXhFLEdBQUcsQ0FBQ3VCLElBQUksRUFBRWlEO0lBQ3pCLENBQUM7SUFFRCxNQUFNbkQsSUFBSSxHQUFHO01BQ1hDLE1BQU0sRUFBRXRCLEdBQUcsQ0FBQ3VCLElBQUksQ0FBQ0QsTUFBTTtNQUN2QkUsY0FBYyxFQUFFLElBQUFDLGFBQUUsRUFBQyxDQUFDO01BQ3BCUCxLQUFLLEVBQUVKLFNBQVM7TUFDaEJBLFNBQVMsRUFBRUEsU0FBUztNQUNwQlksUUFBUSxFQUFFQyxnQkFBTyxDQUFDQyxRQUFRLENBQUNDLEdBQUc7TUFDOUJDLFlBQVksRUFBRSxHQUFHO01BQ2pCQyxRQUFRLEVBQUVDLE1BQU0sQ0FBQ3pCLElBQUksRUFBRUcsR0FBRyxDQUFDO01BQzNCdUIsY0FBYyxFQUFFTixnQkFBTyxDQUFDTyxlQUFlLENBQUNDLEdBQUc7TUFDM0NDLFlBQVksRUFBRVQsZ0JBQU8sQ0FBQ1UsYUFBYSxDQUFDQyxPQUFPO01BQzNDQyxXQUFXLEVBQUVyQyxJQUFJO01BQ2pCc0MsS0FBSyxFQUFFO1FBQ0xmLEVBQUUsRUFBRU8sTUFBTSxDQUFDaEMsR0FBRyxDQUFDdUIsSUFBSSxDQUFDYixHQUFHLENBQUM7UUFDeEIrQixJQUFJLEVBQUV6QyxHQUFHLENBQUN1QixJQUFJLEVBQUVrQixJQUFJO1FBQ3BCQyxPQUFPLEVBQUUxQyxHQUFHLENBQUN1QixJQUFJLEVBQUVtQixPQUFPO1FBQzFCQyxTQUFTLEVBQUUzQyxHQUFHLENBQUN1QixJQUFJLEVBQUVxQixXQUFXO1FBQ2hDQyxLQUFLLEVBQUU3QyxHQUFHLENBQUN1QixJQUFJLEVBQUVzQixLQUFLO1FBQ3RCQyxjQUFjLEVBQUU5QyxHQUFHLENBQUN1QixJQUFJLEVBQUV1QixjQUFjO1FBQ3hDQyxhQUFhLEVBQUUsSUFBQUMsZUFBTSxFQUFDaEQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFMEIsU0FBUyxDQUFDLENBQUNDLE1BQU0sQ0FDL0MscUJBQ0YsQ0FBQztRQUFFO1FBQ0hDLGdCQUFnQixFQUFFLElBQUFILGVBQU0sRUFBQ2hELEdBQUcsQ0FBQ3VCLElBQUksRUFBRTBCLFNBQVMsQ0FBQyxDQUFDQyxNQUFNLENBQ2xELHFCQUNGLENBQUM7UUFDREUsbUJBQW1CLEVBQUVwRCxHQUFHLENBQUN1QixJQUFJLEVBQUU4QixPQUFPO1FBQ3RDQyxFQUFFLEVBQUV0RCxHQUFHLENBQUN1QixJQUFJLEVBQUUrQixFQUFFO1FBQ2hCQyxJQUFJLEVBQUV2RCxHQUFHLENBQUN1QixJQUFJLEVBQUVnQyxJQUFJO1FBQ3BCQyxPQUFPLEVBQUV4RCxHQUFHLENBQUN1QixJQUFJLEVBQUVpQyxPQUFPO1FBQzFCQyxPQUFPLEVBQUV6RCxHQUFHLENBQUN1QixJQUFJLEVBQUVrQztNQUNyQixDQUFDO01BQ0RDLGVBQWUsRUFBRTtRQUNmQyxXQUFXLEVBQUUzRCxHQUFHLENBQUN1QixJQUFJLEVBQUVrQixJQUFJLEdBQUcsRUFBRSxHQUFHekMsR0FBRyxDQUFDdUIsSUFBSSxFQUFFbUIsT0FBTztRQUNwRGEsSUFBSSxFQUFFdkQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFZ0MsSUFBSTtRQUNwQkMsT0FBTyxFQUFFeEQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFaUMsT0FBTztRQUMxQkgsT0FBTyxFQUFFckQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFOEIsT0FBTztRQUMxQkksT0FBTyxFQUFFekQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFa0M7TUFDckIsQ0FBQztNQUNERyxjQUFjLEVBQUU7UUFDZEQsV0FBVyxFQUFFM0QsR0FBRyxDQUFDdUIsSUFBSSxFQUFFa0IsSUFBSSxHQUFHLEVBQUUsR0FBR3pDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRW1CLE9BQU87UUFDcERhLElBQUksRUFBRXZELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWdDLElBQUk7UUFDcEJDLE9BQU8sRUFBRXhELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWlDLE9BQU87UUFDMUJILE9BQU8sRUFBRXJELEdBQUcsQ0FBQ3VCLElBQUksRUFBRThCLE9BQU87UUFDMUJJLE9BQU8sRUFBRXpELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWtDO01BQ3JCLENBQUM7TUFDREksV0FBVyxFQUFFdEQsSUFBSSxDQUFDUSxRQUFRLENBQUNDLEdBQUcsQ0FBQyxDQUFDQyxPQUFPLEVBQUU2QyxLQUFLLEtBQUs7UUFDakQsT0FBTztVQUNMckMsRUFBRSxFQUFFTyxNQUFNLENBQUNmLE9BQU8sRUFBRVAsR0FBRyxDQUFDO1VBQ3hCK0IsSUFBSSxFQUFFeEIsT0FBTyxFQUFFd0IsSUFBSTtVQUNuQnNCLFNBQVMsRUFBRTlDLE9BQU8sQ0FBQytDLFVBQVUsQ0FBQyxDQUFDLENBQUM7VUFDaENDLFNBQVMsRUFBRWhELE9BQU8sQ0FBQytDLFVBQVUsQ0FBQyxDQUFDLENBQUM7VUFDaENFLFFBQVEsRUFBRXZDLGdCQUFPLENBQUN3QyxnQkFBZ0IsQ0FBQ2xELE9BQU8sRUFBRWlELFFBQVEsQ0FBQztVQUNyRGhELEtBQUssRUFBRUQsT0FBTyxFQUFFQztRQUNsQixDQUFDO01BQ0gsQ0FBQztJQUNILENBQUM7SUFFRCxJQUFJa0QsTUFBTSxHQUFHLE1BQU1qRyxRQUFRLENBQUNrRyxhQUFhLENBQUNoRCxJQUFJLENBQUM7SUFDL0MsTUFBTSxJQUFBaUQsMEJBQWUsRUFBQ0YsTUFBTSxDQUFDO0lBQzdCbkUsR0FBRyxDQUFDc0UsSUFBSSxDQUFDSCxNQUFNLENBQUM7RUFDbEIsQ0FDRixDQUFDO0VBRUR2RSxNQUFNLENBQUNDLElBQUksQ0FDVCw4Q0FBOEMsRUFDOUNDLGdCQUFPLEVBQ1AsT0FBT0MsR0FBRyxFQUFFQyxHQUFHLEtBQUs7SUFDbEIsSUFBSTtNQUFFZ0Y7SUFBVSxDQUFDLEdBQUdqRixHQUFHLENBQUNHLElBQUk7SUFDNUIsSUFBSSxDQUFDOEUsU0FBUyxFQUFFO01BQ2QsTUFBTSxJQUFJN0UsaUJBQVEsQ0FBQyx3QkFBd0IsRUFBRSxHQUFHLEVBQUUsbUJBQW1CLENBQUM7SUFDeEU7SUFDQSxJQUFJLENBQUNKLEdBQUcsQ0FBQ3VCLElBQUksRUFBRWlELFdBQVcsRUFBRTtNQUMxQixNQUFNLElBQUlwRSxpQkFBUSxDQUNoQiw4QkFBOEIsRUFDOUIsR0FBRyxFQUNILHFCQUNGLENBQUM7SUFDSDtJQUVBLElBQUksQ0FBQ0osR0FBRyxDQUFDSyxNQUFNLEVBQUVDLE1BQU0sRUFBRTtNQUN2QixNQUFNLElBQUlGLGlCQUFRLENBQUMsb0JBQW9CLEVBQUUsR0FBRyxFQUFFLGdCQUFnQixDQUFDO0lBQ2pFO0lBQ0EsTUFBTUcsSUFBSSxHQUFHLE1BQU1DLGFBQUssQ0FBQ0MsT0FBTyxDQUFDO01BQUVDLEdBQUcsRUFBRVYsR0FBRyxDQUFDSyxNQUFNLEVBQUVDO0lBQU8sQ0FBQyxDQUFDLENBQzFESyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQ2pCQSxRQUFRLENBQUMsVUFBVSxDQUFDO0lBQ3ZCLElBQUksQ0FBQ0osSUFBSSxFQUFFO01BQ1QsTUFBTSxJQUFJSCxpQkFBUSxDQUFDLGdCQUFnQixFQUFFLEdBQUcsRUFBRSxjQUFjLENBQUM7SUFDM0Q7SUFDQSxJQUFJRyxJQUFJLEVBQUVLLFNBQVMsRUFBRTtNQUNuQixNQUFNLElBQUlSLGlCQUFRLENBQUMsbUJBQW1CLEVBQUUsR0FBRyxFQUFFLGVBQWUsQ0FBQztJQUMvRDtJQUVBLE1BQU1VLFNBQVMsR0FBR1AsSUFBSSxDQUFDUSxRQUFRLENBQzVCQyxHQUFHLENBQUVDLE9BQU8sSUFBS0EsT0FBTyxDQUFDQyxLQUFLLENBQUMsQ0FDL0JDLE1BQU0sQ0FBQyxDQUFDaEMsQ0FBQyxFQUFFaUMsQ0FBQyxLQUFLakMsQ0FBQyxHQUFHaUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7O0lBRS9CLE1BQU1sQixJQUFJLEdBQUc7TUFDWCtFLFNBQVM7TUFDVFQsV0FBVyxFQUFFeEUsR0FBRyxDQUFDdUIsSUFBSSxFQUFFaUQ7SUFDekIsQ0FBQztJQUVELE1BQU1uRCxJQUFJLEdBQUc7TUFDWEMsTUFBTSxFQUFFdEIsR0FBRyxDQUFDdUIsSUFBSSxDQUFDRCxNQUFNO01BQ3ZCRSxjQUFjLEVBQUUsSUFBQUMsYUFBRSxFQUFDLENBQUM7TUFDcEJQLEtBQUssRUFBRUosU0FBUztNQUNoQkEsU0FBUyxFQUFFQSxTQUFTO01BQ3BCWSxRQUFRLEVBQUVDLGdCQUFPLENBQUNDLFFBQVEsQ0FBQ0MsR0FBRztNQUM5QkMsWUFBWSxFQUFFLEdBQUc7TUFDakJDLFFBQVEsRUFBRUMsTUFBTSxDQUFDekIsSUFBSSxFQUFFRyxHQUFHLENBQUM7TUFDM0J1QixjQUFjLEVBQUVOLGdCQUFPLENBQUNPLGVBQWUsQ0FBQ0MsR0FBRztNQUMzQ0MsWUFBWSxFQUFFVCxnQkFBTyxDQUFDVSxhQUFhLENBQUNDLE9BQU87TUFDM0NDLFdBQVcsRUFBRXJDLElBQUk7TUFDakJzQyxLQUFLLEVBQUU7UUFDTGYsRUFBRSxFQUFFTyxNQUFNLENBQUNoQyxHQUFHLENBQUN1QixJQUFJLENBQUNiLEdBQUcsQ0FBQztRQUN4QitCLElBQUksRUFBRXpDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRWtCLElBQUk7UUFDcEJDLE9BQU8sRUFBRTFDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRW1CLE9BQU87UUFDMUJDLFNBQVMsRUFBRTNDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRXFCLFdBQVc7UUFDaENDLEtBQUssRUFBRTdDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRXNCLEtBQUs7UUFDdEJDLGNBQWMsRUFBRTlDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRXVCLGNBQWM7UUFDeENDLGFBQWEsRUFBRSxJQUFBQyxlQUFNLEVBQUNoRCxHQUFHLENBQUN1QixJQUFJLEVBQUUwQixTQUFTLENBQUMsQ0FBQ0MsTUFBTSxDQUMvQyxxQkFDRixDQUFDO1FBQUU7UUFDSEMsZ0JBQWdCLEVBQUUsSUFBQUgsZUFBTSxFQUFDaEQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFMEIsU0FBUyxDQUFDLENBQUNDLE1BQU0sQ0FDbEQscUJBQ0YsQ0FBQztRQUNERSxtQkFBbUIsRUFBRXBELEdBQUcsQ0FBQ3VCLElBQUksRUFBRThCLE9BQU87UUFDdENDLEVBQUUsRUFBRXRELEdBQUcsQ0FBQ3VCLElBQUksRUFBRStCLEVBQUU7UUFDaEJDLElBQUksRUFBRXZELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWdDLElBQUk7UUFDcEJDLE9BQU8sRUFBRXhELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWlDLE9BQU87UUFDMUJDLE9BQU8sRUFBRXpELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWtDO01BQ3JCLENBQUM7TUFDREMsZUFBZSxFQUFFO1FBQ2ZDLFdBQVcsRUFBRTNELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWtCLElBQUksR0FBRyxFQUFFLEdBQUd6QyxHQUFHLENBQUN1QixJQUFJLEVBQUVtQixPQUFPO1FBQ3BEYSxJQUFJLEVBQUV2RCxHQUFHLENBQUN1QixJQUFJLEVBQUVnQyxJQUFJO1FBQ3BCQyxPQUFPLEVBQUV4RCxHQUFHLENBQUN1QixJQUFJLEVBQUVpQyxPQUFPO1FBQzFCSCxPQUFPLEVBQUVyRCxHQUFHLENBQUN1QixJQUFJLEVBQUU4QixPQUFPO1FBQzFCSSxPQUFPLEVBQUV6RCxHQUFHLENBQUN1QixJQUFJLEVBQUVrQztNQUNyQixDQUFDO01BQ0RHLGNBQWMsRUFBRTtRQUNkRCxXQUFXLEVBQUUzRCxHQUFHLENBQUN1QixJQUFJLEVBQUVrQixJQUFJLEdBQUcsRUFBRSxHQUFHekMsR0FBRyxDQUFDdUIsSUFBSSxFQUFFbUIsT0FBTztRQUNwRGEsSUFBSSxFQUFFdkQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFZ0MsSUFBSTtRQUNwQkMsT0FBTyxFQUFFeEQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFaUMsT0FBTztRQUMxQkgsT0FBTyxFQUFFckQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFOEIsT0FBTztRQUMxQkksT0FBTyxFQUFFekQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFa0M7TUFDckIsQ0FBQztNQUNESSxXQUFXLEVBQUV0RCxJQUFJLENBQUNRLFFBQVEsQ0FBQ0MsR0FBRyxDQUFDLENBQUNDLE9BQU8sRUFBRTZDLEtBQUssS0FBSztRQUNqRCxPQUFPO1VBQ0xyQyxFQUFFLEVBQUVPLE1BQU0sQ0FBQ2YsT0FBTyxFQUFFUCxHQUFHLENBQUM7VUFDeEIrQixJQUFJLEVBQUV4QixPQUFPLEVBQUV3QixJQUFJO1VBQ25Cc0IsU0FBUyxFQUFFOUMsT0FBTyxDQUFDK0MsVUFBVSxDQUFDLENBQUMsQ0FBQztVQUNoQ0MsU0FBUyxFQUFFaEQsT0FBTyxDQUFDK0MsVUFBVSxDQUFDLENBQUMsQ0FBQztVQUNoQ0UsUUFBUSxFQUFFdkMsZ0JBQU8sQ0FBQ3dDLGdCQUFnQixDQUFDbEQsT0FBTyxFQUFFaUQsUUFBUSxDQUFDO1VBQ3JEaEQsS0FBSyxFQUFFRCxPQUFPLEVBQUVDO1FBQ2xCLENBQUM7TUFDSCxDQUFDO0lBQ0gsQ0FBQztJQUVELElBQUlrRCxNQUFNLEdBQUcsTUFBTWpHLFFBQVEsQ0FBQ2tHLGFBQWEsQ0FBQ2hELElBQUksQ0FBQztJQUMvQyxNQUFNLElBQUFpRCwwQkFBZSxFQUFDRixNQUFNLENBQUM7SUFDN0JuRSxHQUFHLENBQUNzRSxJQUFJLENBQUNILE1BQU0sQ0FBQztFQUNsQixDQUNGLENBQUM7QUFDSCxDQUFDO0FBQUFjLE9BQUEsQ0FBQXBHLE9BQUEsR0FBQWMsUUFBQSIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_moment","_interopRequireDefault","require","_iyzipay","_cart","_users","_ApiError","_Session","Payments","_interopRequireWildcard","Cards","_uuid","_payments2","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","_default","router","post","Session","req","res","card","body","ApiError","params","cartId","cart","Carts","findOne","_id","populate","completed","registerCard","paidPrice","products","map","product","price","reduce","b","data","locale","user","conversationId","id","currency","Iyzipay","CURRENCY","TRY","installments","basketId","String","paymentChannel","PAYMENT_CHANNEL","WEB","paymentGroup","PAYMENT_GROUP","PRODUCT","paymentCard","buyer","name","surname","gsmNumber","phoneNumber","email","identityNumber","lastLoginDate","moment","updatedAt","format","registrationDate","registrationAddress","address","ip","city","country","zipCode","shippingAddress","contactName","billingAddress","basketItems","index","category1","categories","category2","itemType","BASKET_ITEM_TYPE","result","createPayment","CompletePayment","json","cardUserKey","Users","save","cardIndex","cards","getUserCards","parseInt","cardDetails","length","cardToken","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["payments.js"],"sourcesContent":["import moment from \"moment\";\nimport Iyzipay from \"iyzipay\";\nimport Carts from \"../db/cart\";\nimport Users from \"../db/users\";\nimport ApiError from \"../errors/ApiError\";\nimport Session from \"../middlewares/Session\";\nimport * as Payments from \"../services/iyzico/methods/payments\";\nimport * as Cards from \"../services/iyzico/methods/cards\";\nimport id from \"../utils/uuid\";\nimport { CompletePayment } from \"../utils/payments\";\n\nexport default (router) => {\n  //yeni bir kartla ödeme oluştur ve kartı kaydetme\n  router.post(\"/payments/:cartId/with-new-card\", Session, async (req, res) => {\n    const { card } = req.body;\n    if (!card) {\n      throw new ApiError(\"Card is required\", 400, \"cardRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await Carts.findOne({ _id: req.params?.cartId })\n      .populate(\"buyer\")\n      .populate(\"products\");\n    if (!cart) {\n      throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n\n    card.registerCard = \"0\"; //methodslarda registerCard:1 yani kartı kaydet demek ama şuan kaydetme dediğim için 0 yaptım\n\n    const paidPrice = cart.products\n      .map((product) => product.price)\n      .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const data = {\n      locale: req.user.locale,\n      conversationId: id(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: Iyzipay.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n      paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: moment(req.user?.updatedAt).format(\n          \"YYYY-MM-DD HH:mm:ss\"\n        ), //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: moment(req.user?.updatedAt).format(\n          \"YYYY-MM-DD HH:mm:ss\"\n        ),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode,\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode,\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode,\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price,\n        };\n      }),\n    };\n\n    let result = await Payments.createPayment(data);\n    await CompletePayment(result);\n    res.json(result);\n  });\n\n  //yeni bir ödeme oluştur ve kart kaydet\n  router.post(\n    \"/payments/:cartId/with-new-card/register-card\",\n    Session,\n    async (req, res) => {\n      const { card } = req.body;\n      if (!card) {\n        throw new ApiError(\"Card is required\", 400, \"cardRequired\");\n      }\n      if (!req.params?.cartId) {\n        throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      }\n      const cart = await Carts.findOne({ _id: req.params?.cartId })\n        .populate(\"buyer\")\n        .populate(\"products\");\n      if (!cart) {\n        throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n      }\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      if (req.user?.cardUserKey) {\n        card.cardUserKey = req.user?.cardUserKey;\n      }\n      card.registerCard = \"1\"; //methodslarda registerCard:1 yani kartı kaydet\n\n      const paidPrice = cart.products\n        .map((product) => product.price)\n        .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: paidPrice,\n        paidPrice: paidPrice,\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        paymentCard: card,\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ), //iyizpay tarih formatına çevirmek için yapıldı\n          registrationDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems: cart.products.map((product, index) => {\n          return {\n            id: String(product?._id),\n            name: product?.name,\n            category1: product.categories[0],\n            category2: product.categories[1],\n            itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n            price: product?.price,\n          };\n        }),\n      };\n\n      let result = await Payments.createPayment(data);\n      if (req.user?.cardUserKey) {\n        const user = await Users.findOne({ _id: req.user?._id });\n        user.cardUserKey = result?.cardUserKey;\n        await user.save();\n      }\n      await CompletePayment(result);\n      res.json(result);\n    }\n  );\n\n  //hali hazırda bulunan kart ile ödeme\n  router.post(\n    \"/payments/:cartId/:cardIndex/with-registered-card-index\",\n    Session,\n    async (req, res) => {\n      let { cardIndex } = req.params;\n      if (!cardIndex) {\n        throw new ApiError(\"Card index is required\", 400, \"cardIndexRequired\");\n      }\n      if (!req.user?.cardUserKey) {\n        throw new ApiError(\n          \"No registered card available\",\n          400,\n          \"cardUserKeyRequired\"\n        );\n      }\n\n      const cards = await Cards.getUserCards({\n        locale: req.user.locale,\n        conversationId: id(),\n        cardUserKey: req.user?.cardUserKey,\n      });\n      const index = parseInt(cardIndex);\n      if (index >= cards?.cardDetails?.length) {\n        throw new ApiError(\"Card does not exist\", 400, \"cardIndexInvalid\");\n      }\n      const { cardToken } = cards?.cardDetails[index];\n      if (!req.params?.cartId) {\n        throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      }\n      const cart = await Carts.findOne({ _id: req.params?.cartId })\n        .populate(\"buyer\")\n        .populate(\"products\");\n      if (!cart) {\n        throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n      }\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      const paidPrice = cart.products\n        .map((product) => product.price)\n        .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n      const card = {\n        cardToken,\n        cardUserKey: req.user?.cardUserKey,\n      };\n\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: paidPrice,\n        paidPrice: paidPrice,\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        paymentCard: card,\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ), //iyizpay tarih formatına çevirmek için yapıldı\n          registrationDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems: cart.products.map((product, index) => {\n          return {\n            id: String(product?._id),\n            name: product?.name,\n            category1: product.categories[0],\n            category2: product.categories[1],\n            itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n            price: product?.price,\n          };\n        }),\n      };\n\n      let result = await Payments.createPayment(data);\n      await CompletePayment(result);\n      res.json(result);\n    }\n  );\n\n  router.post(\n    \"/payments/:cartId/with-registered-card-token\",\n    Session,\n    async (req, res) => {\n      let { cardToken } = req.body;\n      if (!cardToken) {\n        throw new ApiError(\"Card Token is required\", 400, \"cardTokenRequired\");\n      }\n      if (!req.user?.cardUserKey) {\n        throw new ApiError(\n          \"No registered card available\",\n          400,\n          \"cardUserKeyRequired\"\n        );\n      }\n\n      if (!req.params?.cartId) {\n        throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      }\n      const cart = await Carts.findOne({ _id: req.params?.cartId })\n        .populate(\"buyer\")\n        .populate(\"products\");\n      if (!cart) {\n        throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n      }\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      const paidPrice = cart.products\n        .map((product) => product.price)\n        .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n      const card = {\n        cardToken,\n        cardUserKey: req.user?.cardUserKey,\n      };\n\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: paidPrice,\n        paidPrice: paidPrice,\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        paymentCard: card,\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ), //iyizpay tarih formatına çevirmek için yapıldı\n          registrationDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems: cart.products.map((product, index) => {\n          return {\n            id: String(product?._id),\n            name: product?.name,\n            category1: product.categories[0],\n            category2: product.categories[1],\n            itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n            price: product?.price,\n          };\n        }),\n      };\n\n      let result = await Payments.createPayment(data);\n      await CompletePayment(result);\n      res.json(result);\n    }\n  );\n};\n"],"mappings":";;;;;;AAAA,IAAAA,OAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,QAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,KAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,MAAA,GAAAJ,sBAAA,CAAAC,OAAA;AACA,IAAAI,SAAA,GAAAL,sBAAA,CAAAC,OAAA;AACA,IAAAK,QAAA,GAAAN,sBAAA,CAAAC,OAAA;AACA,IAAAM,QAAA,GAAAC,uBAAA,CAAAP,OAAA;AACA,IAAAQ,KAAA,GAAAD,uBAAA,CAAAP,OAAA;AACA,IAAAS,KAAA,GAAAV,sBAAA,CAAAC,OAAA;AACA,IAAAU,UAAA,GAAAV,OAAA;AAAoD,SAAAW,yBAAAC,CAAA,6BAAAC,OAAA,mBAAAC,CAAA,OAAAD,OAAA,IAAAE,CAAA,OAAAF,OAAA,YAAAF,wBAAA,YAAAA,CAAAC,CAAA,WAAAA,CAAA,GAAAG,CAAA,GAAAD,CAAA,KAAAF,CAAA;AAAA,SAAAL,wBAAAK,CAAA,EAAAE,CAAA,SAAAA,CAAA,IAAAF,CAAA,IAAAA,CAAA,CAAAI,UAAA,SAAAJ,CAAA,eAAAA,CAAA,uBAAAA,CAAA,yBAAAA,CAAA,WAAAK,OAAA,EAAAL,CAAA,QAAAG,CAAA,GAAAJ,wBAAA,CAAAG,CAAA,OAAAC,CAAA,IAAAA,CAAA,CAAAG,GAAA,CAAAN,CAAA,UAAAG,CAAA,CAAAI,GAAA,CAAAP,CAAA,OAAAQ,CAAA,KAAAC,SAAA,UAAAC,CAAA,GAAAC,MAAA,CAAAC,cAAA,IAAAD,MAAA,CAAAE,wBAAA,WAAAC,CAAA,IAAAd,CAAA,oBAAAc,CAAA,OAAAC,cAAA,CAAAC,IAAA,CAAAhB,CAAA,EAAAc,CAAA,SAAAG,CAAA,GAAAP,CAAA,GAAAC,MAAA,CAAAE,wBAAA,CAAAb,CAAA,EAAAc,CAAA,UAAAG,CAAA,KAAAA,CAAA,CAAAV,GAAA,IAAAU,CAAA,CAAAC,GAAA,IAAAP,MAAA,CAAAC,cAAA,CAAAJ,CAAA,EAAAM,CAAA,EAAAG,CAAA,IAAAT,CAAA,CAAAM,CAAA,IAAAd,CAAA,CAAAc,CAAA,YAAAN,CAAA,CAAAH,OAAA,GAAAL,CAAA,EAAAG,CAAA,IAAAA,CAAA,CAAAe,GAAA,CAAAlB,CAAA,EAAAQ,CAAA,GAAAA,CAAA;AAAA,SAAArB,uBAAAa,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAI,UAAA,GAAAJ,CAAA,KAAAK,OAAA,EAAAL,CAAA;AAAA,IAAAmB,QAAA,GAEpCC,MAAM,IAAK;EACzB;EACAA,MAAM,CAACC,IAAI,CAAC,iCAAiC,EAAEC,gBAAO,EAAE,OAAOC,GAAG,EAAEC,GAAG,KAAK;IAC1E,MAAM;MAAEC;IAAK,CAAC,GAAGF,GAAG,CAACG,IAAI;IACzB,IAAI,CAACD,IAAI,EAAE;MACT,MAAM,IAAIE,iBAAQ,CAAC,kBAAkB,EAAE,GAAG,EAAE,cAAc,CAAC;IAC7D;IACA,IAAI,CAACJ,GAAG,CAACK,MAAM,EAAEC,MAAM,EAAE;MACvB,MAAM,IAAIF,iBAAQ,CAAC,oBAAoB,EAAE,GAAG,EAAE,gBAAgB,CAAC;IACjE;IACA,MAAMG,IAAI,GAAG,MAAMC,aAAK,CAACC,OAAO,CAAC;MAAEC,GAAG,EAAEV,GAAG,CAACK,MAAM,EAAEC;IAAO,CAAC,CAAC,CAC1DK,QAAQ,CAAC,OAAO,CAAC,CACjBA,QAAQ,CAAC,UAAU,CAAC;IACvB,IAAI,CAACJ,IAAI,EAAE;MACT,MAAM,IAAIH,iBAAQ,CAAC,gBAAgB,EAAE,GAAG,EAAE,cAAc,CAAC;IAC3D;IACA,IAAIG,IAAI,EAAEK,SAAS,EAAE;MACnB,MAAM,IAAIR,iBAAQ,CAAC,mBAAmB,EAAE,GAAG,EAAE,eAAe,CAAC;IAC/D;IAEAF,IAAI,CAACW,YAAY,GAAG,GAAG,CAAC,CAAC;;IAEzB,MAAMC,SAAS,GAAGP,IAAI,CAACQ,QAAQ,CAC5BC,GAAG,CAAEC,OAAO,IAAKA,OAAO,CAACC,KAAK,CAAC,CAC/BC,MAAM,CAAC,CAAChC,CAAC,EAAEiC,CAAC,KAAKjC,CAAC,GAAGiC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;;IAE/B,MAAMC,IAAI,GAAG;MACXC,MAAM,EAAEtB,GAAG,CAACuB,IAAI,CAACD,MAAM;MACvBE,cAAc,EAAE,IAAAC,aAAE,EAAC,CAAC;MACpBP,KAAK,EAAEJ,SAAS;MAChBA,SAAS,EAAEA,SAAS;MACpBY,QAAQ,EAAEC,gBAAO,CAACC,QAAQ,CAACC,GAAG;MAC9BC,YAAY,EAAE,GAAG;MACjBC,QAAQ,EAAEC,MAAM,CAACzB,IAAI,EAAEG,GAAG,CAAC;MAC3BuB,cAAc,EAAEN,gBAAO,CAACO,eAAe,CAACC,GAAG;MAC3CC,YAAY,EAAET,gBAAO,CAACU,aAAa,CAACC,OAAO;MAC3CC,WAAW,EAAErC,IAAI;MACjBsC,KAAK,EAAE;QACLf,EAAE,EAAEO,MAAM,CAAChC,GAAG,CAACuB,IAAI,CAACb,GAAG,CAAC;QACxB+B,IAAI,EAAEzC,GAAG,CAACuB,IAAI,EAAEkB,IAAI;QACpBC,OAAO,EAAE1C,GAAG,CAACuB,IAAI,EAAEmB,OAAO;QAC1BC,SAAS,EAAE3C,GAAG,CAACuB,IAAI,EAAEqB,WAAW;QAChCC,KAAK,EAAE7C,GAAG,CAACuB,IAAI,EAAEsB,KAAK;QACtBC,cAAc,EAAE9C,GAAG,CAACuB,IAAI,EAAEuB,cAAc;QACxCC,aAAa,EAAE,IAAAC,eAAM,EAAChD,GAAG,CAACuB,IAAI,EAAE0B,SAAS,CAAC,CAACC,MAAM,CAC/C,qBACF,CAAC;QAAE;QACHC,gBAAgB,EAAE,IAAAH,eAAM,EAAChD,GAAG,CAACuB,IAAI,EAAE0B,SAAS,CAAC,CAACC,MAAM,CAClD,qBACF,CAAC;QACDE,mBAAmB,EAAEpD,GAAG,CAACuB,IAAI,EAAE8B,OAAO;QACtCC,EAAE,EAAEtD,GAAG,CAACuB,IAAI,EAAE+B,EAAE;QAChBC,IAAI,EAAEvD,GAAG,CAACuB,IAAI,EAAEgC,IAAI;QACpBC,OAAO,EAAExD,GAAG,CAACuB,IAAI,EAAEiC,OAAO;QAC1BC,OAAO,EAAEzD,GAAG,CAACuB,IAAI,EAAEkC;MACrB,CAAC;MACDC,eAAe,EAAE;QACfC,WAAW,EAAE3D,GAAG,CAACuB,IAAI,EAAEkB,IAAI,GAAG,EAAE,GAAGzC,GAAG,CAACuB,IAAI,EAAEmB,OAAO;QACpDa,IAAI,EAAEvD,GAAG,CAACuB,IAAI,EAAEgC,IAAI;QACpBC,OAAO,EAAExD,GAAG,CAACuB,IAAI,EAAEiC,OAAO;QAC1BH,OAAO,EAAErD,GAAG,CAACuB,IAAI,EAAE8B,OAAO;QAC1BI,OAAO,EAAEzD,GAAG,CAACuB,IAAI,EAAEkC;MACrB,CAAC;MACDG,cAAc,EAAE;QACdD,WAAW,EAAE3D,GAAG,CAACuB,IAAI,EAAEkB,IAAI,GAAG,EAAE,GAAGzC,GAAG,CAACuB,IAAI,EAAEmB,OAAO;QACpDa,IAAI,EAAEvD,GAAG,CAACuB,IAAI,EAAEgC,IAAI;QACpBC,OAAO,EAAExD,GAAG,CAACuB,IAAI,EAAEiC,OAAO;QAC1BH,OAAO,EAAErD,GAAG,CAACuB,IAAI,EAAE8B,OAAO;QAC1BI,OAAO,EAAEzD,GAAG,CAACuB,IAAI,EAAEkC;MACrB,CAAC;MACDI,WAAW,EAAEtD,IAAI,CAACQ,QAAQ,CAACC,GAAG,CAAC,CAACC,OAAO,EAAE6C,KAAK,KAAK;QACjD,OAAO;UACLrC,EAAE,EAAEO,MAAM,CAACf,OAAO,EAAEP,GAAG,CAAC;UACxB+B,IAAI,EAAExB,OAAO,EAAEwB,IAAI;UACnBsB,SAAS,EAAE9C,OAAO,CAAC+C,UAAU,CAAC,CAAC,CAAC;UAChCC,SAAS,EAAEhD,OAAO,CAAC+C,UAAU,CAAC,CAAC,CAAC;UAChCE,QAAQ,EAAEvC,gBAAO,CAACwC,gBAAgB,CAAClD,OAAO,EAAEiD,QAAQ,CAAC;UACrDhD,KAAK,EAAED,OAAO,EAAEC;QAClB,CAAC;MACH,CAAC;IACH,CAAC;IAED,IAAIkD,MAAM,GAAG,MAAMjG,QAAQ,CAACkG,aAAa,CAAChD,IAAI,CAAC;IAC/C,MAAM,IAAAiD,0BAAe,EAACF,MAAM,CAAC;IAC7BnE,GAAG,CAACsE,IAAI,CAACH,MAAM,CAAC;EAClB,CAAC,CAAC;;EAEF;EACAvE,MAAM,CAACC,IAAI,CACT,+CAA+C,EAC/CC,gBAAO,EACP,OAAOC,GAAG,EAAEC,GAAG,KAAK;IAClB,MAAM;MAAEC;IAAK,CAAC,GAAGF,GAAG,CAACG,IAAI;IACzB,IAAI,CAACD,IAAI,EAAE;MACT,MAAM,IAAIE,iBAAQ,CAAC,kBAAkB,EAAE,GAAG,EAAE,cAAc,CAAC;IAC7D;IACA,IAAI,CAACJ,GAAG,CAACK,MAAM,EAAEC,MAAM,EAAE;MACvB,MAAM,IAAIF,iBAAQ,CAAC,oBAAoB,EAAE,GAAG,EAAE,gBAAgB,CAAC;IACjE;IACA,MAAMG,IAAI,GAAG,MAAMC,aAAK,CAACC,OAAO,CAAC;MAAEC,GAAG,EAAEV,GAAG,CAACK,MAAM,EAAEC;IAAO,CAAC,CAAC,CAC1DK,QAAQ,CAAC,OAAO,CAAC,CACjBA,QAAQ,CAAC,UAAU,CAAC;IACvB,IAAI,CAACJ,IAAI,EAAE;MACT,MAAM,IAAIH,iBAAQ,CAAC,gBAAgB,EAAE,GAAG,EAAE,cAAc,CAAC;IAC3D;IACA,IAAIG,IAAI,EAAEK,SAAS,EAAE;MACnB,MAAM,IAAIR,iBAAQ,CAAC,mBAAmB,EAAE,GAAG,EAAE,eAAe,CAAC;IAC/D;IAEA,IAAIJ,GAAG,CAACuB,IAAI,EAAEiD,WAAW,EAAE;MACzBtE,IAAI,CAACsE,WAAW,GAAGxE,GAAG,CAACuB,IAAI,EAAEiD,WAAW;IAC1C;IACAtE,IAAI,CAACW,YAAY,GAAG,GAAG,CAAC,CAAC;;IAEzB,MAAMC,SAAS,GAAGP,IAAI,CAACQ,QAAQ,CAC5BC,GAAG,CAAEC,OAAO,IAAKA,OAAO,CAACC,KAAK,CAAC,CAC/BC,MAAM,CAAC,CAAChC,CAAC,EAAEiC,CAAC,KAAKjC,CAAC,GAAGiC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;;IAE/B,MAAMC,IAAI,GAAG;MACXC,MAAM,EAAEtB,GAAG,CAACuB,IAAI,CAACD,MAAM;MACvBE,cAAc,EAAE,IAAAC,aAAE,EAAC,CAAC;MACpBP,KAAK,EAAEJ,SAAS;MAChBA,SAAS,EAAEA,SAAS;MACpBY,QAAQ,EAAEC,gBAAO,CAACC,QAAQ,CAACC,GAAG;MAC9BC,YAAY,EAAE,GAAG;MACjBC,QAAQ,EAAEC,MAAM,CAACzB,IAAI,EAAEG,GAAG,CAAC;MAC3BuB,cAAc,EAAEN,gBAAO,CAACO,eAAe,CAACC,GAAG;MAC3CC,YAAY,EAAET,gBAAO,CAACU,aAAa,CAACC,OAAO;MAC3CC,WAAW,EAAErC,IAAI;MACjBsC,KAAK,EAAE;QACLf,EAAE,EAAEO,MAAM,CAAChC,GAAG,CAACuB,IAAI,CAACb,GAAG,CAAC;QACxB+B,IAAI,EAAEzC,GAAG,CAACuB,IAAI,EAAEkB,IAAI;QACpBC,OAAO,EAAE1C,GAAG,CAACuB,IAAI,EAAEmB,OAAO;QAC1BC,SAAS,EAAE3C,GAAG,CAACuB,IAAI,EAAEqB,WAAW;QAChCC,KAAK,EAAE7C,GAAG,CAACuB,IAAI,EAAEsB,KAAK;QACtBC,cAAc,EAAE9C,GAAG,CAACuB,IAAI,EAAEuB,cAAc;QACxCC,aAAa,EAAE,IAAAC,eAAM,EAAChD,GAAG,CAACuB,IAAI,EAAE0B,SAAS,CAAC,CAACC,MAAM,CAC/C,qBACF,CAAC;QAAE;QACHC,gBAAgB,EAAE,IAAAH,eAAM,EAAChD,GAAG,CAACuB,IAAI,EAAE0B,SAAS,CAAC,CAACC,MAAM,CAClD,qBACF,CAAC;QACDE,mBAAmB,EAAEpD,GAAG,CAACuB,IAAI,EAAE8B,OAAO;QACtCC,EAAE,EAAEtD,GAAG,CAACuB,IAAI,EAAE+B,EAAE;QAChBC,IAAI,EAAEvD,GAAG,CAACuB,IAAI,EAAEgC,IAAI;QACpBC,OAAO,EAAExD,GAAG,CAACuB,IAAI,EAAEiC,OAAO;QAC1BC,OAAO,EAAEzD,GAAG,CAACuB,IAAI,EAAEkC;MACrB,CAAC;MACDC,eAAe,EAAE;QACfC,WAAW,EAAE3D,GAAG,CAACuB,IAAI,EAAEkB,IAAI,GAAG,EAAE,GAAGzC,GAAG,CAACuB,IAAI,EAAEmB,OAAO;QACpDa,IAAI,EAAEvD,GAAG,CAACuB,IAAI,EAAEgC,IAAI;QACpBC,OAAO,EAAExD,GAAG,CAACuB,IAAI,EAAEiC,OAAO;QAC1BH,OAAO,EAAErD,GAAG,CAACuB,IAAI,EAAE8B,OAAO;QAC1BI,OAAO,EAAEzD,GAAG,CAACuB,IAAI,EAAEkC;MACrB,CAAC;MACDG,cAAc,EAAE;QACdD,WAAW,EAAE3D,GAAG,CAACuB,IAAI,EAAEkB,IAAI,GAAG,EAAE,GAAGzC,GAAG,CAACuB,IAAI,EAAEmB,OAAO;QACpDa,IAAI,EAAEvD,GAAG,CAACuB,IAAI,EAAEgC,IAAI;QACpBC,OAAO,EAAExD,GAAG,CAACuB,IAAI,EAAEiC,OAAO;QAC1BH,OAAO,EAAErD,GAAG,CAACuB,IAAI,EAAE8B,OAAO;QAC1BI,OAAO,EAAEzD,GAAG,CAACuB,IAAI,EAAEkC;MACrB,CAAC;MACDI,WAAW,EAAEtD,IAAI,CAACQ,QAAQ,CAACC,GAAG,CAAC,CAACC,OAAO,EAAE6C,KAAK,KAAK;QACjD,OAAO;UACLrC,EAAE,EAAEO,MAAM,CAACf,OAAO,EAAEP,GAAG,CAAC;UACxB+B,IAAI,EAAExB,OAAO,EAAEwB,IAAI;UACnBsB,SAAS,EAAE9C,OAAO,CAAC+C,UAAU,CAAC,CAAC,CAAC;UAChCC,SAAS,EAAEhD,OAAO,CAAC+C,UAAU,CAAC,CAAC,CAAC;UAChCE,QAAQ,EAAEvC,gBAAO,CAACwC,gBAAgB,CAAClD,OAAO,EAAEiD,QAAQ,CAAC;UACrDhD,KAAK,EAAED,OAAO,EAAEC;QAClB,CAAC;MACH,CAAC;IACH,CAAC;IAED,IAAIkD,MAAM,GAAG,MAAMjG,QAAQ,CAACkG,aAAa,CAAChD,IAAI,CAAC;IAC/C,IAAIrB,GAAG,CAACuB,IAAI,EAAEiD,WAAW,EAAE;MACzB,MAAMjD,IAAI,GAAG,MAAMkD,cAAK,CAAChE,OAAO,CAAC;QAAEC,GAAG,EAAEV,GAAG,CAACuB,IAAI,EAAEb;MAAI,CAAC,CAAC;MACxDa,IAAI,CAACiD,WAAW,GAAGJ,MAAM,EAAEI,WAAW;MACtC,MAAMjD,IAAI,CAACmD,IAAI,CAAC,CAAC;IACnB;IACA,MAAM,IAAAJ,0BAAe,EAACF,MAAM,CAAC;IAC7BnE,GAAG,CAACsE,IAAI,CAACH,MAAM,CAAC;EAClB,CACF,CAAC;;EAED;EACAvE,MAAM,CAACC,IAAI,CACT,yDAAyD,EACzDC,gBAAO,EACP,OAAOC,GAAG,EAAEC,GAAG,KAAK;IAClB,IAAI;MAAE0E;IAAU,CAAC,GAAG3E,GAAG,CAACK,MAAM;IAC9B,IAAI,CAACsE,SAAS,EAAE;MACd,MAAM,IAAIvE,iBAAQ,CAAC,wBAAwB,EAAE,GAAG,EAAE,mBAAmB,CAAC;IACxE;IACA,IAAI,CAACJ,GAAG,CAACuB,IAAI,EAAEiD,WAAW,EAAE;MAC1B,MAAM,IAAIpE,iBAAQ,CAChB,8BAA8B,EAC9B,GAAG,EACH,qBACF,CAAC;IACH;IAEA,MAAMwE,KAAK,GAAG,MAAMvG,KAAK,CAACwG,YAAY,CAAC;MACrCvD,MAAM,EAAEtB,GAAG,CAACuB,IAAI,CAACD,MAAM;MACvBE,cAAc,EAAE,IAAAC,aAAE,EAAC,CAAC;MACpB+C,WAAW,EAAExE,GAAG,CAACuB,IAAI,EAAEiD;IACzB,CAAC,CAAC;IACF,MAAMV,KAAK,GAAGgB,QAAQ,CAACH,SAAS,CAAC;IACjC,IAAIb,KAAK,IAAIc,KAAK,EAAEG,WAAW,EAAEC,MAAM,EAAE;MACvC,MAAM,IAAI5E,iBAAQ,CAAC,qBAAqB,EAAE,GAAG,EAAE,kBAAkB,CAAC;IACpE;IACA,MAAM;MAAE6E;IAAU,CAAC,GAAGL,KAAK,EAAEG,WAAW,CAACjB,KAAK,CAAC;IAC/C,IAAI,CAAC9D,GAAG,CAACK,MAAM,EAAEC,MAAM,EAAE;MACvB,MAAM,IAAIF,iBAAQ,CAAC,oBAAoB,EAAE,GAAG,EAAE,gBAAgB,CAAC;IACjE;IACA,MAAMG,IAAI,GAAG,MAAMC,aAAK,CAACC,OAAO,CAAC;MAAEC,GAAG,EAAEV,GAAG,CAACK,MAAM,EAAEC;IAAO,CAAC,CAAC,CAC1DK,QAAQ,CAAC,OAAO,CAAC,CACjBA,QAAQ,CAAC,UAAU,CAAC;IACvB,IAAI,CAACJ,IAAI,EAAE;MACT,MAAM,IAAIH,iBAAQ,CAAC,gBAAgB,EAAE,GAAG,EAAE,cAAc,CAAC;IAC3D;IACA,IAAIG,IAAI,EAAEK,SAAS,EAAE;MACnB,MAAM,IAAIR,iBAAQ,CAAC,mBAAmB,EAAE,GAAG,EAAE,eAAe,CAAC;IAC/D;IAEA,MAAMU,SAAS,GAAGP,IAAI,CAACQ,QAAQ,CAC5BC,GAAG,CAAEC,OAAO,IAAKA,OAAO,CAACC,KAAK,CAAC,CAC/BC,MAAM,CAAC,CAAChC,CAAC,EAAEiC,CAAC,KAAKjC,CAAC,GAAGiC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;;IAE/B,MAAMlB,IAAI,GAAG;MACX+E,SAAS;MACTT,WAAW,EAAExE,GAAG,CAACuB,IAAI,EAAEiD;IACzB,CAAC;IAED,MAAMnD,IAAI,GAAG;MACXC,MAAM,EAAEtB,GAAG,CAACuB,IAAI,CAACD,MAAM;MACvBE,cAAc,EAAE,IAAAC,aAAE,EAAC,CAAC;MACpBP,KAAK,EAAEJ,SAAS;MAChBA,SAAS,EAAEA,SAAS;MACpBY,QAAQ,EAAEC,gBAAO,CAACC,QAAQ,CAACC,GAAG;MAC9BC,YAAY,EAAE,GAAG;MACjBC,QAAQ,EAAEC,MAAM,CAACzB,IAAI,EAAEG,GAAG,CAAC;MAC3BuB,cAAc,EAAEN,gBAAO,CAACO,eAAe,CAACC,GAAG;MAC3CC,YAAY,EAAET,gBAAO,CAACU,aAAa,CAACC,OAAO;MAC3CC,WAAW,EAAErC,IAAI;MACjBsC,KAAK,EAAE;QACLf,EAAE,EAAEO,MAAM,CAAChC,GAAG,CAACuB,IAAI,CAACb,GAAG,CAAC;QACxB+B,IAAI,EAAEzC,GAAG,CAACuB,IAAI,EAAEkB,IAAI;QACpBC,OAAO,EAAE1C,GAAG,CAACuB,IAAI,EAAEmB,OAAO;QAC1BC,SAAS,EAAE3C,GAAG,CAACuB,IAAI,EAAEqB,WAAW;QAChCC,KAAK,EAAE7C,GAAG,CAACuB,IAAI,EAAEsB,KAAK;QACtBC,cAAc,EAAE9C,GAAG,CAACuB,IAAI,EAAEuB,cAAc;QACxCC,aAAa,EAAE,IAAAC,eAAM,EAAChD,GAAG,CAACuB,IAAI,EAAE0B,SAAS,CAAC,CAACC,MAAM,CAC/C,qBACF,CAAC;QAAE;QACHC,gBAAgB,EAAE,IAAAH,eAAM,EAAChD,GAAG,CAACuB,IAAI,EAAE0B,SAAS,CAAC,CAACC,MAAM,CAClD,qBACF,CAAC;QACDE,mBAAmB,EAAEpD,GAAG,CAACuB,IAAI,EAAE8B,OAAO;QACtCC,EAAE,EAAEtD,GAAG,CAACuB,IAAI,EAAE+B,EAAE;QAChBC,IAAI,EAAEvD,GAAG,CAACuB,IAAI,EAAEgC,IAAI;QACpBC,OAAO,EAAExD,GAAG,CAACuB,IAAI,EAAEiC,OAAO;QAC1BC,OAAO,EAAEzD,GAAG,CAACuB,IAAI,EAAEkC;MACrB,CAAC;MACDC,eAAe,EAAE;QACfC,WAAW,EAAE3D,GAAG,CAACuB,IAAI,EAAEkB,IAAI,GAAG,EAAE,GAAGzC,GAAG,CAACuB,IAAI,EAAEmB,OAAO;QACpDa,IAAI,EAAEvD,GAAG,CAACuB,IAAI,EAAEgC,IAAI;QACpBC,OAAO,EAAExD,GAAG,CAACuB,IAAI,EAAEiC,OAAO;QAC1BH,OAAO,EAAErD,GAAG,CAACuB,IAAI,EAAE8B,OAAO;QAC1BI,OAAO,EAAEzD,GAAG,CAACuB,IAAI,EAAEkC;MACrB,CAAC;MACDG,cAAc,EAAE;QACdD,WAAW,EAAE3D,GAAG,CAACuB,IAAI,EAAEkB,IAAI,GAAG,EAAE,GAAGzC,GAAG,CAACuB,IAAI,EAAEmB,OAAO;QACpDa,IAAI,EAAEvD,GAAG,CAACuB,IAAI,EAAEgC,IAAI;QACpBC,OAAO,EAAExD,GAAG,CAACuB,IAAI,EAAEiC,OAAO;QAC1BH,OAAO,EAAErD,GAAG,CAACuB,IAAI,EAAE8B,OAAO;QAC1BI,OAAO,EAAEzD,GAAG,CAACuB,IAAI,EAAEkC;MACrB,CAAC;MACDI,WAAW,EAAEtD,IAAI,CAACQ,QAAQ,CAACC,GAAG,CAAC,CAACC,OAAO,EAAE6C,KAAK,KAAK;QACjD,OAAO;UACLrC,EAAE,EAAEO,MAAM,CAACf,OAAO,EAAEP,GAAG,CAAC;UACxB+B,IAAI,EAAExB,OAAO,EAAEwB,IAAI;UACnBsB,SAAS,EAAE9C,OAAO,CAAC+C,UAAU,CAAC,CAAC,CAAC;UAChCC,SAAS,EAAEhD,OAAO,CAAC+C,UAAU,CAAC,CAAC,CAAC;UAChCE,QAAQ,EAAEvC,gBAAO,CAACwC,gBAAgB,CAAClD,OAAO,EAAEiD,QAAQ,CAAC;UACrDhD,KAAK,EAAED,OAAO,EAAEC;QAClB,CAAC;MACH,CAAC;IACH,CAAC;IAED,IAAIkD,MAAM,GAAG,MAAMjG,QAAQ,CAACkG,aAAa,CAAChD,IAAI,CAAC;IAC/C,MAAM,IAAAiD,0BAAe,EAACF,MAAM,CAAC;IAC7BnE,GAAG,CAACsE,IAAI,CAACH,MAAM,CAAC;EAClB,CACF,CAAC;EAEDvE,MAAM,CAACC,IAAI,CACT,8CAA8C,EAC9CC,gBAAO,EACP,OAAOC,GAAG,EAAEC,GAAG,KAAK;IAClB,IAAI;MAAEgF;IAAU,CAAC,GAAGjF,GAAG,CAACG,IAAI;IAC5B,IAAI,CAAC8E,SAAS,EAAE;MACd,MAAM,IAAI7E,iBAAQ,CAAC,wBAAwB,EAAE,GAAG,EAAE,mBAAmB,CAAC;IACxE;IACA,IAAI,CAACJ,GAAG,CAACuB,IAAI,EAAEiD,WAAW,EAAE;MAC1B,MAAM,IAAIpE,iBAAQ,CAChB,8BAA8B,EAC9B,GAAG,EACH,qBACF,CAAC;IACH;IAEA,IAAI,CAACJ,GAAG,CAACK,MAAM,EAAEC,MAAM,EAAE;MACvB,MAAM,IAAIF,iBAAQ,CAAC,oBAAoB,EAAE,GAAG,EAAE,gBAAgB,CAAC;IACjE;IACA,MAAMG,IAAI,GAAG,MAAMC,aAAK,CAACC,OAAO,CAAC;MAAEC,GAAG,EAAEV,GAAG,CAACK,MAAM,EAAEC;IAAO,CAAC,CAAC,CAC1DK,QAAQ,CAAC,OAAO,CAAC,CACjBA,QAAQ,CAAC,UAAU,CAAC;IACvB,IAAI,CAACJ,IAAI,EAAE;MACT,MAAM,IAAIH,iBAAQ,CAAC,gBAAgB,EAAE,GAAG,EAAE,cAAc,CAAC;IAC3D;IACA,IAAIG,IAAI,EAAEK,SAAS,EAAE;MACnB,MAAM,IAAIR,iBAAQ,CAAC,mBAAmB,EAAE,GAAG,EAAE,eAAe,CAAC;IAC/D;IAEA,MAAMU,SAAS,GAAGP,IAAI,CAACQ,QAAQ,CAC5BC,GAAG,CAAEC,OAAO,IAAKA,OAAO,CAACC,KAAK,CAAC,CAC/BC,MAAM,CAAC,CAAChC,CAAC,EAAEiC,CAAC,KAAKjC,CAAC,GAAGiC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;;IAE/B,MAAMlB,IAAI,GAAG;MACX+E,SAAS;MACTT,WAAW,EAAExE,GAAG,CAACuB,IAAI,EAAEiD;IACzB,CAAC;IAED,MAAMnD,IAAI,GAAG;MACXC,MAAM,EAAEtB,GAAG,CAACuB,IAAI,CAACD,MAAM;MACvBE,cAAc,EAAE,IAAAC,aAAE,EAAC,CAAC;MACpBP,KAAK,EAAEJ,SAAS;MAChBA,SAAS,EAAEA,SAAS;MACpBY,QAAQ,EAAEC,gBAAO,CAACC,QAAQ,CAACC,GAAG;MAC9BC,YAAY,EAAE,GAAG;MACjBC,QAAQ,EAAEC,MAAM,CAACzB,IAAI,EAAEG,GAAG,CAAC;MAC3BuB,cAAc,EAAEN,gBAAO,CAACO,eAAe,CAACC,GAAG;MAC3CC,YAAY,EAAET,gBAAO,CAACU,aAAa,CAACC,OAAO;MAC3CC,WAAW,EAAErC,IAAI;MACjBsC,KAAK,EAAE;QACLf,EAAE,EAAEO,MAAM,CAAChC,GAAG,CAACuB,IAAI,CAACb,GAAG,CAAC;QACxB+B,IAAI,EAAEzC,GAAG,CAACuB,IAAI,EAAEkB,IAAI;QACpBC,OAAO,EAAE1C,GAAG,CAACuB,IAAI,EAAEmB,OAAO;QAC1BC,SAAS,EAAE3C,GAAG,CAACuB,IAAI,EAAEqB,WAAW;QAChCC,KAAK,EAAE7C,GAAG,CAACuB,IAAI,EAAEsB,KAAK;QACtBC,cAAc,EAAE9C,GAAG,CAACuB,IAAI,EAAEuB,cAAc;QACxCC,aAAa,EAAE,IAAAC,eAAM,EAAChD,GAAG,CAACuB,IAAI,EAAE0B,SAAS,CAAC,CAACC,MAAM,CAC/C,qBACF,CAAC;QAAE;QACHC,gBAAgB,EAAE,IAAAH,eAAM,EAAChD,GAAG,CAACuB,IAAI,EAAE0B,SAAS,CAAC,CAACC,MAAM,CAClD,qBACF,CAAC;QACDE,mBAAmB,EAAEpD,GAAG,CAACuB,IAAI,EAAE8B,OAAO;QACtCC,EAAE,EAAEtD,GAAG,CAACuB,IAAI,EAAE+B,EAAE;QAChBC,IAAI,EAAEvD,GAAG,CAACuB,IAAI,EAAEgC,IAAI;QACpBC,OAAO,EAAExD,GAAG,CAACuB,IAAI,EAAEiC,OAAO;QAC1BC,OAAO,EAAEzD,GAAG,CAACuB,IAAI,EAAEkC;MACrB,CAAC;MACDC,eAAe,EAAE;QACfC,WAAW,EAAE3D,GAAG,CAACuB,IAAI,EAAEkB,IAAI,GAAG,EAAE,GAAGzC,GAAG,CAACuB,IAAI,EAAEmB,OAAO;QACpDa,IAAI,EAAEvD,GAAG,CAACuB,IAAI,EAAEgC,IAAI;QACpBC,OAAO,EAAExD,GAAG,CAACuB,IAAI,EAAEiC,OAAO;QAC1BH,OAAO,EAAErD,GAAG,CAACuB,IAAI,EAAE8B,OAAO;QAC1BI,OAAO,EAAEzD,GAAG,CAACuB,IAAI,EAAEkC;MACrB,CAAC;MACDG,cAAc,EAAE;QACdD,WAAW,EAAE3D,GAAG,CAACuB,IAAI,EAAEkB,IAAI,GAAG,EAAE,GAAGzC,GAAG,CAACuB,IAAI,EAAEmB,OAAO;QACpDa,IAAI,EAAEvD,GAAG,CAACuB,IAAI,EAAEgC,IAAI;QACpBC,OAAO,EAAExD,GAAG,CAACuB,IAAI,EAAEiC,OAAO;QAC1BH,OAAO,EAAErD,GAAG,CAACuB,IAAI,EAAE8B,OAAO;QAC1BI,OAAO,EAAEzD,GAAG,CAACuB,IAAI,EAAEkC;MACrB,CAAC;MACDI,WAAW,EAAEtD,IAAI,CAACQ,QAAQ,CAACC,GAAG,CAAC,CAACC,OAAO,EAAE6C,KAAK,KAAK;QACjD,OAAO;UACLrC,EAAE,EAAEO,MAAM,CAACf,OAAO,EAAEP,GAAG,CAAC;UACxB+B,IAAI,EAAExB,OAAO,EAAEwB,IAAI;UACnBsB,SAAS,EAAE9C,OAAO,CAAC+C,UAAU,CAAC,CAAC,CAAC;UAChCC,SAAS,EAAEhD,OAAO,CAAC+C,UAAU,CAAC,CAAC,CAAC;UAChCE,QAAQ,EAAEvC,gBAAO,CAACwC,gBAAgB,CAAClD,OAAO,EAAEiD,QAAQ,CAAC;UACrDhD,KAAK,EAAED,OAAO,EAAEC;QAClB,CAAC;MACH,CAAC;IACH,CAAC;IAED,IAAIkD,MAAM,GAAG,MAAMjG,QAAQ,CAACkG,aAAa,CAAChD,IAAI,CAAC;IAC/C,MAAM,IAAAiD,0BAAe,EAACF,MAAM,CAAC;IAC7BnE,GAAG,CAACsE,IAAI,CAACH,MAAM,CAAC;EAClB,CACF,CAAC;AACH,CAAC;AAAAc,OAAA,CAAApG,OAAA,GAAAc,QAAA","ignoreList":[]}},"mtime":1723544810375},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/Payments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _moment = _interopRequireDefault(require(\"moment\"));\nvar _iyzipay = _interopRequireDefault(require(\"iyzipay\"));\nvar _cart = _interopRequireDefault(require(\"../db/cart\"));\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nvar Payments = _interopRequireWildcard(require(\"../services/iyzico/methods/payments\"));\nvar Cards = _interopRequireWildcard(require(\"../services/iyzico/methods/cards\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nvar _payments2 = require(\"../utils/payments\");\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function (e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = router => {\n  //yeni bir kartla ödeme oluştur ve kartı kaydetme\n  router.post(\"/payments/:cartId/with-new-card\", _Session.default, async (req, res) => {\n    const {\n      card\n    } = req.body;\n    if (!card) {\n      throw new _ApiError.default(\"Card is required\", 400, \"cardRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _cart.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    card.registerCard = \"0\"; //methodslarda registerCard:1 yani kartı kaydet demek ama şuan kaydetme dediğim için 0 yaptım\n\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    let result = await Payments.createPayment(data);\n    await (0, _payments2.CompletePayment)(result);\n    res.json(result);\n  });\n\n  //yeni bir ödeme oluştur ve kart kaydet\n  router.post(\"/payments/:cartId/with-new-card/register-card\", _Session.default, async (req, res) => {\n    const {\n      card\n    } = req.body;\n    if (!card) {\n      throw new _ApiError.default(\"Card is required\", 400, \"cardRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _cart.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    if (req.user?.cardUserKey) {\n      card.cardUserKey = req.user?.cardUserKey;\n    }\n    card.registerCard = \"1\"; //methodslarda registerCard:1 yani kartı kaydet\n\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    let result = await Payments.createPayment(data);\n    if (req.user?.cardUserKey) {\n      const user = await _users.default.findOne({\n        _id: req.user?._id\n      });\n      user.cardUserKey = result?.cardUserKey;\n      await user.save();\n    }\n    await (0, _payments2.CompletePayment)(result);\n    res.json(result);\n  });\n\n  //hali hazırda bulunan kart ile ödeme\n  router.post(\"/payments/:cartId/:cardIndex/with-registered-card-index\", _Session.default, async (req, res) => {\n    let {\n      cardIndex\n    } = req.params;\n    if (!cardIndex) {\n      throw new _ApiError.default(\"Card index is required\", 400, \"cardIndexRequired\");\n    }\n    if (!req.user?.cardUserKey) {\n      throw new _ApiError.default(\"No registered card available\", 400, \"cardUserKeyRequired\");\n    }\n    const cards = await Cards.getUserCards({\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      cardUserKey: req.user?.cardUserKey\n    });\n    const index = parseInt(cardIndex);\n    if (index >= cards?.cardDetails?.length) {\n      throw new _ApiError.default(\"Card does not exist\", 400, \"cardIndexInvalid\");\n    }\n    const {\n      cardToken\n    } = cards?.cardDetails[index];\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _cart.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const card = {\n      cardToken,\n      cardUserKey: req.user?.cardUserKey\n    };\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    let result = await Payments.createPayment(data);\n    await (0, _payments2.CompletePayment)(result);\n    res.json(result);\n  });\n  router.post(\"/payments/:cartId/with-registered-card-token\", _Session.default, async (req, res) => {\n    let {\n      cardToken\n    } = req.body;\n    if (!cardToken) {\n      throw new _ApiError.default(\"Card Token is required\", 400, \"cardTokenRequired\");\n    }\n    if (!req.user?.cardUserKey) {\n      throw new _ApiError.default(\"No registered card available\", 400, \"cardUserKeyRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _cart.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const card = {\n      cardToken,\n      cardUserKey: req.user?.cardUserKey\n    };\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    let result = await Payments.createPayment(data);\n    await (0, _payments2.CompletePayment)(result);\n    res.json(result);\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9tZW50IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfaXl6aXBheSIsIl9jYXJ0IiwiX3VzZXJzIiwiX0FwaUVycm9yIiwiX1Nlc3Npb24iLCJQYXltZW50cyIsIl9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkIiwiQ2FyZHMiLCJfdXVpZCIsIl9wYXltZW50czIiLCJfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUiLCJlIiwiV2Vha01hcCIsInIiLCJ0IiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJoYXMiLCJnZXQiLCJuIiwiX19wcm90b19fIiwiYSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwidSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImkiLCJzZXQiLCJfZGVmYXVsdCIsInJvdXRlciIsInBvc3QiLCJTZXNzaW9uIiwicmVxIiwicmVzIiwiY2FyZCIsImJvZHkiLCJBcGlFcnJvciIsInBhcmFtcyIsImNhcnRJZCIsImNhcnQiLCJDYXJ0cyIsImZpbmRPbmUiLCJfaWQiLCJwb3B1bGF0ZSIsImNvbXBsZXRlZCIsInJlZ2lzdGVyQ2FyZCIsInBhaWRQcmljZSIsInByb2R1Y3RzIiwibWFwIiwicHJvZHVjdCIsInByaWNlIiwicmVkdWNlIiwiYiIsImRhdGEiLCJsb2NhbGUiLCJ1c2VyIiwiY29udmVyc2F0aW9uSWQiLCJpZCIsImN1cnJlbmN5IiwiSXl6aXBheSIsIkNVUlJFTkNZIiwiVFJZIiwiaW5zdGFsbG1lbnRzIiwiYmFza2V0SWQiLCJTdHJpbmciLCJwYXltZW50Q2hhbm5lbCIsIlBBWU1FTlRfQ0hBTk5FTCIsIldFQiIsInBheW1lbnRHcm91cCIsIlBBWU1FTlRfR1JPVVAiLCJQUk9EVUNUIiwicGF5bWVudENhcmQiLCJidXllciIsIm5hbWUiLCJzdXJuYW1lIiwiZ3NtTnVtYmVyIiwicGhvbmVOdW1iZXIiLCJlbWFpbCIsImlkZW50aXR5TnVtYmVyIiwibGFzdExvZ2luRGF0ZSIsIm1vbWVudCIsInVwZGF0ZWRBdCIsImZvcm1hdCIsInJlZ2lzdHJhdGlvbkRhdGUiLCJyZWdpc3RyYXRpb25BZGRyZXNzIiwiYWRkcmVzcyIsImlwIiwiY2l0eSIsImNvdW50cnkiLCJ6aXBDb2RlIiwic2hpcHBpbmdBZGRyZXNzIiwiY29udGFjdE5hbWUiLCJiaWxsaW5nQWRkcmVzcyIsImJhc2tldEl0ZW1zIiwiaW5kZXgiLCJjYXRlZ29yeTEiLCJjYXRlZ29yaWVzIiwiY2F0ZWdvcnkyIiwiaXRlbVR5cGUiLCJCQVNLRVRfSVRFTV9UWVBFIiwicmVzdWx0IiwiY3JlYXRlUGF5bWVudCIsIkNvbXBsZXRlUGF5bWVudCIsImpzb24iLCJjYXJkVXNlcktleSIsIlVzZXJzIiwic2F2ZSIsImNhcmRJbmRleCIsImNhcmRzIiwiZ2V0VXNlckNhcmRzIiwicGFyc2VJbnQiLCJjYXJkRGV0YWlscyIsImxlbmd0aCIsImNhcmRUb2tlbiIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9yb3V0ZXMvIiwic291cmNlcyI6WyJQYXltZW50cy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9tZW50IGZyb20gXCJtb21lbnRcIjtcbmltcG9ydCBJeXppcGF5IGZyb20gXCJpeXppcGF5XCI7XG5pbXBvcnQgQ2FydHMgZnJvbSBcIi4uL2RiL2NhcnRcIjtcbmltcG9ydCBVc2VycyBmcm9tIFwiLi4vZGIvdXNlcnNcIjtcbmltcG9ydCBBcGlFcnJvciBmcm9tIFwiLi4vZXJyb3JzL0FwaUVycm9yXCI7XG5pbXBvcnQgU2Vzc2lvbiBmcm9tIFwiLi4vbWlkZGxld2FyZXMvU2Vzc2lvblwiO1xuaW1wb3J0ICogYXMgUGF5bWVudHMgZnJvbSBcIi4uL3NlcnZpY2VzL2l5emljby9tZXRob2RzL3BheW1lbnRzXCI7XG5pbXBvcnQgKiBhcyBDYXJkcyBmcm9tIFwiLi4vc2VydmljZXMvaXl6aWNvL21ldGhvZHMvY2FyZHNcIjtcbmltcG9ydCBpZCBmcm9tIFwiLi4vdXRpbHMvdXVpZFwiO1xuaW1wb3J0IHsgQ29tcGxldGVQYXltZW50IH0gZnJvbSBcIi4uL3V0aWxzL3BheW1lbnRzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IChyb3V0ZXIpID0+IHtcbiAgLy95ZW5pIGJpciBrYXJ0bGEgw7ZkZW1lIG9sdcWfdHVyIHZlIGthcnTEsSBrYXlkZXRtZVxuICByb3V0ZXIucG9zdChcIi9wYXltZW50cy86Y2FydElkL3dpdGgtbmV3LWNhcmRcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyBjYXJkIH0gPSByZXEuYm9keTtcbiAgICBpZiAoIWNhcmQpIHtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgaXMgcmVxdWlyZWRcIiwgNDAwLCBcImNhcmRSZXF1aXJlZFwiKTtcbiAgICB9XG4gICAgaWYgKCFyZXEucGFyYW1zPy5jYXJ0SWQpIHtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnRJRCBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FydElkUmVxdWlyZWRcIik7XG4gICAgfVxuICAgIGNvbnN0IGNhcnQgPSBhd2FpdCBDYXJ0cy5maW5kT25lKHsgX2lkOiByZXEucGFyYW1zPy5jYXJ0SWQgfSlcbiAgICAgIC5wb3B1bGF0ZShcImJ1eWVyXCIpXG4gICAgICAucG9wdWxhdGUoXCJwcm9kdWN0c1wiKTtcbiAgICBpZiAoIWNhcnQpIHtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgbm90IGZvdW5kXCIsIDQwNCwgXCJjYXJkTm90Rm91bmRcIik7XG4gICAgfVxuICAgIGlmIChjYXJ0Py5jb21wbGV0ZWQpIHtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgaXMgY29tcGxldGVkXCIsIDQwMCwgXCJjYXJ0Q29tcGxldGVkXCIpO1xuICAgIH1cblxuICAgIGNhcmQucmVnaXN0ZXJDYXJkID0gXCIwXCI7IC8vbWV0aG9kc2xhcmRhIHJlZ2lzdGVyQ2FyZDoxIHlhbmkga2FydMSxIGtheWRldCBkZW1layBhbWEgxZ91YW4ga2F5ZGV0bWUgZGVkacSfaW0gacOnaW4gMCB5YXB0xLFtXG5cbiAgICBjb25zdCBwYWlkUHJpY2UgPSBjYXJ0LnByb2R1Y3RzXG4gICAgICAubWFwKChwcm9kdWN0KSA9PiBwcm9kdWN0LnByaWNlKVxuICAgICAgLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApOyAvL8O2ZGVuZWNlayBtaWt0YXJsYXLEsW4gdG9wbGFtxLFcblxuICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICBsb2NhbGU6IHJlcS51c2VyLmxvY2FsZSxcbiAgICAgIGNvbnZlcnNhdGlvbklkOiBpZCgpLFxuICAgICAgcHJpY2U6IHBhaWRQcmljZSxcbiAgICAgIHBhaWRQcmljZTogcGFpZFByaWNlLFxuICAgICAgY3VycmVuY3k6IEl5emlwYXkuQ1VSUkVOQ1kuVFJZLFxuICAgICAgaW5zdGFsbG1lbnRzOiBcIjFcIixcbiAgICAgIGJhc2tldElkOiBTdHJpbmcoY2FydD8uX2lkKSxcbiAgICAgIHBheW1lbnRDaGFubmVsOiBJeXppcGF5LlBBWU1FTlRfQ0hBTk5FTC5XRUIsXG4gICAgICBwYXltZW50R3JvdXA6IEl5emlwYXkuUEFZTUVOVF9HUk9VUC5QUk9EVUNULFxuICAgICAgcGF5bWVudENhcmQ6IGNhcmQsXG4gICAgICBidXllcjoge1xuICAgICAgICBpZDogU3RyaW5nKHJlcS51c2VyLl9pZCksXG4gICAgICAgIG5hbWU6IHJlcS51c2VyPy5uYW1lLFxuICAgICAgICBzdXJuYW1lOiByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgZ3NtTnVtYmVyOiByZXEudXNlcj8ucGhvbmVOdW1iZXIsXG4gICAgICAgIGVtYWlsOiByZXEudXNlcj8uZW1haWwsXG4gICAgICAgIGlkZW50aXR5TnVtYmVyOiByZXEudXNlcj8uaWRlbnRpdHlOdW1iZXIsXG4gICAgICAgIGxhc3RMb2dpbkRhdGU6IG1vbWVudChyZXEudXNlcj8udXBkYXRlZEF0KS5mb3JtYXQoXG4gICAgICAgICAgXCJZWVlZLU1NLUREIEhIOm1tOnNzXCJcbiAgICAgICAgKSwgLy9peWl6cGF5IHRhcmloIGZvcm1hdMSxbmEgw6dldmlybWVrIGnDp2luIHlhcMSxbGTEsVxuICAgICAgICByZWdpc3RyYXRpb25EYXRlOiBtb21lbnQocmVxLnVzZXI/LnVwZGF0ZWRBdCkuZm9ybWF0KFxuICAgICAgICAgIFwiWVlZWS1NTS1ERCBISDptbTpzc1wiXG4gICAgICAgICksXG4gICAgICAgIHJlZ2lzdHJhdGlvbkFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICBpcDogcmVxLnVzZXI/LmlwLFxuICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgfSxcbiAgICAgIHNoaXBwaW5nQWRkcmVzczoge1xuICAgICAgICBjb250YWN0TmFtZTogcmVxLnVzZXI/Lm5hbWUgKyBcIlwiICsgcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgYWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgfSxcbiAgICAgIGJpbGxpbmdBZGRyZXNzOiB7XG4gICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiXCIgKyByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICBhZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICB9LFxuICAgICAgYmFza2V0SXRlbXM6IGNhcnQucHJvZHVjdHMubWFwKChwcm9kdWN0LCBpbmRleCkgPT4ge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGlkOiBTdHJpbmcocHJvZHVjdD8uX2lkKSxcbiAgICAgICAgICBuYW1lOiBwcm9kdWN0Py5uYW1lLFxuICAgICAgICAgIGNhdGVnb3J5MTogcHJvZHVjdC5jYXRlZ29yaWVzWzBdLFxuICAgICAgICAgIGNhdGVnb3J5MjogcHJvZHVjdC5jYXRlZ29yaWVzWzFdLFxuICAgICAgICAgIGl0ZW1UeXBlOiBJeXppcGF5LkJBU0tFVF9JVEVNX1RZUEVbcHJvZHVjdD8uaXRlbVR5cGVdLFxuICAgICAgICAgIHByaWNlOiBwcm9kdWN0Py5wcmljZSxcbiAgICAgICAgfTtcbiAgICAgIH0pLFxuICAgIH07XG5cbiAgICBsZXQgcmVzdWx0ID0gYXdhaXQgUGF5bWVudHMuY3JlYXRlUGF5bWVudChkYXRhKTtcbiAgICBhd2FpdCBDb21wbGV0ZVBheW1lbnQocmVzdWx0KTtcbiAgICByZXMuanNvbihyZXN1bHQpO1xuICB9KTtcblxuICAvL3llbmkgYmlyIMO2ZGVtZSBvbHXFn3R1ciB2ZSBrYXJ0IGtheWRldFxuICByb3V0ZXIucG9zdChcbiAgICBcIi9wYXltZW50cy86Y2FydElkL3dpdGgtbmV3LWNhcmQvcmVnaXN0ZXItY2FyZFwiLFxuICAgIFNlc3Npb24sXG4gICAgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgICBjb25zdCB7IGNhcmQgfSA9IHJlcS5ib2R5O1xuICAgICAgaWYgKCFjYXJkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgaXMgcmVxdWlyZWRcIiwgNDAwLCBcImNhcmRSZXF1aXJlZFwiKTtcbiAgICAgIH1cbiAgICAgIGlmICghcmVxLnBhcmFtcz8uY2FydElkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnRJRCBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FydElkUmVxdWlyZWRcIik7XG4gICAgICB9XG4gICAgICBjb25zdCBjYXJ0ID0gYXdhaXQgQ2FydHMuZmluZE9uZSh7IF9pZDogcmVxLnBhcmFtcz8uY2FydElkIH0pXG4gICAgICAgIC5wb3B1bGF0ZShcImJ1eWVyXCIpXG4gICAgICAgIC5wb3B1bGF0ZShcInByb2R1Y3RzXCIpO1xuICAgICAgaWYgKCFjYXJ0KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgbm90IGZvdW5kXCIsIDQwNCwgXCJjYXJkTm90Rm91bmRcIik7XG4gICAgICB9XG4gICAgICBpZiAoY2FydD8uY29tcGxldGVkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgaXMgY29tcGxldGVkXCIsIDQwMCwgXCJjYXJ0Q29tcGxldGVkXCIpO1xuICAgICAgfVxuXG4gICAgICBpZiAocmVxLnVzZXI/LmNhcmRVc2VyS2V5KSB7XG4gICAgICAgIGNhcmQuY2FyZFVzZXJLZXkgPSByZXEudXNlcj8uY2FyZFVzZXJLZXk7XG4gICAgICB9XG4gICAgICBjYXJkLnJlZ2lzdGVyQ2FyZCA9IFwiMVwiOyAvL21ldGhvZHNsYXJkYSByZWdpc3RlckNhcmQ6MSB5YW5pIGthcnTEsSBrYXlkZXRcblxuICAgICAgY29uc3QgcGFpZFByaWNlID0gY2FydC5wcm9kdWN0c1xuICAgICAgICAubWFwKChwcm9kdWN0KSA9PiBwcm9kdWN0LnByaWNlKVxuICAgICAgICAucmVkdWNlKChhLCBiKSA9PiBhICsgYiwgMCk7IC8vw7ZkZW5lY2VrIG1pa3RhcmxhcsSxbiB0b3BsYW3EsVxuXG4gICAgICBjb25zdCBkYXRhID0ge1xuICAgICAgICBsb2NhbGU6IHJlcS51c2VyLmxvY2FsZSxcbiAgICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICAgIHByaWNlOiBwYWlkUHJpY2UsXG4gICAgICAgIHBhaWRQcmljZTogcGFpZFByaWNlLFxuICAgICAgICBjdXJyZW5jeTogSXl6aXBheS5DVVJSRU5DWS5UUlksXG4gICAgICAgIGluc3RhbGxtZW50czogXCIxXCIsXG4gICAgICAgIGJhc2tldElkOiBTdHJpbmcoY2FydD8uX2lkKSxcbiAgICAgICAgcGF5bWVudENoYW5uZWw6IEl5emlwYXkuUEFZTUVOVF9DSEFOTkVMLldFQixcbiAgICAgICAgcGF5bWVudEdyb3VwOiBJeXppcGF5LlBBWU1FTlRfR1JPVVAuUFJPRFVDVCxcbiAgICAgICAgcGF5bWVudENhcmQ6IGNhcmQsXG4gICAgICAgIGJ1eWVyOiB7XG4gICAgICAgICAgaWQ6IFN0cmluZyhyZXEudXNlci5faWQpLFxuICAgICAgICAgIG5hbWU6IHJlcS51c2VyPy5uYW1lLFxuICAgICAgICAgIHN1cm5hbWU6IHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICAgIGdzbU51bWJlcjogcmVxLnVzZXI/LnBob25lTnVtYmVyLFxuICAgICAgICAgIGVtYWlsOiByZXEudXNlcj8uZW1haWwsXG4gICAgICAgICAgaWRlbnRpdHlOdW1iZXI6IHJlcS51c2VyPy5pZGVudGl0eU51bWJlcixcbiAgICAgICAgICBsYXN0TG9naW5EYXRlOiBtb21lbnQocmVxLnVzZXI/LnVwZGF0ZWRBdCkuZm9ybWF0KFxuICAgICAgICAgICAgXCJZWVlZLU1NLUREIEhIOm1tOnNzXCJcbiAgICAgICAgICApLCAvL2l5aXpwYXkgdGFyaWggZm9ybWF0xLFuYSDDp2V2aXJtZWsgacOnaW4geWFwxLFsZMSxXG4gICAgICAgICAgcmVnaXN0cmF0aW9uRGF0ZTogbW9tZW50KHJlcS51c2VyPy51cGRhdGVkQXQpLmZvcm1hdChcbiAgICAgICAgICAgIFwiWVlZWS1NTS1ERCBISDptbTpzc1wiXG4gICAgICAgICAgKSxcbiAgICAgICAgICByZWdpc3RyYXRpb25BZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICBpcDogcmVxLnVzZXI/LmlwLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBzaGlwcGluZ0FkZHJlc3M6IHtcbiAgICAgICAgICBjb250YWN0TmFtZTogcmVxLnVzZXI/Lm5hbWUgKyBcIlwiICsgcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgYWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIGJpbGxpbmdBZGRyZXNzOiB7XG4gICAgICAgICAgY29udGFjdE5hbWU6IHJlcS51c2VyPy5uYW1lICsgXCJcIiArIHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIGFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBiYXNrZXRJdGVtczogY2FydC5wcm9kdWN0cy5tYXAoKHByb2R1Y3QsIGluZGV4KSA9PiB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlkOiBTdHJpbmcocHJvZHVjdD8uX2lkKSxcbiAgICAgICAgICAgIG5hbWU6IHByb2R1Y3Q/Lm5hbWUsXG4gICAgICAgICAgICBjYXRlZ29yeTE6IHByb2R1Y3QuY2F0ZWdvcmllc1swXSxcbiAgICAgICAgICAgIGNhdGVnb3J5MjogcHJvZHVjdC5jYXRlZ29yaWVzWzFdLFxuICAgICAgICAgICAgaXRlbVR5cGU6IEl5emlwYXkuQkFTS0VUX0lURU1fVFlQRVtwcm9kdWN0Py5pdGVtVHlwZV0sXG4gICAgICAgICAgICBwcmljZTogcHJvZHVjdD8ucHJpY2UsXG4gICAgICAgICAgfTtcbiAgICAgICAgfSksXG4gICAgICB9O1xuXG4gICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgUGF5bWVudHMuY3JlYXRlUGF5bWVudChkYXRhKTtcbiAgICAgIGlmIChyZXEudXNlcj8uY2FyZFVzZXJLZXkpIHtcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXJzLmZpbmRPbmUoeyBfaWQ6IHJlcS51c2VyPy5faWQgfSk7XG4gICAgICAgIHVzZXIuY2FyZFVzZXJLZXkgPSByZXN1bHQ/LmNhcmRVc2VyS2V5O1xuICAgICAgICBhd2FpdCB1c2VyLnNhdmUoKTtcbiAgICAgIH1cbiAgICAgIGF3YWl0IENvbXBsZXRlUGF5bWVudChyZXN1bHQpO1xuICAgICAgcmVzLmpzb24ocmVzdWx0KTtcbiAgICB9XG4gICk7XG5cbiAgLy9oYWxpIGhhesSxcmRhIGJ1bHVuYW4ga2FydCBpbGUgw7ZkZW1lXG4gIHJvdXRlci5wb3N0KFxuICAgIFwiL3BheW1lbnRzLzpjYXJ0SWQvOmNhcmRJbmRleC93aXRoLXJlZ2lzdGVyZWQtY2FyZC1pbmRleFwiLFxuICAgIFNlc3Npb24sXG4gICAgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgICBsZXQgeyBjYXJkSW5kZXggfSA9IHJlcS5wYXJhbXM7XG4gICAgICBpZiAoIWNhcmRJbmRleCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIGluZGV4IGlzIHJlcXVpcmVkXCIsIDQwMCwgXCJjYXJkSW5kZXhSZXF1aXJlZFwiKTtcbiAgICAgIH1cbiAgICAgIGlmICghcmVxLnVzZXI/LmNhcmRVc2VyS2V5KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgICBcIk5vIHJlZ2lzdGVyZWQgY2FyZCBhdmFpbGFibGVcIixcbiAgICAgICAgICA0MDAsXG4gICAgICAgICAgXCJjYXJkVXNlcktleVJlcXVpcmVkXCJcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgY2FyZHMgPSBhd2FpdCBDYXJkcy5nZXRVc2VyQ2FyZHMoe1xuICAgICAgICBsb2NhbGU6IHJlcS51c2VyLmxvY2FsZSxcbiAgICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICAgIGNhcmRVc2VyS2V5OiByZXEudXNlcj8uY2FyZFVzZXJLZXksXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IGluZGV4ID0gcGFyc2VJbnQoY2FyZEluZGV4KTtcbiAgICAgIGlmIChpbmRleCA+PSBjYXJkcz8uY2FyZERldGFpbHM/Lmxlbmd0aCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIGRvZXMgbm90IGV4aXN0XCIsIDQwMCwgXCJjYXJkSW5kZXhJbnZhbGlkXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBjYXJkVG9rZW4gfSA9IGNhcmRzPy5jYXJkRGV0YWlsc1tpbmRleF07XG4gICAgICBpZiAoIXJlcS5wYXJhbXM/LmNhcnRJZCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJ0SUQgaXMgcmVxdWlyZWRcIiwgNDAwLCBcImNhcnRJZFJlcXVpcmVkXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgY2FydCA9IGF3YWl0IENhcnRzLmZpbmRPbmUoeyBfaWQ6IHJlcS5wYXJhbXM/LmNhcnRJZCB9KVxuICAgICAgICAucG9wdWxhdGUoXCJidXllclwiKVxuICAgICAgICAucG9wdWxhdGUoXCJwcm9kdWN0c1wiKTtcbiAgICAgIGlmICghY2FydCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIG5vdCBmb3VuZFwiLCA0MDQsIFwiY2FyZE5vdEZvdW5kXCIpO1xuICAgICAgfVxuICAgICAgaWYgKGNhcnQ/LmNvbXBsZXRlZCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJ0IGlzIGNvbXBsZXRlZFwiLCA0MDAsIFwiY2FydENvbXBsZXRlZFwiKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcGFpZFByaWNlID0gY2FydC5wcm9kdWN0c1xuICAgICAgICAubWFwKChwcm9kdWN0KSA9PiBwcm9kdWN0LnByaWNlKVxuICAgICAgICAucmVkdWNlKChhLCBiKSA9PiBhICsgYiwgMCk7IC8vw7ZkZW5lY2VrIG1pa3RhcmxhcsSxbiB0b3BsYW3EsVxuXG4gICAgICBjb25zdCBjYXJkID0ge1xuICAgICAgICBjYXJkVG9rZW4sXG4gICAgICAgIGNhcmRVc2VyS2V5OiByZXEudXNlcj8uY2FyZFVzZXJLZXksXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBkYXRhID0ge1xuICAgICAgICBsb2NhbGU6IHJlcS51c2VyLmxvY2FsZSxcbiAgICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICAgIHByaWNlOiBwYWlkUHJpY2UsXG4gICAgICAgIHBhaWRQcmljZTogcGFpZFByaWNlLFxuICAgICAgICBjdXJyZW5jeTogSXl6aXBheS5DVVJSRU5DWS5UUlksXG4gICAgICAgIGluc3RhbGxtZW50czogXCIxXCIsXG4gICAgICAgIGJhc2tldElkOiBTdHJpbmcoY2FydD8uX2lkKSxcbiAgICAgICAgcGF5bWVudENoYW5uZWw6IEl5emlwYXkuUEFZTUVOVF9DSEFOTkVMLldFQixcbiAgICAgICAgcGF5bWVudEdyb3VwOiBJeXppcGF5LlBBWU1FTlRfR1JPVVAuUFJPRFVDVCxcbiAgICAgICAgcGF5bWVudENhcmQ6IGNhcmQsXG4gICAgICAgIGJ1eWVyOiB7XG4gICAgICAgICAgaWQ6IFN0cmluZyhyZXEudXNlci5faWQpLFxuICAgICAgICAgIG5hbWU6IHJlcS51c2VyPy5uYW1lLFxuICAgICAgICAgIHN1cm5hbWU6IHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICAgIGdzbU51bWJlcjogcmVxLnVzZXI/LnBob25lTnVtYmVyLFxuICAgICAgICAgIGVtYWlsOiByZXEudXNlcj8uZW1haWwsXG4gICAgICAgICAgaWRlbnRpdHlOdW1iZXI6IHJlcS51c2VyPy5pZGVudGl0eU51bWJlcixcbiAgICAgICAgICBsYXN0TG9naW5EYXRlOiBtb21lbnQocmVxLnVzZXI/LnVwZGF0ZWRBdCkuZm9ybWF0KFxuICAgICAgICAgICAgXCJZWVlZLU1NLUREIEhIOm1tOnNzXCJcbiAgICAgICAgICApLCAvL2l5aXpwYXkgdGFyaWggZm9ybWF0xLFuYSDDp2V2aXJtZWsgacOnaW4geWFwxLFsZMSxXG4gICAgICAgICAgcmVnaXN0cmF0aW9uRGF0ZTogbW9tZW50KHJlcS51c2VyPy51cGRhdGVkQXQpLmZvcm1hdChcbiAgICAgICAgICAgIFwiWVlZWS1NTS1ERCBISDptbTpzc1wiXG4gICAgICAgICAgKSxcbiAgICAgICAgICByZWdpc3RyYXRpb25BZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICBpcDogcmVxLnVzZXI/LmlwLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBzaGlwcGluZ0FkZHJlc3M6IHtcbiAgICAgICAgICBjb250YWN0TmFtZTogcmVxLnVzZXI/Lm5hbWUgKyBcIlwiICsgcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgYWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIGJpbGxpbmdBZGRyZXNzOiB7XG4gICAgICAgICAgY29udGFjdE5hbWU6IHJlcS51c2VyPy5uYW1lICsgXCJcIiArIHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIGFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBiYXNrZXRJdGVtczogY2FydC5wcm9kdWN0cy5tYXAoKHByb2R1Y3QsIGluZGV4KSA9PiB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlkOiBTdHJpbmcocHJvZHVjdD8uX2lkKSxcbiAgICAgICAgICAgIG5hbWU6IHByb2R1Y3Q/Lm5hbWUsXG4gICAgICAgICAgICBjYXRlZ29yeTE6IHByb2R1Y3QuY2F0ZWdvcmllc1swXSxcbiAgICAgICAgICAgIGNhdGVnb3J5MjogcHJvZHVjdC5jYXRlZ29yaWVzWzFdLFxuICAgICAgICAgICAgaXRlbVR5cGU6IEl5emlwYXkuQkFTS0VUX0lURU1fVFlQRVtwcm9kdWN0Py5pdGVtVHlwZV0sXG4gICAgICAgICAgICBwcmljZTogcHJvZHVjdD8ucHJpY2UsXG4gICAgICAgICAgfTtcbiAgICAgICAgfSksXG4gICAgICB9O1xuXG4gICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgUGF5bWVudHMuY3JlYXRlUGF5bWVudChkYXRhKTtcbiAgICAgIGF3YWl0IENvbXBsZXRlUGF5bWVudChyZXN1bHQpO1xuICAgICAgcmVzLmpzb24ocmVzdWx0KTtcbiAgICB9XG4gICk7XG5cbiAgcm91dGVyLnBvc3QoXG4gICAgXCIvcGF5bWVudHMvOmNhcnRJZC93aXRoLXJlZ2lzdGVyZWQtY2FyZC10b2tlblwiLFxuICAgIFNlc3Npb24sXG4gICAgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgICBsZXQgeyBjYXJkVG9rZW4gfSA9IHJlcS5ib2R5O1xuICAgICAgaWYgKCFjYXJkVG9rZW4pIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FyZCBUb2tlbiBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FyZFRva2VuUmVxdWlyZWRcIik7XG4gICAgICB9XG4gICAgICBpZiAoIXJlcS51c2VyPy5jYXJkVXNlcktleSkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgXCJObyByZWdpc3RlcmVkIGNhcmQgYXZhaWxhYmxlXCIsXG4gICAgICAgICAgNDAwLFxuICAgICAgICAgIFwiY2FyZFVzZXJLZXlSZXF1aXJlZFwiXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGlmICghcmVxLnBhcmFtcz8uY2FydElkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnRJRCBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FydElkUmVxdWlyZWRcIik7XG4gICAgICB9XG4gICAgICBjb25zdCBjYXJ0ID0gYXdhaXQgQ2FydHMuZmluZE9uZSh7IF9pZDogcmVxLnBhcmFtcz8uY2FydElkIH0pXG4gICAgICAgIC5wb3B1bGF0ZShcImJ1eWVyXCIpXG4gICAgICAgIC5wb3B1bGF0ZShcInByb2R1Y3RzXCIpO1xuICAgICAgaWYgKCFjYXJ0KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgbm90IGZvdW5kXCIsIDQwNCwgXCJjYXJkTm90Rm91bmRcIik7XG4gICAgICB9XG4gICAgICBpZiAoY2FydD8uY29tcGxldGVkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgaXMgY29tcGxldGVkXCIsIDQwMCwgXCJjYXJ0Q29tcGxldGVkXCIpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBwYWlkUHJpY2UgPSBjYXJ0LnByb2R1Y3RzXG4gICAgICAgIC5tYXAoKHByb2R1Y3QpID0+IHByb2R1Y3QucHJpY2UpXG4gICAgICAgIC5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiLCAwKTsgLy/DtmRlbmVjZWsgbWlrdGFybGFyxLFuIHRvcGxhbcSxXG5cbiAgICAgIGNvbnN0IGNhcmQgPSB7XG4gICAgICAgIGNhcmRUb2tlbixcbiAgICAgICAgY2FyZFVzZXJLZXk6IHJlcS51c2VyPy5jYXJkVXNlcktleSxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgICBjb252ZXJzYXRpb25JZDogaWQoKSxcbiAgICAgICAgcHJpY2U6IHBhaWRQcmljZSxcbiAgICAgICAgcGFpZFByaWNlOiBwYWlkUHJpY2UsXG4gICAgICAgIGN1cnJlbmN5OiBJeXppcGF5LkNVUlJFTkNZLlRSWSxcbiAgICAgICAgaW5zdGFsbG1lbnRzOiBcIjFcIixcbiAgICAgICAgYmFza2V0SWQ6IFN0cmluZyhjYXJ0Py5faWQpLFxuICAgICAgICBwYXltZW50Q2hhbm5lbDogSXl6aXBheS5QQVlNRU5UX0NIQU5ORUwuV0VCLFxuICAgICAgICBwYXltZW50R3JvdXA6IEl5emlwYXkuUEFZTUVOVF9HUk9VUC5QUk9EVUNULFxuICAgICAgICBwYXltZW50Q2FyZDogY2FyZCxcbiAgICAgICAgYnV5ZXI6IHtcbiAgICAgICAgICBpZDogU3RyaW5nKHJlcS51c2VyLl9pZCksXG4gICAgICAgICAgbmFtZTogcmVxLnVzZXI/Lm5hbWUsXG4gICAgICAgICAgc3VybmFtZTogcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgZ3NtTnVtYmVyOiByZXEudXNlcj8ucGhvbmVOdW1iZXIsXG4gICAgICAgICAgZW1haWw6IHJlcS51c2VyPy5lbWFpbCxcbiAgICAgICAgICBpZGVudGl0eU51bWJlcjogcmVxLnVzZXI/LmlkZW50aXR5TnVtYmVyLFxuICAgICAgICAgIGxhc3RMb2dpbkRhdGU6IG1vbWVudChyZXEudXNlcj8udXBkYXRlZEF0KS5mb3JtYXQoXG4gICAgICAgICAgICBcIllZWVktTU0tREQgSEg6bW06c3NcIlxuICAgICAgICAgICksIC8vaXlpenBheSB0YXJpaCBmb3JtYXTEsW5hIMOnZXZpcm1layBpw6dpbiB5YXDEsWxkxLFcbiAgICAgICAgICByZWdpc3RyYXRpb25EYXRlOiBtb21lbnQocmVxLnVzZXI/LnVwZGF0ZWRBdCkuZm9ybWF0KFxuICAgICAgICAgICAgXCJZWVlZLU1NLUREIEhIOm1tOnNzXCJcbiAgICAgICAgICApLFxuICAgICAgICAgIHJlZ2lzdHJhdGlvbkFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIGlwOiByZXEudXNlcj8uaXAsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIHNoaXBwaW5nQWRkcmVzczoge1xuICAgICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiXCIgKyByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgICBhZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgICAgfSxcbiAgICAgICAgYmlsbGluZ0FkZHJlc3M6IHtcbiAgICAgICAgICBjb250YWN0TmFtZTogcmVxLnVzZXI/Lm5hbWUgKyBcIlwiICsgcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgYWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIGJhc2tldEl0ZW1zOiBjYXJ0LnByb2R1Y3RzLm1hcCgocHJvZHVjdCwgaW5kZXgpID0+IHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaWQ6IFN0cmluZyhwcm9kdWN0Py5faWQpLFxuICAgICAgICAgICAgbmFtZTogcHJvZHVjdD8ubmFtZSxcbiAgICAgICAgICAgIGNhdGVnb3J5MTogcHJvZHVjdC5jYXRlZ29yaWVzWzBdLFxuICAgICAgICAgICAgY2F0ZWdvcnkyOiBwcm9kdWN0LmNhdGVnb3JpZXNbMV0sXG4gICAgICAgICAgICBpdGVtVHlwZTogSXl6aXBheS5CQVNLRVRfSVRFTV9UWVBFW3Byb2R1Y3Q/Lml0ZW1UeXBlXSxcbiAgICAgICAgICAgIHByaWNlOiBwcm9kdWN0Py5wcmljZSxcbiAgICAgICAgICB9O1xuICAgICAgICB9KSxcbiAgICAgIH07XG5cbiAgICAgIGxldCByZXN1bHQgPSBhd2FpdCBQYXltZW50cy5jcmVhdGVQYXltZW50KGRhdGEpO1xuICAgICAgYXdhaXQgQ29tcGxldGVQYXltZW50KHJlc3VsdCk7XG4gICAgICByZXMuanNvbihyZXN1bHQpO1xuICAgIH1cbiAgKTtcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLE9BQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFFBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLEtBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFHLE1BQUEsR0FBQUosc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFJLFNBQUEsR0FBQUwsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFLLFFBQUEsR0FBQU4sc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFNLFFBQUEsR0FBQUMsdUJBQUEsQ0FBQVAsT0FBQTtBQUNBLElBQUFRLEtBQUEsR0FBQUQsdUJBQUEsQ0FBQVAsT0FBQTtBQUNBLElBQUFTLEtBQUEsR0FBQVYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFVLFVBQUEsR0FBQVYsT0FBQTtBQUFvRCxTQUFBVyx5QkFBQUMsQ0FBQSw2QkFBQUMsT0FBQSxtQkFBQUMsQ0FBQSxPQUFBRCxPQUFBLElBQUFFLENBQUEsT0FBQUYsT0FBQSxZQUFBRix3QkFBQSxZQUFBQSxDQUFBQyxDQUFBLFdBQUFBLENBQUEsR0FBQUcsQ0FBQSxHQUFBRCxDQUFBLEtBQUFGLENBQUE7QUFBQSxTQUFBTCx3QkFBQUss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","map":{"version":3,"names":["_moment","_interopRequireDefault","require","_iyzipay","_cart","_users","_ApiError","_Session","Payments","_interopRequireWildcard","Cards","_uuid","_payments2","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","_default","router","post","Session","req","res","card","body","ApiError","params","cartId","cart","Carts","findOne","_id","populate","completed","registerCard","paidPrice","products","map","product","price","reduce","b","data","locale","user","conversationId","id","currency","Iyzipay","CURRENCY","TRY","installments","basketId","String","paymentChannel","PAYMENT_CHANNEL","WEB","paymentGroup","PAYMENT_GROUP","PRODUCT","paymentCard","buyer","name","surname","gsmNumber","phoneNumber","email","identityNumber","lastLoginDate","moment","updatedAt","format","registrationDate","registrationAddress","address","ip","city","country","zipCode","shippingAddress","contactName","billingAddress","basketItems","index","category1","categories","category2","itemType","BASKET_ITEM_TYPE","result","createPayment","CompletePayment","json","cardUserKey","Users","save","cardIndex","cards","getUserCards","parseInt","cardDetails","length","cardToken","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["Payments.js"],"sourcesContent":["import moment from \"moment\";\nimport Iyzipay from \"iyzipay\";\nimport Carts from \"../db/cart\";\nimport Users from \"../db/users\";\nimport ApiError from \"../errors/ApiError\";\nimport Session from \"../middlewares/Session\";\nimport * as Payments from \"../services/iyzico/methods/payments\";\nimport * as Cards from \"../services/iyzico/methods/cards\";\nimport id from \"../utils/uuid\";\nimport { CompletePayment } from \"../utils/payments\";\n\nexport default (router) => {\n  //yeni bir kartla ödeme oluştur ve kartı kaydetme\n  router.post(\"/payments/:cartId/with-new-card\", Session, async (req, res) => {\n    const { card } = req.body;\n    if (!card) {\n      throw new ApiError(\"Card is required\", 400, \"cardRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await Carts.findOne({ _id: req.params?.cartId })\n      .populate(\"buyer\")\n      .populate(\"products\");\n    if (!cart) {\n      throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n\n    card.registerCard = \"0\"; //methodslarda registerCard:1 yani kartı kaydet demek ama şuan kaydetme dediğim için 0 yaptım\n\n    const paidPrice = cart.products\n      .map((product) => product.price)\n      .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const data = {\n      locale: req.user.locale,\n      conversationId: id(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: Iyzipay.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n      paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: moment(req.user?.updatedAt).format(\n          \"YYYY-MM-DD HH:mm:ss\"\n        ), //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: moment(req.user?.updatedAt).format(\n          \"YYYY-MM-DD HH:mm:ss\"\n        ),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode,\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode,\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode,\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price,\n        };\n      }),\n    };\n\n    let result = await Payments.createPayment(data);\n    await CompletePayment(result);\n    res.json(result);\n  });\n\n  //yeni bir ödeme oluştur ve kart kaydet\n  router.post(\n    \"/payments/:cartId/with-new-card/register-card\",\n    Session,\n    async (req, res) => {\n      const { card } = req.body;\n      if (!card) {\n        throw new ApiError(\"Card is required\", 400, \"cardRequired\");\n      }\n      if (!req.params?.cartId) {\n        throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      }\n      const cart = await Carts.findOne({ _id: req.params?.cartId })\n        .populate(\"buyer\")\n        .populate(\"products\");\n      if (!cart) {\n        throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n      }\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      if (req.user?.cardUserKey) {\n        card.cardUserKey = req.user?.cardUserKey;\n      }\n      card.registerCard = \"1\"; //methodslarda registerCard:1 yani kartı kaydet\n\n      const paidPrice = cart.products\n        .map((product) => product.price)\n        .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: paidPrice,\n        paidPrice: paidPrice,\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        paymentCard: card,\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ), //iyizpay tarih formatına çevirmek için yapıldı\n          registrationDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems: cart.products.map((product, index) => {\n          return {\n            id: String(product?._id),\n            name: product?.name,\n            category1: product.categories[0],\n            category2: product.categories[1],\n            itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n            price: product?.price,\n          };\n        }),\n      };\n\n      let result = await Payments.createPayment(data);\n      if (req.user?.cardUserKey) {\n        const user = await Users.findOne({ _id: req.user?._id });\n        user.cardUserKey = result?.cardUserKey;\n        await user.save();\n      }\n      await CompletePayment(result);\n      res.json(result);\n    }\n  );\n\n  //hali hazırda bulunan kart ile ödeme\n  router.post(\n    \"/payments/:cartId/:cardIndex/with-registered-card-index\",\n    Session,\n    async (req, res) => {\n      let { cardIndex } = req.params;\n      if (!cardIndex) {\n        throw new ApiError(\"Card index is required\", 400, \"cardIndexRequired\");\n      }\n      if (!req.user?.cardUserKey) {\n        throw new ApiError(\n          \"No registered card available\",\n          400,\n          \"cardUserKeyRequired\"\n        );\n      }\n\n      const cards = await Cards.getUserCards({\n        locale: req.user.locale,\n        conversationId: id(),\n        cardUserKey: req.user?.cardUserKey,\n      });\n      const index = parseInt(cardIndex);\n      if (index >= cards?.cardDetails?.length) {\n        throw new ApiError(\"Card does not exist\", 400, \"cardIndexInvalid\");\n      }\n      const { cardToken } = cards?.cardDetails[index];\n      if (!req.params?.cartId) {\n        throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      }\n      const cart = await Carts.findOne({ _id: req.params?.cartId })\n        .populate(\"buyer\")\n        .populate(\"products\");\n      if (!cart) {\n        throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n      }\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      const paidPrice = cart.products\n        .map((product) => product.price)\n        .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n      const card = {\n        cardToken,\n        cardUserKey: req.user?.cardUserKey,\n      };\n\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: paidPrice,\n        paidPrice: paidPrice,\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        paymentCard: card,\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ), //iyizpay tarih formatına çevirmek için yapıldı\n          registrationDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems: cart.products.map((product, index) => {\n          return {\n            id: String(product?._id),\n            name: product?.name,\n            category1: product.categories[0],\n            category2: product.categories[1],\n            itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n            price: product?.price,\n          };\n        }),\n      };\n\n      let result = await Payments.createPayment(data);\n      await CompletePayment(result);\n      res.json(result);\n    }\n  );\n\n  router.post(\n    \"/payments/:cartId/with-registered-card-token\",\n    Session,\n    async (req, res) => {\n      let { cardToken } = req.body;\n      if (!cardToken) {\n        throw new ApiError(\"Card Token is required\", 400, \"cardTokenRequired\");\n      }\n      if (!req.user?.cardUserKey) {\n        throw new ApiError(\n          \"No registered card available\",\n          400,\n          \"cardUserKeyRequired\"\n        );\n      }\n\n      if (!req.params?.cartId) {\n        throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      }\n      const cart = await Carts.findOne({ _id: req.params?.cartId })\n        .populate(\"buyer\")\n        .populate(\"products\");\n      if (!cart) {\n        throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n      }\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      const paidPrice = cart.products\n        .map((product) => product.price)\n        .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n      const card = {\n        cardToken,\n        cardUserKey: req.user?.cardUserKey,\n      };\n\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: paidPrice,\n        paidPrice: paidPrice,\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        paymentCard: card,\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ), //iyizpay tarih formatına çevirmek için yapıldı\n          registrationDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems: cart.products.map((product, index) => {\n          return {\n            id: String(product?._id),\n            name: product?.name,\n            category1: product.categories[0],\n            category2: product.categories[1],\n            itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n            price: product?.price,\n          };\n        }),\n      };\n\n      let result = await Payments.createPayment(data);\n      await CompletePayment(result);\n      res.json(result);\n    }\n  );\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1723544661896},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/payments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createPayment = void 0;\nvar _iyzipay = _interopRequireDefault(require(\"../connection/iyzipay\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst createPayment = data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.payment.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.createPayment = createPayment;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaXl6aXBheSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiY3JlYXRlUGF5bWVudCIsImRhdGEiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIml5emlwYXkiLCJwYXltZW50IiwiY3JlYXRlIiwiZXJyIiwicmVzdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3NlcnZpY2VzL2l5emljby9tZXRob2RzLyIsInNvdXJjZXMiOlsicGF5bWVudHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGl5emlwYXkgZnJvbSBcIi4uL2Nvbm5lY3Rpb24vaXl6aXBheVwiO1xuXG5leHBvcnQgY29uc3QgY3JlYXRlUGF5bWVudCA9IChkYXRhKSA9PiB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgaXl6aXBheS5wYXltZW50LmNyZWF0ZShkYXRhLCAoZXJyLCByZXN1bHQpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsUUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQTRDLFNBQUFELHVCQUFBRSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBRXJDLE1BQU1HLGFBQWEsR0FBSUMsSUFBSSxJQUFLO0VBQ3JDLE9BQU8sSUFBSUMsT0FBTyxDQUFDLENBQUNDLE9BQU8sRUFBRUMsTUFBTSxLQUFLO0lBQ3RDQyxnQkFBTyxDQUFDQyxPQUFPLENBQUNDLE1BQU0sQ0FBQ04sSUFBSSxFQUFFLENBQUNPLEdBQUcsRUFBRUMsTUFBTSxLQUFLO01BQzVDLElBQUlELEdBQUcsRUFBRTtRQUNQSixNQUFNLENBQUNJLEdBQUcsQ0FBQztNQUNiLENBQUMsTUFBTTtRQUNMTCxPQUFPLENBQUNNLE1BQU0sQ0FBQztNQUNqQjtJQUNGLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztBQUNKLENBQUM7QUFBQ0MsT0FBQSxDQUFBVixhQUFBLEdBQUFBLGFBQUEiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_iyzipay","_interopRequireDefault","require","e","__esModule","default","createPayment","data","Promise","resolve","reject","iyzipay","payment","create","err","result","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/","sources":["payments.js"],"sourcesContent":["import iyzipay from \"../connection/iyzipay\";\n\nexport const createPayment = (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.payment.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA4C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAErC,MAAMG,aAAa,GAAIC,IAAI,IAAK;EACrC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,OAAO,CAACC,MAAM,CAACN,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MAC5C,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAV,aAAA,GAAAA,aAAA","ignoreList":[]}},"mtime":1723543937124},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/connection/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/connection/iyzipay.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _iyzipay = _interopRequireDefault(require(\"iyzipay\"));\nvar _config = _interopRequireDefault(require(\"../config/config\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst iyzipay = new _iyzipay.default(_config.default);\nvar _default = exports.default = iyzipay;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaXl6aXBheSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2NvbmZpZyIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIml5emlwYXkiLCJJeXppcGF5IiwiY29uZmlnIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvc2VydmljZXMvaXl6aWNvL2Nvbm5lY3Rpb24vIiwic291cmNlcyI6WyJpeXppcGF5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBJeXppcGF5IGZyb20gXCJpeXppcGF5XCI7XG5pbXBvcnQgY29uZmlnIGZyb20gXCIuLi9jb25maWcvY29uZmlnXCI7XG5cbmNvbnN0IGl5emlwYXkgPSBuZXcgSXl6aXBheShjb25maWcpO1xuXG5leHBvcnQgZGVmYXVsdCBpeXppcGF5O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxRQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxPQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFBc0MsU0FBQUQsdUJBQUFHLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFdEMsTUFBTUcsT0FBTyxHQUFHLElBQUlDLGdCQUFPLENBQUNDLGVBQU0sQ0FBQztBQUFDLElBQUFDLFFBQUEsR0FBQUMsT0FBQSxDQUFBTCxPQUFBLEdBRXJCQyxPQUFPIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["_iyzipay","_interopRequireDefault","require","_config","e","__esModule","default","iyzipay","Iyzipay","config","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/connection/","sources":["iyzipay.js"],"sourcesContent":["import Iyzipay from \"iyzipay\";\nimport config from \"../config/config\";\n\nconst iyzipay = new Iyzipay(config);\n\nexport default iyzipay;\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,OAAA,GAAAF,sBAAA,CAAAC,OAAA;AAAsC,SAAAD,uBAAAG,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEtC,MAAMG,OAAO,GAAG,IAAIC,gBAAO,CAACC,eAAM,CAAC;AAAC,IAAAC,QAAA,GAAAC,OAAA,CAAAL,OAAA,GAErBC,OAAO","ignoreList":[]}},"mtime":1723543937086},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/config/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/config/config.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nmodule.exports = {\n  apiKey: \"sandbox-bkqCdxvCL1VB4bIisfgw9jIjhGHnanvp\",\n  secretKey: \"sandbox-cYCcsyTLYHxCN92Qqw24QbKRxXuJnXUa\",\n  uri: \"https://sandbox-api.iyzipay.com\"\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb2R1bGUiLCJleHBvcnRzIiwiYXBpS2V5Iiwic2VjcmV0S2V5IiwidXJpIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvc2VydmljZXMvaXl6aWNvL2NvbmZpZy8iLCJzb3VyY2VzIjpbImNvbmZpZy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHtcbiAgYXBpS2V5OiBcInNhbmRib3gtYmtxQ2R4dkNMMVZCNGJJaXNmZ3c5aklqaEdIbmFudnBcIixcbiAgc2VjcmV0S2V5OiBcInNhbmRib3gtY1lDY3N5VExZSHhDTjkyUXF3MjRRYktSeFh1Sm5YVWFcIixcbiAgdXJpOiBcImh0dHBzOi8vc2FuZGJveC1hcGkuaXl6aXBheS5jb21cIixcbn07XG4iXSwibWFwcGluZ3MiOiI7O0FBQUFBLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHO0VBQ2ZDLE1BQU0sRUFBRSwwQ0FBMEM7RUFDbERDLFNBQVMsRUFBRSwwQ0FBMEM7RUFDckRDLEdBQUcsRUFBRTtBQUNQLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["module","exports","apiKey","secretKey","uri"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/config/","sources":["config.js"],"sourcesContent":["module.exports = {\n  apiKey: \"sandbox-bkqCdxvCL1VB4bIisfgw9jIjhGHnanvp\",\n  secretKey: \"sandbox-cYCcsyTLYHxCN92Qqw24QbKRxXuJnXUa\",\n  uri: \"https://sandbox-api.iyzipay.com\",\n};\n"],"mappings":";;AAAAA,MAAM,CAACC,OAAO,GAAG;EACfC,MAAM,EAAE,0CAA0C;EAClDC,SAAS,EAAE,0CAA0C;EACrDC,GAAG,EAAE;AACP,CAAC","ignoreList":[]}},"mtime":1723543900879},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/cards.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getUserCards = exports.deleteUserCard = exports.createUserCard = void 0;\nvar _iyzipay = _interopRequireDefault(require(\"../connection/iyzipay\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst createUserCard = async data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.card.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.createUserCard = createUserCard;\nconst getUserCards = async data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.cardList.retrieve(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.getUserCards = getUserCards;\nconst deleteUserCard = async data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.card.delete(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.deleteUserCard = deleteUserCard;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaXl6aXBheSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiY3JlYXRlVXNlckNhcmQiLCJkYXRhIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJpeXppcGF5IiwiY2FyZCIsImNyZWF0ZSIsImVyciIsInJlc3VsdCIsImV4cG9ydHMiLCJnZXRVc2VyQ2FyZHMiLCJjYXJkTGlzdCIsInJldHJpZXZlIiwiZGVsZXRlVXNlckNhcmQiLCJkZWxldGUiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9zZXJ2aWNlcy9peXppY28vbWV0aG9kcy8iLCJzb3VyY2VzIjpbImNhcmRzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBpeXppcGF5IGZyb20gXCIuLi9jb25uZWN0aW9uL2l5emlwYXlcIjtcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZVVzZXJDYXJkID0gYXN5bmMgKGRhdGEpID0+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBpeXppcGF5LmNhcmQuY3JlYXRlKGRhdGEsIChlcnIsIHJlc3VsdCkgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0VXNlckNhcmRzID0gYXN5bmMgKGRhdGEpID0+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBpeXppcGF5LmNhcmRMaXN0LnJldHJpZXZlKGRhdGEsIChlcnIsIHJlc3VsdCkgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59O1xuXG5leHBvcnQgY29uc3QgZGVsZXRlVXNlckNhcmQgPSBhc3luYyAoZGF0YSkgPT4ge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGl5emlwYXkuY2FyZC5kZWxldGUoZGF0YSwgKGVyciwgcmVzdWx0KSA9PiB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFFBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUE0QyxTQUFBRCx1QkFBQUUsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUVyQyxNQUFNRyxjQUFjLEdBQUcsTUFBT0MsSUFBSSxJQUFLO0VBQzVDLE9BQU8sSUFBSUMsT0FBTyxDQUFDLENBQUNDLE9BQU8sRUFBRUMsTUFBTSxLQUFLO0lBQ3RDQyxnQkFBTyxDQUFDQyxJQUFJLENBQUNDLE1BQU0sQ0FBQ04sSUFBSSxFQUFFLENBQUNPLEdBQUcsRUFBRUMsTUFBTSxLQUFLO01BQ3pDLElBQUlELEdBQUcsRUFBRTtRQUNQSixNQUFNLENBQUNJLEdBQUcsQ0FBQztNQUNiLENBQUMsTUFBTTtRQUNMTCxPQUFPLENBQUNNLE1BQU0sQ0FBQztNQUNqQjtJQUNGLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztBQUNKLENBQUM7QUFBQ0MsT0FBQSxDQUFBVixjQUFBLEdBQUFBLGNBQUE7QUFFSyxNQUFNVyxZQUFZLEdBQUcsTUFBT1YsSUFBSSxJQUFLO0VBQzFDLE9BQU8sSUFBSUMsT0FBTyxDQUFDLENBQUNDLE9BQU8sRUFBRUMsTUFBTSxLQUFLO0lBQ3RDQyxnQkFBTyxDQUFDTyxRQUFRLENBQUNDLFFBQVEsQ0FBQ1osSUFBSSxFQUFFLENBQUNPLEdBQUcsRUFBRUMsTUFBTSxLQUFLO01BQy9DLElBQUlELEdBQUcsRUFBRTtRQUNQSixNQUFNLENBQUNJLEdBQUcsQ0FBQztNQUNiLENBQUMsTUFBTTtRQUNMTCxPQUFPLENBQUNNLE1BQU0sQ0FBQztNQUNqQjtJQUNGLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztBQUNKLENBQUM7QUFBQ0MsT0FBQSxDQUFBQyxZQUFBLEdBQUFBLFlBQUE7QUFFSyxNQUFNRyxjQUFjLEdBQUcsTUFBT2IsSUFBSSxJQUFLO0VBQzVDLE9BQU8sSUFBSUMsT0FBTyxDQUFDLENBQUNDLE9BQU8sRUFBRUMsTUFBTSxLQUFLO0lBQ3RDQyxnQkFBTyxDQUFDQyxJQUFJLENBQUNTLE1BQU0sQ0FBQ2QsSUFBSSxFQUFFLENBQUNPLEdBQUcsRUFBRUMsTUFBTSxLQUFLO01BQ3pDLElBQUlELEdBQUcsRUFBRTtRQUNQSixNQUFNLENBQUNJLEdBQUcsQ0FBQztNQUNiLENBQUMsTUFBTTtRQUNMTCxPQUFPLENBQUNNLE1BQU0sQ0FBQztNQUNqQjtJQUNGLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztBQUNKLENBQUM7QUFBQ0MsT0FBQSxDQUFBSSxjQUFBLEdBQUFBLGNBQUEiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_iyzipay","_interopRequireDefault","require","e","__esModule","default","createUserCard","data","Promise","resolve","reject","iyzipay","card","create","err","result","exports","getUserCards","cardList","retrieve","deleteUserCard","delete"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/","sources":["cards.js"],"sourcesContent":["import iyzipay from \"../connection/iyzipay\";\n\nexport const createUserCard = async (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.card.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n\nexport const getUserCards = async (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.cardList.retrieve(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n\nexport const deleteUserCard = async (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.card.delete(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA4C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAErC,MAAMG,cAAc,GAAG,MAAOC,IAAI,IAAK;EAC5C,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,IAAI,CAACC,MAAM,CAACN,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MACzC,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAV,cAAA,GAAAA,cAAA;AAEK,MAAMW,YAAY,GAAG,MAAOV,IAAI,IAAK;EAC1C,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACO,QAAQ,CAACC,QAAQ,CAACZ,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MAC/C,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAC,YAAA,GAAAA,YAAA;AAEK,MAAMG,cAAc,GAAG,MAAOb,IAAI,IAAK;EAC5C,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,IAAI,CAACS,MAAM,CAACd,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MACzC,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAI,cAAA,GAAAA,cAAA","ignoreList":[]}},"mtime":1723543937120},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/utils/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/utils/payments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CompletePayment = void 0;\nvar _mongoose = require(\"mongoose\");\nvar _paymentSuccess = _interopRequireDefault(require(\"../db/payment-success\"));\nvar _paymentFailed = _interopRequireDefault(require(\"../db/payment-failed\"));\nvar _cart = _interopRequireDefault(require(\"../db/cart\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst {\n  ObjectId\n} = _mongoose.Types;\nconst CompletePayment = async result => {\n  if (result?.status === \"success\") {\n    await _cart.default.updateOne({\n      _id: new ObjectId(result.basketId)\n    }, {\n      $set: {\n        completed: true\n      }\n    });\n    await _paymentSuccess.default.create({\n      status: result?.status,\n      cartId: result?.basketId,\n      conversationId: result?.conversationId,\n      currency: result?.currency,\n      paymentId: result?.paymentId,\n      price: result?.price,\n      paidPrice: result?.paidPrice,\n      itemTransactions: result?.itemTransactions.map(item => {\n        return {\n          itemId: item?.itemId,\n          paymentTransactionId: item?.paymentTransactionId,\n          price: item?.price,\n          paidPrice: item?.paidPrice\n        };\n      }),\n      log: result\n    });\n  } else {\n    await _paymentFailed.default.create({\n      status: result?.status,\n      conversationId: result?.conversationId,\n      errorCode: result?.errorCode,\n      errorMessage: result?.errorMessage,\n      log: result\n    });\n  }\n};\nexports.CompletePayment = CompletePayment;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJyZXF1aXJlIiwiX3BheW1lbnRTdWNjZXNzIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIl9wYXltZW50RmFpbGVkIiwiX2NhcnQiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJPYmplY3RJZCIsIlR5cGVzIiwiQ29tcGxldGVQYXltZW50IiwicmVzdWx0Iiwic3RhdHVzIiwiQ2FydHMiLCJ1cGRhdGVPbmUiLCJfaWQiLCJiYXNrZXRJZCIsIiRzZXQiLCJjb21wbGV0ZWQiLCJQYXltZW50U3VjY2VzcyIsImNyZWF0ZSIsImNhcnRJZCIsImNvbnZlcnNhdGlvbklkIiwiY3VycmVuY3kiLCJwYXltZW50SWQiLCJwcmljZSIsInBhaWRQcmljZSIsIml0ZW1UcmFuc2FjdGlvbnMiLCJtYXAiLCJpdGVtIiwiaXRlbUlkIiwicGF5bWVudFRyYW5zYWN0aW9uSWQiLCJsb2ciLCJQYXltZW50RmFpbGVkIiwiZXJyb3JDb2RlIiwiZXJyb3JNZXNzYWdlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3V0aWxzLyIsInNvdXJjZXMiOlsicGF5bWVudHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVHlwZXMgfSBmcm9tIFwibW9uZ29vc2VcIjtcbmltcG9ydCBQYXltZW50U3VjY2VzcyBmcm9tIFwiLi4vZGIvcGF5bWVudC1zdWNjZXNzXCI7XG5pbXBvcnQgUGF5bWVudEZhaWxlZCBmcm9tIFwiLi4vZGIvcGF5bWVudC1mYWlsZWRcIjtcbmltcG9ydCBDYXJ0cyBmcm9tIFwiLi4vZGIvY2FydFwiO1xuY29uc3QgeyBPYmplY3RJZCB9ID0gVHlwZXM7XG5cbmV4cG9ydCBjb25zdCBDb21wbGV0ZVBheW1lbnQgPSBhc3luYyAocmVzdWx0KSA9PiB7XG4gIGlmIChyZXN1bHQ/LnN0YXR1cyA9PT0gXCJzdWNjZXNzXCIpIHtcbiAgICBhd2FpdCBDYXJ0cy51cGRhdGVPbmUoXG4gICAgICB7IF9pZDogbmV3IE9iamVjdElkKHJlc3VsdC5iYXNrZXRJZCkgfSxcbiAgICAgIHsgJHNldDogeyBjb21wbGV0ZWQ6IHRydWUgfSB9XG4gICAgKTtcbiAgICBhd2FpdCBQYXltZW50U3VjY2Vzcy5jcmVhdGUoe1xuICAgICAgc3RhdHVzOiByZXN1bHQ/LnN0YXR1cyxcbiAgICAgIGNhcnRJZDogcmVzdWx0Py5iYXNrZXRJZCxcbiAgICAgIGNvbnZlcnNhdGlvbklkOiByZXN1bHQ/LmNvbnZlcnNhdGlvbklkLFxuICAgICAgY3VycmVuY3k6IHJlc3VsdD8uY3VycmVuY3ksXG4gICAgICBwYXltZW50SWQ6IHJlc3VsdD8ucGF5bWVudElkLFxuICAgICAgcHJpY2U6IHJlc3VsdD8ucHJpY2UsXG4gICAgICBwYWlkUHJpY2U6IHJlc3VsdD8ucGFpZFByaWNlLFxuICAgICAgaXRlbVRyYW5zYWN0aW9uczogcmVzdWx0Py5pdGVtVHJhbnNhY3Rpb25zLm1hcCgoaXRlbSkgPT4ge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGl0ZW1JZDogaXRlbT8uaXRlbUlkLFxuICAgICAgICAgIHBheW1lbnRUcmFuc2FjdGlvbklkOiBpdGVtPy5wYXltZW50VHJhbnNhY3Rpb25JZCxcbiAgICAgICAgICBwcmljZTogaXRlbT8ucHJpY2UsXG4gICAgICAgICAgcGFpZFByaWNlOiBpdGVtPy5wYWlkUHJpY2UsXG4gICAgICAgIH07XG4gICAgICB9KSxcbiAgICAgIGxvZzogcmVzdWx0LFxuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIGF3YWl0IFBheW1lbnRGYWlsZWQuY3JlYXRlKHtcbiAgICAgIHN0YXR1czogcmVzdWx0Py5zdGF0dXMsXG4gICAgICBjb252ZXJzYXRpb25JZDogcmVzdWx0Py5jb252ZXJzYXRpb25JZCxcbiAgICAgIGVycm9yQ29kZTogcmVzdWx0Py5lcnJvckNvZGUsXG4gICAgICBlcnJvck1lc3NhZ2U6IHJlc3VsdD8uZXJyb3JNZXNzYWdlLFxuICAgICAgbG9nOiByZXN1bHQsXG4gICAgfSk7XG4gIH1cbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsT0FBQTtBQUNBLElBQUFDLGVBQUEsR0FBQUMsc0JBQUEsQ0FBQUYsT0FBQTtBQUNBLElBQUFHLGNBQUEsR0FBQUQsc0JBQUEsQ0FBQUYsT0FBQTtBQUNBLElBQUFJLEtBQUEsR0FBQUYsc0JBQUEsQ0FBQUYsT0FBQTtBQUErQixTQUFBRSx1QkFBQUcsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUMvQixNQUFNO0VBQUVHO0FBQVMsQ0FBQyxHQUFHQyxlQUFLO0FBRW5CLE1BQU1DLGVBQWUsR0FBRyxNQUFPQyxNQUFNLElBQUs7RUFDL0MsSUFBSUEsTUFBTSxFQUFFQyxNQUFNLEtBQUssU0FBUyxFQUFFO0lBQ2hDLE1BQU1DLGFBQUssQ0FBQ0MsU0FBUyxDQUNuQjtNQUFFQyxHQUFHLEVBQUUsSUFBSVAsUUFBUSxDQUFDRyxNQUFNLENBQUNLLFFBQVE7SUFBRSxDQUFDLEVBQ3RDO01BQUVDLElBQUksRUFBRTtRQUFFQyxTQUFTLEVBQUU7TUFBSztJQUFFLENBQzlCLENBQUM7SUFDRCxNQUFNQyx1QkFBYyxDQUFDQyxNQUFNLENBQUM7TUFDMUJSLE1BQU0sRUFBRUQsTUFBTSxFQUFFQyxNQUFNO01BQ3RCUyxNQUFNLEVBQUVWLE1BQU0sRUFBRUssUUFBUTtNQUN4Qk0sY0FBYyxFQUFFWCxNQUFNLEVBQUVXLGNBQWM7TUFDdENDLFFBQVEsRUFBRVosTUFBTSxFQUFFWSxRQUFRO01BQzFCQyxTQUFTLEVBQUViLE1BQU0sRUFBRWEsU0FBUztNQUM1QkMsS0FBSyxFQUFFZCxNQUFNLEVBQUVjLEtBQUs7TUFDcEJDLFNBQVMsRUFBRWYsTUFBTSxFQUFFZSxTQUFTO01BQzVCQyxnQkFBZ0IsRUFBRWhCLE1BQU0sRUFBRWdCLGdCQUFnQixDQUFDQyxHQUFHLENBQUVDLElBQUksSUFBSztRQUN2RCxPQUFPO1VBQ0xDLE1BQU0sRUFBRUQsSUFBSSxFQUFFQyxNQUFNO1VBQ3BCQyxvQkFBb0IsRUFBRUYsSUFBSSxFQUFFRSxvQkFBb0I7VUFDaEROLEtBQUssRUFBRUksSUFBSSxFQUFFSixLQUFLO1VBQ2xCQyxTQUFTLEVBQUVHLElBQUksRUFBRUg7UUFDbkIsQ0FBQztNQUNILENBQUMsQ0FBQztNQUNGTSxHQUFHLEVBQUVyQjtJQUNQLENBQUMsQ0FBQztFQUNKLENBQUMsTUFBTTtJQUNMLE1BQU1zQixzQkFBYSxDQUFDYixNQUFNLENBQUM7TUFDekJSLE1BQU0sRUFBRUQsTUFBTSxFQUFFQyxNQUFNO01BQ3RCVSxjQUFjLEVBQUVYLE1BQU0sRUFBRVcsY0FBYztNQUN0Q1ksU0FBUyxFQUFFdkIsTUFBTSxFQUFFdUIsU0FBUztNQUM1QkMsWUFBWSxFQUFFeEIsTUFBTSxFQUFFd0IsWUFBWTtNQUNsQ0gsR0FBRyxFQUFFckI7SUFDUCxDQUFDLENBQUM7RUFDSjtBQUNGLENBQUM7QUFBQ3lCLE9BQUEsQ0FBQTFCLGVBQUEsR0FBQUEsZUFBQSIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_mongoose","require","_paymentSuccess","_interopRequireDefault","_paymentFailed","_cart","e","__esModule","default","ObjectId","Types","CompletePayment","result","status","Carts","updateOne","_id","basketId","$set","completed","PaymentSuccess","create","cartId","conversationId","currency","paymentId","price","paidPrice","itemTransactions","map","item","itemId","paymentTransactionId","log","PaymentFailed","errorCode","errorMessage","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/utils/","sources":["payments.js"],"sourcesContent":["import { Types } from \"mongoose\";\nimport PaymentSuccess from \"../db/payment-success\";\nimport PaymentFailed from \"../db/payment-failed\";\nimport Carts from \"../db/cart\";\nconst { ObjectId } = Types;\n\nexport const CompletePayment = async (result) => {\n  if (result?.status === \"success\") {\n    await Carts.updateOne(\n      { _id: new ObjectId(result.basketId) },\n      { $set: { completed: true } }\n    );\n    await PaymentSuccess.create({\n      status: result?.status,\n      cartId: result?.basketId,\n      conversationId: result?.conversationId,\n      currency: result?.currency,\n      paymentId: result?.paymentId,\n      price: result?.price,\n      paidPrice: result?.paidPrice,\n      itemTransactions: result?.itemTransactions.map((item) => {\n        return {\n          itemId: item?.itemId,\n          paymentTransactionId: item?.paymentTransactionId,\n          price: item?.price,\n          paidPrice: item?.paidPrice,\n        };\n      }),\n      log: result,\n    });\n  } else {\n    await PaymentFailed.create({\n      status: result?.status,\n      conversationId: result?.conversationId,\n      errorCode: result?.errorCode,\n      errorMessage: result?.errorMessage,\n      log: result,\n    });\n  }\n};\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,OAAA;AACA,IAAAC,eAAA,GAAAC,sBAAA,CAAAF,OAAA;AACA,IAAAG,cAAA,GAAAD,sBAAA,CAAAF,OAAA;AACA,IAAAI,KAAA,GAAAF,sBAAA,CAAAF,OAAA;AAA+B,SAAAE,uBAAAG,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAC/B,MAAM;EAAEG;AAAS,CAAC,GAAGC,eAAK;AAEnB,MAAMC,eAAe,GAAG,MAAOC,MAAM,IAAK;EAC/C,IAAIA,MAAM,EAAEC,MAAM,KAAK,SAAS,EAAE;IAChC,MAAMC,aAAK,CAACC,SAAS,CACnB;MAAEC,GAAG,EAAE,IAAIP,QAAQ,CAACG,MAAM,CAACK,QAAQ;IAAE,CAAC,EACtC;MAAEC,IAAI,EAAE;QAAEC,SAAS,EAAE;MAAK;IAAE,CAC9B,CAAC;IACD,MAAMC,uBAAc,CAACC,MAAM,CAAC;MAC1BR,MAAM,EAAED,MAAM,EAAEC,MAAM;MACtBS,MAAM,EAAEV,MAAM,EAAEK,QAAQ;MACxBM,cAAc,EAAEX,MAAM,EAAEW,cAAc;MACtCC,QAAQ,EAAEZ,MAAM,EAAEY,QAAQ;MAC1BC,SAAS,EAAEb,MAAM,EAAEa,SAAS;MAC5BC,KAAK,EAAEd,MAAM,EAAEc,KAAK;MACpBC,SAAS,EAAEf,MAAM,EAAEe,SAAS;MAC5BC,gBAAgB,EAAEhB,MAAM,EAAEgB,gBAAgB,CAACC,GAAG,CAAEC,IAAI,IAAK;QACvD,OAAO;UACLC,MAAM,EAAED,IAAI,EAAEC,MAAM;UACpBC,oBAAoB,EAAEF,IAAI,EAAEE,oBAAoB;UAChDN,KAAK,EAAEI,IAAI,EAAEJ,KAAK;UAClBC,SAAS,EAAEG,IAAI,EAAEH;QACnB,CAAC;MACH,CAAC,CAAC;MACFM,GAAG,EAAErB;IACP,CAAC,CAAC;EACJ,CAAC,MAAM;IACL,MAAMsB,sBAAa,CAACb,MAAM,CAAC;MACzBR,MAAM,EAAED,MAAM,EAAEC,MAAM;MACtBU,cAAc,EAAEX,MAAM,EAAEW,cAAc;MACtCY,SAAS,EAAEvB,MAAM,EAAEuB,SAAS;MAC5BC,YAAY,EAAExB,MAAM,EAAEwB,YAAY;MAClCH,GAAG,EAAErB;IACP,CAAC,CAAC;EACJ;AACF,CAAC;AAACyB,OAAA,CAAA1B,eAAA,GAAAA,eAAA","ignoreList":[]}},"mtime":1723544848302},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/Payments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _moment = _interopRequireDefault(require(\"moment\"));\nvar _iyzipay = _interopRequireDefault(require(\"iyzipay\"));\nvar _carts = _interopRequireDefault(require(\"../db/carts\"));\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nvar Payments = _interopRequireWildcard(require(\"../services/iyzico/methods/payments\"));\nvar Cards = _interopRequireWildcard(require(\"../services/iyzico/methods/cards\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nvar _payments2 = require(\"../utils/payments\");\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function (e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = router => {\n  //yeni bir kartla ödeme oluştur ve kartı kaydetme\n  router.post(\"/payments/:cartId/with-new-card\", _Session.default, async (req, res) => {\n    const {\n      card\n    } = req.body;\n    if (!card) {\n      throw new _ApiError.default(\"Card is required\", 400, \"cardRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _carts.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    card.registerCard = \"0\"; //methodslarda registerCard:1 yani kartı kaydet demek ama şuan kaydetme dediğim için 0 yaptım\n\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    let result = await Payments.createPayment(data);\n    await (0, _payments2.CompletePayment)(result);\n    res.json(result);\n  });\n\n  //yeni bir ödeme oluştur ve kart kaydet\n  router.post(\"/payments/:cartId/with-new-card/register-card\", _Session.default, async (req, res) => {\n    const {\n      card\n    } = req.body;\n    if (!card) {\n      throw new _ApiError.default(\"Card is required\", 400, \"cardRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _carts.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    if (req.user?.cardUserKey) {\n      card.cardUserKey = req.user?.cardUserKey;\n    }\n    card.registerCard = \"1\"; //methodslarda registerCard:1 yani kartı kaydet\n\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    let result = await Payments.createPayment(data);\n    if (req.user?.cardUserKey) {\n      const user = await _users.default.findOne({\n        _id: req.user?._id\n      });\n      user.cardUserKey = result?.cardUserKey;\n      await user.save();\n    }\n    await (0, _payments2.CompletePayment)(result);\n    res.json(result);\n  });\n\n  //hali hazırda bulunan kart ile ödeme\n  router.post(\"/payments/:cartId/:cardIndex/with-registered-card-index\", _Session.default, async (req, res) => {\n    let {\n      cardIndex\n    } = req.params;\n    if (!cardIndex) {\n      throw new _ApiError.default(\"Card index is required\", 400, \"cardIndexRequired\");\n    }\n    if (!req.user?.cardUserKey) {\n      throw new _ApiError.default(\"No registered card available\", 400, \"cardUserKeyRequired\");\n    }\n    const cards = await Cards.getUserCards({\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      cardUserKey: req.user?.cardUserKey\n    });\n    const index = parseInt(cardIndex);\n    if (index >= cards?.cardDetails?.length) {\n      throw new _ApiError.default(\"Card does not exist\", 400, \"cardIndexInvalid\");\n    }\n    const {\n      cardToken\n    } = cards?.cardDetails[index];\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _carts.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const card = {\n      cardToken,\n      cardUserKey: req.user?.cardUserKey\n    };\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    let result = await Payments.createPayment(data);\n    await (0, _payments2.CompletePayment)(result);\n    res.json(result);\n  });\n  router.post(\"/payments/:cartId/with-registered-card-token\", _Session.default, async (req, res) => {\n    let {\n      cardToken\n    } = req.body;\n    if (!cardToken) {\n      throw new _ApiError.default(\"Card Token is required\", 400, \"cardTokenRequired\");\n    }\n    if (!req.user?.cardUserKey) {\n      throw new _ApiError.default(\"No registered card available\", 400, \"cardUserKeyRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _carts.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const card = {\n      cardToken,\n      cardUserKey: req.user?.cardUserKey\n    };\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    let result = await Payments.createPayment(data);\n    await (0, _payments2.CompletePayment)(result);\n    res.json(result);\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9tZW50IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfaXl6aXBheSIsIl9jYXJ0cyIsIl91c2VycyIsIl9BcGlFcnJvciIsIl9TZXNzaW9uIiwiUGF5bWVudHMiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsIkNhcmRzIiwiX3V1aWQiLCJfcGF5bWVudHMyIiwiX2dldFJlcXVpcmVXaWxkY2FyZENhY2hlIiwiZSIsIldlYWtNYXAiLCJyIiwidCIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiaGFzIiwiZ2V0IiwibiIsIl9fcHJvdG9fXyIsImEiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsInUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJpIiwic2V0IiwiX2RlZmF1bHQiLCJyb3V0ZXIiLCJwb3N0IiwiU2Vzc2lvbiIsInJlcSIsInJlcyIsImNhcmQiLCJib2R5IiwiQXBpRXJyb3IiLCJwYXJhbXMiLCJjYXJ0SWQiLCJjYXJ0IiwiQ2FydHMiLCJmaW5kT25lIiwiX2lkIiwicG9wdWxhdGUiLCJjb21wbGV0ZWQiLCJyZWdpc3RlckNhcmQiLCJwYWlkUHJpY2UiLCJwcm9kdWN0cyIsIm1hcCIsInByb2R1Y3QiLCJwcmljZSIsInJlZHVjZSIsImIiLCJkYXRhIiwibG9jYWxlIiwidXNlciIsImNvbnZlcnNhdGlvbklkIiwiaWQiLCJjdXJyZW5jeSIsIkl5emlwYXkiLCJDVVJSRU5DWSIsIlRSWSIsImluc3RhbGxtZW50cyIsImJhc2tldElkIiwiU3RyaW5nIiwicGF5bWVudENoYW5uZWwiLCJQQVlNRU5UX0NIQU5ORUwiLCJXRUIiLCJwYXltZW50R3JvdXAiLCJQQVlNRU5UX0dST1VQIiwiUFJPRFVDVCIsInBheW1lbnRDYXJkIiwiYnV5ZXIiLCJuYW1lIiwic3VybmFtZSIsImdzbU51bWJlciIsInBob25lTnVtYmVyIiwiZW1haWwiLCJpZGVudGl0eU51bWJlciIsImxhc3RMb2dpbkRhdGUiLCJtb21lbnQiLCJ1cGRhdGVkQXQiLCJmb3JtYXQiLCJyZWdpc3RyYXRpb25EYXRlIiwicmVnaXN0cmF0aW9uQWRkcmVzcyIsImFkZHJlc3MiLCJpcCIsImNpdHkiLCJjb3VudHJ5IiwiemlwQ29kZSIsInNoaXBwaW5nQWRkcmVzcyIsImNvbnRhY3ROYW1lIiwiYmlsbGluZ0FkZHJlc3MiLCJiYXNrZXRJdGVtcyIsImluZGV4IiwiY2F0ZWdvcnkxIiwiY2F0ZWdvcmllcyIsImNhdGVnb3J5MiIsIml0ZW1UeXBlIiwiQkFTS0VUX0lURU1fVFlQRSIsInJlc3VsdCIsImNyZWF0ZVBheW1lbnQiLCJDb21wbGV0ZVBheW1lbnQiLCJqc29uIiwiY2FyZFVzZXJLZXkiLCJVc2VycyIsInNhdmUiLCJjYXJkSW5kZXgiLCJjYXJkcyIsImdldFVzZXJDYXJkcyIsInBhcnNlSW50IiwiY2FyZERldGFpbHMiLCJsZW5ndGgiLCJjYXJkVG9rZW4iLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvcm91dGVzLyIsInNvdXJjZXMiOlsiUGF5bWVudHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbWVudCBmcm9tIFwibW9tZW50XCI7XG5pbXBvcnQgSXl6aXBheSBmcm9tIFwiaXl6aXBheVwiO1xuaW1wb3J0IENhcnRzIGZyb20gXCIuLi9kYi9jYXJ0c1wiO1xuaW1wb3J0IFVzZXJzIGZyb20gXCIuLi9kYi91c2Vyc1wiO1xuaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuLi9lcnJvcnMvQXBpRXJyb3JcIjtcbmltcG9ydCBTZXNzaW9uIGZyb20gXCIuLi9taWRkbGV3YXJlcy9TZXNzaW9uXCI7XG5pbXBvcnQgKiBhcyBQYXltZW50cyBmcm9tIFwiLi4vc2VydmljZXMvaXl6aWNvL21ldGhvZHMvcGF5bWVudHNcIjtcbmltcG9ydCAqIGFzIENhcmRzIGZyb20gXCIuLi9zZXJ2aWNlcy9peXppY28vbWV0aG9kcy9jYXJkc1wiO1xuaW1wb3J0IGlkIGZyb20gXCIuLi91dGlscy91dWlkXCI7XG5pbXBvcnQgeyBDb21wbGV0ZVBheW1lbnQgfSBmcm9tIFwiLi4vdXRpbHMvcGF5bWVudHNcIjtcblxuZXhwb3J0IGRlZmF1bHQgKHJvdXRlcikgPT4ge1xuICAvL3llbmkgYmlyIGthcnRsYSDDtmRlbWUgb2x1xZ90dXIgdmUga2FydMSxIGtheWRldG1lXG4gIHJvdXRlci5wb3N0KFwiL3BheW1lbnRzLzpjYXJ0SWQvd2l0aC1uZXctY2FyZFwiLCBTZXNzaW9uLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICBjb25zdCB7IGNhcmQgfSA9IHJlcS5ib2R5O1xuICAgIGlmICghY2FyZCkge1xuICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FyZCBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FyZFJlcXVpcmVkXCIpO1xuICAgIH1cbiAgICBpZiAoIXJlcS5wYXJhbXM/LmNhcnRJZCkge1xuICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FydElEIGlzIHJlcXVpcmVkXCIsIDQwMCwgXCJjYXJ0SWRSZXF1aXJlZFwiKTtcbiAgICB9XG4gICAgY29uc3QgY2FydCA9IGF3YWl0IENhcnRzLmZpbmRPbmUoeyBfaWQ6IHJlcS5wYXJhbXM/LmNhcnRJZCB9KVxuICAgICAgLnBvcHVsYXRlKFwiYnV5ZXJcIilcbiAgICAgIC5wb3B1bGF0ZShcInByb2R1Y3RzXCIpO1xuICAgIGlmICghY2FydCkge1xuICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FyZCBub3QgZm91bmRcIiwgNDA0LCBcImNhcmROb3RGb3VuZFwiKTtcbiAgICB9XG4gICAgaWYgKGNhcnQ/LmNvbXBsZXRlZCkge1xuICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FydCBpcyBjb21wbGV0ZWRcIiwgNDAwLCBcImNhcnRDb21wbGV0ZWRcIik7XG4gICAgfVxuXG4gICAgY2FyZC5yZWdpc3RlckNhcmQgPSBcIjBcIjsgLy9tZXRob2RzbGFyZGEgcmVnaXN0ZXJDYXJkOjEgeWFuaSBrYXJ0xLEga2F5ZGV0IGRlbWVrIGFtYSDFn3VhbiBrYXlkZXRtZSBkZWRpxJ9pbSBpw6dpbiAwIHlhcHTEsW1cblxuICAgIGNvbnN0IHBhaWRQcmljZSA9IGNhcnQucHJvZHVjdHNcbiAgICAgIC5tYXAoKHByb2R1Y3QpID0+IHByb2R1Y3QucHJpY2UpXG4gICAgICAucmVkdWNlKChhLCBiKSA9PiBhICsgYiwgMCk7IC8vw7ZkZW5lY2VrIG1pa3RhcmxhcsSxbiB0b3BsYW3EsVxuXG4gICAgY29uc3QgZGF0YSA9IHtcbiAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICBwcmljZTogcGFpZFByaWNlLFxuICAgICAgcGFpZFByaWNlOiBwYWlkUHJpY2UsXG4gICAgICBjdXJyZW5jeTogSXl6aXBheS5DVVJSRU5DWS5UUlksXG4gICAgICBpbnN0YWxsbWVudHM6IFwiMVwiLFxuICAgICAgYmFza2V0SWQ6IFN0cmluZyhjYXJ0Py5faWQpLFxuICAgICAgcGF5bWVudENoYW5uZWw6IEl5emlwYXkuUEFZTUVOVF9DSEFOTkVMLldFQixcbiAgICAgIHBheW1lbnRHcm91cDogSXl6aXBheS5QQVlNRU5UX0dST1VQLlBST0RVQ1QsXG4gICAgICBwYXltZW50Q2FyZDogY2FyZCxcbiAgICAgIGJ1eWVyOiB7XG4gICAgICAgIGlkOiBTdHJpbmcocmVxLnVzZXIuX2lkKSxcbiAgICAgICAgbmFtZTogcmVxLnVzZXI/Lm5hbWUsXG4gICAgICAgIHN1cm5hbWU6IHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICBnc21OdW1iZXI6IHJlcS51c2VyPy5waG9uZU51bWJlcixcbiAgICAgICAgZW1haWw6IHJlcS51c2VyPy5lbWFpbCxcbiAgICAgICAgaWRlbnRpdHlOdW1iZXI6IHJlcS51c2VyPy5pZGVudGl0eU51bWJlcixcbiAgICAgICAgbGFzdExvZ2luRGF0ZTogbW9tZW50KHJlcS51c2VyPy51cGRhdGVkQXQpLmZvcm1hdChcbiAgICAgICAgICBcIllZWVktTU0tREQgSEg6bW06c3NcIlxuICAgICAgICApLCAvL2l5aXpwYXkgdGFyaWggZm9ybWF0xLFuYSDDp2V2aXJtZWsgacOnaW4geWFwxLFsZMSxXG4gICAgICAgIHJlZ2lzdHJhdGlvbkRhdGU6IG1vbWVudChyZXEudXNlcj8udXBkYXRlZEF0KS5mb3JtYXQoXG4gICAgICAgICAgXCJZWVlZLU1NLUREIEhIOm1tOnNzXCJcbiAgICAgICAgKSxcbiAgICAgICAgcmVnaXN0cmF0aW9uQWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgIGlwOiByZXEudXNlcj8uaXAsXG4gICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICB9LFxuICAgICAgc2hpcHBpbmdBZGRyZXNzOiB7XG4gICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiXCIgKyByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICBhZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICB9LFxuICAgICAgYmlsbGluZ0FkZHJlc3M6IHtcbiAgICAgICAgY29udGFjdE5hbWU6IHJlcS51c2VyPy5uYW1lICsgXCJcIiArIHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgIGFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgIH0sXG4gICAgICBiYXNrZXRJdGVtczogY2FydC5wcm9kdWN0cy5tYXAoKHByb2R1Y3QsIGluZGV4KSA9PiB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgaWQ6IFN0cmluZyhwcm9kdWN0Py5faWQpLFxuICAgICAgICAgIG5hbWU6IHByb2R1Y3Q/Lm5hbWUsXG4gICAgICAgICAgY2F0ZWdvcnkxOiBwcm9kdWN0LmNhdGVnb3JpZXNbMF0sXG4gICAgICAgICAgY2F0ZWdvcnkyOiBwcm9kdWN0LmNhdGVnb3JpZXNbMV0sXG4gICAgICAgICAgaXRlbVR5cGU6IEl5emlwYXkuQkFTS0VUX0lURU1fVFlQRVtwcm9kdWN0Py5pdGVtVHlwZV0sXG4gICAgICAgICAgcHJpY2U6IHByb2R1Y3Q/LnByaWNlLFxuICAgICAgICB9O1xuICAgICAgfSksXG4gICAgfTtcblxuICAgIGxldCByZXN1bHQgPSBhd2FpdCBQYXltZW50cy5jcmVhdGVQYXltZW50KGRhdGEpO1xuICAgIGF3YWl0IENvbXBsZXRlUGF5bWVudChyZXN1bHQpO1xuICAgIHJlcy5qc29uKHJlc3VsdCk7XG4gIH0pO1xuXG4gIC8veWVuaSBiaXIgw7ZkZW1lIG9sdcWfdHVyIHZlIGthcnQga2F5ZGV0XG4gIHJvdXRlci5wb3N0KFxuICAgIFwiL3BheW1lbnRzLzpjYXJ0SWQvd2l0aC1uZXctY2FyZC9yZWdpc3Rlci1jYXJkXCIsXG4gICAgU2Vzc2lvbixcbiAgICBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICAgIGNvbnN0IHsgY2FyZCB9ID0gcmVxLmJvZHk7XG4gICAgICBpZiAoIWNhcmQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FyZCBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FyZFJlcXVpcmVkXCIpO1xuICAgICAgfVxuICAgICAgaWYgKCFyZXEucGFyYW1zPy5jYXJ0SWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FydElEIGlzIHJlcXVpcmVkXCIsIDQwMCwgXCJjYXJ0SWRSZXF1aXJlZFwiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGNhcnQgPSBhd2FpdCBDYXJ0cy5maW5kT25lKHsgX2lkOiByZXEucGFyYW1zPy5jYXJ0SWQgfSlcbiAgICAgICAgLnBvcHVsYXRlKFwiYnV5ZXJcIilcbiAgICAgICAgLnBvcHVsYXRlKFwicHJvZHVjdHNcIik7XG4gICAgICBpZiAoIWNhcnQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FyZCBub3QgZm91bmRcIiwgNDA0LCBcImNhcmROb3RGb3VuZFwiKTtcbiAgICAgIH1cbiAgICAgIGlmIChjYXJ0Py5jb21wbGV0ZWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FydCBpcyBjb21wbGV0ZWRcIiwgNDAwLCBcImNhcnRDb21wbGV0ZWRcIik7XG4gICAgICB9XG5cbiAgICAgIGlmIChyZXEudXNlcj8uY2FyZFVzZXJLZXkpIHtcbiAgICAgICAgY2FyZC5jYXJkVXNlcktleSA9IHJlcS51c2VyPy5jYXJkVXNlcktleTtcbiAgICAgIH1cbiAgICAgIGNhcmQucmVnaXN0ZXJDYXJkID0gXCIxXCI7IC8vbWV0aG9kc2xhcmRhIHJlZ2lzdGVyQ2FyZDoxIHlhbmkga2FydMSxIGtheWRldFxuXG4gICAgICBjb25zdCBwYWlkUHJpY2UgPSBjYXJ0LnByb2R1Y3RzXG4gICAgICAgIC5tYXAoKHByb2R1Y3QpID0+IHByb2R1Y3QucHJpY2UpXG4gICAgICAgIC5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiLCAwKTsgLy/DtmRlbmVjZWsgbWlrdGFybGFyxLFuIHRvcGxhbcSxXG5cbiAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgICBjb252ZXJzYXRpb25JZDogaWQoKSxcbiAgICAgICAgcHJpY2U6IHBhaWRQcmljZSxcbiAgICAgICAgcGFpZFByaWNlOiBwYWlkUHJpY2UsXG4gICAgICAgIGN1cnJlbmN5OiBJeXppcGF5LkNVUlJFTkNZLlRSWSxcbiAgICAgICAgaW5zdGFsbG1lbnRzOiBcIjFcIixcbiAgICAgICAgYmFza2V0SWQ6IFN0cmluZyhjYXJ0Py5faWQpLFxuICAgICAgICBwYXltZW50Q2hhbm5lbDogSXl6aXBheS5QQVlNRU5UX0NIQU5ORUwuV0VCLFxuICAgICAgICBwYXltZW50R3JvdXA6IEl5emlwYXkuUEFZTUVOVF9HUk9VUC5QUk9EVUNULFxuICAgICAgICBwYXltZW50Q2FyZDogY2FyZCxcbiAgICAgICAgYnV5ZXI6IHtcbiAgICAgICAgICBpZDogU3RyaW5nKHJlcS51c2VyLl9pZCksXG4gICAgICAgICAgbmFtZTogcmVxLnVzZXI/Lm5hbWUsXG4gICAgICAgICAgc3VybmFtZTogcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgZ3NtTnVtYmVyOiByZXEudXNlcj8ucGhvbmVOdW1iZXIsXG4gICAgICAgICAgZW1haWw6IHJlcS51c2VyPy5lbWFpbCxcbiAgICAgICAgICBpZGVudGl0eU51bWJlcjogcmVxLnVzZXI/LmlkZW50aXR5TnVtYmVyLFxuICAgICAgICAgIGxhc3RMb2dpbkRhdGU6IG1vbWVudChyZXEudXNlcj8udXBkYXRlZEF0KS5mb3JtYXQoXG4gICAgICAgICAgICBcIllZWVktTU0tREQgSEg6bW06c3NcIlxuICAgICAgICAgICksIC8vaXlpenBheSB0YXJpaCBmb3JtYXTEsW5hIMOnZXZpcm1layBpw6dpbiB5YXDEsWxkxLFcbiAgICAgICAgICByZWdpc3RyYXRpb25EYXRlOiBtb21lbnQocmVxLnVzZXI/LnVwZGF0ZWRBdCkuZm9ybWF0KFxuICAgICAgICAgICAgXCJZWVlZLU1NLUREIEhIOm1tOnNzXCJcbiAgICAgICAgICApLFxuICAgICAgICAgIHJlZ2lzdHJhdGlvbkFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIGlwOiByZXEudXNlcj8uaXAsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIHNoaXBwaW5nQWRkcmVzczoge1xuICAgICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiXCIgKyByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgICBhZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgICAgfSxcbiAgICAgICAgYmlsbGluZ0FkZHJlc3M6IHtcbiAgICAgICAgICBjb250YWN0TmFtZTogcmVxLnVzZXI/Lm5hbWUgKyBcIlwiICsgcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgYWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIGJhc2tldEl0ZW1zOiBjYXJ0LnByb2R1Y3RzLm1hcCgocHJvZHVjdCwgaW5kZXgpID0+IHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaWQ6IFN0cmluZyhwcm9kdWN0Py5faWQpLFxuICAgICAgICAgICAgbmFtZTogcHJvZHVjdD8ubmFtZSxcbiAgICAgICAgICAgIGNhdGVnb3J5MTogcHJvZHVjdC5jYXRlZ29yaWVzWzBdLFxuICAgICAgICAgICAgY2F0ZWdvcnkyOiBwcm9kdWN0LmNhdGVnb3JpZXNbMV0sXG4gICAgICAgICAgICBpdGVtVHlwZTogSXl6aXBheS5CQVNLRVRfSVRFTV9UWVBFW3Byb2R1Y3Q/Lml0ZW1UeXBlXSxcbiAgICAgICAgICAgIHByaWNlOiBwcm9kdWN0Py5wcmljZSxcbiAgICAgICAgICB9O1xuICAgICAgICB9KSxcbiAgICAgIH07XG5cbiAgICAgIGxldCByZXN1bHQgPSBhd2FpdCBQYXltZW50cy5jcmVhdGVQYXltZW50KGRhdGEpO1xuICAgICAgaWYgKHJlcS51c2VyPy5jYXJkVXNlcktleSkge1xuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlcnMuZmluZE9uZSh7IF9pZDogcmVxLnVzZXI/Ll9pZCB9KTtcbiAgICAgICAgdXNlci5jYXJkVXNlcktleSA9IHJlc3VsdD8uY2FyZFVzZXJLZXk7XG4gICAgICAgIGF3YWl0IHVzZXIuc2F2ZSgpO1xuICAgICAgfVxuICAgICAgYXdhaXQgQ29tcGxldGVQYXltZW50KHJlc3VsdCk7XG4gICAgICByZXMuanNvbihyZXN1bHQpO1xuICAgIH1cbiAgKTtcblxuICAvL2hhbGkgaGF6xLFyZGEgYnVsdW5hbiBrYXJ0IGlsZSDDtmRlbWVcbiAgcm91dGVyLnBvc3QoXG4gICAgXCIvcGF5bWVudHMvOmNhcnRJZC86Y2FyZEluZGV4L3dpdGgtcmVnaXN0ZXJlZC1jYXJkLWluZGV4XCIsXG4gICAgU2Vzc2lvbixcbiAgICBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICAgIGxldCB7IGNhcmRJbmRleCB9ID0gcmVxLnBhcmFtcztcbiAgICAgIGlmICghY2FyZEluZGV4KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgaW5kZXggaXMgcmVxdWlyZWRcIiwgNDAwLCBcImNhcmRJbmRleFJlcXVpcmVkXCIpO1xuICAgICAgfVxuICAgICAgaWYgKCFyZXEudXNlcj8uY2FyZFVzZXJLZXkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIFwiTm8gcmVnaXN0ZXJlZCBjYXJkIGF2YWlsYWJsZVwiLFxuICAgICAgICAgIDQwMCxcbiAgICAgICAgICBcImNhcmRVc2VyS2V5UmVxdWlyZWRcIlxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBjYXJkcyA9IGF3YWl0IENhcmRzLmdldFVzZXJDYXJkcyh7XG4gICAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgICBjb252ZXJzYXRpb25JZDogaWQoKSxcbiAgICAgICAgY2FyZFVzZXJLZXk6IHJlcS51c2VyPy5jYXJkVXNlcktleSxcbiAgICAgIH0pO1xuICAgICAgY29uc3QgaW5kZXggPSBwYXJzZUludChjYXJkSW5kZXgpO1xuICAgICAgaWYgKGluZGV4ID49IGNhcmRzPy5jYXJkRGV0YWlscz8ubGVuZ3RoKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgZG9lcyBub3QgZXhpc3RcIiwgNDAwLCBcImNhcmRJbmRleEludmFsaWRcIik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGNhcmRUb2tlbiB9ID0gY2FyZHM/LmNhcmREZXRhaWxzW2luZGV4XTtcbiAgICAgIGlmICghcmVxLnBhcmFtcz8uY2FydElkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnRJRCBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FydElkUmVxdWlyZWRcIik7XG4gICAgICB9XG4gICAgICBjb25zdCBjYXJ0ID0gYXdhaXQgQ2FydHMuZmluZE9uZSh7IF9pZDogcmVxLnBhcmFtcz8uY2FydElkIH0pXG4gICAgICAgIC5wb3B1bGF0ZShcImJ1eWVyXCIpXG4gICAgICAgIC5wb3B1bGF0ZShcInByb2R1Y3RzXCIpO1xuICAgICAgaWYgKCFjYXJ0KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgbm90IGZvdW5kXCIsIDQwNCwgXCJjYXJkTm90Rm91bmRcIik7XG4gICAgICB9XG4gICAgICBpZiAoY2FydD8uY29tcGxldGVkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgaXMgY29tcGxldGVkXCIsIDQwMCwgXCJjYXJ0Q29tcGxldGVkXCIpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBwYWlkUHJpY2UgPSBjYXJ0LnByb2R1Y3RzXG4gICAgICAgIC5tYXAoKHByb2R1Y3QpID0+IHByb2R1Y3QucHJpY2UpXG4gICAgICAgIC5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiLCAwKTsgLy/DtmRlbmVjZWsgbWlrdGFybGFyxLFuIHRvcGxhbcSxXG5cbiAgICAgIGNvbnN0IGNhcmQgPSB7XG4gICAgICAgIGNhcmRUb2tlbixcbiAgICAgICAgY2FyZFVzZXJLZXk6IHJlcS51c2VyPy5jYXJkVXNlcktleSxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgICBjb252ZXJzYXRpb25JZDogaWQoKSxcbiAgICAgICAgcHJpY2U6IHBhaWRQcmljZSxcbiAgICAgICAgcGFpZFByaWNlOiBwYWlkUHJpY2UsXG4gICAgICAgIGN1cnJlbmN5OiBJeXppcGF5LkNVUlJFTkNZLlRSWSxcbiAgICAgICAgaW5zdGFsbG1lbnRzOiBcIjFcIixcbiAgICAgICAgYmFza2V0SWQ6IFN0cmluZyhjYXJ0Py5faWQpLFxuICAgICAgICBwYXltZW50Q2hhbm5lbDogSXl6aXBheS5QQVlNRU5UX0NIQU5ORUwuV0VCLFxuICAgICAgICBwYXltZW50R3JvdXA6IEl5emlwYXkuUEFZTUVOVF9HUk9VUC5QUk9EVUNULFxuICAgICAgICBwYXltZW50Q2FyZDogY2FyZCxcbiAgICAgICAgYnV5ZXI6IHtcbiAgICAgICAgICBpZDogU3RyaW5nKHJlcS51c2VyLl9pZCksXG4gICAgICAgICAgbmFtZTogcmVxLnVzZXI/Lm5hbWUsXG4gICAgICAgICAgc3VybmFtZTogcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgZ3NtTnVtYmVyOiByZXEudXNlcj8ucGhvbmVOdW1iZXIsXG4gICAgICAgICAgZW1haWw6IHJlcS51c2VyPy5lbWFpbCxcbiAgICAgICAgICBpZGVudGl0eU51bWJlcjogcmVxLnVzZXI/LmlkZW50aXR5TnVtYmVyLFxuICAgICAgICAgIGxhc3RMb2dpbkRhdGU6IG1vbWVudChyZXEudXNlcj8udXBkYXRlZEF0KS5mb3JtYXQoXG4gICAgICAgICAgICBcIllZWVktTU0tREQgSEg6bW06c3NcIlxuICAgICAgICAgICksIC8vaXlpenBheSB0YXJpaCBmb3JtYXTEsW5hIMOnZXZpcm1layBpw6dpbiB5YXDEsWxkxLFcbiAgICAgICAgICByZWdpc3RyYXRpb25EYXRlOiBtb21lbnQocmVxLnVzZXI/LnVwZGF0ZWRBdCkuZm9ybWF0KFxuICAgICAgICAgICAgXCJZWVlZLU1NLUREIEhIOm1tOnNzXCJcbiAgICAgICAgICApLFxuICAgICAgICAgIHJlZ2lzdHJhdGlvbkFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIGlwOiByZXEudXNlcj8uaXAsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIHNoaXBwaW5nQWRkcmVzczoge1xuICAgICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiXCIgKyByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgICBhZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgICAgfSxcbiAgICAgICAgYmlsbGluZ0FkZHJlc3M6IHtcbiAgICAgICAgICBjb250YWN0TmFtZTogcmVxLnVzZXI/Lm5hbWUgKyBcIlwiICsgcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgYWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIGJhc2tldEl0ZW1zOiBjYXJ0LnByb2R1Y3RzLm1hcCgocHJvZHVjdCwgaW5kZXgpID0+IHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaWQ6IFN0cmluZyhwcm9kdWN0Py5faWQpLFxuICAgICAgICAgICAgbmFtZTogcHJvZHVjdD8ubmFtZSxcbiAgICAgICAgICAgIGNhdGVnb3J5MTogcHJvZHVjdC5jYXRlZ29yaWVzWzBdLFxuICAgICAgICAgICAgY2F0ZWdvcnkyOiBwcm9kdWN0LmNhdGVnb3JpZXNbMV0sXG4gICAgICAgICAgICBpdGVtVHlwZTogSXl6aXBheS5CQVNLRVRfSVRFTV9UWVBFW3Byb2R1Y3Q/Lml0ZW1UeXBlXSxcbiAgICAgICAgICAgIHByaWNlOiBwcm9kdWN0Py5wcmljZSxcbiAgICAgICAgICB9O1xuICAgICAgICB9KSxcbiAgICAgIH07XG5cbiAgICAgIGxldCByZXN1bHQgPSBhd2FpdCBQYXltZW50cy5jcmVhdGVQYXltZW50KGRhdGEpO1xuICAgICAgYXdhaXQgQ29tcGxldGVQYXltZW50KHJlc3VsdCk7XG4gICAgICByZXMuanNvbihyZXN1bHQpO1xuICAgIH1cbiAgKTtcblxuICByb3V0ZXIucG9zdChcbiAgICBcIi9wYXltZW50cy86Y2FydElkL3dpdGgtcmVnaXN0ZXJlZC1jYXJkLXRva2VuXCIsXG4gICAgU2Vzc2lvbixcbiAgICBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICAgIGxldCB7IGNhcmRUb2tlbiB9ID0gcmVxLmJvZHk7XG4gICAgICBpZiAoIWNhcmRUb2tlbikge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIFRva2VuIGlzIHJlcXVpcmVkXCIsIDQwMCwgXCJjYXJkVG9rZW5SZXF1aXJlZFwiKTtcbiAgICAgIH1cbiAgICAgIGlmICghcmVxLnVzZXI/LmNhcmRVc2VyS2V5KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgICBcIk5vIHJlZ2lzdGVyZWQgY2FyZCBhdmFpbGFibGVcIixcbiAgICAgICAgICA0MDAsXG4gICAgICAgICAgXCJjYXJkVXNlcktleVJlcXVpcmVkXCJcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFyZXEucGFyYW1zPy5jYXJ0SWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FydElEIGlzIHJlcXVpcmVkXCIsIDQwMCwgXCJjYXJ0SWRSZXF1aXJlZFwiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGNhcnQgPSBhd2FpdCBDYXJ0cy5maW5kT25lKHsgX2lkOiByZXEucGFyYW1zPy5jYXJ0SWQgfSlcbiAgICAgICAgLnBvcHVsYXRlKFwiYnV5ZXJcIilcbiAgICAgICAgLnBvcHVsYXRlKFwicHJvZHVjdHNcIik7XG4gICAgICBpZiAoIWNhcnQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FyZCBub3QgZm91bmRcIiwgNDA0LCBcImNhcmROb3RGb3VuZFwiKTtcbiAgICAgIH1cbiAgICAgIGlmIChjYXJ0Py5jb21wbGV0ZWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FydCBpcyBjb21wbGV0ZWRcIiwgNDAwLCBcImNhcnRDb21wbGV0ZWRcIik7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHBhaWRQcmljZSA9IGNhcnQucHJvZHVjdHNcbiAgICAgICAgLm1hcCgocHJvZHVjdCkgPT4gcHJvZHVjdC5wcmljZSlcbiAgICAgICAgLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApOyAvL8O2ZGVuZWNlayBtaWt0YXJsYXLEsW4gdG9wbGFtxLFcblxuICAgICAgY29uc3QgY2FyZCA9IHtcbiAgICAgICAgY2FyZFRva2VuLFxuICAgICAgICBjYXJkVXNlcktleTogcmVxLnVzZXI/LmNhcmRVc2VyS2V5LFxuICAgICAgfTtcblxuICAgICAgY29uc3QgZGF0YSA9IHtcbiAgICAgICAgbG9jYWxlOiByZXEudXNlci5sb2NhbGUsXG4gICAgICAgIGNvbnZlcnNhdGlvbklkOiBpZCgpLFxuICAgICAgICBwcmljZTogcGFpZFByaWNlLFxuICAgICAgICBwYWlkUHJpY2U6IHBhaWRQcmljZSxcbiAgICAgICAgY3VycmVuY3k6IEl5emlwYXkuQ1VSUkVOQ1kuVFJZLFxuICAgICAgICBpbnN0YWxsbWVudHM6IFwiMVwiLFxuICAgICAgICBiYXNrZXRJZDogU3RyaW5nKGNhcnQ/Ll9pZCksXG4gICAgICAgIHBheW1lbnRDaGFubmVsOiBJeXppcGF5LlBBWU1FTlRfQ0hBTk5FTC5XRUIsXG4gICAgICAgIHBheW1lbnRHcm91cDogSXl6aXBheS5QQVlNRU5UX0dST1VQLlBST0RVQ1QsXG4gICAgICAgIHBheW1lbnRDYXJkOiBjYXJkLFxuICAgICAgICBidXllcjoge1xuICAgICAgICAgIGlkOiBTdHJpbmcocmVxLnVzZXIuX2lkKSxcbiAgICAgICAgICBuYW1lOiByZXEudXNlcj8ubmFtZSxcbiAgICAgICAgICBzdXJuYW1lOiByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBnc21OdW1iZXI6IHJlcS51c2VyPy5waG9uZU51bWJlcixcbiAgICAgICAgICBlbWFpbDogcmVxLnVzZXI/LmVtYWlsLFxuICAgICAgICAgIGlkZW50aXR5TnVtYmVyOiByZXEudXNlcj8uaWRlbnRpdHlOdW1iZXIsXG4gICAgICAgICAgbGFzdExvZ2luRGF0ZTogbW9tZW50KHJlcS51c2VyPy51cGRhdGVkQXQpLmZvcm1hdChcbiAgICAgICAgICAgIFwiWVlZWS1NTS1ERCBISDptbTpzc1wiXG4gICAgICAgICAgKSwgLy9peWl6cGF5IHRhcmloIGZvcm1hdMSxbmEgw6dldmlybWVrIGnDp2luIHlhcMSxbGTEsVxuICAgICAgICAgIHJlZ2lzdHJhdGlvbkRhdGU6IG1vbWVudChyZXEudXNlcj8udXBkYXRlZEF0KS5mb3JtYXQoXG4gICAgICAgICAgICBcIllZWVktTU0tREQgSEg6bW06c3NcIlxuICAgICAgICAgICksXG4gICAgICAgICAgcmVnaXN0cmF0aW9uQWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgaXA6IHJlcS51c2VyPy5pcCxcbiAgICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgICAgfSxcbiAgICAgICAgc2hpcHBpbmdBZGRyZXNzOiB7XG4gICAgICAgICAgY29udGFjdE5hbWU6IHJlcS51c2VyPy5uYW1lICsgXCJcIiArIHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIGFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBiaWxsaW5nQWRkcmVzczoge1xuICAgICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiXCIgKyByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgICBhZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgICAgfSxcbiAgICAgICAgYmFza2V0SXRlbXM6IGNhcnQucHJvZHVjdHMubWFwKChwcm9kdWN0LCBpbmRleCkgPT4ge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpZDogU3RyaW5nKHByb2R1Y3Q/Ll9pZCksXG4gICAgICAgICAgICBuYW1lOiBwcm9kdWN0Py5uYW1lLFxuICAgICAgICAgICAgY2F0ZWdvcnkxOiBwcm9kdWN0LmNhdGVnb3JpZXNbMF0sXG4gICAgICAgICAgICBjYXRlZ29yeTI6IHByb2R1Y3QuY2F0ZWdvcmllc1sxXSxcbiAgICAgICAgICAgIGl0ZW1UeXBlOiBJeXppcGF5LkJBU0tFVF9JVEVNX1RZUEVbcHJvZHVjdD8uaXRlbVR5cGVdLFxuICAgICAgICAgICAgcHJpY2U6IHByb2R1Y3Q/LnByaWNlLFxuICAgICAgICAgIH07XG4gICAgICAgIH0pLFxuICAgICAgfTtcblxuICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IFBheW1lbnRzLmNyZWF0ZVBheW1lbnQoZGF0YSk7XG4gICAgICBhd2FpdCBDb21wbGV0ZVBheW1lbnQocmVzdWx0KTtcbiAgICAgIHJlcy5qc29uKHJlc3VsdCk7XG4gICAgfVxuICApO1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsT0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsUUFBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsTUFBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUcsTUFBQSxHQUFBSixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUksU0FBQSxHQUFBTCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUssUUFBQSxHQUFBTixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQU0sUUFBQSxHQUFBQyx1QkFBQSxDQUFBUCxPQUFBO0FBQ0EsSUFBQVEsS0FBQSxHQUFBRCx1QkFBQSxDQUFBUCxPQUFBO0FBQ0EsSUFBQVMsS0FBQSxHQUFBVixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQVUsVUFBQSxHQUFBVixPQUFBO0FBQW9ELFNBQUFXLHlCQUFBQyxDQUFBLDZCQUFBQyxPQUFBLG1CQUFBQyxDQUFBLE9BQUFELE9BQUEsSUFBQUUsQ0FBQSxPQUFBRixPQUFBLFlBQUFGLHdCQUFBLFlBQUFBLENBQUFDLENBQUEsV0FBQUEsQ0FBQSxHQUFBRyxDQUFBLEdBQUFELENBQUEsS0FBQUYsQ0FBQTtBQUFBLFNBQUFMLHdCQUFB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","map":{"version":3,"names":["_moment","_interopRequireDefault","require","_iyzipay","_carts","_users","_ApiError","_Session","Payments","_interopRequireWildcard","Cards","_uuid","_payments2","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","_default","router","post","Session","req","res","card","body","ApiError","params","cartId","cart","Carts","findOne","_id","populate","completed","registerCard","paidPrice","products","map","product","price","reduce","b","data","locale","user","conversationId","id","currency","Iyzipay","CURRENCY","TRY","installments","basketId","String","paymentChannel","PAYMENT_CHANNEL","WEB","paymentGroup","PAYMENT_GROUP","PRODUCT","paymentCard","buyer","name","surname","gsmNumber","phoneNumber","email","identityNumber","lastLoginDate","moment","updatedAt","format","registrationDate","registrationAddress","address","ip","city","country","zipCode","shippingAddress","contactName","billingAddress","basketItems","index","category1","categories","category2","itemType","BASKET_ITEM_TYPE","result","createPayment","CompletePayment","json","cardUserKey","Users","save","cardIndex","cards","getUserCards","parseInt","cardDetails","length","cardToken","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["Payments.js"],"sourcesContent":["import moment from \"moment\";\nimport Iyzipay from \"iyzipay\";\nimport Carts from \"../db/carts\";\nimport Users from \"../db/users\";\nimport ApiError from \"../errors/ApiError\";\nimport Session from \"../middlewares/Session\";\nimport * as Payments from \"../services/iyzico/methods/payments\";\nimport * as Cards from \"../services/iyzico/methods/cards\";\nimport id from \"../utils/uuid\";\nimport { CompletePayment } from \"../utils/payments\";\n\nexport default (router) => {\n  //yeni bir kartla ödeme oluştur ve kartı kaydetme\n  router.post(\"/payments/:cartId/with-new-card\", Session, async (req, res) => {\n    const { card } = req.body;\n    if (!card) {\n      throw new ApiError(\"Card is required\", 400, \"cardRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await Carts.findOne({ _id: req.params?.cartId })\n      .populate(\"buyer\")\n      .populate(\"products\");\n    if (!cart) {\n      throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n\n    card.registerCard = \"0\"; //methodslarda registerCard:1 yani kartı kaydet demek ama şuan kaydetme dediğim için 0 yaptım\n\n    const paidPrice = cart.products\n      .map((product) => product.price)\n      .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const data = {\n      locale: req.user.locale,\n      conversationId: id(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: Iyzipay.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n      paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: moment(req.user?.updatedAt).format(\n          \"YYYY-MM-DD HH:mm:ss\"\n        ), //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: moment(req.user?.updatedAt).format(\n          \"YYYY-MM-DD HH:mm:ss\"\n        ),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode,\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode,\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode,\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price,\n        };\n      }),\n    };\n\n    let result = await Payments.createPayment(data);\n    await CompletePayment(result);\n    res.json(result);\n  });\n\n  //yeni bir ödeme oluştur ve kart kaydet\n  router.post(\n    \"/payments/:cartId/with-new-card/register-card\",\n    Session,\n    async (req, res) => {\n      const { card } = req.body;\n      if (!card) {\n        throw new ApiError(\"Card is required\", 400, \"cardRequired\");\n      }\n      if (!req.params?.cartId) {\n        throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      }\n      const cart = await Carts.findOne({ _id: req.params?.cartId })\n        .populate(\"buyer\")\n        .populate(\"products\");\n      if (!cart) {\n        throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n      }\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      if (req.user?.cardUserKey) {\n        card.cardUserKey = req.user?.cardUserKey;\n      }\n      card.registerCard = \"1\"; //methodslarda registerCard:1 yani kartı kaydet\n\n      const paidPrice = cart.products\n        .map((product) => product.price)\n        .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: paidPrice,\n        paidPrice: paidPrice,\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        paymentCard: card,\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ), //iyizpay tarih formatına çevirmek için yapıldı\n          registrationDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems: cart.products.map((product, index) => {\n          return {\n            id: String(product?._id),\n            name: product?.name,\n            category1: product.categories[0],\n            category2: product.categories[1],\n            itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n            price: product?.price,\n          };\n        }),\n      };\n\n      let result = await Payments.createPayment(data);\n      if (req.user?.cardUserKey) {\n        const user = await Users.findOne({ _id: req.user?._id });\n        user.cardUserKey = result?.cardUserKey;\n        await user.save();\n      }\n      await CompletePayment(result);\n      res.json(result);\n    }\n  );\n\n  //hali hazırda bulunan kart ile ödeme\n  router.post(\n    \"/payments/:cartId/:cardIndex/with-registered-card-index\",\n    Session,\n    async (req, res) => {\n      let { cardIndex } = req.params;\n      if (!cardIndex) {\n        throw new ApiError(\"Card index is required\", 400, \"cardIndexRequired\");\n      }\n      if (!req.user?.cardUserKey) {\n        throw new ApiError(\n          \"No registered card available\",\n          400,\n          \"cardUserKeyRequired\"\n        );\n      }\n\n      const cards = await Cards.getUserCards({\n        locale: req.user.locale,\n        conversationId: id(),\n        cardUserKey: req.user?.cardUserKey,\n      });\n      const index = parseInt(cardIndex);\n      if (index >= cards?.cardDetails?.length) {\n        throw new ApiError(\"Card does not exist\", 400, \"cardIndexInvalid\");\n      }\n      const { cardToken } = cards?.cardDetails[index];\n      if (!req.params?.cartId) {\n        throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      }\n      const cart = await Carts.findOne({ _id: req.params?.cartId })\n        .populate(\"buyer\")\n        .populate(\"products\");\n      if (!cart) {\n        throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n      }\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      const paidPrice = cart.products\n        .map((product) => product.price)\n        .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n      const card = {\n        cardToken,\n        cardUserKey: req.user?.cardUserKey,\n      };\n\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: paidPrice,\n        paidPrice: paidPrice,\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        paymentCard: card,\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ), //iyizpay tarih formatına çevirmek için yapıldı\n          registrationDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems: cart.products.map((product, index) => {\n          return {\n            id: String(product?._id),\n            name: product?.name,\n            category1: product.categories[0],\n            category2: product.categories[1],\n            itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n            price: product?.price,\n          };\n        }),\n      };\n\n      let result = await Payments.createPayment(data);\n      await CompletePayment(result);\n      res.json(result);\n    }\n  );\n\n  router.post(\n    \"/payments/:cartId/with-registered-card-token\",\n    Session,\n    async (req, res) => {\n      let { cardToken } = req.body;\n      if (!cardToken) {\n        throw new ApiError(\"Card Token is required\", 400, \"cardTokenRequired\");\n      }\n      if (!req.user?.cardUserKey) {\n        throw new ApiError(\n          \"No registered card available\",\n          400,\n          \"cardUserKeyRequired\"\n        );\n      }\n\n      if (!req.params?.cartId) {\n        throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      }\n      const cart = await Carts.findOne({ _id: req.params?.cartId })\n        .populate(\"buyer\")\n        .populate(\"products\");\n      if (!cart) {\n        throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n      }\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      const paidPrice = cart.products\n        .map((product) => product.price)\n        .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n      const card = {\n        cardToken,\n        cardUserKey: req.user?.cardUserKey,\n      };\n\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: paidPrice,\n        paidPrice: paidPrice,\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        paymentCard: card,\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ), //iyizpay tarih formatına çevirmek için yapıldı\n          registrationDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems: cart.products.map((product, index) => {\n          return {\n            id: String(product?._id),\n            name: product?.name,\n            category1: product.categories[0],\n            category2: product.categories[1],\n            itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n            price: product?.price,\n          };\n        }),\n      };\n\n      let result = await Payments.createPayment(data);\n      await CompletePayment(result);\n      res.json(result);\n    }\n  );\n};\n"],"mappings":";;;;;;AAAA,IAAAA,OAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,QAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,MAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,MAAA,GAAAJ,sBAAA,CAAAC,OAAA;AACA,IAAAI,SAAA,GAAAL,sBAAA,CAAAC,OAAA;AACA,IAAAK,QAAA,GAAAN,sBAAA,CAAAC,OAAA;AACA,IAAAM,QAAA,GAAAC,uBAAA,CAAAP,OAAA;AACA,IAAAQ,KAAA,GAAAD,uBAAA,CAAAP,OAAA;AACA,IAAAS,KAAA,GAAAV,sBAAA,CAAAC,OAAA;AACA,IAAAU,UAAA,GAAAV,OAAA;AAAoD,SAAAW,yBAAAC,CAAA,6BAAAC,OAAA,mBAAAC,CAAA,OAAAD,OAAA,IAAAE,CAAA,OAAAF,OAAA,YAAAF,wBAAA,YAAAA,CAAAC,CAAA,WAAAA,CAAA,GAAAG,CAAA,GAAAD,CAAA,KAAAF,CAAA;AAAA,SAAAL,wBAAAK,CAAA,EAAAE,CAAA,SAAAA,CAAA,IAAAF,CAAA,IAAAA,CAAA,CAAAI,UAAA,SAAAJ,CAAA,eAAAA,CAAA,uBAAAA,CAAA,yBAAAA,CAAA,WAAAK,OAAA,EAAAL,CAAA,QAAAG,CAAA,GAAAJ,wBAAA,CAAAG,CAAA,OAAAC,CAAA,IAAAA,CAAA,CAAAG,GAAA,CAAAN,CAAA,UAAAG,CAAA,CAAAI,GAAA,CAAAP,CAAA,OAAAQ,CAAA,KAAAC,SAAA,UAAAC,CAAA,GAAAC,MAAA,CAAAC,cAAA,IAAAD,MAAA,CAAAE,wBAAA,WAAAC,CAAA,IAAAd,CAAA,oBAAAc,CAAA,OAAAC,cAAA,CAAAC,IAAA,CAAAhB,CAAA,EAAAc,CAAA,SAAAG,CAAA,GAAAP,CAAA,GAAAC,MAAA,CAAAE,wBAAA,CAAAb,CAAA,EAAAc,CAAA,UAAAG,CAAA,KAAAA,CAAA,CAAAV,GAAA,IAAAU,CAAA,CAAAC,GAAA,IAAAP,MAAA,CAAAC,cAAA,CAAAJ,CAAA,EAAAM,CAAA,EAAAG,CAAA,IAAAT,CAAA,CAAAM,CAAA,IAAAd,CAAA,CAAAc,CAAA,YAAAN,CAAA,CAAAH,OAAA,GAAAL,CAAA,EAAAG,CAAA,IAAAA,CAAA,CAAAe,GAAA,CAAAlB,CAAA,EAAAQ,CAAA,GAAAA,CAAA;AAAA,SAAArB,uBAAAa,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAI,UAAA,GAAAJ,CAAA,KAAAK,OAAA,EAAAL,CAAA;AAAA,IAAAmB,QAAA,GAEpCC,MAAM,IAAK;EACzB;EACAA,MAAM,CAACC,IAAI,CAAC,iCAAiC,EAAEC,gBAAO,EAAE,OAAOC,GAAG,EAAEC,GAAG,KAAK;IAC1E,MAAM;MAAEC;IAAK,CAAC,GAAGF,GAAG,CAACG,IAAI;IACzB,IAAI,CAACD,IAAI,EAAE;MACT,MAAM,IAAIE,iBAAQ,CAAC,kBAAkB,EAAE,GAAG,EAAE,cAAc,CAAC;IAC7D;IACA,IAAI,CAACJ,GAAG,CAACK,MAAM,EAAEC,MAAM,EAAE;MACvB,MAAM,IAAIF,iBAAQ,CAAC,oBAAoB,EAAE,GAAG,EAAE,gBAAgB,CAAC;IACjE;IACA,MAAMG,IAAI,GAAG,MAAMC,cAAK,CAACC,OAAO,CAAC;MAAEC,GAAG,EAAEV,GAAG,CAACK,MAAM,EAAEC;IAAO,CAAC,CAAC,CAC1DK,QAAQ,CAAC,OAAO,CAAC,CACjBA,QAAQ,CAAC,UAAU,CAAC;IACvB,IAAI,CAACJ,IAAI,EAAE;MACT,MAAM,IAAIH,iBAAQ,CAAC,gBAAgB,EAAE,GAAG,EAAE,cAAc,CAAC;IAC3D;IACA,IAAIG,IAAI,EAAEK,SAAS,EAAE;MACnB,MAAM,IAAIR,iBAAQ,CAAC,mBAAmB,EAAE,GAAG,EAAE,eAAe,CAAC;IAC/D;IAEAF,IAAI,CAACW,YAAY,GAAG,GAAG,CAAC,CAAC;;IAEzB,MAAMC,SAAS,GAAGP,IAAI,CAACQ,QAAQ,CAC5BC,GAAG,CAAEC,OAAO,IAAKA,OAAO,CAACC,KAAK,CAAC,CAC/BC,MAAM,CAAC,CAAChC,CAAC,EAAEiC,CAAC,KAAKjC,CAAC,GAAGiC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;;IAE/B,MAAMC,IAAI,GAAG;MACXC,MAAM,EAAEtB,GAAG,CAACuB,IAAI,CAACD,MAAM;MACvBE,cAAc,EAAE,IAAAC,aAAE,EAAC,CAAC;MACpBP,KAAK,EAAEJ,SAAS;MAChBA,SAAS,EAAEA,SAAS;MACpBY,QAAQ,EAAEC,gBAAO,CAACC,QAAQ,CAACC,GAAG;MAC9BC,YAAY,EAAE,GAAG;MACjBC,QAAQ,EAAEC,MAAM,CAACzB,IAAI,EAAEG,GAAG,CAAC;MAC3BuB,cAAc,EAAEN,gBAAO,CAACO,eAAe,CAACC,GAAG;MAC3CC,YAAY,EAAET,gBAAO,CAACU,aAAa,CAACC,OAAO;MAC3CC,WAAW,EAAErC,IAAI;MACjBsC,KAAK,EAAE;QACLf,EAAE,EAAEO,MAAM,CAAChC,GAAG,CAACuB,IAAI,CAACb,GAAG,CAAC;QACxB+B,IAAI,EAAEzC,GAAG,CAACuB,IAAI,EAAEkB,IAAI;QACpBC,OAAO,EAAE1C,GAAG,CAACuB,IAAI,EAAEmB,OAAO;QAC1BC,SAAS,EAAE3C,GAAG,CAACuB,IAAI,EAAEqB,WAAW;QAChCC,KAAK,EAAE7C,GAAG,CAACuB,IAAI,EAAEsB,KAAK;QACtBC,cAAc,EAAE9C,GAAG,CAACuB,IAAI,EAAEuB,cAAc;QACxCC,aAAa,EAAE,IAAAC,eAAM,EAAChD,GAAG,CAACuB,IAAI,EAAE0B,SAAS,CAAC,CAACC,MAAM,CAC/C,qBACF,CAAC;QAAE;QACHC,gBAAgB,EAAE,IAAAH,eAAM,EAAChD,GAAG,CAACuB,IAAI,EAAE0B,SAAS,CAAC,CAACC,MAAM,CAClD,qBACF,CAAC;QACDE,mBAAmB,EAAEpD,GAAG,CAACuB,IAAI,EAAE8B,OAAO;QACtCC,EAAE,EAAEtD,GAAG,CAACuB,IAAI,EAAE+B,EAAE;QAChBC,IAAI,EAAEvD,GAAG,CAACuB,IAAI,EAAEgC,IAAI;QACpBC,OAAO,EAAExD,GAAG,CAACuB,IAAI,EAAEiC,OAAO;QAC1BC,OAAO,EAAEzD,GAAG,CAACuB,IAAI,EAAEkC;MACrB,CAAC;MACDC,eAAe,EAAE;QACfC,WAAW,EAAE3D,GAAG,CAACuB,IAAI,EAAEkB,IAAI,GAAG,EAAE,GAAGzC,GAAG,CAACuB,IAAI,EAAEmB,OAAO;QACpDa,IAAI,EAAEvD,GAAG,CAACuB,IAAI,EAAEgC,IAAI;QACpBC,OAAO,EAAExD,GAAG,CAACuB,IAAI,EAAEiC,OAAO;QAC1BH,OAAO,EAAErD,GAAG,CAACuB,IAAI,EAAE8B,OAAO;QAC1BI,OAAO,EAAEzD,GAAG,CAACuB,IAAI,EAAEkC;MACrB,CAAC;MACDG,cAAc,EAAE;QACdD,WAAW,EAAE3D,GAAG,CAACuB,IAAI,EAAEkB,IAAI,GAAG,EAAE,GAAGzC,GAAG,CAACuB,IAAI,EAAEmB,OAAO;QACpDa,IAAI,EAAEvD,GAAG,CAACuB,IAAI,EAAEgC,IAAI;QACpBC,OAAO,EAAExD,GAAG,CAACuB,IAAI,EAAEiC,OAAO;QAC1BH,OAAO,EAAErD,GAAG,CAACuB,IAAI,EAAE8B,OAAO;QAC1BI,OAAO,EAAEzD,GAAG,CAACuB,IAAI,EAAEkC;MACrB,CAAC;MACDI,WAAW,EAAEtD,IAAI,CAACQ,QAAQ,CAACC,GAAG,CAAC,CAACC,OAAO,EAAE6C,KAAK,KAAK;QACjD,OAAO;UACLrC,EAAE,EAAEO,MAAM,CAACf,OAAO,EAAEP,GAAG,CAAC;UACxB+B,IAAI,EAAExB,OAAO,EAAEwB,IAAI;UACnBsB,SAAS,EAAE9C,OAAO,CAAC+C,UAAU,CAAC,CAAC,CAAC;UAChCC,SAAS,EAAEhD,OAAO,CAAC+C,UAAU,CAAC,CAAC,CAAC;UAChCE,QAAQ,EAAEvC,gBAAO,CAACwC,gBAAgB,CAAClD,OAAO,EAAEiD,QAAQ,CAAC;UACrDhD,KAAK,EAAED,OAAO,EAAEC;QAClB,CAAC;MACH,CAAC;IACH,CAAC;IAED,IAAIkD,MAAM,GAAG,MAAMjG,QAAQ,CAACkG,aAAa,CAAChD,IAAI,CAAC;IAC/C,MAAM,IAAAiD,0BAAe,EAACF,MAAM,CAAC;IAC7BnE,GAAG,CAACsE,IAAI,CAACH,MAAM,CAAC;EAClB,CAAC,CAAC;;EAEF;EACAvE,MAAM,CAACC,IAAI,CACT,+CAA+C,EAC/CC,gBAAO,EACP,OAAOC,GAAG,EAAEC,GAAG,KAAK;IAClB,MAAM;MAAEC;IAAK,CAAC,GAAGF,GAAG,CAACG,IAAI;IACzB,IAAI,CAACD,IAAI,EAAE;MACT,MAAM,IAAIE,iBAAQ,CAAC,kBAAkB,EAAE,GAAG,EAAE,cAAc,CAAC;IAC7D;IACA,IAAI,CAACJ,GAAG,CAACK,MAAM,EAAEC,MAAM,EAAE;MACvB,MAAM,IAAIF,iBAAQ,CAAC,oBAAoB,EAAE,GAAG,EAAE,gBAAgB,CAAC;IACjE;IACA,MAAMG,IAAI,GAAG,MAAMC,cAAK,CAACC,OAAO,CAAC;MAAEC,GAAG,EAAEV,GAAG,CAACK,MAAM,EAAEC;IAAO,CAAC,CAAC,CAC1DK,QAAQ,CAAC,OAAO,CAAC,CACjBA,QAAQ,CAAC,UAAU,CAAC;IACvB,IAAI,CAACJ,IAAI,EAAE;MACT,MAAM,IAAIH,iBAAQ,CAAC,gBAAgB,EAAE,GAAG,EAAE,cAAc,CAAC;IAC3D;IACA,IAAIG,IAAI,EAAEK,SAAS,EAAE;MACnB,MAAM,IAAIR,iBAAQ,CAAC,mBAAmB,EAAE,GAAG,EAAE,eAAe,CAAC;IAC/D;IAEA,IAAIJ,GAAG,CAACuB,IAAI,EAAEiD,WAAW,EAAE;MACzBtE,IAAI,CAACsE,WAAW,GAAGxE,GAAG,CAACuB,IAAI,EAAEiD,WAAW;IAC1C;IACAtE,IAAI,CAACW,YAAY,GAAG,GAAG,CAAC,CAAC;;IAEzB,MAAMC,SAAS,GAAGP,IAAI,CAACQ,QAAQ,CAC5BC,GAAG,CAAEC,OAAO,IAAKA,OAAO,CAACC,KAAK,CAAC,CAC/BC,MAAM,CAAC,CAAChC,CAAC,EAAEiC,CAAC,KAAKjC,CAAC,GAAGiC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;;IAE/B,MAAMC,IAAI,GAAG;MACXC,MAAM,EAAEtB,GAAG,CAACuB,IAAI,CAACD,MAAM;MACvBE,cAAc,EAAE,IAAAC,aAAE,EAAC,CAAC;MACpBP,KAAK,EAAEJ,SAAS;MAChBA,SAAS,EAAEA,SAAS;MACpBY,QAAQ,EAAEC,gBAAO,CAACC,QAAQ,CAACC,GAAG;MAC9BC,YAAY,EAAE,GAAG;MACjBC,QAAQ,EAAEC,MAAM,CAACzB,IAAI,EAAEG,GAAG,CAAC;MAC3BuB,cAAc,EAAEN,gBAAO,CAACO,eAAe,CAACC,GAAG;MAC3CC,YAAY,EAAET,gBAAO,CAACU,aAAa,CAACC,OAAO;MAC3CC,WAAW,EAAErC,IAAI;MACjBsC,KAAK,EAAE;QACLf,EAAE,EAAEO,MAAM,CAAChC,GAAG,CAACuB,IAAI,CAACb,GAAG,CAAC;QACxB+B,IAAI,EAAEzC,GAAG,CAACuB,IAAI,EAAEkB,IAAI;QACpBC,OAAO,EAAE1C,GAAG,CAACuB,IAAI,EAAEmB,OAAO;QAC1BC,SAAS,EAAE3C,GAAG,CAACuB,IAAI,EAAEqB,WAAW;QAChCC,KAAK,EAAE7C,GAAG,CAACuB,IAAI,EAAEsB,KAAK;QACtBC,cAAc,EAAE9C,GAAG,CAACuB,IAAI,EAAEuB,cAAc;QACxCC,aAAa,EAAE,IAAAC,eAAM,EAAChD,GAAG,CAACuB,IAAI,EAAE0B,SAAS,CAAC,CAACC,MAAM,CAC/C,qBACF,CAAC;QAAE;QACHC,gBAAgB,EAAE,IAAAH,eAAM,EAAChD,GAAG,CAACuB,IAAI,EAAE0B,SAAS,CAAC,CAACC,MAAM,CAClD,qBACF,CAAC;QACDE,mBAAmB,EAAEpD,GAAG,CAACuB,IAAI,EAAE8B,OAAO;QACtCC,EAAE,EAAEtD,GAAG,CAACuB,IAAI,EAAE+B,EAAE;QAChBC,IAAI,EAAEvD,GAAG,CAACuB,IAAI,EAAEgC,IAAI;QACpBC,OAAO,EAAExD,GAAG,CAACuB,IAAI,EAAEiC,OAAO;QAC1BC,OAAO,EAAEzD,GAAG,CAACuB,IAAI,EAAEkC;MACrB,CAAC;MACDC,eAAe,EAAE;QACfC,WAAW,EAAE3D,GAAG,CAACuB,IAAI,EAAEkB,IAAI,GAAG,EAAE,GAAGzC,GAAG,CAACuB,IAAI,EAAEmB,OAAO;QACpDa,IAAI,EAAEvD,GAAG,CAACuB,IAAI,EAAEgC,IAAI;QACpBC,OAAO,EAAExD,GAAG,CAACuB,IAAI,EAAEiC,OAAO;QAC1BH,OAAO,EAAErD,GAAG,CAACuB,IAAI,EAAE8B,OAAO;QAC1BI,OAAO,EAAEzD,GAAG,CAACuB,IAAI,EAAEkC;MACrB,CAAC;MACDG,cAAc,EAAE;QACdD,WAAW,EAAE3D,GAAG,CAACuB,IAAI,EAAEkB,IAAI,GAAG,EAAE,GAAGzC,GAAG,CAACuB,IAAI,EAAEmB,OAAO;QACpDa,IAAI,EAAEvD,GAAG,CAACuB,IAAI,EAAEgC,IAAI;QACpBC,OAAO,EAAExD,GAAG,CAACuB,IAAI,EAAEiC,OAAO;QAC1BH,OAAO,EAAErD,GAAG,CAACuB,IAAI,EAAE8B,OAAO;QAC1BI,OAAO,EAAEzD,GAAG,CAACuB,IAAI,EAAEkC;MACrB,CAAC;MACDI,WAAW,EAAEtD,IAAI,CAACQ,QAAQ,CAACC,GAAG,CAAC,CAACC,OAAO,EAAE6C,KAAK,KAAK;QACjD,OAAO;UACLrC,EAAE,EAAEO,MAAM,CAACf,OAAO,EAAEP,GAAG,CAAC;UACxB+B,IAAI,EAAExB,OAAO,EAAEwB,IAAI;UACnBsB,SAAS,EAAE9C,OAAO,CAAC+C,UAAU,CAAC,CAAC,CAAC;UAChCC,SAAS,EAAEhD,OAAO,CAAC+C,UAAU,CAAC,CAAC,CAAC;UAChCE,QAAQ,EAAEvC,gBAAO,CAACwC,gBAAgB,CAAClD,OAAO,EAAEiD,QAAQ,CAAC;UACrDhD,KAAK,EAAED,OAAO,EAAEC;QAClB,CAAC;MACH,CAAC;IACH,CAAC;IAED,IAAIkD,MAAM,GAAG,MAAMjG,QAAQ,CAACkG,aAAa,CAAChD,IAAI,CAAC;IAC/C,IAAIrB,GAAG,CAACuB,IAAI,EAAEiD,WAAW,EAAE;MACzB,MAAMjD,IAAI,GAAG,MAAMkD,cAAK,CAAChE,OAAO,CAAC;QAAEC,GAAG,EAAEV,GAAG,CAACuB,IAAI,EAAEb;MAAI,CAAC,CAAC;MACxDa,IAAI,CAACiD,WAAW,GAAGJ,MAAM,EAAEI,WAAW;MACtC,MAAMjD,IAAI,CAACmD,IAAI,CAAC,CAAC;IACnB;IACA,MAAM,IAAAJ,0BAAe,EAACF,MAAM,CAAC;IAC7BnE,GAAG,CAACsE,IAAI,CAACH,MAAM,CAAC;EAClB,CACF,CAAC;;EAED;EACAvE,MAAM,CAACC,IAAI,CACT,yDAAyD,EACzDC,gBAAO,EACP,OAAOC,GAAG,EAAEC,GAAG,KAAK;IAClB,IAAI;MAAE0E;IAAU,CAAC,GAAG3E,GAAG,CAACK,MAAM;IAC9B,IAAI,CAACsE,SAAS,EAAE;MACd,MAAM,IAAIvE,iBAAQ,CAAC,wBAAwB,EAAE,GAAG,EAAE,mBAAmB,CAAC;IACxE;IACA,IAAI,CAACJ,GAAG,CAACuB,IAAI,EAAEiD,WAAW,EAAE;MAC1B,MAAM,IAAIpE,iBAAQ,CAChB,8BAA8B,EAC9B,GAAG,EACH,qBACF,CAAC;IACH;IAEA,MAAMwE,KAAK,GAAG,MAAMvG,KAAK,CAACwG,YAAY,CAAC;MACrCvD,MAAM,EAAEtB,GAAG,CAACuB,IAAI,CAACD,MAAM;MACvBE,cAAc,EAAE,IAAAC,aAAE,EAAC,CAAC;MACpB+C,WAAW,EAAExE,GAAG,CAACuB,IAAI,EAAEiD;IACzB,CAAC,CAAC;IACF,MAAMV,KAAK,GAAGgB,QAAQ,CAACH,SAAS,CAAC;IACjC,IAAIb,KAAK,IAAIc,KAAK,EAAEG,WAAW,EAAEC,MAAM,EAAE;MACvC,MAAM,IAAI5E,iBAAQ,CAAC,qBAAqB,EAAE,GAAG,EAAE,kBAAkB,CAAC;IACpE;IACA,MAAM;MAAE6E;IAAU,CAAC,GAAGL,KAAK,EAAEG,WAAW,CAACjB,KAAK,CAAC;IAC/C,IAAI,CAAC9D,GAAG,CAACK,MAAM,EAAEC,MAAM,EAAE;MACvB,MAAM,IAAIF,iBAAQ,CAAC,oBAAoB,EAAE,GAAG,EAAE,gBAAgB,CAAC;IACjE;IACA,MAAMG,IAAI,GAAG,MAAMC,cAAK,CAACC,OAAO,CAAC;MAAEC,GAAG,EAAEV,GAAG,CAACK,MAAM,EAAEC;IAAO,CAAC,CAAC,CAC1DK,QAAQ,CAAC,OAAO,CAAC,CACjBA,QAAQ,CAAC,UAAU,CAAC;IACvB,IAAI,CAACJ,IAAI,EAAE;MACT,MAAM,IAAIH,iBAAQ,CAAC,gBAAgB,EAAE,GAAG,EAAE,cAAc,CAAC;IAC3D;IACA,IAAIG,IAAI,EAAEK,SAAS,EAAE;MACnB,MAAM,IAAIR,iBAAQ,CAAC,mBAAmB,EAAE,GAAG,EAAE,eAAe,CAAC;IAC/D;IAEA,MAAMU,SAAS,GAAGP,IAAI,CAACQ,QAAQ,CAC5BC,GAAG,CAAEC,OAAO,IAAKA,OAAO,CAACC,KAAK,CAAC,CAC/BC,MAAM,CAAC,CAAChC,CAAC,EAAEiC,CAAC,KAAKjC,CAAC,GAAGiC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;;IAE/B,MAAMlB,IAAI,GAAG;MACX+E,SAAS;MACTT,WAAW,EAAExE,GAAG,CAACuB,IAAI,EAAEiD;IACzB,CAAC;IAED,MAAMnD,IAAI,GAAG;MACXC,MAAM,EAAEtB,GAAG,CAACuB,IAAI,CAACD,MAAM;MACvBE,cAAc,EAAE,IAAAC,aAAE,EAAC,CAAC;MACpBP,KAAK,EAAEJ,SAAS;MAChBA,SAAS,EAAEA,SAAS;MACpBY,QAAQ,EAAEC,gBAAO,CAACC,QAAQ,CAACC,GAAG;MAC9BC,YAAY,EAAE,GAAG;MACjBC,QAAQ,EAAEC,MAAM,CAACzB,IAAI,EAAEG,GAAG,CAAC;MAC3BuB,cAAc,EAAEN,gBAAO,CAACO,eAAe,CAACC,GAAG;MAC3CC,YAAY,EAAET,gBAAO,CAACU,aAAa,CAACC,OAAO;MAC3CC,WAAW,EAAErC,IAAI;MACjBsC,KAAK,EAAE;QACLf,EAAE,EAAEO,MAAM,CAAChC,GAAG,CAACuB,IAAI,CAACb,GAAG,CAAC;QACxB+B,IAAI,EAAEzC,GAAG,CAACuB,IAAI,EAAEkB,IAAI;QACpBC,OAAO,EAAE1C,GAAG,CAACuB,IAAI,EAAEmB,OAAO;QAC1BC,SAAS,EAAE3C,GAAG,CAACuB,IAAI,EAAEqB,WAAW;QAChCC,KAAK,EAAE7C,GAAG,CAACuB,IAAI,EAAEsB,KAAK;QACtBC,cAAc,EAAE9C,GAAG,CAACuB,IAAI,EAAEuB,cAAc;QACxCC,aAAa,EAAE,IAAAC,eAAM,EAAChD,GAAG,CAACuB,IAAI,EAAE0B,SAAS,CAAC,CAACC,MAAM,CAC/C,qBACF,CAAC;QAAE;QACHC,gBAAgB,EAAE,IAAAH,eAAM,EAAChD,GAAG,CAACuB,IAAI,EAAE0B,SAAS,CAAC,CAACC,MAAM,CAClD,qBACF,CAAC;QACDE,mBAAmB,EAAEpD,GAAG,CAACuB,IAAI,EAAE8B,OAAO;QACtCC,EAAE,EAAEtD,GAAG,CAACuB,IAAI,EAAE+B,EAAE;QAChBC,IAAI,EAAEvD,GAAG,CAACuB,IAAI,EAAEgC,IAAI;QACpBC,OAAO,EAAExD,GAAG,CAACuB,IAAI,EAAEiC,OAAO;QAC1BC,OAAO,EAAEzD,GAAG,CAACuB,IAAI,EAAEkC;MACrB,CAAC;MACDC,eAAe,EAAE;QACfC,WAAW,EAAE3D,GAAG,CAACuB,IAAI,EAAEkB,IAAI,GAAG,EAAE,GAAGzC,GAAG,CAACuB,IAAI,EAAEmB,OAAO;QACpDa,IAAI,EAAEvD,GAAG,CAACuB,IAAI,EAAEgC,IAAI;QACpBC,OAAO,EAAExD,GAAG,CAACuB,IAAI,EAAEiC,OAAO;QAC1BH,OAAO,EAAErD,GAAG,CAACuB,IAAI,EAAE8B,OAAO;QAC1BI,OAAO,EAAEzD,GAAG,CAACuB,IAAI,EAAEkC;MACrB,CAAC;MACDG,cAAc,EAAE;QACdD,WAAW,EAAE3D,GAAG,CAACuB,IAAI,EAAEkB,IAAI,GAAG,EAAE,GAAGzC,GAAG,CAACuB,IAAI,EAAEmB,OAAO;QACpDa,IAAI,EAAEvD,GAAG,CAACuB,IAAI,EAAEgC,IAAI;QACpBC,OAAO,EAAExD,GAAG,CAACuB,IAAI,EAAEiC,OAAO;QAC1BH,OAAO,EAAErD,GAAG,CAACuB,IAAI,EAAE8B,OAAO;QAC1BI,OAAO,EAAEzD,GAAG,CAACuB,IAAI,EAAEkC;MACrB,CAAC;MACDI,WAAW,EAAEtD,IAAI,CAACQ,QAAQ,CAACC,GAAG,CAAC,CAACC,OAAO,EAAE6C,KAAK,KAAK;QACjD,OAAO;UACLrC,EAAE,EAAEO,MAAM,CAACf,OAAO,EAAEP,GAAG,CAAC;UACxB+B,IAAI,EAAExB,OAAO,EAAEwB,IAAI;UACnBsB,SAAS,EAAE9C,OAAO,CAAC+C,UAAU,CAAC,CAAC,CAAC;UAChCC,SAAS,EAAEhD,OAAO,CAAC+C,UAAU,CAAC,CAAC,CAAC;UAChCE,QAAQ,EAAEvC,gBAAO,CAACwC,gBAAgB,CAAClD,OAAO,EAAEiD,QAAQ,CAAC;UACrDhD,KAAK,EAAED,OAAO,EAAEC;QAClB,CAAC;MACH,CAAC;IACH,CAAC;IAED,IAAIkD,MAAM,GAAG,MAAMjG,QAAQ,CAACkG,aAAa,CAAChD,IAAI,CAAC;IAC/C,MAAM,IAAAiD,0BAAe,EAACF,MAAM,CAAC;IAC7BnE,GAAG,CAACsE,IAAI,CAACH,MAAM,CAAC;EAClB,CACF,CAAC;EAEDvE,MAAM,CAACC,IAAI,CACT,8CAA8C,EAC9CC,gBAAO,EACP,OAAOC,GAAG,EAAEC,GAAG,KAAK;IAClB,IAAI;MAAEgF;IAAU,CAAC,GAAGjF,GAAG,CAACG,IAAI;IAC5B,IAAI,CAAC8E,SAAS,EAAE;MACd,MAAM,IAAI7E,iBAAQ,CAAC,wBAAwB,EAAE,GAAG,EAAE,mBAAmB,CAAC;IACxE;IACA,IAAI,CAACJ,GAAG,CAACuB,IAAI,EAAEiD,WAAW,EAAE;MAC1B,MAAM,IAAIpE,iBAAQ,CAChB,8BAA8B,EAC9B,GAAG,EACH,qBACF,CAAC;IACH;IAEA,IAAI,CAACJ,GAAG,CAACK,MAAM,EAAEC,MAAM,EAAE;MACvB,MAAM,IAAIF,iBAAQ,CAAC,oBAAoB,EAAE,GAAG,EAAE,gBAAgB,CAAC;IACjE;IACA,MAAMG,IAAI,GAAG,MAAMC,cAAK,CAACC,OAAO,CAAC;MAAEC,GAAG,EAAEV,GAAG,CAACK,MAAM,EAAEC;IAAO,CAAC,CAAC,CAC1DK,QAAQ,CAAC,OAAO,CAAC,CACjBA,QAAQ,CAAC,UAAU,CAAC;IACvB,IAAI,CAACJ,IAAI,EAAE;MACT,MAAM,IAAIH,iBAAQ,CAAC,gBAAgB,EAAE,GAAG,EAAE,cAAc,CAAC;IAC3D;IACA,IAAIG,IAAI,EAAEK,SAAS,EAAE;MACnB,MAAM,IAAIR,iBAAQ,CAAC,mBAAmB,EAAE,GAAG,EAAE,eAAe,CAAC;IAC/D;IAEA,MAAMU,SAAS,GAAGP,IAAI,CAACQ,QAAQ,CAC5BC,GAAG,CAAEC,OAAO,IAAKA,OAAO,CAACC,KAAK,CAAC,CAC/BC,MAAM,CAAC,CAAChC,CAAC,EAAEiC,CAAC,KAAKjC,CAAC,GAAGiC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC;;IAE/B,MAAMlB,IAAI,GAAG;MACX+E,SAAS;MACTT,WAAW,EAAExE,GAAG,CAACuB,IAAI,EAAEiD;IACzB,CAAC;IAED,MAAMnD,IAAI,GAAG;MACXC,MAAM,EAAEtB,GAAG,CAACuB,IAAI,CAACD,MAAM;MACvBE,cAAc,EAAE,IAAAC,aAAE,EAAC,CAAC;MACpBP,KAAK,EAAEJ,SAAS;MAChBA,SAAS,EAAEA,SAAS;MACpBY,QAAQ,EAAEC,gBAAO,CAACC,QAAQ,CAACC,GAAG;MAC9BC,YAAY,EAAE,GAAG;MACjBC,QAAQ,EAAEC,MAAM,CAACzB,IAAI,EAAEG,GAAG,CAAC;MAC3BuB,cAAc,EAAEN,gBAAO,CAACO,eAAe,CAACC,GAAG;MAC3CC,YAAY,EAAET,gBAAO,CAACU,aAAa,CAACC,OAAO;MAC3CC,WAAW,EAAErC,IAAI;MACjBsC,KAAK,EAAE;QACLf,EAAE,EAAEO,MAAM,CAAChC,GAAG,CAACuB,IAAI,CAACb,GAAG,CAAC;QACxB+B,IAAI,EAAEzC,GAAG,CAACuB,IAAI,EAAEkB,IAAI;QACpBC,OAAO,EAAE1C,GAAG,CAACuB,IAAI,EAAEmB,OAAO;QAC1BC,SAAS,EAAE3C,GAAG,CAACuB,IAAI,EAAEqB,WAAW;QAChCC,KAAK,EAAE7C,GAAG,CAACuB,IAAI,EAAEsB,KAAK;QACtBC,cAAc,EAAE9C,GAAG,CAACuB,IAAI,EAAEuB,cAAc;QACxCC,aAAa,EAAE,IAAAC,eAAM,EAAChD,GAAG,CAACuB,IAAI,EAAE0B,SAAS,CAAC,CAACC,MAAM,CAC/C,qBACF,CAAC;QAAE;QACHC,gBAAgB,EAAE,IAAAH,eAAM,EAAChD,GAAG,CAACuB,IAAI,EAAE0B,SAAS,CAAC,CAACC,MAAM,CAClD,qBACF,CAAC;QACDE,mBAAmB,EAAEpD,GAAG,CAACuB,IAAI,EAAE8B,OAAO;QACtCC,EAAE,EAAEtD,GAAG,CAACuB,IAAI,EAAE+B,EAAE;QAChBC,IAAI,EAAEvD,GAAG,CAACuB,IAAI,EAAEgC,IAAI;QACpBC,OAAO,EAAExD,GAAG,CAACuB,IAAI,EAAEiC,OAAO;QAC1BC,OAAO,EAAEzD,GAAG,CAACuB,IAAI,EAAEkC;MACrB,CAAC;MACDC,eAAe,EAAE;QACfC,WAAW,EAAE3D,GAAG,CAACuB,IAAI,EAAEkB,IAAI,GAAG,EAAE,GAAGzC,GAAG,CAACuB,IAAI,EAAEmB,OAAO;QACpDa,IAAI,EAAEvD,GAAG,CAACuB,IAAI,EAAEgC,IAAI;QACpBC,OAAO,EAAExD,GAAG,CAACuB,IAAI,EAAEiC,OAAO;QAC1BH,OAAO,EAAErD,GAAG,CAACuB,IAAI,EAAE8B,OAAO;QAC1BI,OAAO,EAAEzD,GAAG,CAACuB,IAAI,EAAEkC;MACrB,CAAC;MACDG,cAAc,EAAE;QACdD,WAAW,EAAE3D,GAAG,CAACuB,IAAI,EAAEkB,IAAI,GAAG,EAAE,GAAGzC,GAAG,CAACuB,IAAI,EAAEmB,OAAO;QACpDa,IAAI,EAAEvD,GAAG,CAACuB,IAAI,EAAEgC,IAAI;QACpBC,OAAO,EAAExD,GAAG,CAACuB,IAAI,EAAEiC,OAAO;QAC1BH,OAAO,EAAErD,GAAG,CAACuB,IAAI,EAAE8B,OAAO;QAC1BI,OAAO,EAAEzD,GAAG,CAACuB,IAAI,EAAEkC;MACrB,CAAC;MACDI,WAAW,EAAEtD,IAAI,CAACQ,QAAQ,CAACC,GAAG,CAAC,CAACC,OAAO,EAAE6C,KAAK,KAAK;QACjD,OAAO;UACLrC,EAAE,EAAEO,MAAM,CAACf,OAAO,EAAEP,GAAG,CAAC;UACxB+B,IAAI,EAAExB,OAAO,EAAEwB,IAAI;UACnBsB,SAAS,EAAE9C,OAAO,CAAC+C,UAAU,CAAC,CAAC,CAAC;UAChCC,SAAS,EAAEhD,OAAO,CAAC+C,UAAU,CAAC,CAAC,CAAC;UAChCE,QAAQ,EAAEvC,gBAAO,CAACwC,gBAAgB,CAAClD,OAAO,EAAEiD,QAAQ,CAAC;UACrDhD,KAAK,EAAED,OAAO,EAAEC;QAClB,CAAC;MACH,CAAC;IACH,CAAC;IAED,IAAIkD,MAAM,GAAG,MAAMjG,QAAQ,CAACkG,aAAa,CAAChD,IAAI,CAAC;IAC/C,MAAM,IAAAiD,0BAAe,EAACF,MAAM,CAAC;IAC7BnE,GAAG,CAACsE,IAAI,CAACH,MAAM,CAAC;EAClB,CACF,CAAC;AACH,CAAC;AAAAc,OAAA,CAAApG,OAAA,GAAAc,QAAA","ignoreList":[]}},"mtime":1723544779433},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/payments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createPayment = void 0;\nvar _iyzipay = _interopRequireDefault(require(\"../connection/iyzipay\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst createPayment = data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.payment.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.createPayment = createPayment;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaXl6aXBheSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiY3JlYXRlUGF5bWVudCIsImRhdGEiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIml5emlwYXkiLCJwYXltZW50IiwiY3JlYXRlIiwiZXJyIiwicmVzdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3NlcnZpY2VzL2l5emljby9tZXRob2RzLyIsInNvdXJjZXMiOlsicGF5bWVudHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGl5emlwYXkgZnJvbSBcIi4uL2Nvbm5lY3Rpb24vaXl6aXBheVwiO1xuXG5leHBvcnQgY29uc3QgY3JlYXRlUGF5bWVudCA9IChkYXRhKSA9PiB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgaXl6aXBheS5wYXltZW50LmNyZWF0ZShkYXRhLCAoZXJyLCByZXN1bHQpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsUUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQTRDLFNBQUFELHVCQUFBRSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBRXJDLE1BQU1HLGFBQWEsR0FBSUMsSUFBSSxJQUFLO0VBQ3JDLE9BQU8sSUFBSUMsT0FBTyxDQUFDLENBQUNDLE9BQU8sRUFBRUMsTUFBTSxLQUFLO0lBQ3RDQyxnQkFBTyxDQUFDQyxPQUFPLENBQUNDLE1BQU0sQ0FBQ04sSUFBSSxFQUFFLENBQUNPLEdBQUcsRUFBRUMsTUFBTSxLQUFLO01BQzVDLElBQUlELEdBQUcsRUFBRTtRQUNQSixNQUFNLENBQUNJLEdBQUcsQ0FBQztNQUNiLENBQUMsTUFBTTtRQUNMTCxPQUFPLENBQUNNLE1BQU0sQ0FBQztNQUNqQjtJQUNGLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztBQUNKLENBQUM7QUFBQ0MsT0FBQSxDQUFBVixhQUFBLEdBQUFBLGFBQUEiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_iyzipay","_interopRequireDefault","require","e","__esModule","default","createPayment","data","Promise","resolve","reject","iyzipay","payment","create","err","result","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/","sources":["payments.js"],"sourcesContent":["import iyzipay from \"../connection/iyzipay\";\n\nexport const createPayment = (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.payment.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA4C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAErC,MAAMG,aAAa,GAAIC,IAAI,IAAK;EACrC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,OAAO,CAACC,MAAM,CAACN,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MAC5C,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAV,aAAA,GAAAA,aAAA","ignoreList":[]}},"mtime":1723543937124},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/connection/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/connection/iyzipay.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _iyzipay = _interopRequireDefault(require(\"iyzipay\"));\nvar _config = _interopRequireDefault(require(\"../config/config\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst iyzipay = new _iyzipay.default(_config.default);\nvar _default = exports.default = iyzipay;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaXl6aXBheSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2NvbmZpZyIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIml5emlwYXkiLCJJeXppcGF5IiwiY29uZmlnIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvc2VydmljZXMvaXl6aWNvL2Nvbm5lY3Rpb24vIiwic291cmNlcyI6WyJpeXppcGF5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBJeXppcGF5IGZyb20gXCJpeXppcGF5XCI7XG5pbXBvcnQgY29uZmlnIGZyb20gXCIuLi9jb25maWcvY29uZmlnXCI7XG5cbmNvbnN0IGl5emlwYXkgPSBuZXcgSXl6aXBheShjb25maWcpO1xuXG5leHBvcnQgZGVmYXVsdCBpeXppcGF5O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxRQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxPQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFBc0MsU0FBQUQsdUJBQUFHLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFdEMsTUFBTUcsT0FBTyxHQUFHLElBQUlDLGdCQUFPLENBQUNDLGVBQU0sQ0FBQztBQUFDLElBQUFDLFFBQUEsR0FBQUMsT0FBQSxDQUFBTCxPQUFBLEdBRXJCQyxPQUFPIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["_iyzipay","_interopRequireDefault","require","_config","e","__esModule","default","iyzipay","Iyzipay","config","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/connection/","sources":["iyzipay.js"],"sourcesContent":["import Iyzipay from \"iyzipay\";\nimport config from \"../config/config\";\n\nconst iyzipay = new Iyzipay(config);\n\nexport default iyzipay;\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,OAAA,GAAAF,sBAAA,CAAAC,OAAA;AAAsC,SAAAD,uBAAAG,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEtC,MAAMG,OAAO,GAAG,IAAIC,gBAAO,CAACC,eAAM,CAAC;AAAC,IAAAC,QAAA,GAAAC,OAAA,CAAAL,OAAA,GAErBC,OAAO","ignoreList":[]}},"mtime":1723543937086},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/config/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/config/config.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nmodule.exports = {\n  apiKey: \"sandbox-bkqCdxvCL1VB4bIisfgw9jIjhGHnanvp\",\n  secretKey: \"sandbox-cYCcsyTLYHxCN92Qqw24QbKRxXuJnXUa\",\n  uri: \"https://sandbox-api.iyzipay.com\"\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb2R1bGUiLCJleHBvcnRzIiwiYXBpS2V5Iiwic2VjcmV0S2V5IiwidXJpIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvc2VydmljZXMvaXl6aWNvL2NvbmZpZy8iLCJzb3VyY2VzIjpbImNvbmZpZy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJtb2R1bGUuZXhwb3J0cyA9IHtcbiAgYXBpS2V5OiBcInNhbmRib3gtYmtxQ2R4dkNMMVZCNGJJaXNmZ3c5aklqaEdIbmFudnBcIixcbiAgc2VjcmV0S2V5OiBcInNhbmRib3gtY1lDY3N5VExZSHhDTjkyUXF3MjRRYktSeFh1Sm5YVWFcIixcbiAgdXJpOiBcImh0dHBzOi8vc2FuZGJveC1hcGkuaXl6aXBheS5jb21cIixcbn07XG4iXSwibWFwcGluZ3MiOiI7O0FBQUFBLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHO0VBQ2ZDLE1BQU0sRUFBRSwwQ0FBMEM7RUFDbERDLFNBQVMsRUFBRSwwQ0FBMEM7RUFDckRDLEdBQUcsRUFBRTtBQUNQLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["module","exports","apiKey","secretKey","uri"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/config/","sources":["config.js"],"sourcesContent":["module.exports = {\n  apiKey: \"sandbox-bkqCdxvCL1VB4bIisfgw9jIjhGHnanvp\",\n  secretKey: \"sandbox-cYCcsyTLYHxCN92Qqw24QbKRxXuJnXUa\",\n  uri: \"https://sandbox-api.iyzipay.com\",\n};\n"],"mappings":";;AAAAA,MAAM,CAACC,OAAO,GAAG;EACfC,MAAM,EAAE,0CAA0C;EAClDC,SAAS,EAAE,0CAA0C;EACrDC,GAAG,EAAE;AACP,CAAC","ignoreList":[]}},"mtime":1723543900879},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/cards.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar Cards = _interopRequireWildcard(require(\"../services/iyzico/methods/cards\"));\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function (e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\n//varolan kullanıcıya kart ekleme methodu (yeni kart ekliyor o yüzden var olan db verisinin içerisine yeni satır ile cardUserKey eklendi)\nvar _default = router => {\n  //session koyma sebebi kullanıcı login olduğu zaman bu sayfaya erişeceği için\n  router.post(\"/cards\", _Session.default, async (req, res) => {\n    const {\n      card\n    } = req.body;\n    let result = await Cards.createUserCard({\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      email: req.user.email,\n      externalId: (0, _uuid.default)(),\n      ...(req.user?.cardUserKey && {\n        cardUserKey: req.user.cardUserKey\n      }),\n      card: card\n    });\n    if (!req.user.cardUserKey) {\n      if (result?.status === \"success\" && result?.cardUserKey) {\n        const user = await _users.default.findOne({\n          _id: req.user?._id\n        });\n        user.cardUserKey = result?.cardUserKey;\n        await user.save();\n      }\n    }\n    res.json(result);\n  });\n\n  //kullanıcıya ait olan kartları okuma\n  router.get(\"/cards\", _Session.default, async (req, res) => {\n    if (!req.user?.cardUserKey) {\n      throw new _ApiError.default(\"User has no credit card\", 403, \"userHasNoCard\");\n    }\n    let cards = await Cards.getUserCards({\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      cardUserKey: req.user?.cardUserKey\n    });\n    res.status(200).json(cards);\n  });\n\n  //kullanıcıya tanımlı olan kartı silmek\n  router.delete(\"/cards/delete-by-token\", _Session.default, async (req, res) => {\n    const {\n      cardToken\n    } = req.body;\n    if (!cardToken) {\n      throw new _ApiError.default(\"Card token is required\", 400, \"cardTokenRequired\");\n    }\n    let deleteResult = await Cards.deleteUserCard({\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      cardUserKey: req.user?.cardUserKey,\n      cardToken: cardToken\n    });\n    res.status(200).json(deleteResult);\n  });\n\n  //kart silme index\n  router.delete(\"/cards/:cardIndex/delete-by-index\", _Session.default, async (req, res) => {\n    if (!req.params?.cardIndex) {\n      throw new _ApiError.default(\"Card Index is required\", 400, \"cardIndexRequired\");\n    }\n    let cards = await Cards.getUserCards({\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      cardUserKey: req.user?.cardUserKey\n    });\n    const index = parseInt(req.params?.cardIndex); //urldeki cardIndex kısmındaki sayıyı int olarak alır(defaultu string normalde)\n    if (index >= cards?.cardDetails.length) {\n      throw new _ApiError.default(\"Card Does not exists\", 400, \"cardIndexInvalid\");\n    }\n    const {\n      cardToken\n    } = cards?.cardDetails[index];\n    let deleteResult = await Cards.deleteUserCard({\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      cardUserKey: req.user?.cardUserKey,\n      cardToken: cardToken\n    });\n    res.json(deleteResult);\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQXBpRXJyb3IiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIkNhcmRzIiwiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJfdXNlcnMiLCJfdXVpZCIsIl9TZXNzaW9uIiwiX2dldFJlcXVpcmVXaWxkY2FyZENhY2hlIiwiZSIsIldlYWtNYXAiLCJyIiwidCIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiaGFzIiwiZ2V0IiwibiIsIl9fcHJvdG9fXyIsImEiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsInUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJpIiwic2V0IiwiX2RlZmF1bHQiLCJyb3V0ZXIiLCJwb3N0IiwiU2Vzc2lvbiIsInJlcSIsInJlcyIsImNhcmQiLCJib2R5IiwicmVzdWx0IiwiY3JlYXRlVXNlckNhcmQiLCJsb2NhbGUiLCJ1c2VyIiwiY29udmVyc2F0aW9uSWQiLCJpZCIsImVtYWlsIiwiZXh0ZXJuYWxJZCIsImNhcmRVc2VyS2V5Iiwic3RhdHVzIiwiVXNlcnMiLCJmaW5kT25lIiwiX2lkIiwic2F2ZSIsImpzb24iLCJBcGlFcnJvciIsImNhcmRzIiwiZ2V0VXNlckNhcmRzIiwiZGVsZXRlIiwiY2FyZFRva2VuIiwiZGVsZXRlUmVzdWx0IiwiZGVsZXRlVXNlckNhcmQiLCJwYXJhbXMiLCJjYXJkSW5kZXgiLCJpbmRleCIsInBhcnNlSW50IiwiY2FyZERldGFpbHMiLCJsZW5ndGgiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvcm91dGVzLyIsInNvdXJjZXMiOlsiY2FyZHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuLi9lcnJvcnMvQXBpRXJyb3JcIjtcbmltcG9ydCAqIGFzIENhcmRzIGZyb20gXCIuLi9zZXJ2aWNlcy9peXppY28vbWV0aG9kcy9jYXJkc1wiO1xuaW1wb3J0IFVzZXJzIGZyb20gXCIuLi9kYi91c2Vyc1wiO1xuaW1wb3J0IGlkIGZyb20gXCIuLi91dGlscy91dWlkXCI7XG5pbXBvcnQgU2Vzc2lvbiBmcm9tIFwiLi4vbWlkZGxld2FyZXMvU2Vzc2lvblwiO1xuXG4vL3Zhcm9sYW4ga3VsbGFuxLFjxLF5YSBrYXJ0IGVrbGVtZSBtZXRob2R1ICh5ZW5pIGthcnQgZWtsaXlvciBvIHnDvHpkZW4gdmFyIG9sYW4gZGIgdmVyaXNpbmluIGnDp2VyaXNpbmUgeWVuaSBzYXTEsXIgaWxlIGNhcmRVc2VyS2V5IGVrbGVuZGkpXG5leHBvcnQgZGVmYXVsdCAocm91dGVyKSA9PiB7XG4gIC8vc2Vzc2lvbiBrb3ltYSBzZWJlYmkga3VsbGFuxLFjxLEgbG9naW4gb2xkdcSfdSB6YW1hbiBidSBzYXlmYXlhIGVyacWfZWNlxJ9pIGnDp2luXG4gIHJvdXRlci5wb3N0KFwiL2NhcmRzXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGNvbnN0IHsgY2FyZCB9ID0gcmVxLmJvZHk7XG4gICAgbGV0IHJlc3VsdCA9IGF3YWl0IENhcmRzLmNyZWF0ZVVzZXJDYXJkKHtcbiAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICBlbWFpbDogcmVxLnVzZXIuZW1haWwsXG4gICAgICBleHRlcm5hbElkOiBpZCgpLFxuICAgICAgLi4uKHJlcS51c2VyPy5jYXJkVXNlcktleSAmJiB7XG4gICAgICAgIGNhcmRVc2VyS2V5OiByZXEudXNlci5jYXJkVXNlcktleSxcbiAgICAgIH0pLFxuICAgICAgY2FyZDogY2FyZCxcbiAgICB9KTtcbiAgICBpZiAoIXJlcS51c2VyLmNhcmRVc2VyS2V5KSB7XG4gICAgICBpZiAocmVzdWx0Py5zdGF0dXMgPT09IFwic3VjY2Vzc1wiICYmIHJlc3VsdD8uY2FyZFVzZXJLZXkpIHtcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXJzLmZpbmRPbmUoe1xuICAgICAgICAgIF9pZDogcmVxLnVzZXI/Ll9pZCxcbiAgICAgICAgfSk7XG4gICAgICAgIHVzZXIuY2FyZFVzZXJLZXkgPSByZXN1bHQ/LmNhcmRVc2VyS2V5O1xuICAgICAgICBhd2FpdCB1c2VyLnNhdmUoKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmVzLmpzb24ocmVzdWx0KTtcbiAgfSk7XG5cbiAgLy9rdWxsYW7EsWPEsXlhIGFpdCBvbGFuIGthcnRsYXLEsSBva3VtYVxuICByb3V0ZXIuZ2V0KFwiL2NhcmRzXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGlmICghcmVxLnVzZXI/LmNhcmRVc2VyS2V5KSB7XG4gICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJVc2VyIGhhcyBubyBjcmVkaXQgY2FyZFwiLCA0MDMsIFwidXNlckhhc05vQ2FyZFwiKTtcbiAgICB9XG4gICAgbGV0IGNhcmRzID0gYXdhaXQgQ2FyZHMuZ2V0VXNlckNhcmRzKHtcbiAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICBjYXJkVXNlcktleTogcmVxLnVzZXI/LmNhcmRVc2VyS2V5LFxuICAgIH0pO1xuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKGNhcmRzKTtcbiAgfSk7XG5cbiAgLy9rdWxsYW7EsWPEsXlhIHRhbsSxbWzEsSBvbGFuIGthcnTEsSBzaWxtZWtcbiAgcm91dGVyLmRlbGV0ZShcIi9jYXJkcy9kZWxldGUtYnktdG9rZW5cIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyBjYXJkVG9rZW4gfSA9IHJlcS5ib2R5O1xuICAgIGlmICghY2FyZFRva2VuKSB7XG4gICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIHRva2VuIGlzIHJlcXVpcmVkXCIsIDQwMCwgXCJjYXJkVG9rZW5SZXF1aXJlZFwiKTtcbiAgICB9XG4gICAgbGV0IGRlbGV0ZVJlc3VsdCA9IGF3YWl0IENhcmRzLmRlbGV0ZVVzZXJDYXJkKHtcbiAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICBjYXJkVXNlcktleTogcmVxLnVzZXI/LmNhcmRVc2VyS2V5LFxuICAgICAgY2FyZFRva2VuOiBjYXJkVG9rZW4sXG4gICAgfSk7XG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oZGVsZXRlUmVzdWx0KTtcbiAgfSk7XG5cbiAgLy9rYXJ0IHNpbG1lIGluZGV4XG4gIHJvdXRlci5kZWxldGUoXG4gICAgXCIvY2FyZHMvOmNhcmRJbmRleC9kZWxldGUtYnktaW5kZXhcIixcbiAgICBTZXNzaW9uLFxuICAgIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgICAgaWYgKCFyZXEucGFyYW1zPy5jYXJkSW5kZXgpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FyZCBJbmRleCBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FyZEluZGV4UmVxdWlyZWRcIik7XG4gICAgICB9XG4gICAgICBsZXQgY2FyZHMgPSBhd2FpdCBDYXJkcy5nZXRVc2VyQ2FyZHMoe1xuICAgICAgICBsb2NhbGU6IHJlcS51c2VyLmxvY2FsZSxcbiAgICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICAgIGNhcmRVc2VyS2V5OiByZXEudXNlcj8uY2FyZFVzZXJLZXksXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IGluZGV4ID0gcGFyc2VJbnQocmVxLnBhcmFtcz8uY2FyZEluZGV4KTsgLy91cmxkZWtpIGNhcmRJbmRleCBrxLFzbcSxbmRha2kgc2F5xLF5xLEgaW50IG9sYXJhayBhbMSxcihkZWZhdWx0dSBzdHJpbmcgbm9ybWFsZGUpXG4gICAgICBpZiAoaW5kZXggPj0gY2FyZHM/LmNhcmREZXRhaWxzLmxlbmd0aCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIERvZXMgbm90IGV4aXN0c1wiLCA0MDAsIFwiY2FyZEluZGV4SW52YWxpZFwiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgY2FyZFRva2VuIH0gPSBjYXJkcz8uY2FyZERldGFpbHNbaW5kZXhdO1xuICAgICAgbGV0IGRlbGV0ZVJlc3VsdCA9IGF3YWl0IENhcmRzLmRlbGV0ZVVzZXJDYXJkKHtcbiAgICAgICAgbG9jYWxlOiByZXEudXNlci5sb2NhbGUsXG4gICAgICAgIGNvbnZlcnNhdGlvbklkOiBpZCgpLFxuICAgICAgICBjYXJkVXNlcktleTogcmVxLnVzZXI/LmNhcmRVc2VyS2V5LFxuICAgICAgICBjYXJkVG9rZW46IGNhcmRUb2tlbixcbiAgICAgIH0pO1xuXG4gICAgICByZXMuanNvbihkZWxldGVSZXN1bHQpO1xuICAgIH1cbiAgKTtcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLEtBQUEsR0FBQUMsdUJBQUEsQ0FBQUYsT0FBQTtBQUNBLElBQUFHLE1BQUEsR0FBQUosc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFJLEtBQUEsR0FBQUwsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFLLFFBQUEsR0FBQU4sc0JBQUEsQ0FBQUMsT0FBQTtBQUE2QyxTQUFBTSx5QkFBQUMsQ0FBQSw2QkFBQUMsT0FBQSxtQkFBQUMsQ0FBQSxPQUFBRCxPQUFBLElBQUFFLENBQUEsT0FBQUYsT0FBQSxZQUFBRix3QkFBQSxZQUFBQSxDQUFBQyxDQUFBLFdBQUFBLENBQUEsR0FBQUcsQ0FBQSxHQUFBRCxDQUFBLEtBQUFGLENBQUE7QUFBQSxTQUFBTCx3QkFBQUssQ0FBQSxFQUFBRSxDQUFBLFNBQUFBLENBQUEsSUFBQUYsQ0FBQSxJQUFBQSxDQUFBLENBQUFJLFVBQUEsU0FBQUosQ0FBQSxlQUFBQSxDQUFBLHVCQUFBQSxDQUFBLHlCQUFBQSxDQUFBLFdBQUFLLE9BQUEsRUFBQUwsQ0FBQSxRQUFBRyxDQUFBLEdBQUFKLHdCQUFBLENB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","map":{"version":3,"names":["_ApiError","_interopRequireDefault","require","Cards","_interopRequireWildcard","_users","_uuid","_Session","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","_default","router","post","Session","req","res","card","body","result","createUserCard","locale","user","conversationId","id","email","externalId","cardUserKey","status","Users","findOne","_id","save","json","ApiError","cards","getUserCards","delete","cardToken","deleteResult","deleteUserCard","params","cardIndex","index","parseInt","cardDetails","length","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["cards.js"],"sourcesContent":["import ApiError from \"../errors/ApiError\";\nimport * as Cards from \"../services/iyzico/methods/cards\";\nimport Users from \"../db/users\";\nimport id from \"../utils/uuid\";\nimport Session from \"../middlewares/Session\";\n\n//varolan kullanıcıya kart ekleme methodu (yeni kart ekliyor o yüzden var olan db verisinin içerisine yeni satır ile cardUserKey eklendi)\nexport default (router) => {\n  //session koyma sebebi kullanıcı login olduğu zaman bu sayfaya erişeceği için\n  router.post(\"/cards\", Session, async (req, res) => {\n    const { card } = req.body;\n    let result = await Cards.createUserCard({\n      locale: req.user.locale,\n      conversationId: id(),\n      email: req.user.email,\n      externalId: id(),\n      ...(req.user?.cardUserKey && {\n        cardUserKey: req.user.cardUserKey,\n      }),\n      card: card,\n    });\n    if (!req.user.cardUserKey) {\n      if (result?.status === \"success\" && result?.cardUserKey) {\n        const user = await Users.findOne({\n          _id: req.user?._id,\n        });\n        user.cardUserKey = result?.cardUserKey;\n        await user.save();\n      }\n    }\n    res.json(result);\n  });\n\n  //kullanıcıya ait olan kartları okuma\n  router.get(\"/cards\", Session, async (req, res) => {\n    if (!req.user?.cardUserKey) {\n      throw new ApiError(\"User has no credit card\", 403, \"userHasNoCard\");\n    }\n    let cards = await Cards.getUserCards({\n      locale: req.user.locale,\n      conversationId: id(),\n      cardUserKey: req.user?.cardUserKey,\n    });\n    res.status(200).json(cards);\n  });\n\n  //kullanıcıya tanımlı olan kartı silmek\n  router.delete(\"/cards/delete-by-token\", Session, async (req, res) => {\n    const { cardToken } = req.body;\n    if (!cardToken) {\n      throw new ApiError(\"Card token is required\", 400, \"cardTokenRequired\");\n    }\n    let deleteResult = await Cards.deleteUserCard({\n      locale: req.user.locale,\n      conversationId: id(),\n      cardUserKey: req.user?.cardUserKey,\n      cardToken: cardToken,\n    });\n    res.status(200).json(deleteResult);\n  });\n\n  //kart silme index\n  router.delete(\n    \"/cards/:cardIndex/delete-by-index\",\n    Session,\n    async (req, res) => {\n      if (!req.params?.cardIndex) {\n        throw new ApiError(\"Card Index is required\", 400, \"cardIndexRequired\");\n      }\n      let cards = await Cards.getUserCards({\n        locale: req.user.locale,\n        conversationId: id(),\n        cardUserKey: req.user?.cardUserKey,\n      });\n      const index = parseInt(req.params?.cardIndex); //urldeki cardIndex kısmındaki sayıyı int olarak alır(defaultu string normalde)\n      if (index >= cards?.cardDetails.length) {\n        throw new ApiError(\"Card Does not exists\", 400, \"cardIndexInvalid\");\n      }\n      const { cardToken } = cards?.cardDetails[index];\n      let deleteResult = await Cards.deleteUserCard({\n        locale: req.user.locale,\n        conversationId: id(),\n        cardUserKey: req.user?.cardUserKey,\n        cardToken: cardToken,\n      });\n\n      res.json(deleteResult);\n    }\n  );\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1723548985715},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/cards.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getUserCards = exports.deleteUserCard = exports.createUserCard = void 0;\nvar _iyzipay = _interopRequireDefault(require(\"../connection/iyzipay\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst createUserCard = async data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.card.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.createUserCard = createUserCard;\nconst getUserCards = async data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.cardList.retrieve(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.getUserCards = getUserCards;\nconst deleteUserCard = async data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.card.delete(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.deleteUserCard = deleteUserCard;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaXl6aXBheSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiY3JlYXRlVXNlckNhcmQiLCJkYXRhIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJpeXppcGF5IiwiY2FyZCIsImNyZWF0ZSIsImVyciIsInJlc3VsdCIsImV4cG9ydHMiLCJnZXRVc2VyQ2FyZHMiLCJjYXJkTGlzdCIsInJldHJpZXZlIiwiZGVsZXRlVXNlckNhcmQiLCJkZWxldGUiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9zZXJ2aWNlcy9peXppY28vbWV0aG9kcy8iLCJzb3VyY2VzIjpbImNhcmRzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBpeXppcGF5IGZyb20gXCIuLi9jb25uZWN0aW9uL2l5emlwYXlcIjtcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZVVzZXJDYXJkID0gYXN5bmMgKGRhdGEpID0+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBpeXppcGF5LmNhcmQuY3JlYXRlKGRhdGEsIChlcnIsIHJlc3VsdCkgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0VXNlckNhcmRzID0gYXN5bmMgKGRhdGEpID0+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBpeXppcGF5LmNhcmRMaXN0LnJldHJpZXZlKGRhdGEsIChlcnIsIHJlc3VsdCkgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59O1xuXG5leHBvcnQgY29uc3QgZGVsZXRlVXNlckNhcmQgPSBhc3luYyAoZGF0YSkgPT4ge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGl5emlwYXkuY2FyZC5kZWxldGUoZGF0YSwgKGVyciwgcmVzdWx0KSA9PiB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFFBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUE0QyxTQUFBRCx1QkFBQUUsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUVyQyxNQUFNRyxjQUFjLEdBQUcsTUFBT0MsSUFBSSxJQUFLO0VBQzVDLE9BQU8sSUFBSUMsT0FBTyxDQUFDLENBQUNDLE9BQU8sRUFBRUMsTUFBTSxLQUFLO0lBQ3RDQyxnQkFBTyxDQUFDQyxJQUFJLENBQUNDLE1BQU0sQ0FBQ04sSUFBSSxFQUFFLENBQUNPLEdBQUcsRUFBRUMsTUFBTSxLQUFLO01BQ3pDLElBQUlELEdBQUcsRUFBRTtRQUNQSixNQUFNLENBQUNJLEdBQUcsQ0FBQztNQUNiLENBQUMsTUFBTTtRQUNMTCxPQUFPLENBQUNNLE1BQU0sQ0FBQztNQUNqQjtJQUNGLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztBQUNKLENBQUM7QUFBQ0MsT0FBQSxDQUFBVixjQUFBLEdBQUFBLGNBQUE7QUFFSyxNQUFNVyxZQUFZLEdBQUcsTUFBT1YsSUFBSSxJQUFLO0VBQzFDLE9BQU8sSUFBSUMsT0FBTyxDQUFDLENBQUNDLE9BQU8sRUFBRUMsTUFBTSxLQUFLO0lBQ3RDQyxnQkFBTyxDQUFDTyxRQUFRLENBQUNDLFFBQVEsQ0FBQ1osSUFBSSxFQUFFLENBQUNPLEdBQUcsRUFBRUMsTUFBTSxLQUFLO01BQy9DLElBQUlELEdBQUcsRUFBRTtRQUNQSixNQUFNLENBQUNJLEdBQUcsQ0FBQztNQUNiLENBQUMsTUFBTTtRQUNMTCxPQUFPLENBQUNNLE1BQU0sQ0FBQztNQUNqQjtJQUNGLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztBQUNKLENBQUM7QUFBQ0MsT0FBQSxDQUFBQyxZQUFBLEdBQUFBLFlBQUE7QUFFSyxNQUFNRyxjQUFjLEdBQUcsTUFBT2IsSUFBSSxJQUFLO0VBQzVDLE9BQU8sSUFBSUMsT0FBTyxDQUFDLENBQUNDLE9BQU8sRUFBRUMsTUFBTSxLQUFLO0lBQ3RDQyxnQkFBTyxDQUFDQyxJQUFJLENBQUNTLE1BQU0sQ0FBQ2QsSUFBSSxFQUFFLENBQUNPLEdBQUcsRUFBRUMsTUFBTSxLQUFLO01BQ3pDLElBQUlELEdBQUcsRUFBRTtRQUNQSixNQUFNLENBQUNJLEdBQUcsQ0FBQztNQUNiLENBQUMsTUFBTTtRQUNMTCxPQUFPLENBQUNNLE1BQU0sQ0FBQztNQUNqQjtJQUNGLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztBQUNKLENBQUM7QUFBQ0MsT0FBQSxDQUFBSSxjQUFBLEdBQUFBLGNBQUEiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_iyzipay","_interopRequireDefault","require","e","__esModule","default","createUserCard","data","Promise","resolve","reject","iyzipay","card","create","err","result","exports","getUserCards","cardList","retrieve","deleteUserCard","delete"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/","sources":["cards.js"],"sourcesContent":["import iyzipay from \"../connection/iyzipay\";\n\nexport const createUserCard = async (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.card.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n\nexport const getUserCards = async (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.cardList.retrieve(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n\nexport const deleteUserCard = async (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.card.delete(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA4C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAErC,MAAMG,cAAc,GAAG,MAAOC,IAAI,IAAK;EAC5C,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,IAAI,CAACC,MAAM,CAACN,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MACzC,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAV,cAAA,GAAAA,cAAA;AAEK,MAAMW,YAAY,GAAG,MAAOV,IAAI,IAAK;EAC1C,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACO,QAAQ,CAACC,QAAQ,CAACZ,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MAC/C,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAC,YAAA,GAAAA,YAAA;AAEK,MAAMG,cAAc,GAAG,MAAOb,IAAI,IAAK;EAC5C,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,IAAI,CAACS,MAAM,CAACd,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MACzC,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAI,cAAA,GAAAA,cAAA","ignoreList":[]}},"mtime":1723543937120}}