{"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/app.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[],\"presets\":[]}:7.24.9:development":{"value":{"code":"import \"express-async-errors\";\nimport { ExtractJwt, Strategy as JwtStrategy } from \"passport-jwt\";\nimport dotenv from \"dotenv\";\nimport config from \"../src/config\";\nimport express from \"express\";\nimport logger from \"morgan\";\nimport fs from \"fs\";\nimport https from \"https\";\nimport path from \"path\";\nimport GenericErrorHandler from \"./middlewares/GenericErrorHandler\";\nimport ApiError from \"./errors/ApiError\";\nimport helmet from \"helmet\";\nimport cors from \"cors\";\nimport mongoose from \"mongoose\";\nimport passport from \"passport\";\nimport Session from \"./middlewares/Session\";\nimport routes from \"./routes/index\";\nimport DBModels from \"./db/index\";\nimport Users from \"./db/users\";\nconst envPath = config?.production ? \"./env/.prod\" : \"./env/.dev\";\ndotenv.config({\n  path: envPath\n});\nmongoose.connect(process.env.MONGO_URI, {\n  useNewUrlParser: true,\n  useUnifiedTopology: true\n}).then(() => {\n  console.log(\"connected on mongoDB\");\n}).catch(err => {\n  console.log(err);\n});\nconst app = express();\nconst router = express.Router();\napp.use(logger(process.env.LOGGER));\napp.use(helmet());\napp.use(cors({\n  origin: \"*\"\n}));\napp.use(express.json({\n  limit: \"1mb\"\n}));\napp.use(express.urlencoded({\n  extended: true\n}));\npassport.serializeUser((user, done) => {\n  done(null, user);\n});\npassport.deserializeUser((id, done) => {\n  done(null, id);\n});\napp.use(passport.initialize());\nconst jwtOps = {\n  jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),\n  secretOrKey: process.env.JWT_SECRET\n};\npassport.use(new JwtStrategy(jwtOps, async (jwtPayload, done) => {\n  try {\n    const user = await Users.findOne({\n      _id: jwtPayload._id\n    });\n    if (user) {\n      done(null, user.toJSON());\n    } else {\n      done(new ApiError(\"Authorization is not valid\", 401, \"authorizationInvalid\"), false);\n    }\n  } catch (err) {\n    return done(err, false);\n  }\n}));\nroutes.forEach((routeFunc, index) => {\n  routeFunc(router);\n});\napp.use(\"/api\", router);\napp.all(\"/test-auth\", Session, (req, res) => {\n  res.json({\n    test: true\n  });\n});\napp.use(GenericErrorHandler);\nif (process.env.HTTPS_ENABLED === \"true\") {\n  const key = fs.readFileSync(path.join(__dirname, \"./certs/key.pem\")).toString();\n  const cert = fs.readFileSync(path.join(__dirname, \"./certs/cert.pem\")).toString();\n  const server = https.createServer({\n    key: key,\n    cert: cert\n  }, app);\n  server.listen(process.env.PORT, () => {\n    console.log(`Application is running on port =  ${process.env.PORT}`);\n  });\n} else {\n  app.listen(process.env.PORT, () => {\n    console.log(`Application is running on port =  ${process.env.PORT}`);\n  });\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJFeHRyYWN0Snd0IiwiU3RyYXRlZ3kiLCJKd3RTdHJhdGVneSIsImRvdGVudiIsImNvbmZpZyIsImV4cHJlc3MiLCJsb2dnZXIiLCJmcyIsImh0dHBzIiwicGF0aCIsIkdlbmVyaWNFcnJvckhhbmRsZXIiLCJBcGlFcnJvciIsImhlbG1ldCIsImNvcnMiLCJtb25nb29zZSIsInBhc3Nwb3J0IiwiU2Vzc2lvbiIsInJvdXRlcyIsIkRCTW9kZWxzIiwiVXNlcnMiLCJlbnZQYXRoIiwicHJvZHVjdGlvbiIsImNvbm5lY3QiLCJwcm9jZXNzIiwiZW52IiwiTU9OR09fVVJJIiwidXNlTmV3VXJsUGFyc2VyIiwidXNlVW5pZmllZFRvcG9sb2d5IiwidGhlbiIsImNvbnNvbGUiLCJsb2ciLCJjYXRjaCIsImVyciIsImFwcCIsInJvdXRlciIsIlJvdXRlciIsInVzZSIsIkxPR0dFUiIsIm9yaWdpbiIsImpzb24iLCJsaW1pdCIsInVybGVuY29kZWQiLCJleHRlbmRlZCIsInNlcmlhbGl6ZVVzZXIiLCJ1c2VyIiwiZG9uZSIsImRlc2VyaWFsaXplVXNlciIsImlkIiwiaW5pdGlhbGl6ZSIsImp3dE9wcyIsImp3dEZyb21SZXF1ZXN0IiwiZnJvbUF1dGhIZWFkZXJBc0JlYXJlclRva2VuIiwic2VjcmV0T3JLZXkiLCJKV1RfU0VDUkVUIiwiand0UGF5bG9hZCIsImZpbmRPbmUiLCJfaWQiLCJ0b0pTT04iLCJmb3JFYWNoIiwicm91dGVGdW5jIiwiaW5kZXgiLCJhbGwiLCJyZXEiLCJyZXMiLCJ0ZXN0IiwiSFRUUFNfRU5BQkxFRCIsImtleSIsInJlYWRGaWxlU3luYyIsImpvaW4iLCJfX2Rpcm5hbWUiLCJ0b1N0cmluZyIsImNlcnQiLCJzZXJ2ZXIiLCJjcmVhdGVTZXJ2ZXIiLCJsaXN0ZW4iLCJQT1JUIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvIiwic291cmNlcyI6WyJhcHAuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFwiZXhwcmVzcy1hc3luYy1lcnJvcnNcIjtcbmltcG9ydCB7IEV4dHJhY3RKd3QsIFN0cmF0ZWd5IGFzIEp3dFN0cmF0ZWd5IH0gZnJvbSBcInBhc3Nwb3J0LWp3dFwiO1xuaW1wb3J0IGRvdGVudiBmcm9tIFwiZG90ZW52XCI7XG5pbXBvcnQgY29uZmlnIGZyb20gXCIuLi9zcmMvY29uZmlnXCI7XG5pbXBvcnQgZXhwcmVzcyBmcm9tIFwiZXhwcmVzc1wiO1xuaW1wb3J0IGxvZ2dlciBmcm9tIFwibW9yZ2FuXCI7XG5pbXBvcnQgZnMgZnJvbSBcImZzXCI7XG5pbXBvcnQgaHR0cHMgZnJvbSBcImh0dHBzXCI7XG5pbXBvcnQgcGF0aCBmcm9tIFwicGF0aFwiO1xuaW1wb3J0IEdlbmVyaWNFcnJvckhhbmRsZXIgZnJvbSBcIi4vbWlkZGxld2FyZXMvR2VuZXJpY0Vycm9ySGFuZGxlclwiO1xuaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuL2Vycm9ycy9BcGlFcnJvclwiO1xuaW1wb3J0IGhlbG1ldCBmcm9tIFwiaGVsbWV0XCI7XG5pbXBvcnQgY29ycyBmcm9tIFwiY29yc1wiO1xuaW1wb3J0IG1vbmdvb3NlIGZyb20gXCJtb25nb29zZVwiO1xuaW1wb3J0IHBhc3Nwb3J0IGZyb20gXCJwYXNzcG9ydFwiO1xuaW1wb3J0IFNlc3Npb24gZnJvbSBcIi4vbWlkZGxld2FyZXMvU2Vzc2lvblwiO1xuaW1wb3J0IHJvdXRlcyBmcm9tIFwiLi9yb3V0ZXMvaW5kZXhcIjtcbmltcG9ydCBEQk1vZGVscyBmcm9tIFwiLi9kYi9pbmRleFwiO1xuaW1wb3J0IFVzZXJzIGZyb20gXCIuL2RiL3VzZXJzXCI7XG5cbmNvbnN0IGVudlBhdGggPSBjb25maWc/LnByb2R1Y3Rpb24gPyBcIi4vZW52Ly5wcm9kXCIgOiBcIi4vZW52Ly5kZXZcIjtcbmRvdGVudi5jb25maWcoe1xuICBwYXRoOiBlbnZQYXRoLFxufSk7XG5cbm1vbmdvb3NlXG4gIC5jb25uZWN0KHByb2Nlc3MuZW52Lk1PTkdPX1VSSSwge1xuICAgIHVzZU5ld1VybFBhcnNlcjogdHJ1ZSxcbiAgICB1c2VVbmlmaWVkVG9wb2xvZ3k6IHRydWUsXG4gIH0pXG4gIC50aGVuKCgpID0+IHtcbiAgICBjb25zb2xlLmxvZyhcImNvbm5lY3RlZCBvbiBtb25nb0RCXCIpO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4ge1xuICAgIGNvbnNvbGUubG9nKGVycik7XG4gIH0pO1xuXG5jb25zdCBhcHAgPSBleHByZXNzKCk7XG5jb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xuXG5hcHAudXNlKGxvZ2dlcihwcm9jZXNzLmVudi5MT0dHRVIpKTtcbmFwcC51c2UoaGVsbWV0KCkpO1xuYXBwLnVzZShcbiAgY29ycyh7XG4gICAgb3JpZ2luOiBcIipcIixcbiAgfSlcbik7XG5hcHAudXNlKFxuICBleHByZXNzLmpzb24oe1xuICAgIGxpbWl0OiBcIjFtYlwiLFxuICB9KVxuKTtcbmFwcC51c2UoXG4gIGV4cHJlc3MudXJsZW5jb2RlZCh7XG4gICAgZXh0ZW5kZWQ6IHRydWUsXG4gIH0pXG4pO1xuXG5wYXNzcG9ydC5zZXJpYWxpemVVc2VyKCh1c2VyLCBkb25lKSA9PiB7XG4gIGRvbmUobnVsbCwgdXNlcik7XG59KTtcbnBhc3Nwb3J0LmRlc2VyaWFsaXplVXNlcigoaWQsIGRvbmUpID0+IHtcbiAgZG9uZShudWxsLCBpZCk7XG59KTtcblxuYXBwLnVzZShwYXNzcG9ydC5pbml0aWFsaXplKCkpO1xuXG5jb25zdCBqd3RPcHMgPSB7XG4gIGp3dEZyb21SZXF1ZXN0OiBFeHRyYWN0Snd0LmZyb21BdXRoSGVhZGVyQXNCZWFyZXJUb2tlbigpLFxuICBzZWNyZXRPcktleTogcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCxcbn07XG5cbnBhc3Nwb3J0LnVzZShcbiAgbmV3IEp3dFN0cmF0ZWd5KGp3dE9wcywgYXN5bmMgKGp3dFBheWxvYWQsIGRvbmUpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXJzLmZpbmRPbmUoeyBfaWQ6IGp3dFBheWxvYWQuX2lkIH0pO1xuICAgICAgaWYgKHVzZXIpIHtcbiAgICAgICAgZG9uZShudWxsLCB1c2VyLnRvSlNPTigpKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRvbmUoXG4gICAgICAgICAgbmV3IEFwaUVycm9yKFxuICAgICAgICAgICAgXCJBdXRob3JpemF0aW9uIGlzIG5vdCB2YWxpZFwiLFxuICAgICAgICAgICAgNDAxLFxuICAgICAgICAgICAgXCJhdXRob3JpemF0aW9uSW52YWxpZFwiXG4gICAgICAgICAgKSxcbiAgICAgICAgICBmYWxzZVxuICAgICAgICApO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgcmV0dXJuIGRvbmUoZXJyLCBmYWxzZSk7XG4gICAgfVxuICB9KVxuKTtcbnJvdXRlcy5mb3JFYWNoKChyb3V0ZUZ1bmMsIGluZGV4KSA9PiB7XG4gIHJvdXRlRnVuYyhyb3V0ZXIpO1xufSk7XG5cbmFwcC51c2UoXCIvYXBpXCIsIHJvdXRlcik7XG5cbmFwcC5hbGwoXCIvdGVzdC1hdXRoXCIsIFNlc3Npb24sIChyZXEsIHJlcykgPT4ge1xuICByZXMuanNvbih7XG4gICAgdGVzdDogdHJ1ZSxcbiAgfSk7XG59KTtcblxuYXBwLnVzZShHZW5lcmljRXJyb3JIYW5kbGVyKTtcblxuaWYgKHByb2Nlc3MuZW52LkhUVFBTX0VOQUJMRUQgPT09IFwidHJ1ZVwiKSB7XG4gIGNvbnN0IGtleSA9IGZzXG4gICAgLnJlYWRGaWxlU3luYyhwYXRoLmpvaW4oX19kaXJuYW1lLCBcIi4vY2VydHMva2V5LnBlbVwiKSlcbiAgICAudG9TdHJpbmcoKTtcbiAgY29uc3QgY2VydCA9IGZzXG4gICAgLnJlYWRGaWxlU3luYyhwYXRoLmpvaW4oX19kaXJuYW1lLCBcIi4vY2VydHMvY2VydC5wZW1cIikpXG4gICAgLnRvU3RyaW5nKCk7XG4gIGNvbnN0IHNlcnZlciA9IGh0dHBzLmNyZWF0ZVNlcnZlcih7IGtleToga2V5LCBjZXJ0OiBjZXJ0IH0sIGFwcCk7XG5cbiAgc2VydmVyLmxpc3Rlbihwcm9jZXNzLmVudi5QT1JULCAoKSA9PiB7XG4gICAgY29uc29sZS5sb2coYEFwcGxpY2F0aW9uIGlzIHJ1bm5pbmcgb24gcG9ydCA9ICAke3Byb2Nlc3MuZW52LlBPUlR9YCk7XG4gIH0pO1xufSBlbHNlIHtcbiAgYXBwLmxpc3Rlbihwcm9jZXNzLmVudi5QT1JULCAoKSA9PiB7XG4gICAgY29uc29sZS5sb2coYEFwcGxpY2F0aW9uIGlzIHJ1bm5pbmcgb24gcG9ydCA9ICAke3Byb2Nlc3MuZW52LlBPUlR9YCk7XG4gIH0pO1xufVxuIl0sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLHNCQUFzQjtBQUM3QixTQUFTQSxVQUFVLEVBQUVDLFFBQVEsSUFBSUMsV0FBVyxRQUFRLGNBQWM7QUFDbEUsT0FBT0MsTUFBTSxNQUFNLFFBQVE7QUFDM0IsT0FBT0MsTUFBTSxNQUFNLGVBQWU7QUFDbEMsT0FBT0MsT0FBTyxNQUFNLFNBQVM7QUFDN0IsT0FBT0MsTUFBTSxNQUFNLFFBQVE7QUFDM0IsT0FBT0MsRUFBRSxNQUFNLElBQUk7QUFDbkIsT0FBT0MsS0FBSyxNQUFNLE9BQU87QUFDekIsT0FBT0MsSUFBSSxNQUFNLE1BQU07QUFDdkIsT0FBT0MsbUJBQW1CLE1BQU0sbUNBQW1DO0FBQ25FLE9BQU9DLFFBQVEsTUFBTSxtQkFBbUI7QUFDeEMsT0FBT0MsTUFBTSxNQUFNLFFBQVE7QUFDM0IsT0FBT0MsSUFBSSxNQUFNLE1BQU07QUFDdkIsT0FBT0MsUUFBUSxNQUFNLFVBQVU7QUFDL0IsT0FBT0MsUUFBUSxNQUFNLFVBQVU7QUFDL0IsT0FBT0MsT0FBTyxNQUFNLHVCQUF1QjtBQUMzQyxPQUFPQyxNQUFNLE1BQU0sZ0JBQWdCO0FBQ25DLE9BQU9DLFFBQVEsTUFBTSxZQUFZO0FBQ2pDLE9BQU9DLEtBQUssTUFBTSxZQUFZO0FBRTlCLE1BQU1DLE9BQU8sR0FBR2hCLE1BQU0sRUFBRWlCLFVBQVUsR0FBRyxhQUFhLEdBQUcsWUFBWTtBQUNqRWxC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","map":{"version":3,"names":["ExtractJwt","Strategy","JwtStrategy","dotenv","config","express","logger","fs","https","path","GenericErrorHandler","ApiError","helmet","cors","mongoose","passport","Session","routes","DBModels","Users","envPath","production","connect","process","env","MONGO_URI","useNewUrlParser","useUnifiedTopology","then","console","log","catch","err","app","router","Router","use","LOGGER","origin","json","limit","urlencoded","extended","serializeUser","user","done","deserializeUser","id","initialize","jwtOps","jwtFromRequest","fromAuthHeaderAsBearerToken","secretOrKey","JWT_SECRET","jwtPayload","findOne","_id","toJSON","forEach","routeFunc","index","all","req","res","test","HTTPS_ENABLED","key","readFileSync","join","__dirname","toString","cert","server","createServer","listen","PORT"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/","sources":["app.js"],"sourcesContent":["import \"express-async-errors\";\nimport { ExtractJwt, Strategy as JwtStrategy } from \"passport-jwt\";\nimport dotenv from \"dotenv\";\nimport config from \"../src/config\";\nimport express from \"express\";\nimport logger from \"morgan\";\nimport fs from \"fs\";\nimport https from \"https\";\nimport path from \"path\";\nimport GenericErrorHandler from \"./middlewares/GenericErrorHandler\";\nimport ApiError from \"./errors/ApiError\";\nimport helmet from \"helmet\";\nimport cors from \"cors\";\nimport mongoose from \"mongoose\";\nimport passport from \"passport\";\nimport Session from \"./middlewares/Session\";\nimport routes from \"./routes/index\";\nimport DBModels from \"./db/index\";\nimport Users from \"./db/users\";\n\nconst envPath = config?.production ? \"./env/.prod\" : \"./env/.dev\";\ndotenv.config({\n  path: envPath,\n});\n\nmongoose\n  .connect(process.env.MONGO_URI, {\n    useNewUrlParser: true,\n    useUnifiedTopology: true,\n  })\n  .then(() => {\n    console.log(\"connected on mongoDB\");\n  })\n  .catch((err) => {\n    console.log(err);\n  });\n\nconst app = express();\nconst router = express.Router();\n\napp.use(logger(process.env.LOGGER));\napp.use(helmet());\napp.use(\n  cors({\n    origin: \"*\",\n  })\n);\napp.use(\n  express.json({\n    limit: \"1mb\",\n  })\n);\napp.use(\n  express.urlencoded({\n    extended: true,\n  })\n);\n\npassport.serializeUser((user, done) => {\n  done(null, user);\n});\npassport.deserializeUser((id, done) => {\n  done(null, id);\n});\n\napp.use(passport.initialize());\n\nconst jwtOps = {\n  jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),\n  secretOrKey: process.env.JWT_SECRET,\n};\n\npassport.use(\n  new JwtStrategy(jwtOps, async (jwtPayload, done) => {\n    try {\n      const user = await Users.findOne({ _id: jwtPayload._id });\n      if (user) {\n        done(null, user.toJSON());\n      } else {\n        done(\n          new ApiError(\n            \"Authorization is not valid\",\n            401,\n            \"authorizationInvalid\"\n          ),\n          false\n        );\n      }\n    } catch (err) {\n      return done(err, false);\n    }\n  })\n);\nroutes.forEach((routeFunc, index) => {\n  routeFunc(router);\n});\n\napp.use(\"/api\", router);\n\napp.all(\"/test-auth\", Session, (req, res) => {\n  res.json({\n    test: true,\n  });\n});\n\napp.use(GenericErrorHandler);\n\nif (process.env.HTTPS_ENABLED === \"true\") {\n  const key = fs\n    .readFileSync(path.join(__dirname, \"./certs/key.pem\"))\n    .toString();\n  const cert = fs\n    .readFileSync(path.join(__dirname, \"./certs/cert.pem\"))\n    .toString();\n  const server = https.createServer({ key: key, cert: cert }, app);\n\n  server.listen(process.env.PORT, () => {\n    console.log(`Application is running on port =  ${process.env.PORT}`);\n  });\n} else {\n  app.listen(process.env.PORT, () => {\n    console.log(`Application is running on port =  ${process.env.PORT}`);\n  });\n}\n"],"mappings":"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","ignoreList":[]}},"mtime":1721043478445},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/app.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nrequire(\"express-async-errors\");\nvar _passportJwt = require(\"passport-jwt\");\nvar _dotenv = _interopRequireDefault(require(\"dotenv\"));\nvar _config = _interopRequireDefault(require(\"../src/config\"));\nvar _express = _interopRequireDefault(require(\"express\"));\nvar _morgan = _interopRequireDefault(require(\"morgan\"));\nvar _fs = _interopRequireDefault(require(\"fs\"));\nvar _https = _interopRequireDefault(require(\"https\"));\nvar _path = _interopRequireDefault(require(\"path\"));\nvar _GenericErrorHandler = _interopRequireDefault(require(\"./middlewares/GenericErrorHandler\"));\nvar _ApiError = _interopRequireDefault(require(\"./errors/ApiError\"));\nvar _helmet = _interopRequireDefault(require(\"helmet\"));\nvar _cors = _interopRequireDefault(require(\"cors\"));\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _passport = _interopRequireDefault(require(\"passport\"));\nvar _Session = _interopRequireDefault(require(\"./middlewares/Session\"));\nvar _index = _interopRequireDefault(require(\"./routes/index\"));\nvar _index2 = _interopRequireDefault(require(\"./db/index\"));\nvar _users = _interopRequireDefault(require(\"./db/users\"));\nvar _seller = _interopRequireDefault(require(\"./db/seller\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst envPath = _config.default?.production ? \"./env/.prod\" : \"./env/.dev\";\n_dotenv.default.config({\n  path: envPath\n});\n_mongoose.default.connect(process.env.MONGO_URI, {\n  useNewUrlParser: true,\n  useUnifiedTopology: true\n}).then(() => {\n  console.log(\"connected on mongoDB\");\n}).catch(err => {\n  console.log(err);\n});\nconst app = (0, _express.default)();\nconst router = _express.default.Router();\n\n// app.use(express.static(\"images\"));\napp.use(\"/public\", _express.default.static(_path.default.join(__dirname, \"..\", \"public\")));\napp.use((0, _morgan.default)(process.env.LOGGER));\napp.use((0, _helmet.default)());\napp.use((0, _cors.default)({\n  origin: \"*\"\n}));\napp.use(_express.default.json({\n  limit: \"1mb\"\n}));\napp.use(_express.default.urlencoded({\n  extended: true\n}));\n_passport.default.serializeUser((user, done) => {\n  done(null, user);\n});\n_passport.default.deserializeUser((id, done) => {\n  done(null, id);\n});\napp.use(_passport.default.initialize());\nconst jwtOps = {\n  jwtFromRequest: _passportJwt.ExtractJwt.fromAuthHeaderAsBearerToken(),\n  secretOrKey: process.env.JWT_SECRET\n};\n_passport.default.use(new _passportJwt.Strategy(jwtOps, async (jwtPayload, done) => {\n  try {\n    // Önce Users modelinde arama yap\n    const user = await _users.default.findOne({\n      _id: jwtPayload._id\n    });\n    if (user) {\n      // Eğer kullanıcı bulunursa, kullanıcıyı geri döndür\n      return done(null, user.toJSON());\n    }\n\n    // Eğer Users modelinde bulunmazsa Seller modelinde arama yap\n    const seller = await _seller.default.findOne({\n      _id: jwtPayload._id\n    });\n    if (seller) {\n      // Eğer satıcı bulunursa, satıcıyı geri döndür\n      return done(null, seller.toJSON());\n    }\n\n    // Eğer hem kullanıcı hem de satıcı bulunmazsa hata döndür\n    return done(new _ApiError.default(\"Authorization is not valid\", 401, \"authorizationInvalid\"), false);\n  } catch (err) {\n    // Hata durumunda error ve false döndür\n    return done(err, false);\n  }\n}));\n\n// passport.use(\n//   new JwtStrategy(jwtOps, async (jwtPayload, done) => {\n//     try {\n//       const user = await Users.findOne({ _id: jwtPayload._id });\n//       if (user) {\n//         done(null, user.toJSON());\n//       } else {\n//         done(\n//           new ApiError(\n//             \"Authorization is not valid\",\n//             401,\n//             \"authorizationInvalid\"\n//           ),\n//           false\n//         );\n//       }\n//     } catch (err) {\n//       return done(err, false);\n//     }\n//   })\n// );\n// passport.use(\n//   new JwtStrategy(jwtOps, async (jwtPayload, done) => {\n//     try {\n//       const seller = await Seller.findOne({ _id: jwtPayload._id });\n//       if (seller) {\n//         done(null, seller.toJSON());\n//       } else {\n//         done(\n//           new ApiError(\n//             \"Authorization is not valid\",\n//             401,\n//             \"authorizationInvalid\"\n//           ),\n//           false\n//         );\n//       }\n//     } catch (err) {\n//       return done(err, false);\n//     }\n//   })\n// );\n_index.default.forEach((routeFunc, index) => {\n  routeFunc(router);\n});\napp.use(\"/api\", router);\napp.all(\"/test-auth\", _Session.default, (req, res) => {\n  res.json({\n    test: true\n  });\n});\napp.use(_GenericErrorHandler.default);\nif (process.env.HTTPS_ENABLED === \"true\") {\n  const key = _fs.default.readFileSync(_path.default.join(__dirname, \"./certs/key.pem\")).toString();\n  const cert = _fs.default.readFileSync(_path.default.join(__dirname, \"./certs/cert.pem\")).toString();\n  const server = _https.default.createServer({\n    key: key,\n    cert: cert\n  }, app);\n  server.listen(process.env.PORT, () => {\n    console.log(`Application is running on port =  ${process.env.PORT}`);\n  });\n} else {\n  app.listen(process.env.PORT, () => {\n    console.log(`Application is running on port =  ${process.env.PORT}`);\n  });\n}\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJyZXF1aXJlIiwiX3Bhc3Nwb3J0Snd0IiwiX2RvdGVudiIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJfY29uZmlnIiwiX2V4cHJlc3MiLCJfbW9yZ2FuIiwiX2ZzIiwiX2h0dHBzIiwiX3BhdGgiLCJfR2VuZXJpY0Vycm9ySGFuZGxlciIsIl9BcGlFcnJvciIsIl9oZWxtZXQiLCJfY29ycyIsIl9tb25nb29zZSIsIl9wYXNzcG9ydCIsIl9TZXNzaW9uIiwiX2luZGV4IiwiX2luZGV4MiIsIl91c2VycyIsIl9zZWxsZXIiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJlbnZQYXRoIiwiY29uZmlnIiwicHJvZHVjdGlvbiIsImRvdGVudiIsInBhdGgiLCJtb25nb29zZSIsImNvbm5lY3QiLCJwcm9jZXNzIiwiZW52IiwiTU9OR09fVVJJIiwidXNlTmV3VXJsUGFyc2VyIiwidXNlVW5pZmllZFRvcG9sb2d5IiwidGhlbiIsImNvbnNvbGUiLCJsb2ciLCJjYXRjaCIsImVyciIsImFwcCIsImV4cHJlc3MiLCJyb3V0ZXIiLCJSb3V0ZXIiLCJ1c2UiLCJzdGF0aWMiLCJqb2luIiwiX19kaXJuYW1lIiwibG9nZ2VyIiwiTE9HR0VSIiwiaGVsbWV0IiwiY29ycyIsIm9yaWdpbiIsImpzb24iLCJsaW1pdCIsInVybGVuY29kZWQiLCJleHRlbmRlZCIsInBhc3Nwb3J0Iiwic2VyaWFsaXplVXNlciIsInVzZXIiLCJkb25lIiwiZGVzZXJpYWxpemVVc2VyIiwiaWQiLCJpbml0aWFsaXplIiwiand0T3BzIiwiand0RnJvbVJlcXVlc3QiLCJFeHRyYWN0Snd0IiwiZnJvbUF1dGhIZWFkZXJBc0JlYXJlclRva2VuIiwic2VjcmV0T3JLZXkiLCJKV1RfU0VDUkVUIiwiSnd0U3RyYXRlZ3kiLCJqd3RQYXlsb2FkIiwiVXNlcnMiLCJmaW5kT25lIiwiX2lkIiwidG9KU09OIiwic2VsbGVyIiwiU2VsbGVyIiwiQXBpRXJyb3IiLCJyb3V0ZXMiLCJmb3JFYWNoIiwicm91dGVGdW5jIiwiaW5kZXgiLCJhbGwiLCJTZXNzaW9uIiwicmVxIiwicmVzIiwidGVzdCIsIkdlbmVyaWNFcnJvckhhbmRsZXIiLCJIVFRQU19FTkFCTEVEIiwia2V5IiwiZnMiLCJyZWFkRmlsZVN5bmMiLCJ0b1N0cmluZyIsImNlcnQiLCJzZXJ2ZXIiLCJodHRwcyIsImNyZWF0ZVNlcnZlciIsImxpc3RlbiIsIlBPUlQiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy8iLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgXCJleHByZXNzLWFzeW5jLWVycm9yc1wiO1xuaW1wb3J0IHsgRXh0cmFjdEp3dCwgU3RyYXRlZ3kgYXMgSnd0U3RyYXRlZ3kgfSBmcm9tIFwicGFzc3BvcnQtand0XCI7XG5pbXBvcnQgZG90ZW52IGZyb20gXCJkb3RlbnZcIjtcbmltcG9ydCBjb25maWcgZnJvbSBcIi4uL3NyYy9jb25maWdcIjtcbmltcG9ydCBleHByZXNzIGZyb20gXCJleHByZXNzXCI7XG5pbXBvcnQgbG9nZ2VyIGZyb20gXCJtb3JnYW5cIjtcbmltcG9ydCBmcyBmcm9tIFwiZnNcIjtcbmltcG9ydCBodHRwcyBmcm9tIFwiaHR0cHNcIjtcbmltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XG5pbXBvcnQgR2VuZXJpY0Vycm9ySGFuZGxlciBmcm9tIFwiLi9taWRkbGV3YXJlcy9HZW5lcmljRXJyb3JIYW5kbGVyXCI7XG5pbXBvcnQgQXBpRXJyb3IgZnJvbSBcIi4vZXJyb3JzL0FwaUVycm9yXCI7XG5pbXBvcnQgaGVsbWV0IGZyb20gXCJoZWxtZXRcIjtcbmltcG9ydCBjb3JzIGZyb20gXCJjb3JzXCI7XG5pbXBvcnQgbW9uZ29vc2UgZnJvbSBcIm1vbmdvb3NlXCI7XG5pbXBvcnQgcGFzc3BvcnQgZnJvbSBcInBhc3Nwb3J0XCI7XG5pbXBvcnQgU2Vzc2lvbiBmcm9tIFwiLi9taWRkbGV3YXJlcy9TZXNzaW9uXCI7XG5pbXBvcnQgcm91dGVzIGZyb20gXCIuL3JvdXRlcy9pbmRleFwiO1xuaW1wb3J0IERCTW9kZWxzIGZyb20gXCIuL2RiL2luZGV4XCI7XG5pbXBvcnQgVXNlcnMgZnJvbSBcIi4vZGIvdXNlcnNcIjtcbmltcG9ydCBTZWxsZXIgZnJvbSBcIi4vZGIvc2VsbGVyXCI7XG5cbmNvbnN0IGVudlBhdGggPSBjb25maWc/LnByb2R1Y3Rpb24gPyBcIi4vZW52Ly5wcm9kXCIgOiBcIi4vZW52Ly5kZXZcIjtcbmRvdGVudi5jb25maWcoe1xuICBwYXRoOiBlbnZQYXRoLFxufSk7XG5cbm1vbmdvb3NlXG4gIC5jb25uZWN0KHByb2Nlc3MuZW52Lk1PTkdPX1VSSSwge1xuICAgIHVzZU5ld1VybFBhcnNlcjogdHJ1ZSxcbiAgICB1c2VVbmlmaWVkVG9wb2xvZ3k6IHRydWUsXG4gIH0pXG4gIC50aGVuKCgpID0+IHtcbiAgICBjb25zb2xlLmxvZyhcImNvbm5lY3RlZCBvbiBtb25nb0RCXCIpO1xuICB9KVxuICAuY2F0Y2goKGVycikgPT4ge1xuICAgIGNvbnNvbGUubG9nKGVycik7XG4gIH0pO1xuXG5jb25zdCBhcHAgPSBleHByZXNzKCk7XG5jb25zdCByb3V0ZXIgPSBleHByZXNzLlJvdXRlcigpO1xuXG4vLyBhcHAudXNlKGV4cHJlc3Muc3RhdGljKFwiaW1hZ2VzXCIpKTtcbmFwcC51c2UoXCIvcHVibGljXCIsIGV4cHJlc3Muc3RhdGljKHBhdGguam9pbihfX2Rpcm5hbWUsIFwiLi5cIiwgXCJwdWJsaWNcIikpKTtcbmFwcC51c2UobG9nZ2VyKHByb2Nlc3MuZW52LkxPR0dFUikpO1xuYXBwLnVzZShoZWxtZXQoKSk7XG5hcHAudXNlKFxuICBjb3JzKHtcbiAgICBvcmlnaW46IFwiKlwiLFxuICB9KVxuKTtcbmFwcC51c2UoXG4gIGV4cHJlc3MuanNvbih7XG4gICAgbGltaXQ6IFwiMW1iXCIsXG4gIH0pXG4pO1xuYXBwLnVzZShcbiAgZXhwcmVzcy51cmxlbmNvZGVkKHtcbiAgICBleHRlbmRlZDogdHJ1ZSxcbiAgfSlcbik7XG5cbnBhc3Nwb3J0LnNlcmlhbGl6ZVVzZXIoKHVzZXIsIGRvbmUpID0+IHtcbiAgZG9uZShudWxsLCB1c2VyKTtcbn0pO1xucGFzc3BvcnQuZGVzZXJpYWxpemVVc2VyKChpZCwgZG9uZSkgPT4ge1xuICBkb25lKG51bGwsIGlkKTtcbn0pO1xuXG5hcHAudXNlKHBhc3Nwb3J0LmluaXRpYWxpemUoKSk7XG5cbmNvbnN0IGp3dE9wcyA9IHtcbiAgand0RnJvbVJlcXVlc3Q6IEV4dHJhY3RKd3QuZnJvbUF1dGhIZWFkZXJBc0JlYXJlclRva2VuKCksXG4gIHNlY3JldE9yS2V5OiBwcm9jZXNzLmVudi5KV1RfU0VDUkVULFxufTtcblxucGFzc3BvcnQudXNlKFxuICBuZXcgSnd0U3RyYXRlZ3koand0T3BzLCBhc3luYyAoand0UGF5bG9hZCwgZG9uZSkgPT4ge1xuICAgIHRyeSB7XG4gICAgICAvLyDDlm5jZSBVc2VycyBtb2RlbGluZGUgYXJhbWEgeWFwXG4gICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlcnMuZmluZE9uZSh7IF9pZDogand0UGF5bG9hZC5faWQgfSk7XG5cbiAgICAgIGlmICh1c2VyKSB7XG4gICAgICAgIC8vIEXEn2VyIGt1bGxhbsSxY8SxIGJ1bHVudXJzYSwga3VsbGFuxLFjxLF5xLEgZ2VyaSBkw7ZuZMO8clxuICAgICAgICByZXR1cm4gZG9uZShudWxsLCB1c2VyLnRvSlNPTigpKTtcbiAgICAgIH1cblxuICAgICAgLy8gRcSfZXIgVXNlcnMgbW9kZWxpbmRlIGJ1bHVubWF6c2EgU2VsbGVyIG1vZGVsaW5kZSBhcmFtYSB5YXBcbiAgICAgIGNvbnN0IHNlbGxlciA9IGF3YWl0IFNlbGxlci5maW5kT25lKHsgX2lkOiBqd3RQYXlsb2FkLl9pZCB9KTtcblxuICAgICAgaWYgKHNlbGxlcikge1xuICAgICAgICAvLyBFxJ9lciBzYXTEsWPEsSBidWx1bnVyc2EsIHNhdMSxY8SxecSxIGdlcmkgZMO2bmTDvHJcbiAgICAgICAgcmV0dXJuIGRvbmUobnVsbCwgc2VsbGVyLnRvSlNPTigpKTtcbiAgICAgIH1cblxuICAgICAgLy8gRcSfZXIgaGVtIGt1bGxhbsSxY8SxIGhlbSBkZSBzYXTEsWPEsSBidWx1bm1henNhIGhhdGEgZMO2bmTDvHJcbiAgICAgIHJldHVybiBkb25lKFxuICAgICAgICBuZXcgQXBpRXJyb3IoXCJBdXRob3JpemF0aW9uIGlzIG5vdCB2YWxpZFwiLCA0MDEsIFwiYXV0aG9yaXphdGlvbkludmFsaWRcIiksXG4gICAgICAgIGZhbHNlXG4gICAgICApO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgLy8gSGF0YSBkdXJ1bXVuZGEgZXJyb3IgdmUgZmFsc2UgZMO2bmTDvHJcbiAgICAgIHJldHVybiBkb25lKGVyciwgZmFsc2UpO1xuICAgIH1cbiAgfSlcbik7XG5cbi8vIHBhc3Nwb3J0LnVzZShcbi8vICAgbmV3IEp3dFN0cmF0ZWd5KGp3dE9wcywgYXN5bmMgKGp3dFBheWxvYWQsIGRvbmUpID0+IHtcbi8vICAgICB0cnkge1xuLy8gICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXJzLmZpbmRPbmUoeyBfaWQ6IGp3dFBheWxvYWQuX2lkIH0pO1xuLy8gICAgICAgaWYgKHVzZXIpIHtcbi8vICAgICAgICAgZG9uZShudWxsLCB1c2VyLnRvSlNPTigpKTtcbi8vICAgICAgIH0gZWxzZSB7XG4vLyAgICAgICAgIGRvbmUoXG4vLyAgICAgICAgICAgbmV3IEFwaUVycm9yKFxuLy8gICAgICAgICAgICAgXCJBdXRob3JpemF0aW9uIGlzIG5vdCB2YWxpZFwiLFxuLy8gICAgICAgICAgICAgNDAxLFxuLy8gICAgICAgICAgICAgXCJhdXRob3JpemF0aW9uSW52YWxpZFwiXG4vLyAgICAgICAgICAgKSxcbi8vICAgICAgICAgICBmYWxzZVxuLy8gICAgICAgICApO1xuLy8gICAgICAgfVxuLy8gICAgIH0gY2F0Y2ggKGVycikge1xuLy8gICAgICAgcmV0dXJuIGRvbmUoZXJyLCBmYWxzZSk7XG4vLyAgICAgfVxuLy8gICB9KVxuLy8gKTtcbi8vIHBhc3Nwb3J0LnVzZShcbi8vICAgbmV3IEp3dFN0cmF0ZWd5KGp3dE9wcywgYXN5bmMgKGp3dFBheWxvYWQsIGRvbmUpID0+IHtcbi8vICAgICB0cnkge1xuLy8gICAgICAgY29uc3Qgc2VsbGVyID0gYXdhaXQgU2VsbGVyLmZpbmRPbmUoeyBfaWQ6IGp3dFBheWxvYWQuX2lkIH0pO1xuLy8gICAgICAgaWYgKHNlbGxlcikge1xuLy8gICAgICAgICBkb25lKG51bGwsIHNlbGxlci50b0pTT04oKSk7XG4vLyAgICAgICB9IGVsc2Uge1xuLy8gICAgICAgICBkb25lKFxuLy8gICAgICAgICAgIG5ldyBBcGlFcnJvcihcbi8vICAgICAgICAgICAgIFwiQXV0aG9yaXphdGlvbiBpcyBub3QgdmFsaWRcIixcbi8vICAgICAgICAgICAgIDQwMSxcbi8vICAgICAgICAgICAgIFwiYXV0aG9yaXphdGlvbkludmFsaWRcIlxuLy8gICAgICAgICAgICksXG4vLyAgICAgICAgICAgZmFsc2Vcbi8vICAgICAgICAgKTtcbi8vICAgICAgIH1cbi8vICAgICB9IGNhdGNoIChlcnIpIHtcbi8vICAgICAgIHJldHVybiBkb25lKGVyciwgZmFsc2UpO1xuLy8gICAgIH1cbi8vICAgfSlcbi8vICk7XG5yb3V0ZXMuZm9yRWFjaCgocm91dGVGdW5jLCBpbmRleCkgPT4ge1xuICByb3V0ZUZ1bmMocm91dGVyKTtcbn0pO1xuXG5hcHAudXNlKFwiL2FwaVwiLCByb3V0ZXIpO1xuXG5hcHAuYWxsKFwiL3Rlc3QtYXV0aFwiLCBTZXNzaW9uLCAocmVxLCByZXMpID0+IHtcbiAgcmVzLmpzb24oe1xuICAgIHRlc3Q6IHRydWUsXG4gIH0pO1xufSk7XG5cbmFwcC51c2UoR2VuZXJpY0Vycm9ySGFuZGxlcik7XG5cbmlmIChwcm9jZXNzLmVudi5IVFRQU19FTkFCTEVEID09PSBcInRydWVcIikge1xuICBjb25zdCBrZXkgPSBmc1xuICAgIC5yZWFkRmlsZVN5bmMocGF0aC5qb2luKF9fZGlybmFtZSwgXCIuL2NlcnRzL2tleS5wZW1cIikpXG4gICAgLnRvU3RyaW5nKCk7XG4gIGNvbnN0IGNlcnQgPSBmc1xuICAgIC5yZWFkRmlsZVN5bmMocGF0aC5qb2luKF9fZGlybmFtZSwgXCIuL2NlcnRzL2NlcnQucGVtXCIpKVxuICAgIC50b1N0cmluZygpO1xuICBjb25zdCBzZXJ2ZXIgPSBodHRwcy5jcmVhdGVTZXJ2ZXIoeyBrZXk6IGtleSwgY2VydDogY2VydCB9LCBhcHApO1xuXG4gIHNlcnZlci5saXN0ZW4ocHJvY2Vzcy5lbnYuUE9SVCwgKCkgPT4ge1xuICAgIGNvbnNvbGUubG9nKGBBcHBsaWNhdGlvbiBpcyBydW5uaW5nIG9uIHBvcnQgPSAgJHtwcm9jZXNzLmVudi5QT1JUfWApO1xuICB9KTtcbn0gZWxzZSB7XG4gIGFwcC5saXN0ZW4ocHJvY2Vzcy5lbnYuUE9SVCwgKCkgPT4ge1xuICAgIGNvbnNvbGUubG9nKGBBcHBsaWNhdGlvbiBpcyBydW5uaW5nIG9uIHBvcnQgPSAgJHtwcm9jZXNzLmVudi5QT1JUfWApO1xuICB9KTtcbn1cbiJdLCJtYXBwaW5ncyI6Ijs7QUFBQUEsT0FBQTtBQUNBLElBQUFDLFlBQUEsR0FBQUQsT0FBQTtBQUNBLElBQUFFLE9BQUEsR0FBQUMsc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFJLE9BQUEsR0FBQUQsc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFLLFFBQUEsR0FBQUYsc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFNLE9BQUEsR0FBQUgsc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFPLEdBQUEsR0FBQUosc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFRLE1BQUEsR0FBQUwsc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFTLEtBQUEsR0FBQU4sc0JBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFVLG9CQUFBLEdBQUFQLHNCQUFBLENBQUFILE9BQUE7QUFDQSxJQUFBVyxTQUFBLEdBQUFSLHNCQUFBLENBQUFILE9BQUE7QUFDQSxJQUFBWSxPQUFBLEdBQUFU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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0F3QyxjQUFNLENBQUNDLE9BQU8sQ0FBQyxDQUFDQyxTQUFTLEVBQUVDLEtBQUssS0FBSztFQUNuQ0QsU0FBUyxDQUFDdkMsTUFBTSxDQUFDO0FBQ25CLENBQUMsQ0FBQztBQUVGRixHQUFHLENBQUNJLEdBQUcsQ0FBQyxNQUFNLEVBQUVGLE1BQU0sQ0FBQztBQUV2QkYsR0FBRyxDQUFDMkMsR0FBRyxDQUFDLFlBQVksRUFBRUMsZ0JBQU8sRUFBRSxDQUFDQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztFQUMzQ0EsR0FBRyxDQUFDakMsSUFBSSxDQUFDO0lBQ1BrQyxJQUFJLEVBQUU7RUFDUixDQUFDLENBQUM7QUFDSixDQUFDLENBQUM7QUFFRi9DLEdBQUcsQ0FBQ0ksR0FBRyxDQUFDNEMsNEJBQW1CLENBQUM7QUFFNUIsSUFBSTFELE9BQU8sQ0FBQ0MsR0FBRyxDQUFDMEQsYUFBYSxLQUFLLE1BQU0sRUFBRTtFQUN4QyxNQUFNQyxHQUFHLEdBQUdDLFdBQUUsQ0FDWEMsWUFBWSxDQUFDakUsYUFBSSxDQUFDbUIsSUFBSSxDQUFDQyxTQUFTLEVBQUUsaUJBQWlCLENBQUMsQ0FBQyxDQUNyRDhDLFFBQVEsQ0FBQyxDQUFDO0VBQ2IsTUFBTUMsSUFBSSxHQUFHSCxXQUFFLENBQ1pDLFlBQVksQ0FBQ2pFLGFBQUksQ0FBQ21CLElBQUksQ0FBQ0MsU0FBUyxFQUFFLGtCQUFrQixDQUFDLENBQUMsQ0FDdEQ4QyxRQUFRLENBQUMsQ0FBQztFQUNiLE1BQU1FLE1BQU0sR0FBR0MsY0FBSyxDQUFDQyxZQUFZLENBQUM7SUFBRVAsR0FBRyxFQUFFQSxHQUFHO0lBQUVJLElBQUksRUFBRUE7RUFBSyxDQUFDLEVBQUV0RCxHQUFHLENBQUM7RUFFaEV1RCxNQUFNLENBQUNHLE1BQU0sQ0FBQ3BFLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDb0UsSUFBSSxFQUFFLE1BQU07SUFDcEMvRCxPQUFPLENBQUNDLEdBQUcsQ0FBQyxxQ0FBcUNQLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDb0UsSUFBSSxFQUFFLENBQUM7RUFDdEUsQ0FBQyxDQUFDO0FBQ0osQ0FBQyxNQUFNO0VBQ0wzRCxHQUFHLENBQUMwRCxNQUFNLENBQUNwRSxPQUFPLENBQUNDLEdBQUcsQ0FBQ29FLElBQUksRUFBRSxNQUFNO0lBQ2pDL0QsT0FBTyxDQUFDQyxHQUFHLENBQUMscUNBQXFDUCxPQUFPLENBQUNDLEdBQUcsQ0FBQ29FLElBQUksRUFBRSxDQUFDO0VBQ3RFLENBQUMsQ0FBQztBQUNKIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["require","_passportJwt","_dotenv","_interopRequireDefault","_config","_express","_morgan","_fs","_https","_path","_GenericErrorHandler","_ApiError","_helmet","_cors","_mongoose","_passport","_Session","_index","_index2","_users","_seller","e","__esModule","default","envPath","config","production","dotenv","path","mongoose","connect","process","env","MONGO_URI","useNewUrlParser","useUnifiedTopology","then","console","log","catch","err","app","express","router","Router","use","static","join","__dirname","logger","LOGGER","helmet","cors","origin","json","limit","urlencoded","extended","passport","serializeUser","user","done","deserializeUser","id","initialize","jwtOps","jwtFromRequest","ExtractJwt","fromAuthHeaderAsBearerToken","secretOrKey","JWT_SECRET","JwtStrategy","jwtPayload","Users","findOne","_id","toJSON","seller","Seller","ApiError","routes","forEach","routeFunc","index","all","Session","req","res","test","GenericErrorHandler","HTTPS_ENABLED","key","fs","readFileSync","toString","cert","server","https","createServer","listen","PORT"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/","sources":["app.js"],"sourcesContent":["import \"express-async-errors\";\nimport { ExtractJwt, Strategy as JwtStrategy } from \"passport-jwt\";\nimport dotenv from \"dotenv\";\nimport config from \"../src/config\";\nimport express from \"express\";\nimport logger from \"morgan\";\nimport fs from \"fs\";\nimport https from \"https\";\nimport path from \"path\";\nimport GenericErrorHandler from \"./middlewares/GenericErrorHandler\";\nimport ApiError from \"./errors/ApiError\";\nimport helmet from \"helmet\";\nimport cors from \"cors\";\nimport mongoose from \"mongoose\";\nimport passport from \"passport\";\nimport Session from \"./middlewares/Session\";\nimport routes from \"./routes/index\";\nimport DBModels from \"./db/index\";\nimport Users from \"./db/users\";\nimport Seller from \"./db/seller\";\n\nconst envPath = config?.production ? \"./env/.prod\" : \"./env/.dev\";\ndotenv.config({\n  path: envPath,\n});\n\nmongoose\n  .connect(process.env.MONGO_URI, {\n    useNewUrlParser: true,\n    useUnifiedTopology: true,\n  })\n  .then(() => {\n    console.log(\"connected on mongoDB\");\n  })\n  .catch((err) => {\n    console.log(err);\n  });\n\nconst app = express();\nconst router = express.Router();\n\n// app.use(express.static(\"images\"));\napp.use(\"/public\", express.static(path.join(__dirname, \"..\", \"public\")));\napp.use(logger(process.env.LOGGER));\napp.use(helmet());\napp.use(\n  cors({\n    origin: \"*\",\n  })\n);\napp.use(\n  express.json({\n    limit: \"1mb\",\n  })\n);\napp.use(\n  express.urlencoded({\n    extended: true,\n  })\n);\n\npassport.serializeUser((user, done) => {\n  done(null, user);\n});\npassport.deserializeUser((id, done) => {\n  done(null, id);\n});\n\napp.use(passport.initialize());\n\nconst jwtOps = {\n  jwtFromRequest: ExtractJwt.fromAuthHeaderAsBearerToken(),\n  secretOrKey: process.env.JWT_SECRET,\n};\n\npassport.use(\n  new JwtStrategy(jwtOps, async (jwtPayload, done) => {\n    try {\n      // Önce Users modelinde arama yap\n      const user = await Users.findOne({ _id: jwtPayload._id });\n\n      if (user) {\n        // Eğer kullanıcı bulunursa, kullanıcıyı geri döndür\n        return done(null, user.toJSON());\n      }\n\n      // Eğer Users modelinde bulunmazsa Seller modelinde arama yap\n      const seller = await Seller.findOne({ _id: jwtPayload._id });\n\n      if (seller) {\n        // Eğer satıcı bulunursa, satıcıyı geri döndür\n        return done(null, seller.toJSON());\n      }\n\n      // Eğer hem kullanıcı hem de satıcı bulunmazsa hata döndür\n      return done(\n        new ApiError(\"Authorization is not valid\", 401, \"authorizationInvalid\"),\n        false\n      );\n    } catch (err) {\n      // Hata durumunda error ve false döndür\n      return done(err, false);\n    }\n  })\n);\n\n// passport.use(\n//   new JwtStrategy(jwtOps, async (jwtPayload, done) => {\n//     try {\n//       const user = await Users.findOne({ _id: jwtPayload._id });\n//       if (user) {\n//         done(null, user.toJSON());\n//       } else {\n//         done(\n//           new ApiError(\n//             \"Authorization is not valid\",\n//             401,\n//             \"authorizationInvalid\"\n//           ),\n//           false\n//         );\n//       }\n//     } catch (err) {\n//       return done(err, false);\n//     }\n//   })\n// );\n// passport.use(\n//   new JwtStrategy(jwtOps, async (jwtPayload, done) => {\n//     try {\n//       const seller = await Seller.findOne({ _id: jwtPayload._id });\n//       if (seller) {\n//         done(null, seller.toJSON());\n//       } else {\n//         done(\n//           new ApiError(\n//             \"Authorization is not valid\",\n//             401,\n//             \"authorizationInvalid\"\n//           ),\n//           false\n//         );\n//       }\n//     } catch (err) {\n//       return done(err, false);\n//     }\n//   })\n// );\nroutes.forEach((routeFunc, index) => {\n  routeFunc(router);\n});\n\napp.use(\"/api\", router);\n\napp.all(\"/test-auth\", Session, (req, res) => {\n  res.json({\n    test: true,\n  });\n});\n\napp.use(GenericErrorHandler);\n\nif (process.env.HTTPS_ENABLED === \"true\") {\n  const key = fs\n    .readFileSync(path.join(__dirname, \"./certs/key.pem\"))\n    .toString();\n  const cert = fs\n    .readFileSync(path.join(__dirname, \"./certs/cert.pem\"))\n    .toString();\n  const server = https.createServer({ key: key, cert: cert }, app);\n\n  server.listen(process.env.PORT, () => {\n    console.log(`Application is running on port =  ${process.env.PORT}`);\n  });\n} else {\n  app.listen(process.env.PORT, () => {\n    console.log(`Application is running on port =  ${process.env.PORT}`);\n  });\n}\n"],"mappings":"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","ignoreList":[]}},"mtime":1727082066042},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/config.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nconst production = process.argv.slice(2).includes(\"dev\") ? false : true;\nconst config = {\n  development: !production,\n  production: production,\n  deployment: production ? \"PRODUCTION\" : \"DEVELOPMENT\"\n};\nvar _default = exports.default = config;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJwcm9kdWN0aW9uIiwicHJvY2VzcyIsImFyZ3YiLCJzbGljZSIsImluY2x1ZGVzIiwiY29uZmlnIiwiZGV2ZWxvcG1lbnQiLCJkZXBsb3ltZW50IiwiX2RlZmF1bHQiLCJleHBvcnRzIiwiZGVmYXVsdCJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjLyIsInNvdXJjZXMiOlsiY29uZmlnLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHByb2R1Y3Rpb24gPSBwcm9jZXNzLmFyZ3Yuc2xpY2UoMikuaW5jbHVkZXMoXCJkZXZcIikgPyBmYWxzZSA6IHRydWU7XG5cbmNvbnN0IGNvbmZpZyA9IHtcbiAgZGV2ZWxvcG1lbnQ6ICFwcm9kdWN0aW9uLFxuICBwcm9kdWN0aW9uOiBwcm9kdWN0aW9uLFxuICBkZXBsb3ltZW50OiBwcm9kdWN0aW9uID8gXCJQUk9EVUNUSU9OXCIgOiBcIkRFVkVMT1BNRU5UXCIsXG59O1xuZXhwb3J0IGRlZmF1bHQgY29uZmlnO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxNQUFNQSxVQUFVLEdBQUdDLE9BQU8sQ0FBQ0MsSUFBSSxDQUFDQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUNDLFFBQVEsQ0FBQyxLQUFLLENBQUMsR0FBRyxLQUFLLEdBQUcsSUFBSTtBQUV2RSxNQUFNQyxNQUFNLEdBQUc7RUFDYkMsV0FBVyxFQUFFLENBQUNOLFVBQVU7RUFDeEJBLFVBQVUsRUFBRUEsVUFBVTtFQUN0Qk8sVUFBVSxFQUFFUCxVQUFVLEdBQUcsWUFBWSxHQUFHO0FBQzFDLENBQUM7QUFBQyxJQUFBUSxRQUFBLEdBQUFDLE9BQUEsQ0FBQUMsT0FBQSxHQUNhTCxNQUFNIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["production","process","argv","slice","includes","config","development","deployment","_default","exports","default"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/","sources":["config.js"],"sourcesContent":["const production = process.argv.slice(2).includes(\"dev\") ? false : true;\n\nconst config = {\n  development: !production,\n  production: production,\n  deployment: production ? \"PRODUCTION\" : \"DEVELOPMENT\",\n};\nexport default config;\n"],"mappings":";;;;;;AAAA,MAAMA,UAAU,GAAGC,OAAO,CAACC,IAAI,CAACC,KAAK,CAAC,CAAC,CAAC,CAACC,QAAQ,CAAC,KAAK,CAAC,GAAG,KAAK,GAAG,IAAI;AAEvE,MAAMC,MAAM,GAAG;EACbC,WAAW,EAAE,CAACN,UAAU;EACxBA,UAAU,EAAEA,UAAU;EACtBO,UAAU,EAAEP,UAAU,GAAG,YAAY,GAAG;AAC1C,CAAC;AAAC,IAAAQ,QAAA,GAAAC,OAAA,CAAAC,OAAA,GACaL,MAAM","ignoreList":[]}},"mtime":1721043478449},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/GenericErrorHandler.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst GenericErrorHandler = (err, req, res, next) => {\n  if (!(err instanceof _ApiError.default)) {\n    console.error(err);\n  }\n  if (/\\w+ validation failed: \\w+/i.test(err.message)) {\n    err.message = err.message.replace(/\\w+ validation failed: \\w+/i, \"\");\n  }\n  res.status(err.status || 500).json({\n    status: err?.status,\n    error: err?.message,\n    code: err.code\n  });\n};\nvar _default = exports.default = GenericErrorHandler;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQXBpRXJyb3IiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIkdlbmVyaWNFcnJvckhhbmRsZXIiLCJlcnIiLCJyZXEiLCJyZXMiLCJuZXh0IiwiQXBpRXJyb3IiLCJjb25zb2xlIiwiZXJyb3IiLCJ0ZXN0IiwibWVzc2FnZSIsInJlcGxhY2UiLCJzdGF0dXMiLCJqc29uIiwiY29kZSIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL21pZGRsZXdhcmVzLyIsInNvdXJjZXMiOlsiR2VuZXJpY0Vycm9ySGFuZGxlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQXBpRXJyb3IgZnJvbSBcIi4uL2Vycm9ycy9BcGlFcnJvclwiO1xuXG5jb25zdCBHZW5lcmljRXJyb3JIYW5kbGVyID0gKGVyciwgcmVxLCByZXMsIG5leHQpID0+IHtcbiAgaWYgKCEoZXJyIGluc3RhbmNlb2YgQXBpRXJyb3IpKSB7XG4gICAgY29uc29sZS5lcnJvcihlcnIpO1xuICB9XG4gIGlmICgvXFx3KyB2YWxpZGF0aW9uIGZhaWxlZDogXFx3Ky9pLnRlc3QoZXJyLm1lc3NhZ2UpKSB7XG4gICAgZXJyLm1lc3NhZ2UgPSBlcnIubWVzc2FnZS5yZXBsYWNlKC9cXHcrIHZhbGlkYXRpb24gZmFpbGVkOiBcXHcrL2ksIFwiXCIpO1xuICB9XG4gIHJlcy5zdGF0dXMoZXJyLnN0YXR1cyB8fCA1MDApLmpzb24oe1xuICAgIHN0YXR1czogZXJyPy5zdGF0dXMsXG4gICAgZXJyb3I6IGVycj8ubWVzc2FnZSxcbiAgICBjb2RlOiBlcnIuY29kZSxcbiAgfSk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBHZW5lcmljRXJyb3JIYW5kbGVyO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxTQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFBMEMsU0FBQUQsdUJBQUFFLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFMUMsTUFBTUcsbUJBQW1CLEdBQUdBLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksS0FBSztFQUNuRCxJQUFJLEVBQUVILEdBQUcsWUFBWUksaUJBQVEsQ0FBQyxFQUFFO0lBQzlCQyxPQUFPLENBQUNDLEtBQUssQ0FBQ04sR0FBRyxDQUFDO0VBQ3BCO0VBQ0EsSUFBSSw2QkFBNkIsQ0FBQ08sSUFBSSxDQUFDUCxHQUFHLENBQUNRLE9BQU8sQ0FBQyxFQUFFO0lBQ25EUixHQUFHLENBQUNRLE9BQU8sR0FBR1IsR0FBRyxDQUFDUSxPQUFPLENBQUNDLE9BQU8sQ0FBQyw2QkFBNkIsRUFBRSxFQUFFLENBQUM7RUFDdEU7RUFDQVAsR0FBRyxDQUFDUSxNQUFNLENBQUNWLEdBQUcsQ0FBQ1UsTUFBTSxJQUFJLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7SUFDakNELE1BQU0sRUFBRVYsR0FBRyxFQUFFVSxNQUFNO0lBQ25CSixLQUFLLEVBQUVOLEdBQUcsRUFBRVEsT0FBTztJQUNuQkksSUFBSSxFQUFFWixHQUFHLENBQUNZO0VBQ1osQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUFDLElBQUFDLFFBQUEsR0FBQUMsT0FBQSxDQUFBaEIsT0FBQSxHQUVhQyxtQkFBbUIiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_ApiError","_interopRequireDefault","require","e","__esModule","default","GenericErrorHandler","err","req","res","next","ApiError","console","error","test","message","replace","status","json","code","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["GenericErrorHandler.js"],"sourcesContent":["import ApiError from \"../errors/ApiError\";\n\nconst GenericErrorHandler = (err, req, res, next) => {\n  if (!(err instanceof ApiError)) {\n    console.error(err);\n  }\n  if (/\\w+ validation failed: \\w+/i.test(err.message)) {\n    err.message = err.message.replace(/\\w+ validation failed: \\w+/i, \"\");\n  }\n  res.status(err.status || 500).json({\n    status: err?.status,\n    error: err?.message,\n    code: err.code,\n  });\n};\n\nexport default GenericErrorHandler;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA0C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE1C,MAAMG,mBAAmB,GAAGA,CAACC,GAAG,EAAEC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EACnD,IAAI,EAAEH,GAAG,YAAYI,iBAAQ,CAAC,EAAE;IAC9BC,OAAO,CAACC,KAAK,CAACN,GAAG,CAAC;EACpB;EACA,IAAI,6BAA6B,CAACO,IAAI,CAACP,GAAG,CAACQ,OAAO,CAAC,EAAE;IACnDR,GAAG,CAACQ,OAAO,GAAGR,GAAG,CAACQ,OAAO,CAACC,OAAO,CAAC,6BAA6B,EAAE,EAAE,CAAC;EACtE;EACAP,GAAG,CAACQ,MAAM,CAACV,GAAG,CAACU,MAAM,IAAI,GAAG,CAAC,CAACC,IAAI,CAAC;IACjCD,MAAM,EAAEV,GAAG,EAAEU,MAAM;IACnBJ,KAAK,EAAEN,GAAG,EAAEQ,OAAO;IACnBI,IAAI,EAAEZ,GAAG,CAACY;EACZ,CAAC,CAAC;AACJ,CAAC;AAAC,IAAAC,QAAA,GAAAC,OAAA,CAAAhB,OAAA,GAEaC,mBAAmB","ignoreList":[]}},"mtime":1721043695378},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/GenericErrorHandler.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst GenericErrorHandler = (err, req, res, next) => {\n  if (!(err instanceof _ApiError.default)) {\n    console.error(err);\n  }\n  if (/\\w+ validation failed: \\w+/i.test(err.message)) {\n    err.message = err.message.replace(/\\w+ validation failed: \\w+/i, \"\");\n  }\n  res.status(err.status || 500).json({\n    status: err?.status,\n    error: err?.message,\n    code: err.code\n  });\n};\nvar _default = exports.default = GenericErrorHandler;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQXBpRXJyb3IiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIkdlbmVyaWNFcnJvckhhbmRsZXIiLCJlcnIiLCJyZXEiLCJyZXMiLCJuZXh0IiwiQXBpRXJyb3IiLCJjb25zb2xlIiwiZXJyb3IiLCJ0ZXN0IiwibWVzc2FnZSIsInJlcGxhY2UiLCJzdGF0dXMiLCJqc29uIiwiY29kZSIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL21pZGRsZXdhcmVzLyIsInNvdXJjZXMiOlsiR2VuZXJpY0Vycm9ySGFuZGxlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQXBpRXJyb3IgZnJvbSBcIi4uL2Vycm9ycy9BcGlFcnJvclwiO1xuXG5jb25zdCBHZW5lcmljRXJyb3JIYW5kbGVyID0gKGVyciwgcmVxLCByZXMsIG5leHQpID0+IHtcbiAgaWYgKCEoZXJyIGluc3RhbmNlb2YgQXBpRXJyb3IpKSB7XG4gICAgY29uc29sZS5lcnJvcihlcnIpO1xuICB9XG4gIGlmICgvXFx3KyB2YWxpZGF0aW9uIGZhaWxlZDogXFx3Ky9pLnRlc3QoZXJyLm1lc3NhZ2UpKSB7XG4gICAgZXJyLm1lc3NhZ2UgPSBlcnIubWVzc2FnZS5yZXBsYWNlKC9cXHcrIHZhbGlkYXRpb24gZmFpbGVkOiBcXHcrL2ksIFwiXCIpO1xuICB9XG4gIHJlcy5zdGF0dXMoZXJyLnN0YXR1cyB8fCA1MDApLmpzb24oe1xuICAgIHN0YXR1czogZXJyPy5zdGF0dXMsXG4gICAgZXJyb3I6IGVycj8ubWVzc2FnZSxcbiAgICBjb2RlOiBlcnIuY29kZSxcbiAgfSk7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBHZW5lcmljRXJyb3JIYW5kbGVyO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxTQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFBMEMsU0FBQUQsdUJBQUFFLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFMUMsTUFBTUcsbUJBQW1CLEdBQUdBLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksS0FBSztFQUNuRCxJQUFJLEVBQUVILEdBQUcsWUFBWUksaUJBQVEsQ0FBQyxFQUFFO0lBQzlCQyxPQUFPLENBQUNDLEtBQUssQ0FBQ04sR0FBRyxDQUFDO0VBQ3BCO0VBQ0EsSUFBSSw2QkFBNkIsQ0FBQ08sSUFBSSxDQUFDUCxHQUFHLENBQUNRLE9BQU8sQ0FBQyxFQUFFO0lBQ25EUixHQUFHLENBQUNRLE9BQU8sR0FBR1IsR0FBRyxDQUFDUSxPQUFPLENBQUNDLE9BQU8sQ0FBQyw2QkFBNkIsRUFBRSxFQUFFLENBQUM7RUFDdEU7RUFDQVAsR0FBRyxDQUFDUSxNQUFNLENBQUNWLEdBQUcsQ0FBQ1UsTUFBTSxJQUFJLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7SUFDakNELE1BQU0sRUFBRVYsR0FBRyxFQUFFVSxNQUFNO0lBQ25CSixLQUFLLEVBQUVOLEdBQUcsRUFBRVEsT0FBTztJQUNuQkksSUFBSSxFQUFFWixHQUFHLENBQUNZO0VBQ1osQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUFDLElBQUFDLFFBQUEsR0FBQUMsT0FBQSxDQUFBaEIsT0FBQSxHQUVhQyxtQkFBbUIiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_ApiError","_interopRequireDefault","require","e","__esModule","default","GenericErrorHandler","err","req","res","next","ApiError","console","error","test","message","replace","status","json","code","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["GenericErrorHandler.js"],"sourcesContent":["import ApiError from \"../errors/ApiError\";\n\nconst GenericErrorHandler = (err, req, res, next) => {\n  if (!(err instanceof ApiError)) {\n    console.error(err);\n  }\n  if (/\\w+ validation failed: \\w+/i.test(err.message)) {\n    err.message = err.message.replace(/\\w+ validation failed: \\w+/i, \"\");\n  }\n  res.status(err.status || 500).json({\n    status: err?.status,\n    error: err?.message,\n    code: err.code,\n  });\n};\n\nexport default GenericErrorHandler;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA0C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE1C,MAAMG,mBAAmB,GAAGA,CAACC,GAAG,EAAEC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EACnD,IAAI,EAAEH,GAAG,YAAYI,iBAAQ,CAAC,EAAE;IAC9BC,OAAO,CAACC,KAAK,CAACN,GAAG,CAAC;EACpB;EACA,IAAI,6BAA6B,CAACO,IAAI,CAACP,GAAG,CAACQ,OAAO,CAAC,EAAE;IACnDR,GAAG,CAACQ,OAAO,GAAGR,GAAG,CAACQ,OAAO,CAACC,OAAO,CAAC,6BAA6B,EAAE,EAAE,CAAC;EACtE;EACAP,GAAG,CAACQ,MAAM,CAACV,GAAG,CAACU,MAAM,IAAI,GAAG,CAAC,CAACC,IAAI,CAAC;IACjCD,MAAM,EAAEV,GAAG,EAAEU,MAAM;IACnBJ,KAAK,EAAEN,GAAG,EAAEQ,OAAO;IACnBI,IAAI,EAAEZ,GAAG,CAACY;EACZ,CAAC,CAAC;AACJ,CAAC;AAAC,IAAAC,QAAA,GAAAC,OAAA,CAAAhB,OAAA,GAEaC,mBAAmB","ignoreList":[]}},"mtime":1721043695378},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/errors/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/errors/ApiError.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nclass ApiError extends Error {\n  constructor(message, status = 500, code) {\n    super(message);\n    this.status = status;\n    this.code = code;\n    this.name = this.constructor.name;\n    Error.captureStackTrace(this, this.constructor);\n  }\n}\nvar _default = exports.default = ApiError;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJBcGlFcnJvciIsIkVycm9yIiwiY29uc3RydWN0b3IiLCJtZXNzYWdlIiwic3RhdHVzIiwiY29kZSIsIm5hbWUiLCJjYXB0dXJlU3RhY2tUcmFjZSIsIl9kZWZhdWx0IiwiZXhwb3J0cyIsImRlZmF1bHQiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9lcnJvcnMvIiwic291cmNlcyI6WyJBcGlFcnJvci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBBcGlFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3IobWVzc2FnZSwgc3RhdHVzID0gNTAwLCBjb2RlKSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG4gICAgdGhpcy5zdGF0dXMgPSBzdGF0dXM7XG4gICAgdGhpcy5jb2RlID0gY29kZTtcbiAgICB0aGlzLm5hbWUgPSB0aGlzLmNvbnN0cnVjdG9yLm5hbWU7XG4gICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UodGhpcywgdGhpcy5jb25zdHJ1Y3Rvcik7XG4gIH1cbn1cbmV4cG9ydCBkZWZhdWx0IEFwaUVycm9yO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxNQUFNQSxRQUFRLFNBQVNDLEtBQUssQ0FBQztFQUMzQkMsV0FBV0EsQ0FBQ0MsT0FBTyxFQUFFQyxNQUFNLEdBQUcsR0FBRyxFQUFFQyxJQUFJLEVBQUU7SUFDdkMsS0FBSyxDQUFDRixPQUFPLENBQUM7SUFDZCxJQUFJLENBQUNDLE1BQU0sR0FBR0EsTUFBTTtJQUNwQixJQUFJLENBQUNDLElBQUksR0FBR0EsSUFBSTtJQUNoQixJQUFJLENBQUNDLElBQUksR0FBRyxJQUFJLENBQUNKLFdBQVcsQ0FBQ0ksSUFBSTtJQUNqQ0wsS0FBSyxDQUFDTSxpQkFBaUIsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDTCxXQUFXLENBQUM7RUFDakQ7QUFDRjtBQUFDLElBQUFNLFFBQUEsR0FBQUMsT0FBQSxDQUFBQyxPQUFBLEdBQ2NWLFFBQVEiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["ApiError","Error","constructor","message","status","code","name","captureStackTrace","_default","exports","default"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/errors/","sources":["ApiError.js"],"sourcesContent":["class ApiError extends Error {\n  constructor(message, status = 500, code) {\n    super(message);\n    this.status = status;\n    this.code = code;\n    this.name = this.constructor.name;\n    Error.captureStackTrace(this, this.constructor);\n  }\n}\nexport default ApiError;\n"],"mappings":";;;;;;AAAA,MAAMA,QAAQ,SAASC,KAAK,CAAC;EAC3BC,WAAWA,CAACC,OAAO,EAAEC,MAAM,GAAG,GAAG,EAAEC,IAAI,EAAE;IACvC,KAAK,CAACF,OAAO,CAAC;IACd,IAAI,CAACC,MAAM,GAAGA,MAAM;IACpB,IAAI,CAACC,IAAI,GAAGA,IAAI;IAChB,IAAI,CAACC,IAAI,GAAG,IAAI,CAACJ,WAAW,CAACI,IAAI;IACjCL,KAAK,CAACM,iBAAiB,CAAC,IAAI,EAAE,IAAI,CAACL,WAAW,CAAC;EACjD;AACF;AAAC,IAAAM,QAAA,GAAAC,OAAA,CAAAC,OAAA,GACcV,QAAQ","ignoreList":[]}},"mtime":1721043478453},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/Session.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _passport = _interopRequireDefault(require(\"passport\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Session = _passport.default.authenticate(\"jwt\", {\n  session: false\n});\nvar _default = exports.default = Session;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcGFzc3BvcnQiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIlNlc3Npb24iLCJwYXNzcG9ydCIsImF1dGhlbnRpY2F0ZSIsInNlc3Npb24iLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9taWRkbGV3YXJlcy8iLCJzb3VyY2VzIjpbIlNlc3Npb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHBhc3Nwb3J0IGZyb20gXCJwYXNzcG9ydFwiO1xuXG5jb25zdCBTZXNzaW9uID0gcGFzc3BvcnQuYXV0aGVudGljYXRlKFwiand0XCIsIHsgc2Vzc2lvbjogZmFsc2UgfSk7XG5cbmV4cG9ydCBkZWZhdWx0IFNlc3Npb247XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUFnQyxTQUFBRCx1QkFBQUUsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUVoQyxNQUFNRyxPQUFPLEdBQUdDLGlCQUFRLENBQUNDLFlBQVksQ0FBQyxLQUFLLEVBQUU7RUFBRUMsT0FBTyxFQUFFO0FBQU0sQ0FBQyxDQUFDO0FBQUMsSUFBQUMsUUFBQSxHQUFBQyxPQUFBLENBQUFOLE9BQUEsR0FFbERDLE9BQU8iLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_passport","_interopRequireDefault","require","e","__esModule","default","Session","passport","authenticate","session","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["Session.js"],"sourcesContent":["import passport from \"passport\";\n\nconst Session = passport.authenticate(\"jwt\", { session: false });\n\nexport default Session;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AAAgC,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEhC,MAAMG,OAAO,GAAGC,iBAAQ,CAACC,YAAY,CAAC,KAAK,EAAE;EAAEC,OAAO,EAAE;AAAM,CAAC,CAAC;AAAC,IAAAC,QAAA,GAAAC,OAAA,CAAAN,OAAA,GAElDC,OAAO","ignoreList":[]}},"mtime":1722848733624},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _Users = _interopRequireDefault(require(\"./Users\"));\nvar _Products = _interopRequireDefault(require(\"./Products\"));\nvar _cart = _interopRequireDefault(require(\"./cart\"));\nvar _payments = _interopRequireDefault(require(\"./payments\"));\nvar _cards = _interopRequireDefault(require(\"./cards\"));\nvar _cancelPayments = _interopRequireDefault(require(\"./cancel-payments\"));\nvar _checkouts = _interopRequireDefault(require(\"./checkouts\"));\nvar _installments = _interopRequireDefault(require(\"./installments\"));\nvar _refundPayments = _interopRequireDefault(require(\"./refund-payments\"));\nvar _Sellers = _interopRequireDefault(require(\"./Sellers\"));\nvar _admin = _interopRequireDefault(require(\"./admin\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = exports.default = [_Users.default, _Products.default, _cart.default, _payments.default, _cards.default, _cancelPayments.default, _checkouts.default, _installments.default, _refundPayments.default, _Sellers.default, _admin.default];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfVXNlcnMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9Qcm9kdWN0cyIsIl9jYXJ0IiwiX3BheW1lbnRzIiwiX2NhcmRzIiwiX2NhbmNlbFBheW1lbnRzIiwiX2NoZWNrb3V0cyIsIl9pbnN0YWxsbWVudHMiLCJfcmVmdW5kUGF5bWVudHMiLCJfU2VsbGVycyIsIl9hZG1pbiIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIl9kZWZhdWx0IiwiZXhwb3J0cyIsInVzZXJzIiwiUHJvZHVjdHMiLCJjYXJ0cyIsIlBheW1lbnRzIiwiQ2FyZHMiLCJDYW5jZWxQYXltZW50cyIsIkNoZWNrb3V0cyIsIkluc3RhbGxtZW50cyIsIlJlZnVuZFBheW1lbnRzIiwiU2VsbGVyIiwiYWRtaW4iXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9yb3V0ZXMvIiwic291cmNlcyI6WyJpbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdXNlcnMgZnJvbSBcIi4vVXNlcnNcIjtcbmltcG9ydCBQcm9kdWN0cyBmcm9tIFwiLi9Qcm9kdWN0c1wiO1xuaW1wb3J0IGNhcnRzIGZyb20gXCIuL2NhcnRcIjtcbmltcG9ydCBQYXltZW50cyBmcm9tIFwiLi9wYXltZW50c1wiO1xuaW1wb3J0IENhcmRzIGZyb20gXCIuL2NhcmRzXCI7XG5pbXBvcnQgQ2FuY2VsUGF5bWVudHMgZnJvbSBcIi4vY2FuY2VsLXBheW1lbnRzXCI7XG5pbXBvcnQgQ2hlY2tvdXRzIGZyb20gXCIuL2NoZWNrb3V0c1wiO1xuaW1wb3J0IEluc3RhbGxtZW50cyBmcm9tIFwiLi9pbnN0YWxsbWVudHNcIjtcbmltcG9ydCBSZWZ1bmRQYXltZW50cyBmcm9tIFwiLi9yZWZ1bmQtcGF5bWVudHNcIjtcbmltcG9ydCBTZWxsZXIgZnJvbSBcIi4vU2VsbGVyc1wiO1xuaW1wb3J0IGFkbWluIGZyb20gXCIuL2FkbWluXCI7XG5leHBvcnQgZGVmYXVsdCBbXG4gIHVzZXJzLFxuICBQcm9kdWN0cyxcbiAgY2FydHMsXG4gIFBheW1lbnRzLFxuICBDYXJkcyxcbiAgQ2FuY2VsUGF5bWVudHMsXG4gIENoZWNrb3V0cyxcbiAgSW5zdGFsbG1lbnRzLFxuICBSZWZ1bmRQYXltZW50cyxcbiAgU2VsbGVyLFxuICBhZG1pbixcbl07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLE1BQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFNBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLEtBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFHLFNBQUEsR0FBQUosc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFJLE1BQUEsR0FBQUwsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFLLGVBQUEsR0FBQU4sc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFNLFVBQUEsR0FBQVAsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFPLGFBQUEsR0FBQVIsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFRLGVBQUEsR0FBQVQsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFTLFFBQUEsR0FBQVYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFVLE1BQUEsR0FBQVgsc0JBQUEsQ0FBQUMsT0FBQTtBQUE0QixTQUFBRCx1QkFBQVksQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUFBLElBQUFHLFFBQUEsR0FBQUMsT0FBQSxDQUFBRixPQUFBLEdBQ2IsQ0FDYkcsY0FBSyxFQUNMQyxpQkFBUSxFQUNSQyxhQUFLLEVBQ0xDLGlCQUFRLEVBQ1JDLGNBQUssRUFDTEMsdUJBQWMsRUFDZEMsa0JBQVMsRUFDVEMscUJBQVksRUFDWkMsdUJBQWMsRUFDZEMsZ0JBQU0sRUFDTkMsY0FBSyxDQUNOIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["_Users","_interopRequireDefault","require","_Products","_cart","_payments","_cards","_cancelPayments","_checkouts","_installments","_refundPayments","_Sellers","_admin","e","__esModule","default","_default","exports","users","Products","carts","Payments","Cards","CancelPayments","Checkouts","Installments","RefundPayments","Seller","admin"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["index.js"],"sourcesContent":["import users from \"./Users\";\nimport Products from \"./Products\";\nimport carts from \"./cart\";\nimport Payments from \"./payments\";\nimport Cards from \"./cards\";\nimport CancelPayments from \"./cancel-payments\";\nimport Checkouts from \"./checkouts\";\nimport Installments from \"./installments\";\nimport RefundPayments from \"./refund-payments\";\nimport Seller from \"./Sellers\";\nimport admin from \"./admin\";\nexport default [\n  users,\n  Products,\n  carts,\n  Payments,\n  Cards,\n  CancelPayments,\n  Checkouts,\n  Installments,\n  RefundPayments,\n  Seller,\n  admin,\n];\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,KAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,SAAA,GAAAJ,sBAAA,CAAAC,OAAA;AACA,IAAAI,MAAA,GAAAL,sBAAA,CAAAC,OAAA;AACA,IAAAK,eAAA,GAAAN,sBAAA,CAAAC,OAAA;AACA,IAAAM,UAAA,GAAAP,sBAAA,CAAAC,OAAA;AACA,IAAAO,aAAA,GAAAR,sBAAA,CAAAC,OAAA;AACA,IAAAQ,eAAA,GAAAT,sBAAA,CAAAC,OAAA;AACA,IAAAS,QAAA,GAAAV,sBAAA,CAAAC,OAAA;AACA,IAAAU,MAAA,GAAAX,sBAAA,CAAAC,OAAA;AAA4B,SAAAD,uBAAAY,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAAA,IAAAG,QAAA,GAAAC,OAAA,CAAAF,OAAA,GACb,CACbG,cAAK,EACLC,iBAAQ,EACRC,aAAK,EACLC,iBAAQ,EACRC,cAAK,EACLC,uBAAc,EACdC,kBAAS,EACTC,qBAAY,EACZC,uBAAc,EACdC,gBAAM,EACNC,cAAK,CACN","ignoreList":[]}},"mtime":1727012834288},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/Users.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\nvar _cart = _interopRequireDefault(require(\"../db/cart\"));\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _CheckExistence = require(\"../helpers/CheckExistence\");\nvar _RequiredCheck = require(\"../helpers/RequiredCheck\");\nvar _ForgotPasswordMail = require(\"../middlewares/ForgotPasswordMail\");\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nvar _VerificationEmail = _interopRequireDefault(require(\"../middlewares/VerificationEmail\"));\nvar _getUserIP = _interopRequireDefault(require(\"../middlewares/getUserIP\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = router => {\n  router.post(\"/register\", _getUserIP.default, async (req, res, next) => {\n    const {\n      email,\n      name,\n      surname,\n      phoneNumber,\n      identityNumber,\n      password,\n      address,\n      city,\n      country,\n      zipCode\n    } = req.body;\n    try {\n      (0, _RequiredCheck.checkLotsOfRequiredField)([{\n        field: email,\n        fieldName: \"E-Mail\"\n      }, {\n        field: name,\n        fieldName: \"Name\"\n      }, {\n        field: surname,\n        fieldName: \"Surname\"\n      }, {\n        field: phoneNumber,\n        fieldName: \"Phone Number\"\n      }, {\n        field: address,\n        fieldName: \"Address\"\n      }, {\n        field: city,\n        fieldName: \"City\"\n      }, {\n        field: country,\n        fieldName: \"Country\"\n      }, {\n        field: zipCode,\n        fieldName: \"Zip Code\"\n      }, {\n        field: identityNumber,\n        fieldName: \"İdentity Number\"\n      }]);\n    } catch (error) {\n      return res.status(400).send(error);\n    }\n    const existingUser = await _users.default.findOne({\n      email\n    });\n    if (existingUser) {\n      return res.status(400).send(new _ApiError.default(400, \"Bu e-posta zaten kullanılıyor\"));\n    }\n    const user = new _users.default({\n      email,\n      name,\n      surname,\n      phoneNumber,\n      identityNumber,\n      password,\n      address,\n      city,\n      country,\n      zipCode,\n      ip: req.userIp // Kullanıcı IP'sini ekle\n    });\n    try {\n      await user.save();\n      req.user = user;\n      next();\n      // return res\n      //   .status(200)\n      //   .json(`${email} mail adresi ile kullanıcı oluşturuldu.`);\n    } catch (error) {\n      console.log(error);\n      return res.status(500).send(new _ApiError.default(500, \"Kayıt işlemi sırasında hata oluştu\"));\n    }\n  }, _VerificationEmail.default,\n  //silinebilir çalışmazsa\n  (req, res) => {\n    return res.status(200).json(`${req.user.email} mail adresi ile kullanıcı oluşturuldu. Lütfen E-postanızı doğrulayınız.` //middlewaredeki üretilen jwtyi konsola yazdır\n    );\n  });\n  router.get(\"/verify-email/\", async (req, res) => {\n    const {\n      token\n    } = req.query;\n    try {\n      (0, _RequiredCheck.checkRequiredField)(token, \"Token\");\n    } catch (error) {\n      return res.status(400).json(error);\n    }\n    try {\n      const decoded = _jsonwebtoken.default.verify(token, process.env.JWT_SECRET);\n      const user = await _users.default.findById(decoded.id);\n      (0, _CheckExistence.notFoundVariable)(user, \"User\");\n      if (user.isVerified) {\n        return res.status(400).send(new _ApiError.default(400, \"Kullanıcı zaten doğrulanmış\"));\n      }\n      user.isVerified = true;\n      await user.save();\n      return res.sendFile(\"verification-success.html\", {\n        root: \"public\"\n      });\n    } catch (error) {\n      console.log(error);\n      return res.status(500).send(new _ApiError.default(500, \"Doğrulama işlemi sırasında hata oluştu\"));\n    }\n  });\n  router.post(\"/login\", async (req, res) => {\n    const {\n      email,\n      password\n    } = req.body;\n    const user = await _users.default.findOne({\n      email\n    });\n    try {\n      (0, _RequiredCheck.checkLotsOfRequiredField)([{\n        field: email,\n        fieldName: \"E-Mail\"\n      }, {\n        field: password,\n        fieldName: \"Password\"\n      }]);\n    } catch (error) {\n      return res.status(400).json(error);\n    }\n    if (!user) {\n      throw new _ApiError.default(\"Incorrect Password or email\", 401, \"userOrPasswordIncorrect\");\n    }\n    if (user.isVerified == false) {\n      throw new _ApiError.default(\"You have to verificate your account.\", 401, \"accountNotVerified\");\n    }\n    const passwordConfirmed = await _bcryptjs.default.compare(password, user.password);\n    // console.log(\"kullanıcı girdisi:\", password); silinecekler\n    // console.log(\"hashlenmiş hali:\", user.password);\n\n    if (passwordConfirmed) {\n      const userJson = user.toJSON();\n      const token = _jsonwebtoken.default.sign(userJson, process.env.JWT_SECRET);\n      res.json({\n        token: `Bearer ${token}`,\n        user: userJson\n      });\n    } else {\n      throw new _ApiError.default(\"Incorrect Password or email\", 401, \"userOrPasswordIncorrect\");\n    }\n  });\n  router.put(\"/user/update\", _Session.default, async (req, res) => {\n    const {\n      phoneNumber,\n      address,\n      city\n    } = req.body;\n    const user = req.user;\n    try {\n      if (phoneNumber) {\n        const existingUser = await _users.default.findOne({\n          phoneNumber\n        });\n        if (existingUser && existingUser._id.toString() !== user._id.toString()) {\n          throw new _ApiError.default(\"This phone number already using\", 400, \"phoneNumberAlreadyUsing\");\n        }\n      }\n      const updateUser = await _users.default.findByIdAndUpdate(user, {\n        phoneNumber,\n        address,\n        city\n      }, {\n        new: true\n      });\n      (0, _CheckExistence.notFoundVariable)(updateUser, \"User\");\n      return res.status(200).json({\n        message: \"user information has been changed\",\n        user\n      });\n    } catch (error) {\n      console.log(error);\n      throw new _ApiError.default(\"User informations cannot change\", 500, \"cannotChangeUserInformation\");\n    }\n  });\n  router.put(\"/user/change-password\", _Session.default, async (req, res) => {\n    const {\n      oldPassword,\n      newPassword,\n      confirmPassword\n    } = req.body;\n    const user = req.user;\n    try {\n      const existingUser = await _users.default.findById(user._id);\n      if (!existingUser) {\n        throw new _ApiError.default(\"User Not Found\", 404, \"notFoundUser\");\n      }\n      const isMatchPassword = await _bcryptjs.default.compare(oldPassword, existingUser.password);\n      if (!isMatchPassword) {\n        throw new _ApiError.default(\"Incorrect old password\", 404, \"incorrectOldPassword\");\n      }\n      if (newPassword !== confirmPassword) {\n        throw new _ApiError.default(\"New password and confirm password do not match\", 404, \"passwordsDoNotMatch\");\n      }\n      const isSamePassword = await _bcryptjs.default.compare(newPassword, existingUser.password);\n      if (isSamePassword) {\n        throw new _ApiError.default(\"New Password cannot be the same as the old password\", 400, \"sameAsOldPassword\");\n      }\n      existingUser.password = newPassword;\n      await existingUser.save();\n      console.log(\"Old Password (unhashed):\", oldPassword);\n      console.log(\"New Password (unhashed):\", newPassword);\n      return res.status(200).json({\n        message: \"Password has been changed successfully\",\n        user\n      });\n    } catch (error) {\n      console.log(error);\n      res.status(error.statusCode || 500).json({\n        message: error.message || \"Password change failed\",\n        code: error.code || \"passwordChangeFailed\"\n      });\n    }\n  });\n  router.post(\"/forgot-password\", _ForgotPasswordMail.forgotPasswordEmail, async (req, res) => {\n    const {\n      email\n    } = req.body;\n    const userEmail = await _users.default.findOne({\n      email\n    });\n    (0, _CheckExistence.noExistVariable)(userEmail, \"Email\");\n    res.status(200).send(\"Link has been send\");\n  });\n  router.get(\"/user/orders/:cartId\", _Session.default, async (req, res) => {\n    const {\n      cartId\n    } = req.params;\n    const userId = req.user._id;\n    try {\n      const userOrders = await _cart.default.findOne({\n        _id: cartId,\n        completed: true,\n        buyer: userId\n      }).populate(\"products.productId\", \"name price images categories\").populate(\"products.seller\", \"SellerName\");\n      if (!userOrders) {\n        throw new _ApiError.default(\"Cart not found or not completed\", 404, \"cartNotFound\");\n      }\n      res.status(200).json(userOrders);\n    } catch (error) {\n      console.log(error);\n      throw new _ApiError.default(\"Could not get cart orders\", 400, \"getCartOrderFailed\");\n    }\n  });\n  router.get(\"/user/orders\", _Session.default, async (req, res) => {\n    try {\n      const userOrders = await _cart.default.find({\n        buyer: req.user._id,\n        completed: true\n      }).populate(\"products.productId\", \"name price images categories\").populate(\"products.seller\", \"SellerName\");\n      res.status(200).json(userOrders);\n    } catch (error) {\n      console.log(error);\n      throw new _ApiError.default(\"Could not get orders\", 400, \"getOrderFailed\");\n    }\n  });\n\n  // router.get(\"/user/orders\", Session, async (req, res) => {\n  //   const userId = req.user._id;\n  //   try {\n  //     // const cart = await Cart.find({ buyer: req.user._id, completed: true });\n  //     const paymentSuccess = await PaymentSuccess.find({\n  //       status: \"success\",\n  //     })\n  //       .select(\"price paymentId createdAt\")\n  //       .populate({ path: \"cartId\", select: \"buyer\" });\n\n  //     // Giriş yapan kullanıcıya ait olan ödemeleri filtreliyoruz\n  //     const userPayments = paymentSuccess.filter((payment) => {\n  //       // Populate edilmiş cartId içerisinden buyer kontrolü yapıyoruz\n  //       return String(payment.cartId.buyer) === String(userId);\n  //     });\n\n  //     if (userPayments.length === 0) {\n  //       return res\n  //         .status(404)\n  //         .json({ message: \"No payments found for this user\" });\n  //     }\n\n  //     res.status(200).json({ userPayments });\n  //   } catch (error) {\n  //     console.log(error);\n  //     throw new ApiError(\"Could not get orders\", 400, \"getOrderFailed\");\n  //   }\n  // });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYmNyeXB0anMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9qc29ud2VidG9rZW4iLCJfY2FydCIsIl91c2VycyIsIl9BcGlFcnJvciIsIl9DaGVja0V4aXN0ZW5jZSIsIl9SZXF1aXJlZENoZWNrIiwiX0ZvcmdvdFBhc3N3b3JkTWFpbCIsIl9TZXNzaW9uIiwiX1ZlcmlmaWNhdGlvbkVtYWlsIiwiX2dldFVzZXJJUCIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIl9kZWZhdWx0Iiwicm91dGVyIiwicG9zdCIsImdldFVzZXJJcCIsInJlcSIsInJlcyIsIm5leHQiLCJlbWFpbCIsIm5hbWUiLCJzdXJuYW1lIiwicGhvbmVOdW1iZXIiLCJpZGVudGl0eU51bWJlciIsInBhc3N3b3JkIiwiYWRkcmVzcyIsImNpdHkiLCJjb3VudHJ5IiwiemlwQ29kZSIsImJvZHkiLCJjaGVja0xvdHNPZlJlcXVpcmVkRmllbGQiLCJmaWVsZCIsImZpZWxkTmFtZSIsImVycm9yIiwic3RhdHVzIiwic2VuZCIsImV4aXN0aW5nVXNlciIsIlVzZXJzIiwiZmluZE9uZSIsIkFwaUVycm9yIiwidXNlciIsImlwIiwidXNlcklwIiwic2F2ZSIsImNvbnNvbGUiLCJsb2ciLCJzZW5kVmVyaWZpY2F0aW9uRW1haWwiLCJqc29uIiwiZ2V0IiwidG9rZW4iLCJxdWVyeSIsImNoZWNrUmVxdWlyZWRGaWVsZCIsImRlY29kZWQiLCJqd3QiLCJ2ZXJpZnkiLCJwcm9jZXNzIiwiZW52IiwiSldUX1NFQ1JFVCIsImZpbmRCeUlkIiwiaWQiLCJub3RGb3VuZFZhcmlhYmxlIiwiaXNWZXJpZmllZCIsInNlbmRGaWxlIiwicm9vdCIsInBhc3N3b3JkQ29uZmlybWVkIiwiYmNyeXB0IiwiY29tcGFyZSIsInVzZXJKc29uIiwidG9KU09OIiwic2lnbiIsInB1dCIsIlNlc3Npb24iLCJfaWQiLCJ0b1N0cmluZyIsInVwZGF0ZVVzZXIiLCJmaW5kQnlJZEFuZFVwZGF0ZSIsIm5ldyIsIm1lc3NhZ2UiLCJvbGRQYXNzd29yZCIsIm5ld1Bhc3N3b3JkIiwiY29uZmlybVBhc3N3b3JkIiwiaXNNYXRjaFBhc3N3b3JkIiwiaXNTYW1lUGFzc3dvcmQiLCJzdGF0dXNDb2RlIiwiY29kZSIsImZvcmdvdFBhc3N3b3JkRW1haWwiLCJ1c2VyRW1haWwiLCJub0V4aXN0VmFyaWFibGUiLCJjYXJ0SWQiLCJwYXJhbXMiLCJ1c2VySWQiLCJ1c2VyT3JkZXJzIiwiQ2FydCIsImNvbXBsZXRlZCIsImJ1eWVyIiwicG9wdWxhdGUiLCJmaW5kIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3JvdXRlcy8iLCJzb3VyY2VzIjpbIlVzZXJzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBiY3J5cHQgZnJvbSBcImJjcnlwdGpzXCI7XG5pbXBvcnQgand0IGZyb20gXCJqc29ud2VidG9rZW5cIjtcbmltcG9ydCBDYXJ0IGZyb20gXCIuLi9kYi9jYXJ0XCI7XG5pbXBvcnQgVXNlcnMgZnJvbSBcIi4uL2RiL3VzZXJzXCI7XG5pbXBvcnQgQXBpRXJyb3IgZnJvbSBcIi4uL2Vycm9ycy9BcGlFcnJvclwiO1xuaW1wb3J0IHsgbm9FeGlzdFZhcmlhYmxlLCBub3RGb3VuZFZhcmlhYmxlIH0gZnJvbSBcIi4uL2hlbHBlcnMvQ2hlY2tFeGlzdGVuY2VcIjtcbmltcG9ydCB7XG4gIGNoZWNrTG90c09mUmVxdWlyZWRGaWVsZCxcbiAgY2hlY2tSZXF1aXJlZEZpZWxkLFxufSBmcm9tIFwiLi4vaGVscGVycy9SZXF1aXJlZENoZWNrXCI7XG5pbXBvcnQgeyBmb3Jnb3RQYXNzd29yZEVtYWlsIH0gZnJvbSBcIi4uL21pZGRsZXdhcmVzL0ZvcmdvdFBhc3N3b3JkTWFpbFwiO1xuaW1wb3J0IFNlc3Npb24gZnJvbSBcIi4uL21pZGRsZXdhcmVzL1Nlc3Npb25cIjtcbmltcG9ydCBzZW5kVmVyaWZpY2F0aW9uRW1haWwgZnJvbSBcIi4uL21pZGRsZXdhcmVzL1ZlcmlmaWNhdGlvbkVtYWlsXCI7XG5pbXBvcnQgZ2V0VXNlcklwIGZyb20gXCIuLi9taWRkbGV3YXJlcy9nZXRVc2VySVBcIjtcblxuZXhwb3J0IGRlZmF1bHQgKHJvdXRlcikgPT4ge1xuICByb3V0ZXIucG9zdChcbiAgICBcIi9yZWdpc3RlclwiLFxuICAgIGdldFVzZXJJcCxcbiAgICBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgZW1haWwsXG4gICAgICAgIG5hbWUsXG4gICAgICAgIHN1cm5hbWUsXG4gICAgICAgIHBob25lTnVtYmVyLFxuICAgICAgICBpZGVudGl0eU51bWJlcixcbiAgICAgICAgcGFzc3dvcmQsXG4gICAgICAgIGFkZHJlc3MsXG4gICAgICAgIGNpdHksXG4gICAgICAgIGNvdW50cnksXG4gICAgICAgIHppcENvZGUsXG4gICAgICB9ID0gcmVxLmJvZHk7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGNoZWNrTG90c09mUmVxdWlyZWRGaWVsZChbXG4gICAgICAgICAgeyBmaWVsZDogZW1haWwsIGZpZWxkTmFtZTogXCJFLU1haWxcIiB9LFxuICAgICAgICAgIHsgZmllbGQ6IG5hbWUsIGZpZWxkTmFtZTogXCJOYW1lXCIgfSxcbiAgICAgICAgICB7IGZpZWxkOiBzdXJuYW1lLCBmaWVsZE5hbWU6IFwiU3VybmFtZVwiIH0sXG4gICAgICAgICAgeyBmaWVsZDogcGhvbmVOdW1iZXIsIGZpZWxkTmFtZTogXCJQaG9uZSBOdW1iZXJcIiB9LFxuICAgICAgICAgIHsgZmllbGQ6IGFkZHJlc3MsIGZpZWxkTmFtZTogXCJBZGRyZXNzXCIgfSxcbiAgICAgICAgICB7IGZpZWxkOiBjaXR5LCBmaWVsZE5hbWU6IFwiQ2l0eVwiIH0sXG4gICAgICAgICAgeyBmaWVsZDogY291bnRyeSwgZmllbGROYW1lOiBcIkNvdW50cnlcIiB9LFxuICAgICAgICAgIHsgZmllbGQ6IHppcENvZGUsIGZpZWxkTmFtZTogXCJaaXAgQ29kZVwiIH0sXG4gICAgICAgICAgeyBmaWVsZDogaWRlbnRpdHlOdW1iZXIsIGZpZWxkTmFtZTogXCLEsGRlbnRpdHkgTnVtYmVyXCIgfSxcbiAgICAgICAgXSk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoZXJyb3IpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBleGlzdGluZ1VzZXIgPSBhd2FpdCBVc2Vycy5maW5kT25lKHsgZW1haWwgfSk7XG4gICAgICBpZiAoZXhpc3RpbmdVc2VyKSB7XG4gICAgICAgIHJldHVybiByZXNcbiAgICAgICAgICAuc3RhdHVzKDQwMClcbiAgICAgICAgICAuc2VuZChuZXcgQXBpRXJyb3IoNDAwLCBcIkJ1IGUtcG9zdGEgemF0ZW4ga3VsbGFuxLFsxLF5b3JcIikpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB1c2VyID0gbmV3IFVzZXJzKHtcbiAgICAgICAgZW1haWwsXG4gICAgICAgIG5hbWUsXG4gICAgICAgIHN1cm5hbWUsXG4gICAgICAgIHBob25lTnVtYmVyLFxuICAgICAgICBpZGVudGl0eU51bWJlcixcbiAgICAgICAgcGFzc3dvcmQsXG4gICAgICAgIGFkZHJlc3MsXG4gICAgICAgIGNpdHksXG4gICAgICAgIGNvdW50cnksXG4gICAgICAgIHppcENvZGUsXG4gICAgICAgIGlwOiByZXEudXNlcklwLCAvLyBLdWxsYW7EsWPEsSBJUCdzaW5pIGVrbGVcbiAgICAgIH0pO1xuXG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCB1c2VyLnNhdmUoKTtcbiAgICAgICAgcmVxLnVzZXIgPSB1c2VyO1xuICAgICAgICBuZXh0KCk7XG4gICAgICAgIC8vIHJldHVybiByZXNcbiAgICAgICAgLy8gICAuc3RhdHVzKDIwMClcbiAgICAgICAgLy8gICAuanNvbihgJHtlbWFpbH0gbWFpbCBhZHJlc2kgaWxlIGt1bGxhbsSxY8SxIG9sdcWfdHVydWxkdS5gKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgcmV0dXJuIHJlc1xuICAgICAgICAgIC5zdGF0dXMoNTAwKVxuICAgICAgICAgIC5zZW5kKG5ldyBBcGlFcnJvcig1MDAsIFwiS2F5xLF0IGnFn2xlbWkgc8SxcmFzxLFuZGEgaGF0YSBvbHXFn3R1XCIpKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHNlbmRWZXJpZmljYXRpb25FbWFpbCwgLy9zaWxpbmViaWxpciDDp2FsxLHFn21henNhXG4gICAgKHJlcSwgcmVzKSA9PiB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oXG4gICAgICAgIGAke3JlcS51c2VyLmVtYWlsfSBtYWlsIGFkcmVzaSBpbGUga3VsbGFuxLFjxLEgb2x1xZ90dXJ1bGR1LiBMw7x0ZmVuIEUtcG9zdGFuxLF6xLEgZG/En3J1bGF5xLFuxLF6LmAgLy9taWRkbGV3YXJlZGVraSDDvHJldGlsZW4gand0eWkga29uc29sYSB5YXpkxLFyXG4gICAgICApO1xuICAgIH1cbiAgKTtcblxuICByb3V0ZXIuZ2V0KFwiL3ZlcmlmeS1lbWFpbC9cIiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyB0b2tlbiB9ID0gcmVxLnF1ZXJ5O1xuXG4gICAgdHJ5IHtcbiAgICAgIGNoZWNrUmVxdWlyZWRGaWVsZCh0b2tlbiwgXCJUb2tlblwiKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKGVycm9yKTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgZGVjb2RlZCA9IGp3dC52ZXJpZnkodG9rZW4sIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQpO1xuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXJzLmZpbmRCeUlkKGRlY29kZWQuaWQpO1xuXG4gICAgICBub3RGb3VuZFZhcmlhYmxlKHVzZXIsIFwiVXNlclwiKTtcblxuICAgICAgaWYgKHVzZXIuaXNWZXJpZmllZCkge1xuICAgICAgICByZXR1cm4gcmVzXG4gICAgICAgICAgLnN0YXR1cyg0MDApXG4gICAgICAgICAgLnNlbmQobmV3IEFwaUVycm9yKDQwMCwgXCJLdWxsYW7EsWPEsSB6YXRlbiBkb8SfcnVsYW5txLHFn1wiKSk7XG4gICAgICB9XG5cbiAgICAgIHVzZXIuaXNWZXJpZmllZCA9IHRydWU7XG4gICAgICBhd2FpdCB1c2VyLnNhdmUoKTtcblxuICAgICAgcmV0dXJuIHJlcy5zZW5kRmlsZShcInZlcmlmaWNhdGlvbi1zdWNjZXNzLmh0bWxcIiwgeyByb290OiBcInB1YmxpY1wiIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICByZXR1cm4gcmVzXG4gICAgICAgIC5zdGF0dXMoNTAwKVxuICAgICAgICAuc2VuZChuZXcgQXBpRXJyb3IoNTAwLCBcIkRvxJ9ydWxhbWEgacWfbGVtaSBzxLFyYXPEsW5kYSBoYXRhIG9sdcWfdHVcIikpO1xuICAgIH1cbiAgfSk7XG5cbiAgcm91dGVyLnBvc3QoXCIvbG9naW5cIiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyBlbWFpbCwgcGFzc3dvcmQgfSA9IHJlcS5ib2R5O1xuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2Vycy5maW5kT25lKHsgZW1haWwgfSk7XG5cbiAgICB0cnkge1xuICAgICAgY2hlY2tMb3RzT2ZSZXF1aXJlZEZpZWxkKFtcbiAgICAgICAgeyBmaWVsZDogZW1haWwsIGZpZWxkTmFtZTogXCJFLU1haWxcIiB9LFxuICAgICAgICB7IGZpZWxkOiBwYXNzd29yZCwgZmllbGROYW1lOiBcIlBhc3N3b3JkXCIgfSxcbiAgICAgIF0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oZXJyb3IpO1xuICAgIH1cblxuICAgIGlmICghdXNlcikge1xuICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICBcIkluY29ycmVjdCBQYXNzd29yZCBvciBlbWFpbFwiLFxuICAgICAgICA0MDEsXG4gICAgICAgIFwidXNlck9yUGFzc3dvcmRJbmNvcnJlY3RcIlxuICAgICAgKTtcbiAgICB9XG4gICAgaWYgKHVzZXIuaXNWZXJpZmllZCA9PSBmYWxzZSkge1xuICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICBcIllvdSBoYXZlIHRvIHZlcmlmaWNhdGUgeW91ciBhY2NvdW50LlwiLFxuICAgICAgICA0MDEsXG4gICAgICAgIFwiYWNjb3VudE5vdFZlcmlmaWVkXCJcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IHBhc3N3b3JkQ29uZmlybWVkID0gYXdhaXQgYmNyeXB0LmNvbXBhcmUocGFzc3dvcmQsIHVzZXIucGFzc3dvcmQpO1xuICAgIC8vIGNvbnNvbGUubG9nKFwia3VsbGFuxLFjxLEgZ2lyZGlzaTpcIiwgcGFzc3dvcmQpOyBzaWxpbmVjZWtsZXJcbiAgICAvLyBjb25zb2xlLmxvZyhcImhhc2hsZW5tacWfIGhhbGk6XCIsIHVzZXIucGFzc3dvcmQpO1xuXG4gICAgaWYgKHBhc3N3b3JkQ29uZmlybWVkKSB7XG4gICAgICBjb25zdCB1c2VySnNvbiA9IHVzZXIudG9KU09OKCk7XG4gICAgICBjb25zdCB0b2tlbiA9IGp3dC5zaWduKHVzZXJKc29uLCBwcm9jZXNzLmVudi5KV1RfU0VDUkVUKTtcbiAgICAgIHJlcy5qc29uKHtcbiAgICAgICAgdG9rZW46IGBCZWFyZXIgJHt0b2tlbn1gLFxuICAgICAgICB1c2VyOiB1c2VySnNvbixcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgIFwiSW5jb3JyZWN0IFBhc3N3b3JkIG9yIGVtYWlsXCIsXG4gICAgICAgIDQwMSxcbiAgICAgICAgXCJ1c2VyT3JQYXNzd29yZEluY29ycmVjdFwiXG4gICAgICApO1xuICAgIH1cbiAgfSk7XG5cbiAgcm91dGVyLnB1dChcIi91c2VyL3VwZGF0ZVwiLCBTZXNzaW9uLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICBjb25zdCB7IHBob25lTnVtYmVyLCBhZGRyZXNzLCBjaXR5IH0gPSByZXEuYm9keTtcbiAgICBjb25zdCB1c2VyID0gcmVxLnVzZXI7XG5cbiAgICB0cnkge1xuICAgICAgaWYgKHBob25lTnVtYmVyKSB7XG4gICAgICAgIGNvbnN0IGV4aXN0aW5nVXNlciA9IGF3YWl0IFVzZXJzLmZpbmRPbmUoeyBwaG9uZU51bWJlciB9KTtcbiAgICAgICAgaWYgKFxuICAgICAgICAgIGV4aXN0aW5nVXNlciAmJlxuICAgICAgICAgIGV4aXN0aW5nVXNlci5faWQudG9TdHJpbmcoKSAhPT0gdXNlci5faWQudG9TdHJpbmcoKVxuICAgICAgICApIHtcbiAgICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgICBcIlRoaXMgcGhvbmUgbnVtYmVyIGFscmVhZHkgdXNpbmdcIixcbiAgICAgICAgICAgIDQwMCxcbiAgICAgICAgICAgIFwicGhvbmVOdW1iZXJBbHJlYWR5VXNpbmdcIlxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY29uc3QgdXBkYXRlVXNlciA9IGF3YWl0IFVzZXJzLmZpbmRCeUlkQW5kVXBkYXRlKFxuICAgICAgICB1c2VyLFxuICAgICAgICB7IHBob25lTnVtYmVyLCBhZGRyZXNzLCBjaXR5IH0sXG4gICAgICAgIHsgbmV3OiB0cnVlIH1cbiAgICAgICk7XG4gICAgICBub3RGb3VuZFZhcmlhYmxlKHVwZGF0ZVVzZXIsIFwiVXNlclwiKTtcblxuICAgICAgcmV0dXJuIHJlc1xuICAgICAgICAuc3RhdHVzKDIwMClcbiAgICAgICAgLmpzb24oeyBtZXNzYWdlOiBcInVzZXIgaW5mb3JtYXRpb24gaGFzIGJlZW4gY2hhbmdlZFwiLCB1c2VyIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgIFwiVXNlciBpbmZvcm1hdGlvbnMgY2Fubm90IGNoYW5nZVwiLFxuICAgICAgICA1MDAsXG4gICAgICAgIFwiY2Fubm90Q2hhbmdlVXNlckluZm9ybWF0aW9uXCJcbiAgICAgICk7XG4gICAgfVxuICB9KTtcblxuICByb3V0ZXIucHV0KFwiL3VzZXIvY2hhbmdlLXBhc3N3b3JkXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGNvbnN0IHsgb2xkUGFzc3dvcmQsIG5ld1Bhc3N3b3JkLCBjb25maXJtUGFzc3dvcmQgfSA9IHJlcS5ib2R5O1xuICAgIGNvbnN0IHVzZXIgPSByZXEudXNlcjtcbiAgICB0cnkge1xuICAgICAgY29uc3QgZXhpc3RpbmdVc2VyID0gYXdhaXQgVXNlcnMuZmluZEJ5SWQodXNlci5faWQpO1xuICAgICAgaWYgKCFleGlzdGluZ1VzZXIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiVXNlciBOb3QgRm91bmRcIiwgNDA0LCBcIm5vdEZvdW5kVXNlclwiKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgaXNNYXRjaFBhc3N3b3JkID0gYXdhaXQgYmNyeXB0LmNvbXBhcmUoXG4gICAgICAgIG9sZFBhc3N3b3JkLFxuICAgICAgICBleGlzdGluZ1VzZXIucGFzc3dvcmRcbiAgICAgICk7XG4gICAgICBpZiAoIWlzTWF0Y2hQYXNzd29yZCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgXCJJbmNvcnJlY3Qgb2xkIHBhc3N3b3JkXCIsXG4gICAgICAgICAgNDA0LFxuICAgICAgICAgIFwiaW5jb3JyZWN0T2xkUGFzc3dvcmRcIlxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICBpZiAobmV3UGFzc3dvcmQgIT09IGNvbmZpcm1QYXNzd29yZCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgXCJOZXcgcGFzc3dvcmQgYW5kIGNvbmZpcm0gcGFzc3dvcmQgZG8gbm90IG1hdGNoXCIsXG4gICAgICAgICAgNDA0LFxuICAgICAgICAgIFwicGFzc3dvcmRzRG9Ob3RNYXRjaFwiXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGlzU2FtZVBhc3N3b3JkID0gYXdhaXQgYmNyeXB0LmNvbXBhcmUoXG4gICAgICAgIG5ld1Bhc3N3b3JkLFxuICAgICAgICBleGlzdGluZ1VzZXIucGFzc3dvcmRcbiAgICAgICk7XG4gICAgICBpZiAoaXNTYW1lUGFzc3dvcmQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIFwiTmV3IFBhc3N3b3JkIGNhbm5vdCBiZSB0aGUgc2FtZSBhcyB0aGUgb2xkIHBhc3N3b3JkXCIsXG4gICAgICAgICAgNDAwLFxuICAgICAgICAgIFwic2FtZUFzT2xkUGFzc3dvcmRcIlxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICBleGlzdGluZ1VzZXIucGFzc3dvcmQgPSBuZXdQYXNzd29yZDtcbiAgICAgIGF3YWl0IGV4aXN0aW5nVXNlci5zYXZlKCk7XG4gICAgICBjb25zb2xlLmxvZyhcIk9sZCBQYXNzd29yZCAodW5oYXNoZWQpOlwiLCBvbGRQYXNzd29yZCk7XG4gICAgICBjb25zb2xlLmxvZyhcIk5ldyBQYXNzd29yZCAodW5oYXNoZWQpOlwiLCBuZXdQYXNzd29yZCk7XG5cbiAgICAgIHJldHVybiByZXNcbiAgICAgICAgLnN0YXR1cygyMDApXG4gICAgICAgIC5qc29uKHsgbWVzc2FnZTogXCJQYXNzd29yZCBoYXMgYmVlbiBjaGFuZ2VkIHN1Y2Nlc3NmdWxseVwiLCB1c2VyIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICByZXMuc3RhdHVzKGVycm9yLnN0YXR1c0NvZGUgfHwgNTAwKS5qc29uKHtcbiAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSB8fCBcIlBhc3N3b3JkIGNoYW5nZSBmYWlsZWRcIixcbiAgICAgICAgY29kZTogZXJyb3IuY29kZSB8fCBcInBhc3N3b3JkQ2hhbmdlRmFpbGVkXCIsXG4gICAgICB9KTtcbiAgICB9XG4gIH0pO1xuXG4gIHJvdXRlci5wb3N0KFwiL2ZvcmdvdC1wYXNzd29yZFwiLCBmb3Jnb3RQYXNzd29yZEVtYWlsLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICBjb25zdCB7IGVtYWlsIH0gPSByZXEuYm9keTtcbiAgICBjb25zdCB1c2VyRW1haWwgPSBhd2FpdCBVc2Vycy5maW5kT25lKHsgZW1haWwgfSk7XG4gICAgbm9FeGlzdFZhcmlhYmxlKHVzZXJFbWFpbCwgXCJFbWFpbFwiKTtcblxuICAgIHJlcy5zdGF0dXMoMjAwKS5zZW5kKFwiTGluayBoYXMgYmVlbiBzZW5kXCIpO1xuICB9KTtcblxuICByb3V0ZXIuZ2V0KFwiL3VzZXIvb3JkZXJzLzpjYXJ0SWRcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyBjYXJ0SWQgfSA9IHJlcS5wYXJhbXM7XG4gICAgY29uc3QgdXNlcklkID0gcmVxLnVzZXIuX2lkO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB1c2VyT3JkZXJzID0gYXdhaXQgQ2FydC5maW5kT25lKHtcbiAgICAgICAgX2lkOiBjYXJ0SWQsXG4gICAgICAgIGNvbXBsZXRlZDogdHJ1ZSxcbiAgICAgICAgYnV5ZXI6IHVzZXJJZCxcbiAgICAgIH0pXG4gICAgICAgIC5wb3B1bGF0ZShcInByb2R1Y3RzLnByb2R1Y3RJZFwiLCBcIm5hbWUgcHJpY2UgaW1hZ2VzIGNhdGVnb3JpZXNcIilcbiAgICAgICAgLnBvcHVsYXRlKFwicHJvZHVjdHMuc2VsbGVyXCIsIFwiU2VsbGVyTmFtZVwiKTtcbiAgICAgIGlmICghdXNlck9yZGVycykge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgXCJDYXJ0IG5vdCBmb3VuZCBvciBub3QgY29tcGxldGVkXCIsXG4gICAgICAgICAgNDA0LFxuICAgICAgICAgIFwiY2FydE5vdEZvdW5kXCJcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24odXNlck9yZGVycyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgXCJDb3VsZCBub3QgZ2V0IGNhcnQgb3JkZXJzXCIsXG4gICAgICAgIDQwMCxcbiAgICAgICAgXCJnZXRDYXJ0T3JkZXJGYWlsZWRcIlxuICAgICAgKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJvdXRlci5nZXQoXCIvdXNlci9vcmRlcnNcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHVzZXJPcmRlcnMgPSBhd2FpdCBDYXJ0LmZpbmQoe1xuICAgICAgICBidXllcjogcmVxLnVzZXIuX2lkLFxuICAgICAgICBjb21wbGV0ZWQ6IHRydWUsXG4gICAgICB9KVxuICAgICAgICAucG9wdWxhdGUoXCJwcm9kdWN0cy5wcm9kdWN0SWRcIiwgXCJuYW1lIHByaWNlIGltYWdlcyBjYXRlZ29yaWVzXCIpXG4gICAgICAgIC5wb3B1bGF0ZShcInByb2R1Y3RzLnNlbGxlclwiLCBcIlNlbGxlck5hbWVcIik7XG5cbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHVzZXJPcmRlcnMpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDb3VsZCBub3QgZ2V0IG9yZGVyc1wiLCA0MDAsIFwiZ2V0T3JkZXJGYWlsZWRcIik7XG4gICAgfVxuICB9KTtcblxuICAvLyByb3V0ZXIuZ2V0KFwiL3VzZXIvb3JkZXJzXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAvLyAgIGNvbnN0IHVzZXJJZCA9IHJlcS51c2VyLl9pZDtcbiAgLy8gICB0cnkge1xuICAvLyAgICAgLy8gY29uc3QgY2FydCA9IGF3YWl0IENhcnQuZmluZCh7IGJ1eWVyOiByZXEudXNlci5faWQsIGNvbXBsZXRlZDogdHJ1ZSB9KTtcbiAgLy8gICAgIGNvbnN0IHBheW1lbnRTdWNjZXNzID0gYXdhaXQgUGF5bWVudFN1Y2Nlc3MuZmluZCh7XG4gIC8vICAgICAgIHN0YXR1czogXCJzdWNjZXNzXCIsXG4gIC8vICAgICB9KVxuICAvLyAgICAgICAuc2VsZWN0KFwicHJpY2UgcGF5bWVudElkIGNyZWF0ZWRBdFwiKVxuICAvLyAgICAgICAucG9wdWxhdGUoeyBwYXRoOiBcImNhcnRJZFwiLCBzZWxlY3Q6IFwiYnV5ZXJcIiB9KTtcblxuICAvLyAgICAgLy8gR2lyacWfIHlhcGFuIGt1bGxhbsSxY8SxeWEgYWl0IG9sYW4gw7ZkZW1lbGVyaSBmaWx0cmVsaXlvcnV6XG4gIC8vICAgICBjb25zdCB1c2VyUGF5bWVudHMgPSBwYXltZW50U3VjY2Vzcy5maWx0ZXIoKHBheW1lbnQpID0+IHtcbiAgLy8gICAgICAgLy8gUG9wdWxhdGUgZWRpbG1pxZ8gY2FydElkIGnDp2VyaXNpbmRlbiBidXllciBrb250cm9sw7wgeWFwxLF5b3J1elxuICAvLyAgICAgICByZXR1cm4gU3RyaW5nKHBheW1lbnQuY2FydElkLmJ1eWVyKSA9PT0gU3RyaW5nKHVzZXJJZCk7XG4gIC8vICAgICB9KTtcblxuICAvLyAgICAgaWYgKHVzZXJQYXltZW50cy5sZW5ndGggPT09IDApIHtcbiAgLy8gICAgICAgcmV0dXJuIHJlc1xuICAvLyAgICAgICAgIC5zdGF0dXMoNDA0KVxuICAvLyAgICAgICAgIC5qc29uKHsgbWVzc2FnZTogXCJObyBwYXltZW50cyBmb3VuZCBmb3IgdGhpcyB1c2VyXCIgfSk7XG4gIC8vICAgICB9XG5cbiAgLy8gICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgdXNlclBheW1lbnRzIH0pO1xuICAvLyAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gIC8vICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gIC8vICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDb3VsZCBub3QgZ2V0IG9yZGVyc1wiLCA0MDAsIFwiZ2V0T3JkZXJGYWlsZWRcIik7XG4gIC8vICAgfVxuICAvLyB9KTtcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLGFBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLEtBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFHLE1BQUEsR0FBQUosc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFJLFNBQUEsR0FBQUwsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFLLGVBQUEsR0FBQUwsT0FBQTtBQUNBLElBQUFNLGNBQUEsR0FBQU4sT0FBQTtBQUlBLElBQUFPLG1CQUFBLEdBQUFQLE9BQUE7QUFDQSxJQUFBUSxRQUFBLEdBQUFULHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBUyxrQkFBQSxHQUFBVixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQVUsVUFBQSxHQUFBWCxzQkFBQSxDQUFBQyxPQUFBO0FBQWlELFNBQUFELHVCQUFBWSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBQUEsSUFBQUcsUUFBQSxHQUVqQ0MsTUFBTSxJQUFLO0VBQ3pCQSxNQUFNLENBQUNDLElBQUksQ0FDVCxXQUFXLEVBQ1hDLGtCQUFTLEVBQ1QsT0FBT0MsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksS0FBSztJQUN4QixNQUFNO01BQ0pDLEtBQUs7TUFDTEMsSUFBSTtNQUNKQyxPQUFPO01BQ1BDLFdBQVc7TUFDWEMsY0FBYztNQUNkQyxRQUFRO01BQ1JDLE9BQU87TUFDUEMsSUFBSTtNQUNKQyxPQUFPO01BQ1BDO0lBQ0YsQ0FBQyxHQUFHWixHQUFHLENBQUNhLElBQUk7SUFFWixJQUFJO01BQ0YsSUFBQUMsdUNBQXdC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","map":{"version":3,"names":["_bcryptjs","_interopRequireDefault","require","_jsonwebtoken","_cart","_users","_ApiError","_CheckExistence","_RequiredCheck","_ForgotPasswordMail","_Session","_VerificationEmail","_getUserIP","e","__esModule","default","_default","router","post","getUserIp","req","res","next","email","name","surname","phoneNumber","identityNumber","password","address","city","country","zipCode","body","checkLotsOfRequiredField","field","fieldName","error","status","send","existingUser","Users","findOne","ApiError","user","ip","userIp","save","console","log","sendVerificationEmail","json","get","token","query","checkRequiredField","decoded","jwt","verify","process","env","JWT_SECRET","findById","id","notFoundVariable","isVerified","sendFile","root","passwordConfirmed","bcrypt","compare","userJson","toJSON","sign","put","Session","_id","toString","updateUser","findByIdAndUpdate","new","message","oldPassword","newPassword","confirmPassword","isMatchPassword","isSamePassword","statusCode","code","forgotPasswordEmail","userEmail","noExistVariable","cartId","params","userId","userOrders","Cart","completed","buyer","populate","find","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["Users.js"],"sourcesContent":["import bcrypt from \"bcryptjs\";\nimport jwt from \"jsonwebtoken\";\nimport Cart from \"../db/cart\";\nimport Users from \"../db/users\";\nimport ApiError from \"../errors/ApiError\";\nimport { noExistVariable, notFoundVariable } from \"../helpers/CheckExistence\";\nimport {\n  checkLotsOfRequiredField,\n  checkRequiredField,\n} from \"../helpers/RequiredCheck\";\nimport { forgotPasswordEmail } from \"../middlewares/ForgotPasswordMail\";\nimport Session from \"../middlewares/Session\";\nimport sendVerificationEmail from \"../middlewares/VerificationEmail\";\nimport getUserIp from \"../middlewares/getUserIP\";\n\nexport default (router) => {\n  router.post(\n    \"/register\",\n    getUserIp,\n    async (req, res, next) => {\n      const {\n        email,\n        name,\n        surname,\n        phoneNumber,\n        identityNumber,\n        password,\n        address,\n        city,\n        country,\n        zipCode,\n      } = req.body;\n\n      try {\n        checkLotsOfRequiredField([\n          { field: email, fieldName: \"E-Mail\" },\n          { field: name, fieldName: \"Name\" },\n          { field: surname, fieldName: \"Surname\" },\n          { field: phoneNumber, fieldName: \"Phone Number\" },\n          { field: address, fieldName: \"Address\" },\n          { field: city, fieldName: \"City\" },\n          { field: country, fieldName: \"Country\" },\n          { field: zipCode, fieldName: \"Zip Code\" },\n          { field: identityNumber, fieldName: \"İdentity Number\" },\n        ]);\n      } catch (error) {\n        return res.status(400).send(error);\n      }\n\n      const existingUser = await Users.findOne({ email });\n      if (existingUser) {\n        return res\n          .status(400)\n          .send(new ApiError(400, \"Bu e-posta zaten kullanılıyor\"));\n      }\n\n      const user = new Users({\n        email,\n        name,\n        surname,\n        phoneNumber,\n        identityNumber,\n        password,\n        address,\n        city,\n        country,\n        zipCode,\n        ip: req.userIp, // Kullanıcı IP'sini ekle\n      });\n\n      try {\n        await user.save();\n        req.user = user;\n        next();\n        // return res\n        //   .status(200)\n        //   .json(`${email} mail adresi ile kullanıcı oluşturuldu.`);\n      } catch (error) {\n        console.log(error);\n        return res\n          .status(500)\n          .send(new ApiError(500, \"Kayıt işlemi sırasında hata oluştu\"));\n      }\n    },\n    sendVerificationEmail, //silinebilir çalışmazsa\n    (req, res) => {\n      return res.status(200).json(\n        `${req.user.email} mail adresi ile kullanıcı oluşturuldu. Lütfen E-postanızı doğrulayınız.` //middlewaredeki üretilen jwtyi konsola yazdır\n      );\n    }\n  );\n\n  router.get(\"/verify-email/\", async (req, res) => {\n    const { token } = req.query;\n\n    try {\n      checkRequiredField(token, \"Token\");\n    } catch (error) {\n      return res.status(400).json(error);\n    }\n\n    try {\n      const decoded = jwt.verify(token, process.env.JWT_SECRET);\n      const user = await Users.findById(decoded.id);\n\n      notFoundVariable(user, \"User\");\n\n      if (user.isVerified) {\n        return res\n          .status(400)\n          .send(new ApiError(400, \"Kullanıcı zaten doğrulanmış\"));\n      }\n\n      user.isVerified = true;\n      await user.save();\n\n      return res.sendFile(\"verification-success.html\", { root: \"public\" });\n    } catch (error) {\n      console.log(error);\n      return res\n        .status(500)\n        .send(new ApiError(500, \"Doğrulama işlemi sırasında hata oluştu\"));\n    }\n  });\n\n  router.post(\"/login\", async (req, res) => {\n    const { email, password } = req.body;\n    const user = await Users.findOne({ email });\n\n    try {\n      checkLotsOfRequiredField([\n        { field: email, fieldName: \"E-Mail\" },\n        { field: password, fieldName: \"Password\" },\n      ]);\n    } catch (error) {\n      return res.status(400).json(error);\n    }\n\n    if (!user) {\n      throw new ApiError(\n        \"Incorrect Password or email\",\n        401,\n        \"userOrPasswordIncorrect\"\n      );\n    }\n    if (user.isVerified == false) {\n      throw new ApiError(\n        \"You have to verificate your account.\",\n        401,\n        \"accountNotVerified\"\n      );\n    }\n    const passwordConfirmed = await bcrypt.compare(password, user.password);\n    // console.log(\"kullanıcı girdisi:\", password); silinecekler\n    // console.log(\"hashlenmiş hali:\", user.password);\n\n    if (passwordConfirmed) {\n      const userJson = user.toJSON();\n      const token = jwt.sign(userJson, process.env.JWT_SECRET);\n      res.json({\n        token: `Bearer ${token}`,\n        user: userJson,\n      });\n    } else {\n      throw new ApiError(\n        \"Incorrect Password or email\",\n        401,\n        \"userOrPasswordIncorrect\"\n      );\n    }\n  });\n\n  router.put(\"/user/update\", Session, async (req, res) => {\n    const { phoneNumber, address, city } = req.body;\n    const user = req.user;\n\n    try {\n      if (phoneNumber) {\n        const existingUser = await Users.findOne({ phoneNumber });\n        if (\n          existingUser &&\n          existingUser._id.toString() !== user._id.toString()\n        ) {\n          throw new ApiError(\n            \"This phone number already using\",\n            400,\n            \"phoneNumberAlreadyUsing\"\n          );\n        }\n      }\n\n      const updateUser = await Users.findByIdAndUpdate(\n        user,\n        { phoneNumber, address, city },\n        { new: true }\n      );\n      notFoundVariable(updateUser, \"User\");\n\n      return res\n        .status(200)\n        .json({ message: \"user information has been changed\", user });\n    } catch (error) {\n      console.log(error);\n      throw new ApiError(\n        \"User informations cannot change\",\n        500,\n        \"cannotChangeUserInformation\"\n      );\n    }\n  });\n\n  router.put(\"/user/change-password\", Session, async (req, res) => {\n    const { oldPassword, newPassword, confirmPassword } = req.body;\n    const user = req.user;\n    try {\n      const existingUser = await Users.findById(user._id);\n      if (!existingUser) {\n        throw new ApiError(\"User Not Found\", 404, \"notFoundUser\");\n      }\n\n      const isMatchPassword = await bcrypt.compare(\n        oldPassword,\n        existingUser.password\n      );\n      if (!isMatchPassword) {\n        throw new ApiError(\n          \"Incorrect old password\",\n          404,\n          \"incorrectOldPassword\"\n        );\n      }\n\n      if (newPassword !== confirmPassword) {\n        throw new ApiError(\n          \"New password and confirm password do not match\",\n          404,\n          \"passwordsDoNotMatch\"\n        );\n      }\n\n      const isSamePassword = await bcrypt.compare(\n        newPassword,\n        existingUser.password\n      );\n      if (isSamePassword) {\n        throw new ApiError(\n          \"New Password cannot be the same as the old password\",\n          400,\n          \"sameAsOldPassword\"\n        );\n      }\n\n      existingUser.password = newPassword;\n      await existingUser.save();\n      console.log(\"Old Password (unhashed):\", oldPassword);\n      console.log(\"New Password (unhashed):\", newPassword);\n\n      return res\n        .status(200)\n        .json({ message: \"Password has been changed successfully\", user });\n    } catch (error) {\n      console.log(error);\n      res.status(error.statusCode || 500).json({\n        message: error.message || \"Password change failed\",\n        code: error.code || \"passwordChangeFailed\",\n      });\n    }\n  });\n\n  router.post(\"/forgot-password\", forgotPasswordEmail, async (req, res) => {\n    const { email } = req.body;\n    const userEmail = await Users.findOne({ email });\n    noExistVariable(userEmail, \"Email\");\n\n    res.status(200).send(\"Link has been send\");\n  });\n\n  router.get(\"/user/orders/:cartId\", Session, async (req, res) => {\n    const { cartId } = req.params;\n    const userId = req.user._id;\n    try {\n      const userOrders = await Cart.findOne({\n        _id: cartId,\n        completed: true,\n        buyer: userId,\n      })\n        .populate(\"products.productId\", \"name price images categories\")\n        .populate(\"products.seller\", \"SellerName\");\n      if (!userOrders) {\n        throw new ApiError(\n          \"Cart not found or not completed\",\n          404,\n          \"cartNotFound\"\n        );\n      }\n\n      res.status(200).json(userOrders);\n    } catch (error) {\n      console.log(error);\n      throw new ApiError(\n        \"Could not get cart orders\",\n        400,\n        \"getCartOrderFailed\"\n      );\n    }\n  });\n\n  router.get(\"/user/orders\", Session, async (req, res) => {\n    try {\n      const userOrders = await Cart.find({\n        buyer: req.user._id,\n        completed: true,\n      })\n        .populate(\"products.productId\", \"name price images categories\")\n        .populate(\"products.seller\", \"SellerName\");\n\n      res.status(200).json(userOrders);\n    } catch (error) {\n      console.log(error);\n      throw new ApiError(\"Could not get orders\", 400, \"getOrderFailed\");\n    }\n  });\n\n  // router.get(\"/user/orders\", Session, async (req, res) => {\n  //   const userId = req.user._id;\n  //   try {\n  //     // const cart = await Cart.find({ buyer: req.user._id, completed: true });\n  //     const paymentSuccess = await PaymentSuccess.find({\n  //       status: \"success\",\n  //     })\n  //       .select(\"price paymentId createdAt\")\n  //       .populate({ path: \"cartId\", select: \"buyer\" });\n\n  //     // Giriş yapan kullanıcıya ait olan ödemeleri filtreliyoruz\n  //     const userPayments = paymentSuccess.filter((payment) => {\n  //       // Populate edilmiş cartId içerisinden buyer kontrolü yapıyoruz\n  //       return String(payment.cartId.buyer) === String(userId);\n  //     });\n\n  //     if (userPayments.length === 0) {\n  //       return res\n  //         .status(404)\n  //         .json({ message: \"No payments found for this user\" });\n  //     }\n\n  //     res.status(200).json({ userPayments });\n  //   } catch (error) {\n  //     console.log(error);\n  //     throw new ApiError(\"Could not get orders\", 400, \"getOrderFailed\");\n  //   }\n  // });\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1734362474606},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/users.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst randomColorGenerator = () => {\n  return Math.floor(Math.random() * 16777215).toString(16);\n};\nconst UserSchema = new Schema({\n  uuid: {\n    type: String,\n    default: () => (0, _uuid.default)(),\n    unique: true,\n    required: true\n  },\n  locale: {\n    type: String,\n    required: true,\n    default: \"tr\",\n    enum: [\"tr\", \"en\"]\n  },\n  role: {\n    type: String,\n    required: true,\n    default: \"user\",\n    enum: [\"user\", \"admin\"]\n  },\n  name: {\n    type: String,\n    required: true\n  },\n  surname: {\n    type: String,\n    required: true\n  },\n  email: {\n    type: String,\n    required: true,\n    unique: true\n  },\n  phoneNumber: {\n    type: String,\n    required: true,\n    unique: true\n  },\n  identityNumber: {\n    type: String,\n    minlength: 11,\n    maxlength: 11,\n    required: true\n    // default: \"00000000000\",\n  },\n  password: {\n    type: String,\n    required: true\n  },\n  avatarColor: {\n    type: String,\n    default: randomColorGenerator(),\n    required: true\n  },\n  address: {\n    //fatura ve sipariş adresi diye ikiye ayrılabilir\n    type: String,\n    required: true\n  },\n  city: {\n    type: String,\n    required: true\n  },\n  country: {\n    type: String,\n    required: true,\n    default: \"Turkey\"\n  },\n  zipCode: {\n    type: String,\n    required: true\n  },\n  ip: {\n    type: String,\n    required: true\n    //default: \"85.34.78.112\", //cihazın ip'sini alır\n  },\n  isVerified: {\n    type: Boolean,\n    default: false\n  },\n  cardUserKey: {\n    type: String,\n    required: false,\n    unique: true\n  }\n}, {\n  _id: true,\n  collection: \"users\",\n  timestamps: true,\n  toJSON: {\n    transform: (doc, ret) => {\n      delete ret.__v;\n      delete ret.password;\n      return {\n        ...ret\n      };\n    }\n  }\n});\nUserSchema.pre(\"save\", async function (next) {\n  try {\n    if (!this.phoneNumber.startsWith(\"+90\")) {\n      this.phoneNumber = `+90${this.phoneNumber}`;\n    }\n    if (this.isModified(\"password\")) {\n      this.password = await _bcryptjs.default.hash(this.password, 10);\n    }\n    return next();\n  } catch (err) {\n    return next(err);\n  }\n  next();\n});\nconst Users = _mongoose.default.model(\"Users\", UserSchema);\nvar _default = exports.default = Users;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYmNyeXB0anMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9tb25nb29zZSIsIl91dWlkIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiU2NoZW1hIiwibW9uZ29vc2UiLCJPYmplY3RJZCIsIlR5cGVzIiwicmFuZG9tQ29sb3JHZW5lcmF0b3IiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJ0b1N0cmluZyIsIlVzZXJTY2hlbWEiLCJ1dWlkIiwidHlwZSIsIlN0cmluZyIsImdlbmVyYXRlZElkIiwidW5pcXVlIiwicmVxdWlyZWQiLCJsb2NhbGUiLCJlbnVtIiwicm9sZSIsIm5hbWUiLCJzdXJuYW1lIiwiZW1haWwiLCJwaG9uZU51bWJlciIsImlkZW50aXR5TnVtYmVyIiwibWlubGVuZ3RoIiwibWF4bGVuZ3RoIiwicGFzc3dvcmQiLCJhdmF0YXJDb2xvciIsImFkZHJlc3MiLCJjaXR5IiwiY291bnRyeSIsInppcENvZGUiLCJpcCIsImlzVmVyaWZpZWQiLCJCb29sZWFuIiwiY2FyZFVzZXJLZXkiLCJfaWQiLCJjb2xsZWN0aW9uIiwidGltZXN0YW1wcyIsInRvSlNPTiIsInRyYW5zZm9ybSIsImRvYyIsInJldCIsIl9fdiIsInByZSIsIm5leHQiLCJzdGFydHNXaXRoIiwiaXNNb2RpZmllZCIsImJjcnlwdCIsImhhc2giLCJlcnIiLCJVc2VycyIsIm1vZGVsIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvZGIvIiwic291cmNlcyI6WyJ1c2Vycy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgYmNyeXB0IGZyb20gXCJiY3J5cHRqc1wiO1xuaW1wb3J0IG1vbmdvb3NlIGZyb20gXCJtb25nb29zZVwiO1xuaW1wb3J0IGdlbmVyYXRlZElkIGZyb20gXCIuLi91dGlscy91dWlkXCI7XG5cbmNvbnN0IFNjaGVtYSA9IG1vbmdvb3NlLlNjaGVtYTtcbmNvbnN0IHsgT2JqZWN0SWQgfSA9IFNjaGVtYS5UeXBlcztcbmNvbnN0IHJhbmRvbUNvbG9yR2VuZXJhdG9yID0gKCkgPT4ge1xuICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTY3NzcyMTUpLnRvU3RyaW5nKDE2KTtcbn07XG5cbmNvbnN0IFVzZXJTY2hlbWEgPSBuZXcgU2NoZW1hKFxuICB7XG4gICAgdXVpZDoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgZGVmYXVsdDogKCkgPT4gZ2VuZXJhdGVkSWQoKSxcbiAgICAgIHVuaXF1ZTogdHJ1ZSxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgbG9jYWxlOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIGRlZmF1bHQ6IFwidHJcIixcbiAgICAgIGVudW06IFtcInRyXCIsIFwiZW5cIl0sXG4gICAgfSxcbiAgICByb2xlOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIGRlZmF1bHQ6IFwidXNlclwiLFxuICAgICAgZW51bTogW1widXNlclwiLCBcImFkbWluXCJdLFxuICAgIH0sXG4gICAgbmFtZToge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBzdXJuYW1lOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGVtYWlsOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIHVuaXF1ZTogdHJ1ZSxcbiAgICB9LFxuICAgIHBob25lTnVtYmVyOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIHVuaXF1ZTogdHJ1ZSxcbiAgICB9LFxuICAgIGlkZW50aXR5TnVtYmVyOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICBtaW5sZW5ndGg6IDExLFxuICAgICAgbWF4bGVuZ3RoOiAxMSxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgLy8gZGVmYXVsdDogXCIwMDAwMDAwMDAwMFwiLFxuICAgIH0sXG4gICAgcGFzc3dvcmQ6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgYXZhdGFyQ29sb3I6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIGRlZmF1bHQ6IHJhbmRvbUNvbG9yR2VuZXJhdG9yKCksXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGFkZHJlc3M6IHtcbiAgICAgIC8vZmF0dXJhIHZlIHNpcGFyacWfIGFkcmVzaSBkaXllIGlraXllIGF5csSxbGFiaWxpclxuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBjaXR5OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGNvdW50cnk6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgZGVmYXVsdDogXCJUdXJrZXlcIixcbiAgICB9LFxuICAgIHppcENvZGU6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgaXA6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgLy9kZWZhdWx0OiBcIjg1LjM0Ljc4LjExMlwiLCAvL2NpaGF6xLFuIGlwJ3NpbmkgYWzEsXJcbiAgICB9LFxuICAgIGlzVmVyaWZpZWQ6IHtcbiAgICAgIHR5cGU6IEJvb2xlYW4sXG4gICAgICBkZWZhdWx0OiBmYWxzZSxcbiAgICB9LFxuICAgIGNhcmRVc2VyS2V5OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICB1bmlxdWU6IHRydWUsXG4gICAgfSxcbiAgfSxcbiAge1xuICAgIF9pZDogdHJ1ZSxcbiAgICBjb2xsZWN0aW9uOiBcInVzZXJzXCIsXG4gICAgdGltZXN0YW1wczogdHJ1ZSxcbiAgICB0b0pTT046IHtcbiAgICAgIHRyYW5zZm9ybTogKGRvYywgcmV0KSA9PiB7XG4gICAgICAgIGRlbGV0ZSByZXQuX192O1xuICAgICAgICBkZWxldGUgcmV0LnBhc3N3b3JkO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLnJldCxcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgfSxcbiAgfVxuKTtcblxuVXNlclNjaGVtYS5wcmUoXCJzYXZlXCIsIGFzeW5jIGZ1bmN0aW9uIChuZXh0KSB7XG4gIHRyeSB7XG4gICAgaWYgKCF0aGlzLnBob25lTnVtYmVyLnN0YXJ0c1dpdGgoXCIrOTBcIikpIHtcbiAgICAgIHRoaXMucGhvbmVOdW1iZXIgPSBgKzkwJHt0aGlzLnBob25lTnVtYmVyfWA7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaXNNb2RpZmllZChcInBhc3N3b3JkXCIpKSB7XG4gICAgICB0aGlzLnBhc3N3b3JkID0gYXdhaXQgYmNyeXB0Lmhhc2godGhpcy5wYXNzd29yZCwgMTApO1xuICAgIH1cbiAgICByZXR1cm4gbmV4dCgpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICByZXR1cm4gbmV4dChlcnIpO1xuICB9XG4gIG5leHQoKTtcbn0pO1xuY29uc3QgVXNlcnMgPSBtb25nb29zZS5tb2RlbChcIlVzZXJzXCIsIFVzZXJTY2hlbWEpO1xuXG5leHBvcnQgZGVmYXVsdCBVc2VycztcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsU0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsU0FBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsS0FBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBO0FBQXdDLFNBQUFELHVCQUFBSSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBRXhDLE1BQU1HLE1BQU0sR0FBR0MsaUJBQVEsQ0FBQ0QsTUFBTTtBQUM5QixNQUFNO0VBQUVFO0FBQVMsQ0FBQyxHQUFHRixNQUFNLENBQUNHLEtBQUs7QUFDakMsTUFBTUMsb0JBQW9CLEdBQUdBLENBQUEsS0FBTTtFQUNqQyxPQUFPQyxJQUFJLENBQUNDLEtBQUssQ0FBQ0QsSUFBSSxDQUFDRSxNQUFNLENBQUMsQ0FBQyxHQUFHLFFBQVEsQ0FBQyxDQUFDQyxRQUFRLENBQUMsRUFBRSxDQUFDO0FBQzFELENBQUM7QUFFRCxNQUFNQyxVQUFVLEdBQUcsSUFBSVQsTUFBTSxDQUMzQjtFQUNFVSxJQUFJLEVBQUU7SUFDSkMsSUFBSSxFQUFFQyxNQUFNO0lBQ1piLE9BQU8sRUFBRUEsQ0FBQSxLQUFNLElBQUFjLGFBQVcsRUFBQyxDQUFDO0lBQzVCQyxNQUFNLEVBQUUsSUFBSTtJQUNaQyxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RDLE1BQU0sRUFBRTtJQUNOTCxJQUFJLEVBQUVDLE1BQU07SUFDWkcsUUFBUSxFQUFFLElBQUk7SUFDZGhCLE9BQU8sRUFBRSxJQUFJO0lBQ2JrQixJQUFJLEVBQUUsQ0FBQyxJQUFJLEVBQUUsSUFBSTtFQUNuQixDQUFDO0VBQ0RDLElBQUksRUFBRTtJQUNKUCxJQUFJLEVBQUVDLE1BQU07SUFDWkcsUUFBUSxFQUFFLElBQUk7SUFDZGhCLE9BQU8sRUFBRSxNQUFNO0lBQ2ZrQixJQUFJLEVBQUUsQ0FBQyxNQUFNLEVBQUUsT0FBTztFQUN4QixDQUFDO0VBQ0RFLElBQUksRUFBRTtJQUNKUixJQUFJLEVBQUVDLE1BQU07SUFDWkcsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNESyxPQUFPLEVBQUU7SUFDUFQsSUFBSSxFQUFFQyxNQUFNO0lBQ1pHLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDRE0sS0FBSyxFQUFFO0lBQ0xWLElBQUksRUFBRUMsTUFBTTtJQUNaRyxRQUFRLEVBQUUsSUFBSTtJQUNkRCxNQUFNLEVBQUU7RUFDVixDQUFDO0VBQ0RRLFdBQVcsRUFBRTtJQUNYWCxJQUFJLEVBQUVDLE1BQU07SUFDWkcsUUFBUSxFQUFFLElBQUk7SUFDZEQsTUFBTSxFQUFFO0VBQ1YsQ0FBQztFQUNEUyxjQUFjLEVBQUU7SUFDZFosSUFBSSxFQUFFQyxNQUFNO0lBQ1pZLFNBQVMsRUFBRSxFQUFFO0lBQ2JDLFNBQVMsRUFBRSxFQUFFO0lBQ2JWLFFBQVEsRUFBRTtJQUNWO0VBQ0YsQ0FBQztFQUNEVyxRQUFRLEVBQUU7SUFDUmYsSUFBSSxFQUFFQyxNQUFNO0lBQ1pHLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDRFksV0FBVyxFQUFFO0lBQ1hoQixJQUFJLEVBQUVDLE1BQU07SUFDWmIsT0FBTyxFQUFFSyxvQkFBb0IsQ0FBQyxDQUFDO0lBQy9CVyxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RhLE9BQU8sRUFBRTtJQUNQO0lBQ0FqQixJQUFJLEVBQUVDLE1BQU07SUFDWkcsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNEYyxJQUFJLEVBQUU7SUFDSmxCLElBQUksRUFBRUMsTUFBTTtJQUNaRyxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RlLE9BQU8sRUFBRTtJQUNQbkIsSUFBSSxFQUFFQyxNQUFNO0lBQ1pHLFFBQVEsRUFBRSxJQUFJO0lBQ2RoQixPQUFPLEVBQUU7RUFDWCxDQUFDO0VBQ0RnQyxPQUFPLEVBQUU7SUFDUHBCLElBQUksRUFBRUMsTUFBTTtJQUNaRyxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RpQixFQUFFLEVBQUU7SUFDRnJCLElBQUksRUFBRUMsTUFBTTtJQUNaRyxRQUFRLEVBQUU7SUFDVjtFQUNGLENBQUM7RUFDRGtCLFVBQVUsRUFBRTtJQUNWdEIsSUFBSSxFQUFFdUIsT0FBTztJQUNibkMsT0FBTyxFQUFFO0VBQ1gsQ0FBQztFQUNEb0MsV0FBVyxFQUFFO0lBQ1h4QixJQUFJLEVBQUVDLE1BQU07SUFDWkcsUUFBUSxFQUFFLEtBQUs7SUFDZkQsTUFBTSxFQUFFO0VBQ1Y7QUFDRixDQUFDLEVBQ0Q7RUFDRXNCLEdBQUcsRUFBRSxJQUFJO0VBQ1RDLFVBQVUsRUFBRSxPQUFPO0VBQ25CQyxVQUFVLEVBQUUsSUFBSTtFQUNoQkMsTUFBTSxFQUFFO0lBQ05DLFNBQVMsRUFBRUEsQ0FBQ0MsR0FBRyxFQUFFQyxHQUFHLEtBQUs7TUFDdkIsT0FBT0EsR0FBRyxDQUFDQyxHQUFHO01BQ2QsT0FBT0QsR0FBRyxDQUFDaEIsUUFBUTtNQUNuQixPQUFPO1FBQ0wsR0FBR2dCO01BQ0wsQ0FBQztJQUNIO0VBQ0Y7QUFDRixDQUNGLENBQUM7QUFFRGpDLFVBQVUsQ0FBQ21DLEdBQUcsQ0FBQyxNQUFNLEVBQUUsZ0JBQWdCQyxJQUFJLEVBQUU7RUFDM0MsSUFBSTtJQUNGLElBQUksQ0FBQyxJQUFJLENBQUN2QixXQUFXLENBQUN3QixVQUFVLENBQUMsS0FBSyxDQUFDLEVBQUU7TUFDdkMsSUFBSSxDQUFDeEIsV0FBVyxHQUFHLE1BQU0sSUFBSSxDQUFDQSxXQUFXLEVBQUU7SUFDN0M7SUFFQSxJQUFJLElBQUksQ0FBQ3lCLFVBQVUsQ0FBQyxVQUFVLENBQUMsRUFBRTtNQUMvQixJQUFJLENBQUNyQixRQUFRLEdBQUcsTUFBTXNCLGlCQUFNLENBQUNDLElBQUksQ0FBQyxJQUFJLENBQUN2QixRQUFRLEVBQUUsRUFBRSxDQUFDO0lBQ3REO0lBQ0EsT0FBT21CLElBQUksQ0FBQyxDQUFDO0VBQ2YsQ0FBQyxDQUFDLE9BQU9LLEdBQUcsRUFBRTtJQUNaLE9BQU9MLElBQUksQ0FBQ0ssR0FBRyxDQUFDO0VBQ2xCO0VBQ0FMLElBQUksQ0FBQyxDQUFDO0FBQ1IsQ0FBQyxDQUFDO0FBQ0YsTUFBTU0sS0FBSyxHQUFHbEQsaUJBQVEsQ0FBQ21ELEtBQUssQ0FBQyxPQUFPLEVBQUUzQyxVQUFVLENBQUM7QUFBQyxJQUFBNEMsUUFBQSxHQUFBQyxPQUFBLENBQUF2RCxPQUFBLEdBRW5Db0QsS0FBSyIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_bcryptjs","_interopRequireDefault","require","_mongoose","_uuid","e","__esModule","default","Schema","mongoose","ObjectId","Types","randomColorGenerator","Math","floor","random","toString","UserSchema","uuid","type","String","generatedId","unique","required","locale","enum","role","name","surname","email","phoneNumber","identityNumber","minlength","maxlength","password","avatarColor","address","city","country","zipCode","ip","isVerified","Boolean","cardUserKey","_id","collection","timestamps","toJSON","transform","doc","ret","__v","pre","next","startsWith","isModified","bcrypt","hash","err","Users","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["users.js"],"sourcesContent":["import bcrypt from \"bcryptjs\";\nimport mongoose from \"mongoose\";\nimport generatedId from \"../utils/uuid\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\nconst randomColorGenerator = () => {\n  return Math.floor(Math.random() * 16777215).toString(16);\n};\n\nconst UserSchema = new Schema(\n  {\n    uuid: {\n      type: String,\n      default: () => generatedId(),\n      unique: true,\n      required: true,\n    },\n    locale: {\n      type: String,\n      required: true,\n      default: \"tr\",\n      enum: [\"tr\", \"en\"],\n    },\n    role: {\n      type: String,\n      required: true,\n      default: \"user\",\n      enum: [\"user\", \"admin\"],\n    },\n    name: {\n      type: String,\n      required: true,\n    },\n    surname: {\n      type: String,\n      required: true,\n    },\n    email: {\n      type: String,\n      required: true,\n      unique: true,\n    },\n    phoneNumber: {\n      type: String,\n      required: true,\n      unique: true,\n    },\n    identityNumber: {\n      type: String,\n      minlength: 11,\n      maxlength: 11,\n      required: true,\n      // default: \"00000000000\",\n    },\n    password: {\n      type: String,\n      required: true,\n    },\n    avatarColor: {\n      type: String,\n      default: randomColorGenerator(),\n      required: true,\n    },\n    address: {\n      //fatura ve sipariş adresi diye ikiye ayrılabilir\n      type: String,\n      required: true,\n    },\n    city: {\n      type: String,\n      required: true,\n    },\n    country: {\n      type: String,\n      required: true,\n      default: \"Turkey\",\n    },\n    zipCode: {\n      type: String,\n      required: true,\n    },\n    ip: {\n      type: String,\n      required: true,\n      //default: \"85.34.78.112\", //cihazın ip'sini alır\n    },\n    isVerified: {\n      type: Boolean,\n      default: false,\n    },\n    cardUserKey: {\n      type: String,\n      required: false,\n      unique: true,\n    },\n  },\n  {\n    _id: true,\n    collection: \"users\",\n    timestamps: true,\n    toJSON: {\n      transform: (doc, ret) => {\n        delete ret.__v;\n        delete ret.password;\n        return {\n          ...ret,\n        };\n      },\n    },\n  }\n);\n\nUserSchema.pre(\"save\", async function (next) {\n  try {\n    if (!this.phoneNumber.startsWith(\"+90\")) {\n      this.phoneNumber = `+90${this.phoneNumber}`;\n    }\n\n    if (this.isModified(\"password\")) {\n      this.password = await bcrypt.hash(this.password, 10);\n    }\n    return next();\n  } catch (err) {\n    return next(err);\n  }\n  next();\n});\nconst Users = mongoose.model(\"Users\", UserSchema);\n\nexport default Users;\n"],"mappings":"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","ignoreList":[]}},"mtime":1734266012272},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/errors/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/errors/ApiError.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nclass ApiError extends Error {\n  constructor(message, status = 500, code) {\n    super(message);\n    this.status = status;\n    this.code = code;\n    this.name = this.constructor.name;\n    Error.captureStackTrace(this, this.constructor);\n  }\n}\nvar _default = exports.default = ApiError;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJBcGlFcnJvciIsIkVycm9yIiwiY29uc3RydWN0b3IiLCJtZXNzYWdlIiwic3RhdHVzIiwiY29kZSIsIm5hbWUiLCJjYXB0dXJlU3RhY2tUcmFjZSIsIl9kZWZhdWx0IiwiZXhwb3J0cyIsImRlZmF1bHQiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9lcnJvcnMvIiwic291cmNlcyI6WyJBcGlFcnJvci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBBcGlFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3IobWVzc2FnZSwgc3RhdHVzID0gNTAwLCBjb2RlKSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG4gICAgdGhpcy5zdGF0dXMgPSBzdGF0dXM7XG4gICAgdGhpcy5jb2RlID0gY29kZTtcbiAgICB0aGlzLm5hbWUgPSB0aGlzLmNvbnN0cnVjdG9yLm5hbWU7XG4gICAgRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UodGhpcywgdGhpcy5jb25zdHJ1Y3Rvcik7XG4gIH1cbn1cbmV4cG9ydCBkZWZhdWx0IEFwaUVycm9yO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxNQUFNQSxRQUFRLFNBQVNDLEtBQUssQ0FBQztFQUMzQkMsV0FBV0EsQ0FBQ0MsT0FBTyxFQUFFQyxNQUFNLEdBQUcsR0FBRyxFQUFFQyxJQUFJLEVBQUU7SUFDdkMsS0FBSyxDQUFDRixPQUFPLENBQUM7SUFDZCxJQUFJLENBQUNDLE1BQU0sR0FBR0EsTUFBTTtJQUNwQixJQUFJLENBQUNDLElBQUksR0FBR0EsSUFBSTtJQUNoQixJQUFJLENBQUNDLElBQUksR0FBRyxJQUFJLENBQUNKLFdBQVcsQ0FBQ0ksSUFBSTtJQUNqQ0wsS0FBSyxDQUFDTSxpQkFBaUIsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDTCxXQUFXLENBQUM7RUFDakQ7QUFDRjtBQUFDLElBQUFNLFFBQUEsR0FBQUMsT0FBQSxDQUFBQyxPQUFBLEdBQ2NWLFFBQVEiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["ApiError","Error","constructor","message","status","code","name","captureStackTrace","_default","exports","default"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/errors/","sources":["ApiError.js"],"sourcesContent":["class ApiError extends Error {\n  constructor(message, status = 500, code) {\n    super(message);\n    this.status = status;\n    this.code = code;\n    this.name = this.constructor.name;\n    Error.captureStackTrace(this, this.constructor);\n  }\n}\nexport default ApiError;\n"],"mappings":";;;;;;AAAA,MAAMA,QAAQ,SAASC,KAAK,CAAC;EAC3BC,WAAWA,CAACC,OAAO,EAAEC,MAAM,GAAG,GAAG,EAAEC,IAAI,EAAE;IACvC,KAAK,CAACF,OAAO,CAAC;IACd,IAAI,CAACC,MAAM,GAAGA,MAAM;IACpB,IAAI,CAACC,IAAI,GAAGA,IAAI;IAChB,IAAI,CAACC,IAAI,GAAG,IAAI,CAACJ,WAAW,CAACI,IAAI;IACjCL,KAAK,CAACM,iBAAiB,CAAC,IAAI,EAAE,IAAI,CAACL,WAAW,CAAC;EACjD;AACF;AAAC,IAAAM,QAAA,GAAAC,OAAA,CAAAC,OAAA,GACcV,QAAQ","ignoreList":[]}},"mtime":1721043478453},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/utils/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/utils/uuid.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _uuid = require(\"uuid\");\n//burada modellerdeki uuid verisini dolduracak id üretilir(iyzipay için gerekli)\nconst id = () => (0, _uuid.v4)();\nvar _default = exports.default = id;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfdXVpZCIsInJlcXVpcmUiLCJpZCIsInV1aWR2NCIsIl9kZWZhdWx0IiwiZXhwb3J0cyIsImRlZmF1bHQiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy91dGlscy8iLCJzb3VyY2VzIjpbInV1aWQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdjQgYXMgdXVpZHY0IH0gZnJvbSBcInV1aWRcIjtcbi8vYnVyYWRhIG1vZGVsbGVyZGVraSB1dWlkIHZlcmlzaW5pIGRvbGR1cmFjYWsgaWQgw7xyZXRpbGlyKGl5emlwYXkgacOnaW4gZ2VyZWtsaSlcbmNvbnN0IGlkID0gKCkgPT4gdXVpZHY0KCk7XG5cbmV4cG9ydCBkZWZhdWx0IGlkO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxLQUFBLEdBQUFDLE9BQUE7QUFDQTtBQUNBLE1BQU1DLEVBQUUsR0FBR0EsQ0FBQSxLQUFNLElBQUFDLFFBQU0sRUFBQyxDQUFDO0FBQUMsSUFBQUMsUUFBQSxHQUFBQyxPQUFBLENBQUFDLE9BQUEsR0FFWEosRUFBRSIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_uuid","require","id","uuidv4","_default","exports","default"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/utils/","sources":["uuid.js"],"sourcesContent":["import { v4 as uuidv4 } from \"uuid\";\n//burada modellerdeki uuid verisini dolduracak id üretilir(iyzipay için gerekli)\nconst id = () => uuidv4();\n\nexport default id;\n"],"mappings":";;;;;;AAAA,IAAAA,KAAA,GAAAC,OAAA;AACA;AACA,MAAMC,EAAE,GAAGA,CAAA,KAAM,IAAAC,QAAM,EAAC,CAAC;AAAC,IAAAC,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEXJ,EAAE","ignoreList":[]}},"mtime":1728075300218},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _cart = _interopRequireDefault(require(\"./cart\"));\nvar _comments = _interopRequireDefault(require(\"./comments\"));\nvar _paymentFailed = _interopRequireDefault(require(\"./payment-failed\"));\nvar _paymentSuccess = _interopRequireDefault(require(\"./payment-success\"));\nvar _products = _interopRequireDefault(require(\"./products\"));\nvar _replies = _interopRequireDefault(require(\"./replies\"));\nvar _seller = _interopRequireDefault(require(\"./seller\"));\nvar _users = _interopRequireDefault(require(\"./users\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = exports.default = [_users.default, _products.default, _cart.default, _paymentFailed.default, _paymentSuccess.default, _seller.default, _comments.default, _replies.default];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfY2FydCIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2NvbW1lbnRzIiwiX3BheW1lbnRGYWlsZWQiLCJfcGF5bWVudFN1Y2Nlc3MiLCJfcHJvZHVjdHMiLCJfcmVwbGllcyIsIl9zZWxsZXIiLCJfdXNlcnMiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfZGVmYXVsdCIsImV4cG9ydHMiLCJVc2VycyIsIlByb2R1Y3RzIiwiQ2FydCIsIlBheW1lbnRGYWlsZWQiLCJQYXltZW50U3VjY2VzcyIsIlNlbGxlciIsIkNvbW1lbnRzIiwiUmVwbGllcyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL2RiLyIsInNvdXJjZXMiOlsiaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IENhcnQgZnJvbSBcIi4vY2FydFwiO1xuaW1wb3J0IENvbW1lbnRzIGZyb20gXCIuL2NvbW1lbnRzXCI7XG5pbXBvcnQgUGF5bWVudEZhaWxlZCBmcm9tIFwiLi9wYXltZW50LWZhaWxlZFwiO1xuaW1wb3J0IFBheW1lbnRTdWNjZXNzIGZyb20gXCIuL3BheW1lbnQtc3VjY2Vzc1wiO1xuaW1wb3J0IFByb2R1Y3RzIGZyb20gXCIuL3Byb2R1Y3RzXCI7XG5pbXBvcnQgUmVwbGllcyBmcm9tIFwiLi9yZXBsaWVzXCI7XG5pbXBvcnQgU2VsbGVyIGZyb20gXCIuL3NlbGxlclwiO1xuaW1wb3J0IFVzZXJzIGZyb20gXCIuL3VzZXJzXCI7XG5leHBvcnQgZGVmYXVsdCBbXG4gIFVzZXJzLFxuICBQcm9kdWN0cyxcbiAgQ2FydCxcbiAgUGF5bWVudEZhaWxlZCxcbiAgUGF5bWVudFN1Y2Nlc3MsXG4gIFNlbGxlcixcbiAgQ29tbWVudHMsXG4gIFJlcGxpZXMsXG5dO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxLQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxTQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxjQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRyxlQUFBLEdBQUFKLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSSxTQUFBLEdBQUFMLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSyxRQUFBLEdBQUFOLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBTSxPQUFBLEdBQUFQLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBTyxNQUFBLEdBQUFSLHNCQUFBLENBQUFDLE9BQUE7QUFBNEIsU0FBQUQsdUJBQUFTLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFBQSxJQUFBRyxRQUFBLEdBQUFDLE9BQUEsQ0FBQUYsT0FBQSxHQUNiLENBQ2JHLGNBQUssRUFDTEMsaUJBQVEsRUFDUkMsYUFBSSxFQUNKQyxzQkFBYSxFQUNiQyx1QkFBYyxFQUNkQyxlQUFNLEVBQ05DLGlCQUFRLEVBQ1JDLGdCQUFPLENBQ1IiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_cart","_interopRequireDefault","require","_comments","_paymentFailed","_paymentSuccess","_products","_replies","_seller","_users","e","__esModule","default","_default","exports","Users","Products","Cart","PaymentFailed","PaymentSuccess","Seller","Comments","Replies"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["index.js"],"sourcesContent":["import Cart from \"./cart\";\nimport Comments from \"./comments\";\nimport PaymentFailed from \"./payment-failed\";\nimport PaymentSuccess from \"./payment-success\";\nimport Products from \"./products\";\nimport Replies from \"./replies\";\nimport Seller from \"./seller\";\nimport Users from \"./users\";\nexport default [\n  Users,\n  Products,\n  Cart,\n  PaymentFailed,\n  PaymentSuccess,\n  Seller,\n  Comments,\n  Replies,\n];\n"],"mappings":";;;;;;AAAA,IAAAA,KAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,cAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,eAAA,GAAAJ,sBAAA,CAAAC,OAAA;AACA,IAAAI,SAAA,GAAAL,sBAAA,CAAAC,OAAA;AACA,IAAAK,QAAA,GAAAN,sBAAA,CAAAC,OAAA;AACA,IAAAM,OAAA,GAAAP,sBAAA,CAAAC,OAAA;AACA,IAAAO,MAAA,GAAAR,sBAAA,CAAAC,OAAA;AAA4B,SAAAD,uBAAAS,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAAA,IAAAG,QAAA,GAAAC,OAAA,CAAAF,OAAA,GACb,CACbG,cAAK,EACLC,iBAAQ,EACRC,aAAI,EACJC,sBAAa,EACbC,uBAAc,EACdC,eAAM,EACNC,iBAAQ,EACRC,gBAAO,CACR","ignoreList":[]}},"mtime":1734612377908},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/Session.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _passport = _interopRequireDefault(require(\"passport\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Session = _passport.default.authenticate(\"jwt\", {\n  session: false\n});\nvar _default = exports.default = Session;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcGFzc3BvcnQiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIlNlc3Npb24iLCJwYXNzcG9ydCIsImF1dGhlbnRpY2F0ZSIsInNlc3Npb24iLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9taWRkbGV3YXJlcy8iLCJzb3VyY2VzIjpbIlNlc3Npb24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHBhc3Nwb3J0IGZyb20gXCJwYXNzcG9ydFwiO1xuXG5jb25zdCBTZXNzaW9uID0gcGFzc3BvcnQuYXV0aGVudGljYXRlKFwiand0XCIsIHsgc2Vzc2lvbjogZmFsc2UgfSk7XG5cbmV4cG9ydCBkZWZhdWx0IFNlc3Npb247XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUFnQyxTQUFBRCx1QkFBQUUsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUVoQyxNQUFNRyxPQUFPLEdBQUdDLGlCQUFRLENBQUNDLFlBQVksQ0FBQyxLQUFLLEVBQUU7RUFBRUMsT0FBTyxFQUFFO0FBQU0sQ0FBQyxDQUFDO0FBQUMsSUFBQUMsUUFBQSxHQUFBQyxPQUFBLENBQUFOLE9BQUEsR0FFbERDLE9BQU8iLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_passport","_interopRequireDefault","require","e","__esModule","default","Session","passport","authenticate","session","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["Session.js"],"sourcesContent":["import passport from \"passport\";\n\nconst Session = passport.authenticate(\"jwt\", { session: false });\n\nexport default Session;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AAAgC,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEhC,MAAMG,OAAO,GAAGC,iBAAQ,CAACC,YAAY,CAAC,KAAK,EAAE;EAAEC,OAAO,EAAE;AAAM,CAAC,CAAC;AAAC,IAAAC,QAAA,GAAAC,OAAA,CAAAN,OAAA,GAElDC,OAAO","ignoreList":[]}},"mtime":1722848733624},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _Comments = _interopRequireDefault(require(\"./Comments\"));\nvar _Products = _interopRequireDefault(require(\"./Products\"));\nvar _Replies = _interopRequireDefault(require(\"./Replies\"));\nvar _Sellers = _interopRequireDefault(require(\"./Sellers\"));\nvar _Users = _interopRequireDefault(require(\"./Users\"));\nvar _admin = _interopRequireDefault(require(\"./admin\"));\nvar _cancelPayments = _interopRequireDefault(require(\"./cancel-payments\"));\nvar _cards = _interopRequireDefault(require(\"./cards\"));\nvar _cart = _interopRequireDefault(require(\"./cart\"));\nvar _checkouts = _interopRequireDefault(require(\"./checkouts\"));\nvar _installments = _interopRequireDefault(require(\"./installments\"));\nvar _payments = _interopRequireDefault(require(\"./payments\"));\nvar _refundPayments = _interopRequireDefault(require(\"./refund-payments\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = exports.default = [_Users.default, _Products.default, _cart.default, _payments.default, _cards.default, _cancelPayments.default, _checkouts.default, _installments.default, _refundPayments.default, _Sellers.default, _admin.default, _Comments.default, _Replies.default];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQ29tbWVudHMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9Qcm9kdWN0cyIsIl9SZXBsaWVzIiwiX1NlbGxlcnMiLCJfVXNlcnMiLCJfYWRtaW4iLCJfY2FuY2VsUGF5bWVudHMiLCJfY2FyZHMiLCJfY2FydCIsIl9jaGVja291dHMiLCJfaW5zdGFsbG1lbnRzIiwiX3BheW1lbnRzIiwiX3JlZnVuZFBheW1lbnRzIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiX2RlZmF1bHQiLCJleHBvcnRzIiwidXNlcnMiLCJQcm9kdWN0cyIsImNhcnRzIiwiUGF5bWVudHMiLCJDYXJkcyIsIkNhbmNlbFBheW1lbnRzIiwiQ2hlY2tvdXRzIiwiSW5zdGFsbG1lbnRzIiwiUmVmdW5kUGF5bWVudHMiLCJTZWxsZXIiLCJhZG1pbiIsIkNvbW1lbnRzIiwiUmVwbGllcyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3JvdXRlcy8iLCJzb3VyY2VzIjpbImluZGV4LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDb21tZW50cyBmcm9tIFwiLi9Db21tZW50c1wiO1xuaW1wb3J0IFByb2R1Y3RzIGZyb20gXCIuL1Byb2R1Y3RzXCI7XG5pbXBvcnQgUmVwbGllcyBmcm9tIFwiLi9SZXBsaWVzXCI7XG5pbXBvcnQgU2VsbGVyIGZyb20gXCIuL1NlbGxlcnNcIjtcbmltcG9ydCB1c2VycyBmcm9tIFwiLi9Vc2Vyc1wiO1xuaW1wb3J0IGFkbWluIGZyb20gXCIuL2FkbWluXCI7XG5pbXBvcnQgQ2FuY2VsUGF5bWVudHMgZnJvbSBcIi4vY2FuY2VsLXBheW1lbnRzXCI7XG5pbXBvcnQgQ2FyZHMgZnJvbSBcIi4vY2FyZHNcIjtcbmltcG9ydCBjYXJ0cyBmcm9tIFwiLi9jYXJ0XCI7XG5pbXBvcnQgQ2hlY2tvdXRzIGZyb20gXCIuL2NoZWNrb3V0c1wiO1xuaW1wb3J0IEluc3RhbGxtZW50cyBmcm9tIFwiLi9pbnN0YWxsbWVudHNcIjtcbmltcG9ydCBQYXltZW50cyBmcm9tIFwiLi9wYXltZW50c1wiO1xuaW1wb3J0IFJlZnVuZFBheW1lbnRzIGZyb20gXCIuL3JlZnVuZC1wYXltZW50c1wiO1xuZXhwb3J0IGRlZmF1bHQgW1xuICB1c2VycyxcbiAgUHJvZHVjdHMsXG4gIGNhcnRzLFxuICBQYXltZW50cyxcbiAgQ2FyZHMsXG4gIENhbmNlbFBheW1lbnRzLFxuICBDaGVja291dHMsXG4gIEluc3RhbGxtZW50cyxcbiAgUmVmdW5kUGF5bWVudHMsXG4gIFNlbGxlcixcbiAgYWRtaW4sXG4gIENvbW1lbnRzLFxuICBSZXBsaWVzLFxuXTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsU0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsU0FBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsUUFBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUcsUUFBQSxHQUFBSixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUksTUFBQSxHQUFBTCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUssTUFBQSxHQUFBTixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQU0sZUFBQSxHQUFBUCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQU8sTUFBQSxHQUFBUixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQVEsS0FBQSxHQUFBVCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQVMsVUFBQSxHQUFBVixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQVUsYUFBQSxHQUFBWCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQVcsU0FBQSxHQUFBWixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQVksZUFBQSxHQUFBYixzQkFBQSxDQUFBQyxPQUFBO0FBQStDLFNBQUFELHVCQUFBYyxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBQUEsSUFBQUcsUUFBQSxHQUFBQyxPQUFBLENBQUFGLE9BQUEsR0FDaEMsQ0FDYkcsY0FBSyxFQUNMQyxpQkFBUSxFQUNSQyxhQUFLLEVBQ0xDLGlCQUFRLEVBQ1JDLGNBQUssRUFDTEMsdUJBQWMsRUFDZEMsa0JBQVMsRUFDVEMscUJBQVksRUFDWkMsdUJBQWMsRUFDZEMsZ0JBQU0sRUFDTkMsY0FBSyxFQUNMQyxpQkFBUSxFQUNSQyxnQkFBTyxDQUNSIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["_Comments","_interopRequireDefault","require","_Products","_Replies","_Sellers","_Users","_admin","_cancelPayments","_cards","_cart","_checkouts","_installments","_payments","_refundPayments","e","__esModule","default","_default","exports","users","Products","carts","Payments","Cards","CancelPayments","Checkouts","Installments","RefundPayments","Seller","admin","Comments","Replies"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["index.js"],"sourcesContent":["import Comments from \"./Comments\";\nimport Products from \"./Products\";\nimport Replies from \"./Replies\";\nimport Seller from \"./Sellers\";\nimport users from \"./Users\";\nimport admin from \"./admin\";\nimport CancelPayments from \"./cancel-payments\";\nimport Cards from \"./cards\";\nimport carts from \"./cart\";\nimport Checkouts from \"./checkouts\";\nimport Installments from \"./installments\";\nimport Payments from \"./payments\";\nimport RefundPayments from \"./refund-payments\";\nexport default [\n  users,\n  Products,\n  carts,\n  Payments,\n  Cards,\n  CancelPayments,\n  Checkouts,\n  Installments,\n  RefundPayments,\n  Seller,\n  admin,\n  Comments,\n  Replies,\n];\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,QAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,QAAA,GAAAJ,sBAAA,CAAAC,OAAA;AACA,IAAAI,MAAA,GAAAL,sBAAA,CAAAC,OAAA;AACA,IAAAK,MAAA,GAAAN,sBAAA,CAAAC,OAAA;AACA,IAAAM,eAAA,GAAAP,sBAAA,CAAAC,OAAA;AACA,IAAAO,MAAA,GAAAR,sBAAA,CAAAC,OAAA;AACA,IAAAQ,KAAA,GAAAT,sBAAA,CAAAC,OAAA;AACA,IAAAS,UAAA,GAAAV,sBAAA,CAAAC,OAAA;AACA,IAAAU,aAAA,GAAAX,sBAAA,CAAAC,OAAA;AACA,IAAAW,SAAA,GAAAZ,sBAAA,CAAAC,OAAA;AACA,IAAAY,eAAA,GAAAb,sBAAA,CAAAC,OAAA;AAA+C,SAAAD,uBAAAc,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAAA,IAAAG,QAAA,GAAAC,OAAA,CAAAF,OAAA,GAChC,CACbG,cAAK,EACLC,iBAAQ,EACRC,aAAK,EACLC,iBAAQ,EACRC,cAAK,EACLC,uBAAc,EACdC,kBAAS,EACTC,qBAAY,EACZC,uBAAc,EACdC,gBAAM,EACNC,cAAK,EACLC,iBAAQ,EACRC,gBAAO,CACR","ignoreList":[]}},"mtime":1734613563479},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/Users.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\nvar _cart = _interopRequireDefault(require(\"../db/cart\"));\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _CheckExistence = require(\"../helpers/CheckExistence\");\nvar _RequiredCheck = require(\"../helpers/RequiredCheck\");\nvar _ForgotPasswordMail = require(\"../middlewares/ForgotPasswordMail\");\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nvar _VerificationEmail = _interopRequireDefault(require(\"../middlewares/VerificationEmail\"));\nvar _getUserIP = _interopRequireDefault(require(\"../middlewares/getUserIP\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = router => {\n  router.post(\"/register\", _getUserIP.default, async (req, res, next) => {\n    const {\n      email,\n      name,\n      surname,\n      phoneNumber,\n      identityNumber,\n      password,\n      address,\n      city,\n      country,\n      zipCode\n    } = req.body;\n    try {\n      (0, _RequiredCheck.checkLotsOfRequiredField)([{\n        field: email,\n        fieldName: \"E-Mail\"\n      }, {\n        field: name,\n        fieldName: \"Name\"\n      }, {\n        field: surname,\n        fieldName: \"Surname\"\n      }, {\n        field: phoneNumber,\n        fieldName: \"Phone Number\"\n      }, {\n        field: address,\n        fieldName: \"Address\"\n      }, {\n        field: city,\n        fieldName: \"City\"\n      }, {\n        field: country,\n        fieldName: \"Country\"\n      }, {\n        field: zipCode,\n        fieldName: \"Zip Code\"\n      }, {\n        field: identityNumber,\n        fieldName: \"İdentity Number\"\n      }]);\n    } catch (error) {\n      return res.status(400).send(error);\n    }\n    const existingUser = await _users.default.findOne({\n      email\n    });\n    if (existingUser) {\n      return res.status(400).send(new _ApiError.default(400, \"Bu e-posta zaten kullanılıyor\"));\n    }\n    const user = new _users.default({\n      email,\n      name,\n      surname,\n      phoneNumber,\n      identityNumber,\n      password,\n      address,\n      city,\n      country,\n      zipCode,\n      ip: req.userIp // Kullanıcı IP'sini ekle\n    });\n    try {\n      await user.save();\n      req.user = user;\n      next();\n      // return res\n      //   .status(200)\n      //   .json(`${email} mail adresi ile kullanıcı oluşturuldu.`);\n    } catch (error) {\n      console.log(error);\n      return res.status(500).send(new _ApiError.default(500, \"Kayıt işlemi sırasında hata oluştu\"));\n    }\n  }, _VerificationEmail.default,\n  //silinebilir çalışmazsa\n  (req, res) => {\n    return res.status(200).json(`${req.user.email} mail adresi ile kullanıcı oluşturuldu. Lütfen E-postanızı doğrulayınız.` //middlewaredeki üretilen jwtyi konsola yazdır\n    );\n  });\n  router.get(\"/verify-email/\", async (req, res) => {\n    const {\n      token\n    } = req.query;\n    try {\n      (0, _RequiredCheck.checkRequiredField)(token, \"Token\");\n    } catch (error) {\n      return res.status(400).json(error);\n    }\n    try {\n      const decoded = _jsonwebtoken.default.verify(token, process.env.JWT_SECRET);\n      const user = await _users.default.findById(decoded.id);\n      (0, _CheckExistence.notFoundVariable)(user, \"User\");\n      if (user.isVerified) {\n        return res.status(400).send(new _ApiError.default(400, \"Kullanıcı zaten doğrulanmış\"));\n      }\n      user.isVerified = true;\n      await user.save();\n      return res.sendFile(\"verification-success.html\", {\n        root: \"public\"\n      });\n    } catch (error) {\n      console.log(error);\n      return res.status(500).send(new _ApiError.default(500, \"Doğrulama işlemi sırasında hata oluştu\"));\n    }\n  });\n  router.post(\"/login\", async (req, res) => {\n    const {\n      email,\n      password\n    } = req.body;\n    const user = await _users.default.findOne({\n      email\n    });\n    try {\n      (0, _RequiredCheck.checkLotsOfRequiredField)([{\n        field: email,\n        fieldName: \"E-Mail\"\n      }, {\n        field: password,\n        fieldName: \"Password\"\n      }]);\n    } catch (error) {\n      return res.status(400).json(error);\n    }\n    if (!user) {\n      throw new _ApiError.default(\"Incorrect Password or email\", 401, \"userOrPasswordIncorrect\");\n    }\n    if (user.isVerified == false) {\n      throw new _ApiError.default(\"You have to verificate your account.\", 401, \"accountNotVerified\");\n    }\n    const passwordConfirmed = await _bcryptjs.default.compare(password, user.password);\n    // console.log(\"kullanıcı girdisi:\", password); silinecekler\n    // console.log(\"hashlenmiş hali:\", user.password);\n\n    if (passwordConfirmed) {\n      const userJson = user.toJSON();\n      const token = _jsonwebtoken.default.sign(userJson, process.env.JWT_SECRET);\n      res.json({\n        token: `Bearer ${token}`,\n        user: userJson\n      });\n    } else {\n      throw new _ApiError.default(\"Incorrect Password or email\", 401, \"userOrPasswordIncorrect\");\n    }\n  });\n  router.put(\"/user/update\", _Session.default, async (req, res) => {\n    const {\n      phoneNumber,\n      address,\n      city\n    } = req.body;\n    const user = req.user;\n    try {\n      if (phoneNumber) {\n        const existingUser = await _users.default.findOne({\n          phoneNumber\n        });\n        if (existingUser && existingUser._id.toString() !== user._id.toString()) {\n          throw new _ApiError.default(\"This phone number already using\", 400, \"phoneNumberAlreadyUsing\");\n        }\n      }\n      const updateUser = await _users.default.findByIdAndUpdate(user, {\n        phoneNumber,\n        address,\n        city\n      }, {\n        new: true\n      });\n      (0, _CheckExistence.notFoundVariable)(updateUser, \"User\");\n      return res.status(200).json({\n        message: \"user information has been changed\",\n        user\n      });\n    } catch (error) {\n      console.log(error);\n      throw new _ApiError.default(\"User informations cannot change\", 500, \"cannotChangeUserInformation\");\n    }\n  });\n  router.put(\"/user/change-password\", _Session.default, async (req, res) => {\n    const {\n      oldPassword,\n      newPassword,\n      confirmPassword\n    } = req.body;\n    const user = req.user;\n    try {\n      const existingUser = await _users.default.findById(user._id);\n      if (!existingUser) {\n        throw new _ApiError.default(\"User Not Found\", 404, \"notFoundUser\");\n      }\n      const isMatchPassword = await _bcryptjs.default.compare(oldPassword, existingUser.password);\n      if (!isMatchPassword) {\n        throw new _ApiError.default(\"Incorrect old password\", 404, \"incorrectOldPassword\");\n      }\n      if (newPassword !== confirmPassword) {\n        throw new _ApiError.default(\"New password and confirm password do not match\", 404, \"passwordsDoNotMatch\");\n      }\n      const isSamePassword = await _bcryptjs.default.compare(newPassword, existingUser.password);\n      if (isSamePassword) {\n        throw new _ApiError.default(\"New Password cannot be the same as the old password\", 400, \"sameAsOldPassword\");\n      }\n      existingUser.password = newPassword;\n      await existingUser.save();\n      console.log(\"Old Password (unhashed):\", oldPassword);\n      console.log(\"New Password (unhashed):\", newPassword);\n      return res.status(200).json({\n        message: \"Password has been changed successfully\",\n        user\n      });\n    } catch (error) {\n      console.log(error);\n      res.status(error.statusCode || 500).json({\n        message: error.message || \"Password change failed\",\n        code: error.code || \"passwordChangeFailed\"\n      });\n    }\n  });\n  router.post(\"/forgot-password\", _ForgotPasswordMail.forgotPasswordEmail, async (req, res) => {\n    const {\n      email\n    } = req.body;\n    const userEmail = await _users.default.findOne({\n      email\n    });\n    (0, _CheckExistence.noExistVariable)(userEmail, \"Email\");\n    res.status(200).send(\"Link has been send\");\n  });\n  router.get(\"/user/orders/:cartId\", _Session.default, async (req, res) => {\n    const {\n      cartId\n    } = req.params;\n    const userId = req.user._id;\n    try {\n      const userOrders = await _cart.default.findOne({\n        _id: cartId,\n        completed: true,\n        buyer: userId\n      }).populate(\"products.productId\", \"name price images categories\").populate(\"products.seller\", \"SellerName\");\n      if (!userOrders) {\n        throw new _ApiError.default(\"Cart not found or not completed\", 404, \"cartNotFound\");\n      }\n      res.status(200).json(userOrders);\n    } catch (error) {\n      console.log(error);\n      throw new _ApiError.default(\"Could not get cart orders\", 400, \"getCartOrderFailed\");\n    }\n  });\n  router.get(\"/user/orders\", _Session.default, async (req, res) => {\n    try {\n      const userOrders = await _cart.default.find({\n        buyer: req.user._id,\n        completed: true\n      }).populate(\"products.productId\", \"name price images categories\").populate(\"products.seller\", \"SellerName\");\n      res.status(200).json(userOrders);\n    } catch (error) {\n      console.log(error);\n      throw new _ApiError.default(\"Could not get orders\", 400, \"getOrderFailed\");\n    }\n  });\n\n  // router.get(\"/user/orders\", Session, async (req, res) => {\n  //   const userId = req.user._id;\n  //   try {\n  //     // const cart = await Cart.find({ buyer: req.user._id, completed: true });\n  //     const paymentSuccess = await PaymentSuccess.find({\n  //       status: \"success\",\n  //     })\n  //       .select(\"price paymentId createdAt\")\n  //       .populate({ path: \"cartId\", select: \"buyer\" });\n\n  //     // Giriş yapan kullanıcıya ait olan ödemeleri filtreliyoruz\n  //     const userPayments = paymentSuccess.filter((payment) => {\n  //       // Populate edilmiş cartId içerisinden buyer kontrolü yapıyoruz\n  //       return String(payment.cartId.buyer) === String(userId);\n  //     });\n\n  //     if (userPayments.length === 0) {\n  //       return res\n  //         .status(404)\n  //         .json({ message: \"No payments found for this user\" });\n  //     }\n\n  //     res.status(200).json({ userPayments });\n  //   } catch (error) {\n  //     console.log(error);\n  //     throw new ApiError(\"Could not get orders\", 400, \"getOrderFailed\");\n  //   }\n  // });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYmNyeXB0anMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9qc29ud2VidG9rZW4iLCJfY2FydCIsIl91c2VycyIsIl9BcGlFcnJvciIsIl9DaGVja0V4aXN0ZW5jZSIsIl9SZXF1aXJlZENoZWNrIiwiX0ZvcmdvdFBhc3N3b3JkTWFpbCIsIl9TZXNzaW9uIiwiX1ZlcmlmaWNhdGlvbkVtYWlsIiwiX2dldFVzZXJJUCIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIl9kZWZhdWx0Iiwicm91dGVyIiwicG9zdCIsImdldFVzZXJJcCIsInJlcSIsInJlcyIsIm5leHQiLCJlbWFpbCIsIm5hbWUiLCJzdXJuYW1lIiwicGhvbmVOdW1iZXIiLCJpZGVudGl0eU51bWJlciIsInBhc3N3b3JkIiwiYWRkcmVzcyIsImNpdHkiLCJjb3VudHJ5IiwiemlwQ29kZSIsImJvZHkiLCJjaGVja0xvdHNPZlJlcXVpcmVkRmllbGQiLCJmaWVsZCIsImZpZWxkTmFtZSIsImVycm9yIiwic3RhdHVzIiwic2VuZCIsImV4aXN0aW5nVXNlciIsIlVzZXJzIiwiZmluZE9uZSIsIkFwaUVycm9yIiwidXNlciIsImlwIiwidXNlcklwIiwic2F2ZSIsImNvbnNvbGUiLCJsb2ciLCJzZW5kVmVyaWZpY2F0aW9uRW1haWwiLCJqc29uIiwiZ2V0IiwidG9rZW4iLCJxdWVyeSIsImNoZWNrUmVxdWlyZWRGaWVsZCIsImRlY29kZWQiLCJqd3QiLCJ2ZXJpZnkiLCJwcm9jZXNzIiwiZW52IiwiSldUX1NFQ1JFVCIsImZpbmRCeUlkIiwiaWQiLCJub3RGb3VuZFZhcmlhYmxlIiwiaXNWZXJpZmllZCIsInNlbmRGaWxlIiwicm9vdCIsInBhc3N3b3JkQ29uZmlybWVkIiwiYmNyeXB0IiwiY29tcGFyZSIsInVzZXJKc29uIiwidG9KU09OIiwic2lnbiIsInB1dCIsIlNlc3Npb24iLCJfaWQiLCJ0b1N0cmluZyIsInVwZGF0ZVVzZXIiLCJmaW5kQnlJZEFuZFVwZGF0ZSIsIm5ldyIsIm1lc3NhZ2UiLCJvbGRQYXNzd29yZCIsIm5ld1Bhc3N3b3JkIiwiY29uZmlybVBhc3N3b3JkIiwiaXNNYXRjaFBhc3N3b3JkIiwiaXNTYW1lUGFzc3dvcmQiLCJzdGF0dXNDb2RlIiwiY29kZSIsImZvcmdvdFBhc3N3b3JkRW1haWwiLCJ1c2VyRW1haWwiLCJub0V4aXN0VmFyaWFibGUiLCJjYXJ0SWQiLCJwYXJhbXMiLCJ1c2VySWQiLCJ1c2VyT3JkZXJzIiwiQ2FydCIsImNvbXBsZXRlZCIsImJ1eWVyIiwicG9wdWxhdGUiLCJmaW5kIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3JvdXRlcy8iLCJzb3VyY2VzIjpbIlVzZXJzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBiY3J5cHQgZnJvbSBcImJjcnlwdGpzXCI7XG5pbXBvcnQgand0IGZyb20gXCJqc29ud2VidG9rZW5cIjtcbmltcG9ydCBDYXJ0IGZyb20gXCIuLi9kYi9jYXJ0XCI7XG5pbXBvcnQgVXNlcnMgZnJvbSBcIi4uL2RiL3VzZXJzXCI7XG5pbXBvcnQgQXBpRXJyb3IgZnJvbSBcIi4uL2Vycm9ycy9BcGlFcnJvclwiO1xuaW1wb3J0IHsgbm9FeGlzdFZhcmlhYmxlLCBub3RGb3VuZFZhcmlhYmxlIH0gZnJvbSBcIi4uL2hlbHBlcnMvQ2hlY2tFeGlzdGVuY2VcIjtcbmltcG9ydCB7XG4gIGNoZWNrTG90c09mUmVxdWlyZWRGaWVsZCxcbiAgY2hlY2tSZXF1aXJlZEZpZWxkLFxufSBmcm9tIFwiLi4vaGVscGVycy9SZXF1aXJlZENoZWNrXCI7XG5pbXBvcnQgeyBmb3Jnb3RQYXNzd29yZEVtYWlsIH0gZnJvbSBcIi4uL21pZGRsZXdhcmVzL0ZvcmdvdFBhc3N3b3JkTWFpbFwiO1xuaW1wb3J0IFNlc3Npb24gZnJvbSBcIi4uL21pZGRsZXdhcmVzL1Nlc3Npb25cIjtcbmltcG9ydCBzZW5kVmVyaWZpY2F0aW9uRW1haWwgZnJvbSBcIi4uL21pZGRsZXdhcmVzL1ZlcmlmaWNhdGlvbkVtYWlsXCI7XG5pbXBvcnQgZ2V0VXNlcklwIGZyb20gXCIuLi9taWRkbGV3YXJlcy9nZXRVc2VySVBcIjtcblxuZXhwb3J0IGRlZmF1bHQgKHJvdXRlcikgPT4ge1xuICByb3V0ZXIucG9zdChcbiAgICBcIi9yZWdpc3RlclwiLFxuICAgIGdldFVzZXJJcCxcbiAgICBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgZW1haWwsXG4gICAgICAgIG5hbWUsXG4gICAgICAgIHN1cm5hbWUsXG4gICAgICAgIHBob25lTnVtYmVyLFxuICAgICAgICBpZGVudGl0eU51bWJlcixcbiAgICAgICAgcGFzc3dvcmQsXG4gICAgICAgIGFkZHJlc3MsXG4gICAgICAgIGNpdHksXG4gICAgICAgIGNvdW50cnksXG4gICAgICAgIHppcENvZGUsXG4gICAgICB9ID0gcmVxLmJvZHk7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGNoZWNrTG90c09mUmVxdWlyZWRGaWVsZChbXG4gICAgICAgICAgeyBmaWVsZDogZW1haWwsIGZpZWxkTmFtZTogXCJFLU1haWxcIiB9LFxuICAgICAgICAgIHsgZmllbGQ6IG5hbWUsIGZpZWxkTmFtZTogXCJOYW1lXCIgfSxcbiAgICAgICAgICB7IGZpZWxkOiBzdXJuYW1lLCBmaWVsZE5hbWU6IFwiU3VybmFtZVwiIH0sXG4gICAgICAgICAgeyBmaWVsZDogcGhvbmVOdW1iZXIsIGZpZWxkTmFtZTogXCJQaG9uZSBOdW1iZXJcIiB9LFxuICAgICAgICAgIHsgZmllbGQ6IGFkZHJlc3MsIGZpZWxkTmFtZTogXCJBZGRyZXNzXCIgfSxcbiAgICAgICAgICB7IGZpZWxkOiBjaXR5LCBmaWVsZE5hbWU6IFwiQ2l0eVwiIH0sXG4gICAgICAgICAgeyBmaWVsZDogY291bnRyeSwgZmllbGROYW1lOiBcIkNvdW50cnlcIiB9LFxuICAgICAgICAgIHsgZmllbGQ6IHppcENvZGUsIGZpZWxkTmFtZTogXCJaaXAgQ29kZVwiIH0sXG4gICAgICAgICAgeyBmaWVsZDogaWRlbnRpdHlOdW1iZXIsIGZpZWxkTmFtZTogXCLEsGRlbnRpdHkgTnVtYmVyXCIgfSxcbiAgICAgICAgXSk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoZXJyb3IpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBleGlzdGluZ1VzZXIgPSBhd2FpdCBVc2Vycy5maW5kT25lKHsgZW1haWwgfSk7XG4gICAgICBpZiAoZXhpc3RpbmdVc2VyKSB7XG4gICAgICAgIHJldHVybiByZXNcbiAgICAgICAgICAuc3RhdHVzKDQwMClcbiAgICAgICAgICAuc2VuZChuZXcgQXBpRXJyb3IoNDAwLCBcIkJ1IGUtcG9zdGEgemF0ZW4ga3VsbGFuxLFsxLF5b3JcIikpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCB1c2VyID0gbmV3IFVzZXJzKHtcbiAgICAgICAgZW1haWwsXG4gICAgICAgIG5hbWUsXG4gICAgICAgIHN1cm5hbWUsXG4gICAgICAgIHBob25lTnVtYmVyLFxuICAgICAgICBpZGVudGl0eU51bWJlcixcbiAgICAgICAgcGFzc3dvcmQsXG4gICAgICAgIGFkZHJlc3MsXG4gICAgICAgIGNpdHksXG4gICAgICAgIGNvdW50cnksXG4gICAgICAgIHppcENvZGUsXG4gICAgICAgIGlwOiByZXEudXNlcklwLCAvLyBLdWxsYW7EsWPEsSBJUCdzaW5pIGVrbGVcbiAgICAgIH0pO1xuXG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCB1c2VyLnNhdmUoKTtcbiAgICAgICAgcmVxLnVzZXIgPSB1c2VyO1xuICAgICAgICBuZXh0KCk7XG4gICAgICAgIC8vIHJldHVybiByZXNcbiAgICAgICAgLy8gICAuc3RhdHVzKDIwMClcbiAgICAgICAgLy8gICAuanNvbihgJHtlbWFpbH0gbWFpbCBhZHJlc2kgaWxlIGt1bGxhbsSxY8SxIG9sdcWfdHVydWxkdS5gKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgcmV0dXJuIHJlc1xuICAgICAgICAgIC5zdGF0dXMoNTAwKVxuICAgICAgICAgIC5zZW5kKG5ldyBBcGlFcnJvcig1MDAsIFwiS2F5xLF0IGnFn2xlbWkgc8SxcmFzxLFuZGEgaGF0YSBvbHXFn3R1XCIpKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIHNlbmRWZXJpZmljYXRpb25FbWFpbCwgLy9zaWxpbmViaWxpciDDp2FsxLHFn21henNhXG4gICAgKHJlcSwgcmVzKSA9PiB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24oXG4gICAgICAgIGAke3JlcS51c2VyLmVtYWlsfSBtYWlsIGFkcmVzaSBpbGUga3VsbGFuxLFjxLEgb2x1xZ90dXJ1bGR1LiBMw7x0ZmVuIEUtcG9zdGFuxLF6xLEgZG/En3J1bGF5xLFuxLF6LmAgLy9taWRkbGV3YXJlZGVraSDDvHJldGlsZW4gand0eWkga29uc29sYSB5YXpkxLFyXG4gICAgICApO1xuICAgIH1cbiAgKTtcblxuICByb3V0ZXIuZ2V0KFwiL3ZlcmlmeS1lbWFpbC9cIiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyB0b2tlbiB9ID0gcmVxLnF1ZXJ5O1xuXG4gICAgdHJ5IHtcbiAgICAgIGNoZWNrUmVxdWlyZWRGaWVsZCh0b2tlbiwgXCJUb2tlblwiKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKGVycm9yKTtcbiAgICB9XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgZGVjb2RlZCA9IGp3dC52ZXJpZnkodG9rZW4sIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQpO1xuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXJzLmZpbmRCeUlkKGRlY29kZWQuaWQpO1xuXG4gICAgICBub3RGb3VuZFZhcmlhYmxlKHVzZXIsIFwiVXNlclwiKTtcblxuICAgICAgaWYgKHVzZXIuaXNWZXJpZmllZCkge1xuICAgICAgICByZXR1cm4gcmVzXG4gICAgICAgICAgLnN0YXR1cyg0MDApXG4gICAgICAgICAgLnNlbmQobmV3IEFwaUVycm9yKDQwMCwgXCJLdWxsYW7EsWPEsSB6YXRlbiBkb8SfcnVsYW5txLHFn1wiKSk7XG4gICAgICB9XG5cbiAgICAgIHVzZXIuaXNWZXJpZmllZCA9IHRydWU7XG4gICAgICBhd2FpdCB1c2VyLnNhdmUoKTtcblxuICAgICAgcmV0dXJuIHJlcy5zZW5kRmlsZShcInZlcmlmaWNhdGlvbi1zdWNjZXNzLmh0bWxcIiwgeyByb290OiBcInB1YmxpY1wiIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICByZXR1cm4gcmVzXG4gICAgICAgIC5zdGF0dXMoNTAwKVxuICAgICAgICAuc2VuZChuZXcgQXBpRXJyb3IoNTAwLCBcIkRvxJ9ydWxhbWEgacWfbGVtaSBzxLFyYXPEsW5kYSBoYXRhIG9sdcWfdHVcIikpO1xuICAgIH1cbiAgfSk7XG5cbiAgcm91dGVyLnBvc3QoXCIvbG9naW5cIiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyBlbWFpbCwgcGFzc3dvcmQgfSA9IHJlcS5ib2R5O1xuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2Vycy5maW5kT25lKHsgZW1haWwgfSk7XG5cbiAgICB0cnkge1xuICAgICAgY2hlY2tMb3RzT2ZSZXF1aXJlZEZpZWxkKFtcbiAgICAgICAgeyBmaWVsZDogZW1haWwsIGZpZWxkTmFtZTogXCJFLU1haWxcIiB9LFxuICAgICAgICB7IGZpZWxkOiBwYXNzd29yZCwgZmllbGROYW1lOiBcIlBhc3N3b3JkXCIgfSxcbiAgICAgIF0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oZXJyb3IpO1xuICAgIH1cblxuICAgIGlmICghdXNlcikge1xuICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICBcIkluY29ycmVjdCBQYXNzd29yZCBvciBlbWFpbFwiLFxuICAgICAgICA0MDEsXG4gICAgICAgIFwidXNlck9yUGFzc3dvcmRJbmNvcnJlY3RcIlxuICAgICAgKTtcbiAgICB9XG4gICAgaWYgKHVzZXIuaXNWZXJpZmllZCA9PSBmYWxzZSkge1xuICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICBcIllvdSBoYXZlIHRvIHZlcmlmaWNhdGUgeW91ciBhY2NvdW50LlwiLFxuICAgICAgICA0MDEsXG4gICAgICAgIFwiYWNjb3VudE5vdFZlcmlmaWVkXCJcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IHBhc3N3b3JkQ29uZmlybWVkID0gYXdhaXQgYmNyeXB0LmNvbXBhcmUocGFzc3dvcmQsIHVzZXIucGFzc3dvcmQpO1xuICAgIC8vIGNvbnNvbGUubG9nKFwia3VsbGFuxLFjxLEgZ2lyZGlzaTpcIiwgcGFzc3dvcmQpOyBzaWxpbmVjZWtsZXJcbiAgICAvLyBjb25zb2xlLmxvZyhcImhhc2hsZW5tacWfIGhhbGk6XCIsIHVzZXIucGFzc3dvcmQpO1xuXG4gICAgaWYgKHBhc3N3b3JkQ29uZmlybWVkKSB7XG4gICAgICBjb25zdCB1c2VySnNvbiA9IHVzZXIudG9KU09OKCk7XG4gICAgICBjb25zdCB0b2tlbiA9IGp3dC5zaWduKHVzZXJKc29uLCBwcm9jZXNzLmVudi5KV1RfU0VDUkVUKTtcbiAgICAgIHJlcy5qc29uKHtcbiAgICAgICAgdG9rZW46IGBCZWFyZXIgJHt0b2tlbn1gLFxuICAgICAgICB1c2VyOiB1c2VySnNvbixcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgIFwiSW5jb3JyZWN0IFBhc3N3b3JkIG9yIGVtYWlsXCIsXG4gICAgICAgIDQwMSxcbiAgICAgICAgXCJ1c2VyT3JQYXNzd29yZEluY29ycmVjdFwiXG4gICAgICApO1xuICAgIH1cbiAgfSk7XG5cbiAgcm91dGVyLnB1dChcIi91c2VyL3VwZGF0ZVwiLCBTZXNzaW9uLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICBjb25zdCB7IHBob25lTnVtYmVyLCBhZGRyZXNzLCBjaXR5IH0gPSByZXEuYm9keTtcbiAgICBjb25zdCB1c2VyID0gcmVxLnVzZXI7XG5cbiAgICB0cnkge1xuICAgICAgaWYgKHBob25lTnVtYmVyKSB7XG4gICAgICAgIGNvbnN0IGV4aXN0aW5nVXNlciA9IGF3YWl0IFVzZXJzLmZpbmRPbmUoeyBwaG9uZU51bWJlciB9KTtcbiAgICAgICAgaWYgKFxuICAgICAgICAgIGV4aXN0aW5nVXNlciAmJlxuICAgICAgICAgIGV4aXN0aW5nVXNlci5faWQudG9TdHJpbmcoKSAhPT0gdXNlci5faWQudG9TdHJpbmcoKVxuICAgICAgICApIHtcbiAgICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgICBcIlRoaXMgcGhvbmUgbnVtYmVyIGFscmVhZHkgdXNpbmdcIixcbiAgICAgICAgICAgIDQwMCxcbiAgICAgICAgICAgIFwicGhvbmVOdW1iZXJBbHJlYWR5VXNpbmdcIlxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgY29uc3QgdXBkYXRlVXNlciA9IGF3YWl0IFVzZXJzLmZpbmRCeUlkQW5kVXBkYXRlKFxuICAgICAgICB1c2VyLFxuICAgICAgICB7IHBob25lTnVtYmVyLCBhZGRyZXNzLCBjaXR5IH0sXG4gICAgICAgIHsgbmV3OiB0cnVlIH1cbiAgICAgICk7XG4gICAgICBub3RGb3VuZFZhcmlhYmxlKHVwZGF0ZVVzZXIsIFwiVXNlclwiKTtcblxuICAgICAgcmV0dXJuIHJlc1xuICAgICAgICAuc3RhdHVzKDIwMClcbiAgICAgICAgLmpzb24oeyBtZXNzYWdlOiBcInVzZXIgaW5mb3JtYXRpb24gaGFzIGJlZW4gY2hhbmdlZFwiLCB1c2VyIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgIFwiVXNlciBpbmZvcm1hdGlvbnMgY2Fubm90IGNoYW5nZVwiLFxuICAgICAgICA1MDAsXG4gICAgICAgIFwiY2Fubm90Q2hhbmdlVXNlckluZm9ybWF0aW9uXCJcbiAgICAgICk7XG4gICAgfVxuICB9KTtcblxuICByb3V0ZXIucHV0KFwiL3VzZXIvY2hhbmdlLXBhc3N3b3JkXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGNvbnN0IHsgb2xkUGFzc3dvcmQsIG5ld1Bhc3N3b3JkLCBjb25maXJtUGFzc3dvcmQgfSA9IHJlcS5ib2R5O1xuICAgIGNvbnN0IHVzZXIgPSByZXEudXNlcjtcbiAgICB0cnkge1xuICAgICAgY29uc3QgZXhpc3RpbmdVc2VyID0gYXdhaXQgVXNlcnMuZmluZEJ5SWQodXNlci5faWQpO1xuICAgICAgaWYgKCFleGlzdGluZ1VzZXIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiVXNlciBOb3QgRm91bmRcIiwgNDA0LCBcIm5vdEZvdW5kVXNlclwiKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgaXNNYXRjaFBhc3N3b3JkID0gYXdhaXQgYmNyeXB0LmNvbXBhcmUoXG4gICAgICAgIG9sZFBhc3N3b3JkLFxuICAgICAgICBleGlzdGluZ1VzZXIucGFzc3dvcmRcbiAgICAgICk7XG4gICAgICBpZiAoIWlzTWF0Y2hQYXNzd29yZCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgXCJJbmNvcnJlY3Qgb2xkIHBhc3N3b3JkXCIsXG4gICAgICAgICAgNDA0LFxuICAgICAgICAgIFwiaW5jb3JyZWN0T2xkUGFzc3dvcmRcIlxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICBpZiAobmV3UGFzc3dvcmQgIT09IGNvbmZpcm1QYXNzd29yZCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgXCJOZXcgcGFzc3dvcmQgYW5kIGNvbmZpcm0gcGFzc3dvcmQgZG8gbm90IG1hdGNoXCIsXG4gICAgICAgICAgNDA0LFxuICAgICAgICAgIFwicGFzc3dvcmRzRG9Ob3RNYXRjaFwiXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGlzU2FtZVBhc3N3b3JkID0gYXdhaXQgYmNyeXB0LmNvbXBhcmUoXG4gICAgICAgIG5ld1Bhc3N3b3JkLFxuICAgICAgICBleGlzdGluZ1VzZXIucGFzc3dvcmRcbiAgICAgICk7XG4gICAgICBpZiAoaXNTYW1lUGFzc3dvcmQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIFwiTmV3IFBhc3N3b3JkIGNhbm5vdCBiZSB0aGUgc2FtZSBhcyB0aGUgb2xkIHBhc3N3b3JkXCIsXG4gICAgICAgICAgNDAwLFxuICAgICAgICAgIFwic2FtZUFzT2xkUGFzc3dvcmRcIlxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICBleGlzdGluZ1VzZXIucGFzc3dvcmQgPSBuZXdQYXNzd29yZDtcbiAgICAgIGF3YWl0IGV4aXN0aW5nVXNlci5zYXZlKCk7XG4gICAgICBjb25zb2xlLmxvZyhcIk9sZCBQYXNzd29yZCAodW5oYXNoZWQpOlwiLCBvbGRQYXNzd29yZCk7XG4gICAgICBjb25zb2xlLmxvZyhcIk5ldyBQYXNzd29yZCAodW5oYXNoZWQpOlwiLCBuZXdQYXNzd29yZCk7XG5cbiAgICAgIHJldHVybiByZXNcbiAgICAgICAgLnN0YXR1cygyMDApXG4gICAgICAgIC5qc29uKHsgbWVzc2FnZTogXCJQYXNzd29yZCBoYXMgYmVlbiBjaGFuZ2VkIHN1Y2Nlc3NmdWxseVwiLCB1c2VyIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICByZXMuc3RhdHVzKGVycm9yLnN0YXR1c0NvZGUgfHwgNTAwKS5qc29uKHtcbiAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSB8fCBcIlBhc3N3b3JkIGNoYW5nZSBmYWlsZWRcIixcbiAgICAgICAgY29kZTogZXJyb3IuY29kZSB8fCBcInBhc3N3b3JkQ2hhbmdlRmFpbGVkXCIsXG4gICAgICB9KTtcbiAgICB9XG4gIH0pO1xuXG4gIHJvdXRlci5wb3N0KFwiL2ZvcmdvdC1wYXNzd29yZFwiLCBmb3Jnb3RQYXNzd29yZEVtYWlsLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICBjb25zdCB7IGVtYWlsIH0gPSByZXEuYm9keTtcbiAgICBjb25zdCB1c2VyRW1haWwgPSBhd2FpdCBVc2Vycy5maW5kT25lKHsgZW1haWwgfSk7XG4gICAgbm9FeGlzdFZhcmlhYmxlKHVzZXJFbWFpbCwgXCJFbWFpbFwiKTtcblxuICAgIHJlcy5zdGF0dXMoMjAwKS5zZW5kKFwiTGluayBoYXMgYmVlbiBzZW5kXCIpO1xuICB9KTtcblxuICByb3V0ZXIuZ2V0KFwiL3VzZXIvb3JkZXJzLzpjYXJ0SWRcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyBjYXJ0SWQgfSA9IHJlcS5wYXJhbXM7XG4gICAgY29uc3QgdXNlcklkID0gcmVxLnVzZXIuX2lkO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB1c2VyT3JkZXJzID0gYXdhaXQgQ2FydC5maW5kT25lKHtcbiAgICAgICAgX2lkOiBjYXJ0SWQsXG4gICAgICAgIGNvbXBsZXRlZDogdHJ1ZSxcbiAgICAgICAgYnV5ZXI6IHVzZXJJZCxcbiAgICAgIH0pXG4gICAgICAgIC5wb3B1bGF0ZShcInByb2R1Y3RzLnByb2R1Y3RJZFwiLCBcIm5hbWUgcHJpY2UgaW1hZ2VzIGNhdGVnb3JpZXNcIilcbiAgICAgICAgLnBvcHVsYXRlKFwicHJvZHVjdHMuc2VsbGVyXCIsIFwiU2VsbGVyTmFtZVwiKTtcbiAgICAgIGlmICghdXNlck9yZGVycykge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgXCJDYXJ0IG5vdCBmb3VuZCBvciBub3QgY29tcGxldGVkXCIsXG4gICAgICAgICAgNDA0LFxuICAgICAgICAgIFwiY2FydE5vdEZvdW5kXCJcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24odXNlck9yZGVycyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgXCJDb3VsZCBub3QgZ2V0IGNhcnQgb3JkZXJzXCIsXG4gICAgICAgIDQwMCxcbiAgICAgICAgXCJnZXRDYXJ0T3JkZXJGYWlsZWRcIlxuICAgICAgKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJvdXRlci5nZXQoXCIvdXNlci9vcmRlcnNcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHVzZXJPcmRlcnMgPSBhd2FpdCBDYXJ0LmZpbmQoe1xuICAgICAgICBidXllcjogcmVxLnVzZXIuX2lkLFxuICAgICAgICBjb21wbGV0ZWQ6IHRydWUsXG4gICAgICB9KVxuICAgICAgICAucG9wdWxhdGUoXCJwcm9kdWN0cy5wcm9kdWN0SWRcIiwgXCJuYW1lIHByaWNlIGltYWdlcyBjYXRlZ29yaWVzXCIpXG4gICAgICAgIC5wb3B1bGF0ZShcInByb2R1Y3RzLnNlbGxlclwiLCBcIlNlbGxlck5hbWVcIik7XG5cbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHVzZXJPcmRlcnMpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDb3VsZCBub3QgZ2V0IG9yZGVyc1wiLCA0MDAsIFwiZ2V0T3JkZXJGYWlsZWRcIik7XG4gICAgfVxuICB9KTtcblxuICAvLyByb3V0ZXIuZ2V0KFwiL3VzZXIvb3JkZXJzXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAvLyAgIGNvbnN0IHVzZXJJZCA9IHJlcS51c2VyLl9pZDtcbiAgLy8gICB0cnkge1xuICAvLyAgICAgLy8gY29uc3QgY2FydCA9IGF3YWl0IENhcnQuZmluZCh7IGJ1eWVyOiByZXEudXNlci5faWQsIGNvbXBsZXRlZDogdHJ1ZSB9KTtcbiAgLy8gICAgIGNvbnN0IHBheW1lbnRTdWNjZXNzID0gYXdhaXQgUGF5bWVudFN1Y2Nlc3MuZmluZCh7XG4gIC8vICAgICAgIHN0YXR1czogXCJzdWNjZXNzXCIsXG4gIC8vICAgICB9KVxuICAvLyAgICAgICAuc2VsZWN0KFwicHJpY2UgcGF5bWVudElkIGNyZWF0ZWRBdFwiKVxuICAvLyAgICAgICAucG9wdWxhdGUoeyBwYXRoOiBcImNhcnRJZFwiLCBzZWxlY3Q6IFwiYnV5ZXJcIiB9KTtcblxuICAvLyAgICAgLy8gR2lyacWfIHlhcGFuIGt1bGxhbsSxY8SxeWEgYWl0IG9sYW4gw7ZkZW1lbGVyaSBmaWx0cmVsaXlvcnV6XG4gIC8vICAgICBjb25zdCB1c2VyUGF5bWVudHMgPSBwYXltZW50U3VjY2Vzcy5maWx0ZXIoKHBheW1lbnQpID0+IHtcbiAgLy8gICAgICAgLy8gUG9wdWxhdGUgZWRpbG1pxZ8gY2FydElkIGnDp2VyaXNpbmRlbiBidXllciBrb250cm9sw7wgeWFwxLF5b3J1elxuICAvLyAgICAgICByZXR1cm4gU3RyaW5nKHBheW1lbnQuY2FydElkLmJ1eWVyKSA9PT0gU3RyaW5nKHVzZXJJZCk7XG4gIC8vICAgICB9KTtcblxuICAvLyAgICAgaWYgKHVzZXJQYXltZW50cy5sZW5ndGggPT09IDApIHtcbiAgLy8gICAgICAgcmV0dXJuIHJlc1xuICAvLyAgICAgICAgIC5zdGF0dXMoNDA0KVxuICAvLyAgICAgICAgIC5qc29uKHsgbWVzc2FnZTogXCJObyBwYXltZW50cyBmb3VuZCBmb3IgdGhpcyB1c2VyXCIgfSk7XG4gIC8vICAgICB9XG5cbiAgLy8gICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgdXNlclBheW1lbnRzIH0pO1xuICAvLyAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gIC8vICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gIC8vICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDb3VsZCBub3QgZ2V0IG9yZGVyc1wiLCA0MDAsIFwiZ2V0T3JkZXJGYWlsZWRcIik7XG4gIC8vICAgfVxuICAvLyB9KTtcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLGFBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLEtBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFHLE1BQUEsR0FBQUosc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFJLFNBQUEsR0FBQUwsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFLLGVBQUEsR0FBQUwsT0FBQTtBQUNBLElBQUFNLGNBQUEsR0FBQU4sT0FBQTtBQUlBLElBQUFPLG1CQUFBLEdBQUFQLE9BQUE7QUFDQSxJQUFBUSxRQUFBLEdBQUFULHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBUyxrQkFBQSxHQUFBVixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQVUsVUFBQSxHQUFBWCxzQkFBQSxDQUFBQyxPQUFBO0FBQWlELFNBQUFELHVCQUFBWSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBQUEsSUFBQUcsUUFBQSxHQUVqQ0MsTUFBTSxJQUFLO0VBQ3pCQSxNQUFNLENBQUNDLElBQUksQ0FDVCxXQUFXLEVBQ1hDLGtCQUFTLEVBQ1QsT0FBT0MsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksS0FBSztJQUN4QixNQUFNO01BQ0pDLEtBQUs7TUFDTEMsSUFBSTtNQUNKQyxPQUFPO01BQ1BDLFdBQVc7TUFDWEMsY0FBYztNQUNkQyxRQUFRO01BQ1JDLE9BQU87TUFDUEMsSUFBSTtNQUNKQyxPQUFPO01BQ1BDO0lBQ0YsQ0FBQyxHQUFHWixHQUFHLENBQUNhLElBQUk7SUFFWixJQUFJO01BQ0YsSUFBQUMsdUNBQXdC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","map":{"version":3,"names":["_bcryptjs","_interopRequireDefault","require","_jsonwebtoken","_cart","_users","_ApiError","_CheckExistence","_RequiredCheck","_ForgotPasswordMail","_Session","_VerificationEmail","_getUserIP","e","__esModule","default","_default","router","post","getUserIp","req","res","next","email","name","surname","phoneNumber","identityNumber","password","address","city","country","zipCode","body","checkLotsOfRequiredField","field","fieldName","error","status","send","existingUser","Users","findOne","ApiError","user","ip","userIp","save","console","log","sendVerificationEmail","json","get","token","query","checkRequiredField","decoded","jwt","verify","process","env","JWT_SECRET","findById","id","notFoundVariable","isVerified","sendFile","root","passwordConfirmed","bcrypt","compare","userJson","toJSON","sign","put","Session","_id","toString","updateUser","findByIdAndUpdate","new","message","oldPassword","newPassword","confirmPassword","isMatchPassword","isSamePassword","statusCode","code","forgotPasswordEmail","userEmail","noExistVariable","cartId","params","userId","userOrders","Cart","completed","buyer","populate","find","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["Users.js"],"sourcesContent":["import bcrypt from \"bcryptjs\";\nimport jwt from \"jsonwebtoken\";\nimport Cart from \"../db/cart\";\nimport Users from \"../db/users\";\nimport ApiError from \"../errors/ApiError\";\nimport { noExistVariable, notFoundVariable } from \"../helpers/CheckExistence\";\nimport {\n  checkLotsOfRequiredField,\n  checkRequiredField,\n} from \"../helpers/RequiredCheck\";\nimport { forgotPasswordEmail } from \"../middlewares/ForgotPasswordMail\";\nimport Session from \"../middlewares/Session\";\nimport sendVerificationEmail from \"../middlewares/VerificationEmail\";\nimport getUserIp from \"../middlewares/getUserIP\";\n\nexport default (router) => {\n  router.post(\n    \"/register\",\n    getUserIp,\n    async (req, res, next) => {\n      const {\n        email,\n        name,\n        surname,\n        phoneNumber,\n        identityNumber,\n        password,\n        address,\n        city,\n        country,\n        zipCode,\n      } = req.body;\n\n      try {\n        checkLotsOfRequiredField([\n          { field: email, fieldName: \"E-Mail\" },\n          { field: name, fieldName: \"Name\" },\n          { field: surname, fieldName: \"Surname\" },\n          { field: phoneNumber, fieldName: \"Phone Number\" },\n          { field: address, fieldName: \"Address\" },\n          { field: city, fieldName: \"City\" },\n          { field: country, fieldName: \"Country\" },\n          { field: zipCode, fieldName: \"Zip Code\" },\n          { field: identityNumber, fieldName: \"İdentity Number\" },\n        ]);\n      } catch (error) {\n        return res.status(400).send(error);\n      }\n\n      const existingUser = await Users.findOne({ email });\n      if (existingUser) {\n        return res\n          .status(400)\n          .send(new ApiError(400, \"Bu e-posta zaten kullanılıyor\"));\n      }\n\n      const user = new Users({\n        email,\n        name,\n        surname,\n        phoneNumber,\n        identityNumber,\n        password,\n        address,\n        city,\n        country,\n        zipCode,\n        ip: req.userIp, // Kullanıcı IP'sini ekle\n      });\n\n      try {\n        await user.save();\n        req.user = user;\n        next();\n        // return res\n        //   .status(200)\n        //   .json(`${email} mail adresi ile kullanıcı oluşturuldu.`);\n      } catch (error) {\n        console.log(error);\n        return res\n          .status(500)\n          .send(new ApiError(500, \"Kayıt işlemi sırasında hata oluştu\"));\n      }\n    },\n    sendVerificationEmail, //silinebilir çalışmazsa\n    (req, res) => {\n      return res.status(200).json(\n        `${req.user.email} mail adresi ile kullanıcı oluşturuldu. Lütfen E-postanızı doğrulayınız.` //middlewaredeki üretilen jwtyi konsola yazdır\n      );\n    }\n  );\n\n  router.get(\"/verify-email/\", async (req, res) => {\n    const { token } = req.query;\n\n    try {\n      checkRequiredField(token, \"Token\");\n    } catch (error) {\n      return res.status(400).json(error);\n    }\n\n    try {\n      const decoded = jwt.verify(token, process.env.JWT_SECRET);\n      const user = await Users.findById(decoded.id);\n\n      notFoundVariable(user, \"User\");\n\n      if (user.isVerified) {\n        return res\n          .status(400)\n          .send(new ApiError(400, \"Kullanıcı zaten doğrulanmış\"));\n      }\n\n      user.isVerified = true;\n      await user.save();\n\n      return res.sendFile(\"verification-success.html\", { root: \"public\" });\n    } catch (error) {\n      console.log(error);\n      return res\n        .status(500)\n        .send(new ApiError(500, \"Doğrulama işlemi sırasında hata oluştu\"));\n    }\n  });\n\n  router.post(\"/login\", async (req, res) => {\n    const { email, password } = req.body;\n    const user = await Users.findOne({ email });\n\n    try {\n      checkLotsOfRequiredField([\n        { field: email, fieldName: \"E-Mail\" },\n        { field: password, fieldName: \"Password\" },\n      ]);\n    } catch (error) {\n      return res.status(400).json(error);\n    }\n\n    if (!user) {\n      throw new ApiError(\n        \"Incorrect Password or email\",\n        401,\n        \"userOrPasswordIncorrect\"\n      );\n    }\n    if (user.isVerified == false) {\n      throw new ApiError(\n        \"You have to verificate your account.\",\n        401,\n        \"accountNotVerified\"\n      );\n    }\n    const passwordConfirmed = await bcrypt.compare(password, user.password);\n    // console.log(\"kullanıcı girdisi:\", password); silinecekler\n    // console.log(\"hashlenmiş hali:\", user.password);\n\n    if (passwordConfirmed) {\n      const userJson = user.toJSON();\n      const token = jwt.sign(userJson, process.env.JWT_SECRET);\n      res.json({\n        token: `Bearer ${token}`,\n        user: userJson,\n      });\n    } else {\n      throw new ApiError(\n        \"Incorrect Password or email\",\n        401,\n        \"userOrPasswordIncorrect\"\n      );\n    }\n  });\n\n  router.put(\"/user/update\", Session, async (req, res) => {\n    const { phoneNumber, address, city } = req.body;\n    const user = req.user;\n\n    try {\n      if (phoneNumber) {\n        const existingUser = await Users.findOne({ phoneNumber });\n        if (\n          existingUser &&\n          existingUser._id.toString() !== user._id.toString()\n        ) {\n          throw new ApiError(\n            \"This phone number already using\",\n            400,\n            \"phoneNumberAlreadyUsing\"\n          );\n        }\n      }\n\n      const updateUser = await Users.findByIdAndUpdate(\n        user,\n        { phoneNumber, address, city },\n        { new: true }\n      );\n      notFoundVariable(updateUser, \"User\");\n\n      return res\n        .status(200)\n        .json({ message: \"user information has been changed\", user });\n    } catch (error) {\n      console.log(error);\n      throw new ApiError(\n        \"User informations cannot change\",\n        500,\n        \"cannotChangeUserInformation\"\n      );\n    }\n  });\n\n  router.put(\"/user/change-password\", Session, async (req, res) => {\n    const { oldPassword, newPassword, confirmPassword } = req.body;\n    const user = req.user;\n    try {\n      const existingUser = await Users.findById(user._id);\n      if (!existingUser) {\n        throw new ApiError(\"User Not Found\", 404, \"notFoundUser\");\n      }\n\n      const isMatchPassword = await bcrypt.compare(\n        oldPassword,\n        existingUser.password\n      );\n      if (!isMatchPassword) {\n        throw new ApiError(\n          \"Incorrect old password\",\n          404,\n          \"incorrectOldPassword\"\n        );\n      }\n\n      if (newPassword !== confirmPassword) {\n        throw new ApiError(\n          \"New password and confirm password do not match\",\n          404,\n          \"passwordsDoNotMatch\"\n        );\n      }\n\n      const isSamePassword = await bcrypt.compare(\n        newPassword,\n        existingUser.password\n      );\n      if (isSamePassword) {\n        throw new ApiError(\n          \"New Password cannot be the same as the old password\",\n          400,\n          \"sameAsOldPassword\"\n        );\n      }\n\n      existingUser.password = newPassword;\n      await existingUser.save();\n      console.log(\"Old Password (unhashed):\", oldPassword);\n      console.log(\"New Password (unhashed):\", newPassword);\n\n      return res\n        .status(200)\n        .json({ message: \"Password has been changed successfully\", user });\n    } catch (error) {\n      console.log(error);\n      res.status(error.statusCode || 500).json({\n        message: error.message || \"Password change failed\",\n        code: error.code || \"passwordChangeFailed\",\n      });\n    }\n  });\n\n  router.post(\"/forgot-password\", forgotPasswordEmail, async (req, res) => {\n    const { email } = req.body;\n    const userEmail = await Users.findOne({ email });\n    noExistVariable(userEmail, \"Email\");\n\n    res.status(200).send(\"Link has been send\");\n  });\n\n  router.get(\"/user/orders/:cartId\", Session, async (req, res) => {\n    const { cartId } = req.params;\n    const userId = req.user._id;\n    try {\n      const userOrders = await Cart.findOne({\n        _id: cartId,\n        completed: true,\n        buyer: userId,\n      })\n        .populate(\"products.productId\", \"name price images categories\")\n        .populate(\"products.seller\", \"SellerName\");\n      if (!userOrders) {\n        throw new ApiError(\n          \"Cart not found or not completed\",\n          404,\n          \"cartNotFound\"\n        );\n      }\n\n      res.status(200).json(userOrders);\n    } catch (error) {\n      console.log(error);\n      throw new ApiError(\n        \"Could not get cart orders\",\n        400,\n        \"getCartOrderFailed\"\n      );\n    }\n  });\n\n  router.get(\"/user/orders\", Session, async (req, res) => {\n    try {\n      const userOrders = await Cart.find({\n        buyer: req.user._id,\n        completed: true,\n      })\n        .populate(\"products.productId\", \"name price images categories\")\n        .populate(\"products.seller\", \"SellerName\");\n\n      res.status(200).json(userOrders);\n    } catch (error) {\n      console.log(error);\n      throw new ApiError(\"Could not get orders\", 400, \"getOrderFailed\");\n    }\n  });\n\n  // router.get(\"/user/orders\", Session, async (req, res) => {\n  //   const userId = req.user._id;\n  //   try {\n  //     // const cart = await Cart.find({ buyer: req.user._id, completed: true });\n  //     const paymentSuccess = await PaymentSuccess.find({\n  //       status: \"success\",\n  //     })\n  //       .select(\"price paymentId createdAt\")\n  //       .populate({ path: \"cartId\", select: \"buyer\" });\n\n  //     // Giriş yapan kullanıcıya ait olan ödemeleri filtreliyoruz\n  //     const userPayments = paymentSuccess.filter((payment) => {\n  //       // Populate edilmiş cartId içerisinden buyer kontrolü yapıyoruz\n  //       return String(payment.cartId.buyer) === String(userId);\n  //     });\n\n  //     if (userPayments.length === 0) {\n  //       return res\n  //         .status(404)\n  //         .json({ message: \"No payments found for this user\" });\n  //     }\n\n  //     res.status(200).json({ userPayments });\n  //   } catch (error) {\n  //     console.log(error);\n  //     throw new ApiError(\"Could not get orders\", 400, \"getOrderFailed\");\n  //   }\n  // });\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1734362474606},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/users.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst randomColorGenerator = () => {\n  return Math.floor(Math.random() * 16777215).toString(16);\n};\nconst UserSchema = new Schema({\n  uuid: {\n    type: String,\n    default: () => (0, _uuid.default)(),\n    unique: true,\n    required: true\n  },\n  locale: {\n    type: String,\n    required: true,\n    default: \"tr\",\n    enum: [\"tr\", \"en\"]\n  },\n  role: {\n    type: String,\n    required: true,\n    default: \"user\",\n    enum: [\"user\", \"admin\"]\n  },\n  name: {\n    type: String,\n    required: true\n  },\n  surname: {\n    type: String,\n    required: true\n  },\n  email: {\n    type: String,\n    required: true,\n    unique: true\n  },\n  phoneNumber: {\n    type: String,\n    required: true,\n    unique: true\n  },\n  identityNumber: {\n    type: String,\n    minlength: 11,\n    maxlength: 11,\n    required: true\n    // default: \"00000000000\",\n  },\n  password: {\n    type: String,\n    required: true\n  },\n  avatarColor: {\n    type: String,\n    default: randomColorGenerator(),\n    required: true\n  },\n  address: {\n    //fatura ve sipariş adresi diye ikiye ayrılabilir\n    type: String,\n    required: true\n  },\n  city: {\n    type: String,\n    required: true\n  },\n  country: {\n    type: String,\n    required: true,\n    default: \"Turkey\"\n  },\n  zipCode: {\n    type: String,\n    required: true\n  },\n  ip: {\n    type: String,\n    required: true\n    //default: \"85.34.78.112\", //cihazın ip'sini alır\n  },\n  isVerified: {\n    type: Boolean,\n    default: false\n  },\n  cardUserKey: {\n    type: String,\n    required: false,\n    unique: true\n  }\n}, {\n  _id: true,\n  collection: \"users\",\n  timestamps: true,\n  toJSON: {\n    transform: (doc, ret) => {\n      delete ret.__v;\n      delete ret.password;\n      return {\n        ...ret\n      };\n    }\n  }\n});\nUserSchema.pre(\"save\", async function (next) {\n  try {\n    if (!this.phoneNumber.startsWith(\"+90\")) {\n      this.phoneNumber = `+90${this.phoneNumber}`;\n    }\n    if (this.isModified(\"password\")) {\n      this.password = await _bcryptjs.default.hash(this.password, 10);\n    }\n    return next();\n  } catch (err) {\n    return next(err);\n  }\n  next();\n});\nconst Users = _mongoose.default.model(\"Users\", UserSchema);\nvar _default = exports.default = Users;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYmNyeXB0anMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9tb25nb29zZSIsIl91dWlkIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiU2NoZW1hIiwibW9uZ29vc2UiLCJPYmplY3RJZCIsIlR5cGVzIiwicmFuZG9tQ29sb3JHZW5lcmF0b3IiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJ0b1N0cmluZyIsIlVzZXJTY2hlbWEiLCJ1dWlkIiwidHlwZSIsIlN0cmluZyIsImdlbmVyYXRlZElkIiwidW5pcXVlIiwicmVxdWlyZWQiLCJsb2NhbGUiLCJlbnVtIiwicm9sZSIsIm5hbWUiLCJzdXJuYW1lIiwiZW1haWwiLCJwaG9uZU51bWJlciIsImlkZW50aXR5TnVtYmVyIiwibWlubGVuZ3RoIiwibWF4bGVuZ3RoIiwicGFzc3dvcmQiLCJhdmF0YXJDb2xvciIsImFkZHJlc3MiLCJjaXR5IiwiY291bnRyeSIsInppcENvZGUiLCJpcCIsImlzVmVyaWZpZWQiLCJCb29sZWFuIiwiY2FyZFVzZXJLZXkiLCJfaWQiLCJjb2xsZWN0aW9uIiwidGltZXN0YW1wcyIsInRvSlNPTiIsInRyYW5zZm9ybSIsImRvYyIsInJldCIsIl9fdiIsInByZSIsIm5leHQiLCJzdGFydHNXaXRoIiwiaXNNb2RpZmllZCIsImJjcnlwdCIsImhhc2giLCJlcnIiLCJVc2VycyIsIm1vZGVsIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvZGIvIiwic291cmNlcyI6WyJ1c2Vycy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgYmNyeXB0IGZyb20gXCJiY3J5cHRqc1wiO1xuaW1wb3J0IG1vbmdvb3NlIGZyb20gXCJtb25nb29zZVwiO1xuaW1wb3J0IGdlbmVyYXRlZElkIGZyb20gXCIuLi91dGlscy91dWlkXCI7XG5cbmNvbnN0IFNjaGVtYSA9IG1vbmdvb3NlLlNjaGVtYTtcbmNvbnN0IHsgT2JqZWN0SWQgfSA9IFNjaGVtYS5UeXBlcztcbmNvbnN0IHJhbmRvbUNvbG9yR2VuZXJhdG9yID0gKCkgPT4ge1xuICByZXR1cm4gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTY3NzcyMTUpLnRvU3RyaW5nKDE2KTtcbn07XG5cbmNvbnN0IFVzZXJTY2hlbWEgPSBuZXcgU2NoZW1hKFxuICB7XG4gICAgdXVpZDoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgZGVmYXVsdDogKCkgPT4gZ2VuZXJhdGVkSWQoKSxcbiAgICAgIHVuaXF1ZTogdHJ1ZSxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgbG9jYWxlOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIGRlZmF1bHQ6IFwidHJcIixcbiAgICAgIGVudW06IFtcInRyXCIsIFwiZW5cIl0sXG4gICAgfSxcbiAgICByb2xlOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIGRlZmF1bHQ6IFwidXNlclwiLFxuICAgICAgZW51bTogW1widXNlclwiLCBcImFkbWluXCJdLFxuICAgIH0sXG4gICAgbmFtZToge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBzdXJuYW1lOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGVtYWlsOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIHVuaXF1ZTogdHJ1ZSxcbiAgICB9LFxuICAgIHBob25lTnVtYmVyOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIHVuaXF1ZTogdHJ1ZSxcbiAgICB9LFxuICAgIGlkZW50aXR5TnVtYmVyOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICBtaW5sZW5ndGg6IDExLFxuICAgICAgbWF4bGVuZ3RoOiAxMSxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgLy8gZGVmYXVsdDogXCIwMDAwMDAwMDAwMFwiLFxuICAgIH0sXG4gICAgcGFzc3dvcmQ6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgYXZhdGFyQ29sb3I6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIGRlZmF1bHQ6IHJhbmRvbUNvbG9yR2VuZXJhdG9yKCksXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGFkZHJlc3M6IHtcbiAgICAgIC8vZmF0dXJhIHZlIHNpcGFyacWfIGFkcmVzaSBkaXllIGlraXllIGF5csSxbGFiaWxpclxuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBjaXR5OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGNvdW50cnk6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgZGVmYXVsdDogXCJUdXJrZXlcIixcbiAgICB9LFxuICAgIHppcENvZGU6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgaXA6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgLy9kZWZhdWx0OiBcIjg1LjM0Ljc4LjExMlwiLCAvL2NpaGF6xLFuIGlwJ3NpbmkgYWzEsXJcbiAgICB9LFxuICAgIGlzVmVyaWZpZWQ6IHtcbiAgICAgIHR5cGU6IEJvb2xlYW4sXG4gICAgICBkZWZhdWx0OiBmYWxzZSxcbiAgICB9LFxuICAgIGNhcmRVc2VyS2V5OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICB1bmlxdWU6IHRydWUsXG4gICAgfSxcbiAgfSxcbiAge1xuICAgIF9pZDogdHJ1ZSxcbiAgICBjb2xsZWN0aW9uOiBcInVzZXJzXCIsXG4gICAgdGltZXN0YW1wczogdHJ1ZSxcbiAgICB0b0pTT046IHtcbiAgICAgIHRyYW5zZm9ybTogKGRvYywgcmV0KSA9PiB7XG4gICAgICAgIGRlbGV0ZSByZXQuX192O1xuICAgICAgICBkZWxldGUgcmV0LnBhc3N3b3JkO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLnJldCxcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgfSxcbiAgfVxuKTtcblxuVXNlclNjaGVtYS5wcmUoXCJzYXZlXCIsIGFzeW5jIGZ1bmN0aW9uIChuZXh0KSB7XG4gIHRyeSB7XG4gICAgaWYgKCF0aGlzLnBob25lTnVtYmVyLnN0YXJ0c1dpdGgoXCIrOTBcIikpIHtcbiAgICAgIHRoaXMucGhvbmVOdW1iZXIgPSBgKzkwJHt0aGlzLnBob25lTnVtYmVyfWA7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaXNNb2RpZmllZChcInBhc3N3b3JkXCIpKSB7XG4gICAgICB0aGlzLnBhc3N3b3JkID0gYXdhaXQgYmNyeXB0Lmhhc2godGhpcy5wYXNzd29yZCwgMTApO1xuICAgIH1cbiAgICByZXR1cm4gbmV4dCgpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICByZXR1cm4gbmV4dChlcnIpO1xuICB9XG4gIG5leHQoKTtcbn0pO1xuY29uc3QgVXNlcnMgPSBtb25nb29zZS5tb2RlbChcIlVzZXJzXCIsIFVzZXJTY2hlbWEpO1xuXG5leHBvcnQgZGVmYXVsdCBVc2VycztcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsU0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsU0FBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsS0FBQSxHQUFBSCxz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","map":{"version":3,"names":["_bcryptjs","_interopRequireDefault","require","_mongoose","_uuid","e","__esModule","default","Schema","mongoose","ObjectId","Types","randomColorGenerator","Math","floor","random","toString","UserSchema","uuid","type","String","generatedId","unique","required","locale","enum","role","name","surname","email","phoneNumber","identityNumber","minlength","maxlength","password","avatarColor","address","city","country","zipCode","ip","isVerified","Boolean","cardUserKey","_id","collection","timestamps","toJSON","transform","doc","ret","__v","pre","next","startsWith","isModified","bcrypt","hash","err","Users","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["users.js"],"sourcesContent":["import bcrypt from \"bcryptjs\";\nimport mongoose from \"mongoose\";\nimport generatedId from \"../utils/uuid\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\nconst randomColorGenerator = () => {\n  return Math.floor(Math.random() * 16777215).toString(16);\n};\n\nconst UserSchema = new Schema(\n  {\n    uuid: {\n      type: String,\n      default: () => generatedId(),\n      unique: true,\n      required: true,\n    },\n    locale: {\n      type: String,\n      required: true,\n      default: \"tr\",\n      enum: [\"tr\", \"en\"],\n    },\n    role: {\n      type: String,\n      required: true,\n      default: \"user\",\n      enum: [\"user\", \"admin\"],\n    },\n    name: {\n      type: String,\n      required: true,\n    },\n    surname: {\n      type: String,\n      required: true,\n    },\n    email: {\n      type: String,\n      required: true,\n      unique: true,\n    },\n    phoneNumber: {\n      type: String,\n      required: true,\n      unique: true,\n    },\n    identityNumber: {\n      type: String,\n      minlength: 11,\n      maxlength: 11,\n      required: true,\n      // default: \"00000000000\",\n    },\n    password: {\n      type: String,\n      required: true,\n    },\n    avatarColor: {\n      type: String,\n      default: randomColorGenerator(),\n      required: true,\n    },\n    address: {\n      //fatura ve sipariş adresi diye ikiye ayrılabilir\n      type: String,\n      required: true,\n    },\n    city: {\n      type: String,\n      required: true,\n    },\n    country: {\n      type: String,\n      required: true,\n      default: \"Turkey\",\n    },\n    zipCode: {\n      type: String,\n      required: true,\n    },\n    ip: {\n      type: String,\n      required: true,\n      //default: \"85.34.78.112\", //cihazın ip'sini alır\n    },\n    isVerified: {\n      type: Boolean,\n      default: false,\n    },\n    cardUserKey: {\n      type: String,\n      required: false,\n      unique: true,\n    },\n  },\n  {\n    _id: true,\n    collection: \"users\",\n    timestamps: true,\n    toJSON: {\n      transform: (doc, ret) => {\n        delete ret.__v;\n        delete ret.password;\n        return {\n          ...ret,\n        };\n      },\n    },\n  }\n);\n\nUserSchema.pre(\"save\", async function (next) {\n  try {\n    if (!this.phoneNumber.startsWith(\"+90\")) {\n      this.phoneNumber = `+90${this.phoneNumber}`;\n    }\n\n    if (this.isModified(\"password\")) {\n      this.password = await bcrypt.hash(this.password, 10);\n    }\n    return next();\n  } catch (err) {\n    return next(err);\n  }\n  next();\n});\nconst Users = mongoose.model(\"Users\", UserSchema);\n\nexport default Users;\n"],"mappings":"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","ignoreList":[]}},"mtime":1734266012272},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/utils/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/utils/uuid.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _uuid = require(\"uuid\");\n//burada modellerdeki uuid verisini dolduracak id üretilir(iyzipay için gerekli)\nconst id = () => (0, _uuid.v4)();\nvar _default = exports.default = id;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfdXVpZCIsInJlcXVpcmUiLCJpZCIsInV1aWR2NCIsIl9kZWZhdWx0IiwiZXhwb3J0cyIsImRlZmF1bHQiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy91dGlscy8iLCJzb3VyY2VzIjpbInV1aWQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgdjQgYXMgdXVpZHY0IH0gZnJvbSBcInV1aWRcIjtcbi8vYnVyYWRhIG1vZGVsbGVyZGVraSB1dWlkIHZlcmlzaW5pIGRvbGR1cmFjYWsgaWQgw7xyZXRpbGlyKGl5emlwYXkgacOnaW4gZ2VyZWtsaSlcbmNvbnN0IGlkID0gKCkgPT4gdXVpZHY0KCk7XG5cbmV4cG9ydCBkZWZhdWx0IGlkO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxLQUFBLEdBQUFDLE9BQUE7QUFDQTtBQUNBLE1BQU1DLEVBQUUsR0FBR0EsQ0FBQSxLQUFNLElBQUFDLFFBQU0sRUFBQyxDQUFDO0FBQUMsSUFBQUMsUUFBQSxHQUFBQyxPQUFBLENBQUFDLE9BQUEsR0FFWEosRUFBRSIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_uuid","require","id","uuidv4","_default","exports","default"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/utils/","sources":["uuid.js"],"sourcesContent":["import { v4 as uuidv4 } from \"uuid\";\n//burada modellerdeki uuid verisini dolduracak id üretilir(iyzipay için gerekli)\nconst id = () => uuidv4();\n\nexport default id;\n"],"mappings":";;;;;;AAAA,IAAAA,KAAA,GAAAC,OAAA;AACA;AACA,MAAMC,EAAE,GAAGA,CAAA,KAAM,IAAAC,QAAM,EAAC,CAAC;AAAC,IAAAC,QAAA,GAAAC,OAAA,CAAAC,OAAA,GAEXJ,EAAE","ignoreList":[]}},"mtime":1728075300218},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/getUserIP.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nconst getUserIp = async (req, res, next) => {\n  const ipAddress = req.ip || req.connection.remoteAddress || req.headers[\"x-forwarded-for\"];\n  req.userIp = ipAddress;\n  next();\n};\nvar _default = exports.default = getUserIp;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJnZXRVc2VySXAiLCJyZXEiLCJyZXMiLCJuZXh0IiwiaXBBZGRyZXNzIiwiaXAiLCJjb25uZWN0aW9uIiwicmVtb3RlQWRkcmVzcyIsImhlYWRlcnMiLCJ1c2VySXAiLCJfZGVmYXVsdCIsImV4cG9ydHMiLCJkZWZhdWx0Il0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvbWlkZGxld2FyZXMvIiwic291cmNlcyI6WyJnZXRVc2VySVAuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZ2V0VXNlcklwID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIGNvbnN0IGlwQWRkcmVzcyA9XG4gICAgcmVxLmlwIHx8IHJlcS5jb25uZWN0aW9uLnJlbW90ZUFkZHJlc3MgfHwgcmVxLmhlYWRlcnNbXCJ4LWZvcndhcmRlZC1mb3JcIl07XG4gIHJlcS51c2VySXAgPSBpcEFkZHJlc3M7XG4gIG5leHQoKTtcbn07XG5leHBvcnQgZGVmYXVsdCBnZXRVc2VySXA7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLE1BQU1BLFNBQVMsR0FBRyxNQUFBQSxDQUFPQyxHQUFHLEVBQUVDLEdBQUcsRUFBRUMsSUFBSSxLQUFLO0VBQzFDLE1BQU1DLFNBQVMsR0FDYkgsR0FBRyxDQUFDSSxFQUFFLElBQUlKLEdBQUcsQ0FBQ0ssVUFBVSxDQUFDQyxhQUFhLElBQUlOLEdBQUcsQ0FBQ08sT0FBTyxDQUFDLGlCQUFpQixDQUFDO0VBQzFFUCxHQUFHLENBQUNRLE1BQU0sR0FBR0wsU0FBUztFQUN0QkQsSUFBSSxDQUFDLENBQUM7QUFDUixDQUFDO0FBQUMsSUFBQU8sUUFBQSxHQUFBQyxPQUFBLENBQUFDLE9BQUEsR0FDYVosU0FBUyIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["getUserIp","req","res","next","ipAddress","ip","connection","remoteAddress","headers","userIp","_default","exports","default"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["getUserIP.js"],"sourcesContent":["const getUserIp = async (req, res, next) => {\n  const ipAddress =\n    req.ip || req.connection.remoteAddress || req.headers[\"x-forwarded-for\"];\n  req.userIp = ipAddress;\n  next();\n};\nexport default getUserIp;\n"],"mappings":";;;;;;AAAA,MAAMA,SAAS,GAAG,MAAAA,CAAOC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EAC1C,MAAMC,SAAS,GACbH,GAAG,CAACI,EAAE,IAAIJ,GAAG,CAACK,UAAU,CAACC,aAAa,IAAIN,GAAG,CAACO,OAAO,CAAC,iBAAiB,CAAC;EAC1EP,GAAG,CAACQ,MAAM,GAAGL,SAAS;EACtBD,IAAI,CAAC,CAAC;AACR,CAAC;AAAC,IAAAO,QAAA,GAAAC,OAAA,CAAAC,OAAA,GACaZ,SAAS","ignoreList":[]}},"mtime":1721312705757},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/getUserIP.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nconst getUserIp = async (req, res, next) => {\n  const ipAddress = req.ip || req.connection.remoteAddress || req.headers[\"x-forwarded-for\"];\n  req.userIp = ipAddress;\n  next();\n};\nvar _default = exports.default = getUserIp;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJnZXRVc2VySXAiLCJyZXEiLCJyZXMiLCJuZXh0IiwiaXBBZGRyZXNzIiwiaXAiLCJjb25uZWN0aW9uIiwicmVtb3RlQWRkcmVzcyIsImhlYWRlcnMiLCJ1c2VySXAiLCJfZGVmYXVsdCIsImV4cG9ydHMiLCJkZWZhdWx0Il0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvbWlkZGxld2FyZXMvIiwic291cmNlcyI6WyJnZXRVc2VySVAuanMiXSwic291cmNlc0NvbnRlbnQiOlsiY29uc3QgZ2V0VXNlcklwID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIGNvbnN0IGlwQWRkcmVzcyA9XG4gICAgcmVxLmlwIHx8IHJlcS5jb25uZWN0aW9uLnJlbW90ZUFkZHJlc3MgfHwgcmVxLmhlYWRlcnNbXCJ4LWZvcndhcmRlZC1mb3JcIl07XG4gIHJlcS51c2VySXAgPSBpcEFkZHJlc3M7XG4gIG5leHQoKTtcbn07XG5leHBvcnQgZGVmYXVsdCBnZXRVc2VySXA7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLE1BQU1BLFNBQVMsR0FBRyxNQUFBQSxDQUFPQyxHQUFHLEVBQUVDLEdBQUcsRUFBRUMsSUFBSSxLQUFLO0VBQzFDLE1BQU1DLFNBQVMsR0FDYkgsR0FBRyxDQUFDSSxFQUFFLElBQUlKLEdBQUcsQ0FBQ0ssVUFBVSxDQUFDQyxhQUFhLElBQUlOLEdBQUcsQ0FBQ08sT0FBTyxDQUFDLGlCQUFpQixDQUFDO0VBQzFFUCxHQUFHLENBQUNRLE1BQU0sR0FBR0wsU0FBUztFQUN0QkQsSUFBSSxDQUFDLENBQUM7QUFDUixDQUFDO0FBQUMsSUFBQU8sUUFBQSxHQUFBQyxPQUFBLENBQUFDLE9BQUEsR0FDYVosU0FBUyIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["getUserIp","req","res","next","ipAddress","ip","connection","remoteAddress","headers","userIp","_default","exports","default"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["getUserIP.js"],"sourcesContent":["const getUserIp = async (req, res, next) => {\n  const ipAddress =\n    req.ip || req.connection.remoteAddress || req.headers[\"x-forwarded-for\"];\n  req.userIp = ipAddress;\n  next();\n};\nexport default getUserIp;\n"],"mappings":";;;;;;AAAA,MAAMA,SAAS,GAAG,MAAAA,CAAOC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EAC1C,MAAMC,SAAS,GACbH,GAAG,CAACI,EAAE,IAAIJ,GAAG,CAACK,UAAU,CAACC,aAAa,IAAIN,GAAG,CAACO,OAAO,CAAC,iBAAiB,CAAC;EAC1EP,GAAG,CAACQ,MAAM,GAAGL,SAAS;EACtBD,IAAI,CAAC,CAAC;AACR,CAAC;AAAC,IAAAO,QAAA,GAAAC,OAAA,CAAAC,OAAA,GACaZ,SAAS","ignoreList":[]}},"mtime":1721312705757},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/config.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nconst production = process.argv.slice(2).includes(\"dev\") ? false : true;\nconst config = {\n  development: !production,\n  production: production,\n  deployment: production ? \"PRODUCTION\" : \"DEVELOPMENT\"\n};\nvar _default = exports.default = config;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJwcm9kdWN0aW9uIiwicHJvY2VzcyIsImFyZ3YiLCJzbGljZSIsImluY2x1ZGVzIiwiY29uZmlnIiwiZGV2ZWxvcG1lbnQiLCJkZXBsb3ltZW50IiwiX2RlZmF1bHQiLCJleHBvcnRzIiwiZGVmYXVsdCJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjLyIsInNvdXJjZXMiOlsiY29uZmlnLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHByb2R1Y3Rpb24gPSBwcm9jZXNzLmFyZ3Yuc2xpY2UoMikuaW5jbHVkZXMoXCJkZXZcIikgPyBmYWxzZSA6IHRydWU7XG5cbmNvbnN0IGNvbmZpZyA9IHtcbiAgZGV2ZWxvcG1lbnQ6ICFwcm9kdWN0aW9uLFxuICBwcm9kdWN0aW9uOiBwcm9kdWN0aW9uLFxuICBkZXBsb3ltZW50OiBwcm9kdWN0aW9uID8gXCJQUk9EVUNUSU9OXCIgOiBcIkRFVkVMT1BNRU5UXCIsXG59O1xuZXhwb3J0IGRlZmF1bHQgY29uZmlnO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxNQUFNQSxVQUFVLEdBQUdDLE9BQU8sQ0FBQ0MsSUFBSSxDQUFDQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUNDLFFBQVEsQ0FBQyxLQUFLLENBQUMsR0FBRyxLQUFLLEdBQUcsSUFBSTtBQUV2RSxNQUFNQyxNQUFNLEdBQUc7RUFDYkMsV0FBVyxFQUFFLENBQUNOLFVBQVU7RUFDeEJBLFVBQVUsRUFBRUEsVUFBVTtFQUN0Qk8sVUFBVSxFQUFFUCxVQUFVLEdBQUcsWUFBWSxHQUFHO0FBQzFDLENBQUM7QUFBQyxJQUFBUSxRQUFBLEdBQUFDLE9BQUEsQ0FBQUMsT0FBQSxHQUNhTCxNQUFNIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["production","process","argv","slice","includes","config","development","deployment","_default","exports","default"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/","sources":["config.js"],"sourcesContent":["const production = process.argv.slice(2).includes(\"dev\") ? false : true;\n\nconst config = {\n  development: !production,\n  production: production,\n  deployment: production ? \"PRODUCTION\" : \"DEVELOPMENT\",\n};\nexport default config;\n"],"mappings":";;;;;;AAAA,MAAMA,UAAU,GAAGC,OAAO,CAACC,IAAI,CAACC,KAAK,CAAC,CAAC,CAAC,CAACC,QAAQ,CAAC,KAAK,CAAC,GAAG,KAAK,GAAG,IAAI;AAEvE,MAAMC,MAAM,GAAG;EACbC,WAAW,EAAE,CAACN,UAAU;EACxBA,UAAU,EAAEA,UAAU;EACtBO,UAAU,EAAEP,UAAU,GAAG,YAAY,GAAG;AAC1C,CAAC;AAAC,IAAAQ,QAAA,GAAAC,OAAA,CAAAC,OAAA,GACaL,MAAM","ignoreList":[]}},"mtime":1721043478449},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/index.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _cart = _interopRequireDefault(require(\"./cart\"));\nvar _comments = _interopRequireDefault(require(\"./comments\"));\nvar _paymentFailed = _interopRequireDefault(require(\"./payment-failed\"));\nvar _paymentSuccess = _interopRequireDefault(require(\"./payment-success\"));\nvar _products = _interopRequireDefault(require(\"./products\"));\nvar _replies = _interopRequireDefault(require(\"./replies\"));\nvar _seller = _interopRequireDefault(require(\"./seller\"));\nvar _users = _interopRequireDefault(require(\"./users\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = exports.default = [_users.default, _products.default, _cart.default, _paymentFailed.default, _paymentSuccess.default, _seller.default, _comments.default, _replies.default];\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfY2FydCIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2NvbW1lbnRzIiwiX3BheW1lbnRGYWlsZWQiLCJfcGF5bWVudFN1Y2Nlc3MiLCJfcHJvZHVjdHMiLCJfcmVwbGllcyIsIl9zZWxsZXIiLCJfdXNlcnMiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfZGVmYXVsdCIsImV4cG9ydHMiLCJVc2VycyIsIlByb2R1Y3RzIiwiQ2FydCIsIlBheW1lbnRGYWlsZWQiLCJQYXltZW50U3VjY2VzcyIsIlNlbGxlciIsIkNvbW1lbnRzIiwiUmVwbGllcyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL2RiLyIsInNvdXJjZXMiOlsiaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IENhcnQgZnJvbSBcIi4vY2FydFwiO1xuaW1wb3J0IENvbW1lbnRzIGZyb20gXCIuL2NvbW1lbnRzXCI7XG5pbXBvcnQgUGF5bWVudEZhaWxlZCBmcm9tIFwiLi9wYXltZW50LWZhaWxlZFwiO1xuaW1wb3J0IFBheW1lbnRTdWNjZXNzIGZyb20gXCIuL3BheW1lbnQtc3VjY2Vzc1wiO1xuaW1wb3J0IFByb2R1Y3RzIGZyb20gXCIuL3Byb2R1Y3RzXCI7XG5pbXBvcnQgUmVwbGllcyBmcm9tIFwiLi9yZXBsaWVzXCI7XG5pbXBvcnQgU2VsbGVyIGZyb20gXCIuL3NlbGxlclwiO1xuaW1wb3J0IFVzZXJzIGZyb20gXCIuL3VzZXJzXCI7XG5leHBvcnQgZGVmYXVsdCBbXG4gIFVzZXJzLFxuICBQcm9kdWN0cyxcbiAgQ2FydCxcbiAgUGF5bWVudEZhaWxlZCxcbiAgUGF5bWVudFN1Y2Nlc3MsXG4gIFNlbGxlcixcbiAgQ29tbWVudHMsXG4gIFJlcGxpZXMsXG5dO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxLQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxTQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxjQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRyxlQUFBLEdBQUFKLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSSxTQUFBLEdBQUFMLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSyxRQUFBLEdBQUFOLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBTSxPQUFBLEdBQUFQLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBTyxNQUFBLEdBQUFSLHNCQUFBLENBQUFDLE9BQUE7QUFBNEIsU0FBQUQsdUJBQUFTLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFBQSxJQUFBRyxRQUFBLEdBQUFDLE9BQUEsQ0FBQUYsT0FBQSxHQUNiLENBQ2JHLGNBQUssRUFDTEMsaUJBQVEsRUFDUkMsYUFBSSxFQUNKQyxzQkFBYSxFQUNiQyx1QkFBYyxFQUNkQyxlQUFNLEVBQ05DLGlCQUFRLEVBQ1JDLGdCQUFPLENBQ1IiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_cart","_interopRequireDefault","require","_comments","_paymentFailed","_paymentSuccess","_products","_replies","_seller","_users","e","__esModule","default","_default","exports","Users","Products","Cart","PaymentFailed","PaymentSuccess","Seller","Comments","Replies"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["index.js"],"sourcesContent":["import Cart from \"./cart\";\nimport Comments from \"./comments\";\nimport PaymentFailed from \"./payment-failed\";\nimport PaymentSuccess from \"./payment-success\";\nimport Products from \"./products\";\nimport Replies from \"./replies\";\nimport Seller from \"./seller\";\nimport Users from \"./users\";\nexport default [\n  Users,\n  Products,\n  Cart,\n  PaymentFailed,\n  PaymentSuccess,\n  Seller,\n  Comments,\n  Replies,\n];\n"],"mappings":";;;;;;AAAA,IAAAA,KAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,cAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,eAAA,GAAAJ,sBAAA,CAAAC,OAAA;AACA,IAAAI,SAAA,GAAAL,sBAAA,CAAAC,OAAA;AACA,IAAAK,QAAA,GAAAN,sBAAA,CAAAC,OAAA;AACA,IAAAM,OAAA,GAAAP,sBAAA,CAAAC,OAAA;AACA,IAAAO,MAAA,GAAAR,sBAAA,CAAAC,OAAA;AAA4B,SAAAD,uBAAAS,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAAA,IAAAG,QAAA,GAAAC,OAAA,CAAAF,OAAA,GACb,CACbG,cAAK,EACLC,iBAAQ,EACRC,aAAI,EACJC,sBAAa,EACbC,uBAAc,EACdC,eAAM,EACNC,iBAAQ,EACRC,gBAAO,CACR","ignoreList":[]}},"mtime":1734612377908},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/VerificationEmail.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\nvar _nodemailer = _interopRequireDefault(require(\"nodemailer\"));\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst sendVerificationEmail = async (req, res, next) => {\n  const {\n    email\n  } = req.body;\n  const user = await _users.default.findOne({\n    email\n  });\n  if (!user) {\n    return next(new _ApiError.default(400, \"Kullanıcı bulunamadı\"));\n  }\n  const token = _jsonwebtoken.default.sign({\n    id: user._id\n  }, process.env.JWT_SECRET, {\n    expiresIn: \"1h\"\n  });\n  const verificationUrl = `https://localhost:3000/api/verify-email?token=${token}`;\n  const transporter = _nodemailer.default.createTransport({\n    host: \"smtp.yandex.com\",\n    port: 465,\n    secure: true,\n    auth: {\n      user: process.env.MAIL_SENDER,\n      pass: process.env.MAIL_SENDER_PASSWORD\n    },\n    debug: true,\n    logger: true\n  });\n  const mailOptions = {\n    from: process.env.MAIL_SENDER,\n    to: email,\n    subject: \"Email Onayı\",\n    html: `\n      <div style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333; background-color: #f9f9f9; padding: 20px; border-radius: 5px;\">\n        <table style=\"width: 100%; max-width: 600px; margin: 0 auto; background-color: #ffffff; border-radius: 5px; overflow: hidden; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\">\n          <thead style=\"background-color: #007bff; color: #ffffff; text-align: center; padding: 10px;\">\n            <tr>\n              <th style=\"padding: 20px; font-size: 24px;\">Email Onayı</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr>\n              <td style=\"padding: 20px; text-align: center; font-size: 16px;\">\n                <p>Hello,</p>\n                <p>Kayıt olduğunuz için teşekkür ederiz. Lütfen alttaki bağlantıya tıklayıp hesabınızı onaylayın.</p>\n                <a href=\"${verificationUrl}\" style=\"display: inline-block; background-color: #007bff; color: #ffffff; text-decoration: none; padding: 10px 20px; font-size: 16px; border-radius: 5px; margin-top: 10px;\">Verify Email</a>\n                <p style=\"margin-top: 20px; font-size: 14px; color: #666;\">If you didn’t create this account, you can safely ignore this email.</p>\n              </td>\n            </tr>\n          </tbody>\n          <tfoot style=\"background-color: #f1f1f1; text-align: center; padding: 10px;\">\n            <tr>\n              <td style=\"font-size: 12px; color: #999;\">\n                &copy; ${new Date().getFullYear()} TURKOTREND. Tüm Hakları Saklıdır.\n              </td>\n            </tr>\n          </tfoot>\n        </table>\n      </div>\n    `\n  };\n  try {\n    await transporter.sendMail(mailOptions);\n    console.log(`JWT Token: ${token}`); //bitince silinecek\n    next();\n  } catch (error) {\n    console.log(error);\n    return next(new _ApiError.default(500, \"Doğrulama e-postası gönderilemedi\"));\n  }\n};\nvar _default = exports.default = sendVerificationEmail;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfanNvbndlYnRva2VuIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfbm9kZW1haWxlciIsIl91c2VycyIsIl9BcGlFcnJvciIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsInNlbmRWZXJpZmljYXRpb25FbWFpbCIsInJlcSIsInJlcyIsIm5leHQiLCJlbWFpbCIsImJvZHkiLCJ1c2VyIiwiVXNlcnMiLCJmaW5kT25lIiwiQXBpRXJyb3IiLCJ0b2tlbiIsImp3dCIsInNpZ24iLCJpZCIsIl9pZCIsInByb2Nlc3MiLCJlbnYiLCJKV1RfU0VDUkVUIiwiZXhwaXJlc0luIiwidmVyaWZpY2F0aW9uVXJsIiwidHJhbnNwb3J0ZXIiLCJub2RlbWFpbGVyIiwiY3JlYXRlVHJhbnNwb3J0IiwiaG9zdCIsInBvcnQiLCJzZWN1cmUiLCJhdXRoIiwiTUFJTF9TRU5ERVIiLCJwYXNzIiwiTUFJTF9TRU5ERVJfUEFTU1dPUkQiLCJkZWJ1ZyIsImxvZ2dlciIsIm1haWxPcHRpb25zIiwiZnJvbSIsInRvIiwic3ViamVjdCIsImh0bWwiLCJEYXRlIiwiZ2V0RnVsbFllYXIiLCJzZW5kTWFpbCIsImNvbnNvbGUiLCJsb2ciLCJlcnJvciIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL21pZGRsZXdhcmVzLyIsInNvdXJjZXMiOlsiVmVyaWZpY2F0aW9uRW1haWwuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGp3dCBmcm9tIFwianNvbndlYnRva2VuXCI7XG5pbXBvcnQgbm9kZW1haWxlciBmcm9tIFwibm9kZW1haWxlclwiO1xuaW1wb3J0IFVzZXJzIGZyb20gXCIuLi9kYi91c2Vyc1wiO1xuaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuLi9lcnJvcnMvQXBpRXJyb3JcIjtcblxuY29uc3Qgc2VuZFZlcmlmaWNhdGlvbkVtYWlsID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIGNvbnN0IHsgZW1haWwgfSA9IHJlcS5ib2R5O1xuICBjb25zdCB1c2VyID0gYXdhaXQgVXNlcnMuZmluZE9uZSh7IGVtYWlsIH0pO1xuXG4gIGlmICghdXNlcikge1xuICAgIHJldHVybiBuZXh0KG5ldyBBcGlFcnJvcig0MDAsIFwiS3VsbGFuxLFjxLEgYnVsdW5hbWFkxLFcIikpO1xuICB9XG5cbiAgY29uc3QgdG9rZW4gPSBqd3Quc2lnbih7IGlkOiB1c2VyLl9pZCB9LCBwcm9jZXNzLmVudi5KV1RfU0VDUkVULCB7XG4gICAgZXhwaXJlc0luOiBcIjFoXCIsXG4gIH0pO1xuICBjb25zdCB2ZXJpZmljYXRpb25VcmwgPSBgaHR0cHM6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvdmVyaWZ5LWVtYWlsP3Rva2VuPSR7dG9rZW59YDtcblxuICBjb25zdCB0cmFuc3BvcnRlciA9IG5vZGVtYWlsZXIuY3JlYXRlVHJhbnNwb3J0KHtcbiAgICBob3N0OiBcInNtdHAueWFuZGV4LmNvbVwiLFxuICAgIHBvcnQ6IDQ2NSxcbiAgICBzZWN1cmU6IHRydWUsXG4gICAgYXV0aDoge1xuICAgICAgdXNlcjogcHJvY2Vzcy5lbnYuTUFJTF9TRU5ERVIsXG4gICAgICBwYXNzOiBwcm9jZXNzLmVudi5NQUlMX1NFTkRFUl9QQVNTV09SRCxcbiAgICB9LFxuICAgIGRlYnVnOiB0cnVlLFxuICAgIGxvZ2dlcjogdHJ1ZSxcbiAgfSk7XG5cbiAgY29uc3QgbWFpbE9wdGlvbnMgPSB7XG4gICAgZnJvbTogcHJvY2Vzcy5lbnYuTUFJTF9TRU5ERVIsXG4gICAgdG86IGVtYWlsLFxuICAgIHN1YmplY3Q6IFwiRW1haWwgT25hecSxXCIsXG4gICAgaHRtbDogYFxuICAgICAgPGRpdiBzdHlsZT1cImZvbnQtZmFtaWx5OiBBcmlhbCwgc2Fucy1zZXJpZjsgbGluZS1oZWlnaHQ6IDEuNjsgY29sb3I6ICMzMzM7IGJhY2tncm91bmQtY29sb3I6ICNmOWY5Zjk7IHBhZGRpbmc6IDIwcHg7IGJvcmRlci1yYWRpdXM6IDVweDtcIj5cbiAgICAgICAgPHRhYmxlIHN0eWxlPVwid2lkdGg6IDEwMCU7IG1heC13aWR0aDogNjAwcHg7IG1hcmdpbjogMCBhdXRvOyBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmZmZmOyBib3JkZXItcmFkaXVzOiA1cHg7IG92ZXJmbG93OiBoaWRkZW47IGJveC1zaGFkb3c6IDAgMnB4IDRweCByZ2JhKDAsIDAsIDAsIDAuMSk7XCI+XG4gICAgICAgICAgPHRoZWFkIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjogIzAwN2JmZjsgY29sb3I6ICNmZmZmZmY7IHRleHQtYWxpZ246IGNlbnRlcjsgcGFkZGluZzogMTBweDtcIj5cbiAgICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICAgPHRoIHN0eWxlPVwicGFkZGluZzogMjBweDsgZm9udC1zaXplOiAyNHB4O1wiPkVtYWlsIE9uYXnEsTwvdGg+XG4gICAgICAgICAgICA8L3RyPlxuICAgICAgICAgIDwvdGhlYWQ+XG4gICAgICAgICAgPHRib2R5PlxuICAgICAgICAgICAgPHRyPlxuICAgICAgICAgICAgICA8dGQgc3R5bGU9XCJwYWRkaW5nOiAyMHB4OyB0ZXh0LWFsaWduOiBjZW50ZXI7IGZvbnQtc2l6ZTogMTZweDtcIj5cbiAgICAgICAgICAgICAgICA8cD5IZWxsbyw8L3A+XG4gICAgICAgICAgICAgICAgPHA+S2F5xLF0IG9sZHXEn3VudXogacOnaW4gdGXFn2Vra8O8ciBlZGVyaXouIEzDvHRmZW4gYWx0dGFraSBiYcSfbGFudMSxeWEgdMSxa2xhecSxcCBoZXNhYsSxbsSxesSxIG9uYXlsYXnEsW4uPC9wPlxuICAgICAgICAgICAgICAgIDxhIGhyZWY9XCIke3ZlcmlmaWNhdGlvblVybH1cIiBzdHlsZT1cImRpc3BsYXk6IGlubGluZS1ibG9jazsgYmFja2dyb3VuZC1jb2xvcjogIzAwN2JmZjsgY29sb3I6ICNmZmZmZmY7IHRleHQtZGVjb3JhdGlvbjogbm9uZTsgcGFkZGluZzogMTBweCAyMHB4OyBmb250LXNpemU6IDE2cHg7IGJvcmRlci1yYWRpdXM6IDVweDsgbWFyZ2luLXRvcDogMTBweDtcIj5WZXJpZnkgRW1haWw8L2E+XG4gICAgICAgICAgICAgICAgPHAgc3R5bGU9XCJtYXJnaW4tdG9wOiAyMHB4OyBmb250LXNpemU6IDE0cHg7IGNvbG9yOiAjNjY2O1wiPklmIHlvdSBkaWRu4oCZdCBjcmVhdGUgdGhpcyBhY2NvdW50LCB5b3UgY2FuIHNhZmVseSBpZ25vcmUgdGhpcyBlbWFpbC48L3A+XG4gICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICA8L3RyPlxuICAgICAgICAgIDwvdGJvZHk+XG4gICAgICAgICAgPHRmb290IHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjogI2YxZjFmMTsgdGV4dC1hbGlnbjogY2VudGVyOyBwYWRkaW5nOiAxMHB4O1wiPlxuICAgICAgICAgICAgPHRyPlxuICAgICAgICAgICAgICA8dGQgc3R5bGU9XCJmb250LXNpemU6IDEycHg7IGNvbG9yOiAjOTk5O1wiPlxuICAgICAgICAgICAgICAgICZjb3B5OyAke25ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKX0gVFVSS09UUkVORC4gVMO8bSBIYWtsYXLEsSBTYWtsxLFkxLFyLlxuICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICA8L3Rmb290PlxuICAgICAgICA8L3RhYmxlPlxuICAgICAgPC9kaXY+XG4gICAgYCxcbiAgfTtcblxuICB0cnkge1xuICAgIGF3YWl0IHRyYW5zcG9ydGVyLnNlbmRNYWlsKG1haWxPcHRpb25zKTtcbiAgICBjb25zb2xlLmxvZyhgSldUIFRva2VuOiAke3Rva2VufWApOyAvL2JpdGluY2Ugc2lsaW5lY2VrXG4gICAgbmV4dCgpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICByZXR1cm4gbmV4dChuZXcgQXBpRXJyb3IoNTAwLCBcIkRvxJ9ydWxhbWEgZS1wb3N0YXPEsSBnw7ZuZGVyaWxlbWVkaVwiKSk7XG4gIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IHNlbmRWZXJpZmljYXRpb25FbWFpbDtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsYUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsV0FBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsTUFBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUcsU0FBQSxHQUFBSixzQkFBQSxDQUFBQyxPQUFBO0FBQTBDLFNBQUFELHVCQUFBSyxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBRTFDLE1BQU1HLHFCQUFxQixHQUFHLE1BQUFBLENBQU9DLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxJQUFJLEtBQUs7RUFDdEQsTUFBTTtJQUFFQztFQUFNLENBQUMsR0FBR0gsR0FBRyxDQUFDSSxJQUFJO0VBQzFCLE1BQU1DLElBQUksR0FBRyxNQUFNQyxjQUFLLENBQUNDLE9BQU8sQ0FBQztJQUFFSjtFQUFNLENBQUMsQ0FBQztFQUUzQyxJQUFJLENBQUNFLElBQUksRUFBRTtJQUNULE9BQU9ILElBQUksQ0FBQyxJQUFJTSxpQkFBUSxDQUFDLEdBQUcsRUFBRSxzQkFBc0IsQ0FBQyxDQUFDO0VBQ3hEO0VBRUEsTUFBTUMsS0FBSyxHQUFHQyxxQkFBRyxDQUFDQyxJQUFJLENBQUM7SUFBRUMsRUFBRSxFQUFFUCxJQUFJLENBQUNRO0VBQUksQ0FBQyxFQUFFQyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0MsVUFBVSxFQUFFO0lBQy9EQyxTQUFTLEVBQUU7RUFDYixDQUFDLENBQUM7RUFDRixNQUFNQyxlQUFlLEdBQUcsaURBQWlEVCxLQUFLLEVBQUU7RUFFaEYsTUFBTVUsV0FBVyxHQUFHQyxtQkFBVSxDQUFDQyxlQUFlLENBQUM7SUFDN0NDLElBQUksRUFBRSxpQkFBaUI7SUFDdkJDLElBQUksRUFBRSxHQUFHO0lBQ1RDLE1BQU0sRUFBRSxJQUFJO0lBQ1pDLElBQUksRUFBRTtNQUNKcEIsSUFBSSxFQUFFUyxPQUFPLENBQUNDLEdBQUcsQ0FBQ1csV0FBVztNQUM3QkMsSUFBSSxFQUFFYixPQUFPLENBQUNDLEdBQUcsQ0FBQ2E7SUFDcEIsQ0FBQztJQUNEQyxLQUFLLEVBQUUsSUFBSTtJQUNYQyxNQUFNLEVBQUU7RUFDVixDQUFDLENBQUM7RUFFRixNQUFNQyxXQUFXLEdBQUc7SUFDbEJDLElBQUksRUFBRWxCLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDVyxXQUFXO0lBQzdCTyxFQUFFLEVBQUU5QixLQUFLO0lBQ1QrQixPQUFPLEVBQUUsYUFBYTtJQUN0QkMsSUFBSSxFQUFFO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCakIsZUFBZTtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixJQUFJa0IsSUFBSSxDQUFDLENBQUMsQ0FBQ0MsV0FBVyxDQUFDLENBQUM7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0VBQ0UsQ0FBQztFQUVELElBQUk7SUFDRixNQUFNbEIsV0FBVyxDQUFDbUIsUUFBUSxDQUFDUCxXQUFXLENBQUM7SUFDdkNRLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLGNBQWMvQixLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDcENQLElBQUksQ0FBQyxDQUFDO0VBQ1IsQ0FBQyxDQUFDLE9BQU91QyxLQUFLLEVBQUU7SUFDZEYsT0FBTyxDQUFDQyxHQUFHLENBQUNDLEtBQUssQ0FBQztJQUNsQixPQUFPdkMsSUFBSSxDQUFDLElBQUlNLGlCQUFRLENBQUMsR0FBRyxFQUFFLG1DQUFtQyxDQUFDLENBQUM7RUFDckU7QUFDRixDQUFDO0FBQUMsSUFBQWtDLFFBQUEsR0FBQUMsT0FBQSxDQUFBN0MsT0FBQSxHQUVhQyxxQkFBcUIiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_jsonwebtoken","_interopRequireDefault","require","_nodemailer","_users","_ApiError","e","__esModule","default","sendVerificationEmail","req","res","next","email","body","user","Users","findOne","ApiError","token","jwt","sign","id","_id","process","env","JWT_SECRET","expiresIn","verificationUrl","transporter","nodemailer","createTransport","host","port","secure","auth","MAIL_SENDER","pass","MAIL_SENDER_PASSWORD","debug","logger","mailOptions","from","to","subject","html","Date","getFullYear","sendMail","console","log","error","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["VerificationEmail.js"],"sourcesContent":["import jwt from \"jsonwebtoken\";\nimport nodemailer from \"nodemailer\";\nimport Users from \"../db/users\";\nimport ApiError from \"../errors/ApiError\";\n\nconst sendVerificationEmail = async (req, res, next) => {\n  const { email } = req.body;\n  const user = await Users.findOne({ email });\n\n  if (!user) {\n    return next(new ApiError(400, \"Kullanıcı bulunamadı\"));\n  }\n\n  const token = jwt.sign({ id: user._id }, process.env.JWT_SECRET, {\n    expiresIn: \"1h\",\n  });\n  const verificationUrl = `https://localhost:3000/api/verify-email?token=${token}`;\n\n  const transporter = nodemailer.createTransport({\n    host: \"smtp.yandex.com\",\n    port: 465,\n    secure: true,\n    auth: {\n      user: process.env.MAIL_SENDER,\n      pass: process.env.MAIL_SENDER_PASSWORD,\n    },\n    debug: true,\n    logger: true,\n  });\n\n  const mailOptions = {\n    from: process.env.MAIL_SENDER,\n    to: email,\n    subject: \"Email Onayı\",\n    html: `\n      <div style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333; background-color: #f9f9f9; padding: 20px; border-radius: 5px;\">\n        <table style=\"width: 100%; max-width: 600px; margin: 0 auto; background-color: #ffffff; border-radius: 5px; overflow: hidden; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\">\n          <thead style=\"background-color: #007bff; color: #ffffff; text-align: center; padding: 10px;\">\n            <tr>\n              <th style=\"padding: 20px; font-size: 24px;\">Email Onayı</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr>\n              <td style=\"padding: 20px; text-align: center; font-size: 16px;\">\n                <p>Hello,</p>\n                <p>Kayıt olduğunuz için teşekkür ederiz. Lütfen alttaki bağlantıya tıklayıp hesabınızı onaylayın.</p>\n                <a href=\"${verificationUrl}\" style=\"display: inline-block; background-color: #007bff; color: #ffffff; text-decoration: none; padding: 10px 20px; font-size: 16px; border-radius: 5px; margin-top: 10px;\">Verify Email</a>\n                <p style=\"margin-top: 20px; font-size: 14px; color: #666;\">If you didn’t create this account, you can safely ignore this email.</p>\n              </td>\n            </tr>\n          </tbody>\n          <tfoot style=\"background-color: #f1f1f1; text-align: center; padding: 10px;\">\n            <tr>\n              <td style=\"font-size: 12px; color: #999;\">\n                &copy; ${new Date().getFullYear()} TURKOTREND. Tüm Hakları Saklıdır.\n              </td>\n            </tr>\n          </tfoot>\n        </table>\n      </div>\n    `,\n  };\n\n  try {\n    await transporter.sendMail(mailOptions);\n    console.log(`JWT Token: ${token}`); //bitince silinecek\n    next();\n  } catch (error) {\n    console.log(error);\n    return next(new ApiError(500, \"Doğrulama e-postası gönderilemedi\"));\n  }\n};\n\nexport default sendVerificationEmail;\n"],"mappings":";;;;;;AAAA,IAAAA,aAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,WAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,MAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,SAAA,GAAAJ,sBAAA,CAAAC,OAAA;AAA0C,SAAAD,uBAAAK,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE1C,MAAMG,qBAAqB,GAAG,MAAAA,CAAOC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EACtD,MAAM;IAAEC;EAAM,CAAC,GAAGH,GAAG,CAACI,IAAI;EAC1B,MAAMC,IAAI,GAAG,MAAMC,cAAK,CAACC,OAAO,CAAC;IAAEJ;EAAM,CAAC,CAAC;EAE3C,IAAI,CAACE,IAAI,EAAE;IACT,OAAOH,IAAI,CAAC,IAAIM,iBAAQ,CAAC,GAAG,EAAE,sBAAsB,CAAC,CAAC;EACxD;EAEA,MAAMC,KAAK,GAAGC,qBAAG,CAACC,IAAI,CAAC;IAAEC,EAAE,EAAEP,IAAI,CAACQ;EAAI,CAAC,EAAEC,OAAO,CAACC,GAAG,CAACC,UAAU,EAAE;IAC/DC,SAAS,EAAE;EACb,CAAC,CAAC;EACF,MAAMC,eAAe,GAAG,iDAAiDT,KAAK,EAAE;EAEhF,MAAMU,WAAW,GAAGC,mBAAU,CAACC,eAAe,CAAC;IAC7CC,IAAI,EAAE,iBAAiB;IACvBC,IAAI,EAAE,GAAG;IACTC,MAAM,EAAE,IAAI;IACZC,IAAI,EAAE;MACJpB,IAAI,EAAES,OAAO,CAACC,GAAG,CAACW,WAAW;MAC7BC,IAAI,EAAEb,OAAO,CAACC,GAAG,CAACa;IACpB,CAAC;IACDC,KAAK,EAAE,IAAI;IACXC,MAAM,EAAE;EACV,CAAC,CAAC;EAEF,MAAMC,WAAW,GAAG;IAClBC,IAAI,EAAElB,OAAO,CAACC,GAAG,CAACW,WAAW;IAC7BO,EAAE,EAAE9B,KAAK;IACT+B,OAAO,EAAE,aAAa;IACtBC,IAAI,EAAE;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2BjB,eAAe;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,IAAIkB,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;AACjD;AACA;AACA;AACA;AACA;AACA;EACE,CAAC;EAED,IAAI;IACF,MAAMlB,WAAW,CAACmB,QAAQ,CAACP,WAAW,CAAC;IACvCQ,OAAO,CAACC,GAAG,CAAC,cAAc/B,KAAK,EAAE,CAAC,CAAC,CAAC;IACpCP,IAAI,CAAC,CAAC;EACR,CAAC,CAAC,OAAOuC,KAAK,EAAE;IACdF,OAAO,CAACC,GAAG,CAACC,KAAK,CAAC;IAClB,OAAOvC,IAAI,CAAC,IAAIM,iBAAQ,CAAC,GAAG,EAAE,mCAAmC,CAAC,CAAC;EACrE;AACF,CAAC;AAAC,IAAAkC,QAAA,GAAAC,OAAA,CAAA7C,OAAA,GAEaC,qBAAqB","ignoreList":[]}},"mtime":1732616652847},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/VerificationEmail.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\nvar _nodemailer = _interopRequireDefault(require(\"nodemailer\"));\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst sendVerificationEmail = async (req, res, next) => {\n  const {\n    email\n  } = req.body;\n  const user = await _users.default.findOne({\n    email\n  });\n  if (!user) {\n    return next(new _ApiError.default(400, \"Kullanıcı bulunamadı\"));\n  }\n  const token = _jsonwebtoken.default.sign({\n    id: user._id\n  }, process.env.JWT_SECRET, {\n    expiresIn: \"1h\"\n  });\n  const verificationUrl = `https://localhost:3000/api/verify-email?token=${token}`;\n  const transporter = _nodemailer.default.createTransport({\n    host: \"smtp.yandex.com\",\n    port: 465,\n    secure: true,\n    auth: {\n      user: process.env.MAIL_SENDER,\n      pass: process.env.MAIL_SENDER_PASSWORD\n    },\n    debug: true,\n    logger: true\n  });\n  const mailOptions = {\n    from: process.env.MAIL_SENDER,\n    to: email,\n    subject: \"Email Onayı\",\n    html: `\n      <div style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333; background-color: #f9f9f9; padding: 20px; border-radius: 5px;\">\n        <table style=\"width: 100%; max-width: 600px; margin: 0 auto; background-color: #ffffff; border-radius: 5px; overflow: hidden; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\">\n          <thead style=\"background-color: #007bff; color: #ffffff; text-align: center; padding: 10px;\">\n            <tr>\n              <th style=\"padding: 20px; font-size: 24px;\">Email Onayı</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr>\n              <td style=\"padding: 20px; text-align: center; font-size: 16px;\">\n                <p>Hello,</p>\n                <p>Kayıt olduğunuz için teşekkür ederiz. Lütfen alttaki bağlantıya tıklayıp hesabınızı onaylayın.</p>\n                <a href=\"${verificationUrl}\" style=\"display: inline-block; background-color: #007bff; color: #ffffff; text-decoration: none; padding: 10px 20px; font-size: 16px; border-radius: 5px; margin-top: 10px;\">Verify Email</a>\n                <p style=\"margin-top: 20px; font-size: 14px; color: #666;\">If you didn’t create this account, you can safely ignore this email.</p>\n              </td>\n            </tr>\n          </tbody>\n          <tfoot style=\"background-color: #f1f1f1; text-align: center; padding: 10px;\">\n            <tr>\n              <td style=\"font-size: 12px; color: #999;\">\n                &copy; ${new Date().getFullYear()} TURKOTREND. Tüm Hakları Saklıdır.\n              </td>\n            </tr>\n          </tfoot>\n        </table>\n      </div>\n    `\n  };\n  try {\n    await transporter.sendMail(mailOptions);\n    console.log(`JWT Token: ${token}`); //bitince silinecek\n    next();\n  } catch (error) {\n    console.log(error);\n    return next(new _ApiError.default(500, \"Doğrulama e-postası gönderilemedi\"));\n  }\n};\nvar _default = exports.default = sendVerificationEmail;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfanNvbndlYnRva2VuIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfbm9kZW1haWxlciIsIl91c2VycyIsIl9BcGlFcnJvciIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsInNlbmRWZXJpZmljYXRpb25FbWFpbCIsInJlcSIsInJlcyIsIm5leHQiLCJlbWFpbCIsImJvZHkiLCJ1c2VyIiwiVXNlcnMiLCJmaW5kT25lIiwiQXBpRXJyb3IiLCJ0b2tlbiIsImp3dCIsInNpZ24iLCJpZCIsIl9pZCIsInByb2Nlc3MiLCJlbnYiLCJKV1RfU0VDUkVUIiwiZXhwaXJlc0luIiwidmVyaWZpY2F0aW9uVXJsIiwidHJhbnNwb3J0ZXIiLCJub2RlbWFpbGVyIiwiY3JlYXRlVHJhbnNwb3J0IiwiaG9zdCIsInBvcnQiLCJzZWN1cmUiLCJhdXRoIiwiTUFJTF9TRU5ERVIiLCJwYXNzIiwiTUFJTF9TRU5ERVJfUEFTU1dPUkQiLCJkZWJ1ZyIsImxvZ2dlciIsIm1haWxPcHRpb25zIiwiZnJvbSIsInRvIiwic3ViamVjdCIsImh0bWwiLCJEYXRlIiwiZ2V0RnVsbFllYXIiLCJzZW5kTWFpbCIsImNvbnNvbGUiLCJsb2ciLCJlcnJvciIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL21pZGRsZXdhcmVzLyIsInNvdXJjZXMiOlsiVmVyaWZpY2F0aW9uRW1haWwuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGp3dCBmcm9tIFwianNvbndlYnRva2VuXCI7XG5pbXBvcnQgbm9kZW1haWxlciBmcm9tIFwibm9kZW1haWxlclwiO1xuaW1wb3J0IFVzZXJzIGZyb20gXCIuLi9kYi91c2Vyc1wiO1xuaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuLi9lcnJvcnMvQXBpRXJyb3JcIjtcblxuY29uc3Qgc2VuZFZlcmlmaWNhdGlvbkVtYWlsID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIGNvbnN0IHsgZW1haWwgfSA9IHJlcS5ib2R5O1xuICBjb25zdCB1c2VyID0gYXdhaXQgVXNlcnMuZmluZE9uZSh7IGVtYWlsIH0pO1xuXG4gIGlmICghdXNlcikge1xuICAgIHJldHVybiBuZXh0KG5ldyBBcGlFcnJvcig0MDAsIFwiS3VsbGFuxLFjxLEgYnVsdW5hbWFkxLFcIikpO1xuICB9XG5cbiAgY29uc3QgdG9rZW4gPSBqd3Quc2lnbih7IGlkOiB1c2VyLl9pZCB9LCBwcm9jZXNzLmVudi5KV1RfU0VDUkVULCB7XG4gICAgZXhwaXJlc0luOiBcIjFoXCIsXG4gIH0pO1xuICBjb25zdCB2ZXJpZmljYXRpb25VcmwgPSBgaHR0cHM6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvdmVyaWZ5LWVtYWlsP3Rva2VuPSR7dG9rZW59YDtcblxuICBjb25zdCB0cmFuc3BvcnRlciA9IG5vZGVtYWlsZXIuY3JlYXRlVHJhbnNwb3J0KHtcbiAgICBob3N0OiBcInNtdHAueWFuZGV4LmNvbVwiLFxuICAgIHBvcnQ6IDQ2NSxcbiAgICBzZWN1cmU6IHRydWUsXG4gICAgYXV0aDoge1xuICAgICAgdXNlcjogcHJvY2Vzcy5lbnYuTUFJTF9TRU5ERVIsXG4gICAgICBwYXNzOiBwcm9jZXNzLmVudi5NQUlMX1NFTkRFUl9QQVNTV09SRCxcbiAgICB9LFxuICAgIGRlYnVnOiB0cnVlLFxuICAgIGxvZ2dlcjogdHJ1ZSxcbiAgfSk7XG5cbiAgY29uc3QgbWFpbE9wdGlvbnMgPSB7XG4gICAgZnJvbTogcHJvY2Vzcy5lbnYuTUFJTF9TRU5ERVIsXG4gICAgdG86IGVtYWlsLFxuICAgIHN1YmplY3Q6IFwiRW1haWwgT25hecSxXCIsXG4gICAgaHRtbDogYFxuICAgICAgPGRpdiBzdHlsZT1cImZvbnQtZmFtaWx5OiBBcmlhbCwgc2Fucy1zZXJpZjsgbGluZS1oZWlnaHQ6IDEuNjsgY29sb3I6ICMzMzM7IGJhY2tncm91bmQtY29sb3I6ICNmOWY5Zjk7IHBhZGRpbmc6IDIwcHg7IGJvcmRlci1yYWRpdXM6IDVweDtcIj5cbiAgICAgICAgPHRhYmxlIHN0eWxlPVwid2lkdGg6IDEwMCU7IG1heC13aWR0aDogNjAwcHg7IG1hcmdpbjogMCBhdXRvOyBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmZmZmOyBib3JkZXItcmFkaXVzOiA1cHg7IG92ZXJmbG93OiBoaWRkZW47IGJveC1zaGFkb3c6IDAgMnB4IDRweCByZ2JhKDAsIDAsIDAsIDAuMSk7XCI+XG4gICAgICAgICAgPHRoZWFkIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjogIzAwN2JmZjsgY29sb3I6ICNmZmZmZmY7IHRleHQtYWxpZ246IGNlbnRlcjsgcGFkZGluZzogMTBweDtcIj5cbiAgICAgICAgICAgIDx0cj5cbiAgICAgICAgICAgICAgPHRoIHN0eWxlPVwicGFkZGluZzogMjBweDsgZm9udC1zaXplOiAyNHB4O1wiPkVtYWlsIE9uYXnEsTwvdGg+XG4gICAgICAgICAgICA8L3RyPlxuICAgICAgICAgIDwvdGhlYWQ+XG4gICAgICAgICAgPHRib2R5PlxuICAgICAgICAgICAgPHRyPlxuICAgICAgICAgICAgICA8dGQgc3R5bGU9XCJwYWRkaW5nOiAyMHB4OyB0ZXh0LWFsaWduOiBjZW50ZXI7IGZvbnQtc2l6ZTogMTZweDtcIj5cbiAgICAgICAgICAgICAgICA8cD5IZWxsbyw8L3A+XG4gICAgICAgICAgICAgICAgPHA+S2F5xLF0IG9sZHXEn3VudXogacOnaW4gdGXFn2Vra8O8ciBlZGVyaXouIEzDvHRmZW4gYWx0dGFraSBiYcSfbGFudMSxeWEgdMSxa2xhecSxcCBoZXNhYsSxbsSxesSxIG9uYXlsYXnEsW4uPC9wPlxuICAgICAgICAgICAgICAgIDxhIGhyZWY9XCIke3ZlcmlmaWNhdGlvblVybH1cIiBzdHlsZT1cImRpc3BsYXk6IGlubGluZS1ibG9jazsgYmFja2dyb3VuZC1jb2xvcjogIzAwN2JmZjsgY29sb3I6ICNmZmZmZmY7IHRleHQtZGVjb3JhdGlvbjogbm9uZTsgcGFkZGluZzogMTBweCAyMHB4OyBmb250LXNpemU6IDE2cHg7IGJvcmRlci1yYWRpdXM6IDVweDsgbWFyZ2luLXRvcDogMTBweDtcIj5WZXJpZnkgRW1haWw8L2E+XG4gICAgICAgICAgICAgICAgPHAgc3R5bGU9XCJtYXJnaW4tdG9wOiAyMHB4OyBmb250LXNpemU6IDE0cHg7IGNvbG9yOiAjNjY2O1wiPklmIHlvdSBkaWRu4oCZdCBjcmVhdGUgdGhpcyBhY2NvdW50LCB5b3UgY2FuIHNhZmVseSBpZ25vcmUgdGhpcyBlbWFpbC48L3A+XG4gICAgICAgICAgICAgIDwvdGQ+XG4gICAgICAgICAgICA8L3RyPlxuICAgICAgICAgIDwvdGJvZHk+XG4gICAgICAgICAgPHRmb290IHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjogI2YxZjFmMTsgdGV4dC1hbGlnbjogY2VudGVyOyBwYWRkaW5nOiAxMHB4O1wiPlxuICAgICAgICAgICAgPHRyPlxuICAgICAgICAgICAgICA8dGQgc3R5bGU9XCJmb250LXNpemU6IDEycHg7IGNvbG9yOiAjOTk5O1wiPlxuICAgICAgICAgICAgICAgICZjb3B5OyAke25ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKX0gVFVSS09UUkVORC4gVMO8bSBIYWtsYXLEsSBTYWtsxLFkxLFyLlxuICAgICAgICAgICAgICA8L3RkPlxuICAgICAgICAgICAgPC90cj5cbiAgICAgICAgICA8L3Rmb290PlxuICAgICAgICA8L3RhYmxlPlxuICAgICAgPC9kaXY+XG4gICAgYCxcbiAgfTtcblxuICB0cnkge1xuICAgIGF3YWl0IHRyYW5zcG9ydGVyLnNlbmRNYWlsKG1haWxPcHRpb25zKTtcbiAgICBjb25zb2xlLmxvZyhgSldUIFRva2VuOiAke3Rva2VufWApOyAvL2JpdGluY2Ugc2lsaW5lY2VrXG4gICAgbmV4dCgpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICByZXR1cm4gbmV4dChuZXcgQXBpRXJyb3IoNTAwLCBcIkRvxJ9ydWxhbWEgZS1wb3N0YXPEsSBnw7ZuZGVyaWxlbWVkaVwiKSk7XG4gIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IHNlbmRWZXJpZmljYXRpb25FbWFpbDtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsYUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsV0FBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsTUFBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUcsU0FBQSxHQUFBSixzQkFBQSxDQUFBQyxPQUFBO0FBQTBDLFNBQUFELHVCQUFBSyxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBRTFDLE1BQU1HLHFCQUFxQixHQUFHLE1BQUFBLENBQU9DLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxJQUFJLEtBQUs7RUFDdEQsTUFBTTtJQUFFQztFQUFNLENBQUMsR0FBR0gsR0FBRyxDQUFDSSxJQUFJO0VBQzFCLE1BQU1DLElBQUksR0FBRyxNQUFNQyxjQUFLLENBQUNDLE9BQU8sQ0FBQztJQUFFSjtFQUFNLENBQUMsQ0FBQztFQUUzQyxJQUFJLENBQUNFLElBQUksRUFBRTtJQUNULE9BQU9ILElBQUksQ0FBQyxJQUFJTSxpQkFBUSxDQUFDLEdBQUcsRUFBRSxzQkFBc0IsQ0FBQyxDQUFDO0VBQ3hEO0VBRUEsTUFBTUMsS0FBSyxHQUFHQyxxQkFBRyxDQUFDQyxJQUFJLENBQUM7SUFBRUMsRUFBRSxFQUFFUCxJQUFJLENBQUNRO0VBQUksQ0FBQyxFQUFFQyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0MsVUFBVSxFQUFFO0lBQy9EQyxTQUFTLEVBQUU7RUFDYixDQUFDLENBQUM7RUFDRixNQUFNQyxlQUFlLEdBQUcsaURBQWlEVCxLQUFLLEVBQUU7RUFFaEYsTUFBTVUsV0FBVyxHQUFHQyxtQkFBVSxDQUFDQyxlQUFlLENBQUM7SUFDN0NDLElBQUksRUFBRSxpQkFBaUI7SUFDdkJDLElBQUksRUFBRSxHQUFHO0lBQ1RDLE1BQU0sRUFBRSxJQUFJO0lBQ1pDLElBQUksRUFBRTtNQUNKcEIsSUFBSSxFQUFFUyxPQUFPLENBQUNDLEdBQUcsQ0FBQ1csV0FBVztNQUM3QkMsSUFBSSxFQUFFYixPQUFPLENBQUNDLEdBQUcsQ0FBQ2E7SUFDcEIsQ0FBQztJQUNEQyxLQUFLLEVBQUUsSUFBSTtJQUNYQyxNQUFNLEVBQUU7RUFDVixDQUFDLENBQUM7RUFFRixNQUFNQyxXQUFXLEdBQUc7SUFDbEJDLElBQUksRUFBRWxCLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDVyxXQUFXO0lBQzdCTyxFQUFFLEVBQUU5QixLQUFLO0lBQ1QrQixPQUFPLEVBQUUsYUFBYTtJQUN0QkMsSUFBSSxFQUFFO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCakIsZUFBZTtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlCQUF5QixJQUFJa0IsSUFBSSxDQUFDLENBQUMsQ0FBQ0MsV0FBVyxDQUFDLENBQUM7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0VBQ0UsQ0FBQztFQUVELElBQUk7SUFDRixNQUFNbEIsV0FBVyxDQUFDbUIsUUFBUSxDQUFDUCxXQUFXLENBQUM7SUFDdkNRLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLGNBQWMvQixLQUFLLEVBQUUsQ0FBQyxDQUFDLENBQUM7SUFDcENQLElBQUksQ0FBQyxDQUFDO0VBQ1IsQ0FBQyxDQUFDLE9BQU91QyxLQUFLLEVBQUU7SUFDZEYsT0FBTyxDQUFDQyxHQUFHLENBQUNDLEtBQUssQ0FBQztJQUNsQixPQUFPdkMsSUFBSSxDQUFDLElBQUlNLGlCQUFRLENBQUMsR0FBRyxFQUFFLG1DQUFtQyxDQUFDLENBQUM7RUFDckU7QUFDRixDQUFDO0FBQUMsSUFBQWtDLFFBQUEsR0FBQUMsT0FBQSxDQUFBN0MsT0FBQSxHQUVhQyxxQkFBcUIiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_jsonwebtoken","_interopRequireDefault","require","_nodemailer","_users","_ApiError","e","__esModule","default","sendVerificationEmail","req","res","next","email","body","user","Users","findOne","ApiError","token","jwt","sign","id","_id","process","env","JWT_SECRET","expiresIn","verificationUrl","transporter","nodemailer","createTransport","host","port","secure","auth","MAIL_SENDER","pass","MAIL_SENDER_PASSWORD","debug","logger","mailOptions","from","to","subject","html","Date","getFullYear","sendMail","console","log","error","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["VerificationEmail.js"],"sourcesContent":["import jwt from \"jsonwebtoken\";\nimport nodemailer from \"nodemailer\";\nimport Users from \"../db/users\";\nimport ApiError from \"../errors/ApiError\";\n\nconst sendVerificationEmail = async (req, res, next) => {\n  const { email } = req.body;\n  const user = await Users.findOne({ email });\n\n  if (!user) {\n    return next(new ApiError(400, \"Kullanıcı bulunamadı\"));\n  }\n\n  const token = jwt.sign({ id: user._id }, process.env.JWT_SECRET, {\n    expiresIn: \"1h\",\n  });\n  const verificationUrl = `https://localhost:3000/api/verify-email?token=${token}`;\n\n  const transporter = nodemailer.createTransport({\n    host: \"smtp.yandex.com\",\n    port: 465,\n    secure: true,\n    auth: {\n      user: process.env.MAIL_SENDER,\n      pass: process.env.MAIL_SENDER_PASSWORD,\n    },\n    debug: true,\n    logger: true,\n  });\n\n  const mailOptions = {\n    from: process.env.MAIL_SENDER,\n    to: email,\n    subject: \"Email Onayı\",\n    html: `\n      <div style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333; background-color: #f9f9f9; padding: 20px; border-radius: 5px;\">\n        <table style=\"width: 100%; max-width: 600px; margin: 0 auto; background-color: #ffffff; border-radius: 5px; overflow: hidden; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\">\n          <thead style=\"background-color: #007bff; color: #ffffff; text-align: center; padding: 10px;\">\n            <tr>\n              <th style=\"padding: 20px; font-size: 24px;\">Email Onayı</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr>\n              <td style=\"padding: 20px; text-align: center; font-size: 16px;\">\n                <p>Hello,</p>\n                <p>Kayıt olduğunuz için teşekkür ederiz. Lütfen alttaki bağlantıya tıklayıp hesabınızı onaylayın.</p>\n                <a href=\"${verificationUrl}\" style=\"display: inline-block; background-color: #007bff; color: #ffffff; text-decoration: none; padding: 10px 20px; font-size: 16px; border-radius: 5px; margin-top: 10px;\">Verify Email</a>\n                <p style=\"margin-top: 20px; font-size: 14px; color: #666;\">If you didn’t create this account, you can safely ignore this email.</p>\n              </td>\n            </tr>\n          </tbody>\n          <tfoot style=\"background-color: #f1f1f1; text-align: center; padding: 10px;\">\n            <tr>\n              <td style=\"font-size: 12px; color: #999;\">\n                &copy; ${new Date().getFullYear()} TURKOTREND. Tüm Hakları Saklıdır.\n              </td>\n            </tr>\n          </tfoot>\n        </table>\n      </div>\n    `,\n  };\n\n  try {\n    await transporter.sendMail(mailOptions);\n    console.log(`JWT Token: ${token}`); //bitince silinecek\n    next();\n  } catch (error) {\n    console.log(error);\n    return next(new ApiError(500, \"Doğrulama e-postası gönderilemedi\"));\n  }\n};\n\nexport default sendVerificationEmail;\n"],"mappings":";;;;;;AAAA,IAAAA,aAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,WAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,MAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,SAAA,GAAAJ,sBAAA,CAAAC,OAAA;AAA0C,SAAAD,uBAAAK,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE1C,MAAMG,qBAAqB,GAAG,MAAAA,CAAOC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EACtD,MAAM;IAAEC;EAAM,CAAC,GAAGH,GAAG,CAACI,IAAI;EAC1B,MAAMC,IAAI,GAAG,MAAMC,cAAK,CAACC,OAAO,CAAC;IAAEJ;EAAM,CAAC,CAAC;EAE3C,IAAI,CAACE,IAAI,EAAE;IACT,OAAOH,IAAI,CAAC,IAAIM,iBAAQ,CAAC,GAAG,EAAE,sBAAsB,CAAC,CAAC;EACxD;EAEA,MAAMC,KAAK,GAAGC,qBAAG,CAACC,IAAI,CAAC;IAAEC,EAAE,EAAEP,IAAI,CAACQ;EAAI,CAAC,EAAEC,OAAO,CAACC,GAAG,CAACC,UAAU,EAAE;IAC/DC,SAAS,EAAE;EACb,CAAC,CAAC;EACF,MAAMC,eAAe,GAAG,iDAAiDT,KAAK,EAAE;EAEhF,MAAMU,WAAW,GAAGC,mBAAU,CAACC,eAAe,CAAC;IAC7CC,IAAI,EAAE,iBAAiB;IACvBC,IAAI,EAAE,GAAG;IACTC,MAAM,EAAE,IAAI;IACZC,IAAI,EAAE;MACJpB,IAAI,EAAES,OAAO,CAACC,GAAG,CAACW,WAAW;MAC7BC,IAAI,EAAEb,OAAO,CAACC,GAAG,CAACa;IACpB,CAAC;IACDC,KAAK,EAAE,IAAI;IACXC,MAAM,EAAE;EACV,CAAC,CAAC;EAEF,MAAMC,WAAW,GAAG;IAClBC,IAAI,EAAElB,OAAO,CAACC,GAAG,CAACW,WAAW;IAC7BO,EAAE,EAAE9B,KAAK;IACT+B,OAAO,EAAE,aAAa;IACtBC,IAAI,EAAE;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2BjB,eAAe;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yBAAyB,IAAIkB,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;AACjD;AACA;AACA;AACA;AACA;AACA;EACE,CAAC;EAED,IAAI;IACF,MAAMlB,WAAW,CAACmB,QAAQ,CAACP,WAAW,CAAC;IACvCQ,OAAO,CAACC,GAAG,CAAC,cAAc/B,KAAK,EAAE,CAAC,CAAC,CAAC;IACpCP,IAAI,CAAC,CAAC;EACR,CAAC,CAAC,OAAOuC,KAAK,EAAE;IACdF,OAAO,CAACC,GAAG,CAACC,KAAK,CAAC;IAClB,OAAOvC,IAAI,CAAC,IAAIM,iBAAQ,CAAC,GAAG,EAAE,mCAAmC,CAAC,CAAC;EACrE;AACF,CAAC;AAAC,IAAAkC,QAAA,GAAAC,OAAA,CAAA7C,OAAA,GAEaC,qBAAqB","ignoreList":[]}},"mtime":1732616652847},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/products.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst ProductsSchema = new Schema({\n  uuid: {\n    type: String,\n    default: (0, _uuid.default)(),\n    unique: false,\n    required: true\n  },\n  name: {\n    type: String,\n    required: true\n  },\n  definition: {\n    type: String,\n    required: true\n  },\n  images: {\n    type: [String],\n    //text array olacak\n    required: true\n  },\n  categories: {\n    type: [String]\n  },\n  seller: {\n    type: ObjectId,\n    ref: \"Sellers\",\n    required: true\n  },\n  price: {\n    type: Number,\n    required: true\n  },\n  currency: {\n    type: String,\n    required: true,\n    default: \"TRY\",\n    enum: [\"TRY\", \"USD\", \"EUR\"]\n  },\n  stock: {\n    type: Number,\n    default: 1,\n    required: true\n  },\n  itemType: {\n    type: String,\n    required: true,\n    default: \"PHYSICAL\",\n    enum: [\"PHYSICAL\", \"VIRTUAL\"]\n  }\n}, {\n  _id: true,\n  collection: \"products\",\n  timestamps: true,\n  toJSON: {\n    transform: (doc, ret) => {\n      delete ret.__v;\n      return {\n        ...ret\n      };\n    }\n  }\n});\nconst Products = _mongoose.default.model(\"Products\", ProductsSchema);\nvar _default = exports.default = Products;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9iY3J5cHRqcyIsIl91dWlkIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiU2NoZW1hIiwibW9uZ29vc2UiLCJPYmplY3RJZCIsIlR5cGVzIiwiUHJvZHVjdHNTY2hlbWEiLCJ1dWlkIiwidHlwZSIsIlN0cmluZyIsImlkIiwidW5pcXVlIiwicmVxdWlyZWQiLCJuYW1lIiwiZGVmaW5pdGlvbiIsImltYWdlcyIsImNhdGVnb3JpZXMiLCJzZWxsZXIiLCJyZWYiLCJwcmljZSIsIk51bWJlciIsImN1cnJlbmN5IiwiZW51bSIsInN0b2NrIiwiaXRlbVR5cGUiLCJfaWQiLCJjb2xsZWN0aW9uIiwidGltZXN0YW1wcyIsInRvSlNPTiIsInRyYW5zZm9ybSIsImRvYyIsInJldCIsIl9fdiIsIlByb2R1Y3RzIiwibW9kZWwiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9kYi8iLCJzb3VyY2VzIjpbInByb2R1Y3RzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSBmcm9tIFwibW9uZ29vc2VcIjtcbmltcG9ydCBiY3J5cHQgZnJvbSBcImJjcnlwdGpzXCI7XG5pbXBvcnQgaWQgZnJvbSBcIi4uL3V0aWxzL3V1aWRcIjtcblxuY29uc3QgU2NoZW1hID0gbW9uZ29vc2UuU2NoZW1hO1xuY29uc3QgeyBPYmplY3RJZCB9ID0gU2NoZW1hLlR5cGVzO1xuXG5jb25zdCBQcm9kdWN0c1NjaGVtYSA9IG5ldyBTY2hlbWEoXG4gIHtcbiAgICB1dWlkOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICBkZWZhdWx0OiBpZCgpLFxuICAgICAgdW5pcXVlOiBmYWxzZSxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgbmFtZToge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGltYWdlczoge1xuICAgICAgdHlwZTogW1N0cmluZ10sIC8vdGV4dCBhcnJheSBvbGFjYWtcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgY2F0ZWdvcmllczoge1xuICAgICAgdHlwZTogW1N0cmluZ10sXG4gICAgfSxcbiAgICBzZWxsZXI6IHtcbiAgICAgIHR5cGU6IE9iamVjdElkLFxuICAgICAgcmVmOiBcIlNlbGxlcnNcIixcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgcHJpY2U6IHtcbiAgICAgIHR5cGU6IE51bWJlcixcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgY3VycmVuY3k6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgZGVmYXVsdDogXCJUUllcIixcbiAgICAgIGVudW06IFtcIlRSWVwiLCBcIlVTRFwiLCBcIkVVUlwiXSxcbiAgICB9LFxuICAgIHN0b2NrOiB7XG4gICAgICB0eXBlOiBOdW1iZXIsXG4gICAgICBkZWZhdWx0OiAxLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBpdGVtVHlwZToge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICBkZWZhdWx0OiBcIlBIWVNJQ0FMXCIsXG4gICAgICBlbnVtOiBbXCJQSFlTSUNBTFwiLCBcIlZJUlRVQUxcIl0sXG4gICAgfSxcbiAgfSxcbiAge1xuICAgIF9pZDogdHJ1ZSxcbiAgICBjb2xsZWN0aW9uOiBcInByb2R1Y3RzXCIsXG4gICAgdGltZXN0YW1wczogdHJ1ZSxcbiAgICB0b0pTT046IHtcbiAgICAgIHRyYW5zZm9ybTogKGRvYywgcmV0KSA9PiB7XG4gICAgICAgIGRlbGV0ZSByZXQuX192O1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLnJldCxcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgfSxcbiAgfVxuKTtcblxuY29uc3QgUHJvZHVjdHMgPSBtb25nb29zZS5tb2RlbChcIlByb2R1Y3RzXCIsIFByb2R1Y3RzU2NoZW1hKTtcblxuZXhwb3J0IGRlZmF1bHQgUHJvZHVjdHM7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFNBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLEtBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUErQixTQUFBRCx1QkFBQUksQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUUvQixNQUFNRyxNQUFNLEdBQUdDLGlCQUFRLENBQUNELE1BQU07QUFDOUIsTUFBTTtFQUFFRTtBQUFTLENBQUMsR0FBR0YsTUFBTSxDQUFDRyxLQUFLO0FBRWpDLE1BQU1DLGNBQWMsR0FBRyxJQUFJSixNQUFNLENBQy9CO0VBQ0VLLElBQUksRUFBRTtJQUNKQyxJQUFJLEVBQUVDLE1BQU07SUFDWlIsT0FBTyxFQUFFLElBQUFTLGFBQUUsRUFBQyxDQUFDO0lBQ2JDLE1BQU0sRUFBRSxLQUFLO0lBQ2JDLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDREMsSUFBSSxFQUFFO0lBQ0pMLElBQUksRUFBRUMsTUFBTTtJQUNaRyxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RFLFVBQVUsRUFBRTtJQUNWTixJQUFJLEVBQUVDLE1BQU07SUFDWkcsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNERyxNQUFNLEVBQUU7SUFDTlAsSUFBSSxFQUFFLENBQUNDLE1BQU0sQ0FBQztJQUFFO0lBQ2hCRyxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RJLFVBQVUsRUFBRTtJQUNWUixJQUFJLEVBQUUsQ0FBQ0MsTUFBTTtFQUNmLENBQUM7RUFDRFEsTUFBTSxFQUFFO0lBQ05ULElBQUksRUFBRUosUUFBUTtJQUNkYyxHQUFHLEVBQUUsU0FBUztJQUNkTixRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RPLEtBQUssRUFBRTtJQUNMWCxJQUFJLEVBQUVZLE1BQU07SUFDWlIsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNEUyxRQUFRLEVBQUU7SUFDUmIsSUFBSSxFQUFFQyxNQUFNO0lBQ1pHLFFBQVEsRUFBRSxJQUFJO0lBQ2RYLE9BQU8sRUFBRSxLQUFLO0lBQ2RxQixJQUFJLEVBQUUsQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUs7RUFDNUIsQ0FBQztFQUNEQyxLQUFLLEVBQUU7SUFDTGYsSUFBSSxFQUFFWSxNQUFNO0lBQ1puQixPQUFPLEVBQUUsQ0FBQztJQUNWVyxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RZLFFBQVEsRUFBRTtJQUNSaEIsSUFBSSxFQUFFQyxNQUFNO0lBQ1pHLFFBQVEsRUFBRSxJQUFJO0lBQ2RYLE9BQU8sRUFBRSxVQUFVO0lBQ25CcUIsSUFBSSxFQUFFLENBQUMsVUFBVSxFQUFFLFNBQVM7RUFDOUI7QUFDRixDQUFDLEVBQ0Q7RUFDRUcsR0FBRyxFQUFFLElBQUk7RUFDVEMsVUFBVSxFQUFFLFVBQVU7RUFDdEJDLFVBQVUsRUFBRSxJQUFJO0VBQ2hCQyxNQUFNLEVBQUU7SUFDTkMsU0FBUyxFQUFFQSxDQUFDQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztNQUN2QixPQUFPQSxHQUFHLENBQUNDLEdBQUc7TUFDZCxPQUFPO1FBQ0wsR0FBR0Q7TUFDTCxDQUFDO0lBQ0g7RUFDRjtBQUNGLENBQ0YsQ0FBQztBQUVELE1BQU1FLFFBQVEsR0FBRzlCLGlCQUFRLENBQUMrQixLQUFLLENBQUMsVUFBVSxFQUFFNUIsY0FBYyxDQUFDO0FBQUMsSUFBQTZCLFFBQUEsR0FBQUMsT0FBQSxDQUFBbkMsT0FBQSxHQUU3Q2dDLFFBQVEiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","_bcryptjs","_uuid","e","__esModule","default","Schema","mongoose","ObjectId","Types","ProductsSchema","uuid","type","String","id","unique","required","name","definition","images","categories","seller","ref","price","Number","currency","enum","stock","itemType","_id","collection","timestamps","toJSON","transform","doc","ret","__v","Products","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["products.js"],"sourcesContent":["import mongoose from \"mongoose\";\nimport bcrypt from \"bcryptjs\";\nimport id from \"../utils/uuid\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\n\nconst ProductsSchema = new Schema(\n  {\n    uuid: {\n      type: String,\n      default: id(),\n      unique: false,\n      required: true,\n    },\n    name: {\n      type: String,\n      required: true,\n    },\n    definition: {\n      type: String,\n      required: true,\n    },\n    images: {\n      type: [String], //text array olacak\n      required: true,\n    },\n    categories: {\n      type: [String],\n    },\n    seller: {\n      type: ObjectId,\n      ref: \"Sellers\",\n      required: true,\n    },\n    price: {\n      type: Number,\n      required: true,\n    },\n    currency: {\n      type: String,\n      required: true,\n      default: \"TRY\",\n      enum: [\"TRY\", \"USD\", \"EUR\"],\n    },\n    stock: {\n      type: Number,\n      default: 1,\n      required: true,\n    },\n    itemType: {\n      type: String,\n      required: true,\n      default: \"PHYSICAL\",\n      enum: [\"PHYSICAL\", \"VIRTUAL\"],\n    },\n  },\n  {\n    _id: true,\n    collection: \"products\",\n    timestamps: true,\n    toJSON: {\n      transform: (doc, ret) => {\n        delete ret.__v;\n        return {\n          ...ret,\n        };\n      },\n    },\n  }\n);\n\nconst Products = mongoose.model(\"Products\", ProductsSchema);\n\nexport default Products;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,KAAA,GAAAH,sBAAA,CAAAC,OAAA;AAA+B,SAAAD,uBAAAI,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE/B,MAAMG,MAAM,GAAGC,iBAAQ,CAACD,MAAM;AAC9B,MAAM;EAAEE;AAAS,CAAC,GAAGF,MAAM,CAACG,KAAK;AAEjC,MAAMC,cAAc,GAAG,IAAIJ,MAAM,CAC/B;EACEK,IAAI,EAAE;IACJC,IAAI,EAAEC,MAAM;IACZR,OAAO,EAAE,IAAAS,aAAE,EAAC,CAAC;IACbC,MAAM,EAAE,KAAK;IACbC,QAAQ,EAAE;EACZ,CAAC;EACDC,IAAI,EAAE;IACJL,IAAI,EAAEC,MAAM;IACZG,QAAQ,EAAE;EACZ,CAAC;EACDE,UAAU,EAAE;IACVN,IAAI,EAAEC,MAAM;IACZG,QAAQ,EAAE;EACZ,CAAC;EACDG,MAAM,EAAE;IACNP,IAAI,EAAE,CAACC,MAAM,CAAC;IAAE;IAChBG,QAAQ,EAAE;EACZ,CAAC;EACDI,UAAU,EAAE;IACVR,IAAI,EAAE,CAACC,MAAM;EACf,CAAC;EACDQ,MAAM,EAAE;IACNT,IAAI,EAAEJ,QAAQ;IACdc,GAAG,EAAE,SAAS;IACdN,QAAQ,EAAE;EACZ,CAAC;EACDO,KAAK,EAAE;IACLX,IAAI,EAAEY,MAAM;IACZR,QAAQ,EAAE;EACZ,CAAC;EACDS,QAAQ,EAAE;IACRb,IAAI,EAAEC,MAAM;IACZG,QAAQ,EAAE,IAAI;IACdX,OAAO,EAAE,KAAK;IACdqB,IAAI,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK;EAC5B,CAAC;EACDC,KAAK,EAAE;IACLf,IAAI,EAAEY,MAAM;IACZnB,OAAO,EAAE,CAAC;IACVW,QAAQ,EAAE;EACZ,CAAC;EACDY,QAAQ,EAAE;IACRhB,IAAI,EAAEC,MAAM;IACZG,QAAQ,EAAE,IAAI;IACdX,OAAO,EAAE,UAAU;IACnBqB,IAAI,EAAE,CAAC,UAAU,EAAE,SAAS;EAC9B;AACF,CAAC,EACD;EACEG,GAAG,EAAE,IAAI;EACTC,UAAU,EAAE,UAAU;EACtBC,UAAU,EAAE,IAAI;EAChBC,MAAM,EAAE;IACNC,SAAS,EAAEA,CAACC,GAAG,EAAEC,GAAG,KAAK;MACvB,OAAOA,GAAG,CAACC,GAAG;MACd,OAAO;QACL,GAAGD;MACL,CAAC;IACH;EACF;AACF,CACF,CAAC;AAED,MAAME,QAAQ,GAAG9B,iBAAQ,CAAC+B,KAAK,CAAC,UAAU,EAAE5B,cAAc,CAAC;AAAC,IAAA6B,QAAA,GAAAC,OAAA,CAAAnC,OAAA,GAE7CgC,QAAQ","ignoreList":[]}},"mtime":1727078468711},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/Products.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _multer = _interopRequireDefault(require(\"multer\"));\nvar _path = _interopRequireDefault(require(\"path\"));\nvar _products = _interopRequireDefault(require(\"../db/products\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _CheckExistence = require(\"../helpers/CheckExistence\");\nvar _Permissions = require(\"../helpers/Permissions\");\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst upload = (0, _multer.default)({\n  storage: _multer.default.diskStorage({\n    destination: (req, file, cb) => {\n      cb(null, \"public/images\");\n    },\n    filename: (req, file, cb) => {\n      const originalName = file.originalname;\n      cb(null, originalName);\n    }\n  }),\n  fileFilter: (req, file, cb) => {\n    const fileTypes = /jpeg|jpg|png/;\n    const extname = fileTypes.test(_path.default.extname(file.originalname).toLowerCase());\n    const mimetype = fileTypes.test(file.mimetype);\n    if (mimetype && extname) {\n      return cb(null, true);\n    } else {\n      cb(new _ApiError.default(\"Invalid file type. Only JPEG, JPG, and PNG are allowed.\", 400, \"InvalidFileType\"));\n    }\n  }\n});\nvar _default = router => {\n  router.post(\"/create-product\", _Session.default, upload.array(\"images\", 10), async (req, res, next) => {\n    (0, _Permissions.checkPermissions)(req.user, [\"admin\", \"seller\"]);\n    try {\n      const {\n        name,\n        categories,\n        definition,\n        price,\n        stock\n      } = req.body;\n      const imagePaths = req.files.map(file => file.path);\n      const sellerId = req.user._id;\n      const product = new _products.default({\n        name,\n        images: imagePaths,\n        categories,\n        seller: sellerId,\n        definition,\n        price,\n        stock\n      });\n      await product.save();\n      res.status(201).json(product);\n    } catch (error) {\n      console.log(error);\n      next(new _ApiError.default(\"Product could not be added\", 401, \"DoesNotAddedProduct\"));\n    }\n  });\n  router.get(\"/get-all-products\", async (req, res) => {\n    try {\n      const getAllProducts = await _products.default.find().populate(\"seller\");\n      if (getAllProducts.length === 0) {\n        throw new _ApiError.default(\"There are no products available\", 404, \"noFindProduct\");\n      }\n      res.status(200).json(getAllProducts);\n    } catch (error) {\n      // Hata ApiError ise, hata kodunu ve mesajını kullan\n      if (error instanceof _ApiError.default) {\n        res.status(error.status).json({\n          message: error.message,\n          errorCode: error.code\n        });\n      } else {\n        // Eğer hata ApiError değilse, genel bir hata mesajı döndür\n        res.status(500).json({\n          message: \"An unexpected error occurred\",\n          errorCode: \"InternalServerError\"\n        });\n      }\n    }\n  });\n  router.get(\"/get-products-by-category\", async (req, res) => {\n    const category = req.query.category;\n    if (!category) {\n      return res.status(400).json(new _ApiError.default(\"Category is required\", 401, \"RequiredCategory\"));\n    }\n    try {\n      const products = await _products.default.find({\n        categories: category\n      }).populate(\"seller\");\n      res.status(200).json(products);\n    } catch (error) {\n      console.error(error);\n      res.status(500).json(new _ApiError.default(\"Products cannot be retrieved by category\", 401, \"CannotGetProductsByCategory\"));\n    }\n  });\n  router.get(\"/get-product-by-id/:id\", async (req, res) => {\n    const {\n      id\n    } = req.params;\n    try {\n      const product = await _products.default.findById(id).populate(\"seller\");\n      if (!product) {\n        return res.status(404).json(new _ApiError.default(\"Product not found\", 404, \"ProductNotFound\"));\n      }\n      res.status(200).json(product);\n    } catch (error) {\n      console.error(error);\n      res.status(500).json(new _ApiError.default(\"Product cannot be retrieved\", 500, \"CannotGetProduct\"));\n    }\n  });\n  router.delete(\"/delete-product/:id\", _Session.default, async (req, res) => {\n    const id = req.params.id;\n    try {\n      const sellerProduct = await _products.default.findById(id);\n      const product = await _products.default.findOneAndDelete({\n        _id: id\n      });\n      (0, _Permissions.checkProductOwnerShip)(req.user, product);\n      if (product) {\n        res.status(200).json(`Product number ${id} was deleted`);\n      } else {\n        res.status(404).json(`Product with ID ${id} not found`);\n      }\n    } catch (error) {\n      console.log(error);\n      res.status(500).json(new _ApiError.default(\"Cannot delete product\", 401, \"cannotDeleteProduct\"));\n    }\n  });\n  router.get(\"/get-categories\", async (req, res) => {\n    try {\n      const products = await _products.default.find({});\n      const categories = {};\n      products.forEach(product => {\n        product.categories.forEach(cat => {\n          if (!categories[cat]) {\n            categories[cat] = [];\n          }\n          categories[cat].push(product);\n        });\n      });\n      res.json(categories);\n    } catch (err) {\n      console.error(err);\n      res.status(500).json(new _ApiError.default(\"Cannot get categories\", 401, \"cannotGetCategories\"));\n    }\n  });\n  router.put(\"/update-product/:id\", _Session.default, upload.array(\"images\", 10), async (req, res, next) => {\n    (0, _Permissions.checkPermissions)(req.user, [\"admin\", \"seller\"]);\n    try {\n      const productId = req.params.id;\n      const {\n        name,\n        categories,\n        brand,\n        definition,\n        price,\n        stock\n      } = req.body;\n      const imagePaths = req.files.map(file => file.path);\n      const product = await _products.default.findById(productId);\n      (0, _CheckExistence.notFoundVariable)(product, \"Product\");\n      (0, _Permissions.checkProductOwnerShip)(req.user, product);\n      if (name) product.name = name;\n      if (categories) product.categories = categories;\n      if (brand) product.brand = brand;\n      if (definition) product.definition = definition;\n      if (price) product.price = price;\n      if (stock) product.stock = stock;\n      if (req.files.length > 0) {\n        product.images = imagePaths;\n      }\n      await product.save();\n      res.status(200).json(product);\n    } catch (error) {\n      console.log(error);\n      next(new _ApiError.default(\"Product could not be updated\", 400, \"DoesNotUpdatedProduct\"));\n    }\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbXVsdGVyIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfcGF0aCIsIl9wcm9kdWN0cyIsIl9BcGlFcnJvciIsIl9DaGVja0V4aXN0ZW5jZSIsIl9QZXJtaXNzaW9ucyIsIl9TZXNzaW9uIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwidXBsb2FkIiwibXVsdGVyIiwic3RvcmFnZSIsImRpc2tTdG9yYWdlIiwiZGVzdGluYXRpb24iLCJyZXEiLCJmaWxlIiwiY2IiLCJmaWxlbmFtZSIsIm9yaWdpbmFsTmFtZSIsIm9yaWdpbmFsbmFtZSIsImZpbGVGaWx0ZXIiLCJmaWxlVHlwZXMiLCJleHRuYW1lIiwidGVzdCIsInBhdGgiLCJ0b0xvd2VyQ2FzZSIsIm1pbWV0eXBlIiwiQXBpRXJyb3IiLCJfZGVmYXVsdCIsInJvdXRlciIsInBvc3QiLCJTZXNzaW9uIiwiYXJyYXkiLCJyZXMiLCJuZXh0IiwiY2hlY2tQZXJtaXNzaW9ucyIsInVzZXIiLCJuYW1lIiwiY2F0ZWdvcmllcyIsImRlZmluaXRpb24iLCJwcmljZSIsInN0b2NrIiwiYm9keSIsImltYWdlUGF0aHMiLCJmaWxlcyIsIm1hcCIsInNlbGxlcklkIiwiX2lkIiwicHJvZHVjdCIsIlByb2R1Y3RzIiwiaW1hZ2VzIiwic2VsbGVyIiwic2F2ZSIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJnZXQiLCJnZXRBbGxQcm9kdWN0cyIsImZpbmQiLCJwb3B1bGF0ZSIsImxlbmd0aCIsIm1lc3NhZ2UiLCJlcnJvckNvZGUiLCJjb2RlIiwiY2F0ZWdvcnkiLCJxdWVyeSIsInByb2R1Y3RzIiwiaWQiLCJwYXJhbXMiLCJmaW5kQnlJZCIsImRlbGV0ZSIsInNlbGxlclByb2R1Y3QiLCJmaW5kT25lQW5kRGVsZXRlIiwiY2hlY2tQcm9kdWN0T3duZXJTaGlwIiwiZm9yRWFjaCIsImNhdCIsInB1c2giLCJlcnIiLCJwdXQiLCJwcm9kdWN0SWQiLCJicmFuZCIsIm5vdEZvdW5kVmFyaWFibGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvcm91dGVzLyIsInNvdXJjZXMiOlsiUHJvZHVjdHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG11bHRlciBmcm9tIFwibXVsdGVyXCI7XG5pbXBvcnQgcGF0aCBmcm9tIFwicGF0aFwiO1xuaW1wb3J0IFByb2R1Y3RzIGZyb20gXCIuLi9kYi9wcm9kdWN0c1wiO1xuaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuLi9lcnJvcnMvQXBpRXJyb3JcIjtcbmltcG9ydCB7IG5vdEZvdW5kVmFyaWFibGUgfSBmcm9tIFwiLi4vaGVscGVycy9DaGVja0V4aXN0ZW5jZVwiO1xuaW1wb3J0IHtcbiAgY2hlY2tQZXJtaXNzaW9ucyxcbiAgY2hlY2tQcm9kdWN0T3duZXJTaGlwLFxufSBmcm9tIFwiLi4vaGVscGVycy9QZXJtaXNzaW9uc1wiO1xuaW1wb3J0IFNlc3Npb24gZnJvbSBcIi4uL21pZGRsZXdhcmVzL1Nlc3Npb25cIjtcblxuY29uc3QgdXBsb2FkID0gbXVsdGVyKHtcbiAgc3RvcmFnZTogbXVsdGVyLmRpc2tTdG9yYWdlKHtcbiAgICBkZXN0aW5hdGlvbjogKHJlcSwgZmlsZSwgY2IpID0+IHtcbiAgICAgIGNiKG51bGwsIFwicHVibGljL2ltYWdlc1wiKTtcbiAgICB9LFxuICAgIGZpbGVuYW1lOiAocmVxLCBmaWxlLCBjYikgPT4ge1xuICAgICAgY29uc3Qgb3JpZ2luYWxOYW1lID0gZmlsZS5vcmlnaW5hbG5hbWU7XG4gICAgICBjYihudWxsLCBvcmlnaW5hbE5hbWUpO1xuICAgIH0sXG4gIH0pLFxuICBmaWxlRmlsdGVyOiAocmVxLCBmaWxlLCBjYikgPT4ge1xuICAgIGNvbnN0IGZpbGVUeXBlcyA9IC9qcGVnfGpwZ3xwbmcvO1xuXG4gICAgY29uc3QgZXh0bmFtZSA9IGZpbGVUeXBlcy50ZXN0KFxuICAgICAgcGF0aC5leHRuYW1lKGZpbGUub3JpZ2luYWxuYW1lKS50b0xvd2VyQ2FzZSgpXG4gICAgKTtcblxuICAgIGNvbnN0IG1pbWV0eXBlID0gZmlsZVR5cGVzLnRlc3QoZmlsZS5taW1ldHlwZSk7XG5cbiAgICBpZiAobWltZXR5cGUgJiYgZXh0bmFtZSkge1xuICAgICAgcmV0dXJuIGNiKG51bGwsIHRydWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjYihcbiAgICAgICAgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIFwiSW52YWxpZCBmaWxlIHR5cGUuIE9ubHkgSlBFRywgSlBHLCBhbmQgUE5HIGFyZSBhbGxvd2VkLlwiLFxuICAgICAgICAgIDQwMCxcbiAgICAgICAgICBcIkludmFsaWRGaWxlVHlwZVwiXG4gICAgICAgIClcbiAgICAgICk7XG4gICAgfVxuICB9LFxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IChyb3V0ZXIpID0+IHtcbiAgcm91dGVyLnBvc3QoXG4gICAgXCIvY3JlYXRlLXByb2R1Y3RcIixcbiAgICBTZXNzaW9uLFxuICAgIHVwbG9hZC5hcnJheShcImltYWdlc1wiLCAxMCksXG4gICAgYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgICBjaGVja1Blcm1pc3Npb25zKHJlcS51c2VyLCBbXCJhZG1pblwiLCBcInNlbGxlclwiXSk7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCB7IG5hbWUsIGNhdGVnb3JpZXMsIGRlZmluaXRpb24sIHByaWNlLCBzdG9jayB9ID0gcmVxLmJvZHk7XG4gICAgICAgIGNvbnN0IGltYWdlUGF0aHMgPSByZXEuZmlsZXMubWFwKChmaWxlKSA9PiBmaWxlLnBhdGgpO1xuICAgICAgICBjb25zdCBzZWxsZXJJZCA9IHJlcS51c2VyLl9pZDtcblxuICAgICAgICBjb25zdCBwcm9kdWN0ID0gbmV3IFByb2R1Y3RzKHtcbiAgICAgICAgICBuYW1lLFxuICAgICAgICAgIGltYWdlczogaW1hZ2VQYXRocyxcbiAgICAgICAgICBjYXRlZ29yaWVzLFxuICAgICAgICAgIHNlbGxlcjogc2VsbGVySWQsXG4gICAgICAgICAgZGVmaW5pdGlvbixcbiAgICAgICAgICBwcmljZSxcbiAgICAgICAgICBzdG9jayxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgYXdhaXQgcHJvZHVjdC5zYXZlKCk7XG4gICAgICAgIHJlcy5zdGF0dXMoMjAxKS5qc29uKHByb2R1Y3QpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICBuZXh0KFxuICAgICAgICAgIG5ldyBBcGlFcnJvcihcIlByb2R1Y3QgY291bGQgbm90IGJlIGFkZGVkXCIsIDQwMSwgXCJEb2VzTm90QWRkZWRQcm9kdWN0XCIpXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICApO1xuXG4gIHJvdXRlci5nZXQoXCIvZ2V0LWFsbC1wcm9kdWN0c1wiLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgZ2V0QWxsUHJvZHVjdHMgPSBhd2FpdCBQcm9kdWN0cy5maW5kKCkucG9wdWxhdGUoXCJzZWxsZXJcIik7XG5cbiAgICAgIGlmIChnZXRBbGxQcm9kdWN0cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIFwiVGhlcmUgYXJlIG5vIHByb2R1Y3RzIGF2YWlsYWJsZVwiLFxuICAgICAgICAgIDQwNCxcbiAgICAgICAgICBcIm5vRmluZFByb2R1Y3RcIlxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbihnZXRBbGxQcm9kdWN0cyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIEhhdGEgQXBpRXJyb3IgaXNlLCBoYXRhIGtvZHVudSB2ZSBtZXNhasSxbsSxIGt1bGxhblxuICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgQXBpRXJyb3IpIHtcbiAgICAgICAgcmVzLnN0YXR1cyhlcnJvci5zdGF0dXMpLmpzb24oe1xuICAgICAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXG4gICAgICAgICAgZXJyb3JDb2RlOiBlcnJvci5jb2RlLFxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEXEn2VyIGhhdGEgQXBpRXJyb3IgZGXEn2lsc2UsIGdlbmVsIGJpciBoYXRhIG1lc2FqxLEgZMO2bmTDvHJcbiAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgICAgICAgIG1lc3NhZ2U6IFwiQW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnJlZFwiLFxuICAgICAgICAgIGVycm9yQ29kZTogXCJJbnRlcm5hbFNlcnZlckVycm9yXCIsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgcm91dGVyLmdldChcIi9nZXQtcHJvZHVjdHMtYnktY2F0ZWdvcnlcIiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgY2F0ZWdvcnkgPSByZXEucXVlcnkuY2F0ZWdvcnk7XG4gICAgaWYgKCFjYXRlZ29yeSkge1xuICAgICAgcmV0dXJuIHJlc1xuICAgICAgICAuc3RhdHVzKDQwMClcbiAgICAgICAgLmpzb24obmV3IEFwaUVycm9yKFwiQ2F0ZWdvcnkgaXMgcmVxdWlyZWRcIiwgNDAxLCBcIlJlcXVpcmVkQ2F0ZWdvcnlcIikpO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBwcm9kdWN0cyA9IGF3YWl0IFByb2R1Y3RzLmZpbmQoe1xuICAgICAgICBjYXRlZ29yaWVzOiBjYXRlZ29yeSxcbiAgICAgIH0pLnBvcHVsYXRlKFwic2VsbGVyXCIpO1xuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24ocHJvZHVjdHMpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgIHJlc1xuICAgICAgICAuc3RhdHVzKDUwMClcbiAgICAgICAgLmpzb24oXG4gICAgICAgICAgbmV3IEFwaUVycm9yKFxuICAgICAgICAgICAgXCJQcm9kdWN0cyBjYW5ub3QgYmUgcmV0cmlldmVkIGJ5IGNhdGVnb3J5XCIsXG4gICAgICAgICAgICA0MDEsXG4gICAgICAgICAgICBcIkNhbm5vdEdldFByb2R1Y3RzQnlDYXRlZ29yeVwiXG4gICAgICAgICAgKVxuICAgICAgICApO1xuICAgIH1cbiAgfSk7XG5cbiAgcm91dGVyLmdldChcIi9nZXQtcHJvZHVjdC1ieS1pZC86aWRcIiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyBpZCB9ID0gcmVxLnBhcmFtcztcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBwcm9kdWN0ID0gYXdhaXQgUHJvZHVjdHMuZmluZEJ5SWQoaWQpLnBvcHVsYXRlKFwic2VsbGVyXCIpO1xuICAgICAgaWYgKCFwcm9kdWN0KSB7XG4gICAgICAgIHJldHVybiByZXNcbiAgICAgICAgICAuc3RhdHVzKDQwNClcbiAgICAgICAgICAuanNvbihuZXcgQXBpRXJyb3IoXCJQcm9kdWN0IG5vdCBmb3VuZFwiLCA0MDQsIFwiUHJvZHVjdE5vdEZvdW5kXCIpKTtcbiAgICAgIH1cbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHByb2R1Y3QpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgIHJlc1xuICAgICAgICAuc3RhdHVzKDUwMClcbiAgICAgICAgLmpzb24oXG4gICAgICAgICAgbmV3IEFwaUVycm9yKFwiUHJvZHVjdCBjYW5ub3QgYmUgcmV0cmlldmVkXCIsIDUwMCwgXCJDYW5ub3RHZXRQcm9kdWN0XCIpXG4gICAgICAgICk7XG4gICAgfVxuICB9KTtcblxuICByb3V0ZXIuZGVsZXRlKFwiL2RlbGV0ZS1wcm9kdWN0LzppZFwiLCBTZXNzaW9uLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICBjb25zdCBpZCA9IHJlcS5wYXJhbXMuaWQ7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHNlbGxlclByb2R1Y3QgPSBhd2FpdCBQcm9kdWN0cy5maW5kQnlJZChpZCk7XG5cbiAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBQcm9kdWN0cy5maW5kT25lQW5kRGVsZXRlKHsgX2lkOiBpZCB9KTtcbiAgICAgIGNoZWNrUHJvZHVjdE93bmVyU2hpcChyZXEudXNlciwgcHJvZHVjdCk7XG5cbiAgICAgIGlmIChwcm9kdWN0KSB7XG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKGBQcm9kdWN0IG51bWJlciAke2lkfSB3YXMgZGVsZXRlZGApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzLnN0YXR1cyg0MDQpLmpzb24oYFByb2R1Y3Qgd2l0aCBJRCAke2lkfSBub3QgZm91bmRgKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgcmVzXG4gICAgICAgIC5zdGF0dXMoNTAwKVxuICAgICAgICAuanNvbihcbiAgICAgICAgICBuZXcgQXBpRXJyb3IoXCJDYW5ub3QgZGVsZXRlIHByb2R1Y3RcIiwgNDAxLCBcImNhbm5vdERlbGV0ZVByb2R1Y3RcIilcbiAgICAgICAgKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJvdXRlci5nZXQoXCIvZ2V0LWNhdGVnb3JpZXNcIiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgUHJvZHVjdHMuZmluZCh7fSk7XG4gICAgICBjb25zdCBjYXRlZ29yaWVzID0ge307XG5cbiAgICAgIHByb2R1Y3RzLmZvckVhY2goKHByb2R1Y3QpID0+IHtcbiAgICAgICAgcHJvZHVjdC5jYXRlZ29yaWVzLmZvckVhY2goKGNhdCkgPT4ge1xuICAgICAgICAgIGlmICghY2F0ZWdvcmllc1tjYXRdKSB7XG4gICAgICAgICAgICBjYXRlZ29yaWVzW2NhdF0gPSBbXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY2F0ZWdvcmllc1tjYXRdLnB1c2gocHJvZHVjdCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIHJlcy5qc29uKGNhdGVnb3JpZXMpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgcmVzXG4gICAgICAgIC5zdGF0dXMoNTAwKVxuICAgICAgICAuanNvbihcbiAgICAgICAgICBuZXcgQXBpRXJyb3IoXCJDYW5ub3QgZ2V0IGNhdGVnb3JpZXNcIiwgNDAxLCBcImNhbm5vdEdldENhdGVnb3JpZXNcIilcbiAgICAgICAgKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJvdXRlci5wdXQoXG4gICAgXCIvdXBkYXRlLXByb2R1Y3QvOmlkXCIsXG4gICAgU2Vzc2lvbixcbiAgICB1cGxvYWQuYXJyYXkoXCJpbWFnZXNcIiwgMTApLFxuICAgIGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgICAgY2hlY2tQZXJtaXNzaW9ucyhyZXEudXNlciwgW1wiYWRtaW5cIiwgXCJzZWxsZXJcIl0pO1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcHJvZHVjdElkID0gcmVxLnBhcmFtcy5pZDtcbiAgICAgICAgY29uc3QgeyBuYW1lLCBjYXRlZ29yaWVzLCBicmFuZCwgZGVmaW5pdGlvbiwgcHJpY2UsIHN0b2NrIH0gPSByZXEuYm9keTtcbiAgICAgICAgY29uc3QgaW1hZ2VQYXRocyA9IHJlcS5maWxlcy5tYXAoKGZpbGUpID0+IGZpbGUucGF0aCk7XG5cbiAgICAgICAgY29uc3QgcHJvZHVjdCA9IGF3YWl0IFByb2R1Y3RzLmZpbmRCeUlkKHByb2R1Y3RJZCk7XG5cbiAgICAgICAgbm90Rm91bmRWYXJpYWJsZShwcm9kdWN0LCBcIlByb2R1Y3RcIik7XG5cbiAgICAgICAgY2hlY2tQcm9kdWN0T3duZXJTaGlwKHJlcS51c2VyLCBwcm9kdWN0KTtcblxuICAgICAgICBpZiAobmFtZSkgcHJvZHVjdC5uYW1lID0gbmFtZTtcbiAgICAgICAgaWYgKGNhdGVnb3JpZXMpIHByb2R1Y3QuY2F0ZWdvcmllcyA9IGNhdGVnb3JpZXM7XG4gICAgICAgIGlmIChicmFuZCkgcHJvZHVjdC5icmFuZCA9IGJyYW5kO1xuICAgICAgICBpZiAoZGVmaW5pdGlvbikgcHJvZHVjdC5kZWZpbml0aW9uID0gZGVmaW5pdGlvbjtcbiAgICAgICAgaWYgKHByaWNlKSBwcm9kdWN0LnByaWNlID0gcHJpY2U7XG4gICAgICAgIGlmIChzdG9jaykgcHJvZHVjdC5zdG9jayA9IHN0b2NrO1xuXG4gICAgICAgIGlmIChyZXEuZmlsZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHByb2R1Y3QuaW1hZ2VzID0gaW1hZ2VQYXRocztcbiAgICAgICAgfVxuXG4gICAgICAgIGF3YWl0IHByb2R1Y3Quc2F2ZSgpO1xuXG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHByb2R1Y3QpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICBuZXh0KFxuICAgICAgICAgIG5ldyBBcGlFcnJvcihcbiAgICAgICAgICAgIFwiUHJvZHVjdCBjb3VsZCBub3QgYmUgdXBkYXRlZFwiLFxuICAgICAgICAgICAgNDAwLFxuICAgICAgICAgICAgXCJEb2VzTm90VXBkYXRlZFByb2R1Y3RcIlxuICAgICAgICAgIClcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG4gICk7XG59O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxPQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxLQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxTQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRyxTQUFBLEdBQUFKLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSSxlQUFBLEdBQUFKLE9BQUE7QUFDQSxJQUFBSyxZQUFBLEdBQUFMLE9BQUE7QUFJQSxJQUFBTSxRQUFBLEdBQUFQLHNCQUFBLENBQUFDLE9BQUE7QUFBNkMsU0FBQUQsdUJB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","map":{"version":3,"names":["_multer","_interopRequireDefault","require","_path","_products","_ApiError","_CheckExistence","_Permissions","_Session","e","__esModule","default","upload","multer","storage","diskStorage","destination","req","file","cb","filename","originalName","originalname","fileFilter","fileTypes","extname","test","path","toLowerCase","mimetype","ApiError","_default","router","post","Session","array","res","next","checkPermissions","user","name","categories","definition","price","stock","body","imagePaths","files","map","sellerId","_id","product","Products","images","seller","save","status","json","error","console","log","get","getAllProducts","find","populate","length","message","errorCode","code","category","query","products","id","params","findById","delete","sellerProduct","findOneAndDelete","checkProductOwnerShip","forEach","cat","push","err","put","productId","brand","notFoundVariable","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["Products.js"],"sourcesContent":["import multer from \"multer\";\nimport path from \"path\";\nimport Products from \"../db/products\";\nimport ApiError from \"../errors/ApiError\";\nimport { notFoundVariable } from \"../helpers/CheckExistence\";\nimport {\n  checkPermissions,\n  checkProductOwnerShip,\n} from \"../helpers/Permissions\";\nimport Session from \"../middlewares/Session\";\n\nconst upload = multer({\n  storage: multer.diskStorage({\n    destination: (req, file, cb) => {\n      cb(null, \"public/images\");\n    },\n    filename: (req, file, cb) => {\n      const originalName = file.originalname;\n      cb(null, originalName);\n    },\n  }),\n  fileFilter: (req, file, cb) => {\n    const fileTypes = /jpeg|jpg|png/;\n\n    const extname = fileTypes.test(\n      path.extname(file.originalname).toLowerCase()\n    );\n\n    const mimetype = fileTypes.test(file.mimetype);\n\n    if (mimetype && extname) {\n      return cb(null, true);\n    } else {\n      cb(\n        new ApiError(\n          \"Invalid file type. Only JPEG, JPG, and PNG are allowed.\",\n          400,\n          \"InvalidFileType\"\n        )\n      );\n    }\n  },\n});\n\nexport default (router) => {\n  router.post(\n    \"/create-product\",\n    Session,\n    upload.array(\"images\", 10),\n    async (req, res, next) => {\n      checkPermissions(req.user, [\"admin\", \"seller\"]);\n      try {\n        const { name, categories, definition, price, stock } = req.body;\n        const imagePaths = req.files.map((file) => file.path);\n        const sellerId = req.user._id;\n\n        const product = new Products({\n          name,\n          images: imagePaths,\n          categories,\n          seller: sellerId,\n          definition,\n          price,\n          stock,\n        });\n\n        await product.save();\n        res.status(201).json(product);\n      } catch (error) {\n        console.log(error);\n        next(\n          new ApiError(\"Product could not be added\", 401, \"DoesNotAddedProduct\")\n        );\n      }\n    }\n  );\n\n  router.get(\"/get-all-products\", async (req, res) => {\n    try {\n      const getAllProducts = await Products.find().populate(\"seller\");\n\n      if (getAllProducts.length === 0) {\n        throw new ApiError(\n          \"There are no products available\",\n          404,\n          \"noFindProduct\"\n        );\n      }\n\n      res.status(200).json(getAllProducts);\n    } catch (error) {\n      // Hata ApiError ise, hata kodunu ve mesajını kullan\n      if (error instanceof ApiError) {\n        res.status(error.status).json({\n          message: error.message,\n          errorCode: error.code,\n        });\n      } else {\n        // Eğer hata ApiError değilse, genel bir hata mesajı döndür\n        res.status(500).json({\n          message: \"An unexpected error occurred\",\n          errorCode: \"InternalServerError\",\n        });\n      }\n    }\n  });\n\n  router.get(\"/get-products-by-category\", async (req, res) => {\n    const category = req.query.category;\n    if (!category) {\n      return res\n        .status(400)\n        .json(new ApiError(\"Category is required\", 401, \"RequiredCategory\"));\n    }\n\n    try {\n      const products = await Products.find({\n        categories: category,\n      }).populate(\"seller\");\n      res.status(200).json(products);\n    } catch (error) {\n      console.error(error);\n      res\n        .status(500)\n        .json(\n          new ApiError(\n            \"Products cannot be retrieved by category\",\n            401,\n            \"CannotGetProductsByCategory\"\n          )\n        );\n    }\n  });\n\n  router.get(\"/get-product-by-id/:id\", async (req, res) => {\n    const { id } = req.params;\n\n    try {\n      const product = await Products.findById(id).populate(\"seller\");\n      if (!product) {\n        return res\n          .status(404)\n          .json(new ApiError(\"Product not found\", 404, \"ProductNotFound\"));\n      }\n      res.status(200).json(product);\n    } catch (error) {\n      console.error(error);\n      res\n        .status(500)\n        .json(\n          new ApiError(\"Product cannot be retrieved\", 500, \"CannotGetProduct\")\n        );\n    }\n  });\n\n  router.delete(\"/delete-product/:id\", Session, async (req, res) => {\n    const id = req.params.id;\n    try {\n      const sellerProduct = await Products.findById(id);\n\n      const product = await Products.findOneAndDelete({ _id: id });\n      checkProductOwnerShip(req.user, product);\n\n      if (product) {\n        res.status(200).json(`Product number ${id} was deleted`);\n      } else {\n        res.status(404).json(`Product with ID ${id} not found`);\n      }\n    } catch (error) {\n      console.log(error);\n      res\n        .status(500)\n        .json(\n          new ApiError(\"Cannot delete product\", 401, \"cannotDeleteProduct\")\n        );\n    }\n  });\n\n  router.get(\"/get-categories\", async (req, res) => {\n    try {\n      const products = await Products.find({});\n      const categories = {};\n\n      products.forEach((product) => {\n        product.categories.forEach((cat) => {\n          if (!categories[cat]) {\n            categories[cat] = [];\n          }\n          categories[cat].push(product);\n        });\n      });\n\n      res.json(categories);\n    } catch (err) {\n      console.error(err);\n      res\n        .status(500)\n        .json(\n          new ApiError(\"Cannot get categories\", 401, \"cannotGetCategories\")\n        );\n    }\n  });\n\n  router.put(\n    \"/update-product/:id\",\n    Session,\n    upload.array(\"images\", 10),\n    async (req, res, next) => {\n      checkPermissions(req.user, [\"admin\", \"seller\"]);\n      try {\n        const productId = req.params.id;\n        const { name, categories, brand, definition, price, stock } = req.body;\n        const imagePaths = req.files.map((file) => file.path);\n\n        const product = await Products.findById(productId);\n\n        notFoundVariable(product, \"Product\");\n\n        checkProductOwnerShip(req.user, product);\n\n        if (name) product.name = name;\n        if (categories) product.categories = categories;\n        if (brand) product.brand = brand;\n        if (definition) product.definition = definition;\n        if (price) product.price = price;\n        if (stock) product.stock = stock;\n\n        if (req.files.length > 0) {\n          product.images = imagePaths;\n        }\n\n        await product.save();\n\n        res.status(200).json(product);\n      } catch (error) {\n        console.log(error);\n        next(\n          new ApiError(\n            \"Product could not be updated\",\n            400,\n            \"DoesNotUpdatedProduct\"\n          )\n        );\n      }\n    }\n  );\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1731316713756},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/Products.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _multer = _interopRequireDefault(require(\"multer\"));\nvar _path = _interopRequireDefault(require(\"path\"));\nvar _products = _interopRequireDefault(require(\"../db/products\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _CheckExistence = require(\"../helpers/CheckExistence\");\nvar _Permissions = require(\"../helpers/Permissions\");\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst upload = (0, _multer.default)({\n  storage: _multer.default.diskStorage({\n    destination: (req, file, cb) => {\n      cb(null, \"public/images\");\n    },\n    filename: (req, file, cb) => {\n      const originalName = file.originalname;\n      cb(null, originalName);\n    }\n  }),\n  fileFilter: (req, file, cb) => {\n    const fileTypes = /jpeg|jpg|png/;\n    const extname = fileTypes.test(_path.default.extname(file.originalname).toLowerCase());\n    const mimetype = fileTypes.test(file.mimetype);\n    if (mimetype && extname) {\n      return cb(null, true);\n    } else {\n      cb(new _ApiError.default(\"Invalid file type. Only JPEG, JPG, and PNG are allowed.\", 400, \"InvalidFileType\"));\n    }\n  }\n});\nvar _default = router => {\n  router.post(\"/create-product\", _Session.default, upload.array(\"images\", 10), async (req, res, next) => {\n    (0, _Permissions.checkPermissions)(req.user, [\"admin\", \"seller\"]);\n    try {\n      const {\n        name,\n        categories,\n        definition,\n        price,\n        stock\n      } = req.body;\n      const imagePaths = req.files.map(file => file.path);\n      const sellerId = req.user._id;\n      const product = new _products.default({\n        name,\n        images: imagePaths,\n        categories,\n        seller: sellerId,\n        definition,\n        price,\n        stock\n      });\n      await product.save();\n      res.status(201).json(product);\n    } catch (error) {\n      console.log(error);\n      next(new _ApiError.default(\"Product could not be added\", 401, \"DoesNotAddedProduct\"));\n    }\n  });\n  router.get(\"/get-all-products\", async (req, res) => {\n    try {\n      const getAllProducts = await _products.default.find().populate(\"seller\");\n      if (getAllProducts.length === 0) {\n        throw new _ApiError.default(\"There are no products available\", 404, \"noFindProduct\");\n      }\n      res.status(200).json(getAllProducts);\n    } catch (error) {\n      // Hata ApiError ise, hata kodunu ve mesajını kullan\n      if (error instanceof _ApiError.default) {\n        res.status(error.status).json({\n          message: error.message,\n          errorCode: error.code\n        });\n      } else {\n        // Eğer hata ApiError değilse, genel bir hata mesajı döndür\n        res.status(500).json({\n          message: \"An unexpected error occurred\",\n          errorCode: \"InternalServerError\"\n        });\n      }\n    }\n  });\n  router.get(\"/get-products-by-category\", async (req, res) => {\n    const category = req.query.category;\n    if (!category) {\n      return res.status(400).json(new _ApiError.default(\"Category is required\", 401, \"RequiredCategory\"));\n    }\n    try {\n      const products = await _products.default.find({\n        categories: category\n      }).populate(\"seller\");\n      res.status(200).json(products);\n    } catch (error) {\n      console.error(error);\n      res.status(500).json(new _ApiError.default(\"Products cannot be retrieved by category\", 401, \"CannotGetProductsByCategory\"));\n    }\n  });\n  router.get(\"/get-product-by-id/:id\", async (req, res) => {\n    const {\n      id\n    } = req.params;\n    try {\n      const product = await _products.default.findById(id).populate(\"seller\");\n      if (!product) {\n        return res.status(404).json(new _ApiError.default(\"Product not found\", 404, \"ProductNotFound\"));\n      }\n      res.status(200).json(product);\n    } catch (error) {\n      console.error(error);\n      res.status(500).json(new _ApiError.default(\"Product cannot be retrieved\", 500, \"CannotGetProduct\"));\n    }\n  });\n  router.delete(\"/delete-product/:id\", _Session.default, async (req, res) => {\n    const id = req.params.id;\n    try {\n      const sellerProduct = await _products.default.findById(id);\n      const product = await _products.default.findOneAndDelete({\n        _id: id\n      });\n      (0, _Permissions.checkProductOwnerShip)(req.user, product);\n      if (product) {\n        res.status(200).json(`Product number ${id} was deleted`);\n      } else {\n        res.status(404).json(`Product with ID ${id} not found`);\n      }\n    } catch (error) {\n      console.log(error);\n      res.status(500).json(new _ApiError.default(\"Cannot delete product\", 401, \"cannotDeleteProduct\"));\n    }\n  });\n  router.get(\"/get-categories\", async (req, res) => {\n    try {\n      const products = await _products.default.find({});\n      const categories = {};\n      products.forEach(product => {\n        product.categories.forEach(cat => {\n          if (!categories[cat]) {\n            categories[cat] = [];\n          }\n          categories[cat].push(product);\n        });\n      });\n      res.json(categories);\n    } catch (err) {\n      console.error(err);\n      res.status(500).json(new _ApiError.default(\"Cannot get categories\", 401, \"cannotGetCategories\"));\n    }\n  });\n  router.put(\"/update-product/:id\", _Session.default, upload.array(\"images\", 10), async (req, res, next) => {\n    (0, _Permissions.checkPermissions)(req.user, [\"admin\", \"seller\"]);\n    try {\n      const productId = req.params.id;\n      const {\n        name,\n        categories,\n        brand,\n        definition,\n        price,\n        stock\n      } = req.body;\n      const imagePaths = req.files.map(file => file.path);\n      const product = await _products.default.findById(productId);\n      (0, _CheckExistence.notFoundVariable)(product, \"Product\");\n      (0, _Permissions.checkProductOwnerShip)(req.user, product);\n      if (name) product.name = name;\n      if (categories) product.categories = categories;\n      if (brand) product.brand = brand;\n      if (definition) product.definition = definition;\n      if (price) product.price = price;\n      if (stock) product.stock = stock;\n      if (req.files.length > 0) {\n        product.images = imagePaths;\n      }\n      await product.save();\n      res.status(200).json(product);\n    } catch (error) {\n      console.log(error);\n      next(new _ApiError.default(\"Product could not be updated\", 400, \"DoesNotUpdatedProduct\"));\n    }\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbXVsdGVyIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfcGF0aCIsIl9wcm9kdWN0cyIsIl9BcGlFcnJvciIsIl9DaGVja0V4aXN0ZW5jZSIsIl9QZXJtaXNzaW9ucyIsIl9TZXNzaW9uIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwidXBsb2FkIiwibXVsdGVyIiwic3RvcmFnZSIsImRpc2tTdG9yYWdlIiwiZGVzdGluYXRpb24iLCJyZXEiLCJmaWxlIiwiY2IiLCJmaWxlbmFtZSIsIm9yaWdpbmFsTmFtZSIsIm9yaWdpbmFsbmFtZSIsImZpbGVGaWx0ZXIiLCJmaWxlVHlwZXMiLCJleHRuYW1lIiwidGVzdCIsInBhdGgiLCJ0b0xvd2VyQ2FzZSIsIm1pbWV0eXBlIiwiQXBpRXJyb3IiLCJfZGVmYXVsdCIsInJvdXRlciIsInBvc3QiLCJTZXNzaW9uIiwiYXJyYXkiLCJyZXMiLCJuZXh0IiwiY2hlY2tQZXJtaXNzaW9ucyIsInVzZXIiLCJuYW1lIiwiY2F0ZWdvcmllcyIsImRlZmluaXRpb24iLCJwcmljZSIsInN0b2NrIiwiYm9keSIsImltYWdlUGF0aHMiLCJmaWxlcyIsIm1hcCIsInNlbGxlcklkIiwiX2lkIiwicHJvZHVjdCIsIlByb2R1Y3RzIiwiaW1hZ2VzIiwic2VsbGVyIiwic2F2ZSIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJnZXQiLCJnZXRBbGxQcm9kdWN0cyIsImZpbmQiLCJwb3B1bGF0ZSIsImxlbmd0aCIsIm1lc3NhZ2UiLCJlcnJvckNvZGUiLCJjb2RlIiwiY2F0ZWdvcnkiLCJxdWVyeSIsInByb2R1Y3RzIiwiaWQiLCJwYXJhbXMiLCJmaW5kQnlJZCIsImRlbGV0ZSIsInNlbGxlclByb2R1Y3QiLCJmaW5kT25lQW5kRGVsZXRlIiwiY2hlY2tQcm9kdWN0T3duZXJTaGlwIiwiZm9yRWFjaCIsImNhdCIsInB1c2giLCJlcnIiLCJwdXQiLCJwcm9kdWN0SWQiLCJicmFuZCIsIm5vdEZvdW5kVmFyaWFibGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvcm91dGVzLyIsInNvdXJjZXMiOlsiUHJvZHVjdHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG11bHRlciBmcm9tIFwibXVsdGVyXCI7XG5pbXBvcnQgcGF0aCBmcm9tIFwicGF0aFwiO1xuaW1wb3J0IFByb2R1Y3RzIGZyb20gXCIuLi9kYi9wcm9kdWN0c1wiO1xuaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuLi9lcnJvcnMvQXBpRXJyb3JcIjtcbmltcG9ydCB7IG5vdEZvdW5kVmFyaWFibGUgfSBmcm9tIFwiLi4vaGVscGVycy9DaGVja0V4aXN0ZW5jZVwiO1xuaW1wb3J0IHtcbiAgY2hlY2tQZXJtaXNzaW9ucyxcbiAgY2hlY2tQcm9kdWN0T3duZXJTaGlwLFxufSBmcm9tIFwiLi4vaGVscGVycy9QZXJtaXNzaW9uc1wiO1xuaW1wb3J0IFNlc3Npb24gZnJvbSBcIi4uL21pZGRsZXdhcmVzL1Nlc3Npb25cIjtcblxuY29uc3QgdXBsb2FkID0gbXVsdGVyKHtcbiAgc3RvcmFnZTogbXVsdGVyLmRpc2tTdG9yYWdlKHtcbiAgICBkZXN0aW5hdGlvbjogKHJlcSwgZmlsZSwgY2IpID0+IHtcbiAgICAgIGNiKG51bGwsIFwicHVibGljL2ltYWdlc1wiKTtcbiAgICB9LFxuICAgIGZpbGVuYW1lOiAocmVxLCBmaWxlLCBjYikgPT4ge1xuICAgICAgY29uc3Qgb3JpZ2luYWxOYW1lID0gZmlsZS5vcmlnaW5hbG5hbWU7XG4gICAgICBjYihudWxsLCBvcmlnaW5hbE5hbWUpO1xuICAgIH0sXG4gIH0pLFxuICBmaWxlRmlsdGVyOiAocmVxLCBmaWxlLCBjYikgPT4ge1xuICAgIGNvbnN0IGZpbGVUeXBlcyA9IC9qcGVnfGpwZ3xwbmcvO1xuXG4gICAgY29uc3QgZXh0bmFtZSA9IGZpbGVUeXBlcy50ZXN0KFxuICAgICAgcGF0aC5leHRuYW1lKGZpbGUub3JpZ2luYWxuYW1lKS50b0xvd2VyQ2FzZSgpXG4gICAgKTtcblxuICAgIGNvbnN0IG1pbWV0eXBlID0gZmlsZVR5cGVzLnRlc3QoZmlsZS5taW1ldHlwZSk7XG5cbiAgICBpZiAobWltZXR5cGUgJiYgZXh0bmFtZSkge1xuICAgICAgcmV0dXJuIGNiKG51bGwsIHRydWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjYihcbiAgICAgICAgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIFwiSW52YWxpZCBmaWxlIHR5cGUuIE9ubHkgSlBFRywgSlBHLCBhbmQgUE5HIGFyZSBhbGxvd2VkLlwiLFxuICAgICAgICAgIDQwMCxcbiAgICAgICAgICBcIkludmFsaWRGaWxlVHlwZVwiXG4gICAgICAgIClcbiAgICAgICk7XG4gICAgfVxuICB9LFxufSk7XG5cbmV4cG9ydCBkZWZhdWx0IChyb3V0ZXIpID0+IHtcbiAgcm91dGVyLnBvc3QoXG4gICAgXCIvY3JlYXRlLXByb2R1Y3RcIixcbiAgICBTZXNzaW9uLFxuICAgIHVwbG9hZC5hcnJheShcImltYWdlc1wiLCAxMCksXG4gICAgYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgICBjaGVja1Blcm1pc3Npb25zKHJlcS51c2VyLCBbXCJhZG1pblwiLCBcInNlbGxlclwiXSk7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCB7IG5hbWUsIGNhdGVnb3JpZXMsIGRlZmluaXRpb24sIHByaWNlLCBzdG9jayB9ID0gcmVxLmJvZHk7XG4gICAgICAgIGNvbnN0IGltYWdlUGF0aHMgPSByZXEuZmlsZXMubWFwKChmaWxlKSA9PiBmaWxlLnBhdGgpO1xuICAgICAgICBjb25zdCBzZWxsZXJJZCA9IHJlcS51c2VyLl9pZDtcblxuICAgICAgICBjb25zdCBwcm9kdWN0ID0gbmV3IFByb2R1Y3RzKHtcbiAgICAgICAgICBuYW1lLFxuICAgICAgICAgIGltYWdlczogaW1hZ2VQYXRocyxcbiAgICAgICAgICBjYXRlZ29yaWVzLFxuICAgICAgICAgIHNlbGxlcjogc2VsbGVySWQsXG4gICAgICAgICAgZGVmaW5pdGlvbixcbiAgICAgICAgICBwcmljZSxcbiAgICAgICAgICBzdG9jayxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgYXdhaXQgcHJvZHVjdC5zYXZlKCk7XG4gICAgICAgIHJlcy5zdGF0dXMoMjAxKS5qc29uKHByb2R1Y3QpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICBuZXh0KFxuICAgICAgICAgIG5ldyBBcGlFcnJvcihcIlByb2R1Y3QgY291bGQgbm90IGJlIGFkZGVkXCIsIDQwMSwgXCJEb2VzTm90QWRkZWRQcm9kdWN0XCIpXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICApO1xuXG4gIHJvdXRlci5nZXQoXCIvZ2V0LWFsbC1wcm9kdWN0c1wiLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgZ2V0QWxsUHJvZHVjdHMgPSBhd2FpdCBQcm9kdWN0cy5maW5kKCkucG9wdWxhdGUoXCJzZWxsZXJcIik7XG5cbiAgICAgIGlmIChnZXRBbGxQcm9kdWN0cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIFwiVGhlcmUgYXJlIG5vIHByb2R1Y3RzIGF2YWlsYWJsZVwiLFxuICAgICAgICAgIDQwNCxcbiAgICAgICAgICBcIm5vRmluZFByb2R1Y3RcIlxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbihnZXRBbGxQcm9kdWN0cyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIC8vIEhhdGEgQXBpRXJyb3IgaXNlLCBoYXRhIGtvZHVudSB2ZSBtZXNhasSxbsSxIGt1bGxhblxuICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgQXBpRXJyb3IpIHtcbiAgICAgICAgcmVzLnN0YXR1cyhlcnJvci5zdGF0dXMpLmpzb24oe1xuICAgICAgICAgIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXG4gICAgICAgICAgZXJyb3JDb2RlOiBlcnJvci5jb2RlLFxuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIEXEn2VyIGhhdGEgQXBpRXJyb3IgZGXEn2lsc2UsIGdlbmVsIGJpciBoYXRhIG1lc2FqxLEgZMO2bmTDvHJcbiAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgICAgICAgIG1lc3NhZ2U6IFwiQW4gdW5leHBlY3RlZCBlcnJvciBvY2N1cnJlZFwiLFxuICAgICAgICAgIGVycm9yQ29kZTogXCJJbnRlcm5hbFNlcnZlckVycm9yXCIsXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgcm91dGVyLmdldChcIi9nZXQtcHJvZHVjdHMtYnktY2F0ZWdvcnlcIiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgY2F0ZWdvcnkgPSByZXEucXVlcnkuY2F0ZWdvcnk7XG4gICAgaWYgKCFjYXRlZ29yeSkge1xuICAgICAgcmV0dXJuIHJlc1xuICAgICAgICAuc3RhdHVzKDQwMClcbiAgICAgICAgLmpzb24obmV3IEFwaUVycm9yKFwiQ2F0ZWdvcnkgaXMgcmVxdWlyZWRcIiwgNDAxLCBcIlJlcXVpcmVkQ2F0ZWdvcnlcIikpO1xuICAgIH1cblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBwcm9kdWN0cyA9IGF3YWl0IFByb2R1Y3RzLmZpbmQoe1xuICAgICAgICBjYXRlZ29yaWVzOiBjYXRlZ29yeSxcbiAgICAgIH0pLnBvcHVsYXRlKFwic2VsbGVyXCIpO1xuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24ocHJvZHVjdHMpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgIHJlc1xuICAgICAgICAuc3RhdHVzKDUwMClcbiAgICAgICAgLmpzb24oXG4gICAgICAgICAgbmV3IEFwaUVycm9yKFxuICAgICAgICAgICAgXCJQcm9kdWN0cyBjYW5ub3QgYmUgcmV0cmlldmVkIGJ5IGNhdGVnb3J5XCIsXG4gICAgICAgICAgICA0MDEsXG4gICAgICAgICAgICBcIkNhbm5vdEdldFByb2R1Y3RzQnlDYXRlZ29yeVwiXG4gICAgICAgICAgKVxuICAgICAgICApO1xuICAgIH1cbiAgfSk7XG5cbiAgcm91dGVyLmdldChcIi9nZXQtcHJvZHVjdC1ieS1pZC86aWRcIiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyBpZCB9ID0gcmVxLnBhcmFtcztcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCBwcm9kdWN0ID0gYXdhaXQgUHJvZHVjdHMuZmluZEJ5SWQoaWQpLnBvcHVsYXRlKFwic2VsbGVyXCIpO1xuICAgICAgaWYgKCFwcm9kdWN0KSB7XG4gICAgICAgIHJldHVybiByZXNcbiAgICAgICAgICAuc3RhdHVzKDQwNClcbiAgICAgICAgICAuanNvbihuZXcgQXBpRXJyb3IoXCJQcm9kdWN0IG5vdCBmb3VuZFwiLCA0MDQsIFwiUHJvZHVjdE5vdEZvdW5kXCIpKTtcbiAgICAgIH1cbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHByb2R1Y3QpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgIHJlc1xuICAgICAgICAuc3RhdHVzKDUwMClcbiAgICAgICAgLmpzb24oXG4gICAgICAgICAgbmV3IEFwaUVycm9yKFwiUHJvZHVjdCBjYW5ub3QgYmUgcmV0cmlldmVkXCIsIDUwMCwgXCJDYW5ub3RHZXRQcm9kdWN0XCIpXG4gICAgICAgICk7XG4gICAgfVxuICB9KTtcblxuICByb3V0ZXIuZGVsZXRlKFwiL2RlbGV0ZS1wcm9kdWN0LzppZFwiLCBTZXNzaW9uLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICBjb25zdCBpZCA9IHJlcS5wYXJhbXMuaWQ7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHNlbGxlclByb2R1Y3QgPSBhd2FpdCBQcm9kdWN0cy5maW5kQnlJZChpZCk7XG5cbiAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBQcm9kdWN0cy5maW5kT25lQW5kRGVsZXRlKHsgX2lkOiBpZCB9KTtcbiAgICAgIGNoZWNrUHJvZHVjdE93bmVyU2hpcChyZXEudXNlciwgcHJvZHVjdCk7XG5cbiAgICAgIGlmIChwcm9kdWN0KSB7XG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKGBQcm9kdWN0IG51bWJlciAke2lkfSB3YXMgZGVsZXRlZGApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzLnN0YXR1cyg0MDQpLmpzb24oYFByb2R1Y3Qgd2l0aCBJRCAke2lkfSBub3QgZm91bmRgKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgcmVzXG4gICAgICAgIC5zdGF0dXMoNTAwKVxuICAgICAgICAuanNvbihcbiAgICAgICAgICBuZXcgQXBpRXJyb3IoXCJDYW5ub3QgZGVsZXRlIHByb2R1Y3RcIiwgNDAxLCBcImNhbm5vdERlbGV0ZVByb2R1Y3RcIilcbiAgICAgICAgKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJvdXRlci5nZXQoXCIvZ2V0LWNhdGVnb3JpZXNcIiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgUHJvZHVjdHMuZmluZCh7fSk7XG4gICAgICBjb25zdCBjYXRlZ29yaWVzID0ge307XG5cbiAgICAgIHByb2R1Y3RzLmZvckVhY2goKHByb2R1Y3QpID0+IHtcbiAgICAgICAgcHJvZHVjdC5jYXRlZ29yaWVzLmZvckVhY2goKGNhdCkgPT4ge1xuICAgICAgICAgIGlmICghY2F0ZWdvcmllc1tjYXRdKSB7XG4gICAgICAgICAgICBjYXRlZ29yaWVzW2NhdF0gPSBbXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgY2F0ZWdvcmllc1tjYXRdLnB1c2gocHJvZHVjdCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG5cbiAgICAgIHJlcy5qc29uKGNhdGVnb3JpZXMpO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xuICAgICAgcmVzXG4gICAgICAgIC5zdGF0dXMoNTAwKVxuICAgICAgICAuanNvbihcbiAgICAgICAgICBuZXcgQXBpRXJyb3IoXCJDYW5ub3QgZ2V0IGNhdGVnb3JpZXNcIiwgNDAxLCBcImNhbm5vdEdldENhdGVnb3JpZXNcIilcbiAgICAgICAgKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJvdXRlci5wdXQoXG4gICAgXCIvdXBkYXRlLXByb2R1Y3QvOmlkXCIsXG4gICAgU2Vzc2lvbixcbiAgICB1cGxvYWQuYXJyYXkoXCJpbWFnZXNcIiwgMTApLFxuICAgIGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgICAgY2hlY2tQZXJtaXNzaW9ucyhyZXEudXNlciwgW1wiYWRtaW5cIiwgXCJzZWxsZXJcIl0pO1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcHJvZHVjdElkID0gcmVxLnBhcmFtcy5pZDtcbiAgICAgICAgY29uc3QgeyBuYW1lLCBjYXRlZ29yaWVzLCBicmFuZCwgZGVmaW5pdGlvbiwgcHJpY2UsIHN0b2NrIH0gPSByZXEuYm9keTtcbiAgICAgICAgY29uc3QgaW1hZ2VQYXRocyA9IHJlcS5maWxlcy5tYXAoKGZpbGUpID0+IGZpbGUucGF0aCk7XG5cbiAgICAgICAgY29uc3QgcHJvZHVjdCA9IGF3YWl0IFByb2R1Y3RzLmZpbmRCeUlkKHByb2R1Y3RJZCk7XG5cbiAgICAgICAgbm90Rm91bmRWYXJpYWJsZShwcm9kdWN0LCBcIlByb2R1Y3RcIik7XG5cbiAgICAgICAgY2hlY2tQcm9kdWN0T3duZXJTaGlwKHJlcS51c2VyLCBwcm9kdWN0KTtcblxuICAgICAgICBpZiAobmFtZSkgcHJvZHVjdC5uYW1lID0gbmFtZTtcbiAgICAgICAgaWYgKGNhdGVnb3JpZXMpIHByb2R1Y3QuY2F0ZWdvcmllcyA9IGNhdGVnb3JpZXM7XG4gICAgICAgIGlmIChicmFuZCkgcHJvZHVjdC5icmFuZCA9IGJyYW5kO1xuICAgICAgICBpZiAoZGVmaW5pdGlvbikgcHJvZHVjdC5kZWZpbml0aW9uID0gZGVmaW5pdGlvbjtcbiAgICAgICAgaWYgKHByaWNlKSBwcm9kdWN0LnByaWNlID0gcHJpY2U7XG4gICAgICAgIGlmIChzdG9jaykgcHJvZHVjdC5zdG9jayA9IHN0b2NrO1xuXG4gICAgICAgIGlmIChyZXEuZmlsZXMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHByb2R1Y3QuaW1hZ2VzID0gaW1hZ2VQYXRocztcbiAgICAgICAgfVxuXG4gICAgICAgIGF3YWl0IHByb2R1Y3Quc2F2ZSgpO1xuXG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHByb2R1Y3QpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICBuZXh0KFxuICAgICAgICAgIG5ldyBBcGlFcnJvcihcbiAgICAgICAgICAgIFwiUHJvZHVjdCBjb3VsZCBub3QgYmUgdXBkYXRlZFwiLFxuICAgICAgICAgICAgNDAwLFxuICAgICAgICAgICAgXCJEb2VzTm90VXBkYXRlZFByb2R1Y3RcIlxuICAgICAgICAgIClcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICB9XG4gICk7XG59O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxPQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxLQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxTQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRyxTQUFBLEdBQUFKLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSSxlQUFBLEdBQUFKLE9BQUE7QUFDQSxJQUFBSyxZQUFBLEdBQUFMLE9BQUE7QUFJQSxJQUFBTSxRQUFBLEdBQUFQLHNCQUFBLENBQUFDLE9BQUE7QUFBNkMsU0FBQUQsdUJB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","map":{"version":3,"names":["_multer","_interopRequireDefault","require","_path","_products","_ApiError","_CheckExistence","_Permissions","_Session","e","__esModule","default","upload","multer","storage","diskStorage","destination","req","file","cb","filename","originalName","originalname","fileFilter","fileTypes","extname","test","path","toLowerCase","mimetype","ApiError","_default","router","post","Session","array","res","next","checkPermissions","user","name","categories","definition","price","stock","body","imagePaths","files","map","sellerId","_id","product","Products","images","seller","save","status","json","error","console","log","get","getAllProducts","find","populate","length","message","errorCode","code","category","query","products","id","params","findById","delete","sellerProduct","findOneAndDelete","checkProductOwnerShip","forEach","cat","push","err","put","productId","brand","notFoundVariable","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["Products.js"],"sourcesContent":["import multer from \"multer\";\nimport path from \"path\";\nimport Products from \"../db/products\";\nimport ApiError from \"../errors/ApiError\";\nimport { notFoundVariable } from \"../helpers/CheckExistence\";\nimport {\n  checkPermissions,\n  checkProductOwnerShip,\n} from \"../helpers/Permissions\";\nimport Session from \"../middlewares/Session\";\n\nconst upload = multer({\n  storage: multer.diskStorage({\n    destination: (req, file, cb) => {\n      cb(null, \"public/images\");\n    },\n    filename: (req, file, cb) => {\n      const originalName = file.originalname;\n      cb(null, originalName);\n    },\n  }),\n  fileFilter: (req, file, cb) => {\n    const fileTypes = /jpeg|jpg|png/;\n\n    const extname = fileTypes.test(\n      path.extname(file.originalname).toLowerCase()\n    );\n\n    const mimetype = fileTypes.test(file.mimetype);\n\n    if (mimetype && extname) {\n      return cb(null, true);\n    } else {\n      cb(\n        new ApiError(\n          \"Invalid file type. Only JPEG, JPG, and PNG are allowed.\",\n          400,\n          \"InvalidFileType\"\n        )\n      );\n    }\n  },\n});\n\nexport default (router) => {\n  router.post(\n    \"/create-product\",\n    Session,\n    upload.array(\"images\", 10),\n    async (req, res, next) => {\n      checkPermissions(req.user, [\"admin\", \"seller\"]);\n      try {\n        const { name, categories, definition, price, stock } = req.body;\n        const imagePaths = req.files.map((file) => file.path);\n        const sellerId = req.user._id;\n\n        const product = new Products({\n          name,\n          images: imagePaths,\n          categories,\n          seller: sellerId,\n          definition,\n          price,\n          stock,\n        });\n\n        await product.save();\n        res.status(201).json(product);\n      } catch (error) {\n        console.log(error);\n        next(\n          new ApiError(\"Product could not be added\", 401, \"DoesNotAddedProduct\")\n        );\n      }\n    }\n  );\n\n  router.get(\"/get-all-products\", async (req, res) => {\n    try {\n      const getAllProducts = await Products.find().populate(\"seller\");\n\n      if (getAllProducts.length === 0) {\n        throw new ApiError(\n          \"There are no products available\",\n          404,\n          \"noFindProduct\"\n        );\n      }\n\n      res.status(200).json(getAllProducts);\n    } catch (error) {\n      // Hata ApiError ise, hata kodunu ve mesajını kullan\n      if (error instanceof ApiError) {\n        res.status(error.status).json({\n          message: error.message,\n          errorCode: error.code,\n        });\n      } else {\n        // Eğer hata ApiError değilse, genel bir hata mesajı döndür\n        res.status(500).json({\n          message: \"An unexpected error occurred\",\n          errorCode: \"InternalServerError\",\n        });\n      }\n    }\n  });\n\n  router.get(\"/get-products-by-category\", async (req, res) => {\n    const category = req.query.category;\n    if (!category) {\n      return res\n        .status(400)\n        .json(new ApiError(\"Category is required\", 401, \"RequiredCategory\"));\n    }\n\n    try {\n      const products = await Products.find({\n        categories: category,\n      }).populate(\"seller\");\n      res.status(200).json(products);\n    } catch (error) {\n      console.error(error);\n      res\n        .status(500)\n        .json(\n          new ApiError(\n            \"Products cannot be retrieved by category\",\n            401,\n            \"CannotGetProductsByCategory\"\n          )\n        );\n    }\n  });\n\n  router.get(\"/get-product-by-id/:id\", async (req, res) => {\n    const { id } = req.params;\n\n    try {\n      const product = await Products.findById(id).populate(\"seller\");\n      if (!product) {\n        return res\n          .status(404)\n          .json(new ApiError(\"Product not found\", 404, \"ProductNotFound\"));\n      }\n      res.status(200).json(product);\n    } catch (error) {\n      console.error(error);\n      res\n        .status(500)\n        .json(\n          new ApiError(\"Product cannot be retrieved\", 500, \"CannotGetProduct\")\n        );\n    }\n  });\n\n  router.delete(\"/delete-product/:id\", Session, async (req, res) => {\n    const id = req.params.id;\n    try {\n      const sellerProduct = await Products.findById(id);\n\n      const product = await Products.findOneAndDelete({ _id: id });\n      checkProductOwnerShip(req.user, product);\n\n      if (product) {\n        res.status(200).json(`Product number ${id} was deleted`);\n      } else {\n        res.status(404).json(`Product with ID ${id} not found`);\n      }\n    } catch (error) {\n      console.log(error);\n      res\n        .status(500)\n        .json(\n          new ApiError(\"Cannot delete product\", 401, \"cannotDeleteProduct\")\n        );\n    }\n  });\n\n  router.get(\"/get-categories\", async (req, res) => {\n    try {\n      const products = await Products.find({});\n      const categories = {};\n\n      products.forEach((product) => {\n        product.categories.forEach((cat) => {\n          if (!categories[cat]) {\n            categories[cat] = [];\n          }\n          categories[cat].push(product);\n        });\n      });\n\n      res.json(categories);\n    } catch (err) {\n      console.error(err);\n      res\n        .status(500)\n        .json(\n          new ApiError(\"Cannot get categories\", 401, \"cannotGetCategories\")\n        );\n    }\n  });\n\n  router.put(\n    \"/update-product/:id\",\n    Session,\n    upload.array(\"images\", 10),\n    async (req, res, next) => {\n      checkPermissions(req.user, [\"admin\", \"seller\"]);\n      try {\n        const productId = req.params.id;\n        const { name, categories, brand, definition, price, stock } = req.body;\n        const imagePaths = req.files.map((file) => file.path);\n\n        const product = await Products.findById(productId);\n\n        notFoundVariable(product, \"Product\");\n\n        checkProductOwnerShip(req.user, product);\n\n        if (name) product.name = name;\n        if (categories) product.categories = categories;\n        if (brand) product.brand = brand;\n        if (definition) product.definition = definition;\n        if (price) product.price = price;\n        if (stock) product.stock = stock;\n\n        if (req.files.length > 0) {\n          product.images = imagePaths;\n        }\n\n        await product.save();\n\n        res.status(200).json(product);\n      } catch (error) {\n        console.log(error);\n        next(\n          new ApiError(\n            \"Product could not be updated\",\n            400,\n            \"DoesNotUpdatedProduct\"\n          )\n        );\n      }\n    }\n  );\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1731316713756},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/products.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst ProductsSchema = new Schema({\n  uuid: {\n    type: String,\n    default: (0, _uuid.default)(),\n    unique: false,\n    required: true\n  },\n  name: {\n    type: String,\n    required: true\n  },\n  definition: {\n    type: String,\n    required: true\n  },\n  images: {\n    type: [String],\n    //text array olacak\n    required: true\n  },\n  categories: {\n    type: [String]\n  },\n  seller: {\n    type: ObjectId,\n    ref: \"Sellers\",\n    required: true\n  },\n  price: {\n    type: Number,\n    required: true\n  },\n  currency: {\n    type: String,\n    required: true,\n    default: \"TRY\",\n    enum: [\"TRY\", \"USD\", \"EUR\"]\n  },\n  stock: {\n    type: Number,\n    default: 1,\n    required: true\n  },\n  itemType: {\n    type: String,\n    required: true,\n    default: \"PHYSICAL\",\n    enum: [\"PHYSICAL\", \"VIRTUAL\"]\n  }\n}, {\n  _id: true,\n  collection: \"products\",\n  timestamps: true,\n  toJSON: {\n    transform: (doc, ret) => {\n      delete ret.__v;\n      return {\n        ...ret\n      };\n    }\n  }\n});\nconst Products = _mongoose.default.model(\"Products\", ProductsSchema);\nvar _default = exports.default = Products;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9iY3J5cHRqcyIsIl91dWlkIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiU2NoZW1hIiwibW9uZ29vc2UiLCJPYmplY3RJZCIsIlR5cGVzIiwiUHJvZHVjdHNTY2hlbWEiLCJ1dWlkIiwidHlwZSIsIlN0cmluZyIsImlkIiwidW5pcXVlIiwicmVxdWlyZWQiLCJuYW1lIiwiZGVmaW5pdGlvbiIsImltYWdlcyIsImNhdGVnb3JpZXMiLCJzZWxsZXIiLCJyZWYiLCJwcmljZSIsIk51bWJlciIsImN1cnJlbmN5IiwiZW51bSIsInN0b2NrIiwiaXRlbVR5cGUiLCJfaWQiLCJjb2xsZWN0aW9uIiwidGltZXN0YW1wcyIsInRvSlNPTiIsInRyYW5zZm9ybSIsImRvYyIsInJldCIsIl9fdiIsIlByb2R1Y3RzIiwibW9kZWwiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9kYi8iLCJzb3VyY2VzIjpbInByb2R1Y3RzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSBmcm9tIFwibW9uZ29vc2VcIjtcbmltcG9ydCBiY3J5cHQgZnJvbSBcImJjcnlwdGpzXCI7XG5pbXBvcnQgaWQgZnJvbSBcIi4uL3V0aWxzL3V1aWRcIjtcblxuY29uc3QgU2NoZW1hID0gbW9uZ29vc2UuU2NoZW1hO1xuY29uc3QgeyBPYmplY3RJZCB9ID0gU2NoZW1hLlR5cGVzO1xuXG5jb25zdCBQcm9kdWN0c1NjaGVtYSA9IG5ldyBTY2hlbWEoXG4gIHtcbiAgICB1dWlkOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICBkZWZhdWx0OiBpZCgpLFxuICAgICAgdW5pcXVlOiBmYWxzZSxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgbmFtZToge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGltYWdlczoge1xuICAgICAgdHlwZTogW1N0cmluZ10sIC8vdGV4dCBhcnJheSBvbGFjYWtcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgY2F0ZWdvcmllczoge1xuICAgICAgdHlwZTogW1N0cmluZ10sXG4gICAgfSxcbiAgICBzZWxsZXI6IHtcbiAgICAgIHR5cGU6IE9iamVjdElkLFxuICAgICAgcmVmOiBcIlNlbGxlcnNcIixcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgcHJpY2U6IHtcbiAgICAgIHR5cGU6IE51bWJlcixcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgY3VycmVuY3k6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgZGVmYXVsdDogXCJUUllcIixcbiAgICAgIGVudW06IFtcIlRSWVwiLCBcIlVTRFwiLCBcIkVVUlwiXSxcbiAgICB9LFxuICAgIHN0b2NrOiB7XG4gICAgICB0eXBlOiBOdW1iZXIsXG4gICAgICBkZWZhdWx0OiAxLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBpdGVtVHlwZToge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICBkZWZhdWx0OiBcIlBIWVNJQ0FMXCIsXG4gICAgICBlbnVtOiBbXCJQSFlTSUNBTFwiLCBcIlZJUlRVQUxcIl0sXG4gICAgfSxcbiAgfSxcbiAge1xuICAgIF9pZDogdHJ1ZSxcbiAgICBjb2xsZWN0aW9uOiBcInByb2R1Y3RzXCIsXG4gICAgdGltZXN0YW1wczogdHJ1ZSxcbiAgICB0b0pTT046IHtcbiAgICAgIHRyYW5zZm9ybTogKGRvYywgcmV0KSA9PiB7XG4gICAgICAgIGRlbGV0ZSByZXQuX192O1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLnJldCxcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgfSxcbiAgfVxuKTtcblxuY29uc3QgUHJvZHVjdHMgPSBtb25nb29zZS5tb2RlbChcIlByb2R1Y3RzXCIsIFByb2R1Y3RzU2NoZW1hKTtcblxuZXhwb3J0IGRlZmF1bHQgUHJvZHVjdHM7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFNBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLEtBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUErQixTQUFBRCx1QkFBQUksQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUUvQixNQUFNRyxNQUFNLEdBQUdDLGlCQUFRLENBQUNELE1BQU07QUFDOUIsTUFBTTtFQUFFRTtBQUFTLENBQUMsR0FBR0YsTUFBTSxDQUFDRyxLQUFLO0FBRWpDLE1BQU1DLGNBQWMsR0FBRyxJQUFJSixNQUFNLENBQy9CO0VBQ0VLLElBQUksRUFBRTtJQUNKQyxJQUFJLEVBQUVDLE1BQU07SUFDWlIsT0FBTyxFQUFFLElBQUFTLGFBQUUsRUFBQyxDQUFDO0lBQ2JDLE1BQU0sRUFBRSxLQUFLO0lBQ2JDLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDREMsSUFBSSxFQUFFO0lBQ0pMLElBQUksRUFBRUMsTUFBTTtJQUNaRyxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RFLFVBQVUsRUFBRTtJQUNWTixJQUFJLEVBQUVDLE1BQU07SUFDWkcsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNERyxNQUFNLEVBQUU7SUFDTlAsSUFBSSxFQUFFLENBQUNDLE1BQU0sQ0FBQztJQUFFO0lBQ2hCRyxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RJLFVBQVUsRUFBRTtJQUNWUixJQUFJLEVBQUUsQ0FBQ0MsTUFBTTtFQUNmLENBQUM7RUFDRFEsTUFBTSxFQUFFO0lBQ05ULElBQUksRUFBRUosUUFBUTtJQUNkYyxHQUFHLEVBQUUsU0FBUztJQUNkTixRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RPLEtBQUssRUFBRTtJQUNMWCxJQUFJLEVBQUVZLE1BQU07SUFDWlIsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNEUyxRQUFRLEVBQUU7SUFDUmIsSUFBSSxFQUFFQyxNQUFNO0lBQ1pHLFFBQVEsRUFBRSxJQUFJO0lBQ2RYLE9BQU8sRUFBRSxLQUFLO0lBQ2RxQixJQUFJLEVBQUUsQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLEtBQUs7RUFDNUIsQ0FBQztFQUNEQyxLQUFLLEVBQUU7SUFDTGYsSUFBSSxFQUFFWSxNQUFNO0lBQ1puQixPQUFPLEVBQUUsQ0FBQztJQUNWVyxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RZLFFBQVEsRUFBRTtJQUNSaEIsSUFBSSxFQUFFQyxNQUFNO0lBQ1pHLFFBQVEsRUFBRSxJQUFJO0lBQ2RYLE9BQU8sRUFBRSxVQUFVO0lBQ25CcUIsSUFBSSxFQUFFLENBQUMsVUFBVSxFQUFFLFNBQVM7RUFDOUI7QUFDRixDQUFDLEVBQ0Q7RUFDRUcsR0FBRyxFQUFFLElBQUk7RUFDVEMsVUFBVSxFQUFFLFVBQVU7RUFDdEJDLFVBQVUsRUFBRSxJQUFJO0VBQ2hCQyxNQUFNLEVBQUU7SUFDTkMsU0FBUyxFQUFFQSxDQUFDQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztNQUN2QixPQUFPQSxHQUFHLENBQUNDLEdBQUc7TUFDZCxPQUFPO1FBQ0wsR0FBR0Q7TUFDTCxDQUFDO0lBQ0g7RUFDRjtBQUNGLENBQ0YsQ0FBQztBQUVELE1BQU1FLFFBQVEsR0FBRzlCLGlCQUFRLENBQUMrQixLQUFLLENBQUMsVUFBVSxFQUFFNUIsY0FBYyxDQUFDO0FBQUMsSUFBQTZCLFFBQUEsR0FBQUMsT0FBQSxDQUFBbkMsT0FBQSxHQUU3Q2dDLFFBQVEiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","_bcryptjs","_uuid","e","__esModule","default","Schema","mongoose","ObjectId","Types","ProductsSchema","uuid","type","String","id","unique","required","name","definition","images","categories","seller","ref","price","Number","currency","enum","stock","itemType","_id","collection","timestamps","toJSON","transform","doc","ret","__v","Products","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["products.js"],"sourcesContent":["import mongoose from \"mongoose\";\nimport bcrypt from \"bcryptjs\";\nimport id from \"../utils/uuid\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\n\nconst ProductsSchema = new Schema(\n  {\n    uuid: {\n      type: String,\n      default: id(),\n      unique: false,\n      required: true,\n    },\n    name: {\n      type: String,\n      required: true,\n    },\n    definition: {\n      type: String,\n      required: true,\n    },\n    images: {\n      type: [String], //text array olacak\n      required: true,\n    },\n    categories: {\n      type: [String],\n    },\n    seller: {\n      type: ObjectId,\n      ref: \"Sellers\",\n      required: true,\n    },\n    price: {\n      type: Number,\n      required: true,\n    },\n    currency: {\n      type: String,\n      required: true,\n      default: \"TRY\",\n      enum: [\"TRY\", \"USD\", \"EUR\"],\n    },\n    stock: {\n      type: Number,\n      default: 1,\n      required: true,\n    },\n    itemType: {\n      type: String,\n      required: true,\n      default: \"PHYSICAL\",\n      enum: [\"PHYSICAL\", \"VIRTUAL\"],\n    },\n  },\n  {\n    _id: true,\n    collection: \"products\",\n    timestamps: true,\n    toJSON: {\n      transform: (doc, ret) => {\n        delete ret.__v;\n        return {\n          ...ret,\n        };\n      },\n    },\n  }\n);\n\nconst Products = mongoose.model(\"Products\", ProductsSchema);\n\nexport default Products;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,KAAA,GAAAH,sBAAA,CAAAC,OAAA;AAA+B,SAAAD,uBAAAI,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE/B,MAAMG,MAAM,GAAGC,iBAAQ,CAACD,MAAM;AAC9B,MAAM;EAAEE;AAAS,CAAC,GAAGF,MAAM,CAACG,KAAK;AAEjC,MAAMC,cAAc,GAAG,IAAIJ,MAAM,CAC/B;EACEK,IAAI,EAAE;IACJC,IAAI,EAAEC,MAAM;IACZR,OAAO,EAAE,IAAAS,aAAE,EAAC,CAAC;IACbC,MAAM,EAAE,KAAK;IACbC,QAAQ,EAAE;EACZ,CAAC;EACDC,IAAI,EAAE;IACJL,IAAI,EAAEC,MAAM;IACZG,QAAQ,EAAE;EACZ,CAAC;EACDE,UAAU,EAAE;IACVN,IAAI,EAAEC,MAAM;IACZG,QAAQ,EAAE;EACZ,CAAC;EACDG,MAAM,EAAE;IACNP,IAAI,EAAE,CAACC,MAAM,CAAC;IAAE;IAChBG,QAAQ,EAAE;EACZ,CAAC;EACDI,UAAU,EAAE;IACVR,IAAI,EAAE,CAACC,MAAM;EACf,CAAC;EACDQ,MAAM,EAAE;IACNT,IAAI,EAAEJ,QAAQ;IACdc,GAAG,EAAE,SAAS;IACdN,QAAQ,EAAE;EACZ,CAAC;EACDO,KAAK,EAAE;IACLX,IAAI,EAAEY,MAAM;IACZR,QAAQ,EAAE;EACZ,CAAC;EACDS,QAAQ,EAAE;IACRb,IAAI,EAAEC,MAAM;IACZG,QAAQ,EAAE,IAAI;IACdX,OAAO,EAAE,KAAK;IACdqB,IAAI,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK;EAC5B,CAAC;EACDC,KAAK,EAAE;IACLf,IAAI,EAAEY,MAAM;IACZnB,OAAO,EAAE,CAAC;IACVW,QAAQ,EAAE;EACZ,CAAC;EACDY,QAAQ,EAAE;IACRhB,IAAI,EAAEC,MAAM;IACZG,QAAQ,EAAE,IAAI;IACdX,OAAO,EAAE,UAAU;IACnBqB,IAAI,EAAE,CAAC,UAAU,EAAE,SAAS;EAC9B;AACF,CAAC,EACD;EACEG,GAAG,EAAE,IAAI;EACTC,UAAU,EAAE,UAAU;EACtBC,UAAU,EAAE,IAAI;EAChBC,MAAM,EAAE;IACNC,SAAS,EAAEA,CAACC,GAAG,EAAEC,GAAG,KAAK;MACvB,OAAOA,GAAG,CAACC,GAAG;MACd,OAAO;QACL,GAAGD;MACL,CAAC;IACH;EACF;AACF,CACF,CAAC;AAED,MAAME,QAAQ,GAAG9B,iBAAQ,CAAC+B,KAAK,CAAC,UAAU,EAAE5B,cAAc,CAAC;AAAC,IAAA6B,QAAA,GAAAC,OAAA,CAAAnC,OAAA,GAE7CgC,QAAQ","ignoreList":[]}},"mtime":1727078468711},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/RoleMiddleware.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst checkRole = roles => {\n  return async (req, res, next) => {\n    try {\n      // Assuming the user ID is stored in req.user.id by the authentication middleware\n      const userId = req.user.id;\n\n      // Fetch the user from the database\n      const user = await _users.default.findById(userId);\n      if (!user) {\n        return res.status(404).json(\"User not found.\");\n      }\n\n      // Check if the user's role is in the allowed roles\n      if (roles.includes(user.role)) {\n        next();\n      } else {\n        return res.status(401).json(\"You cannot get in.\");\n      }\n    } catch (error) {\n      return res.status(500).json({\n        message: \"Internal server error\",\n        error\n      });\n    }\n  };\n};\nvar _default = exports.default = checkRole;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfdXNlcnMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImNoZWNrUm9sZSIsInJvbGVzIiwicmVxIiwicmVzIiwibmV4dCIsInVzZXJJZCIsInVzZXIiLCJpZCIsIlVzZXIiLCJmaW5kQnlJZCIsInN0YXR1cyIsImpzb24iLCJpbmNsdWRlcyIsInJvbGUiLCJlcnJvciIsIm1lc3NhZ2UiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9taWRkbGV3YXJlcy8iLCJzb3VyY2VzIjpbIlJvbGVNaWRkbGV3YXJlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBVc2VyIGZyb20gXCIuLi9kYi91c2Vyc1wiO1xuXG5jb25zdCBjaGVja1JvbGUgPSAocm9sZXMpID0+IHtcbiAgcmV0dXJuIGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBBc3N1bWluZyB0aGUgdXNlciBJRCBpcyBzdG9yZWQgaW4gcmVxLnVzZXIuaWQgYnkgdGhlIGF1dGhlbnRpY2F0aW9uIG1pZGRsZXdhcmVcbiAgICAgIGNvbnN0IHVzZXJJZCA9IHJlcS51c2VyLmlkO1xuXG4gICAgICAvLyBGZXRjaCB0aGUgdXNlciBmcm9tIHRoZSBkYXRhYmFzZVxuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZEJ5SWQodXNlcklkKTtcblxuICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbihcIlVzZXIgbm90IGZvdW5kLlwiKTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgaWYgdGhlIHVzZXIncyByb2xlIGlzIGluIHRoZSBhbGxvd2VkIHJvbGVzXG4gICAgICBpZiAocm9sZXMuaW5jbHVkZXModXNlci5yb2xlKSkge1xuICAgICAgICBuZXh0KCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oXCJZb3UgY2Fubm90IGdldCBpbi5cIik7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IG1lc3NhZ2U6IFwiSW50ZXJuYWwgc2VydmVyIGVycm9yXCIsIGVycm9yIH0pO1xuICAgIH1cbiAgfTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGNoZWNrUm9sZTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsTUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQStCLFNBQUFELHVCQUFBRSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBRS9CLE1BQU1HLFNBQVMsR0FBSUMsS0FBSyxJQUFLO0VBQzNCLE9BQU8sT0FBT0MsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksS0FBSztJQUMvQixJQUFJO01BQ0Y7TUFDQSxNQUFNQyxNQUFNLEdBQUdILEdBQUcsQ0FBQ0ksSUFBSSxDQUFDQyxFQUFFOztNQUUxQjtNQUNBLE1BQU1ELElBQUksR0FBRyxNQUFNRSxjQUFJLENBQUNDLFFBQVEsQ0FBQ0osTUFBTSxDQUFDO01BRXhDLElBQUksQ0FBQ0MsSUFBSSxFQUFFO1FBQ1QsT0FBT0gsR0FBRyxDQUFDTyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQztNQUNoRDs7TUFFQTtNQUNBLElBQUlWLEtBQUssQ0FBQ1csUUFBUSxDQUFDTixJQUFJLENBQUNPLElBQUksQ0FBQyxFQUFFO1FBQzdCVCxJQUFJLENBQUMsQ0FBQztNQUNSLENBQUMsTUFBTTtRQUNMLE9BQU9ELEdBQUcsQ0FBQ08sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMsb0JBQW9CLENBQUM7TUFDbkQ7SUFDRixDQUFDLENBQUMsT0FBT0csS0FBSyxFQUFFO01BQ2QsT0FBT1gsR0FBRyxDQUFDTyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztRQUFFSSxPQUFPLEVBQUUsdUJBQXVCO1FBQUVEO01BQU0sQ0FBQyxDQUFDO0lBQzFFO0VBQ0YsQ0FBQztBQUNILENBQUM7QUFBQyxJQUFBRSxRQUFBLEdBQUFDLE9BQUEsQ0FBQWxCLE9BQUEsR0FFYUMsU0FBUyIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_users","_interopRequireDefault","require","e","__esModule","default","checkRole","roles","req","res","next","userId","user","id","User","findById","status","json","includes","role","error","message","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["RoleMiddleware.js"],"sourcesContent":["import User from \"../db/users\";\n\nconst checkRole = (roles) => {\n  return async (req, res, next) => {\n    try {\n      // Assuming the user ID is stored in req.user.id by the authentication middleware\n      const userId = req.user.id;\n\n      // Fetch the user from the database\n      const user = await User.findById(userId);\n\n      if (!user) {\n        return res.status(404).json(\"User not found.\");\n      }\n\n      // Check if the user's role is in the allowed roles\n      if (roles.includes(user.role)) {\n        next();\n      } else {\n        return res.status(401).json(\"You cannot get in.\");\n      }\n    } catch (error) {\n      return res.status(500).json({ message: \"Internal server error\", error });\n    }\n  };\n};\n\nexport default checkRole;\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA+B,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE/B,MAAMG,SAAS,GAAIC,KAAK,IAAK;EAC3B,OAAO,OAAOC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;IAC/B,IAAI;MACF;MACA,MAAMC,MAAM,GAAGH,GAAG,CAACI,IAAI,CAACC,EAAE;;MAE1B;MACA,MAAMD,IAAI,GAAG,MAAME,cAAI,CAACC,QAAQ,CAACJ,MAAM,CAAC;MAExC,IAAI,CAACC,IAAI,EAAE;QACT,OAAOH,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,iBAAiB,CAAC;MAChD;;MAEA;MACA,IAAIV,KAAK,CAACW,QAAQ,CAACN,IAAI,CAACO,IAAI,CAAC,EAAE;QAC7BT,IAAI,CAAC,CAAC;MACR,CAAC,MAAM;QACL,OAAOD,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,oBAAoB,CAAC;MACnD;IACF,CAAC,CAAC,OAAOG,KAAK,EAAE;MACd,OAAOX,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEI,OAAO,EAAE,uBAAuB;QAAED;MAAM,CAAC,CAAC;IAC1E;EACF,CAAC;AACH,CAAC;AAAC,IAAAE,QAAA,GAAAC,OAAA,CAAAlB,OAAA,GAEaC,SAAS","ignoreList":[]}},"mtime":1722424936373},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/RoleMiddleware.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst checkRole = roles => {\n  return async (req, res, next) => {\n    try {\n      // Assuming the user ID is stored in req.user.id by the authentication middleware\n      const userId = req.user.id;\n\n      // Fetch the user from the database\n      const user = await _users.default.findById(userId);\n      if (!user) {\n        return res.status(404).json(\"User not found.\");\n      }\n\n      // Check if the user's role is in the allowed roles\n      if (roles.includes(user.role)) {\n        next();\n      } else {\n        return res.status(401).json(\"You cannot get in.\");\n      }\n    } catch (error) {\n      return res.status(500).json({\n        message: \"Internal server error\",\n        error\n      });\n    }\n  };\n};\nvar _default = exports.default = checkRole;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfdXNlcnMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImNoZWNrUm9sZSIsInJvbGVzIiwicmVxIiwicmVzIiwibmV4dCIsInVzZXJJZCIsInVzZXIiLCJpZCIsIlVzZXIiLCJmaW5kQnlJZCIsInN0YXR1cyIsImpzb24iLCJpbmNsdWRlcyIsInJvbGUiLCJlcnJvciIsIm1lc3NhZ2UiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9taWRkbGV3YXJlcy8iLCJzb3VyY2VzIjpbIlJvbGVNaWRkbGV3YXJlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBVc2VyIGZyb20gXCIuLi9kYi91c2Vyc1wiO1xuXG5jb25zdCBjaGVja1JvbGUgPSAocm9sZXMpID0+IHtcbiAgcmV0dXJuIGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICAvLyBBc3N1bWluZyB0aGUgdXNlciBJRCBpcyBzdG9yZWQgaW4gcmVxLnVzZXIuaWQgYnkgdGhlIGF1dGhlbnRpY2F0aW9uIG1pZGRsZXdhcmVcbiAgICAgIGNvbnN0IHVzZXJJZCA9IHJlcS51c2VyLmlkO1xuXG4gICAgICAvLyBGZXRjaCB0aGUgdXNlciBmcm9tIHRoZSBkYXRhYmFzZVxuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXIuZmluZEJ5SWQodXNlcklkKTtcblxuICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbihcIlVzZXIgbm90IGZvdW5kLlwiKTtcbiAgICAgIH1cblxuICAgICAgLy8gQ2hlY2sgaWYgdGhlIHVzZXIncyByb2xlIGlzIGluIHRoZSBhbGxvd2VkIHJvbGVzXG4gICAgICBpZiAocm9sZXMuaW5jbHVkZXModXNlci5yb2xlKSkge1xuICAgICAgICBuZXh0KCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oXCJZb3UgY2Fubm90IGdldCBpbi5cIik7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IG1lc3NhZ2U6IFwiSW50ZXJuYWwgc2VydmVyIGVycm9yXCIsIGVycm9yIH0pO1xuICAgIH1cbiAgfTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGNoZWNrUm9sZTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsTUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQStCLFNBQUFELHVCQUFBRSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBRS9CLE1BQU1HLFNBQVMsR0FBSUMsS0FBSyxJQUFLO0VBQzNCLE9BQU8sT0FBT0MsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksS0FBSztJQUMvQixJQUFJO01BQ0Y7TUFDQSxNQUFNQyxNQUFNLEdBQUdILEdBQUcsQ0FBQ0ksSUFBSSxDQUFDQyxFQUFFOztNQUUxQjtNQUNBLE1BQU1ELElBQUksR0FBRyxNQUFNRSxjQUFJLENBQUNDLFFBQVEsQ0FBQ0osTUFBTSxDQUFDO01BRXhDLElBQUksQ0FBQ0MsSUFBSSxFQUFFO1FBQ1QsT0FBT0gsR0FBRyxDQUFDTyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQyxpQkFBaUIsQ0FBQztNQUNoRDs7TUFFQTtNQUNBLElBQUlWLEtBQUssQ0FBQ1csUUFBUSxDQUFDTixJQUFJLENBQUNPLElBQUksQ0FBQyxFQUFFO1FBQzdCVCxJQUFJLENBQUMsQ0FBQztNQUNSLENBQUMsTUFBTTtRQUNMLE9BQU9ELEdBQUcsQ0FBQ08sTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUMsb0JBQW9CLENBQUM7TUFDbkQ7SUFDRixDQUFDLENBQUMsT0FBT0csS0FBSyxFQUFFO01BQ2QsT0FBT1gsR0FBRyxDQUFDTyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztRQUFFSSxPQUFPLEVBQUUsdUJBQXVCO1FBQUVEO01BQU0sQ0FBQyxDQUFDO0lBQzFFO0VBQ0YsQ0FBQztBQUNILENBQUM7QUFBQyxJQUFBRSxRQUFBLEdBQUFDLE9BQUEsQ0FBQWxCLE9BQUEsR0FFYUMsU0FBUyIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_users","_interopRequireDefault","require","e","__esModule","default","checkRole","roles","req","res","next","userId","user","id","User","findById","status","json","includes","role","error","message","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["RoleMiddleware.js"],"sourcesContent":["import User from \"../db/users\";\n\nconst checkRole = (roles) => {\n  return async (req, res, next) => {\n    try {\n      // Assuming the user ID is stored in req.user.id by the authentication middleware\n      const userId = req.user.id;\n\n      // Fetch the user from the database\n      const user = await User.findById(userId);\n\n      if (!user) {\n        return res.status(404).json(\"User not found.\");\n      }\n\n      // Check if the user's role is in the allowed roles\n      if (roles.includes(user.role)) {\n        next();\n      } else {\n        return res.status(401).json(\"You cannot get in.\");\n      }\n    } catch (error) {\n      return res.status(500).json({ message: \"Internal server error\", error });\n    }\n  };\n};\n\nexport default checkRole;\n"],"mappings":";;;;;;AAAA,IAAAA,MAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA+B,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE/B,MAAMG,SAAS,GAAIC,KAAK,IAAK;EAC3B,OAAO,OAAOC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;IAC/B,IAAI;MACF;MACA,MAAMC,MAAM,GAAGH,GAAG,CAACI,IAAI,CAACC,EAAE;;MAE1B;MACA,MAAMD,IAAI,GAAG,MAAME,cAAI,CAACC,QAAQ,CAACJ,MAAM,CAAC;MAExC,IAAI,CAACC,IAAI,EAAE;QACT,OAAOH,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,iBAAiB,CAAC;MAChD;;MAEA;MACA,IAAIV,KAAK,CAACW,QAAQ,CAACN,IAAI,CAACO,IAAI,CAAC,EAAE;QAC7BT,IAAI,CAAC,CAAC;MACR,CAAC,MAAM;QACL,OAAOD,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,oBAAoB,CAAC;MACnD;IACF,CAAC,CAAC,OAAOG,KAAK,EAAE;MACd,OAAOX,GAAG,CAACO,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEI,OAAO,EAAE,uBAAuB;QAAED;MAAM,CAAC,CAAC;IAC1E;EACF,CAAC;AACH,CAAC;AAAC,IAAAE,QAAA,GAAAC,OAAA,CAAAlB,OAAA,GAEaC,SAAS","ignoreList":[]}},"mtime":1722424936373},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/cart.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst CartsSchema = new Schema({\n  uuid: {\n    type: String,\n    default: () => (0, _uuid.default)(),\n    unique: true,\n    required: true\n  },\n  completed: {\n    type: Boolean,\n    default: false,\n    required: true\n  },\n  buyer: {\n    type: ObjectId,\n    ref: \"Users\",\n    required: true\n  },\n  products: [{\n    productId: {\n      type: _mongoose.default.Schema.Types.ObjectId,\n      ref: \"Products\",\n      required: true\n    },\n    seller: {\n      type: _mongoose.default.Schema.Types.ObjectId,\n      ref: \"Sellers\",\n      required: true\n    },\n    // Ürünün sahibi olan satıcı\n    quantity: {\n      type: Number,\n      required: true\n    },\n    status: {\n      type: String,\n      enum: [\"pending\", \"processing\", \"completed\", \"canceled\"],\n      // Ürün durumları\n      default: \"pending\"\n    }\n  }],\n  currency: {\n    type: String,\n    required: true,\n    default: \"TRY\",\n    enum: [\"TRY\", \"USD\", \"EUR\"]\n  }\n}, {\n  _id: true,\n  collection: \"carts\",\n  timestamps: true,\n  toJSON: {\n    transform: (doc, ret) => {\n      delete ret.__v;\n      return {\n        ...ret\n      };\n    }\n  }\n});\nconst Carts = _mongoose.default.model(\"Carts\", CartsSchema);\nvar _default = exports.default = Carts;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl91dWlkIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiU2NoZW1hIiwibW9uZ29vc2UiLCJPYmplY3RJZCIsIlR5cGVzIiwiQ2FydHNTY2hlbWEiLCJ1dWlkIiwidHlwZSIsIlN0cmluZyIsInVuaXF1ZSIsInJlcXVpcmVkIiwiY29tcGxldGVkIiwiQm9vbGVhbiIsImJ1eWVyIiwicmVmIiwicHJvZHVjdHMiLCJwcm9kdWN0SWQiLCJzZWxsZXIiLCJxdWFudGl0eSIsIk51bWJlciIsInN0YXR1cyIsImVudW0iLCJjdXJyZW5jeSIsIl9pZCIsImNvbGxlY3Rpb24iLCJ0aW1lc3RhbXBzIiwidG9KU09OIiwidHJhbnNmb3JtIiwiZG9jIiwicmV0IiwiX192IiwiQ2FydHMiLCJtb2RlbCIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL2RiLyIsInNvdXJjZXMiOlsiY2FydC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UgZnJvbSBcIm1vbmdvb3NlXCI7XG5pbXBvcnQgdXVpZCBmcm9tIFwiLi4vdXRpbHMvdXVpZFwiO1xuXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWE7XG5jb25zdCB7IE9iamVjdElkIH0gPSBTY2hlbWEuVHlwZXM7XG5cbmNvbnN0IENhcnRzU2NoZW1hID0gbmV3IFNjaGVtYShcbiAge1xuICAgIHV1aWQ6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIGRlZmF1bHQ6ICgpID0+IHV1aWQoKSxcbiAgICAgIHVuaXF1ZTogdHJ1ZSxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgY29tcGxldGVkOiB7XG4gICAgICB0eXBlOiBCb29sZWFuLFxuICAgICAgZGVmYXVsdDogZmFsc2UsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGJ1eWVyOiB7XG4gICAgICB0eXBlOiBPYmplY3RJZCxcbiAgICAgIHJlZjogXCJVc2Vyc1wiLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBwcm9kdWN0czogW1xuICAgICAge1xuICAgICAgICBwcm9kdWN0SWQ6IHtcbiAgICAgICAgICB0eXBlOiBtb25nb29zZS5TY2hlbWEuVHlwZXMuT2JqZWN0SWQsXG4gICAgICAgICAgcmVmOiBcIlByb2R1Y3RzXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICAgIHNlbGxlcjoge1xuICAgICAgICAgIHR5cGU6IG1vbmdvb3NlLlNjaGVtYS5UeXBlcy5PYmplY3RJZCxcbiAgICAgICAgICByZWY6IFwiU2VsbGVyc1wiLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICB9LCAvLyDDnHLDvG7DvG4gc2FoaWJpIG9sYW4gc2F0xLFjxLFcbiAgICAgICAgcXVhbnRpdHk6IHtcbiAgICAgICAgICB0eXBlOiBOdW1iZXIsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICAgIHN0YXR1czoge1xuICAgICAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgICAgICBlbnVtOiBbXCJwZW5kaW5nXCIsIFwicHJvY2Vzc2luZ1wiLCBcImNvbXBsZXRlZFwiLCBcImNhbmNlbGVkXCJdLCAvLyDDnHLDvG4gZHVydW1sYXLEsVxuICAgICAgICAgIGRlZmF1bHQ6IFwicGVuZGluZ1wiLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICBdLFxuICAgIGN1cnJlbmN5OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIGRlZmF1bHQ6IFwiVFJZXCIsXG4gICAgICBlbnVtOiBbXCJUUllcIiwgXCJVU0RcIiwgXCJFVVJcIl0sXG4gICAgfSxcbiAgfSxcbiAge1xuICAgIF9pZDogdHJ1ZSxcbiAgICBjb2xsZWN0aW9uOiBcImNhcnRzXCIsXG4gICAgdGltZXN0YW1wczogdHJ1ZSxcbiAgICB0b0pTT046IHtcbiAgICAgIHRyYW5zZm9ybTogKGRvYywgcmV0KSA9PiB7XG4gICAgICAgIGRlbGV0ZSByZXQuX192O1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLnJldCxcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgfSxcbiAgfVxuKTtcblxuY29uc3QgQ2FydHMgPSBtb25nb29zZS5tb2RlbChcIkNhcnRzXCIsIENhcnRzU2NoZW1hKTtcblxuZXhwb3J0IGRlZmF1bHQgQ2FydHM7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLEtBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUFpQyxTQUFBRCx1QkFBQUcsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUVqQyxNQUFNRyxNQUFNLEdBQUdDLGlCQUFRLENBQUNELE1BQU07QUFDOUIsTUFBTTtFQUFFRTtBQUFTLENBQUMsR0FBR0YsTUFBTSxDQUFDRyxLQUFLO0FBRWpDLE1BQU1DLFdBQVcsR0FBRyxJQUFJSixNQUFNLENBQzVCO0VBQ0VLLElBQUksRUFBRTtJQUNKQyxJQUFJLEVBQUVDLE1BQU07SUFDWlIsT0FBTyxFQUFFQSxDQUFBLEtBQU0sSUFBQU0sYUFBSSxFQUFDLENBQUM7SUFDckJHLE1BQU0sRUFBRSxJQUFJO0lBQ1pDLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDREMsU0FBUyxFQUFFO0lBQ1RKLElBQUksRUFBRUssT0FBTztJQUNiWixPQUFPLEVBQUUsS0FBSztJQUNkVSxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RHLEtBQUssRUFBRTtJQUNMTixJQUFJLEVBQUVKLFFBQVE7SUFDZFcsR0FBRyxFQUFFLE9BQU87SUFDWkosUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNESyxRQUFRLEVBQUUsQ0FDUjtJQUNFQyxTQUFTLEVBQUU7TUFDVFQsSUFBSSxFQUFFTCxpQkFBUSxDQUFDRCxNQUFNLENBQUNHLEtBQUssQ0FBQ0QsUUFBUTtNQUNwQ1csR0FBRyxFQUFFLFVBQVU7TUFDZkosUUFBUSxFQUFFO0lBQ1osQ0FBQztJQUNETyxNQUFNLEVBQUU7TUFDTlYsSUFBSSxFQUFFTCxpQkFBUSxDQUFDRCxNQUFNLENBQUNHLEtBQUssQ0FBQ0QsUUFBUTtNQUNwQ1csR0FBRyxFQUFFLFNBQVM7TUFDZEosUUFBUSxFQUFFO0lBQ1osQ0FBQztJQUFFO0lBQ0hRLFFBQVEsRUFBRTtNQUNSWCxJQUFJLEVBQUVZLE1BQU07TUFDWlQsUUFBUSxFQUFFO0lBQ1osQ0FBQztJQUNEVSxNQUFNLEVBQUU7TUFDTmIsSUFBSSxFQUFFQyxNQUFNO01BQ1phLElBQUksRUFBRSxDQUFDLFNBQVMsRUFBRSxZQUFZLEVBQUUsV0FBVyxFQUFFLFVBQVUsQ0FBQztNQUFFO01BQzFEckIsT0FBTyxFQUFFO0lBQ1g7RUFDRixDQUFDLENBQ0Y7RUFDRHNCLFFBQVEsRUFBRTtJQUNSZixJQUFJLEVBQUVDLE1BQU07SUFDWkUsUUFBUSxFQUFFLElBQUk7SUFDZFYsT0FBTyxFQUFFLEtBQUs7SUFDZHFCLElBQUksRUFBRSxDQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSztFQUM1QjtBQUNGLENBQUMsRUFDRDtFQUNFRSxHQUFHLEVBQUUsSUFBSTtFQUNUQyxVQUFVLEVBQUUsT0FBTztFQUNuQkMsVUFBVSxFQUFFLElBQUk7RUFDaEJDLE1BQU0sRUFBRTtJQUNOQyxTQUFTLEVBQUVBLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxLQUFLO01BQ3ZCLE9BQU9BLEdBQUcsQ0FBQ0MsR0FBRztNQUNkLE9BQU87UUFDTCxHQUFHRDtNQUNMLENBQUM7SUFDSDtFQUNGO0FBQ0YsQ0FDRixDQUFDO0FBRUQsTUFBTUUsS0FBSyxHQUFHN0IsaUJBQVEsQ0FBQzhCLEtBQUssQ0FBQyxPQUFPLEVBQUUzQixXQUFXLENBQUM7QUFBQyxJQUFBNEIsUUFBQSxHQUFBQyxPQUFBLENBQUFsQyxPQUFBLEdBRXBDK0IsS0FBSyIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","_uuid","e","__esModule","default","Schema","mongoose","ObjectId","Types","CartsSchema","uuid","type","String","unique","required","completed","Boolean","buyer","ref","products","productId","seller","quantity","Number","status","enum","currency","_id","collection","timestamps","toJSON","transform","doc","ret","__v","Carts","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["cart.js"],"sourcesContent":["import mongoose from \"mongoose\";\nimport uuid from \"../utils/uuid\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\n\nconst CartsSchema = new Schema(\n  {\n    uuid: {\n      type: String,\n      default: () => uuid(),\n      unique: true,\n      required: true,\n    },\n    completed: {\n      type: Boolean,\n      default: false,\n      required: true,\n    },\n    buyer: {\n      type: ObjectId,\n      ref: \"Users\",\n      required: true,\n    },\n    products: [\n      {\n        productId: {\n          type: mongoose.Schema.Types.ObjectId,\n          ref: \"Products\",\n          required: true,\n        },\n        seller: {\n          type: mongoose.Schema.Types.ObjectId,\n          ref: \"Sellers\",\n          required: true,\n        }, // Ürünün sahibi olan satıcı\n        quantity: {\n          type: Number,\n          required: true,\n        },\n        status: {\n          type: String,\n          enum: [\"pending\", \"processing\", \"completed\", \"canceled\"], // Ürün durumları\n          default: \"pending\",\n        },\n      },\n    ],\n    currency: {\n      type: String,\n      required: true,\n      default: \"TRY\",\n      enum: [\"TRY\", \"USD\", \"EUR\"],\n    },\n  },\n  {\n    _id: true,\n    collection: \"carts\",\n    timestamps: true,\n    toJSON: {\n      transform: (doc, ret) => {\n        delete ret.__v;\n        return {\n          ...ret,\n        };\n      },\n    },\n  }\n);\n\nconst Carts = mongoose.model(\"Carts\", CartsSchema);\n\nexport default Carts;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,KAAA,GAAAF,sBAAA,CAAAC,OAAA;AAAiC,SAAAD,uBAAAG,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEjC,MAAMG,MAAM,GAAGC,iBAAQ,CAACD,MAAM;AAC9B,MAAM;EAAEE;AAAS,CAAC,GAAGF,MAAM,CAACG,KAAK;AAEjC,MAAMC,WAAW,GAAG,IAAIJ,MAAM,CAC5B;EACEK,IAAI,EAAE;IACJC,IAAI,EAAEC,MAAM;IACZR,OAAO,EAAEA,CAAA,KAAM,IAAAM,aAAI,EAAC,CAAC;IACrBG,MAAM,EAAE,IAAI;IACZC,QAAQ,EAAE;EACZ,CAAC;EACDC,SAAS,EAAE;IACTJ,IAAI,EAAEK,OAAO;IACbZ,OAAO,EAAE,KAAK;IACdU,QAAQ,EAAE;EACZ,CAAC;EACDG,KAAK,EAAE;IACLN,IAAI,EAAEJ,QAAQ;IACdW,GAAG,EAAE,OAAO;IACZJ,QAAQ,EAAE;EACZ,CAAC;EACDK,QAAQ,EAAE,CACR;IACEC,SAAS,EAAE;MACTT,IAAI,EAAEL,iBAAQ,CAACD,MAAM,CAACG,KAAK,CAACD,QAAQ;MACpCW,GAAG,EAAE,UAAU;MACfJ,QAAQ,EAAE;IACZ,CAAC;IACDO,MAAM,EAAE;MACNV,IAAI,EAAEL,iBAAQ,CAACD,MAAM,CAACG,KAAK,CAACD,QAAQ;MACpCW,GAAG,EAAE,SAAS;MACdJ,QAAQ,EAAE;IACZ,CAAC;IAAE;IACHQ,QAAQ,EAAE;MACRX,IAAI,EAAEY,MAAM;MACZT,QAAQ,EAAE;IACZ,CAAC;IACDU,MAAM,EAAE;MACNb,IAAI,EAAEC,MAAM;MACZa,IAAI,EAAE,CAAC,SAAS,EAAE,YAAY,EAAE,WAAW,EAAE,UAAU,CAAC;MAAE;MAC1DrB,OAAO,EAAE;IACX;EACF,CAAC,CACF;EACDsB,QAAQ,EAAE;IACRf,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE,IAAI;IACdV,OAAO,EAAE,KAAK;IACdqB,IAAI,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK;EAC5B;AACF,CAAC,EACD;EACEE,GAAG,EAAE,IAAI;EACTC,UAAU,EAAE,OAAO;EACnBC,UAAU,EAAE,IAAI;EAChBC,MAAM,EAAE;IACNC,SAAS,EAAEA,CAACC,GAAG,EAAEC,GAAG,KAAK;MACvB,OAAOA,GAAG,CAACC,GAAG;MACd,OAAO;QACL,GAAGD;MACL,CAAC;IACH;EACF;AACF,CACF,CAAC;AAED,MAAME,KAAK,GAAG7B,iBAAQ,CAAC8B,KAAK,CAAC,OAAO,EAAE3B,WAAW,CAAC;AAAC,IAAA4B,QAAA,GAAAC,OAAA,CAAAlC,OAAA,GAEpC+B,KAAK","ignoreList":[]}},"mtime":1734874359469},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/cart.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst CartsSchema = new Schema({\n  uuid: {\n    type: String,\n    default: () => (0, _uuid.default)(),\n    unique: true,\n    required: true\n  },\n  completed: {\n    type: Boolean,\n    default: false,\n    required: true\n  },\n  buyer: {\n    type: ObjectId,\n    ref: \"Users\",\n    required: true\n  },\n  products: [{\n    productId: {\n      type: _mongoose.default.Schema.Types.ObjectId,\n      ref: \"Products\",\n      required: true\n    },\n    seller: {\n      type: _mongoose.default.Schema.Types.ObjectId,\n      ref: \"Sellers\",\n      required: true\n    },\n    // Ürünün sahibi olan satıcı\n    quantity: {\n      type: Number,\n      required: true\n    },\n    status: {\n      type: String,\n      enum: [\"pending\", \"processing\", \"completed\", \"canceled\"],\n      // Ürün durumları\n      default: \"pending\"\n    }\n  }],\n  currency: {\n    type: String,\n    required: true,\n    default: \"TRY\",\n    enum: [\"TRY\", \"USD\", \"EUR\"]\n  }\n}, {\n  _id: true,\n  collection: \"carts\",\n  timestamps: true,\n  toJSON: {\n    transform: (doc, ret) => {\n      delete ret.__v;\n      return {\n        ...ret\n      };\n    }\n  }\n});\nconst Carts = _mongoose.default.model(\"Carts\", CartsSchema);\nvar _default = exports.default = Carts;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl91dWlkIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiU2NoZW1hIiwibW9uZ29vc2UiLCJPYmplY3RJZCIsIlR5cGVzIiwiQ2FydHNTY2hlbWEiLCJ1dWlkIiwidHlwZSIsIlN0cmluZyIsInVuaXF1ZSIsInJlcXVpcmVkIiwiY29tcGxldGVkIiwiQm9vbGVhbiIsImJ1eWVyIiwicmVmIiwicHJvZHVjdHMiLCJwcm9kdWN0SWQiLCJzZWxsZXIiLCJxdWFudGl0eSIsIk51bWJlciIsInN0YXR1cyIsImVudW0iLCJjdXJyZW5jeSIsIl9pZCIsImNvbGxlY3Rpb24iLCJ0aW1lc3RhbXBzIiwidG9KU09OIiwidHJhbnNmb3JtIiwiZG9jIiwicmV0IiwiX192IiwiQ2FydHMiLCJtb2RlbCIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL2RiLyIsInNvdXJjZXMiOlsiY2FydC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UgZnJvbSBcIm1vbmdvb3NlXCI7XG5pbXBvcnQgdXVpZCBmcm9tIFwiLi4vdXRpbHMvdXVpZFwiO1xuXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWE7XG5jb25zdCB7IE9iamVjdElkIH0gPSBTY2hlbWEuVHlwZXM7XG5cbmNvbnN0IENhcnRzU2NoZW1hID0gbmV3IFNjaGVtYShcbiAge1xuICAgIHV1aWQ6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIGRlZmF1bHQ6ICgpID0+IHV1aWQoKSxcbiAgICAgIHVuaXF1ZTogdHJ1ZSxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgY29tcGxldGVkOiB7XG4gICAgICB0eXBlOiBCb29sZWFuLFxuICAgICAgZGVmYXVsdDogZmFsc2UsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGJ1eWVyOiB7XG4gICAgICB0eXBlOiBPYmplY3RJZCxcbiAgICAgIHJlZjogXCJVc2Vyc1wiLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBwcm9kdWN0czogW1xuICAgICAge1xuICAgICAgICBwcm9kdWN0SWQ6IHtcbiAgICAgICAgICB0eXBlOiBtb25nb29zZS5TY2hlbWEuVHlwZXMuT2JqZWN0SWQsXG4gICAgICAgICAgcmVmOiBcIlByb2R1Y3RzXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICAgIHNlbGxlcjoge1xuICAgICAgICAgIHR5cGU6IG1vbmdvb3NlLlNjaGVtYS5UeXBlcy5PYmplY3RJZCxcbiAgICAgICAgICByZWY6IFwiU2VsbGVyc1wiLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICB9LCAvLyDDnHLDvG7DvG4gc2FoaWJpIG9sYW4gc2F0xLFjxLFcbiAgICAgICAgcXVhbnRpdHk6IHtcbiAgICAgICAgICB0eXBlOiBOdW1iZXIsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgIH0sXG4gICAgICAgIHN0YXR1czoge1xuICAgICAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgICAgICBlbnVtOiBbXCJwZW5kaW5nXCIsIFwicHJvY2Vzc2luZ1wiLCBcImNvbXBsZXRlZFwiLCBcImNhbmNlbGVkXCJdLCAvLyDDnHLDvG4gZHVydW1sYXLEsVxuICAgICAgICAgIGRlZmF1bHQ6IFwicGVuZGluZ1wiLFxuICAgICAgICB9LFxuICAgICAgfSxcbiAgICBdLFxuICAgIGN1cnJlbmN5OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIGRlZmF1bHQ6IFwiVFJZXCIsXG4gICAgICBlbnVtOiBbXCJUUllcIiwgXCJVU0RcIiwgXCJFVVJcIl0sXG4gICAgfSxcbiAgfSxcbiAge1xuICAgIF9pZDogdHJ1ZSxcbiAgICBjb2xsZWN0aW9uOiBcImNhcnRzXCIsXG4gICAgdGltZXN0YW1wczogdHJ1ZSxcbiAgICB0b0pTT046IHtcbiAgICAgIHRyYW5zZm9ybTogKGRvYywgcmV0KSA9PiB7XG4gICAgICAgIGRlbGV0ZSByZXQuX192O1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLnJldCxcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgfSxcbiAgfVxuKTtcblxuY29uc3QgQ2FydHMgPSBtb25nb29zZS5tb2RlbChcIkNhcnRzXCIsIENhcnRzU2NoZW1hKTtcblxuZXhwb3J0IGRlZmF1bHQgQ2FydHM7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLEtBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUFpQyxTQUFBRCx1QkFBQUcsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUVqQyxNQUFNRyxNQUFNLEdBQUdDLGlCQUFRLENBQUNELE1BQU07QUFDOUIsTUFBTTtFQUFFRTtBQUFTLENBQUMsR0FBR0YsTUFBTSxDQUFDRyxLQUFLO0FBRWpDLE1BQU1DLFdBQVcsR0FBRyxJQUFJSixNQUFNLENBQzVCO0VBQ0VLLElBQUksRUFBRTtJQUNKQyxJQUFJLEVBQUVDLE1BQU07SUFDWlIsT0FBTyxFQUFFQSxDQUFBLEtBQU0sSUFBQU0sYUFBSSxFQUFDLENBQUM7SUFDckJHLE1BQU0sRUFBRSxJQUFJO0lBQ1pDLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDREMsU0FBUyxFQUFFO0lBQ1RKLElBQUksRUFBRUssT0FBTztJQUNiWixPQUFPLEVBQUUsS0FBSztJQUNkVSxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RHLEtBQUssRUFBRTtJQUNMTixJQUFJLEVBQUVKLFFBQVE7SUFDZFcsR0FBRyxFQUFFLE9BQU87SUFDWkosUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNESyxRQUFRLEVBQUUsQ0FDUjtJQUNFQyxTQUFTLEVBQUU7TUFDVFQsSUFBSSxFQUFFTCxpQkFBUSxDQUFDRCxNQUFNLENBQUNHLEtBQUssQ0FBQ0QsUUFBUTtNQUNwQ1csR0FBRyxFQUFFLFVBQVU7TUFDZkosUUFBUSxFQUFFO0lBQ1osQ0FBQztJQUNETyxNQUFNLEVBQUU7TUFDTlYsSUFBSSxFQUFFTCxpQkFBUSxDQUFDRCxNQUFNLENBQUNHLEtBQUssQ0FBQ0QsUUFBUTtNQUNwQ1csR0FBRyxFQUFFLFNBQVM7TUFDZEosUUFBUSxFQUFFO0lBQ1osQ0FBQztJQUFFO0lBQ0hRLFFBQVEsRUFBRTtNQUNSWCxJQUFJLEVBQUVZLE1BQU07TUFDWlQsUUFBUSxFQUFFO0lBQ1osQ0FBQztJQUNEVSxNQUFNLEVBQUU7TUFDTmIsSUFBSSxFQUFFQyxNQUFNO01BQ1phLElBQUksRUFBRSxDQUFDLFNBQVMsRUFBRSxZQUFZLEVBQUUsV0FBVyxFQUFFLFVBQVUsQ0FBQztNQUFFO01BQzFEckIsT0FBTyxFQUFFO0lBQ1g7RUFDRixDQUFDLENBQ0Y7RUFDRHNCLFFBQVEsRUFBRTtJQUNSZixJQUFJLEVBQUVDLE1BQU07SUFDWkUsUUFBUSxFQUFFLElBQUk7SUFDZFYsT0FBTyxFQUFFLEtBQUs7SUFDZHFCLElBQUksRUFBRSxDQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSztFQUM1QjtBQUNGLENBQUMsRUFDRDtFQUNFRSxHQUFHLEVBQUUsSUFBSTtFQUNUQyxVQUFVLEVBQUUsT0FBTztFQUNuQkMsVUFBVSxFQUFFLElBQUk7RUFDaEJDLE1BQU0sRUFBRTtJQUNOQyxTQUFTLEVBQUVBLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxLQUFLO01BQ3ZCLE9BQU9BLEdBQUcsQ0FBQ0MsR0FBRztNQUNkLE9BQU87UUFDTCxHQUFHRDtNQUNMLENBQUM7SUFDSDtFQUNGO0FBQ0YsQ0FDRixDQUFDO0FBRUQsTUFBTUUsS0FBSyxHQUFHN0IsaUJBQVEsQ0FBQzhCLEtBQUssQ0FBQyxPQUFPLEVBQUUzQixXQUFXLENBQUM7QUFBQyxJQUFBNEIsUUFBQSxHQUFBQyxPQUFBLENBQUFsQyxPQUFBLEdBRXBDK0IsS0FBSyIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","_uuid","e","__esModule","default","Schema","mongoose","ObjectId","Types","CartsSchema","uuid","type","String","unique","required","completed","Boolean","buyer","ref","products","productId","seller","quantity","Number","status","enum","currency","_id","collection","timestamps","toJSON","transform","doc","ret","__v","Carts","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["cart.js"],"sourcesContent":["import mongoose from \"mongoose\";\nimport uuid from \"../utils/uuid\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\n\nconst CartsSchema = new Schema(\n  {\n    uuid: {\n      type: String,\n      default: () => uuid(),\n      unique: true,\n      required: true,\n    },\n    completed: {\n      type: Boolean,\n      default: false,\n      required: true,\n    },\n    buyer: {\n      type: ObjectId,\n      ref: \"Users\",\n      required: true,\n    },\n    products: [\n      {\n        productId: {\n          type: mongoose.Schema.Types.ObjectId,\n          ref: \"Products\",\n          required: true,\n        },\n        seller: {\n          type: mongoose.Schema.Types.ObjectId,\n          ref: \"Sellers\",\n          required: true,\n        }, // Ürünün sahibi olan satıcı\n        quantity: {\n          type: Number,\n          required: true,\n        },\n        status: {\n          type: String,\n          enum: [\"pending\", \"processing\", \"completed\", \"canceled\"], // Ürün durumları\n          default: \"pending\",\n        },\n      },\n    ],\n    currency: {\n      type: String,\n      required: true,\n      default: \"TRY\",\n      enum: [\"TRY\", \"USD\", \"EUR\"],\n    },\n  },\n  {\n    _id: true,\n    collection: \"carts\",\n    timestamps: true,\n    toJSON: {\n      transform: (doc, ret) => {\n        delete ret.__v;\n        return {\n          ...ret,\n        };\n      },\n    },\n  }\n);\n\nconst Carts = mongoose.model(\"Carts\", CartsSchema);\n\nexport default Carts;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,KAAA,GAAAF,sBAAA,CAAAC,OAAA;AAAiC,SAAAD,uBAAAG,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEjC,MAAMG,MAAM,GAAGC,iBAAQ,CAACD,MAAM;AAC9B,MAAM;EAAEE;AAAS,CAAC,GAAGF,MAAM,CAACG,KAAK;AAEjC,MAAMC,WAAW,GAAG,IAAIJ,MAAM,CAC5B;EACEK,IAAI,EAAE;IACJC,IAAI,EAAEC,MAAM;IACZR,OAAO,EAAEA,CAAA,KAAM,IAAAM,aAAI,EAAC,CAAC;IACrBG,MAAM,EAAE,IAAI;IACZC,QAAQ,EAAE;EACZ,CAAC;EACDC,SAAS,EAAE;IACTJ,IAAI,EAAEK,OAAO;IACbZ,OAAO,EAAE,KAAK;IACdU,QAAQ,EAAE;EACZ,CAAC;EACDG,KAAK,EAAE;IACLN,IAAI,EAAEJ,QAAQ;IACdW,GAAG,EAAE,OAAO;IACZJ,QAAQ,EAAE;EACZ,CAAC;EACDK,QAAQ,EAAE,CACR;IACEC,SAAS,EAAE;MACTT,IAAI,EAAEL,iBAAQ,CAACD,MAAM,CAACG,KAAK,CAACD,QAAQ;MACpCW,GAAG,EAAE,UAAU;MACfJ,QAAQ,EAAE;IACZ,CAAC;IACDO,MAAM,EAAE;MACNV,IAAI,EAAEL,iBAAQ,CAACD,MAAM,CAACG,KAAK,CAACD,QAAQ;MACpCW,GAAG,EAAE,SAAS;MACdJ,QAAQ,EAAE;IACZ,CAAC;IAAE;IACHQ,QAAQ,EAAE;MACRX,IAAI,EAAEY,MAAM;MACZT,QAAQ,EAAE;IACZ,CAAC;IACDU,MAAM,EAAE;MACNb,IAAI,EAAEC,MAAM;MACZa,IAAI,EAAE,CAAC,SAAS,EAAE,YAAY,EAAE,WAAW,EAAE,UAAU,CAAC;MAAE;MAC1DrB,OAAO,EAAE;IACX;EACF,CAAC,CACF;EACDsB,QAAQ,EAAE;IACRf,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE,IAAI;IACdV,OAAO,EAAE,KAAK;IACdqB,IAAI,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK;EAC5B;AACF,CAAC,EACD;EACEE,GAAG,EAAE,IAAI;EACTC,UAAU,EAAE,OAAO;EACnBC,UAAU,EAAE,IAAI;EAChBC,MAAM,EAAE;IACNC,SAAS,EAAEA,CAACC,GAAG,EAAEC,GAAG,KAAK;MACvB,OAAOA,GAAG,CAACC,GAAG;MACd,OAAO;QACL,GAAGD;MACL,CAAC;IACH;EACF;AACF,CACF,CAAC;AAED,MAAME,KAAK,GAAG7B,iBAAQ,CAAC8B,KAAK,CAAC,OAAO,EAAE3B,WAAW,CAAC;AAAC,IAAA4B,QAAA,GAAAC,OAAA,CAAAlC,OAAA,GAEpC+B,KAAK","ignoreList":[]}},"mtime":1734874359469},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/cart.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _cart = _interopRequireDefault(require(\"../db/cart\"));\nvar _products = _interopRequireDefault(require(\"../db/products\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = router => {\n  // router.post(\"/carts\", Session, async (req, res, next) => {\n  //   try {\n  //     const { productId } = req.body;\n\n  //     // Ürünün geçerli olup olmadığını kontrol et\n  //     const product = await Products.findById(productId);\n  //     if (!product) {\n  //       throw new ApiError(\"Product not found\", 404, \"ProductNotFound\");\n  //     }\n\n  //     // Kullanıcının mevcut bir sepeti var mı kontrol et (Tamamlanmamış bir sepet)\n  //     let cart = await Cart.findOne({\n  //       buyer: req.user._id,\n  //       completed: false,\n  //     });\n\n  //     // Eğer mevcut bir sepet yoksa yeni bir sepet oluştur\n  //     if (!cart) {\n  //       cart = new Cart({\n  //         buyer: new mongoose.Types.ObjectId(req.user._id),\n  //       });\n  //     }\n\n  //     // Ürünü sepete ekle\n  //     cart.products.push(new mongoose.Types.ObjectId(productId));\n\n  //     // Sepeti kaydet\n  //     await cart.save();\n\n  //     res.status(200).json({\n  //       message: \"Product added on cart.\",\n  //       cart,\n  //     });\n  //   } catch (error) {\n  //     console.log(error);\n  //     throw new ApiError(\n  //       \"Cart could not be created\",\n  //       400,\n  //       \"cartCreationFailed\"\n  //     );\n  //   }\n  // });\n\n  router.post(\"/carts\", _Session.default, async (req, res, next) => {\n    try {\n      const {\n        productId,\n        quantity\n      } = req.body;\n\n      // Ürünün geçerli olup olmadığını kontrol et\n      const product = await _products.default.findById(productId);\n      if (!product) {\n        throw new _ApiError.default(\"Product not found\", 404, \"ProductNotFound\");\n      }\n      if (product.stock <= 0) {\n        throw new _ApiError.default(\"Product is out of\", 404, \"OutOfStock\");\n      }\n      if (product.stock < (quantity || 1)) {\n        throw new _ApiError.default(`Only ${product.stock} units of the product are available in stock`, 400, \"InsufficientStock\");\n      }\n\n      // Kullanıcının mevcut bir sepeti var mı kontrol et (Tamamlanmamış bir sepet)\n      let cart = await _cart.default.findOne({\n        buyer: req.user._id,\n        completed: false\n      });\n\n      // Eğer mevcut bir sepet yoksa yeni bir sepet oluştur\n      if (!cart) {\n        cart = new _cart.default({\n          buyer: new _mongoose.default.Types.ObjectId(req.user._id),\n          products: []\n        });\n      }\n\n      // Sepette zaten aynı ürün varsa miktarını artır, yoksa yeni ürün olarak ekle\n      const existingProductIndex = cart.products.findIndex(item => item.productId.toString() === productId);\n      if (existingProductIndex > -1) {\n        // // Eğer ürün zaten sepetteyse, miktarı artır\n        // cart.products[existingProductIndex].quantity += quantity || 1;\n        // Eğer ürün zaten sepetteyse, miktarı artır\n        const newQuantity = cart.products[existingProductIndex].quantity + (quantity || 1);\n        if (newQuantity > product.stock) {\n          throw new _ApiError.default(`Cannot add more than ${product.stock} units of the product to the cart`, 400, \"ExceedsStock\");\n        }\n        cart.products[existingProductIndex].quantity = newQuantity;\n      } else {\n        // Ürün sepette yoksa yeni ürün olarak ekle\n        cart.products.push({\n          productId: new _mongoose.default.Types.ObjectId(productId),\n          seller: product.seller,\n          // Ürünün satıcısını buraya ekliyoruz\n          quantity: quantity || 1,\n          // Gönderilen miktarı kullan veya 1 olarak ayarla\n          status: \"pending\" // Varsayılan olarak ürün durumu 'pending'\n        });\n      }\n\n      // Sepeti kaydet\n      await cart.save();\n      res.status(200).json({\n        message: \"Product added to cart.\",\n        cart\n      });\n    } catch (error) {\n      console.error(error);\n      next(new _ApiError.default(\"Cart could not be created\", 400, \"cartCreationFailed\"));\n    }\n  });\n  router.get(\"/getCart\", _Session.default, async (req, res) => {\n    try {\n      const cart = await _cart.default.findOne({\n        buyer: req.user._id,\n        completed: false\n      }).populate(\"products.productId\", \"name price images categories\").populate(\"products.seller\", \"name subMerchantKey\");\n      if (!cart) {\n        throw new _ApiError.default(\"No active Cart found\", 401, \"cartNotFound\");\n      }\n      res.status(200).json(cart);\n    } catch (error) {\n      console.log(error);\n      throw new _ApiError.default(\"Could not retrieve cart\", 400, \"getCartFailed\");\n    }\n  });\n  router.post(\"/delete-product-in-cart/:cartId\", _Session.default, async (req, res) => {\n    try {\n      const {\n        cartId\n      } = req.params;\n      const {\n        productId\n      } = req.body;\n      const cart = await _cart.default.findById(cartId);\n      if (!cart) {\n        throw new _ApiError.default(\"Cart not found\", 404, \"CartNotFound\");\n      }\n\n      // Cart'taki product'ların içinde productId'yi arıyoruz\n      const productIndex = cart.products.findIndex(item => item.productId.toString() === productId.toString());\n      if (productIndex > -1) {\n        // Ürünü bulduk, şimdi miktarı kontrol ediyoruz\n        if (cart.products[productIndex].quantity > 1) {\n          // Eğer miktar 1'den fazlaysa, miktarı azalt\n          cart.products[productIndex].quantity -= 1;\n        } else {\n          // Eğer miktar 1 ise ürünü tamamen sepetten kaldır\n          cart.products.splice(productIndex, 1);\n        }\n      } else {\n        throw new _ApiError.default(\"Product not found in cart\", 404, \"ProductNotFoundInCart\");\n      }\n      if (cart.products.length === 0) {\n        await _cart.default.findByIdAndDelete(cartId);\n        return res.status(200).json({\n          message: \"Cart is empty and has been deleted\"\n        });\n      }\n\n      // Sepeti kaydediyoruz\n      await cart.save();\n      res.status(200).json({\n        message: \"Product has been removed or quantity decreased.\",\n        cart\n      });\n    } catch (error) {\n      console.log(error);\n      return res.status(400).json({\n        message: \"Could not delete product from cart\",\n        error: error.message\n      });\n    }\n  });\n\n  // router.post(\"/delete-product-in-cart/:cartId\", Session, async (req, res) => {\n  //   try {\n  //     const { cartId } = req.params;\n  //     const { productId } = req.body;\n\n  //     const cart = await Cart.findById(cartId);\n  //     if (!cart) {\n  //       throw new ApiError(\"Cart not found\", 404, \"CartNotFound\");\n  //     }\n\n  //     // if (cart.buyer.toString() !== req.user._id.toString()) {\n  //     //   throw new ApiError(\n  //     //     \" You are not the owner of this cart\",\n  //     //     403,\n  //     //     \"youAreNotTheOwnerOfThisCart\"\n  //     //   );\n  //     // }\n\n  //     const productIndex = cart.products.indexOf(\n  //       new mongoose.Types.ObjectId(productId)\n  //     );\n  //     if (productIndex > -1) {\n  //       cart.products.splice(productIndex, 1);\n  //     } else {\n  //       throw new ApiError(\n  //         \"Product not found in cart\",\n  //         404,\n  //         \"ProductNotFoundInCart\"\n  //       );\n  //     }\n\n  //     await cart.save();\n\n  //     res.status(200).json({\n  //       message: \"Product has been removed.\",\n  //       cart,\n  //     });\n  //   } catch (error) {\n  //     console.log(error);\n  //     throw new ApiError(\n  //       \"Could not delete product from cart\",\n  //       400,\n  //       \"DeleteProductFailed\"\n  //     );\n  //   }\n  // });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9jYXJ0IiwiX3Byb2R1Y3RzIiwiX0FwaUVycm9yIiwiX1Nlc3Npb24iLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfZGVmYXVsdCIsInJvdXRlciIsInBvc3QiLCJTZXNzaW9uIiwicmVxIiwicmVzIiwibmV4dCIsInByb2R1Y3RJZCIsInF1YW50aXR5IiwiYm9keSIsInByb2R1Y3QiLCJQcm9kdWN0cyIsImZpbmRCeUlkIiwiQXBpRXJyb3IiLCJzdG9jayIsImNhcnQiLCJDYXJ0IiwiZmluZE9uZSIsImJ1eWVyIiwidXNlciIsIl9pZCIsImNvbXBsZXRlZCIsIm1vbmdvb3NlIiwiVHlwZXMiLCJPYmplY3RJZCIsInByb2R1Y3RzIiwiZXhpc3RpbmdQcm9kdWN0SW5kZXgiLCJmaW5kSW5kZXgiLCJpdGVtIiwidG9TdHJpbmciLCJuZXdRdWFudGl0eSIsInB1c2giLCJzZWxsZXIiLCJzdGF0dXMiLCJzYXZlIiwianNvbiIsIm1lc3NhZ2UiLCJlcnJvciIsImNvbnNvbGUiLCJnZXQiLCJwb3B1bGF0ZSIsImxvZyIsImNhcnRJZCIsInBhcmFtcyIsInByb2R1Y3RJbmRleCIsInNwbGljZSIsImxlbmd0aCIsImZpbmRCeUlkQW5kRGVsZXRlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3JvdXRlcy8iLCJzb3VyY2VzIjpbImNhcnQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlIGZyb20gXCJtb25nb29zZVwiO1xuaW1wb3J0IENhcnQgZnJvbSBcIi4uL2RiL2NhcnRcIjtcbmltcG9ydCBQcm9kdWN0cyBmcm9tIFwiLi4vZGIvcHJvZHVjdHNcIjtcbmltcG9ydCBBcGlFcnJvciBmcm9tIFwiLi4vZXJyb3JzL0FwaUVycm9yXCI7XG5pbXBvcnQgU2Vzc2lvbiBmcm9tIFwiLi4vbWlkZGxld2FyZXMvU2Vzc2lvblwiO1xuXG5leHBvcnQgZGVmYXVsdCAocm91dGVyKSA9PiB7XG4gIC8vIHJvdXRlci5wb3N0KFwiL2NhcnRzXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAvLyAgIHRyeSB7XG4gIC8vICAgICBjb25zdCB7IHByb2R1Y3RJZCB9ID0gcmVxLmJvZHk7XG5cbiAgLy8gICAgIC8vIMOccsO8bsO8biBnZcOnZXJsaSBvbHVwIG9sbWFkxLHEn8SxbsSxIGtvbnRyb2wgZXRcbiAgLy8gICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBQcm9kdWN0cy5maW5kQnlJZChwcm9kdWN0SWQpO1xuICAvLyAgICAgaWYgKCFwcm9kdWN0KSB7XG4gIC8vICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIlByb2R1Y3Qgbm90IGZvdW5kXCIsIDQwNCwgXCJQcm9kdWN0Tm90Rm91bmRcIik7XG4gIC8vICAgICB9XG5cbiAgLy8gICAgIC8vIEt1bGxhbsSxY8SxbsSxbiBtZXZjdXQgYmlyIHNlcGV0aSB2YXIgbcSxIGtvbnRyb2wgZXQgKFRhbWFtbGFubWFtxLHFnyBiaXIgc2VwZXQpXG4gIC8vICAgICBsZXQgY2FydCA9IGF3YWl0IENhcnQuZmluZE9uZSh7XG4gIC8vICAgICAgIGJ1eWVyOiByZXEudXNlci5faWQsXG4gIC8vICAgICAgIGNvbXBsZXRlZDogZmFsc2UsXG4gIC8vICAgICB9KTtcblxuICAvLyAgICAgLy8gRcSfZXIgbWV2Y3V0IGJpciBzZXBldCB5b2tzYSB5ZW5pIGJpciBzZXBldCBvbHXFn3R1clxuICAvLyAgICAgaWYgKCFjYXJ0KSB7XG4gIC8vICAgICAgIGNhcnQgPSBuZXcgQ2FydCh7XG4gIC8vICAgICAgICAgYnV5ZXI6IG5ldyBtb25nb29zZS5UeXBlcy5PYmplY3RJZChyZXEudXNlci5faWQpLFxuICAvLyAgICAgICB9KTtcbiAgLy8gICAgIH1cblxuICAvLyAgICAgLy8gw5xyw7xuw7wgc2VwZXRlIGVrbGVcbiAgLy8gICAgIGNhcnQucHJvZHVjdHMucHVzaChuZXcgbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQocHJvZHVjdElkKSk7XG5cbiAgLy8gICAgIC8vIFNlcGV0aSBrYXlkZXRcbiAgLy8gICAgIGF3YWl0IGNhcnQuc2F2ZSgpO1xuXG4gIC8vICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gIC8vICAgICAgIG1lc3NhZ2U6IFwiUHJvZHVjdCBhZGRlZCBvbiBjYXJ0LlwiLFxuICAvLyAgICAgICBjYXJ0LFxuICAvLyAgICAgfSk7XG4gIC8vICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgLy8gICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgLy8gICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgLy8gICAgICAgXCJDYXJ0IGNvdWxkIG5vdCBiZSBjcmVhdGVkXCIsXG4gIC8vICAgICAgIDQwMCxcbiAgLy8gICAgICAgXCJjYXJ0Q3JlYXRpb25GYWlsZWRcIlxuICAvLyAgICAgKTtcbiAgLy8gICB9XG4gIC8vIH0pO1xuXG4gIHJvdXRlci5wb3N0KFwiL2NhcnRzXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IHByb2R1Y3RJZCwgcXVhbnRpdHkgfSA9IHJlcS5ib2R5O1xuXG4gICAgICAvLyDDnHLDvG7DvG4gZ2XDp2VybGkgb2x1cCBvbG1hZMSxxJ/EsW7EsSBrb250cm9sIGV0XG4gICAgICBjb25zdCBwcm9kdWN0ID0gYXdhaXQgUHJvZHVjdHMuZmluZEJ5SWQocHJvZHVjdElkKTtcbiAgICAgIGlmICghcHJvZHVjdCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJQcm9kdWN0IG5vdCBmb3VuZFwiLCA0MDQsIFwiUHJvZHVjdE5vdEZvdW5kXCIpO1xuICAgICAgfVxuXG4gICAgICBpZiAocHJvZHVjdC5zdG9jayA8PSAwKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIlByb2R1Y3QgaXMgb3V0IG9mXCIsIDQwNCwgXCJPdXRPZlN0b2NrXCIpO1xuICAgICAgfVxuICAgICAgaWYgKHByb2R1Y3Quc3RvY2sgPCAocXVhbnRpdHkgfHwgMSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIGBPbmx5ICR7cHJvZHVjdC5zdG9ja30gdW5pdHMgb2YgdGhlIHByb2R1Y3QgYXJlIGF2YWlsYWJsZSBpbiBzdG9ja2AsXG4gICAgICAgICAgNDAwLFxuICAgICAgICAgIFwiSW5zdWZmaWNpZW50U3RvY2tcIlxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICAvLyBLdWxsYW7EsWPEsW7EsW4gbWV2Y3V0IGJpciBzZXBldGkgdmFyIG3EsSBrb250cm9sIGV0IChUYW1hbWxhbm1hbcSxxZ8gYmlyIHNlcGV0KVxuICAgICAgbGV0IGNhcnQgPSBhd2FpdCBDYXJ0LmZpbmRPbmUoe1xuICAgICAgICBidXllcjogcmVxLnVzZXIuX2lkLFxuICAgICAgICBjb21wbGV0ZWQ6IGZhbHNlLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIEXEn2VyIG1ldmN1dCBiaXIgc2VwZXQgeW9rc2EgeWVuaSBiaXIgc2VwZXQgb2x1xZ90dXJcbiAgICAgIGlmICghY2FydCkge1xuICAgICAgICBjYXJ0ID0gbmV3IENhcnQoe1xuICAgICAgICAgIGJ1eWVyOiBuZXcgbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQocmVxLnVzZXIuX2lkKSxcbiAgICAgICAgICBwcm9kdWN0czogW10sXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBTZXBldHRlIHphdGVuIGF5bsSxIMO8csO8biB2YXJzYSBtaWt0YXLEsW7EsSBhcnTEsXIsIHlva3NhIHllbmkgw7xyw7xuIG9sYXJhayBla2xlXG4gICAgICBjb25zdCBleGlzdGluZ1Byb2R1Y3RJbmRleCA9IGNhcnQucHJvZHVjdHMuZmluZEluZGV4KFxuICAgICAgICAoaXRlbSkgPT4gaXRlbS5wcm9kdWN0SWQudG9TdHJpbmcoKSA9PT0gcHJvZHVjdElkXG4gICAgICApO1xuXG4gICAgICBpZiAoZXhpc3RpbmdQcm9kdWN0SW5kZXggPiAtMSkge1xuICAgICAgICAvLyAvLyBFxJ9lciDDvHLDvG4gemF0ZW4gc2VwZXR0ZXlzZSwgbWlrdGFyxLEgYXJ0xLFyXG4gICAgICAgIC8vIGNhcnQucHJvZHVjdHNbZXhpc3RpbmdQcm9kdWN0SW5kZXhdLnF1YW50aXR5ICs9IHF1YW50aXR5IHx8IDE7XG4gICAgICAgIC8vIEXEn2VyIMO8csO8biB6YXRlbiBzZXBldHRleXNlLCBtaWt0YXLEsSBhcnTEsXJcbiAgICAgICAgY29uc3QgbmV3UXVhbnRpdHkgPVxuICAgICAgICAgIGNhcnQucHJvZHVjdHNbZXhpc3RpbmdQcm9kdWN0SW5kZXhdLnF1YW50aXR5ICsgKHF1YW50aXR5IHx8IDEpO1xuXG4gICAgICAgIGlmIChuZXdRdWFudGl0eSA+IHByb2R1Y3Quc3RvY2spIHtcbiAgICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgICBgQ2Fubm90IGFkZCBtb3JlIHRoYW4gJHtwcm9kdWN0LnN0b2NrfSB1bml0cyBvZiB0aGUgcHJvZHVjdCB0byB0aGUgY2FydGAsXG4gICAgICAgICAgICA0MDAsXG4gICAgICAgICAgICBcIkV4Y2VlZHNTdG9ja1wiXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNhcnQucHJvZHVjdHNbZXhpc3RpbmdQcm9kdWN0SW5kZXhdLnF1YW50aXR5ID0gbmV3UXVhbnRpdHk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyDDnHLDvG4gc2VwZXR0ZSB5b2tzYSB5ZW5pIMO8csO8biBvbGFyYWsgZWtsZVxuICAgICAgICBjYXJ0LnByb2R1Y3RzLnB1c2goe1xuICAgICAgICAgIHByb2R1Y3RJZDogbmV3IG1vbmdvb3NlLlR5cGVzLk9iamVjdElkKHByb2R1Y3RJZCksXG4gICAgICAgICAgc2VsbGVyOiBwcm9kdWN0LnNlbGxlciwgLy8gw5xyw7xuw7xuIHNhdMSxY8Sxc8SxbsSxIGJ1cmF5YSBla2xpeW9ydXpcbiAgICAgICAgICBxdWFudGl0eTogcXVhbnRpdHkgfHwgMSwgLy8gR8O2bmRlcmlsZW4gbWlrdGFyxLEga3VsbGFuIHZleWEgMSBvbGFyYWsgYXlhcmxhXG4gICAgICAgICAgc3RhdHVzOiBcInBlbmRpbmdcIiwgLy8gVmFyc2F5xLFsYW4gb2xhcmFrIMO8csO8biBkdXJ1bXUgJ3BlbmRpbmcnXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBTZXBldGkga2F5ZGV0XG4gICAgICBhd2FpdCBjYXJ0LnNhdmUoKTtcblxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgICBtZXNzYWdlOiBcIlByb2R1Y3QgYWRkZWQgdG8gY2FydC5cIixcbiAgICAgICAgY2FydCxcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgIG5leHQoXG4gICAgICAgIG5ldyBBcGlFcnJvcihcIkNhcnQgY291bGQgbm90IGJlIGNyZWF0ZWRcIiwgNDAwLCBcImNhcnRDcmVhdGlvbkZhaWxlZFwiKVxuICAgICAgKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJvdXRlci5nZXQoXCIvZ2V0Q2FydFwiLCBTZXNzaW9uLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgY2FydCA9IGF3YWl0IENhcnQuZmluZE9uZSh7XG4gICAgICAgIGJ1eWVyOiByZXEudXNlci5faWQsXG4gICAgICAgIGNvbXBsZXRlZDogZmFsc2UsXG4gICAgICB9KVxuICAgICAgICAucG9wdWxhdGUoXCJwcm9kdWN0cy5wcm9kdWN0SWRcIiwgXCJuYW1lIHByaWNlIGltYWdlcyBjYXRlZ29yaWVzXCIpXG4gICAgICAgIC5wb3B1bGF0ZShcInByb2R1Y3RzLnNlbGxlclwiLCBcIm5hbWUgc3ViTWVyY2hhbnRLZXlcIik7XG5cbiAgICAgIGlmICghY2FydCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJObyBhY3RpdmUgQ2FydCBmb3VuZFwiLCA0MDEsIFwiY2FydE5vdEZvdW5kXCIpO1xuICAgICAgfVxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oY2FydCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNvdWxkIG5vdCByZXRyaWV2ZSBjYXJ0XCIsIDQwMCwgXCJnZXRDYXJ0RmFpbGVkXCIpO1xuICAgIH1cbiAgfSk7XG5cbiAgcm91dGVyLnBvc3QoXCIvZGVsZXRlLXByb2R1Y3QtaW4tY2FydC86Y2FydElkXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGNhcnRJZCB9ID0gcmVxLnBhcmFtcztcbiAgICAgIGNvbnN0IHsgcHJvZHVjdElkIH0gPSByZXEuYm9keTtcblxuICAgICAgY29uc3QgY2FydCA9IGF3YWl0IENhcnQuZmluZEJ5SWQoY2FydElkKTtcbiAgICAgIGlmICghY2FydCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJ0IG5vdCBmb3VuZFwiLCA0MDQsIFwiQ2FydE5vdEZvdW5kXCIpO1xuICAgICAgfVxuXG4gICAgICAvLyBDYXJ0J3Rha2kgcHJvZHVjdCdsYXLEsW4gacOnaW5kZSBwcm9kdWN0SWQneWkgYXLEsXlvcnV6XG4gICAgICBjb25zdCBwcm9kdWN0SW5kZXggPSBjYXJ0LnByb2R1Y3RzLmZpbmRJbmRleChcbiAgICAgICAgKGl0ZW0pID0+IGl0ZW0ucHJvZHVjdElkLnRvU3RyaW5nKCkgPT09IHByb2R1Y3RJZC50b1N0cmluZygpXG4gICAgICApO1xuXG4gICAgICBpZiAocHJvZHVjdEluZGV4ID4gLTEpIHtcbiAgICAgICAgLy8gw5xyw7xuw7wgYnVsZHVrLCDFn2ltZGkgbWlrdGFyxLEga29udHJvbCBlZGl5b3J1elxuICAgICAgICBpZiAoY2FydC5wcm9kdWN0c1twcm9kdWN0SW5kZXhdLnF1YW50aXR5ID4gMSkge1xuICAgICAgICAgIC8vIEXEn2VyIG1pa3RhciAxJ2RlbiBmYXpsYXlzYSwgbWlrdGFyxLEgYXphbHRcbiAgICAgICAgICBjYXJ0LnByb2R1Y3RzW3Byb2R1Y3RJbmRleF0ucXVhbnRpdHkgLT0gMTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBFxJ9lciBtaWt0YXIgMSBpc2Ugw7xyw7xuw7wgdGFtYW1lbiBzZXBldHRlbiBrYWxkxLFyXG4gICAgICAgICAgY2FydC5wcm9kdWN0cy5zcGxpY2UocHJvZHVjdEluZGV4LCAxKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIFwiUHJvZHVjdCBub3QgZm91bmQgaW4gY2FydFwiLFxuICAgICAgICAgIDQwNCxcbiAgICAgICAgICBcIlByb2R1Y3ROb3RGb3VuZEluQ2FydFwiXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGlmIChjYXJ0LnByb2R1Y3RzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBhd2FpdCBDYXJ0LmZpbmRCeUlkQW5kRGVsZXRlKGNhcnRJZCk7XG4gICAgICAgIHJldHVybiByZXNcbiAgICAgICAgICAuc3RhdHVzKDIwMClcbiAgICAgICAgICAuanNvbih7IG1lc3NhZ2U6IFwiQ2FydCBpcyBlbXB0eSBhbmQgaGFzIGJlZW4gZGVsZXRlZFwiIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBTZXBldGkga2F5ZGVkaXlvcnV6XG4gICAgICBhd2FpdCBjYXJ0LnNhdmUoKTtcblxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgICBtZXNzYWdlOiBcIlByb2R1Y3QgaGFzIGJlZW4gcmVtb3ZlZCBvciBxdWFudGl0eSBkZWNyZWFzZWQuXCIsXG4gICAgICAgIGNhcnQsXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcbiAgICAgICAgbWVzc2FnZTogXCJDb3VsZCBub3QgZGVsZXRlIHByb2R1Y3QgZnJvbSBjYXJ0XCIsXG4gICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxuICAgICAgfSk7XG4gICAgfVxuICB9KTtcblxuICAvLyByb3V0ZXIucG9zdChcIi9kZWxldGUtcHJvZHVjdC1pbi1jYXJ0LzpjYXJ0SWRcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gIC8vICAgdHJ5IHtcbiAgLy8gICAgIGNvbnN0IHsgY2FydElkIH0gPSByZXEucGFyYW1zO1xuICAvLyAgICAgY29uc3QgeyBwcm9kdWN0SWQgfSA9IHJlcS5ib2R5O1xuXG4gIC8vICAgICBjb25zdCBjYXJ0ID0gYXdhaXQgQ2FydC5maW5kQnlJZChjYXJ0SWQpO1xuICAvLyAgICAgaWYgKCFjYXJ0KSB7XG4gIC8vICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgbm90IGZvdW5kXCIsIDQwNCwgXCJDYXJ0Tm90Rm91bmRcIik7XG4gIC8vICAgICB9XG5cbiAgLy8gICAgIC8vIGlmIChjYXJ0LmJ1eWVyLnRvU3RyaW5nKCkgIT09IHJlcS51c2VyLl9pZC50b1N0cmluZygpKSB7XG4gIC8vICAgICAvLyAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgLy8gICAgIC8vICAgICBcIiBZb3UgYXJlIG5vdCB0aGUgb3duZXIgb2YgdGhpcyBjYXJ0XCIsXG4gIC8vICAgICAvLyAgICAgNDAzLFxuICAvLyAgICAgLy8gICAgIFwieW91QXJlTm90VGhlT3duZXJPZlRoaXNDYXJ0XCJcbiAgLy8gICAgIC8vICAgKTtcbiAgLy8gICAgIC8vIH1cblxuICAvLyAgICAgY29uc3QgcHJvZHVjdEluZGV4ID0gY2FydC5wcm9kdWN0cy5pbmRleE9mKFxuICAvLyAgICAgICBuZXcgbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQocHJvZHVjdElkKVxuICAvLyAgICAgKTtcbiAgLy8gICAgIGlmIChwcm9kdWN0SW5kZXggPiAtMSkge1xuICAvLyAgICAgICBjYXJ0LnByb2R1Y3RzLnNwbGljZShwcm9kdWN0SW5kZXgsIDEpO1xuICAvLyAgICAgfSBlbHNlIHtcbiAgLy8gICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAvLyAgICAgICAgIFwiUHJvZHVjdCBub3QgZm91bmQgaW4gY2FydFwiLFxuICAvLyAgICAgICAgIDQwNCxcbiAgLy8gICAgICAgICBcIlByb2R1Y3ROb3RGb3VuZEluQ2FydFwiXG4gIC8vICAgICAgICk7XG4gIC8vICAgICB9XG5cbiAgLy8gICAgIGF3YWl0IGNhcnQuc2F2ZSgpO1xuXG4gIC8vICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gIC8vICAgICAgIG1lc3NhZ2U6IFwiUHJvZHVjdCBoYXMgYmVlbiByZW1vdmVkLlwiLFxuICAvLyAgICAgICBjYXJ0LFxuICAvLyAgICAgfSk7XG4gIC8vICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgLy8gICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgLy8gICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgLy8gICAgICAgXCJDb3VsZCBub3QgZGVsZXRlIHByb2R1Y3QgZnJvbSBjYXJ0XCIsXG4gIC8vICAgICAgIDQwMCxcbiAgLy8gICAgICAgXCJEZWxldGVQcm9kdWN0RmFpbGVkXCJcbiAgLy8gICAgICk7XG4gIC8vICAgfVxuICAvLyB9KTtcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLEtBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLFNBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFHLFNBQUEsR0FBQUosc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFJLFFBQUEsR0FBQUwsc0JBQUEsQ0FBQUMsT0FBQTtBQUE2QyxTQUFBRCx1QkFBQU0sQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFB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","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","_cart","_products","_ApiError","_Session","e","__esModule","default","_default","router","post","Session","req","res","next","productId","quantity","body","product","Products","findById","ApiError","stock","cart","Cart","findOne","buyer","user","_id","completed","mongoose","Types","ObjectId","products","existingProductIndex","findIndex","item","toString","newQuantity","push","seller","status","save","json","message","error","console","get","populate","log","cartId","params","productIndex","splice","length","findByIdAndDelete","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["cart.js"],"sourcesContent":["import mongoose from \"mongoose\";\nimport Cart from \"../db/cart\";\nimport Products from \"../db/products\";\nimport ApiError from \"../errors/ApiError\";\nimport Session from \"../middlewares/Session\";\n\nexport default (router) => {\n  // router.post(\"/carts\", Session, async (req, res, next) => {\n  //   try {\n  //     const { productId } = req.body;\n\n  //     // Ürünün geçerli olup olmadığını kontrol et\n  //     const product = await Products.findById(productId);\n  //     if (!product) {\n  //       throw new ApiError(\"Product not found\", 404, \"ProductNotFound\");\n  //     }\n\n  //     // Kullanıcının mevcut bir sepeti var mı kontrol et (Tamamlanmamış bir sepet)\n  //     let cart = await Cart.findOne({\n  //       buyer: req.user._id,\n  //       completed: false,\n  //     });\n\n  //     // Eğer mevcut bir sepet yoksa yeni bir sepet oluştur\n  //     if (!cart) {\n  //       cart = new Cart({\n  //         buyer: new mongoose.Types.ObjectId(req.user._id),\n  //       });\n  //     }\n\n  //     // Ürünü sepete ekle\n  //     cart.products.push(new mongoose.Types.ObjectId(productId));\n\n  //     // Sepeti kaydet\n  //     await cart.save();\n\n  //     res.status(200).json({\n  //       message: \"Product added on cart.\",\n  //       cart,\n  //     });\n  //   } catch (error) {\n  //     console.log(error);\n  //     throw new ApiError(\n  //       \"Cart could not be created\",\n  //       400,\n  //       \"cartCreationFailed\"\n  //     );\n  //   }\n  // });\n\n  router.post(\"/carts\", Session, async (req, res, next) => {\n    try {\n      const { productId, quantity } = req.body;\n\n      // Ürünün geçerli olup olmadığını kontrol et\n      const product = await Products.findById(productId);\n      if (!product) {\n        throw new ApiError(\"Product not found\", 404, \"ProductNotFound\");\n      }\n\n      if (product.stock <= 0) {\n        throw new ApiError(\"Product is out of\", 404, \"OutOfStock\");\n      }\n      if (product.stock < (quantity || 1)) {\n        throw new ApiError(\n          `Only ${product.stock} units of the product are available in stock`,\n          400,\n          \"InsufficientStock\"\n        );\n      }\n\n      // Kullanıcının mevcut bir sepeti var mı kontrol et (Tamamlanmamış bir sepet)\n      let cart = await Cart.findOne({\n        buyer: req.user._id,\n        completed: false,\n      });\n\n      // Eğer mevcut bir sepet yoksa yeni bir sepet oluştur\n      if (!cart) {\n        cart = new Cart({\n          buyer: new mongoose.Types.ObjectId(req.user._id),\n          products: [],\n        });\n      }\n\n      // Sepette zaten aynı ürün varsa miktarını artır, yoksa yeni ürün olarak ekle\n      const existingProductIndex = cart.products.findIndex(\n        (item) => item.productId.toString() === productId\n      );\n\n      if (existingProductIndex > -1) {\n        // // Eğer ürün zaten sepetteyse, miktarı artır\n        // cart.products[existingProductIndex].quantity += quantity || 1;\n        // Eğer ürün zaten sepetteyse, miktarı artır\n        const newQuantity =\n          cart.products[existingProductIndex].quantity + (quantity || 1);\n\n        if (newQuantity > product.stock) {\n          throw new ApiError(\n            `Cannot add more than ${product.stock} units of the product to the cart`,\n            400,\n            \"ExceedsStock\"\n          );\n        }\n\n        cart.products[existingProductIndex].quantity = newQuantity;\n      } else {\n        // Ürün sepette yoksa yeni ürün olarak ekle\n        cart.products.push({\n          productId: new mongoose.Types.ObjectId(productId),\n          seller: product.seller, // Ürünün satıcısını buraya ekliyoruz\n          quantity: quantity || 1, // Gönderilen miktarı kullan veya 1 olarak ayarla\n          status: \"pending\", // Varsayılan olarak ürün durumu 'pending'\n        });\n      }\n\n      // Sepeti kaydet\n      await cart.save();\n\n      res.status(200).json({\n        message: \"Product added to cart.\",\n        cart,\n      });\n    } catch (error) {\n      console.error(error);\n      next(\n        new ApiError(\"Cart could not be created\", 400, \"cartCreationFailed\")\n      );\n    }\n  });\n\n  router.get(\"/getCart\", Session, async (req, res) => {\n    try {\n      const cart = await Cart.findOne({\n        buyer: req.user._id,\n        completed: false,\n      })\n        .populate(\"products.productId\", \"name price images categories\")\n        .populate(\"products.seller\", \"name subMerchantKey\");\n\n      if (!cart) {\n        throw new ApiError(\"No active Cart found\", 401, \"cartNotFound\");\n      }\n      res.status(200).json(cart);\n    } catch (error) {\n      console.log(error);\n      throw new ApiError(\"Could not retrieve cart\", 400, \"getCartFailed\");\n    }\n  });\n\n  router.post(\"/delete-product-in-cart/:cartId\", Session, async (req, res) => {\n    try {\n      const { cartId } = req.params;\n      const { productId } = req.body;\n\n      const cart = await Cart.findById(cartId);\n      if (!cart) {\n        throw new ApiError(\"Cart not found\", 404, \"CartNotFound\");\n      }\n\n      // Cart'taki product'ların içinde productId'yi arıyoruz\n      const productIndex = cart.products.findIndex(\n        (item) => item.productId.toString() === productId.toString()\n      );\n\n      if (productIndex > -1) {\n        // Ürünü bulduk, şimdi miktarı kontrol ediyoruz\n        if (cart.products[productIndex].quantity > 1) {\n          // Eğer miktar 1'den fazlaysa, miktarı azalt\n          cart.products[productIndex].quantity -= 1;\n        } else {\n          // Eğer miktar 1 ise ürünü tamamen sepetten kaldır\n          cart.products.splice(productIndex, 1);\n        }\n      } else {\n        throw new ApiError(\n          \"Product not found in cart\",\n          404,\n          \"ProductNotFoundInCart\"\n        );\n      }\n\n      if (cart.products.length === 0) {\n        await Cart.findByIdAndDelete(cartId);\n        return res\n          .status(200)\n          .json({ message: \"Cart is empty and has been deleted\" });\n      }\n\n      // Sepeti kaydediyoruz\n      await cart.save();\n\n      res.status(200).json({\n        message: \"Product has been removed or quantity decreased.\",\n        cart,\n      });\n    } catch (error) {\n      console.log(error);\n      return res.status(400).json({\n        message: \"Could not delete product from cart\",\n        error: error.message,\n      });\n    }\n  });\n\n  // router.post(\"/delete-product-in-cart/:cartId\", Session, async (req, res) => {\n  //   try {\n  //     const { cartId } = req.params;\n  //     const { productId } = req.body;\n\n  //     const cart = await Cart.findById(cartId);\n  //     if (!cart) {\n  //       throw new ApiError(\"Cart not found\", 404, \"CartNotFound\");\n  //     }\n\n  //     // if (cart.buyer.toString() !== req.user._id.toString()) {\n  //     //   throw new ApiError(\n  //     //     \" You are not the owner of this cart\",\n  //     //     403,\n  //     //     \"youAreNotTheOwnerOfThisCart\"\n  //     //   );\n  //     // }\n\n  //     const productIndex = cart.products.indexOf(\n  //       new mongoose.Types.ObjectId(productId)\n  //     );\n  //     if (productIndex > -1) {\n  //       cart.products.splice(productIndex, 1);\n  //     } else {\n  //       throw new ApiError(\n  //         \"Product not found in cart\",\n  //         404,\n  //         \"ProductNotFoundInCart\"\n  //       );\n  //     }\n\n  //     await cart.save();\n\n  //     res.status(200).json({\n  //       message: \"Product has been removed.\",\n  //       cart,\n  //     });\n  //   } catch (error) {\n  //     console.log(error);\n  //     throw new ApiError(\n  //       \"Could not delete product from cart\",\n  //       400,\n  //       \"DeleteProductFailed\"\n  //     );\n  //   }\n  // });\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1734270863690},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/cart.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _cart = _interopRequireDefault(require(\"../db/cart\"));\nvar _products = _interopRequireDefault(require(\"../db/products\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = router => {\n  // router.post(\"/carts\", Session, async (req, res, next) => {\n  //   try {\n  //     const { productId } = req.body;\n\n  //     // Ürünün geçerli olup olmadığını kontrol et\n  //     const product = await Products.findById(productId);\n  //     if (!product) {\n  //       throw new ApiError(\"Product not found\", 404, \"ProductNotFound\");\n  //     }\n\n  //     // Kullanıcının mevcut bir sepeti var mı kontrol et (Tamamlanmamış bir sepet)\n  //     let cart = await Cart.findOne({\n  //       buyer: req.user._id,\n  //       completed: false,\n  //     });\n\n  //     // Eğer mevcut bir sepet yoksa yeni bir sepet oluştur\n  //     if (!cart) {\n  //       cart = new Cart({\n  //         buyer: new mongoose.Types.ObjectId(req.user._id),\n  //       });\n  //     }\n\n  //     // Ürünü sepete ekle\n  //     cart.products.push(new mongoose.Types.ObjectId(productId));\n\n  //     // Sepeti kaydet\n  //     await cart.save();\n\n  //     res.status(200).json({\n  //       message: \"Product added on cart.\",\n  //       cart,\n  //     });\n  //   } catch (error) {\n  //     console.log(error);\n  //     throw new ApiError(\n  //       \"Cart could not be created\",\n  //       400,\n  //       \"cartCreationFailed\"\n  //     );\n  //   }\n  // });\n\n  router.post(\"/carts\", _Session.default, async (req, res, next) => {\n    try {\n      const {\n        productId,\n        quantity\n      } = req.body;\n\n      // Ürünün geçerli olup olmadığını kontrol et\n      const product = await _products.default.findById(productId);\n      if (!product) {\n        throw new _ApiError.default(\"Product not found\", 404, \"ProductNotFound\");\n      }\n      if (product.stock <= 0) {\n        throw new _ApiError.default(\"Product is out of\", 404, \"OutOfStock\");\n      }\n      if (product.stock < (quantity || 1)) {\n        throw new _ApiError.default(`Only ${product.stock} units of the product are available in stock`, 400, \"InsufficientStock\");\n      }\n\n      // Kullanıcının mevcut bir sepeti var mı kontrol et (Tamamlanmamış bir sepet)\n      let cart = await _cart.default.findOne({\n        buyer: req.user._id,\n        completed: false\n      });\n\n      // Eğer mevcut bir sepet yoksa yeni bir sepet oluştur\n      if (!cart) {\n        cart = new _cart.default({\n          buyer: new _mongoose.default.Types.ObjectId(req.user._id),\n          products: []\n        });\n      }\n\n      // Sepette zaten aynı ürün varsa miktarını artır, yoksa yeni ürün olarak ekle\n      const existingProductIndex = cart.products.findIndex(item => item.productId.toString() === productId);\n      if (existingProductIndex > -1) {\n        // // Eğer ürün zaten sepetteyse, miktarı artır\n        // cart.products[existingProductIndex].quantity += quantity || 1;\n        // Eğer ürün zaten sepetteyse, miktarı artır\n        const newQuantity = cart.products[existingProductIndex].quantity + (quantity || 1);\n        if (newQuantity > product.stock) {\n          throw new _ApiError.default(`Cannot add more than ${product.stock} units of the product to the cart`, 400, \"ExceedsStock\");\n        }\n        cart.products[existingProductIndex].quantity = newQuantity;\n      } else {\n        // Ürün sepette yoksa yeni ürün olarak ekle\n        cart.products.push({\n          productId: new _mongoose.default.Types.ObjectId(productId),\n          seller: product.seller,\n          // Ürünün satıcısını buraya ekliyoruz\n          quantity: quantity || 1,\n          // Gönderilen miktarı kullan veya 1 olarak ayarla\n          status: \"pending\" // Varsayılan olarak ürün durumu 'pending'\n        });\n      }\n\n      // Sepeti kaydet\n      await cart.save();\n      res.status(200).json({\n        message: \"Product added to cart.\",\n        cart\n      });\n    } catch (error) {\n      console.error(error);\n      next(new _ApiError.default(\"Cart could not be created\", 400, \"cartCreationFailed\"));\n    }\n  });\n  router.get(\"/getCart\", _Session.default, async (req, res) => {\n    try {\n      const cart = await _cart.default.findOne({\n        buyer: req.user._id,\n        completed: false\n      }).populate(\"products.productId\", \"name price images categories\").populate(\"products.seller\", \"name subMerchantKey\");\n      if (!cart) {\n        throw new _ApiError.default(\"No active Cart found\", 401, \"cartNotFound\");\n      }\n      res.status(200).json(cart);\n    } catch (error) {\n      console.log(error);\n      throw new _ApiError.default(\"Could not retrieve cart\", 400, \"getCartFailed\");\n    }\n  });\n  router.post(\"/delete-product-in-cart/:cartId\", _Session.default, async (req, res) => {\n    try {\n      const {\n        cartId\n      } = req.params;\n      const {\n        productId\n      } = req.body;\n      const cart = await _cart.default.findById(cartId);\n      if (!cart) {\n        throw new _ApiError.default(\"Cart not found\", 404, \"CartNotFound\");\n      }\n\n      // Cart'taki product'ların içinde productId'yi arıyoruz\n      const productIndex = cart.products.findIndex(item => item.productId.toString() === productId.toString());\n      if (productIndex > -1) {\n        // Ürünü bulduk, şimdi miktarı kontrol ediyoruz\n        if (cart.products[productIndex].quantity > 1) {\n          // Eğer miktar 1'den fazlaysa, miktarı azalt\n          cart.products[productIndex].quantity -= 1;\n        } else {\n          // Eğer miktar 1 ise ürünü tamamen sepetten kaldır\n          cart.products.splice(productIndex, 1);\n        }\n      } else {\n        throw new _ApiError.default(\"Product not found in cart\", 404, \"ProductNotFoundInCart\");\n      }\n      if (cart.products.length === 0) {\n        await _cart.default.findByIdAndDelete(cartId);\n        return res.status(200).json({\n          message: \"Cart is empty and has been deleted\"\n        });\n      }\n\n      // Sepeti kaydediyoruz\n      await cart.save();\n      res.status(200).json({\n        message: \"Product has been removed or quantity decreased.\",\n        cart\n      });\n    } catch (error) {\n      console.log(error);\n      return res.status(400).json({\n        message: \"Could not delete product from cart\",\n        error: error.message\n      });\n    }\n  });\n\n  // router.post(\"/delete-product-in-cart/:cartId\", Session, async (req, res) => {\n  //   try {\n  //     const { cartId } = req.params;\n  //     const { productId } = req.body;\n\n  //     const cart = await Cart.findById(cartId);\n  //     if (!cart) {\n  //       throw new ApiError(\"Cart not found\", 404, \"CartNotFound\");\n  //     }\n\n  //     // if (cart.buyer.toString() !== req.user._id.toString()) {\n  //     //   throw new ApiError(\n  //     //     \" You are not the owner of this cart\",\n  //     //     403,\n  //     //     \"youAreNotTheOwnerOfThisCart\"\n  //     //   );\n  //     // }\n\n  //     const productIndex = cart.products.indexOf(\n  //       new mongoose.Types.ObjectId(productId)\n  //     );\n  //     if (productIndex > -1) {\n  //       cart.products.splice(productIndex, 1);\n  //     } else {\n  //       throw new ApiError(\n  //         \"Product not found in cart\",\n  //         404,\n  //         \"ProductNotFoundInCart\"\n  //       );\n  //     }\n\n  //     await cart.save();\n\n  //     res.status(200).json({\n  //       message: \"Product has been removed.\",\n  //       cart,\n  //     });\n  //   } catch (error) {\n  //     console.log(error);\n  //     throw new ApiError(\n  //       \"Could not delete product from cart\",\n  //       400,\n  //       \"DeleteProductFailed\"\n  //     );\n  //   }\n  // });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9jYXJ0IiwiX3Byb2R1Y3RzIiwiX0FwaUVycm9yIiwiX1Nlc3Npb24iLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfZGVmYXVsdCIsInJvdXRlciIsInBvc3QiLCJTZXNzaW9uIiwicmVxIiwicmVzIiwibmV4dCIsInByb2R1Y3RJZCIsInF1YW50aXR5IiwiYm9keSIsInByb2R1Y3QiLCJQcm9kdWN0cyIsImZpbmRCeUlkIiwiQXBpRXJyb3IiLCJzdG9jayIsImNhcnQiLCJDYXJ0IiwiZmluZE9uZSIsImJ1eWVyIiwidXNlciIsIl9pZCIsImNvbXBsZXRlZCIsIm1vbmdvb3NlIiwiVHlwZXMiLCJPYmplY3RJZCIsInByb2R1Y3RzIiwiZXhpc3RpbmdQcm9kdWN0SW5kZXgiLCJmaW5kSW5kZXgiLCJpdGVtIiwidG9TdHJpbmciLCJuZXdRdWFudGl0eSIsInB1c2giLCJzZWxsZXIiLCJzdGF0dXMiLCJzYXZlIiwianNvbiIsIm1lc3NhZ2UiLCJlcnJvciIsImNvbnNvbGUiLCJnZXQiLCJwb3B1bGF0ZSIsImxvZyIsImNhcnRJZCIsInBhcmFtcyIsInByb2R1Y3RJbmRleCIsInNwbGljZSIsImxlbmd0aCIsImZpbmRCeUlkQW5kRGVsZXRlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3JvdXRlcy8iLCJzb3VyY2VzIjpbImNhcnQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlIGZyb20gXCJtb25nb29zZVwiO1xuaW1wb3J0IENhcnQgZnJvbSBcIi4uL2RiL2NhcnRcIjtcbmltcG9ydCBQcm9kdWN0cyBmcm9tIFwiLi4vZGIvcHJvZHVjdHNcIjtcbmltcG9ydCBBcGlFcnJvciBmcm9tIFwiLi4vZXJyb3JzL0FwaUVycm9yXCI7XG5pbXBvcnQgU2Vzc2lvbiBmcm9tIFwiLi4vbWlkZGxld2FyZXMvU2Vzc2lvblwiO1xuXG5leHBvcnQgZGVmYXVsdCAocm91dGVyKSA9PiB7XG4gIC8vIHJvdXRlci5wb3N0KFwiL2NhcnRzXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAvLyAgIHRyeSB7XG4gIC8vICAgICBjb25zdCB7IHByb2R1Y3RJZCB9ID0gcmVxLmJvZHk7XG5cbiAgLy8gICAgIC8vIMOccsO8bsO8biBnZcOnZXJsaSBvbHVwIG9sbWFkxLHEn8SxbsSxIGtvbnRyb2wgZXRcbiAgLy8gICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBQcm9kdWN0cy5maW5kQnlJZChwcm9kdWN0SWQpO1xuICAvLyAgICAgaWYgKCFwcm9kdWN0KSB7XG4gIC8vICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIlByb2R1Y3Qgbm90IGZvdW5kXCIsIDQwNCwgXCJQcm9kdWN0Tm90Rm91bmRcIik7XG4gIC8vICAgICB9XG5cbiAgLy8gICAgIC8vIEt1bGxhbsSxY8SxbsSxbiBtZXZjdXQgYmlyIHNlcGV0aSB2YXIgbcSxIGtvbnRyb2wgZXQgKFRhbWFtbGFubWFtxLHFnyBiaXIgc2VwZXQpXG4gIC8vICAgICBsZXQgY2FydCA9IGF3YWl0IENhcnQuZmluZE9uZSh7XG4gIC8vICAgICAgIGJ1eWVyOiByZXEudXNlci5faWQsXG4gIC8vICAgICAgIGNvbXBsZXRlZDogZmFsc2UsXG4gIC8vICAgICB9KTtcblxuICAvLyAgICAgLy8gRcSfZXIgbWV2Y3V0IGJpciBzZXBldCB5b2tzYSB5ZW5pIGJpciBzZXBldCBvbHXFn3R1clxuICAvLyAgICAgaWYgKCFjYXJ0KSB7XG4gIC8vICAgICAgIGNhcnQgPSBuZXcgQ2FydCh7XG4gIC8vICAgICAgICAgYnV5ZXI6IG5ldyBtb25nb29zZS5UeXBlcy5PYmplY3RJZChyZXEudXNlci5faWQpLFxuICAvLyAgICAgICB9KTtcbiAgLy8gICAgIH1cblxuICAvLyAgICAgLy8gw5xyw7xuw7wgc2VwZXRlIGVrbGVcbiAgLy8gICAgIGNhcnQucHJvZHVjdHMucHVzaChuZXcgbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQocHJvZHVjdElkKSk7XG5cbiAgLy8gICAgIC8vIFNlcGV0aSBrYXlkZXRcbiAgLy8gICAgIGF3YWl0IGNhcnQuc2F2ZSgpO1xuXG4gIC8vICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gIC8vICAgICAgIG1lc3NhZ2U6IFwiUHJvZHVjdCBhZGRlZCBvbiBjYXJ0LlwiLFxuICAvLyAgICAgICBjYXJ0LFxuICAvLyAgICAgfSk7XG4gIC8vICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgLy8gICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgLy8gICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgLy8gICAgICAgXCJDYXJ0IGNvdWxkIG5vdCBiZSBjcmVhdGVkXCIsXG4gIC8vICAgICAgIDQwMCxcbiAgLy8gICAgICAgXCJjYXJ0Q3JlYXRpb25GYWlsZWRcIlxuICAvLyAgICAgKTtcbiAgLy8gICB9XG4gIC8vIH0pO1xuXG4gIHJvdXRlci5wb3N0KFwiL2NhcnRzXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IHByb2R1Y3RJZCwgcXVhbnRpdHkgfSA9IHJlcS5ib2R5O1xuXG4gICAgICAvLyDDnHLDvG7DvG4gZ2XDp2VybGkgb2x1cCBvbG1hZMSxxJ/EsW7EsSBrb250cm9sIGV0XG4gICAgICBjb25zdCBwcm9kdWN0ID0gYXdhaXQgUHJvZHVjdHMuZmluZEJ5SWQocHJvZHVjdElkKTtcbiAgICAgIGlmICghcHJvZHVjdCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJQcm9kdWN0IG5vdCBmb3VuZFwiLCA0MDQsIFwiUHJvZHVjdE5vdEZvdW5kXCIpO1xuICAgICAgfVxuXG4gICAgICBpZiAocHJvZHVjdC5zdG9jayA8PSAwKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIlByb2R1Y3QgaXMgb3V0IG9mXCIsIDQwNCwgXCJPdXRPZlN0b2NrXCIpO1xuICAgICAgfVxuICAgICAgaWYgKHByb2R1Y3Quc3RvY2sgPCAocXVhbnRpdHkgfHwgMSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIGBPbmx5ICR7cHJvZHVjdC5zdG9ja30gdW5pdHMgb2YgdGhlIHByb2R1Y3QgYXJlIGF2YWlsYWJsZSBpbiBzdG9ja2AsXG4gICAgICAgICAgNDAwLFxuICAgICAgICAgIFwiSW5zdWZmaWNpZW50U3RvY2tcIlxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICAvLyBLdWxsYW7EsWPEsW7EsW4gbWV2Y3V0IGJpciBzZXBldGkgdmFyIG3EsSBrb250cm9sIGV0IChUYW1hbWxhbm1hbcSxxZ8gYmlyIHNlcGV0KVxuICAgICAgbGV0IGNhcnQgPSBhd2FpdCBDYXJ0LmZpbmRPbmUoe1xuICAgICAgICBidXllcjogcmVxLnVzZXIuX2lkLFxuICAgICAgICBjb21wbGV0ZWQ6IGZhbHNlLFxuICAgICAgfSk7XG5cbiAgICAgIC8vIEXEn2VyIG1ldmN1dCBiaXIgc2VwZXQgeW9rc2EgeWVuaSBiaXIgc2VwZXQgb2x1xZ90dXJcbiAgICAgIGlmICghY2FydCkge1xuICAgICAgICBjYXJ0ID0gbmV3IENhcnQoe1xuICAgICAgICAgIGJ1eWVyOiBuZXcgbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQocmVxLnVzZXIuX2lkKSxcbiAgICAgICAgICBwcm9kdWN0czogW10sXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBTZXBldHRlIHphdGVuIGF5bsSxIMO8csO8biB2YXJzYSBtaWt0YXLEsW7EsSBhcnTEsXIsIHlva3NhIHllbmkgw7xyw7xuIG9sYXJhayBla2xlXG4gICAgICBjb25zdCBleGlzdGluZ1Byb2R1Y3RJbmRleCA9IGNhcnQucHJvZHVjdHMuZmluZEluZGV4KFxuICAgICAgICAoaXRlbSkgPT4gaXRlbS5wcm9kdWN0SWQudG9TdHJpbmcoKSA9PT0gcHJvZHVjdElkXG4gICAgICApO1xuXG4gICAgICBpZiAoZXhpc3RpbmdQcm9kdWN0SW5kZXggPiAtMSkge1xuICAgICAgICAvLyAvLyBFxJ9lciDDvHLDvG4gemF0ZW4gc2VwZXR0ZXlzZSwgbWlrdGFyxLEgYXJ0xLFyXG4gICAgICAgIC8vIGNhcnQucHJvZHVjdHNbZXhpc3RpbmdQcm9kdWN0SW5kZXhdLnF1YW50aXR5ICs9IHF1YW50aXR5IHx8IDE7XG4gICAgICAgIC8vIEXEn2VyIMO8csO8biB6YXRlbiBzZXBldHRleXNlLCBtaWt0YXLEsSBhcnTEsXJcbiAgICAgICAgY29uc3QgbmV3UXVhbnRpdHkgPVxuICAgICAgICAgIGNhcnQucHJvZHVjdHNbZXhpc3RpbmdQcm9kdWN0SW5kZXhdLnF1YW50aXR5ICsgKHF1YW50aXR5IHx8IDEpO1xuXG4gICAgICAgIGlmIChuZXdRdWFudGl0eSA+IHByb2R1Y3Quc3RvY2spIHtcbiAgICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgICBgQ2Fubm90IGFkZCBtb3JlIHRoYW4gJHtwcm9kdWN0LnN0b2NrfSB1bml0cyBvZiB0aGUgcHJvZHVjdCB0byB0aGUgY2FydGAsXG4gICAgICAgICAgICA0MDAsXG4gICAgICAgICAgICBcIkV4Y2VlZHNTdG9ja1wiXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNhcnQucHJvZHVjdHNbZXhpc3RpbmdQcm9kdWN0SW5kZXhdLnF1YW50aXR5ID0gbmV3UXVhbnRpdHk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyDDnHLDvG4gc2VwZXR0ZSB5b2tzYSB5ZW5pIMO8csO8biBvbGFyYWsgZWtsZVxuICAgICAgICBjYXJ0LnByb2R1Y3RzLnB1c2goe1xuICAgICAgICAgIHByb2R1Y3RJZDogbmV3IG1vbmdvb3NlLlR5cGVzLk9iamVjdElkKHByb2R1Y3RJZCksXG4gICAgICAgICAgc2VsbGVyOiBwcm9kdWN0LnNlbGxlciwgLy8gw5xyw7xuw7xuIHNhdMSxY8Sxc8SxbsSxIGJ1cmF5YSBla2xpeW9ydXpcbiAgICAgICAgICBxdWFudGl0eTogcXVhbnRpdHkgfHwgMSwgLy8gR8O2bmRlcmlsZW4gbWlrdGFyxLEga3VsbGFuIHZleWEgMSBvbGFyYWsgYXlhcmxhXG4gICAgICAgICAgc3RhdHVzOiBcInBlbmRpbmdcIiwgLy8gVmFyc2F5xLFsYW4gb2xhcmFrIMO8csO8biBkdXJ1bXUgJ3BlbmRpbmcnXG4gICAgICAgIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBTZXBldGkga2F5ZGV0XG4gICAgICBhd2FpdCBjYXJ0LnNhdmUoKTtcblxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgICBtZXNzYWdlOiBcIlByb2R1Y3QgYWRkZWQgdG8gY2FydC5cIixcbiAgICAgICAgY2FydCxcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgIG5leHQoXG4gICAgICAgIG5ldyBBcGlFcnJvcihcIkNhcnQgY291bGQgbm90IGJlIGNyZWF0ZWRcIiwgNDAwLCBcImNhcnRDcmVhdGlvbkZhaWxlZFwiKVxuICAgICAgKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJvdXRlci5nZXQoXCIvZ2V0Q2FydFwiLCBTZXNzaW9uLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3QgY2FydCA9IGF3YWl0IENhcnQuZmluZE9uZSh7XG4gICAgICAgIGJ1eWVyOiByZXEudXNlci5faWQsXG4gICAgICAgIGNvbXBsZXRlZDogZmFsc2UsXG4gICAgICB9KVxuICAgICAgICAucG9wdWxhdGUoXCJwcm9kdWN0cy5wcm9kdWN0SWRcIiwgXCJuYW1lIHByaWNlIGltYWdlcyBjYXRlZ29yaWVzXCIpXG4gICAgICAgIC5wb3B1bGF0ZShcInByb2R1Y3RzLnNlbGxlclwiLCBcIm5hbWUgc3ViTWVyY2hhbnRLZXlcIik7XG5cbiAgICAgIGlmICghY2FydCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJObyBhY3RpdmUgQ2FydCBmb3VuZFwiLCA0MDEsIFwiY2FydE5vdEZvdW5kXCIpO1xuICAgICAgfVxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oY2FydCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNvdWxkIG5vdCByZXRyaWV2ZSBjYXJ0XCIsIDQwMCwgXCJnZXRDYXJ0RmFpbGVkXCIpO1xuICAgIH1cbiAgfSk7XG5cbiAgcm91dGVyLnBvc3QoXCIvZGVsZXRlLXByb2R1Y3QtaW4tY2FydC86Y2FydElkXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGNhcnRJZCB9ID0gcmVxLnBhcmFtcztcbiAgICAgIGNvbnN0IHsgcHJvZHVjdElkIH0gPSByZXEuYm9keTtcblxuICAgICAgY29uc3QgY2FydCA9IGF3YWl0IENhcnQuZmluZEJ5SWQoY2FydElkKTtcbiAgICAgIGlmICghY2FydCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJ0IG5vdCBmb3VuZFwiLCA0MDQsIFwiQ2FydE5vdEZvdW5kXCIpO1xuICAgICAgfVxuXG4gICAgICAvLyBDYXJ0J3Rha2kgcHJvZHVjdCdsYXLEsW4gacOnaW5kZSBwcm9kdWN0SWQneWkgYXLEsXlvcnV6XG4gICAgICBjb25zdCBwcm9kdWN0SW5kZXggPSBjYXJ0LnByb2R1Y3RzLmZpbmRJbmRleChcbiAgICAgICAgKGl0ZW0pID0+IGl0ZW0ucHJvZHVjdElkLnRvU3RyaW5nKCkgPT09IHByb2R1Y3RJZC50b1N0cmluZygpXG4gICAgICApO1xuXG4gICAgICBpZiAocHJvZHVjdEluZGV4ID4gLTEpIHtcbiAgICAgICAgLy8gw5xyw7xuw7wgYnVsZHVrLCDFn2ltZGkgbWlrdGFyxLEga29udHJvbCBlZGl5b3J1elxuICAgICAgICBpZiAoY2FydC5wcm9kdWN0c1twcm9kdWN0SW5kZXhdLnF1YW50aXR5ID4gMSkge1xuICAgICAgICAgIC8vIEXEn2VyIG1pa3RhciAxJ2RlbiBmYXpsYXlzYSwgbWlrdGFyxLEgYXphbHRcbiAgICAgICAgICBjYXJ0LnByb2R1Y3RzW3Byb2R1Y3RJbmRleF0ucXVhbnRpdHkgLT0gMTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBFxJ9lciBtaWt0YXIgMSBpc2Ugw7xyw7xuw7wgdGFtYW1lbiBzZXBldHRlbiBrYWxkxLFyXG4gICAgICAgICAgY2FydC5wcm9kdWN0cy5zcGxpY2UocHJvZHVjdEluZGV4LCAxKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIFwiUHJvZHVjdCBub3QgZm91bmQgaW4gY2FydFwiLFxuICAgICAgICAgIDQwNCxcbiAgICAgICAgICBcIlByb2R1Y3ROb3RGb3VuZEluQ2FydFwiXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGlmIChjYXJ0LnByb2R1Y3RzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBhd2FpdCBDYXJ0LmZpbmRCeUlkQW5kRGVsZXRlKGNhcnRJZCk7XG4gICAgICAgIHJldHVybiByZXNcbiAgICAgICAgICAuc3RhdHVzKDIwMClcbiAgICAgICAgICAuanNvbih7IG1lc3NhZ2U6IFwiQ2FydCBpcyBlbXB0eSBhbmQgaGFzIGJlZW4gZGVsZXRlZFwiIH0pO1xuICAgICAgfVxuXG4gICAgICAvLyBTZXBldGkga2F5ZGVkaXlvcnV6XG4gICAgICBhd2FpdCBjYXJ0LnNhdmUoKTtcblxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgICBtZXNzYWdlOiBcIlByb2R1Y3QgaGFzIGJlZW4gcmVtb3ZlZCBvciBxdWFudGl0eSBkZWNyZWFzZWQuXCIsXG4gICAgICAgIGNhcnQsXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcbiAgICAgICAgbWVzc2FnZTogXCJDb3VsZCBub3QgZGVsZXRlIHByb2R1Y3QgZnJvbSBjYXJ0XCIsXG4gICAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxuICAgICAgfSk7XG4gICAgfVxuICB9KTtcblxuICAvLyByb3V0ZXIucG9zdChcIi9kZWxldGUtcHJvZHVjdC1pbi1jYXJ0LzpjYXJ0SWRcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gIC8vICAgdHJ5IHtcbiAgLy8gICAgIGNvbnN0IHsgY2FydElkIH0gPSByZXEucGFyYW1zO1xuICAvLyAgICAgY29uc3QgeyBwcm9kdWN0SWQgfSA9IHJlcS5ib2R5O1xuXG4gIC8vICAgICBjb25zdCBjYXJ0ID0gYXdhaXQgQ2FydC5maW5kQnlJZChjYXJ0SWQpO1xuICAvLyAgICAgaWYgKCFjYXJ0KSB7XG4gIC8vICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgbm90IGZvdW5kXCIsIDQwNCwgXCJDYXJ0Tm90Rm91bmRcIik7XG4gIC8vICAgICB9XG5cbiAgLy8gICAgIC8vIGlmIChjYXJ0LmJ1eWVyLnRvU3RyaW5nKCkgIT09IHJlcS51c2VyLl9pZC50b1N0cmluZygpKSB7XG4gIC8vICAgICAvLyAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgLy8gICAgIC8vICAgICBcIiBZb3UgYXJlIG5vdCB0aGUgb3duZXIgb2YgdGhpcyBjYXJ0XCIsXG4gIC8vICAgICAvLyAgICAgNDAzLFxuICAvLyAgICAgLy8gICAgIFwieW91QXJlTm90VGhlT3duZXJPZlRoaXNDYXJ0XCJcbiAgLy8gICAgIC8vICAgKTtcbiAgLy8gICAgIC8vIH1cblxuICAvLyAgICAgY29uc3QgcHJvZHVjdEluZGV4ID0gY2FydC5wcm9kdWN0cy5pbmRleE9mKFxuICAvLyAgICAgICBuZXcgbW9uZ29vc2UuVHlwZXMuT2JqZWN0SWQocHJvZHVjdElkKVxuICAvLyAgICAgKTtcbiAgLy8gICAgIGlmIChwcm9kdWN0SW5kZXggPiAtMSkge1xuICAvLyAgICAgICBjYXJ0LnByb2R1Y3RzLnNwbGljZShwcm9kdWN0SW5kZXgsIDEpO1xuICAvLyAgICAgfSBlbHNlIHtcbiAgLy8gICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAvLyAgICAgICAgIFwiUHJvZHVjdCBub3QgZm91bmQgaW4gY2FydFwiLFxuICAvLyAgICAgICAgIDQwNCxcbiAgLy8gICAgICAgICBcIlByb2R1Y3ROb3RGb3VuZEluQ2FydFwiXG4gIC8vICAgICAgICk7XG4gIC8vICAgICB9XG5cbiAgLy8gICAgIGF3YWl0IGNhcnQuc2F2ZSgpO1xuXG4gIC8vICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gIC8vICAgICAgIG1lc3NhZ2U6IFwiUHJvZHVjdCBoYXMgYmVlbiByZW1vdmVkLlwiLFxuICAvLyAgICAgICBjYXJ0LFxuICAvLyAgICAgfSk7XG4gIC8vICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgLy8gICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgLy8gICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgLy8gICAgICAgXCJDb3VsZCBub3QgZGVsZXRlIHByb2R1Y3QgZnJvbSBjYXJ0XCIsXG4gIC8vICAgICAgIDQwMCxcbiAgLy8gICAgICAgXCJEZWxldGVQcm9kdWN0RmFpbGVkXCJcbiAgLy8gICAgICk7XG4gIC8vICAgfVxuICAvLyB9KTtcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLEtBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLFNBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFHLFNBQUEsR0FBQUosc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFJLFFBQUEsR0FBQUwsc0JBQUEsQ0FBQUMsT0FBQTtBQUE2QyxTQUFBRCx1QkFBQU0sQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFB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","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","_cart","_products","_ApiError","_Session","e","__esModule","default","_default","router","post","Session","req","res","next","productId","quantity","body","product","Products","findById","ApiError","stock","cart","Cart","findOne","buyer","user","_id","completed","mongoose","Types","ObjectId","products","existingProductIndex","findIndex","item","toString","newQuantity","push","seller","status","save","json","message","error","console","get","populate","log","cartId","params","productIndex","splice","length","findByIdAndDelete","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["cart.js"],"sourcesContent":["import mongoose from \"mongoose\";\nimport Cart from \"../db/cart\";\nimport Products from \"../db/products\";\nimport ApiError from \"../errors/ApiError\";\nimport Session from \"../middlewares/Session\";\n\nexport default (router) => {\n  // router.post(\"/carts\", Session, async (req, res, next) => {\n  //   try {\n  //     const { productId } = req.body;\n\n  //     // Ürünün geçerli olup olmadığını kontrol et\n  //     const product = await Products.findById(productId);\n  //     if (!product) {\n  //       throw new ApiError(\"Product not found\", 404, \"ProductNotFound\");\n  //     }\n\n  //     // Kullanıcının mevcut bir sepeti var mı kontrol et (Tamamlanmamış bir sepet)\n  //     let cart = await Cart.findOne({\n  //       buyer: req.user._id,\n  //       completed: false,\n  //     });\n\n  //     // Eğer mevcut bir sepet yoksa yeni bir sepet oluştur\n  //     if (!cart) {\n  //       cart = new Cart({\n  //         buyer: new mongoose.Types.ObjectId(req.user._id),\n  //       });\n  //     }\n\n  //     // Ürünü sepete ekle\n  //     cart.products.push(new mongoose.Types.ObjectId(productId));\n\n  //     // Sepeti kaydet\n  //     await cart.save();\n\n  //     res.status(200).json({\n  //       message: \"Product added on cart.\",\n  //       cart,\n  //     });\n  //   } catch (error) {\n  //     console.log(error);\n  //     throw new ApiError(\n  //       \"Cart could not be created\",\n  //       400,\n  //       \"cartCreationFailed\"\n  //     );\n  //   }\n  // });\n\n  router.post(\"/carts\", Session, async (req, res, next) => {\n    try {\n      const { productId, quantity } = req.body;\n\n      // Ürünün geçerli olup olmadığını kontrol et\n      const product = await Products.findById(productId);\n      if (!product) {\n        throw new ApiError(\"Product not found\", 404, \"ProductNotFound\");\n      }\n\n      if (product.stock <= 0) {\n        throw new ApiError(\"Product is out of\", 404, \"OutOfStock\");\n      }\n      if (product.stock < (quantity || 1)) {\n        throw new ApiError(\n          `Only ${product.stock} units of the product are available in stock`,\n          400,\n          \"InsufficientStock\"\n        );\n      }\n\n      // Kullanıcının mevcut bir sepeti var mı kontrol et (Tamamlanmamış bir sepet)\n      let cart = await Cart.findOne({\n        buyer: req.user._id,\n        completed: false,\n      });\n\n      // Eğer mevcut bir sepet yoksa yeni bir sepet oluştur\n      if (!cart) {\n        cart = new Cart({\n          buyer: new mongoose.Types.ObjectId(req.user._id),\n          products: [],\n        });\n      }\n\n      // Sepette zaten aynı ürün varsa miktarını artır, yoksa yeni ürün olarak ekle\n      const existingProductIndex = cart.products.findIndex(\n        (item) => item.productId.toString() === productId\n      );\n\n      if (existingProductIndex > -1) {\n        // // Eğer ürün zaten sepetteyse, miktarı artır\n        // cart.products[existingProductIndex].quantity += quantity || 1;\n        // Eğer ürün zaten sepetteyse, miktarı artır\n        const newQuantity =\n          cart.products[existingProductIndex].quantity + (quantity || 1);\n\n        if (newQuantity > product.stock) {\n          throw new ApiError(\n            `Cannot add more than ${product.stock} units of the product to the cart`,\n            400,\n            \"ExceedsStock\"\n          );\n        }\n\n        cart.products[existingProductIndex].quantity = newQuantity;\n      } else {\n        // Ürün sepette yoksa yeni ürün olarak ekle\n        cart.products.push({\n          productId: new mongoose.Types.ObjectId(productId),\n          seller: product.seller, // Ürünün satıcısını buraya ekliyoruz\n          quantity: quantity || 1, // Gönderilen miktarı kullan veya 1 olarak ayarla\n          status: \"pending\", // Varsayılan olarak ürün durumu 'pending'\n        });\n      }\n\n      // Sepeti kaydet\n      await cart.save();\n\n      res.status(200).json({\n        message: \"Product added to cart.\",\n        cart,\n      });\n    } catch (error) {\n      console.error(error);\n      next(\n        new ApiError(\"Cart could not be created\", 400, \"cartCreationFailed\")\n      );\n    }\n  });\n\n  router.get(\"/getCart\", Session, async (req, res) => {\n    try {\n      const cart = await Cart.findOne({\n        buyer: req.user._id,\n        completed: false,\n      })\n        .populate(\"products.productId\", \"name price images categories\")\n        .populate(\"products.seller\", \"name subMerchantKey\");\n\n      if (!cart) {\n        throw new ApiError(\"No active Cart found\", 401, \"cartNotFound\");\n      }\n      res.status(200).json(cart);\n    } catch (error) {\n      console.log(error);\n      throw new ApiError(\"Could not retrieve cart\", 400, \"getCartFailed\");\n    }\n  });\n\n  router.post(\"/delete-product-in-cart/:cartId\", Session, async (req, res) => {\n    try {\n      const { cartId } = req.params;\n      const { productId } = req.body;\n\n      const cart = await Cart.findById(cartId);\n      if (!cart) {\n        throw new ApiError(\"Cart not found\", 404, \"CartNotFound\");\n      }\n\n      // Cart'taki product'ların içinde productId'yi arıyoruz\n      const productIndex = cart.products.findIndex(\n        (item) => item.productId.toString() === productId.toString()\n      );\n\n      if (productIndex > -1) {\n        // Ürünü bulduk, şimdi miktarı kontrol ediyoruz\n        if (cart.products[productIndex].quantity > 1) {\n          // Eğer miktar 1'den fazlaysa, miktarı azalt\n          cart.products[productIndex].quantity -= 1;\n        } else {\n          // Eğer miktar 1 ise ürünü tamamen sepetten kaldır\n          cart.products.splice(productIndex, 1);\n        }\n      } else {\n        throw new ApiError(\n          \"Product not found in cart\",\n          404,\n          \"ProductNotFoundInCart\"\n        );\n      }\n\n      if (cart.products.length === 0) {\n        await Cart.findByIdAndDelete(cartId);\n        return res\n          .status(200)\n          .json({ message: \"Cart is empty and has been deleted\" });\n      }\n\n      // Sepeti kaydediyoruz\n      await cart.save();\n\n      res.status(200).json({\n        message: \"Product has been removed or quantity decreased.\",\n        cart,\n      });\n    } catch (error) {\n      console.log(error);\n      return res.status(400).json({\n        message: \"Could not delete product from cart\",\n        error: error.message,\n      });\n    }\n  });\n\n  // router.post(\"/delete-product-in-cart/:cartId\", Session, async (req, res) => {\n  //   try {\n  //     const { cartId } = req.params;\n  //     const { productId } = req.body;\n\n  //     const cart = await Cart.findById(cartId);\n  //     if (!cart) {\n  //       throw new ApiError(\"Cart not found\", 404, \"CartNotFound\");\n  //     }\n\n  //     // if (cart.buyer.toString() !== req.user._id.toString()) {\n  //     //   throw new ApiError(\n  //     //     \" You are not the owner of this cart\",\n  //     //     403,\n  //     //     \"youAreNotTheOwnerOfThisCart\"\n  //     //   );\n  //     // }\n\n  //     const productIndex = cart.products.indexOf(\n  //       new mongoose.Types.ObjectId(productId)\n  //     );\n  //     if (productIndex > -1) {\n  //       cart.products.splice(productIndex, 1);\n  //     } else {\n  //       throw new ApiError(\n  //         \"Product not found in cart\",\n  //         404,\n  //         \"ProductNotFoundInCart\"\n  //       );\n  //     }\n\n  //     await cart.save();\n\n  //     res.status(200).json({\n  //       message: \"Product has been removed.\",\n  //       cart,\n  //     });\n  //   } catch (error) {\n  //     console.log(error);\n  //     throw new ApiError(\n  //       \"Could not delete product from cart\",\n  //       400,\n  //       \"DeleteProductFailed\"\n  //     );\n  //   }\n  // });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,KAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,SAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,SAAA,GAAAJ,sBAAA,CAAAC,OAAA;AACA,IAAAI,QAAA,GAAAL,sBAAA,CAAAC,OAAA;AAA6C,SAAAD,uBAAAM,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAAA,IAAAG,QAAA,GAE7BC,MAAM,IAAK;EACzB;EACA;EACA;;EAEA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;;EAEA;EACA;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEAA,MAAM,CAACC,IAAI,CAAC,QAAQ,EAAEC,gBAAO,EAAE,OAAOC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;IACvD,IAAI;MACF,MAAM;QAAEC,SAAS;QAAEC;MAAS,CAAC,GAAGJ,GAAG,CAACK,IAAI;;MAExC;MACA,MAAMC,OAAO,GAAG,MAAMC,iBAAQ,CAACC,QAAQ,CAACL,SAAS,CAAC;MAClD,IAAI,CAACG,OAAO,EAAE;QACZ,MAAM,IAAIG,iBAAQ,CAAC,mBAAmB,EAAE,GAAG,EAAE,iBAAiB,CAAC;MACjE;MAEA,IAAIH,OAAO,CAACI,KAAK,IAAI,CAAC,EAAE;QACtB,MAAM,IAAID,iBAAQ,CAAC,mBAAmB,EAAE,GAAG,EAAE,YAAY,CAAC;MAC5D;MACA,IAAIH,OAAO,CAACI,KAAK,IAAIN,QAAQ,IAAI,CAAC,CAAC,EAAE;QACnC,MAAM,IAAIK,iBAAQ,CAChB,QAAQH,OAAO,CAACI,KAAK,8CAA8C,EACnE,GAAG,EACH,mBACF,CAAC;MACH;;MAEA;MACA,IAAIC,IAAI,GAAG,MAAMC,aAAI,CAACC,OAAO,CAAC;QAC5BC,KAAK,EAAEd,GAAG,CAACe,IAAI,CAACC,GAAG;QACnBC,SAAS,EAAE;MACb,CAAC,CAAC;;MAEF;MACA,IAAI,CAACN,IAAI,EAAE;QACTA,IAAI,GAAG,IAAIC,aAAI,CAAC;UACdE,KAAK,EAAE,IAAII,iBAAQ,CAACC,KAAK,CAACC,QAAQ,CAACpB,GAAG,CAACe,IAAI,CAACC,GAAG,CAAC;UAChDK,QAAQ,EAAE;QACZ,CAAC,CAAC;MACJ;;MAEA;MACA,MAAMC,oBAAoB,GAAGX,IAAI,CAACU,QAAQ,CAACE,SAAS,CACjDC,IAAI,IAAKA,IAAI,CAACrB,SAAS,CAACsB,QAAQ,CAAC,CAAC,KAAKtB,SAC1C,CAAC;MAED,IAAImB,oBAAoB,GAAG,CAAC,CAAC,EAAE;QAC7B;QACA;QACA;QACA,MAAMI,WAAW,GACff,IAAI,CAACU,QAAQ,CAACC,oBAAoB,CAAC,CAAClB,QAAQ,IAAIA,QAAQ,IAAI,CAAC,CAAC;QAEhE,IAAIsB,WAAW,GAAGpB,OAAO,CAACI,KAAK,EAAE;UAC/B,MAAM,IAAID,iBAAQ,CAChB,wBAAwBH,OAAO,CAACI,KAAK,mCAAmC,EACxE,GAAG,EACH,cACF,CAAC;QACH;QAEAC,IAAI,CAACU,QAAQ,CAACC,oBAAoB,CAAC,CAAClB,QAAQ,GAAGsB,WAAW;MAC5D,CAAC,MAAM;QACL;QACAf,IAAI,CAACU,QAAQ,CAACM,IAAI,CAAC;UACjBxB,SAAS,EAAE,IAAIe,iBAAQ,CAACC,KAAK,CAACC,QAAQ,CAACjB,SAAS,CAAC;UACjDyB,MAAM,EAAEtB,OAAO,CAACsB,MAAM;UAAE;UACxBxB,QAAQ,EAAEA,QAAQ,IAAI,CAAC;UAAE;UACzByB,MAAM,EAAE,SAAS,CAAE;QACrB,CAAC,CAAC;MACJ;;MAEA;MACA,MAAMlB,IAAI,CAACmB,IAAI,CAAC,CAAC;MAEjB7B,GAAG,CAAC4B,MAAM,CAAC,GAAG,CAAC,CAACE,IAAI,CAAC;QACnBC,OAAO,EAAE,wBAAwB;QACjCrB;MACF,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOsB,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;MACpB/B,IAAI,CACF,IAAIO,iBAAQ,CAAC,2BAA2B,EAAE,GAAG,EAAE,oBAAoB,CACrE,CAAC;IACH;EACF,CAAC,CAAC;EAEFZ,MAAM,CAACsC,GAAG,CAAC,UAAU,EAAEpC,gBAAO,EAAE,OAAOC,GAAG,EAAEC,GAAG,KAAK;IAClD,IAAI;MACF,MAAMU,IAAI,GAAG,MAAMC,aAAI,CAACC,OAAO,CAAC;QAC9BC,KAAK,EAAEd,GAAG,CAACe,IAAI,CAACC,GAAG;QACnBC,SAAS,EAAE;MACb,CAAC,CAAC,CACCmB,QAAQ,CAAC,oBAAoB,EAAE,8BAA8B,CAAC,CAC9DA,QAAQ,CAAC,iBAAiB,EAAE,qBAAqB,CAAC;MAErD,IAAI,CAACzB,IAAI,EAAE;QACT,MAAM,IAAIF,iBAAQ,CAAC,sBAAsB,EAAE,GAAG,EAAE,cAAc,CAAC;MACjE;MACAR,GAAG,CAAC4B,MAAM,CAAC,GAAG,CAAC,CAACE,IAAI,CAACpB,IAAI,CAAC;IAC5B,CAAC,CAAC,OAAOsB,KAAK,EAAE;MACdC,OAAO,CAACG,GAAG,CAACJ,KAAK,CAAC;MAClB,MAAM,IAAIxB,iBAAQ,CAAC,yBAAyB,EAAE,GAAG,EAAE,eAAe,CAAC;IACrE;EACF,CAAC,CAAC;EAEFZ,MAAM,CAACC,IAAI,CAAC,iCAAiC,EAAEC,gBAAO,EAAE,OAAOC,GAAG,EAAEC,GAAG,KAAK;IAC1E,IAAI;MACF,MAAM;QAAEqC;MAAO,CAAC,GAAGtC,GAAG,CAACuC,MAAM;MAC7B,MAAM;QAAEpC;MAAU,CAAC,GAAGH,GAAG,CAACK,IAAI;MAE9B,MAAMM,IAAI,GAAG,MAAMC,aAAI,CAACJ,QAAQ,CAAC8B,MAAM,CAAC;MACxC,IAAI,CAAC3B,IAAI,EAAE;QACT,MAAM,IAAIF,iBAAQ,CAAC,gBAAgB,EAAE,GAAG,EAAE,cAAc,CAAC;MAC3D;;MAEA;MACA,MAAM+B,YAAY,GAAG7B,IAAI,CAACU,QAAQ,CAACE,SAAS,CACzCC,IAAI,IAAKA,IAAI,CAACrB,SAAS,CAACsB,QAAQ,CAAC,CAAC,KAAKtB,SAAS,CAACsB,QAAQ,CAAC,CAC7D,CAAC;MAED,IAAIe,YAAY,GAAG,CAAC,CAAC,EAAE;QACrB;QACA,IAAI7B,IAAI,CAACU,QAAQ,CAACmB,YAAY,CAAC,CAACpC,QAAQ,GAAG,CAAC,EAAE;UAC5C;UACAO,IAAI,CAACU,QAAQ,CAACmB,YAAY,CAAC,CAACpC,QAAQ,IAAI,CAAC;QAC3C,CAAC,MAAM;UACL;UACAO,IAAI,CAACU,QAAQ,CAACoB,MAAM,CAACD,YAAY,EAAE,CAAC,CAAC;QACvC;MACF,CAAC,MAAM;QACL,MAAM,IAAI/B,iBAAQ,CAChB,2BAA2B,EAC3B,GAAG,EACH,uBACF,CAAC;MACH;MAEA,IAAIE,IAAI,CAACU,QAAQ,CAACqB,MAAM,KAAK,CAAC,EAAE;QAC9B,MAAM9B,aAAI,CAAC+B,iBAAiB,CAACL,MAAM,CAAC;QACpC,OAAOrC,GAAG,CACP4B,MAAM,CAAC,GAAG,CAAC,CACXE,IAAI,CAAC;UAAEC,OAAO,EAAE;QAAqC,CAAC,CAAC;MAC5D;;MAEA;MACA,MAAMrB,IAAI,CAACmB,IAAI,CAAC,CAAC;MAEjB7B,GAAG,CAAC4B,MAAM,CAAC,GAAG,CAAC,CAACE,IAAI,CAAC;QACnBC,OAAO,EAAE,iDAAiD;QAC1DrB;MACF,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOsB,KAAK,EAAE;MACdC,OAAO,CAACG,GAAG,CAACJ,KAAK,CAAC;MAClB,OAAOhC,GAAG,CAAC4B,MAAM,CAAC,GAAG,CAAC,CAACE,IAAI,CAAC;QAC1BC,OAAO,EAAE,oCAAoC;QAC7CC,KAAK,EAAEA,KAAK,CAACD;MACf,CAAC,CAAC;IACJ;EACF,CAAC,CAAC;;EAEF;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;;EAEA;;EAEA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;AACF,CAAC;AAAAY,OAAA,CAAAjD,OAAA,GAAAC,QAAA","ignoreList":[]}},"mtime":1734270863690},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/payment-success.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst ItemTransactionSchema = new Schema({\n  uuid: {\n    type: String,\n    default: () => (0, _uuid.default)(),\n    //hata alırsak tüm dblerdeki uuidlere bi bak\n    unique: true,\n    required: true\n  },\n  itemId: {\n    type: ObjectId,\n    required: true,\n    ref: \"Products\"\n  },\n  paymentTransactionId: {\n    type: String,\n    required: true\n  },\n  price: {\n    type: Number,\n    required: true\n  },\n  paidPrice: {\n    type: Number,\n    required: true\n  },\n  quantity: {\n    type: Number,\n    required: false\n  },\n  isApprove: {\n    type: Boolean,\n    default: false\n  },\n  isDisApprove: {\n    type: Boolean,\n    default: false\n  }\n});\nconst PaymentsSuccessSchema = new Schema({\n  uuid: {\n    type: String,\n    default: () => (0, _uuid.default)(),\n    unique: true,\n    required: true\n  },\n  status: {\n    type: String,\n    required: true,\n    enum: [\"success\"]\n  },\n  cartId: {\n    type: ObjectId,\n    ref: \"Carts\",\n    required: true\n  },\n  conversationId: {\n    type: String,\n    required: true\n  },\n  currency: {\n    type: String,\n    required: true,\n    enum: [\"TRY\", \"USD\", \"EUR\"]\n  },\n  paymentId: {\n    type: String,\n    required: true,\n    unique: true\n  },\n  price: {\n    type: Number,\n    required: true\n  },\n  paidPrice: {\n    type: Number,\n    required: true\n  },\n  itemTransactions: {\n    type: [ItemTransactionSchema]\n  },\n  log: {\n    type: Schema.Types.Mixed,\n    required: true\n  }\n}, {\n  _id: true,\n  collection: \"payment-success\",\n  timestamps: true,\n  toJSON: {\n    transform: (doc, ret) => {\n      delete ret.__v;\n      return {\n        ...ret\n      };\n    }\n  }\n});\nconst PaymentsSuccess = _mongoose.default.model(\"PaymentSuccess\", PaymentsSuccessSchema);\nvar _default = exports.default = PaymentsSuccess;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl91dWlkIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiU2NoZW1hIiwibW9uZ29vc2UiLCJPYmplY3RJZCIsIlR5cGVzIiwiSXRlbVRyYW5zYWN0aW9uU2NoZW1hIiwidXVpZCIsInR5cGUiLCJTdHJpbmciLCJ1bmlxdWUiLCJyZXF1aXJlZCIsIml0ZW1JZCIsInJlZiIsInBheW1lbnRUcmFuc2FjdGlvbklkIiwicHJpY2UiLCJOdW1iZXIiLCJwYWlkUHJpY2UiLCJxdWFudGl0eSIsImlzQXBwcm92ZSIsIkJvb2xlYW4iLCJpc0Rpc0FwcHJvdmUiLCJQYXltZW50c1N1Y2Nlc3NTY2hlbWEiLCJzdGF0dXMiLCJlbnVtIiwiY2FydElkIiwiY29udmVyc2F0aW9uSWQiLCJjdXJyZW5jeSIsInBheW1lbnRJZCIsIml0ZW1UcmFuc2FjdGlvbnMiLCJsb2ciLCJNaXhlZCIsIl9pZCIsImNvbGxlY3Rpb24iLCJ0aW1lc3RhbXBzIiwidG9KU09OIiwidHJhbnNmb3JtIiwiZG9jIiwicmV0IiwiX192IiwiUGF5bWVudHNTdWNjZXNzIiwibW9kZWwiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9kYi8iLCJzb3VyY2VzIjpbInBheW1lbnQtc3VjY2Vzcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UgZnJvbSBcIm1vbmdvb3NlXCI7XG5pbXBvcnQgdXVpZCBmcm9tIFwiLi4vdXRpbHMvdXVpZFwiO1xuXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWE7XG5jb25zdCB7IE9iamVjdElkIH0gPSBTY2hlbWEuVHlwZXM7XG5cbmNvbnN0IEl0ZW1UcmFuc2FjdGlvblNjaGVtYSA9IG5ldyBTY2hlbWEoe1xuICB1dWlkOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGRlZmF1bHQ6ICgpID0+IHV1aWQoKSwgLy9oYXRhIGFsxLFyc2FrIHTDvG0gZGJsZXJkZWtpIHV1aWRsZXJlIGJpIGJha1xuICAgIHVuaXF1ZTogdHJ1ZSxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgaXRlbUlkOiB7XG4gICAgdHlwZTogT2JqZWN0SWQsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgcmVmOiBcIlByb2R1Y3RzXCIsXG4gIH0sXG4gIHBheW1lbnRUcmFuc2FjdGlvbklkOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHJlcXVpcmVkOiB0cnVlLFxuICB9LFxuICBwcmljZToge1xuICAgIHR5cGU6IE51bWJlcixcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgcGFpZFByaWNlOiB7XG4gICAgdHlwZTogTnVtYmVyLFxuICAgIHJlcXVpcmVkOiB0cnVlLFxuICB9LFxuICBxdWFudGl0eToge1xuICAgIHR5cGU6IE51bWJlcixcbiAgICByZXF1aXJlZDogZmFsc2UsXG4gIH0sXG4gIGlzQXBwcm92ZToge1xuICAgIHR5cGU6IEJvb2xlYW4sXG4gICAgZGVmYXVsdDogZmFsc2UsXG4gIH0sXG4gIGlzRGlzQXBwcm92ZToge1xuICAgIHR5cGU6IEJvb2xlYW4sXG4gICAgZGVmYXVsdDogZmFsc2UsXG4gIH0sXG59KTtcblxuY29uc3QgUGF5bWVudHNTdWNjZXNzU2NoZW1hID0gbmV3IFNjaGVtYShcbiAge1xuICAgIHV1aWQ6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIGRlZmF1bHQ6ICgpID0+IHV1aWQoKSxcbiAgICAgIHVuaXF1ZTogdHJ1ZSxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgc3RhdHVzOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIGVudW06IFtcInN1Y2Nlc3NcIl0sXG4gICAgfSxcbiAgICBjYXJ0SWQ6IHtcbiAgICAgIHR5cGU6IE9iamVjdElkLFxuICAgICAgcmVmOiBcIkNhcnRzXCIsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGNvbnZlcnNhdGlvbklkOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGN1cnJlbmN5OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIGVudW06IFtcIlRSWVwiLCBcIlVTRFwiLCBcIkVVUlwiXSxcbiAgICB9LFxuICAgIHBheW1lbnRJZDoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICB1bmlxdWU6IHRydWUsXG4gICAgfSxcbiAgICBwcmljZToge1xuICAgICAgdHlwZTogTnVtYmVyLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBwYWlkUHJpY2U6IHtcbiAgICAgIHR5cGU6IE51bWJlcixcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgaXRlbVRyYW5zYWN0aW9uczoge1xuICAgICAgdHlwZTogW0l0ZW1UcmFuc2FjdGlvblNjaGVtYV0sXG4gICAgfSxcbiAgICBsb2c6IHtcbiAgICAgIHR5cGU6IFNjaGVtYS5UeXBlcy5NaXhlZCxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gIH0sXG4gIHtcbiAgICBfaWQ6IHRydWUsXG4gICAgY29sbGVjdGlvbjogXCJwYXltZW50LXN1Y2Nlc3NcIixcbiAgICB0aW1lc3RhbXBzOiB0cnVlLFxuICAgIHRvSlNPTjoge1xuICAgICAgdHJhbnNmb3JtOiAoZG9jLCByZXQpID0+IHtcbiAgICAgICAgZGVsZXRlIHJldC5fX3Y7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgLi4ucmV0LFxuICAgICAgICB9O1xuICAgICAgfSxcbiAgICB9LFxuICB9XG4pO1xuXG5jb25zdCBQYXltZW50c1N1Y2Nlc3MgPSBtb25nb29zZS5tb2RlbChcIlBheW1lbnRTdWNjZXNzXCIsIFBheW1lbnRzU3VjY2Vzc1NjaGVtYSk7XG5leHBvcnQgZGVmYXVsdCBQYXltZW50c1N1Y2Nlc3M7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLEtBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUFpQyxTQUFBRCx1QkFBQUcsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUVqQyxNQUFNRyxNQUFNLEdBQUdDLGlCQUFRLENBQUNELE1BQU07QUFDOUIsTUFBTTtFQUFFRTtBQUFTLENBQUMsR0FBR0YsTUFBTSxDQUFDRyxLQUFLO0FBRWpDLE1BQU1DLHFCQUFxQixHQUFHLElBQUlKLE1BQU0sQ0FBQztFQUN2Q0ssSUFBSSxFQUFFO0lBQ0pDLElBQUksRUFBRUMsTUFBTTtJQUNaUixPQUFPLEVBQUVBLENBQUEsS0FBTSxJQUFBTSxhQUFJLEVBQUMsQ0FBQztJQUFFO0lBQ3ZCRyxNQUFNLEVBQUUsSUFBSTtJQUNaQyxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RDLE1BQU0sRUFBRTtJQUNOSixJQUFJLEVBQUVKLFFBQVE7SUFDZE8sUUFBUSxFQUFFLElBQUk7SUFDZEUsR0FBRyxFQUFFO0VBQ1AsQ0FBQztFQUNEQyxvQkFBb0IsRUFBRTtJQUNwQk4sSUFBSSxFQUFFQyxNQUFNO0lBQ1pFLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDREksS0FBSyxFQUFFO0lBQ0xQLElBQUksRUFBRVEsTUFBTTtJQUNaTCxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RNLFNBQVMsRUFBRTtJQUNUVCxJQUFJLEVBQUVRLE1BQU07SUFDWkwsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNETyxRQUFRLEVBQUU7SUFDUlYsSUFBSSxFQUFFUSxNQUFNO0lBQ1pMLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDRFEsU0FBUyxFQUFFO0lBQ1RYLElBQUksRUFBRVksT0FBTztJQUNibkIsT0FBTyxFQUFFO0VBQ1gsQ0FBQztFQUNEb0IsWUFBWSxFQUFFO0lBQ1piLElBQUksRUFBRVksT0FBTztJQUNibkIsT0FBTyxFQUFFO0VBQ1g7QUFDRixDQUFDLENBQUM7QUFFRixNQUFNcUIscUJBQXFCLEdBQUcsSUFBSXBCLE1BQU0sQ0FDdEM7RUFDRUssSUFBSSxFQUFFO0lBQ0pDLElBQUksRUFBRUMsTUFBTTtJQUNaUixPQUFPLEVBQUVBLENBQUEsS0FBTSxJQUFBTSxhQUFJLEVBQUMsQ0FBQztJQUNyQkcsTUFBTSxFQUFFLElBQUk7SUFDWkMsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNEWSxNQUFNLEVBQUU7SUFDTmYsSUFBSSxFQUFFQyxNQUFNO0lBQ1pFLFFBQVEsRUFBRSxJQUFJO0lBQ2RhLElBQUksRUFBRSxDQUFDLFNBQVM7RUFDbEIsQ0FBQztFQUNEQyxNQUFNLEVBQUU7SUFDTmpCLElBQUksRUFBRUosUUFBUTtJQUNkUyxHQUFHLEVBQUUsT0FBTztJQUNaRixRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RlLGNBQWMsRUFBRTtJQUNkbEIsSUFBSSxFQUFFQyxNQUFNO0lBQ1pFLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDRGdCLFFBQVEsRUFBRTtJQUNSbkIsSUFBSSxFQUFFQyxNQUFNO0lBQ1pFLFFBQVEsRUFBRSxJQUFJO0lBQ2RhLElBQUksRUFBRSxDQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSztFQUM1QixDQUFDO0VBQ0RJLFNBQVMsRUFBRTtJQUNUcEIsSUFBSSxFQUFFQyxNQUFNO0lBQ1pFLFFBQVEsRUFBRSxJQUFJO0lBQ2RELE1BQU0sRUFBRTtFQUNWLENBQUM7RUFDREssS0FBSyxFQUFFO0lBQ0xQLElBQUksRUFBRVEsTUFBTTtJQUNaTCxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RNLFNBQVMsRUFBRTtJQUNUVCxJQUFJLEVBQUVRLE1BQU07SUFDWkwsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNEa0IsZ0JBQWdCLEVBQUU7SUFDaEJyQixJQUFJLEVBQUUsQ0FBQ0YscUJBQXFCO0VBQzlCLENBQUM7RUFDRHdCLEdBQUcsRUFBRTtJQUNIdEIsSUFBSSxFQUFFTixNQUFNLENBQUNHLEtBQUssQ0FBQzBCLEtBQUs7SUFDeEJwQixRQUFRLEVBQUU7RUFDWjtBQUNGLENBQUMsRUFDRDtFQUNFcUIsR0FBRyxFQUFFLElBQUk7RUFDVEMsVUFBVSxFQUFFLGlCQUFpQjtFQUM3QkMsVUFBVSxFQUFFLElBQUk7RUFDaEJDLE1BQU0sRUFBRTtJQUNOQyxTQUFTLEVBQUVBLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxLQUFLO01BQ3ZCLE9BQU9BLEdBQUcsQ0FBQ0MsR0FBRztNQUNkLE9BQU87UUFDTCxHQUFHRDtNQUNMLENBQUM7SUFDSDtFQUNGO0FBQ0YsQ0FDRixDQUFDO0FBRUQsTUFBTUUsZUFBZSxHQUFHckMsaUJBQVEsQ0FBQ3NDLEtBQUssQ0FBQyxnQkFBZ0IsRUFBRW5CLHFCQUFxQixDQUFDO0FBQUMsSUFBQW9CLFFBQUEsR0FBQUMsT0FBQSxDQUFBMUMsT0FBQSxHQUNqRXVDLGVBQWUiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","_uuid","e","__esModule","default","Schema","mongoose","ObjectId","Types","ItemTransactionSchema","uuid","type","String","unique","required","itemId","ref","paymentTransactionId","price","Number","paidPrice","quantity","isApprove","Boolean","isDisApprove","PaymentsSuccessSchema","status","enum","cartId","conversationId","currency","paymentId","itemTransactions","log","Mixed","_id","collection","timestamps","toJSON","transform","doc","ret","__v","PaymentsSuccess","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["payment-success.js"],"sourcesContent":["import mongoose from \"mongoose\";\nimport uuid from \"../utils/uuid\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\n\nconst ItemTransactionSchema = new Schema({\n  uuid: {\n    type: String,\n    default: () => uuid(), //hata alırsak tüm dblerdeki uuidlere bi bak\n    unique: true,\n    required: true,\n  },\n  itemId: {\n    type: ObjectId,\n    required: true,\n    ref: \"Products\",\n  },\n  paymentTransactionId: {\n    type: String,\n    required: true,\n  },\n  price: {\n    type: Number,\n    required: true,\n  },\n  paidPrice: {\n    type: Number,\n    required: true,\n  },\n  quantity: {\n    type: Number,\n    required: false,\n  },\n  isApprove: {\n    type: Boolean,\n    default: false,\n  },\n  isDisApprove: {\n    type: Boolean,\n    default: false,\n  },\n});\n\nconst PaymentsSuccessSchema = new Schema(\n  {\n    uuid: {\n      type: String,\n      default: () => uuid(),\n      unique: true,\n      required: true,\n    },\n    status: {\n      type: String,\n      required: true,\n      enum: [\"success\"],\n    },\n    cartId: {\n      type: ObjectId,\n      ref: \"Carts\",\n      required: true,\n    },\n    conversationId: {\n      type: String,\n      required: true,\n    },\n    currency: {\n      type: String,\n      required: true,\n      enum: [\"TRY\", \"USD\", \"EUR\"],\n    },\n    paymentId: {\n      type: String,\n      required: true,\n      unique: true,\n    },\n    price: {\n      type: Number,\n      required: true,\n    },\n    paidPrice: {\n      type: Number,\n      required: true,\n    },\n    itemTransactions: {\n      type: [ItemTransactionSchema],\n    },\n    log: {\n      type: Schema.Types.Mixed,\n      required: true,\n    },\n  },\n  {\n    _id: true,\n    collection: \"payment-success\",\n    timestamps: true,\n    toJSON: {\n      transform: (doc, ret) => {\n        delete ret.__v;\n        return {\n          ...ret,\n        };\n      },\n    },\n  }\n);\n\nconst PaymentsSuccess = mongoose.model(\"PaymentSuccess\", PaymentsSuccessSchema);\nexport default PaymentsSuccess;\n"],"mappings":"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","ignoreList":[]}},"mtime":1731410453564},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/payment-failed.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst PaymentsFailedSchema = new Schema({\n  uuid: {\n    type: String,\n    default: () => (0, _uuid.default)(),\n    unique: true,\n    required: true\n  },\n  status: {\n    type: String,\n    required: true,\n    enum: [\"failure\"]\n  },\n  conversationId: {\n    type: String,\n    required: true\n  },\n  errorCode: {\n    type: String,\n    required: true\n  },\n  errorMessage: {\n    type: String,\n    required: true\n  },\n  log: {\n    type: Schema.Types.Mixed,\n    required: true\n  }\n}, {\n  _id: true,\n  collection: \"payment-failed\",\n  timestamps: true,\n  toJSON: {\n    transform: (doc, ret) => {\n      delete ret.__v;\n      return {\n        ...ret\n      };\n    }\n  }\n});\nconst PaymentsFailed = _mongoose.default.model(\"PaymentsFailed\", PaymentsFailedSchema);\nvar _default = exports.default = PaymentsFailed;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl91dWlkIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiU2NoZW1hIiwibW9uZ29vc2UiLCJPYmplY3RJZCIsIlR5cGVzIiwiUGF5bWVudHNGYWlsZWRTY2hlbWEiLCJ1dWlkIiwidHlwZSIsIlN0cmluZyIsInVuaXF1ZSIsInJlcXVpcmVkIiwic3RhdHVzIiwiZW51bSIsImNvbnZlcnNhdGlvbklkIiwiZXJyb3JDb2RlIiwiZXJyb3JNZXNzYWdlIiwibG9nIiwiTWl4ZWQiLCJfaWQiLCJjb2xsZWN0aW9uIiwidGltZXN0YW1wcyIsInRvSlNPTiIsInRyYW5zZm9ybSIsImRvYyIsInJldCIsIl9fdiIsIlBheW1lbnRzRmFpbGVkIiwibW9kZWwiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9kYi8iLCJzb3VyY2VzIjpbInBheW1lbnQtZmFpbGVkLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSBmcm9tIFwibW9uZ29vc2VcIjtcbmltcG9ydCB1dWlkIGZyb20gXCIuLi91dGlscy91dWlkXCI7XG5cbmNvbnN0IFNjaGVtYSA9IG1vbmdvb3NlLlNjaGVtYTtcbmNvbnN0IHsgT2JqZWN0SWQgfSA9IFNjaGVtYS5UeXBlcztcblxuY29uc3QgUGF5bWVudHNGYWlsZWRTY2hlbWEgPSBuZXcgU2NoZW1hKFxuICB7XG4gICAgdXVpZDoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgZGVmYXVsdDogKCkgPT4gdXVpZCgpLFxuICAgICAgdW5pcXVlOiB0cnVlLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBzdGF0dXM6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgZW51bTogW1wiZmFpbHVyZVwiXSxcbiAgICB9LFxuICAgIGNvbnZlcnNhdGlvbklkOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGVycm9yQ29kZToge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBlcnJvck1lc3NhZ2U6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgbG9nOiB7XG4gICAgICB0eXBlOiBTY2hlbWEuVHlwZXMuTWl4ZWQsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICB9LFxuICB7XG4gICAgX2lkOiB0cnVlLFxuICAgIGNvbGxlY3Rpb246IFwicGF5bWVudC1mYWlsZWRcIixcbiAgICB0aW1lc3RhbXBzOiB0cnVlLFxuICAgIHRvSlNPTjoge1xuICAgICAgdHJhbnNmb3JtOiAoZG9jLCByZXQpID0+IHtcbiAgICAgICAgZGVsZXRlIHJldC5fX3Y7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgLi4ucmV0LFxuICAgICAgICB9O1xuICAgICAgfSxcbiAgICB9LFxuICB9XG4pO1xuXG5jb25zdCBQYXltZW50c0ZhaWxlZCA9IG1vbmdvb3NlLm1vZGVsKFwiUGF5bWVudHNGYWlsZWRcIiwgUGF5bWVudHNGYWlsZWRTY2hlbWEpO1xuZXhwb3J0IGRlZmF1bHQgUGF5bWVudHNGYWlsZWQ7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLEtBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUFpQyxTQUFBRCx1QkFBQUcsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUVqQyxNQUFNRyxNQUFNLEdBQUdDLGlCQUFRLENBQUNELE1BQU07QUFDOUIsTUFBTTtFQUFFRTtBQUFTLENBQUMsR0FBR0YsTUFBTSxDQUFDRyxLQUFLO0FBRWpDLE1BQU1DLG9CQUFvQixHQUFHLElBQUlKLE1BQU0sQ0FDckM7RUFDRUssSUFBSSxFQUFFO0lBQ0pDLElBQUksRUFBRUMsTUFBTTtJQUNaUixPQUFPLEVBQUVBLENBQUEsS0FBTSxJQUFBTSxhQUFJLEVBQUMsQ0FBQztJQUNyQkcsTUFBTSxFQUFFLElBQUk7SUFDWkMsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNEQyxNQUFNLEVBQUU7SUFDTkosSUFBSSxFQUFFQyxNQUFNO0lBQ1pFLFFBQVEsRUFBRSxJQUFJO0lBQ2RFLElBQUksRUFBRSxDQUFDLFNBQVM7RUFDbEIsQ0FBQztFQUNEQyxjQUFjLEVBQUU7SUFDZE4sSUFBSSxFQUFFQyxNQUFNO0lBQ1pFLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDREksU0FBUyxFQUFFO0lBQ1RQLElBQUksRUFBRUMsTUFBTTtJQUNaRSxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RLLFlBQVksRUFBRTtJQUNaUixJQUFJLEVBQUVDLE1BQU07SUFDWkUsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNETSxHQUFHLEVBQUU7SUFDSFQsSUFBSSxFQUFFTixNQUFNLENBQUNHLEtBQUssQ0FBQ2EsS0FBSztJQUN4QlAsUUFBUSxFQUFFO0VBQ1o7QUFDRixDQUFDLEVBQ0Q7RUFDRVEsR0FBRyxFQUFFLElBQUk7RUFDVEMsVUFBVSxFQUFFLGdCQUFnQjtFQUM1QkMsVUFBVSxFQUFFLElBQUk7RUFDaEJDLE1BQU0sRUFBRTtJQUNOQyxTQUFTLEVBQUVBLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxLQUFLO01BQ3ZCLE9BQU9BLEdBQUcsQ0FBQ0MsR0FBRztNQUNkLE9BQU87UUFDTCxHQUFHRDtNQUNMLENBQUM7SUFDSDtFQUNGO0FBQ0YsQ0FDRixDQUFDO0FBRUQsTUFBTUUsY0FBYyxHQUFHeEIsaUJBQVEsQ0FBQ3lCLEtBQUssQ0FBQyxnQkFBZ0IsRUFBRXRCLG9CQUFvQixDQUFDO0FBQUMsSUFBQXVCLFFBQUEsR0FBQUMsT0FBQSxDQUFBN0IsT0FBQSxHQUMvRDBCLGNBQWMiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","_uuid","e","__esModule","default","Schema","mongoose","ObjectId","Types","PaymentsFailedSchema","uuid","type","String","unique","required","status","enum","conversationId","errorCode","errorMessage","log","Mixed","_id","collection","timestamps","toJSON","transform","doc","ret","__v","PaymentsFailed","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["payment-failed.js"],"sourcesContent":["import mongoose from \"mongoose\";\nimport uuid from \"../utils/uuid\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\n\nconst PaymentsFailedSchema = new Schema(\n  {\n    uuid: {\n      type: String,\n      default: () => uuid(),\n      unique: true,\n      required: true,\n    },\n    status: {\n      type: String,\n      required: true,\n      enum: [\"failure\"],\n    },\n    conversationId: {\n      type: String,\n      required: true,\n    },\n    errorCode: {\n      type: String,\n      required: true,\n    },\n    errorMessage: {\n      type: String,\n      required: true,\n    },\n    log: {\n      type: Schema.Types.Mixed,\n      required: true,\n    },\n  },\n  {\n    _id: true,\n    collection: \"payment-failed\",\n    timestamps: true,\n    toJSON: {\n      transform: (doc, ret) => {\n        delete ret.__v;\n        return {\n          ...ret,\n        };\n      },\n    },\n  }\n);\n\nconst PaymentsFailed = mongoose.model(\"PaymentsFailed\", PaymentsFailedSchema);\nexport default PaymentsFailed;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,KAAA,GAAAF,sBAAA,CAAAC,OAAA;AAAiC,SAAAD,uBAAAG,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEjC,MAAMG,MAAM,GAAGC,iBAAQ,CAACD,MAAM;AAC9B,MAAM;EAAEE;AAAS,CAAC,GAAGF,MAAM,CAACG,KAAK;AAEjC,MAAMC,oBAAoB,GAAG,IAAIJ,MAAM,CACrC;EACEK,IAAI,EAAE;IACJC,IAAI,EAAEC,MAAM;IACZR,OAAO,EAAEA,CAAA,KAAM,IAAAM,aAAI,EAAC,CAAC;IACrBG,MAAM,EAAE,IAAI;IACZC,QAAQ,EAAE;EACZ,CAAC;EACDC,MAAM,EAAE;IACNJ,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE,IAAI;IACdE,IAAI,EAAE,CAAC,SAAS;EAClB,CAAC;EACDC,cAAc,EAAE;IACdN,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE;EACZ,CAAC;EACDI,SAAS,EAAE;IACTP,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE;EACZ,CAAC;EACDK,YAAY,EAAE;IACZR,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE;EACZ,CAAC;EACDM,GAAG,EAAE;IACHT,IAAI,EAAEN,MAAM,CAACG,KAAK,CAACa,KAAK;IACxBP,QAAQ,EAAE;EACZ;AACF,CAAC,EACD;EACEQ,GAAG,EAAE,IAAI;EACTC,UAAU,EAAE,gBAAgB;EAC5BC,UAAU,EAAE,IAAI;EAChBC,MAAM,EAAE;IACNC,SAAS,EAAEA,CAACC,GAAG,EAAEC,GAAG,KAAK;MACvB,OAAOA,GAAG,CAACC,GAAG;MACd,OAAO;QACL,GAAGD;MACL,CAAC;IACH;EACF;AACF,CACF,CAAC;AAED,MAAME,cAAc,GAAGxB,iBAAQ,CAACyB,KAAK,CAAC,gBAAgB,EAAEtB,oBAAoB,CAAC;AAAC,IAAAuB,QAAA,GAAAC,OAAA,CAAA7B,OAAA,GAC/D0B,cAAc","ignoreList":[]}},"mtime":1731323497596},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/payment-success.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst ItemTransactionSchema = new Schema({\n  uuid: {\n    type: String,\n    default: () => (0, _uuid.default)(),\n    //hata alırsak tüm dblerdeki uuidlere bi bak\n    unique: true,\n    required: true\n  },\n  itemId: {\n    type: ObjectId,\n    required: true,\n    ref: \"Products\"\n  },\n  paymentTransactionId: {\n    type: String,\n    required: true\n  },\n  price: {\n    type: Number,\n    required: true\n  },\n  paidPrice: {\n    type: Number,\n    required: true\n  },\n  quantity: {\n    type: Number,\n    required: false\n  },\n  isApprove: {\n    type: Boolean,\n    default: false\n  },\n  isDisApprove: {\n    type: Boolean,\n    default: false\n  }\n});\nconst PaymentsSuccessSchema = new Schema({\n  uuid: {\n    type: String,\n    default: () => (0, _uuid.default)(),\n    unique: true,\n    required: true\n  },\n  status: {\n    type: String,\n    required: true,\n    enum: [\"success\"]\n  },\n  cartId: {\n    type: ObjectId,\n    ref: \"Carts\",\n    required: true\n  },\n  conversationId: {\n    type: String,\n    required: true\n  },\n  currency: {\n    type: String,\n    required: true,\n    enum: [\"TRY\", \"USD\", \"EUR\"]\n  },\n  paymentId: {\n    type: String,\n    required: true,\n    unique: true\n  },\n  price: {\n    type: Number,\n    required: true\n  },\n  paidPrice: {\n    type: Number,\n    required: true\n  },\n  itemTransactions: {\n    type: [ItemTransactionSchema]\n  },\n  log: {\n    type: Schema.Types.Mixed,\n    required: true\n  }\n}, {\n  _id: true,\n  collection: \"payment-success\",\n  timestamps: true,\n  toJSON: {\n    transform: (doc, ret) => {\n      delete ret.__v;\n      return {\n        ...ret\n      };\n    }\n  }\n});\nconst PaymentsSuccess = _mongoose.default.model(\"PaymentSuccess\", PaymentsSuccessSchema);\nvar _default = exports.default = PaymentsSuccess;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl91dWlkIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiU2NoZW1hIiwibW9uZ29vc2UiLCJPYmplY3RJZCIsIlR5cGVzIiwiSXRlbVRyYW5zYWN0aW9uU2NoZW1hIiwidXVpZCIsInR5cGUiLCJTdHJpbmciLCJ1bmlxdWUiLCJyZXF1aXJlZCIsIml0ZW1JZCIsInJlZiIsInBheW1lbnRUcmFuc2FjdGlvbklkIiwicHJpY2UiLCJOdW1iZXIiLCJwYWlkUHJpY2UiLCJxdWFudGl0eSIsImlzQXBwcm92ZSIsIkJvb2xlYW4iLCJpc0Rpc0FwcHJvdmUiLCJQYXltZW50c1N1Y2Nlc3NTY2hlbWEiLCJzdGF0dXMiLCJlbnVtIiwiY2FydElkIiwiY29udmVyc2F0aW9uSWQiLCJjdXJyZW5jeSIsInBheW1lbnRJZCIsIml0ZW1UcmFuc2FjdGlvbnMiLCJsb2ciLCJNaXhlZCIsIl9pZCIsImNvbGxlY3Rpb24iLCJ0aW1lc3RhbXBzIiwidG9KU09OIiwidHJhbnNmb3JtIiwiZG9jIiwicmV0IiwiX192IiwiUGF5bWVudHNTdWNjZXNzIiwibW9kZWwiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9kYi8iLCJzb3VyY2VzIjpbInBheW1lbnQtc3VjY2Vzcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9uZ29vc2UgZnJvbSBcIm1vbmdvb3NlXCI7XG5pbXBvcnQgdXVpZCBmcm9tIFwiLi4vdXRpbHMvdXVpZFwiO1xuXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWE7XG5jb25zdCB7IE9iamVjdElkIH0gPSBTY2hlbWEuVHlwZXM7XG5cbmNvbnN0IEl0ZW1UcmFuc2FjdGlvblNjaGVtYSA9IG5ldyBTY2hlbWEoe1xuICB1dWlkOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGRlZmF1bHQ6ICgpID0+IHV1aWQoKSwgLy9oYXRhIGFsxLFyc2FrIHTDvG0gZGJsZXJkZWtpIHV1aWRsZXJlIGJpIGJha1xuICAgIHVuaXF1ZTogdHJ1ZSxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgaXRlbUlkOiB7XG4gICAgdHlwZTogT2JqZWN0SWQsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgcmVmOiBcIlByb2R1Y3RzXCIsXG4gIH0sXG4gIHBheW1lbnRUcmFuc2FjdGlvbklkOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHJlcXVpcmVkOiB0cnVlLFxuICB9LFxuICBwcmljZToge1xuICAgIHR5cGU6IE51bWJlcixcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgcGFpZFByaWNlOiB7XG4gICAgdHlwZTogTnVtYmVyLFxuICAgIHJlcXVpcmVkOiB0cnVlLFxuICB9LFxuICBxdWFudGl0eToge1xuICAgIHR5cGU6IE51bWJlcixcbiAgICByZXF1aXJlZDogZmFsc2UsXG4gIH0sXG4gIGlzQXBwcm92ZToge1xuICAgIHR5cGU6IEJvb2xlYW4sXG4gICAgZGVmYXVsdDogZmFsc2UsXG4gIH0sXG4gIGlzRGlzQXBwcm92ZToge1xuICAgIHR5cGU6IEJvb2xlYW4sXG4gICAgZGVmYXVsdDogZmFsc2UsXG4gIH0sXG59KTtcblxuY29uc3QgUGF5bWVudHNTdWNjZXNzU2NoZW1hID0gbmV3IFNjaGVtYShcbiAge1xuICAgIHV1aWQ6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIGRlZmF1bHQ6ICgpID0+IHV1aWQoKSxcbiAgICAgIHVuaXF1ZTogdHJ1ZSxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgc3RhdHVzOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIGVudW06IFtcInN1Y2Nlc3NcIl0sXG4gICAgfSxcbiAgICBjYXJ0SWQ6IHtcbiAgICAgIHR5cGU6IE9iamVjdElkLFxuICAgICAgcmVmOiBcIkNhcnRzXCIsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGNvbnZlcnNhdGlvbklkOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGN1cnJlbmN5OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIGVudW06IFtcIlRSWVwiLCBcIlVTRFwiLCBcIkVVUlwiXSxcbiAgICB9LFxuICAgIHBheW1lbnRJZDoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICB1bmlxdWU6IHRydWUsXG4gICAgfSxcbiAgICBwcmljZToge1xuICAgICAgdHlwZTogTnVtYmVyLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBwYWlkUHJpY2U6IHtcbiAgICAgIHR5cGU6IE51bWJlcixcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgaXRlbVRyYW5zYWN0aW9uczoge1xuICAgICAgdHlwZTogW0l0ZW1UcmFuc2FjdGlvblNjaGVtYV0sXG4gICAgfSxcbiAgICBsb2c6IHtcbiAgICAgIHR5cGU6IFNjaGVtYS5UeXBlcy5NaXhlZCxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gIH0sXG4gIHtcbiAgICBfaWQ6IHRydWUsXG4gICAgY29sbGVjdGlvbjogXCJwYXltZW50LXN1Y2Nlc3NcIixcbiAgICB0aW1lc3RhbXBzOiB0cnVlLFxuICAgIHRvSlNPTjoge1xuICAgICAgdHJhbnNmb3JtOiAoZG9jLCByZXQpID0+IHtcbiAgICAgICAgZGVsZXRlIHJldC5fX3Y7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgLi4ucmV0LFxuICAgICAgICB9O1xuICAgICAgfSxcbiAgICB9LFxuICB9XG4pO1xuXG5jb25zdCBQYXltZW50c1N1Y2Nlc3MgPSBtb25nb29zZS5tb2RlbChcIlBheW1lbnRTdWNjZXNzXCIsIFBheW1lbnRzU3VjY2Vzc1NjaGVtYSk7XG5leHBvcnQgZGVmYXVsdCBQYXltZW50c1N1Y2Nlc3M7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLEtBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUFpQyxTQUFBRCx1QkFBQUcsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUVqQyxNQUFNRyxNQUFNLEdBQUdDLGlCQUFRLENBQUNELE1BQU07QUFDOUIsTUFBTTtFQUFFRTtBQUFTLENBQUMsR0FBR0YsTUFBTSxDQUFDRyxLQUFLO0FBRWpDLE1BQU1DLHFCQUFxQixHQUFHLElBQUlKLE1BQU0sQ0FBQztFQUN2Q0ssSUFBSSxFQUFFO0lBQ0pDLElBQUksRUFBRUMsTUFBTTtJQUNaUixPQUFPLEVBQUVBLENBQUEsS0FBTSxJQUFBTSxhQUFJLEVBQUMsQ0FBQztJQUFFO0lBQ3ZCRyxNQUFNLEVBQUUsSUFBSTtJQUNaQyxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RDLE1BQU0sRUFBRTtJQUNOSixJQUFJLEVBQUVKLFFBQVE7SUFDZE8sUUFBUSxFQUFFLElBQUk7SUFDZEUsR0FBRyxFQUFFO0VBQ1AsQ0FBQztFQUNEQyxvQkFBb0IsRUFBRTtJQUNwQk4sSUFBSSxFQUFFQyxNQUFNO0lBQ1pFLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDREksS0FBSyxFQUFFO0lBQ0xQLElBQUksRUFBRVEsTUFBTTtJQUNaTCxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RNLFNBQVMsRUFBRTtJQUNUVCxJQUFJLEVBQUVRLE1BQU07SUFDWkwsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNETyxRQUFRLEVBQUU7SUFDUlYsSUFBSSxFQUFFUSxNQUFNO0lBQ1pMLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDRFEsU0FBUyxFQUFFO0lBQ1RYLElBQUksRUFBRVksT0FBTztJQUNibkIsT0FBTyxFQUFFO0VBQ1gsQ0FBQztFQUNEb0IsWUFBWSxFQUFFO0lBQ1piLElBQUksRUFBRVksT0FBTztJQUNibkIsT0FBTyxFQUFFO0VBQ1g7QUFDRixDQUFDLENBQUM7QUFFRixNQUFNcUIscUJBQXFCLEdBQUcsSUFBSXBCLE1BQU0sQ0FDdEM7RUFDRUssSUFBSSxFQUFFO0lBQ0pDLElBQUksRUFBRUMsTUFBTTtJQUNaUixPQUFPLEVBQUVBLENBQUEsS0FBTSxJQUFBTSxhQUFJLEVBQUMsQ0FBQztJQUNyQkcsTUFBTSxFQUFFLElBQUk7SUFDWkMsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNEWSxNQUFNLEVBQUU7SUFDTmYsSUFBSSxFQUFFQyxNQUFNO0lBQ1pFLFFBQVEsRUFBRSxJQUFJO0lBQ2RhLElBQUksRUFBRSxDQUFDLFNBQVM7RUFDbEIsQ0FBQztFQUNEQyxNQUFNLEVBQUU7SUFDTmpCLElBQUksRUFBRUosUUFBUTtJQUNkUyxHQUFHLEVBQUUsT0FBTztJQUNaRixRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RlLGNBQWMsRUFBRTtJQUNkbEIsSUFBSSxFQUFFQyxNQUFNO0lBQ1pFLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDRGdCLFFBQVEsRUFBRTtJQUNSbkIsSUFBSSxFQUFFQyxNQUFNO0lBQ1pFLFFBQVEsRUFBRSxJQUFJO0lBQ2RhLElBQUksRUFBRSxDQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsS0FBSztFQUM1QixDQUFDO0VBQ0RJLFNBQVMsRUFBRTtJQUNUcEIsSUFBSSxFQUFFQyxNQUFNO0lBQ1pFLFFBQVEsRUFBRSxJQUFJO0lBQ2RELE1BQU0sRUFBRTtFQUNWLENBQUM7RUFDREssS0FBSyxFQUFFO0lBQ0xQLElBQUksRUFBRVEsTUFBTTtJQUNaTCxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RNLFNBQVMsRUFBRTtJQUNUVCxJQUFJLEVBQUVRLE1BQU07SUFDWkwsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNEa0IsZ0JBQWdCLEVBQUU7SUFDaEJyQixJQUFJLEVBQUUsQ0FBQ0YscUJBQXFCO0VBQzlCLENBQUM7RUFDRHdCLEdBQUcsRUFBRTtJQUNIdEIsSUFBSSxFQUFFTixNQUFNLENBQUNHLEtBQUssQ0FBQzBCLEtBQUs7SUFDeEJwQixRQUFRLEVBQUU7RUFDWjtBQUNGLENBQUMsRUFDRDtFQUNFcUIsR0FBRyxFQUFFLElBQUk7RUFDVEMsVUFBVSxFQUFFLGlCQUFpQjtFQUM3QkMsVUFBVSxFQUFFLElBQUk7RUFDaEJDLE1BQU0sRUFBRTtJQUNOQyxTQUFTLEVBQUVBLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxLQUFLO01BQ3ZCLE9BQU9BLEdBQUcsQ0FBQ0MsR0FBRztNQUNkLE9BQU87UUFDTCxHQUFHRDtNQUNMLENBQUM7SUFDSDtFQUNGO0FBQ0YsQ0FDRixDQUFDO0FBRUQsTUFBTUUsZUFBZSxHQUFHckMsaUJBQVEsQ0FBQ3NDLEtBQUssQ0FBQyxnQkFBZ0IsRUFBRW5CLHFCQUFxQixDQUFDO0FBQUMsSUFBQW9CLFFBQUEsR0FBQUMsT0FBQSxDQUFBMUMsT0FBQSxHQUNqRXVDLGVBQWUiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","_uuid","e","__esModule","default","Schema","mongoose","ObjectId","Types","ItemTransactionSchema","uuid","type","String","unique","required","itemId","ref","paymentTransactionId","price","Number","paidPrice","quantity","isApprove","Boolean","isDisApprove","PaymentsSuccessSchema","status","enum","cartId","conversationId","currency","paymentId","itemTransactions","log","Mixed","_id","collection","timestamps","toJSON","transform","doc","ret","__v","PaymentsSuccess","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["payment-success.js"],"sourcesContent":["import mongoose from \"mongoose\";\nimport uuid from \"../utils/uuid\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\n\nconst ItemTransactionSchema = new Schema({\n  uuid: {\n    type: String,\n    default: () => uuid(), //hata alırsak tüm dblerdeki uuidlere bi bak\n    unique: true,\n    required: true,\n  },\n  itemId: {\n    type: ObjectId,\n    required: true,\n    ref: \"Products\",\n  },\n  paymentTransactionId: {\n    type: String,\n    required: true,\n  },\n  price: {\n    type: Number,\n    required: true,\n  },\n  paidPrice: {\n    type: Number,\n    required: true,\n  },\n  quantity: {\n    type: Number,\n    required: false,\n  },\n  isApprove: {\n    type: Boolean,\n    default: false,\n  },\n  isDisApprove: {\n    type: Boolean,\n    default: false,\n  },\n});\n\nconst PaymentsSuccessSchema = new Schema(\n  {\n    uuid: {\n      type: String,\n      default: () => uuid(),\n      unique: true,\n      required: true,\n    },\n    status: {\n      type: String,\n      required: true,\n      enum: [\"success\"],\n    },\n    cartId: {\n      type: ObjectId,\n      ref: \"Carts\",\n      required: true,\n    },\n    conversationId: {\n      type: String,\n      required: true,\n    },\n    currency: {\n      type: String,\n      required: true,\n      enum: [\"TRY\", \"USD\", \"EUR\"],\n    },\n    paymentId: {\n      type: String,\n      required: true,\n      unique: true,\n    },\n    price: {\n      type: Number,\n      required: true,\n    },\n    paidPrice: {\n      type: Number,\n      required: true,\n    },\n    itemTransactions: {\n      type: [ItemTransactionSchema],\n    },\n    log: {\n      type: Schema.Types.Mixed,\n      required: true,\n    },\n  },\n  {\n    _id: true,\n    collection: \"payment-success\",\n    timestamps: true,\n    toJSON: {\n      transform: (doc, ret) => {\n        delete ret.__v;\n        return {\n          ...ret,\n        };\n      },\n    },\n  }\n);\n\nconst PaymentsSuccess = mongoose.model(\"PaymentSuccess\", PaymentsSuccessSchema);\nexport default PaymentsSuccess;\n"],"mappings":"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","ignoreList":[]}},"mtime":1731410453564},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/payment-failed.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst PaymentsFailedSchema = new Schema({\n  uuid: {\n    type: String,\n    default: () => (0, _uuid.default)(),\n    unique: true,\n    required: true\n  },\n  status: {\n    type: String,\n    required: true,\n    enum: [\"failure\"]\n  },\n  conversationId: {\n    type: String,\n    required: true\n  },\n  errorCode: {\n    type: String,\n    required: true\n  },\n  errorMessage: {\n    type: String,\n    required: true\n  },\n  log: {\n    type: Schema.Types.Mixed,\n    required: true\n  }\n}, {\n  _id: true,\n  collection: \"payment-failed\",\n  timestamps: true,\n  toJSON: {\n    transform: (doc, ret) => {\n      delete ret.__v;\n      return {\n        ...ret\n      };\n    }\n  }\n});\nconst PaymentsFailed = _mongoose.default.model(\"PaymentsFailed\", PaymentsFailedSchema);\nvar _default = exports.default = PaymentsFailed;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl91dWlkIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiU2NoZW1hIiwibW9uZ29vc2UiLCJPYmplY3RJZCIsIlR5cGVzIiwiUGF5bWVudHNGYWlsZWRTY2hlbWEiLCJ1dWlkIiwidHlwZSIsIlN0cmluZyIsInVuaXF1ZSIsInJlcXVpcmVkIiwic3RhdHVzIiwiZW51bSIsImNvbnZlcnNhdGlvbklkIiwiZXJyb3JDb2RlIiwiZXJyb3JNZXNzYWdlIiwibG9nIiwiTWl4ZWQiLCJfaWQiLCJjb2xsZWN0aW9uIiwidGltZXN0YW1wcyIsInRvSlNPTiIsInRyYW5zZm9ybSIsImRvYyIsInJldCIsIl9fdiIsIlBheW1lbnRzRmFpbGVkIiwibW9kZWwiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9kYi8iLCJzb3VyY2VzIjpbInBheW1lbnQtZmFpbGVkLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSBmcm9tIFwibW9uZ29vc2VcIjtcbmltcG9ydCB1dWlkIGZyb20gXCIuLi91dGlscy91dWlkXCI7XG5cbmNvbnN0IFNjaGVtYSA9IG1vbmdvb3NlLlNjaGVtYTtcbmNvbnN0IHsgT2JqZWN0SWQgfSA9IFNjaGVtYS5UeXBlcztcblxuY29uc3QgUGF5bWVudHNGYWlsZWRTY2hlbWEgPSBuZXcgU2NoZW1hKFxuICB7XG4gICAgdXVpZDoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgZGVmYXVsdDogKCkgPT4gdXVpZCgpLFxuICAgICAgdW5pcXVlOiB0cnVlLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBzdGF0dXM6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgZW51bTogW1wiZmFpbHVyZVwiXSxcbiAgICB9LFxuICAgIGNvbnZlcnNhdGlvbklkOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGVycm9yQ29kZToge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBlcnJvck1lc3NhZ2U6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgbG9nOiB7XG4gICAgICB0eXBlOiBTY2hlbWEuVHlwZXMuTWl4ZWQsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICB9LFxuICB7XG4gICAgX2lkOiB0cnVlLFxuICAgIGNvbGxlY3Rpb246IFwicGF5bWVudC1mYWlsZWRcIixcbiAgICB0aW1lc3RhbXBzOiB0cnVlLFxuICAgIHRvSlNPTjoge1xuICAgICAgdHJhbnNmb3JtOiAoZG9jLCByZXQpID0+IHtcbiAgICAgICAgZGVsZXRlIHJldC5fX3Y7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgLi4ucmV0LFxuICAgICAgICB9O1xuICAgICAgfSxcbiAgICB9LFxuICB9XG4pO1xuXG5jb25zdCBQYXltZW50c0ZhaWxlZCA9IG1vbmdvb3NlLm1vZGVsKFwiUGF5bWVudHNGYWlsZWRcIiwgUGF5bWVudHNGYWlsZWRTY2hlbWEpO1xuZXhwb3J0IGRlZmF1bHQgUGF5bWVudHNGYWlsZWQ7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLEtBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUFpQyxTQUFBRCx1QkFBQUcsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUVqQyxNQUFNRyxNQUFNLEdBQUdDLGlCQUFRLENBQUNELE1BQU07QUFDOUIsTUFBTTtFQUFFRTtBQUFTLENBQUMsR0FBR0YsTUFBTSxDQUFDRyxLQUFLO0FBRWpDLE1BQU1DLG9CQUFvQixHQUFHLElBQUlKLE1BQU0sQ0FDckM7RUFDRUssSUFBSSxFQUFFO0lBQ0pDLElBQUksRUFBRUMsTUFBTTtJQUNaUixPQUFPLEVBQUVBLENBQUEsS0FBTSxJQUFBTSxhQUFJLEVBQUMsQ0FBQztJQUNyQkcsTUFBTSxFQUFFLElBQUk7SUFDWkMsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNEQyxNQUFNLEVBQUU7SUFDTkosSUFBSSxFQUFFQyxNQUFNO0lBQ1pFLFFBQVEsRUFBRSxJQUFJO0lBQ2RFLElBQUksRUFBRSxDQUFDLFNBQVM7RUFDbEIsQ0FBQztFQUNEQyxjQUFjLEVBQUU7SUFDZE4sSUFBSSxFQUFFQyxNQUFNO0lBQ1pFLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDREksU0FBUyxFQUFFO0lBQ1RQLElBQUksRUFBRUMsTUFBTTtJQUNaRSxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RLLFlBQVksRUFBRTtJQUNaUixJQUFJLEVBQUVDLE1BQU07SUFDWkUsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNETSxHQUFHLEVBQUU7SUFDSFQsSUFBSSxFQUFFTixNQUFNLENBQUNHLEtBQUssQ0FBQ2EsS0FBSztJQUN4QlAsUUFBUSxFQUFFO0VBQ1o7QUFDRixDQUFDLEVBQ0Q7RUFDRVEsR0FBRyxFQUFFLElBQUk7RUFDVEMsVUFBVSxFQUFFLGdCQUFnQjtFQUM1QkMsVUFBVSxFQUFFLElBQUk7RUFDaEJDLE1BQU0sRUFBRTtJQUNOQyxTQUFTLEVBQUVBLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxLQUFLO01BQ3ZCLE9BQU9BLEdBQUcsQ0FBQ0MsR0FBRztNQUNkLE9BQU87UUFDTCxHQUFHRDtNQUNMLENBQUM7SUFDSDtFQUNGO0FBQ0YsQ0FDRixDQUFDO0FBRUQsTUFBTUUsY0FBYyxHQUFHeEIsaUJBQVEsQ0FBQ3lCLEtBQUssQ0FBQyxnQkFBZ0IsRUFBRXRCLG9CQUFvQixDQUFDO0FBQUMsSUFBQXVCLFFBQUEsR0FBQUMsT0FBQSxDQUFBN0IsT0FBQSxHQUMvRDBCLGNBQWMiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","_uuid","e","__esModule","default","Schema","mongoose","ObjectId","Types","PaymentsFailedSchema","uuid","type","String","unique","required","status","enum","conversationId","errorCode","errorMessage","log","Mixed","_id","collection","timestamps","toJSON","transform","doc","ret","__v","PaymentsFailed","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["payment-failed.js"],"sourcesContent":["import mongoose from \"mongoose\";\nimport uuid from \"../utils/uuid\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\n\nconst PaymentsFailedSchema = new Schema(\n  {\n    uuid: {\n      type: String,\n      default: () => uuid(),\n      unique: true,\n      required: true,\n    },\n    status: {\n      type: String,\n      required: true,\n      enum: [\"failure\"],\n    },\n    conversationId: {\n      type: String,\n      required: true,\n    },\n    errorCode: {\n      type: String,\n      required: true,\n    },\n    errorMessage: {\n      type: String,\n      required: true,\n    },\n    log: {\n      type: Schema.Types.Mixed,\n      required: true,\n    },\n  },\n  {\n    _id: true,\n    collection: \"payment-failed\",\n    timestamps: true,\n    toJSON: {\n      transform: (doc, ret) => {\n        delete ret.__v;\n        return {\n          ...ret,\n        };\n      },\n    },\n  }\n);\n\nconst PaymentsFailed = mongoose.model(\"PaymentsFailed\", PaymentsFailedSchema);\nexport default PaymentsFailed;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,KAAA,GAAAF,sBAAA,CAAAC,OAAA;AAAiC,SAAAD,uBAAAG,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEjC,MAAMG,MAAM,GAAGC,iBAAQ,CAACD,MAAM;AAC9B,MAAM;EAAEE;AAAS,CAAC,GAAGF,MAAM,CAACG,KAAK;AAEjC,MAAMC,oBAAoB,GAAG,IAAIJ,MAAM,CACrC;EACEK,IAAI,EAAE;IACJC,IAAI,EAAEC,MAAM;IACZR,OAAO,EAAEA,CAAA,KAAM,IAAAM,aAAI,EAAC,CAAC;IACrBG,MAAM,EAAE,IAAI;IACZC,QAAQ,EAAE;EACZ,CAAC;EACDC,MAAM,EAAE;IACNJ,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE,IAAI;IACdE,IAAI,EAAE,CAAC,SAAS;EAClB,CAAC;EACDC,cAAc,EAAE;IACdN,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE;EACZ,CAAC;EACDI,SAAS,EAAE;IACTP,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE;EACZ,CAAC;EACDK,YAAY,EAAE;IACZR,IAAI,EAAEC,MAAM;IACZE,QAAQ,EAAE;EACZ,CAAC;EACDM,GAAG,EAAE;IACHT,IAAI,EAAEN,MAAM,CAACG,KAAK,CAACa,KAAK;IACxBP,QAAQ,EAAE;EACZ;AACF,CAAC,EACD;EACEQ,GAAG,EAAE,IAAI;EACTC,UAAU,EAAE,gBAAgB;EAC5BC,UAAU,EAAE,IAAI;EAChBC,MAAM,EAAE;IACNC,SAAS,EAAEA,CAACC,GAAG,EAAEC,GAAG,KAAK;MACvB,OAAOA,GAAG,CAACC,GAAG;MACd,OAAO;QACL,GAAGD;MACL,CAAC;IACH;EACF;AACF,CACF,CAAC;AAED,MAAME,cAAc,GAAGxB,iBAAQ,CAACyB,KAAK,CAAC,gBAAgB,EAAEtB,oBAAoB,CAAC;AAAC,IAAAuB,QAAA,GAAAC,OAAA,CAAA7B,OAAA,GAC/D0B,cAAc","ignoreList":[]}},"mtime":1731323497596},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/payments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _iyzipay = _interopRequireDefault(require(\"iyzipay\"));\nvar _moment = _interopRequireDefault(require(\"moment\"));\nvar _cart = _interopRequireDefault(require(\"../db/cart\"));\nvar _products = _interopRequireDefault(require(\"../db/products\"));\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _RequiredCheck = require(\"../helpers/RequiredCheck\");\nvar _OrderCompleteMail = _interopRequireDefault(require(\"../middlewares/OrderCompleteMail\"));\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nvar Cards = _interopRequireWildcard(require(\"../services/iyzico/methods/cards\"));\nvar Payments = _interopRequireWildcard(require(\"../services/iyzico/methods/payments\"));\nvar _payments2 = require(\"../utils/payments\");\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function (e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = router => {\n  /*çalışıyor*/router.post(\"/payments/:cartId/with-new-card\", _Session.default, async (req, res, next) => {\n    const {\n      card\n    } = req.body;\n    // if (!card) {\n    //   throw new ApiError(\"Card is required\", 400, \"cardRequired\");\n    // }\n    (0, _RequiredCheck.checkRequiredField)(card, \"Card\");\n    (0, _RequiredCheck.checkRequiredField)(req.params?.cartId, \"CartId\");\n    // if (!req.params?.cartId) {\n    //   throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n    // }\n    const cart = await _cart.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    card.registerCard = \"0\"; //methodslarda registerCard:1 yani kartı kaydet demek ama şuan kaydetme dediğim için 0 yaptım\n\n    // Ürün bilgilerini getirme (Cart'taki productId'leri kullanarak)\n    const productIds = cart.products.map(item => item.productId);\n    const products = await _products.default.find({\n      _id: {\n        $in: productIds\n      }\n    }).populate(\"seller\");\n\n    // Ürün bilgilerini cart'a ekliyoruz\n    const enrichedProducts = cart.products.map(cartProduct => {\n      const productDetail = products.find(product => String(product._id) === String(cartProduct.productId));\n      return {\n        ...cartProduct._doc,\n        productDetail\n      };\n    });\n\n    // Ödenecek miktar hesaplama\n    // const paidPrice = enrichedProducts\n    //   .map((product) => product.productDetail.price * product.quantity)\n    //   .reduce((a, b) => a + b, 0);\n\n    const paidPrice = enrichedProducts.reduce((acc, product) => acc + product.productDetail.price * product.quantity, 0).toFixed(2);\n    const basketItems = enrichedProducts.map(cartProduct => {\n      const product = cartProduct.productDetail;\n      // Log subMerchantKey to ensure it's present\n      console.log(`Processing product: ${product.name}`);\n      console.log(`subMerchantKey: ${product.seller.subMerchantKey}`);\n      return {\n        id: String(product?._id),\n        name: product?.name,\n        category1: product?.categories?.[0] || \"Uncategorized\",\n        category2: product?.categories?.[1] || \"\",\n        itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n        price: (product?.price * cartProduct.quantity).toFixed(2),\n        // Birim fiyatı çarpıyoruz ve virgülden sonra 2 basamak tutuyoruz\n        subMerchantKey: product?.seller?.subMerchantKey,\n        subMerchantPrice: (product.price * cartProduct.quantity * 0.9).toFixed(2)\n      };\n    });\n    console.log(\"Final basketItems array:\", basketItems);\n\n    // Sepetteki ürünlerin toplam fiyatını hesaplıyoruz\n    const basketTotal = basketItems.reduce((acc, item) => acc + parseFloat(item.price), 0).toFixed(2); // Fiyatları alıp float'a çeviriyoruz\n\n    // Ödeme ve sepet toplamları kontrolü\n    if (basketTotal !== paidPrice) {\n      console.log(basketTotal);\n      throw new _ApiError.default(\"Gönderilen tutar tüm kırılımların toplam tutarına eşit olmalıdır\", 400, \"priceMismatch\");\n    }\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: basketTotal,\n      //toFixed(2) vardı\n      paidPrice: basketTotal,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems\n    };\n    try {\n      let result = await Payments.createPayment(data);\n      await (0, _payments2.CompletePayment)(result);\n\n      // Ürün stoklarını güncelleme\n      const productStockUpdates = {};\n\n      // Sepetteki ürünleri döngüyle işleyerek aynı ürünlerden kaç tane olduğunu hesapla\n      for (const cartProduct of cart.products) {\n        const productId = String(cartProduct.productId); // Doğru ürün ID'si buradan alınmalı\n        const quantity = cartProduct.quantity; // Sepetteki miktar\n\n        if (productStockUpdates[productId]) {\n          productStockUpdates[productId] += quantity;\n        } else {\n          productStockUpdates[productId] = quantity;\n        }\n      }\n\n      // Stokları güncelle\n      for (const productId in productStockUpdates) {\n        const quantityToDecrease = productStockUpdates[productId];\n        await _products.default.updateOne({\n          _id: productId\n        }, {\n          $inc: {\n            stock: -quantityToDecrease\n          }\n        });\n      }\n      await (0, _OrderCompleteMail.default)(req, res);\n      res.json(result);\n    } catch (error) {\n      next(error);\n    }\n  });\n\n  //yeni bir ödeme oluştur ve kart kaydet\n  router.post(\"/payments/:cartId/with-new-card/register-card\", _Session.default, async (req, res) => {\n    const {\n      card\n    } = req.body;\n    if (!card) {\n      throw new _ApiError.default(\"Card is required\", 400, \"cardRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _cart.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    if (req.user?.cardUserKey) {\n      card.cardUserKey = req.user?.cardUserKey;\n    }\n    card.registerCard = \"1\"; //methodslarda registerCard:1 yani kartı kaydet\n\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    let result = await Payments.createPayment(data);\n    if (req.user?.cardUserKey) {\n      const user = await _users.default.findOne({\n        _id: req.user?._id\n      });\n      user.cardUserKey = result?.cardUserKey;\n      await user.save();\n    }\n    await (0, _payments2.CompletePayment)(result);\n    res.json(result);\n  });\n\n  /*çalışıyor*/\n  router.post(\"/payments/:cartId/:cardIndex/with-registered-card-index\", _Session.default, async (req, res, next) => {\n    //çalışıyor bu endpoint\n    let {\n      cardIndex\n    } = req.params;\n    if (!cardIndex) {\n      throw new _ApiError.default(\"Card index is required\", 400, \"cardIndexRequired\");\n    }\n    if (!req.user?.cardUserKey) {\n      throw new _ApiError.default(\"No registered card available\", 400, \"cardUserKeyRequired\");\n    }\n    const cards = await Cards.getUserCards({\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      cardUserKey: req.user?.cardUserKey\n    });\n    const index = parseInt(cardIndex);\n    if (index >= cards?.cardDetails?.length) {\n      throw new _ApiError.default(\"Card does not exist\", 400, \"cardIndexInvalid\");\n    }\n    const {\n      cardToken\n    } = cards?.cardDetails[index];\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n\n    // Cart'ı bul\n    const cart = await _cart.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\"); // Sadece buyer'ı populate ediyoruz.\n\n    if (!cart) {\n      throw new _ApiError.default(\"Cart not found\", 404, \"cartNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n\n    // Ürün bilgilerini getirme (Cart'taki productId'leri kullanarak)\n    const productIds = cart.products.map(item => item.productId);\n    const products = await _products.default.find({\n      _id: {\n        $in: productIds\n      }\n    }).populate(\"seller\");\n\n    // Ürün bilgilerini cart'a ekliyoruz\n    const enrichedProducts = cart.products.map(cartProduct => {\n      const productDetail = products.find(product => String(product._id) === String(cartProduct.productId));\n      return {\n        ...cartProduct._doc,\n        productDetail\n      };\n    });\n\n    // Ödenecek miktar hesaplama\n    const paidPrice = enrichedProducts.reduce((acc, product) => acc + product.productDetail.price * product.quantity, 0).toFixed(2);\n    const basketItems = enrichedProducts.map(cartProduct => {\n      const product = cartProduct.productDetail;\n      console.log(`Processing product: ${product.name}`);\n      console.log(`subMerchantKey: ${product.seller.subMerchantKey}`);\n      return {\n        id: String(product?._id),\n        name: product?.name,\n        category1: product?.categories?.[0] || \"Uncategorized\",\n        category2: product?.categories?.[1] || \"\",\n        itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n        price: (product?.price * cartProduct.quantity).toFixed(2),\n        // Birim fiyatı çarpıyoruz ve virgülden sonra 2 basamak tutuyoruz\n        subMerchantKey: product?.seller?.subMerchantKey,\n        subMerchantPrice: (product.price * cartProduct.quantity * 0.9).toFixed(2)\n      };\n    });\n    console.log(\"Items:\", basketItems);\n\n    // Sepetteki ürünlerin toplam fiyatını hesaplıyoruz\n    const basketTotal = basketItems.reduce((acc, item) => acc + parseFloat(item.price), 0).toFixed(2); // Fiyatları alıp float'a çeviriyoruz\n\n    // Ödeme ve sepet toplamları kontrolü\n    if (basketTotal !== paidPrice) {\n      throw new _ApiError.default(\"Gönderilen tutar tüm kırılımların toplam tutarına eşit olmalıdır\", 400, \"priceMismatch\");\n    }\n\n    // Ödeme verisi\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: basketTotal,\n      // İyzico için yuvarlanmış toplam sepet tutarı\n      paidPrice: basketTotal,\n      // Aynı değeri paidPrice'a da gönderiyoruz\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: {\n        cardToken,\n        cardUserKey: req.user?.cardUserKey\n      },\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationDate: (0, _moment.default)(req.user?.createdAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \" \" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \" \" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems // Doğru hesaplanan sepet öğelerini gönderiyoruz\n    };\n    console.log(data);\n    try {\n      let result = await Payments.createPayment(data);\n      await (0, _payments2.CompletePayment)(result);\n      const productStockUpdates = {};\n\n      // Sepetteki ürünleri döngüyle işleyerek aynı ürünlerden kaç tane olduğunu hesapla\n      for (const cartProduct of cart.products) {\n        const productId = String(cartProduct.productId); // Doğru ürün ID'si buradan alınmalı\n        const quantity = cartProduct.quantity; // Sepetteki miktar\n\n        if (productStockUpdates[productId]) {\n          productStockUpdates[productId] += quantity;\n        } else {\n          productStockUpdates[productId] = quantity;\n        }\n      }\n\n      // Stokları güncelle\n      for (const productId in productStockUpdates) {\n        const quantityToDecrease = productStockUpdates[productId];\n        await _products.default.updateOne({\n          _id: productId\n        }, {\n          $inc: {\n            stock: -quantityToDecrease\n          }\n        });\n      }\n      res.json(result);\n      next();\n    } catch (error) {\n      next(error);\n    }\n  }, _OrderCompleteMail.default, (req, res) => {\n    return res.status(200).json(`${req.user.email} mail adresine sipariş detayı gönderilmiştir.`);\n  });\n  router.post(\"/payments/:cartId/with-registered-card-token\", _Session.default, async (req, res, next) => {\n    // Get cardToken from the request body\n    let {\n      cardToken\n    } = req.body;\n\n    // Ensure cardToken is provided\n    if (!cardToken) {\n      throw new _ApiError.default(\"Card token is required\", 400, \"cardTokenRequired\");\n    }\n\n    // Ensure the user has a registered card (cardUserKey)\n    if (!req.user?.cardUserKey) {\n      throw new _ApiError.default(\"No registered card available\", 400, \"cardUserKeyRequired\");\n    }\n\n    // Ensure cartId is provided in the request params\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n\n    // Find the cart using cartId\n    const cart = await _cart.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\");\n    if (!cart) {\n      throw new _ApiError.default(\"Cart not found\", 404, \"cartNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n\n    // Fetch product details for the cart\n    const productIds = cart.products.map(item => item.productId);\n    const products = await _products.default.find({\n      _id: {\n        $in: productIds\n      }\n    }).populate(\"seller\");\n\n    // Enrich cart with product details\n    const enrichedProducts = cart.products.map(cartProduct => {\n      const productDetail = products.find(product => String(product._id) === String(cartProduct.productId));\n      return {\n        ...cartProduct._doc,\n        productDetail\n      };\n    });\n\n    // Calculate total price\n    const paidPrice = enrichedProducts.reduce((acc, product) => acc + product.productDetail.price * product.quantity, 0).toFixed(2);\n\n    // Create basket items for payment\n    const basketItems = enrichedProducts.map(cartProduct => {\n      const product = cartProduct.productDetail;\n      return {\n        id: String(product?._id),\n        name: product?.name,\n        category1: product?.categories?.[0] || \"Uncategorized\",\n        category2: product?.categories?.[1] || \"\",\n        itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n        price: (product?.price * cartProduct.quantity).toFixed(2),\n        subMerchantKey: product?.seller?.subMerchantKey,\n        subMerchantPrice: (product.price * cartProduct.quantity * 0.9).toFixed(2)\n      };\n    });\n    const basketTotal = basketItems.reduce((acc, item) => acc + parseFloat(item.price), 0).toFixed(2);\n    if (basketTotal !== paidPrice) {\n      throw new _ApiError.default(\"Gönderilen tutar tüm kırılımların toplam tutarına eşit olmalıdır\", 400, \"priceMismatch\");\n    }\n\n    // Prepare payment data\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: basketTotal,\n      paidPrice: basketTotal,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: {\n        cardToken,\n        cardUserKey: req.user?.cardUserKey\n      },\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationDate: (0, _moment.default)(req.user?.createdAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \" \" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \" \" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems\n    };\n    try {\n      // Process payment\n      let result = await Payments.createPayment(data);\n      await (0, _payments2.CompletePayment)(result);\n      const productStockUpdates = {};\n\n      // Update stock for each product\n      for (const cartProduct of cart.products) {\n        const productId = String(cartProduct.productId);\n        const quantity = cartProduct.quantity;\n        if (productStockUpdates[productId]) {\n          productStockUpdates[productId] += quantity;\n        } else {\n          productStockUpdates[productId] = quantity;\n        }\n      }\n\n      // Decrease stock based on the quantities\n      for (const productId in productStockUpdates) {\n        const quantityToDecrease = productStockUpdates[productId];\n        await _products.default.updateOne({\n          _id: productId\n        }, {\n          $inc: {\n            stock: -quantityToDecrease\n          }\n        });\n      }\n      res.json(result);\n      next();\n    } catch (error) {\n      next(error);\n    }\n  }, _OrderCompleteMail.default, (req, res) => {\n    return res.status(200).json(`${req.user.email} mail adresine sipariş detayı gönderilmiştir.`);\n  });\n\n  // router.post(\n  //   \"/payments/:cartId/with-registered-card-token\",\n  //   Session,\n  //   async (req, res) => {\n  //     let { cardToken } = req.body;\n  //     if (!cardToken) {\n  //       throw new ApiError(\"Card Token is required\", 400, \"cardTokenRequired\");\n  //     }\n  //     if (!req.user?.cardUserKey) {\n  //       throw new ApiError(\n  //         \"No registered card available\",\n  //         400,\n  //         \"cardUserKeyRequired\"\n  //       );\n  //     }\n\n  //     if (!req.params?.cartId) {\n  //       throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n  //     }\n  //     const cart = await Carts.findOne({ _id: req.params?.cartId })\n  //       .populate(\"buyer\")\n  //       .populate(\"products\");\n  //     if (!cart) {\n  //       throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n  //     }\n  //     if (cart?.completed) {\n  //       throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n  //     }\n\n  //     const paidPrice = cart.products\n  //       .map((product) => product.price)\n  //       .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n  //     const card = {\n  //       cardToken,\n  //       cardUserKey: req.user?.cardUserKey,\n  //     };\n\n  //     const data = {\n  //       locale: req.user.locale,\n  //       conversationId: id(),\n  //       price: paidPrice,\n  //       paidPrice: paidPrice,\n  //       currency: Iyzipay.CURRENCY.TRY,\n  //       installments: \"1\",\n  //       basketId: String(cart?._id),\n  //       paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n  //       paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n  //       paymentCard: card,\n  //       buyer: {\n  //         id: String(req.user._id),\n  //         name: req.user?.name,\n  //         surname: req.user?.surname,\n  //         gsmNumber: req.user?.phoneNumber,\n  //         email: req.user?.email,\n  //         identityNumber: req.user?.identityNumber,\n  //         lastLoginDate: moment(req.user?.updatedAt).format(\n  //           \"YYYY-MM-DD HH:mm:ss\"\n  //         ), //iyizpay tarih formatına çevirmek için yapıldı\n  //         registrationDate: moment(req.user?.updatedAt).format(\n  //           \"YYYY-MM-DD HH:mm:ss\"\n  //         ),\n  //         registrationAddress: req.user?.address,\n  //         ip: req.user?.ip,\n  //         city: req.user?.city,\n  //         country: req.user?.country,\n  //         zipCode: req.user?.zipCode,\n  //       },\n  //       shippingAddress: {\n  //         contactName: req.user?.name + \"\" + req.user?.surname,\n  //         city: req.user?.city,\n  //         country: req.user?.country,\n  //         address: req.user?.address,\n  //         zipCode: req.user?.zipCode,\n  //       },\n  //       billingAddress: {\n  //         contactName: req.user?.name + \"\" + req.user?.surname,\n  //         city: req.user?.city,\n  //         country: req.user?.country,\n  //         address: req.user?.address,\n  //         zipCode: req.user?.zipCode,\n  //       },\n  //       basketItems: cart.products.map((product, index) => {\n  //         return {\n  //           id: String(product?._id),\n  //           name: product?.name,\n  //           category1: product.categories[0],\n  //           category2: product.categories[1],\n  //           itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n  //           price: product?.price,\n  //         };\n  //       }),\n  //     };\n\n  //     let result = await Payments.createPayment(data);\n  //     await CompletePayment(result);\n  //     res.json(result);\n  //   }\n  // );\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaXl6aXBheSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX21vbWVudCIsIl9jYXJ0IiwiX3Byb2R1Y3RzIiwiX3VzZXJzIiwiX0FwaUVycm9yIiwiX1JlcXVpcmVkQ2hlY2siLCJfT3JkZXJDb21wbGV0ZU1haWwiLCJfU2Vzc2lvbiIsIkNhcmRzIiwiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJQYXltZW50cyIsIl9wYXltZW50czIiLCJfdXVpZCIsIl9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSIsImUiLCJXZWFrTWFwIiwiciIsInQiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImhhcyIsImdldCIsIm4iLCJfX3Byb3RvX18iLCJhIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJ1IiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiaSIsInNldCIsIl9kZWZhdWx0Iiwicm91dGVyIiwicG9zdCIsIlNlc3Npb24iLCJyZXEiLCJyZXMiLCJuZXh0IiwiY2FyZCIsImJvZHkiLCJjaGVja1JlcXVpcmVkRmllbGQiLCJwYXJhbXMiLCJjYXJ0SWQiLCJjYXJ0IiwiQ2FydHMiLCJmaW5kT25lIiwiX2lkIiwicG9wdWxhdGUiLCJBcGlFcnJvciIsImNvbXBsZXRlZCIsInJlZ2lzdGVyQ2FyZCIsInByb2R1Y3RJZHMiLCJwcm9kdWN0cyIsIm1hcCIsIml0ZW0iLCJwcm9kdWN0SWQiLCJQcm9kdWN0cyIsImZpbmQiLCIkaW4iLCJlbnJpY2hlZFByb2R1Y3RzIiwiY2FydFByb2R1Y3QiLCJwcm9kdWN0RGV0YWlsIiwicHJvZHVjdCIsIlN0cmluZyIsIl9kb2MiLCJwYWlkUHJpY2UiLCJyZWR1Y2UiLCJhY2MiLCJwcmljZSIsInF1YW50aXR5IiwidG9GaXhlZCIsImJhc2tldEl0ZW1zIiwiY29uc29sZSIsImxvZyIsIm5hbWUiLCJzZWxsZXIiLCJzdWJNZXJjaGFudEtleSIsImlkIiwiY2F0ZWdvcnkxIiwiY2F0ZWdvcmllcyIsImNhdGVnb3J5MiIsIml0ZW1UeXBlIiwiSXl6aXBheSIsIkJBU0tFVF9JVEVNX1RZUEUiLCJzdWJNZXJjaGFudFByaWNlIiwiYmFza2V0VG90YWwiLCJwYXJzZUZsb2F0IiwiZGF0YSIsImxvY2FsZSIsInVzZXIiLCJjb252ZXJzYXRpb25JZCIsImN1cnJlbmN5IiwiQ1VSUkVOQ1kiLCJUUlkiLCJpbnN0YWxsbWVudHMiLCJiYXNrZXRJZCIsInBheW1lbnRDaGFubmVsIiwiUEFZTUVOVF9DSEFOTkVMIiwiV0VCIiwicGF5bWVudEdyb3VwIiwiUEFZTUVOVF9HUk9VUCIsIlBST0RVQ1QiLCJwYXltZW50Q2FyZCIsImJ1eWVyIiwic3VybmFtZSIsImdzbU51bWJlciIsInBob25lTnVtYmVyIiwiZW1haWwiLCJpZGVudGl0eU51bWJlciIsImxhc3RMb2dpbkRhdGUiLCJtb21lbnQiLCJ1cGRhdGVkQXQiLCJmb3JtYXQiLCJyZWdpc3RyYXRpb25EYXRlIiwicmVnaXN0cmF0aW9uQWRkcmVzcyIsImFkZHJlc3MiLCJpcCIsImNpdHkiLCJjb3VudHJ5IiwiemlwQ29kZSIsInNoaXBwaW5nQWRkcmVzcyIsImNvbnRhY3ROYW1lIiwiYmlsbGluZ0FkZHJlc3MiLCJyZXN1bHQiLCJjcmVhdGVQYXltZW50IiwiQ29tcGxldGVQYXltZW50IiwicHJvZHVjdFN0b2NrVXBkYXRlcyIsInF1YW50aXR5VG9EZWNyZWFzZSIsInVwZGF0ZU9uZSIsIiRpbmMiLCJzdG9jayIsIk9yZGVyQ29tcGxldGVNYWlsIiwianNvbiIsImVycm9yIiwiY2FyZFVzZXJLZXkiLCJiIiwiaW5kZXgiLCJVc2VycyIsInNhdmUiLCJjYXJkSW5kZXgiLCJjYXJkcyIsImdldFVzZXJDYXJkcyIsInBhcnNlSW50IiwiY2FyZERldGFpbHMiLCJsZW5ndGgiLCJjYXJkVG9rZW4iLCJjcmVhdGVkQXQiLCJzdGF0dXMiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvcm91dGVzLyIsInNvdXJjZXMiOlsicGF5bWVudHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEl5emlwYXkgZnJvbSBcIml5emlwYXlcIjtcbmltcG9ydCBtb21lbnQgZnJvbSBcIm1vbWVudFwiO1xuaW1wb3J0IENhcnRzIGZyb20gXCIuLi9kYi9jYXJ0XCI7XG5pbXBvcnQgUHJvZHVjdHMgZnJvbSBcIi4uL2RiL3Byb2R1Y3RzXCI7XG5pbXBvcnQgVXNlcnMgZnJvbSBcIi4uL2RiL3VzZXJzXCI7XG5pbXBvcnQgQXBpRXJyb3IgZnJvbSBcIi4uL2Vycm9ycy9BcGlFcnJvclwiO1xuaW1wb3J0IHsgY2hlY2tSZXF1aXJlZEZpZWxkIH0gZnJvbSBcIi4uL2hlbHBlcnMvUmVxdWlyZWRDaGVja1wiO1xuaW1wb3J0IE9yZGVyQ29tcGxldGVNYWlsIGZyb20gXCIuLi9taWRkbGV3YXJlcy9PcmRlckNvbXBsZXRlTWFpbFwiO1xuaW1wb3J0IFNlc3Npb24gZnJvbSBcIi4uL21pZGRsZXdhcmVzL1Nlc3Npb25cIjtcbmltcG9ydCAqIGFzIENhcmRzIGZyb20gXCIuLi9zZXJ2aWNlcy9peXppY28vbWV0aG9kcy9jYXJkc1wiO1xuaW1wb3J0ICogYXMgUGF5bWVudHMgZnJvbSBcIi4uL3NlcnZpY2VzL2l5emljby9tZXRob2RzL3BheW1lbnRzXCI7XG5pbXBvcnQgeyBDb21wbGV0ZVBheW1lbnQgfSBmcm9tIFwiLi4vdXRpbHMvcGF5bWVudHNcIjtcbmltcG9ydCBpZCBmcm9tIFwiLi4vdXRpbHMvdXVpZFwiO1xuXG5leHBvcnQgZGVmYXVsdCAocm91dGVyKSA9PiB7XG4gIC8qw6dhbMSxxZ/EsXlvciovIHJvdXRlci5wb3N0KFxuICAgIFwiL3BheW1lbnRzLzpjYXJ0SWQvd2l0aC1uZXctY2FyZFwiLFxuICAgIFNlc3Npb24sXG4gICAgYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgICBjb25zdCB7IGNhcmQgfSA9IHJlcS5ib2R5O1xuICAgICAgLy8gaWYgKCFjYXJkKSB7XG4gICAgICAvLyAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgaXMgcmVxdWlyZWRcIiwgNDAwLCBcImNhcmRSZXF1aXJlZFwiKTtcbiAgICAgIC8vIH1cbiAgICAgIGNoZWNrUmVxdWlyZWRGaWVsZChjYXJkLCBcIkNhcmRcIik7XG4gICAgICBjaGVja1JlcXVpcmVkRmllbGQocmVxLnBhcmFtcz8uY2FydElkLCBcIkNhcnRJZFwiKTtcbiAgICAgIC8vIGlmICghcmVxLnBhcmFtcz8uY2FydElkKSB7XG4gICAgICAvLyAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnRJRCBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FydElkUmVxdWlyZWRcIik7XG4gICAgICAvLyB9XG4gICAgICBjb25zdCBjYXJ0ID0gYXdhaXQgQ2FydHMuZmluZE9uZSh7IF9pZDogcmVxLnBhcmFtcz8uY2FydElkIH0pXG4gICAgICAgIC5wb3B1bGF0ZShcImJ1eWVyXCIpXG4gICAgICAgIC5wb3B1bGF0ZShcInByb2R1Y3RzXCIpO1xuICAgICAgaWYgKCFjYXJ0KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgbm90IGZvdW5kXCIsIDQwNCwgXCJjYXJkTm90Rm91bmRcIik7XG4gICAgICB9XG4gICAgICBpZiAoY2FydD8uY29tcGxldGVkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgaXMgY29tcGxldGVkXCIsIDQwMCwgXCJjYXJ0Q29tcGxldGVkXCIpO1xuICAgICAgfVxuXG4gICAgICBjYXJkLnJlZ2lzdGVyQ2FyZCA9IFwiMFwiOyAvL21ldGhvZHNsYXJkYSByZWdpc3RlckNhcmQ6MSB5YW5pIGthcnTEsSBrYXlkZXQgZGVtZWsgYW1hIMWfdWFuIGtheWRldG1lIGRlZGnEn2ltIGnDp2luIDAgeWFwdMSxbVxuXG4gICAgICAvLyDDnHLDvG4gYmlsZ2lsZXJpbmkgZ2V0aXJtZSAoQ2FydCd0YWtpIHByb2R1Y3RJZCdsZXJpIGt1bGxhbmFyYWspXG4gICAgICBjb25zdCBwcm9kdWN0SWRzID0gY2FydC5wcm9kdWN0cy5tYXAoKGl0ZW0pID0+IGl0ZW0ucHJvZHVjdElkKTtcbiAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgUHJvZHVjdHMuZmluZCh7XG4gICAgICAgIF9pZDogeyAkaW46IHByb2R1Y3RJZHMgfSxcbiAgICAgIH0pLnBvcHVsYXRlKFwic2VsbGVyXCIpO1xuXG4gICAgICAvLyDDnHLDvG4gYmlsZ2lsZXJpbmkgY2FydCdhIGVrbGl5b3J1elxuICAgICAgY29uc3QgZW5yaWNoZWRQcm9kdWN0cyA9IGNhcnQucHJvZHVjdHMubWFwKChjYXJ0UHJvZHVjdCkgPT4ge1xuICAgICAgICBjb25zdCBwcm9kdWN0RGV0YWlsID0gcHJvZHVjdHMuZmluZChcbiAgICAgICAgICAocHJvZHVjdCkgPT4gU3RyaW5nKHByb2R1Y3QuX2lkKSA9PT0gU3RyaW5nKGNhcnRQcm9kdWN0LnByb2R1Y3RJZClcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAuLi5jYXJ0UHJvZHVjdC5fZG9jLFxuICAgICAgICAgIHByb2R1Y3REZXRhaWwsXG4gICAgICAgIH07XG4gICAgICB9KTtcblxuICAgICAgLy8gw5ZkZW5lY2VrIG1pa3RhciBoZXNhcGxhbWFcbiAgICAgIC8vIGNvbnN0IHBhaWRQcmljZSA9IGVucmljaGVkUHJvZHVjdHNcbiAgICAgIC8vICAgLm1hcCgocHJvZHVjdCkgPT4gcHJvZHVjdC5wcm9kdWN0RGV0YWlsLnByaWNlICogcHJvZHVjdC5xdWFudGl0eSlcbiAgICAgIC8vICAgLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApO1xuXG4gICAgICBjb25zdCBwYWlkUHJpY2UgPSBlbnJpY2hlZFByb2R1Y3RzXG4gICAgICAgIC5yZWR1Y2UoXG4gICAgICAgICAgKGFjYywgcHJvZHVjdCkgPT5cbiAgICAgICAgICAgIGFjYyArIHByb2R1Y3QucHJvZHVjdERldGFpbC5wcmljZSAqIHByb2R1Y3QucXVhbnRpdHksXG4gICAgICAgICAgMFxuICAgICAgICApXG4gICAgICAgIC50b0ZpeGVkKDIpO1xuXG4gICAgICBjb25zdCBiYXNrZXRJdGVtcyA9IGVucmljaGVkUHJvZHVjdHMubWFwKChjYXJ0UHJvZHVjdCkgPT4ge1xuICAgICAgICBjb25zdCBwcm9kdWN0ID0gY2FydFByb2R1Y3QucHJvZHVjdERldGFpbDtcbiAgICAgICAgLy8gTG9nIHN1Yk1lcmNoYW50S2V5IHRvIGVuc3VyZSBpdCdzIHByZXNlbnRcbiAgICAgICAgY29uc29sZS5sb2coYFByb2Nlc3NpbmcgcHJvZHVjdDogJHtwcm9kdWN0Lm5hbWV9YCk7XG4gICAgICAgIGNvbnNvbGUubG9nKGBzdWJNZXJjaGFudEtleTogJHtwcm9kdWN0LnNlbGxlci5zdWJNZXJjaGFudEtleX1gKTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGlkOiBTdHJpbmcocHJvZHVjdD8uX2lkKSxcbiAgICAgICAgICBuYW1lOiBwcm9kdWN0Py5uYW1lLFxuICAgICAgICAgIGNhdGVnb3J5MTogcHJvZHVjdD8uY2F0ZWdvcmllcz8uWzBdIHx8IFwiVW5jYXRlZ29yaXplZFwiLFxuICAgICAgICAgIGNhdGVnb3J5MjogcHJvZHVjdD8uY2F0ZWdvcmllcz8uWzFdIHx8IFwiXCIsXG4gICAgICAgICAgaXRlbVR5cGU6IEl5emlwYXkuQkFTS0VUX0lURU1fVFlQRVtwcm9kdWN0Py5pdGVtVHlwZV0sXG4gICAgICAgICAgcHJpY2U6IChwcm9kdWN0Py5wcmljZSAqIGNhcnRQcm9kdWN0LnF1YW50aXR5KS50b0ZpeGVkKDIpLCAvLyBCaXJpbSBmaXlhdMSxIMOnYXJwxLF5b3J1eiB2ZSB2aXJnw7xsZGVuIHNvbnJhIDIgYmFzYW1hayB0dXR1eW9ydXpcbiAgICAgICAgICBzdWJNZXJjaGFudEtleTogcHJvZHVjdD8uc2VsbGVyPy5zdWJNZXJjaGFudEtleSxcbiAgICAgICAgICBzdWJNZXJjaGFudFByaWNlOiAoXG4gICAgICAgICAgICBwcm9kdWN0LnByaWNlICpcbiAgICAgICAgICAgIGNhcnRQcm9kdWN0LnF1YW50aXR5ICpcbiAgICAgICAgICAgIDAuOVxuICAgICAgICAgICkudG9GaXhlZCgyKSxcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgICAgY29uc29sZS5sb2coXCJGaW5hbCBiYXNrZXRJdGVtcyBhcnJheTpcIiwgYmFza2V0SXRlbXMpO1xuXG4gICAgICAvLyBTZXBldHRla2kgw7xyw7xubGVyaW4gdG9wbGFtIGZpeWF0xLFuxLEgaGVzYXBsxLF5b3J1elxuICAgICAgY29uc3QgYmFza2V0VG90YWwgPSBiYXNrZXRJdGVtc1xuICAgICAgICAucmVkdWNlKChhY2MsIGl0ZW0pID0+IGFjYyArIHBhcnNlRmxvYXQoaXRlbS5wcmljZSksIDApXG4gICAgICAgIC50b0ZpeGVkKDIpOyAvLyBGaXlhdGxhcsSxIGFsxLFwIGZsb2F0J2Egw6dldmlyaXlvcnV6XG5cbiAgICAgIC8vIMOWZGVtZSB2ZSBzZXBldCB0b3BsYW1sYXLEsSBrb250cm9sw7xcbiAgICAgIGlmIChiYXNrZXRUb3RhbCAhPT0gcGFpZFByaWNlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGJhc2tldFRvdGFsKTtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIFwiR8O2bmRlcmlsZW4gdHV0YXIgdMO8bSBrxLFyxLFsxLFtbGFyxLFuIHRvcGxhbSB0dXRhcsSxbmEgZcWfaXQgb2xtYWzEsWTEsXJcIixcbiAgICAgICAgICA0MDAsXG4gICAgICAgICAgXCJwcmljZU1pc21hdGNoXCJcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZGF0YSA9IHtcbiAgICAgICAgbG9jYWxlOiByZXEudXNlci5sb2NhbGUsXG4gICAgICAgIGNvbnZlcnNhdGlvbklkOiBpZCgpLFxuICAgICAgICBwcmljZTogYmFza2V0VG90YWwsIC8vdG9GaXhlZCgyKSB2YXJkxLFcbiAgICAgICAgcGFpZFByaWNlOiBiYXNrZXRUb3RhbCxcbiAgICAgICAgY3VycmVuY3k6IEl5emlwYXkuQ1VSUkVOQ1kuVFJZLFxuICAgICAgICBpbnN0YWxsbWVudHM6IFwiMVwiLFxuICAgICAgICBiYXNrZXRJZDogU3RyaW5nKGNhcnQ/Ll9pZCksXG4gICAgICAgIHBheW1lbnRDaGFubmVsOiBJeXppcGF5LlBBWU1FTlRfQ0hBTk5FTC5XRUIsXG4gICAgICAgIHBheW1lbnRHcm91cDogSXl6aXBheS5QQVlNRU5UX0dST1VQLlBST0RVQ1QsXG4gICAgICAgIHBheW1lbnRDYXJkOiBjYXJkLFxuICAgICAgICBidXllcjoge1xuICAgICAgICAgIGlkOiBTdHJpbmcocmVxLnVzZXIuX2lkKSxcbiAgICAgICAgICBuYW1lOiByZXEudXNlcj8ubmFtZSxcbiAgICAgICAgICBzdXJuYW1lOiByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBnc21OdW1iZXI6IHJlcS51c2VyPy5waG9uZU51bWJlcixcbiAgICAgICAgICBlbWFpbDogcmVxLnVzZXI/LmVtYWlsLFxuICAgICAgICAgIGlkZW50aXR5TnVtYmVyOiByZXEudXNlcj8uaWRlbnRpdHlOdW1iZXIsXG4gICAgICAgICAgbGFzdExvZ2luRGF0ZTogbW9tZW50KHJlcS51c2VyPy51cGRhdGVkQXQpLmZvcm1hdChcbiAgICAgICAgICAgIFwiWVlZWS1NTS1ERCBISDptbTpzc1wiXG4gICAgICAgICAgKSwgLy9peWl6cGF5IHRhcmloIGZvcm1hdMSxbmEgw6dldmlybWVrIGnDp2luIHlhcMSxbGTEsVxuICAgICAgICAgIHJlZ2lzdHJhdGlvbkRhdGU6IG1vbWVudChyZXEudXNlcj8udXBkYXRlZEF0KS5mb3JtYXQoXG4gICAgICAgICAgICBcIllZWVktTU0tREQgSEg6bW06c3NcIlxuICAgICAgICAgICksXG4gICAgICAgICAgcmVnaXN0cmF0aW9uQWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgaXA6IHJlcS51c2VyPy5pcCxcbiAgICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgICAgfSxcbiAgICAgICAgc2hpcHBpbmdBZGRyZXNzOiB7XG4gICAgICAgICAgY29udGFjdE5hbWU6IHJlcS51c2VyPy5uYW1lICsgXCJcIiArIHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIGFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBiaWxsaW5nQWRkcmVzczoge1xuICAgICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiXCIgKyByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgICBhZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgICAgfSxcbiAgICAgICAgYmFza2V0SXRlbXMsXG4gICAgICB9O1xuXG4gICAgICB0cnkge1xuICAgICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgUGF5bWVudHMuY3JlYXRlUGF5bWVudChkYXRhKTtcbiAgICAgICAgYXdhaXQgQ29tcGxldGVQYXltZW50KHJlc3VsdCk7XG5cbiAgICAgICAgLy8gw5xyw7xuIHN0b2tsYXLEsW7EsSBnw7xuY2VsbGVtZVxuICAgICAgICBjb25zdCBwcm9kdWN0U3RvY2tVcGRhdGVzID0ge307XG5cbiAgICAgICAgLy8gU2VwZXR0ZWtpIMO8csO8bmxlcmkgZMO2bmfDvHlsZSBpxZ9sZXllcmVrIGF5bsSxIMO8csO8bmxlcmRlbiBrYcOnIHRhbmUgb2xkdcSfdW51IGhlc2FwbGFcbiAgICAgICAgZm9yIChjb25zdCBjYXJ0UHJvZHVjdCBvZiBjYXJ0LnByb2R1Y3RzKSB7XG4gICAgICAgICAgY29uc3QgcHJvZHVjdElkID0gU3RyaW5nKGNhcnRQcm9kdWN0LnByb2R1Y3RJZCk7IC8vIERvxJ9ydSDDvHLDvG4gSUQnc2kgYnVyYWRhbiBhbMSxbm1hbMSxXG4gICAgICAgICAgY29uc3QgcXVhbnRpdHkgPSBjYXJ0UHJvZHVjdC5xdWFudGl0eTsgLy8gU2VwZXR0ZWtpIG1pa3RhclxuXG4gICAgICAgICAgaWYgKHByb2R1Y3RTdG9ja1VwZGF0ZXNbcHJvZHVjdElkXSkge1xuICAgICAgICAgICAgcHJvZHVjdFN0b2NrVXBkYXRlc1twcm9kdWN0SWRdICs9IHF1YW50aXR5O1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwcm9kdWN0U3RvY2tVcGRhdGVzW3Byb2R1Y3RJZF0gPSBxdWFudGl0eTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTdG9rbGFyxLEgZ8O8bmNlbGxlXG4gICAgICAgIGZvciAoY29uc3QgcHJvZHVjdElkIGluIHByb2R1Y3RTdG9ja1VwZGF0ZXMpIHtcbiAgICAgICAgICBjb25zdCBxdWFudGl0eVRvRGVjcmVhc2UgPSBwcm9kdWN0U3RvY2tVcGRhdGVzW3Byb2R1Y3RJZF07XG4gICAgICAgICAgYXdhaXQgUHJvZHVjdHMudXBkYXRlT25lKFxuICAgICAgICAgICAgeyBfaWQ6IHByb2R1Y3RJZCB9LFxuICAgICAgICAgICAgeyAkaW5jOiB7IHN0b2NrOiAtcXVhbnRpdHlUb0RlY3JlYXNlIH0gfVxuICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICBhd2FpdCBPcmRlckNvbXBsZXRlTWFpbChyZXEsIHJlcyk7XG4gICAgICAgIHJlcy5qc29uKHJlc3VsdCk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBuZXh0KGVycm9yKTtcbiAgICAgIH1cbiAgICB9XG4gICk7XG5cbiAgLy95ZW5pIGJpciDDtmRlbWUgb2x1xZ90dXIgdmUga2FydCBrYXlkZXRcbiAgcm91dGVyLnBvc3QoXG4gICAgXCIvcGF5bWVudHMvOmNhcnRJZC93aXRoLW5ldy1jYXJkL3JlZ2lzdGVyLWNhcmRcIixcbiAgICBTZXNzaW9uLFxuICAgIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgICAgY29uc3QgeyBjYXJkIH0gPSByZXEuYm9keTtcbiAgICAgIGlmICghY2FyZCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIGlzIHJlcXVpcmVkXCIsIDQwMCwgXCJjYXJkUmVxdWlyZWRcIik7XG4gICAgICB9XG4gICAgICBpZiAoIXJlcS5wYXJhbXM/LmNhcnRJZCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJ0SUQgaXMgcmVxdWlyZWRcIiwgNDAwLCBcImNhcnRJZFJlcXVpcmVkXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgY2FydCA9IGF3YWl0IENhcnRzLmZpbmRPbmUoeyBfaWQ6IHJlcS5wYXJhbXM/LmNhcnRJZCB9KVxuICAgICAgICAucG9wdWxhdGUoXCJidXllclwiKVxuICAgICAgICAucG9wdWxhdGUoXCJwcm9kdWN0c1wiKTtcbiAgICAgIGlmICghY2FydCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIG5vdCBmb3VuZFwiLCA0MDQsIFwiY2FyZE5vdEZvdW5kXCIpO1xuICAgICAgfVxuICAgICAgaWYgKGNhcnQ/LmNvbXBsZXRlZCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJ0IGlzIGNvbXBsZXRlZFwiLCA0MDAsIFwiY2FydENvbXBsZXRlZFwiKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHJlcS51c2VyPy5jYXJkVXNlcktleSkge1xuICAgICAgICBjYXJkLmNhcmRVc2VyS2V5ID0gcmVxLnVzZXI/LmNhcmRVc2VyS2V5O1xuICAgICAgfVxuICAgICAgY2FyZC5yZWdpc3RlckNhcmQgPSBcIjFcIjsgLy9tZXRob2RzbGFyZGEgcmVnaXN0ZXJDYXJkOjEgeWFuaSBrYXJ0xLEga2F5ZGV0XG5cbiAgICAgIGNvbnN0IHBhaWRQcmljZSA9IGNhcnQucHJvZHVjdHNcbiAgICAgICAgLm1hcCgocHJvZHVjdCkgPT4gcHJvZHVjdC5wcmljZSlcbiAgICAgICAgLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApOyAvL8O2ZGVuZWNlayBtaWt0YXJsYXLEsW4gdG9wbGFtxLFcblxuICAgICAgY29uc3QgZGF0YSA9IHtcbiAgICAgICAgbG9jYWxlOiByZXEudXNlci5sb2NhbGUsXG4gICAgICAgIGNvbnZlcnNhdGlvbklkOiBpZCgpLFxuICAgICAgICBwcmljZTogcGFpZFByaWNlLFxuICAgICAgICBwYWlkUHJpY2U6IHBhaWRQcmljZSxcbiAgICAgICAgY3VycmVuY3k6IEl5emlwYXkuQ1VSUkVOQ1kuVFJZLFxuICAgICAgICBpbnN0YWxsbWVudHM6IFwiMVwiLFxuICAgICAgICBiYXNrZXRJZDogU3RyaW5nKGNhcnQ/Ll9pZCksXG4gICAgICAgIHBheW1lbnRDaGFubmVsOiBJeXppcGF5LlBBWU1FTlRfQ0hBTk5FTC5XRUIsXG4gICAgICAgIHBheW1lbnRHcm91cDogSXl6aXBheS5QQVlNRU5UX0dST1VQLlBST0RVQ1QsXG4gICAgICAgIHBheW1lbnRDYXJkOiBjYXJkLFxuICAgICAgICBidXllcjoge1xuICAgICAgICAgIGlkOiBTdHJpbmcocmVxLnVzZXIuX2lkKSxcbiAgICAgICAgICBuYW1lOiByZXEudXNlcj8ubmFtZSxcbiAgICAgICAgICBzdXJuYW1lOiByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBnc21OdW1iZXI6IHJlcS51c2VyPy5waG9uZU51bWJlcixcbiAgICAgICAgICBlbWFpbDogcmVxLnVzZXI/LmVtYWlsLFxuICAgICAgICAgIGlkZW50aXR5TnVtYmVyOiByZXEudXNlcj8uaWRlbnRpdHlOdW1iZXIsXG4gICAgICAgICAgbGFzdExvZ2luRGF0ZTogbW9tZW50KHJlcS51c2VyPy51cGRhdGVkQXQpLmZvcm1hdChcbiAgICAgICAgICAgIFwiWVlZWS1NTS1ERCBISDptbTpzc1wiXG4gICAgICAgICAgKSwgLy9peWl6cGF5IHRhcmloIGZvcm1hdMSxbmEgw6dldmlybWVrIGnDp2luIHlhcMSxbGTEsVxuICAgICAgICAgIHJlZ2lzdHJhdGlvbkRhdGU6IG1vbWVudChyZXEudXNlcj8udXBkYXRlZEF0KS5mb3JtYXQoXG4gICAgICAgICAgICBcIllZWVktTU0tREQgSEg6bW06c3NcIlxuICAgICAgICAgICksXG4gICAgICAgICAgcmVnaXN0cmF0aW9uQWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgaXA6IHJlcS51c2VyPy5pcCxcbiAgICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgICAgfSxcbiAgICAgICAgc2hpcHBpbmdBZGRyZXNzOiB7XG4gICAgICAgICAgY29udGFjdE5hbWU6IHJlcS51c2VyPy5uYW1lICsgXCJcIiArIHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIGFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBiaWxsaW5nQWRkcmVzczoge1xuICAgICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiXCIgKyByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgICBhZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgICAgfSxcbiAgICAgICAgYmFza2V0SXRlbXM6IGNhcnQucHJvZHVjdHMubWFwKChwcm9kdWN0LCBpbmRleCkgPT4ge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpZDogU3RyaW5nKHByb2R1Y3Q/Ll9pZCksXG4gICAgICAgICAgICBuYW1lOiBwcm9kdWN0Py5uYW1lLFxuICAgICAgICAgICAgY2F0ZWdvcnkxOiBwcm9kdWN0LmNhdGVnb3JpZXNbMF0sXG4gICAgICAgICAgICBjYXRlZ29yeTI6IHByb2R1Y3QuY2F0ZWdvcmllc1sxXSxcbiAgICAgICAgICAgIGl0ZW1UeXBlOiBJeXppcGF5LkJBU0tFVF9JVEVNX1RZUEVbcHJvZHVjdD8uaXRlbVR5cGVdLFxuICAgICAgICAgICAgcHJpY2U6IHByb2R1Y3Q/LnByaWNlLFxuICAgICAgICAgIH07XG4gICAgICAgIH0pLFxuICAgICAgfTtcblxuICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IFBheW1lbnRzLmNyZWF0ZVBheW1lbnQoZGF0YSk7XG4gICAgICBpZiAocmVxLnVzZXI/LmNhcmRVc2VyS2V5KSB7XG4gICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2Vycy5maW5kT25lKHsgX2lkOiByZXEudXNlcj8uX2lkIH0pO1xuICAgICAgICB1c2VyLmNhcmRVc2VyS2V5ID0gcmVzdWx0Py5jYXJkVXNlcktleTtcbiAgICAgICAgYXdhaXQgdXNlci5zYXZlKCk7XG4gICAgICB9XG4gICAgICBhd2FpdCBDb21wbGV0ZVBheW1lbnQocmVzdWx0KTtcbiAgICAgIHJlcy5qc29uKHJlc3VsdCk7XG4gICAgfVxuICApO1xuXG4gIC8qw6dhbMSxxZ/EsXlvciovIHJvdXRlci5wb3N0KFxuICAgIFwiL3BheW1lbnRzLzpjYXJ0SWQvOmNhcmRJbmRleC93aXRoLXJlZ2lzdGVyZWQtY2FyZC1pbmRleFwiLFxuICAgIFNlc3Npb24sXG4gICAgYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgICAvL8OnYWzEscWfxLF5b3IgYnUgZW5kcG9pbnRcbiAgICAgIGxldCB7IGNhcmRJbmRleCB9ID0gcmVxLnBhcmFtcztcbiAgICAgIGlmICghY2FyZEluZGV4KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgaW5kZXggaXMgcmVxdWlyZWRcIiwgNDAwLCBcImNhcmRJbmRleFJlcXVpcmVkXCIpO1xuICAgICAgfVxuICAgICAgaWYgKCFyZXEudXNlcj8uY2FyZFVzZXJLZXkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIFwiTm8gcmVnaXN0ZXJlZCBjYXJkIGF2YWlsYWJsZVwiLFxuICAgICAgICAgIDQwMCxcbiAgICAgICAgICBcImNhcmRVc2VyS2V5UmVxdWlyZWRcIlxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBjYXJkcyA9IGF3YWl0IENhcmRzLmdldFVzZXJDYXJkcyh7XG4gICAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgICBjb252ZXJzYXRpb25JZDogaWQoKSxcbiAgICAgICAgY2FyZFVzZXJLZXk6IHJlcS51c2VyPy5jYXJkVXNlcktleSxcbiAgICAgIH0pO1xuICAgICAgY29uc3QgaW5kZXggPSBwYXJzZUludChjYXJkSW5kZXgpO1xuICAgICAgaWYgKGluZGV4ID49IGNhcmRzPy5jYXJkRGV0YWlscz8ubGVuZ3RoKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgZG9lcyBub3QgZXhpc3RcIiwgNDAwLCBcImNhcmRJbmRleEludmFsaWRcIik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGNhcmRUb2tlbiB9ID0gY2FyZHM/LmNhcmREZXRhaWxzW2luZGV4XTtcbiAgICAgIGlmICghcmVxLnBhcmFtcz8uY2FydElkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnRJRCBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FydElkUmVxdWlyZWRcIik7XG4gICAgICB9XG5cbiAgICAgIC8vIENhcnQnxLEgYnVsXG4gICAgICBjb25zdCBjYXJ0ID0gYXdhaXQgQ2FydHMuZmluZE9uZSh7IF9pZDogcmVxLnBhcmFtcz8uY2FydElkIH0pLnBvcHVsYXRlKFxuICAgICAgICBcImJ1eWVyXCJcbiAgICAgICk7IC8vIFNhZGVjZSBidXllcifEsSBwb3B1bGF0ZSBlZGl5b3J1ei5cblxuICAgICAgaWYgKCFjYXJ0KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgbm90IGZvdW5kXCIsIDQwNCwgXCJjYXJ0Tm90Rm91bmRcIik7XG4gICAgICB9XG4gICAgICBpZiAoY2FydD8uY29tcGxldGVkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgaXMgY29tcGxldGVkXCIsIDQwMCwgXCJjYXJ0Q29tcGxldGVkXCIpO1xuICAgICAgfVxuXG4gICAgICAvLyDDnHLDvG4gYmlsZ2lsZXJpbmkgZ2V0aXJtZSAoQ2FydCd0YWtpIHByb2R1Y3RJZCdsZXJpIGt1bGxhbmFyYWspXG4gICAgICBjb25zdCBwcm9kdWN0SWRzID0gY2FydC5wcm9kdWN0cy5tYXAoKGl0ZW0pID0+IGl0ZW0ucHJvZHVjdElkKTtcbiAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgUHJvZHVjdHMuZmluZCh7XG4gICAgICAgIF9pZDogeyAkaW46IHByb2R1Y3RJZHMgfSxcbiAgICAgIH0pLnBvcHVsYXRlKFwic2VsbGVyXCIpO1xuXG4gICAgICAvLyDDnHLDvG4gYmlsZ2lsZXJpbmkgY2FydCdhIGVrbGl5b3J1elxuICAgICAgY29uc3QgZW5yaWNoZWRQcm9kdWN0cyA9IGNhcnQucHJvZHVjdHMubWFwKChjYXJ0UHJvZHVjdCkgPT4ge1xuICAgICAgICBjb25zdCBwcm9kdWN0RGV0YWlsID0gcHJvZHVjdHMuZmluZChcbiAgICAgICAgICAocHJvZHVjdCkgPT4gU3RyaW5nKHByb2R1Y3QuX2lkKSA9PT0gU3RyaW5nKGNhcnRQcm9kdWN0LnByb2R1Y3RJZClcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAuLi5jYXJ0UHJvZHVjdC5fZG9jLFxuICAgICAgICAgIHByb2R1Y3REZXRhaWwsXG4gICAgICAgIH07XG4gICAgICB9KTtcblxuICAgICAgLy8gw5ZkZW5lY2VrIG1pa3RhciBoZXNhcGxhbWFcbiAgICAgIGNvbnN0IHBhaWRQcmljZSA9IGVucmljaGVkUHJvZHVjdHNcbiAgICAgICAgLnJlZHVjZShcbiAgICAgICAgICAoYWNjLCBwcm9kdWN0KSA9PlxuICAgICAgICAgICAgYWNjICsgcHJvZHVjdC5wcm9kdWN0RGV0YWlsLnByaWNlICogcHJvZHVjdC5xdWFudGl0eSxcbiAgICAgICAgICAwXG4gICAgICAgIClcbiAgICAgICAgLnRvRml4ZWQoMik7XG5cbiAgICAgIGNvbnN0IGJhc2tldEl0ZW1zID0gZW5yaWNoZWRQcm9kdWN0cy5tYXAoKGNhcnRQcm9kdWN0KSA9PiB7XG4gICAgICAgIGNvbnN0IHByb2R1Y3QgPSBjYXJ0UHJvZHVjdC5wcm9kdWN0RGV0YWlsO1xuICAgICAgICBjb25zb2xlLmxvZyhgUHJvY2Vzc2luZyBwcm9kdWN0OiAke3Byb2R1Y3QubmFtZX1gKTtcbiAgICAgICAgY29uc29sZS5sb2coYHN1Yk1lcmNoYW50S2V5OiAke3Byb2R1Y3Quc2VsbGVyLnN1Yk1lcmNoYW50S2V5fWApO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGlkOiBTdHJpbmcocHJvZHVjdD8uX2lkKSxcbiAgICAgICAgICBuYW1lOiBwcm9kdWN0Py5uYW1lLFxuICAgICAgICAgIGNhdGVnb3J5MTogcHJvZHVjdD8uY2F0ZWdvcmllcz8uWzBdIHx8IFwiVW5jYXRlZ29yaXplZFwiLFxuICAgICAgICAgIGNhdGVnb3J5MjogcHJvZHVjdD8uY2F0ZWdvcmllcz8uWzFdIHx8IFwiXCIsXG4gICAgICAgICAgaXRlbVR5cGU6IEl5emlwYXkuQkFTS0VUX0lURU1fVFlQRVtwcm9kdWN0Py5pdGVtVHlwZV0sXG4gICAgICAgICAgcHJpY2U6IChwcm9kdWN0Py5wcmljZSAqIGNhcnRQcm9kdWN0LnF1YW50aXR5KS50b0ZpeGVkKDIpLCAvLyBCaXJpbSBmaXlhdMSxIMOnYXJwxLF5b3J1eiB2ZSB2aXJnw7xsZGVuIHNvbnJhIDIgYmFzYW1hayB0dXR1eW9ydXpcbiAgICAgICAgICBzdWJNZXJjaGFudEtleTogcHJvZHVjdD8uc2VsbGVyPy5zdWJNZXJjaGFudEtleSxcbiAgICAgICAgICBzdWJNZXJjaGFudFByaWNlOiAoXG4gICAgICAgICAgICBwcm9kdWN0LnByaWNlICpcbiAgICAgICAgICAgIGNhcnRQcm9kdWN0LnF1YW50aXR5ICpcbiAgICAgICAgICAgIDAuOVxuICAgICAgICAgICkudG9GaXhlZCgyKSxcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgICAgY29uc29sZS5sb2coXCJJdGVtczpcIiwgYmFza2V0SXRlbXMpO1xuXG4gICAgICAvLyBTZXBldHRla2kgw7xyw7xubGVyaW4gdG9wbGFtIGZpeWF0xLFuxLEgaGVzYXBsxLF5b3J1elxuICAgICAgY29uc3QgYmFza2V0VG90YWwgPSBiYXNrZXRJdGVtc1xuICAgICAgICAucmVkdWNlKChhY2MsIGl0ZW0pID0+IGFjYyArIHBhcnNlRmxvYXQoaXRlbS5wcmljZSksIDApXG4gICAgICAgIC50b0ZpeGVkKDIpOyAvLyBGaXlhdGxhcsSxIGFsxLFwIGZsb2F0J2Egw6dldmlyaXlvcnV6XG5cbiAgICAgIC8vIMOWZGVtZSB2ZSBzZXBldCB0b3BsYW1sYXLEsSBrb250cm9sw7xcbiAgICAgIGlmIChiYXNrZXRUb3RhbCAhPT0gcGFpZFByaWNlKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgICBcIkfDtm5kZXJpbGVuIHR1dGFyIHTDvG0ga8SxcsSxbMSxbWxhcsSxbiB0b3BsYW0gdHV0YXLEsW5hIGXFn2l0IG9sbWFsxLFkxLFyXCIsXG4gICAgICAgICAgNDAwLFxuICAgICAgICAgIFwicHJpY2VNaXNtYXRjaFwiXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIC8vIMOWZGVtZSB2ZXJpc2lcbiAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgICBjb252ZXJzYXRpb25JZDogaWQoKSxcbiAgICAgICAgcHJpY2U6IGJhc2tldFRvdGFsLCAvLyDEsHl6aWNvIGnDp2luIHl1dmFybGFubcSxxZ8gdG9wbGFtIHNlcGV0IHR1dGFyxLFcbiAgICAgICAgcGFpZFByaWNlOiBiYXNrZXRUb3RhbCwgLy8gQXluxLEgZGXEn2VyaSBwYWlkUHJpY2UnYSBkYSBnw7ZuZGVyaXlvcnV6XG4gICAgICAgIGN1cnJlbmN5OiBJeXppcGF5LkNVUlJFTkNZLlRSWSxcbiAgICAgICAgaW5zdGFsbG1lbnRzOiBcIjFcIixcbiAgICAgICAgYmFza2V0SWQ6IFN0cmluZyhjYXJ0Py5faWQpLFxuICAgICAgICBwYXltZW50Q2hhbm5lbDogSXl6aXBheS5QQVlNRU5UX0NIQU5ORUwuV0VCLFxuICAgICAgICBwYXltZW50R3JvdXA6IEl5emlwYXkuUEFZTUVOVF9HUk9VUC5QUk9EVUNULFxuICAgICAgICBwYXltZW50Q2FyZDoge1xuICAgICAgICAgIGNhcmRUb2tlbixcbiAgICAgICAgICBjYXJkVXNlcktleTogcmVxLnVzZXI/LmNhcmRVc2VyS2V5LFxuICAgICAgICB9LFxuICAgICAgICBidXllcjoge1xuICAgICAgICAgIGlkOiBTdHJpbmcocmVxLnVzZXIuX2lkKSxcbiAgICAgICAgICBuYW1lOiByZXEudXNlcj8ubmFtZSxcbiAgICAgICAgICBzdXJuYW1lOiByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBnc21OdW1iZXI6IHJlcS51c2VyPy5waG9uZU51bWJlcixcbiAgICAgICAgICBlbWFpbDogcmVxLnVzZXI/LmVtYWlsLFxuICAgICAgICAgIGlkZW50aXR5TnVtYmVyOiByZXEudXNlcj8uaWRlbnRpdHlOdW1iZXIsXG4gICAgICAgICAgbGFzdExvZ2luRGF0ZTogbW9tZW50KHJlcS51c2VyPy51cGRhdGVkQXQpLmZvcm1hdChcbiAgICAgICAgICAgIFwiWVlZWS1NTS1ERCBISDptbTpzc1wiXG4gICAgICAgICAgKSxcbiAgICAgICAgICByZWdpc3RyYXRpb25EYXRlOiBtb21lbnQocmVxLnVzZXI/LmNyZWF0ZWRBdCkuZm9ybWF0KFxuICAgICAgICAgICAgXCJZWVlZLU1NLUREIEhIOm1tOnNzXCJcbiAgICAgICAgICApLFxuICAgICAgICAgIHJlZ2lzdHJhdGlvbkFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIGlwOiByZXEudXNlcj8uaXAsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIHNoaXBwaW5nQWRkcmVzczoge1xuICAgICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiIFwiICsgcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgYWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIGJpbGxpbmdBZGRyZXNzOiB7XG4gICAgICAgICAgY29udGFjdE5hbWU6IHJlcS51c2VyPy5uYW1lICsgXCIgXCIgKyByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgICBhZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgICAgfSxcbiAgICAgICAgYmFza2V0SXRlbXMsIC8vIERvxJ9ydSBoZXNhcGxhbmFuIHNlcGV0IMO2xJ9lbGVyaW5pIGfDtm5kZXJpeW9ydXpcbiAgICAgIH07XG4gICAgICBjb25zb2xlLmxvZyhkYXRhKTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IFBheW1lbnRzLmNyZWF0ZVBheW1lbnQoZGF0YSk7XG4gICAgICAgIGF3YWl0IENvbXBsZXRlUGF5bWVudChyZXN1bHQpO1xuXG4gICAgICAgIGNvbnN0IHByb2R1Y3RTdG9ja1VwZGF0ZXMgPSB7fTtcblxuICAgICAgICAvLyBTZXBldHRla2kgw7xyw7xubGVyaSBkw7ZuZ8O8eWxlIGnFn2xleWVyZWsgYXluxLEgw7xyw7xubGVyZGVuIGthw6cgdGFuZSBvbGR1xJ91bnUgaGVzYXBsYVxuICAgICAgICBmb3IgKGNvbnN0IGNhcnRQcm9kdWN0IG9mIGNhcnQucHJvZHVjdHMpIHtcbiAgICAgICAgICBjb25zdCBwcm9kdWN0SWQgPSBTdHJpbmcoY2FydFByb2R1Y3QucHJvZHVjdElkKTsgLy8gRG/En3J1IMO8csO8biBJRCdzaSBidXJhZGFuIGFsxLFubWFsxLFcbiAgICAgICAgICBjb25zdCBxdWFudGl0eSA9IGNhcnRQcm9kdWN0LnF1YW50aXR5OyAvLyBTZXBldHRla2kgbWlrdGFyXG5cbiAgICAgICAgICBpZiAocHJvZHVjdFN0b2NrVXBkYXRlc1twcm9kdWN0SWRdKSB7XG4gICAgICAgICAgICBwcm9kdWN0U3RvY2tVcGRhdGVzW3Byb2R1Y3RJZF0gKz0gcXVhbnRpdHk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHByb2R1Y3RTdG9ja1VwZGF0ZXNbcHJvZHVjdElkXSA9IHF1YW50aXR5O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFN0b2tsYXLEsSBnw7xuY2VsbGVcbiAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0SWQgaW4gcHJvZHVjdFN0b2NrVXBkYXRlcykge1xuICAgICAgICAgIGNvbnN0IHF1YW50aXR5VG9EZWNyZWFzZSA9IHByb2R1Y3RTdG9ja1VwZGF0ZXNbcHJvZHVjdElkXTtcbiAgICAgICAgICBhd2FpdCBQcm9kdWN0cy51cGRhdGVPbmUoXG4gICAgICAgICAgICB7IF9pZDogcHJvZHVjdElkIH0sXG4gICAgICAgICAgICB7ICRpbmM6IHsgc3RvY2s6IC1xdWFudGl0eVRvRGVjcmVhc2UgfSB9XG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJlcy5qc29uKHJlc3VsdCk7XG4gICAgICAgIG5leHQoKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIG5leHQoZXJyb3IpO1xuICAgICAgfVxuICAgIH0sXG4gICAgT3JkZXJDb21wbGV0ZU1haWwsXG4gICAgKHJlcSwgcmVzKSA9PiB7XG4gICAgICByZXR1cm4gcmVzXG4gICAgICAgIC5zdGF0dXMoMjAwKVxuICAgICAgICAuanNvbihgJHtyZXEudXNlci5lbWFpbH0gbWFpbCBhZHJlc2luZSBzaXBhcmnFnyBkZXRhecSxIGfDtm5kZXJpbG1pxZ90aXIuYCk7XG4gICAgfVxuICApO1xuICByb3V0ZXIucG9zdChcbiAgICBcIi9wYXltZW50cy86Y2FydElkL3dpdGgtcmVnaXN0ZXJlZC1jYXJkLXRva2VuXCIsXG4gICAgU2Vzc2lvbixcbiAgICBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICAgIC8vIEdldCBjYXJkVG9rZW4gZnJvbSB0aGUgcmVxdWVzdCBib2R5XG4gICAgICBsZXQgeyBjYXJkVG9rZW4gfSA9IHJlcS5ib2R5O1xuXG4gICAgICAvLyBFbnN1cmUgY2FyZFRva2VuIGlzIHByb3ZpZGVkXG4gICAgICBpZiAoIWNhcmRUb2tlbikge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIHRva2VuIGlzIHJlcXVpcmVkXCIsIDQwMCwgXCJjYXJkVG9rZW5SZXF1aXJlZFwiKTtcbiAgICAgIH1cblxuICAgICAgLy8gRW5zdXJlIHRoZSB1c2VyIGhhcyBhIHJlZ2lzdGVyZWQgY2FyZCAoY2FyZFVzZXJLZXkpXG4gICAgICBpZiAoIXJlcS51c2VyPy5jYXJkVXNlcktleSkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgXCJObyByZWdpc3RlcmVkIGNhcmQgYXZhaWxhYmxlXCIsXG4gICAgICAgICAgNDAwLFxuICAgICAgICAgIFwiY2FyZFVzZXJLZXlSZXF1aXJlZFwiXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIC8vIEVuc3VyZSBjYXJ0SWQgaXMgcHJvdmlkZWQgaW4gdGhlIHJlcXVlc3QgcGFyYW1zXG4gICAgICBpZiAoIXJlcS5wYXJhbXM/LmNhcnRJZCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJ0SUQgaXMgcmVxdWlyZWRcIiwgNDAwLCBcImNhcnRJZFJlcXVpcmVkXCIpO1xuICAgICAgfVxuXG4gICAgICAvLyBGaW5kIHRoZSBjYXJ0IHVzaW5nIGNhcnRJZFxuICAgICAgY29uc3QgY2FydCA9IGF3YWl0IENhcnRzLmZpbmRPbmUoeyBfaWQ6IHJlcS5wYXJhbXM/LmNhcnRJZCB9KS5wb3B1bGF0ZShcbiAgICAgICAgXCJidXllclwiXG4gICAgICApO1xuICAgICAgaWYgKCFjYXJ0KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgbm90IGZvdW5kXCIsIDQwNCwgXCJjYXJ0Tm90Rm91bmRcIik7XG4gICAgICB9XG5cbiAgICAgIGlmIChjYXJ0Py5jb21wbGV0ZWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FydCBpcyBjb21wbGV0ZWRcIiwgNDAwLCBcImNhcnRDb21wbGV0ZWRcIik7XG4gICAgICB9XG5cbiAgICAgIC8vIEZldGNoIHByb2R1Y3QgZGV0YWlscyBmb3IgdGhlIGNhcnRcbiAgICAgIGNvbnN0IHByb2R1Y3RJZHMgPSBjYXJ0LnByb2R1Y3RzLm1hcCgoaXRlbSkgPT4gaXRlbS5wcm9kdWN0SWQpO1xuICAgICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBQcm9kdWN0cy5maW5kKHtcbiAgICAgICAgX2lkOiB7ICRpbjogcHJvZHVjdElkcyB9LFxuICAgICAgfSkucG9wdWxhdGUoXCJzZWxsZXJcIik7XG5cbiAgICAgIC8vIEVucmljaCBjYXJ0IHdpdGggcHJvZHVjdCBkZXRhaWxzXG4gICAgICBjb25zdCBlbnJpY2hlZFByb2R1Y3RzID0gY2FydC5wcm9kdWN0cy5tYXAoKGNhcnRQcm9kdWN0KSA9PiB7XG4gICAgICAgIGNvbnN0IHByb2R1Y3REZXRhaWwgPSBwcm9kdWN0cy5maW5kKFxuICAgICAgICAgIChwcm9kdWN0KSA9PiBTdHJpbmcocHJvZHVjdC5faWQpID09PSBTdHJpbmcoY2FydFByb2R1Y3QucHJvZHVjdElkKVxuICAgICAgICApO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLmNhcnRQcm9kdWN0Ll9kb2MsXG4gICAgICAgICAgcHJvZHVjdERldGFpbCxcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBDYWxjdWxhdGUgdG90YWwgcHJpY2VcbiAgICAgIGNvbnN0IHBhaWRQcmljZSA9IGVucmljaGVkUHJvZHVjdHNcbiAgICAgICAgLnJlZHVjZShcbiAgICAgICAgICAoYWNjLCBwcm9kdWN0KSA9PlxuICAgICAgICAgICAgYWNjICsgcHJvZHVjdC5wcm9kdWN0RGV0YWlsLnByaWNlICogcHJvZHVjdC5xdWFudGl0eSxcbiAgICAgICAgICAwXG4gICAgICAgIClcbiAgICAgICAgLnRvRml4ZWQoMik7XG5cbiAgICAgIC8vIENyZWF0ZSBiYXNrZXQgaXRlbXMgZm9yIHBheW1lbnRcbiAgICAgIGNvbnN0IGJhc2tldEl0ZW1zID0gZW5yaWNoZWRQcm9kdWN0cy5tYXAoKGNhcnRQcm9kdWN0KSA9PiB7XG4gICAgICAgIGNvbnN0IHByb2R1Y3QgPSBjYXJ0UHJvZHVjdC5wcm9kdWN0RGV0YWlsO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGlkOiBTdHJpbmcocHJvZHVjdD8uX2lkKSxcbiAgICAgICAgICBuYW1lOiBwcm9kdWN0Py5uYW1lLFxuICAgICAgICAgIGNhdGVnb3J5MTogcHJvZHVjdD8uY2F0ZWdvcmllcz8uWzBdIHx8IFwiVW5jYXRlZ29yaXplZFwiLFxuICAgICAgICAgIGNhdGVnb3J5MjogcHJvZHVjdD8uY2F0ZWdvcmllcz8uWzFdIHx8IFwiXCIsXG4gICAgICAgICAgaXRlbVR5cGU6IEl5emlwYXkuQkFTS0VUX0lURU1fVFlQRVtwcm9kdWN0Py5pdGVtVHlwZV0sXG4gICAgICAgICAgcHJpY2U6IChwcm9kdWN0Py5wcmljZSAqIGNhcnRQcm9kdWN0LnF1YW50aXR5KS50b0ZpeGVkKDIpLFxuICAgICAgICAgIHN1Yk1lcmNoYW50S2V5OiBwcm9kdWN0Py5zZWxsZXI/LnN1Yk1lcmNoYW50S2V5LFxuICAgICAgICAgIHN1Yk1lcmNoYW50UHJpY2U6IChcbiAgICAgICAgICAgIHByb2R1Y3QucHJpY2UgKlxuICAgICAgICAgICAgY2FydFByb2R1Y3QucXVhbnRpdHkgKlxuICAgICAgICAgICAgMC45XG4gICAgICAgICAgKS50b0ZpeGVkKDIpLFxuICAgICAgICB9O1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IGJhc2tldFRvdGFsID0gYmFza2V0SXRlbXNcbiAgICAgICAgLnJlZHVjZSgoYWNjLCBpdGVtKSA9PiBhY2MgKyBwYXJzZUZsb2F0KGl0ZW0ucHJpY2UpLCAwKVxuICAgICAgICAudG9GaXhlZCgyKTtcblxuICAgICAgaWYgKGJhc2tldFRvdGFsICE9PSBwYWlkUHJpY2UpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIFwiR8O2bmRlcmlsZW4gdHV0YXIgdMO8bSBrxLFyxLFsxLFtbGFyxLFuIHRvcGxhbSB0dXRhcsSxbmEgZcWfaXQgb2xtYWzEsWTEsXJcIixcbiAgICAgICAgICA0MDAsXG4gICAgICAgICAgXCJwcmljZU1pc21hdGNoXCJcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgLy8gUHJlcGFyZSBwYXltZW50IGRhdGFcbiAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgICBjb252ZXJzYXRpb25JZDogaWQoKSxcbiAgICAgICAgcHJpY2U6IGJhc2tldFRvdGFsLFxuICAgICAgICBwYWlkUHJpY2U6IGJhc2tldFRvdGFsLFxuICAgICAgICBjdXJyZW5jeTogSXl6aXBheS5DVVJSRU5DWS5UUlksXG4gICAgICAgIGluc3RhbGxtZW50czogXCIxXCIsXG4gICAgICAgIGJhc2tldElkOiBTdHJpbmcoY2FydD8uX2lkKSxcbiAgICAgICAgcGF5bWVudENoYW5uZWw6IEl5emlwYXkuUEFZTUVOVF9DSEFOTkVMLldFQixcbiAgICAgICAgcGF5bWVudEdyb3VwOiBJeXppcGF5LlBBWU1FTlRfR1JPVVAuUFJPRFVDVCxcbiAgICAgICAgcGF5bWVudENhcmQ6IHtcbiAgICAgICAgICBjYXJkVG9rZW4sXG4gICAgICAgICAgY2FyZFVzZXJLZXk6IHJlcS51c2VyPy5jYXJkVXNlcktleSxcbiAgICAgICAgfSxcbiAgICAgICAgYnV5ZXI6IHtcbiAgICAgICAgICBpZDogU3RyaW5nKHJlcS51c2VyLl9pZCksXG4gICAgICAgICAgbmFtZTogcmVxLnVzZXI/Lm5hbWUsXG4gICAgICAgICAgc3VybmFtZTogcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgZ3NtTnVtYmVyOiByZXEudXNlcj8ucGhvbmVOdW1iZXIsXG4gICAgICAgICAgZW1haWw6IHJlcS51c2VyPy5lbWFpbCxcbiAgICAgICAgICBpZGVudGl0eU51bWJlcjogcmVxLnVzZXI/LmlkZW50aXR5TnVtYmVyLFxuICAgICAgICAgIGxhc3RMb2dpbkRhdGU6IG1vbWVudChyZXEudXNlcj8udXBkYXRlZEF0KS5mb3JtYXQoXG4gICAgICAgICAgICBcIllZWVktTU0tREQgSEg6bW06c3NcIlxuICAgICAgICAgICksXG4gICAgICAgICAgcmVnaXN0cmF0aW9uRGF0ZTogbW9tZW50KHJlcS51c2VyPy5jcmVhdGVkQXQpLmZvcm1hdChcbiAgICAgICAgICAgIFwiWVlZWS1NTS1ERCBISDptbTpzc1wiXG4gICAgICAgICAgKSxcbiAgICAgICAgICByZWdpc3RyYXRpb25BZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICBpcDogcmVxLnVzZXI/LmlwLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBzaGlwcGluZ0FkZHJlc3M6IHtcbiAgICAgICAgICBjb250YWN0TmFtZTogcmVxLnVzZXI/Lm5hbWUgKyBcIiBcIiArIHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIGFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBiaWxsaW5nQWRkcmVzczoge1xuICAgICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiIFwiICsgcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgYWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIGJhc2tldEl0ZW1zLFxuICAgICAgfTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gUHJvY2VzcyBwYXltZW50XG4gICAgICAgIGxldCByZXN1bHQgPSBhd2FpdCBQYXltZW50cy5jcmVhdGVQYXltZW50KGRhdGEpO1xuICAgICAgICBhd2FpdCBDb21wbGV0ZVBheW1lbnQocmVzdWx0KTtcblxuICAgICAgICBjb25zdCBwcm9kdWN0U3RvY2tVcGRhdGVzID0ge307XG5cbiAgICAgICAgLy8gVXBkYXRlIHN0b2NrIGZvciBlYWNoIHByb2R1Y3RcbiAgICAgICAgZm9yIChjb25zdCBjYXJ0UHJvZHVjdCBvZiBjYXJ0LnByb2R1Y3RzKSB7XG4gICAgICAgICAgY29uc3QgcHJvZHVjdElkID0gU3RyaW5nKGNhcnRQcm9kdWN0LnByb2R1Y3RJZCk7XG4gICAgICAgICAgY29uc3QgcXVhbnRpdHkgPSBjYXJ0UHJvZHVjdC5xdWFudGl0eTtcbiAgICAgICAgICBpZiAocHJvZHVjdFN0b2NrVXBkYXRlc1twcm9kdWN0SWRdKSB7XG4gICAgICAgICAgICBwcm9kdWN0U3RvY2tVcGRhdGVzW3Byb2R1Y3RJZF0gKz0gcXVhbnRpdHk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHByb2R1Y3RTdG9ja1VwZGF0ZXNbcHJvZHVjdElkXSA9IHF1YW50aXR5O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERlY3JlYXNlIHN0b2NrIGJhc2VkIG9uIHRoZSBxdWFudGl0aWVzXG4gICAgICAgIGZvciAoY29uc3QgcHJvZHVjdElkIGluIHByb2R1Y3RTdG9ja1VwZGF0ZXMpIHtcbiAgICAgICAgICBjb25zdCBxdWFudGl0eVRvRGVjcmVhc2UgPSBwcm9kdWN0U3RvY2tVcGRhdGVzW3Byb2R1Y3RJZF07XG4gICAgICAgICAgYXdhaXQgUHJvZHVjdHMudXBkYXRlT25lKFxuICAgICAgICAgICAgeyBfaWQ6IHByb2R1Y3RJZCB9LFxuICAgICAgICAgICAgeyAkaW5jOiB7IHN0b2NrOiAtcXVhbnRpdHlUb0RlY3JlYXNlIH0gfVxuICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICByZXMuanNvbihyZXN1bHQpO1xuICAgICAgICBuZXh0KCk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBuZXh0KGVycm9yKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIE9yZGVyQ29tcGxldGVNYWlsLFxuICAgIChyZXEsIHJlcykgPT4ge1xuICAgICAgcmV0dXJuIHJlc1xuICAgICAgICAuc3RhdHVzKDIwMClcbiAgICAgICAgLmpzb24oYCR7cmVxLnVzZXIuZW1haWx9IG1haWwgYWRyZXNpbmUgc2lwYXJpxZ8gZGV0YXnEsSBnw7ZuZGVyaWxtacWfdGlyLmApO1xuICAgIH1cbiAgKTtcblxuICAvLyByb3V0ZXIucG9zdChcbiAgLy8gICBcIi9wYXltZW50cy86Y2FydElkL3dpdGgtcmVnaXN0ZXJlZC1jYXJkLXRva2VuXCIsXG4gIC8vICAgU2Vzc2lvbixcbiAgLy8gICBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgLy8gICAgIGxldCB7IGNhcmRUb2tlbiB9ID0gcmVxLmJvZHk7XG4gIC8vICAgICBpZiAoIWNhcmRUb2tlbikge1xuICAvLyAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIFRva2VuIGlzIHJlcXVpcmVkXCIsIDQwMCwgXCJjYXJkVG9rZW5SZXF1aXJlZFwiKTtcbiAgLy8gICAgIH1cbiAgLy8gICAgIGlmICghcmVxLnVzZXI/LmNhcmRVc2VyS2V5KSB7XG4gIC8vICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgLy8gICAgICAgICBcIk5vIHJlZ2lzdGVyZWQgY2FyZCBhdmFpbGFibGVcIixcbiAgLy8gICAgICAgICA0MDAsXG4gIC8vICAgICAgICAgXCJjYXJkVXNlcktleVJlcXVpcmVkXCJcbiAgLy8gICAgICAgKTtcbiAgLy8gICAgIH1cblxuICAvLyAgICAgaWYgKCFyZXEucGFyYW1zPy5jYXJ0SWQpIHtcbiAgLy8gICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FydElEIGlzIHJlcXVpcmVkXCIsIDQwMCwgXCJjYXJ0SWRSZXF1aXJlZFwiKTtcbiAgLy8gICAgIH1cbiAgLy8gICAgIGNvbnN0IGNhcnQgPSBhd2FpdCBDYXJ0cy5maW5kT25lKHsgX2lkOiByZXEucGFyYW1zPy5jYXJ0SWQgfSlcbiAgLy8gICAgICAgLnBvcHVsYXRlKFwiYnV5ZXJcIilcbiAgLy8gICAgICAgLnBvcHVsYXRlKFwicHJvZHVjdHNcIik7XG4gIC8vICAgICBpZiAoIWNhcnQpIHtcbiAgLy8gICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FyZCBub3QgZm91bmRcIiwgNDA0LCBcImNhcmROb3RGb3VuZFwiKTtcbiAgLy8gICAgIH1cbiAgLy8gICAgIGlmIChjYXJ0Py5jb21wbGV0ZWQpIHtcbiAgLy8gICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FydCBpcyBjb21wbGV0ZWRcIiwgNDAwLCBcImNhcnRDb21wbGV0ZWRcIik7XG4gIC8vICAgICB9XG5cbiAgLy8gICAgIGNvbnN0IHBhaWRQcmljZSA9IGNhcnQucHJvZHVjdHNcbiAgLy8gICAgICAgLm1hcCgocHJvZHVjdCkgPT4gcHJvZHVjdC5wcmljZSlcbiAgLy8gICAgICAgLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApOyAvL8O2ZGVuZWNlayBtaWt0YXJsYXLEsW4gdG9wbGFtxLFcblxuICAvLyAgICAgY29uc3QgY2FyZCA9IHtcbiAgLy8gICAgICAgY2FyZFRva2VuLFxuICAvLyAgICAgICBjYXJkVXNlcktleTogcmVxLnVzZXI/LmNhcmRVc2VyS2V5LFxuICAvLyAgICAgfTtcblxuICAvLyAgICAgY29uc3QgZGF0YSA9IHtcbiAgLy8gICAgICAgbG9jYWxlOiByZXEudXNlci5sb2NhbGUsXG4gIC8vICAgICAgIGNvbnZlcnNhdGlvbklkOiBpZCgpLFxuICAvLyAgICAgICBwcmljZTogcGFpZFByaWNlLFxuICAvLyAgICAgICBwYWlkUHJpY2U6IHBhaWRQcmljZSxcbiAgLy8gICAgICAgY3VycmVuY3k6IEl5emlwYXkuQ1VSUkVOQ1kuVFJZLFxuICAvLyAgICAgICBpbnN0YWxsbWVudHM6IFwiMVwiLFxuICAvLyAgICAgICBiYXNrZXRJZDogU3RyaW5nKGNhcnQ/Ll9pZCksXG4gIC8vICAgICAgIHBheW1lbnRDaGFubmVsOiBJeXppcGF5LlBBWU1FTlRfQ0hBTk5FTC5XRUIsXG4gIC8vICAgICAgIHBheW1lbnRHcm91cDogSXl6aXBheS5QQVlNRU5UX0dST1VQLlBST0RVQ1QsXG4gIC8vICAgICAgIHBheW1lbnRDYXJkOiBjYXJkLFxuICAvLyAgICAgICBidXllcjoge1xuICAvLyAgICAgICAgIGlkOiBTdHJpbmcocmVxLnVzZXIuX2lkKSxcbiAgLy8gICAgICAgICBuYW1lOiByZXEudXNlcj8ubmFtZSxcbiAgLy8gICAgICAgICBzdXJuYW1lOiByZXEudXNlcj8uc3VybmFtZSxcbiAgLy8gICAgICAgICBnc21OdW1iZXI6IHJlcS51c2VyPy5waG9uZU51bWJlcixcbiAgLy8gICAgICAgICBlbWFpbDogcmVxLnVzZXI/LmVtYWlsLFxuICAvLyAgICAgICAgIGlkZW50aXR5TnVtYmVyOiByZXEudXNlcj8uaWRlbnRpdHlOdW1iZXIsXG4gIC8vICAgICAgICAgbGFzdExvZ2luRGF0ZTogbW9tZW50KHJlcS51c2VyPy51cGRhdGVkQXQpLmZvcm1hdChcbiAgLy8gICAgICAgICAgIFwiWVlZWS1NTS1ERCBISDptbTpzc1wiXG4gIC8vICAgICAgICAgKSwgLy9peWl6cGF5IHRhcmloIGZvcm1hdMSxbmEgw6dldmlybWVrIGnDp2luIHlhcMSxbGTEsVxuICAvLyAgICAgICAgIHJlZ2lzdHJhdGlvbkRhdGU6IG1vbWVudChyZXEudXNlcj8udXBkYXRlZEF0KS5mb3JtYXQoXG4gIC8vICAgICAgICAgICBcIllZWVktTU0tREQgSEg6bW06c3NcIlxuICAvLyAgICAgICAgICksXG4gIC8vICAgICAgICAgcmVnaXN0cmF0aW9uQWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gIC8vICAgICAgICAgaXA6IHJlcS51c2VyPy5pcCxcbiAgLy8gICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgLy8gICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgLy8gICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgLy8gICAgICAgfSxcbiAgLy8gICAgICAgc2hpcHBpbmdBZGRyZXNzOiB7XG4gIC8vICAgICAgICAgY29udGFjdE5hbWU6IHJlcS51c2VyPy5uYW1lICsgXCJcIiArIHJlcS51c2VyPy5zdXJuYW1lLFxuICAvLyAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAvLyAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAvLyAgICAgICAgIGFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAvLyAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAvLyAgICAgICB9LFxuICAvLyAgICAgICBiaWxsaW5nQWRkcmVzczoge1xuICAvLyAgICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiXCIgKyByZXEudXNlcj8uc3VybmFtZSxcbiAgLy8gICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgLy8gICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgLy8gICAgICAgICBhZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgLy8gICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgLy8gICAgICAgfSxcbiAgLy8gICAgICAgYmFza2V0SXRlbXM6IGNhcnQucHJvZHVjdHMubWFwKChwcm9kdWN0LCBpbmRleCkgPT4ge1xuICAvLyAgICAgICAgIHJldHVybiB7XG4gIC8vICAgICAgICAgICBpZDogU3RyaW5nKHByb2R1Y3Q/Ll9pZCksXG4gIC8vICAgICAgICAgICBuYW1lOiBwcm9kdWN0Py5uYW1lLFxuICAvLyAgICAgICAgICAgY2F0ZWdvcnkxOiBwcm9kdWN0LmNhdGVnb3JpZXNbMF0sXG4gIC8vICAgICAgICAgICBjYXRlZ29yeTI6IHByb2R1Y3QuY2F0ZWdvcmllc1sxXSxcbiAgLy8gICAgICAgICAgIGl0ZW1UeXBlOiBJeXppcGF5LkJBU0tFVF9JVEVNX1RZUEVbcHJvZHVjdD8uaXRlbVR5cGVdLFxuICAvLyAgICAgICAgICAgcHJpY2U6IHByb2R1Y3Q/LnByaWNlLFxuICAvLyAgICAgICAgIH07XG4gIC8vICAgICAgIH0pLFxuICAvLyAgICAgfTtcblxuICAvLyAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IFBheW1lbnRzLmNyZWF0ZVBheW1lbnQoZGF0YSk7XG4gIC8vICAgICBhd2FpdCBDb21wbGV0ZVBheW1lbnQocmVzdWx0KTtcbiAgLy8gICAgIHJlcy5qc29uKHJlc3VsdCk7XG4gIC8vICAgfVxuICAvLyApO1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsUUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsT0FBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsS0FBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUcsU0FBQSxHQUFBSixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUksTUFBQSxHQUFBTCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUssU0FBQSxHQUFBTixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQU0sY0FBQSxHQUFBTixPQUFBO0FBQ0EsSUFBQU8sa0JBQUEsR0FBQVIsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFRLFFBQUEsR0FBQVQsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFTLEtBQUEsR0FBQUMsdUJBQUEsQ0FBQVYsT0FBQTtBQUNBLElBQUFXLFFBQUEsR0FBQUQsdUJBQUEsQ0FBQVYsT0FBQTtBQUNBLElBQUFZLFVBQUEsR0FBQVosT0FBQTtBQUNBLElBQUFhLEtBQUEsR0FBQWQsc0JBQUEsQ0FBQUMsT0FBQTtBQUErQixTQUFBYyx5QkFBQUMsQ0FBQSw2QkFBQUMsT0FBQSxtQkFBQUMsQ0FBQSxPQUFBRCxPQUFBLElBQUFFLENBQUEsT0FBQUYsT0FBQSxZQUFBRix3QkFBQSxZQUFBQSxDQUFBQyxDQUFBLFdBQUFBLENB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","map":{"version":3,"names":["_iyzipay","_interopRequireDefault","require","_moment","_cart","_products","_users","_ApiError","_RequiredCheck","_OrderCompleteMail","_Session","Cards","_interopRequireWildcard","Payments","_payments2","_uuid","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","_default","router","post","Session","req","res","next","card","body","checkRequiredField","params","cartId","cart","Carts","findOne","_id","populate","ApiError","completed","registerCard","productIds","products","map","item","productId","Products","find","$in","enrichedProducts","cartProduct","productDetail","product","String","_doc","paidPrice","reduce","acc","price","quantity","toFixed","basketItems","console","log","name","seller","subMerchantKey","id","category1","categories","category2","itemType","Iyzipay","BASKET_ITEM_TYPE","subMerchantPrice","basketTotal","parseFloat","data","locale","user","conversationId","currency","CURRENCY","TRY","installments","basketId","paymentChannel","PAYMENT_CHANNEL","WEB","paymentGroup","PAYMENT_GROUP","PRODUCT","paymentCard","buyer","surname","gsmNumber","phoneNumber","email","identityNumber","lastLoginDate","moment","updatedAt","format","registrationDate","registrationAddress","address","ip","city","country","zipCode","shippingAddress","contactName","billingAddress","result","createPayment","CompletePayment","productStockUpdates","quantityToDecrease","updateOne","$inc","stock","OrderCompleteMail","json","error","cardUserKey","b","index","Users","save","cardIndex","cards","getUserCards","parseInt","cardDetails","length","cardToken","createdAt","status","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["payments.js"],"sourcesContent":["import Iyzipay from \"iyzipay\";\nimport moment from \"moment\";\nimport Carts from \"../db/cart\";\nimport Products from \"../db/products\";\nimport Users from \"../db/users\";\nimport ApiError from \"../errors/ApiError\";\nimport { checkRequiredField } from \"../helpers/RequiredCheck\";\nimport OrderCompleteMail from \"../middlewares/OrderCompleteMail\";\nimport Session from \"../middlewares/Session\";\nimport * as Cards from \"../services/iyzico/methods/cards\";\nimport * as Payments from \"../services/iyzico/methods/payments\";\nimport { CompletePayment } from \"../utils/payments\";\nimport id from \"../utils/uuid\";\n\nexport default (router) => {\n  /*çalışıyor*/ router.post(\n    \"/payments/:cartId/with-new-card\",\n    Session,\n    async (req, res, next) => {\n      const { card } = req.body;\n      // if (!card) {\n      //   throw new ApiError(\"Card is required\", 400, \"cardRequired\");\n      // }\n      checkRequiredField(card, \"Card\");\n      checkRequiredField(req.params?.cartId, \"CartId\");\n      // if (!req.params?.cartId) {\n      //   throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      // }\n      const cart = await Carts.findOne({ _id: req.params?.cartId })\n        .populate(\"buyer\")\n        .populate(\"products\");\n      if (!cart) {\n        throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n      }\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      card.registerCard = \"0\"; //methodslarda registerCard:1 yani kartı kaydet demek ama şuan kaydetme dediğim için 0 yaptım\n\n      // Ürün bilgilerini getirme (Cart'taki productId'leri kullanarak)\n      const productIds = cart.products.map((item) => item.productId);\n      const products = await Products.find({\n        _id: { $in: productIds },\n      }).populate(\"seller\");\n\n      // Ürün bilgilerini cart'a ekliyoruz\n      const enrichedProducts = cart.products.map((cartProduct) => {\n        const productDetail = products.find(\n          (product) => String(product._id) === String(cartProduct.productId)\n        );\n        return {\n          ...cartProduct._doc,\n          productDetail,\n        };\n      });\n\n      // Ödenecek miktar hesaplama\n      // const paidPrice = enrichedProducts\n      //   .map((product) => product.productDetail.price * product.quantity)\n      //   .reduce((a, b) => a + b, 0);\n\n      const paidPrice = enrichedProducts\n        .reduce(\n          (acc, product) =>\n            acc + product.productDetail.price * product.quantity,\n          0\n        )\n        .toFixed(2);\n\n      const basketItems = enrichedProducts.map((cartProduct) => {\n        const product = cartProduct.productDetail;\n        // Log subMerchantKey to ensure it's present\n        console.log(`Processing product: ${product.name}`);\n        console.log(`subMerchantKey: ${product.seller.subMerchantKey}`);\n\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product?.categories?.[0] || \"Uncategorized\",\n          category2: product?.categories?.[1] || \"\",\n          itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n          price: (product?.price * cartProduct.quantity).toFixed(2), // Birim fiyatı çarpıyoruz ve virgülden sonra 2 basamak tutuyoruz\n          subMerchantKey: product?.seller?.subMerchantKey,\n          subMerchantPrice: (\n            product.price *\n            cartProduct.quantity *\n            0.9\n          ).toFixed(2),\n        };\n      });\n      console.log(\"Final basketItems array:\", basketItems);\n\n      // Sepetteki ürünlerin toplam fiyatını hesaplıyoruz\n      const basketTotal = basketItems\n        .reduce((acc, item) => acc + parseFloat(item.price), 0)\n        .toFixed(2); // Fiyatları alıp float'a çeviriyoruz\n\n      // Ödeme ve sepet toplamları kontrolü\n      if (basketTotal !== paidPrice) {\n        console.log(basketTotal);\n        throw new ApiError(\n          \"Gönderilen tutar tüm kırılımların toplam tutarına eşit olmalıdır\",\n          400,\n          \"priceMismatch\"\n        );\n      }\n\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: basketTotal, //toFixed(2) vardı\n        paidPrice: basketTotal,\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        paymentCard: card,\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ), //iyizpay tarih formatına çevirmek için yapıldı\n          registrationDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems,\n      };\n\n      try {\n        let result = await Payments.createPayment(data);\n        await CompletePayment(result);\n\n        // Ürün stoklarını güncelleme\n        const productStockUpdates = {};\n\n        // Sepetteki ürünleri döngüyle işleyerek aynı ürünlerden kaç tane olduğunu hesapla\n        for (const cartProduct of cart.products) {\n          const productId = String(cartProduct.productId); // Doğru ürün ID'si buradan alınmalı\n          const quantity = cartProduct.quantity; // Sepetteki miktar\n\n          if (productStockUpdates[productId]) {\n            productStockUpdates[productId] += quantity;\n          } else {\n            productStockUpdates[productId] = quantity;\n          }\n        }\n\n        // Stokları güncelle\n        for (const productId in productStockUpdates) {\n          const quantityToDecrease = productStockUpdates[productId];\n          await Products.updateOne(\n            { _id: productId },\n            { $inc: { stock: -quantityToDecrease } }\n          );\n        }\n\n        await OrderCompleteMail(req, res);\n        res.json(result);\n      } catch (error) {\n        next(error);\n      }\n    }\n  );\n\n  //yeni bir ödeme oluştur ve kart kaydet\n  router.post(\n    \"/payments/:cartId/with-new-card/register-card\",\n    Session,\n    async (req, res) => {\n      const { card } = req.body;\n      if (!card) {\n        throw new ApiError(\"Card is required\", 400, \"cardRequired\");\n      }\n      if (!req.params?.cartId) {\n        throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      }\n      const cart = await Carts.findOne({ _id: req.params?.cartId })\n        .populate(\"buyer\")\n        .populate(\"products\");\n      if (!cart) {\n        throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n      }\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      if (req.user?.cardUserKey) {\n        card.cardUserKey = req.user?.cardUserKey;\n      }\n      card.registerCard = \"1\"; //methodslarda registerCard:1 yani kartı kaydet\n\n      const paidPrice = cart.products\n        .map((product) => product.price)\n        .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: paidPrice,\n        paidPrice: paidPrice,\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        paymentCard: card,\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ), //iyizpay tarih formatına çevirmek için yapıldı\n          registrationDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems: cart.products.map((product, index) => {\n          return {\n            id: String(product?._id),\n            name: product?.name,\n            category1: product.categories[0],\n            category2: product.categories[1],\n            itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n            price: product?.price,\n          };\n        }),\n      };\n\n      let result = await Payments.createPayment(data);\n      if (req.user?.cardUserKey) {\n        const user = await Users.findOne({ _id: req.user?._id });\n        user.cardUserKey = result?.cardUserKey;\n        await user.save();\n      }\n      await CompletePayment(result);\n      res.json(result);\n    }\n  );\n\n  /*çalışıyor*/ router.post(\n    \"/payments/:cartId/:cardIndex/with-registered-card-index\",\n    Session,\n    async (req, res, next) => {\n      //çalışıyor bu endpoint\n      let { cardIndex } = req.params;\n      if (!cardIndex) {\n        throw new ApiError(\"Card index is required\", 400, \"cardIndexRequired\");\n      }\n      if (!req.user?.cardUserKey) {\n        throw new ApiError(\n          \"No registered card available\",\n          400,\n          \"cardUserKeyRequired\"\n        );\n      }\n\n      const cards = await Cards.getUserCards({\n        locale: req.user.locale,\n        conversationId: id(),\n        cardUserKey: req.user?.cardUserKey,\n      });\n      const index = parseInt(cardIndex);\n      if (index >= cards?.cardDetails?.length) {\n        throw new ApiError(\"Card does not exist\", 400, \"cardIndexInvalid\");\n      }\n      const { cardToken } = cards?.cardDetails[index];\n      if (!req.params?.cartId) {\n        throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      }\n\n      // Cart'ı bul\n      const cart = await Carts.findOne({ _id: req.params?.cartId }).populate(\n        \"buyer\"\n      ); // Sadece buyer'ı populate ediyoruz.\n\n      if (!cart) {\n        throw new ApiError(\"Cart not found\", 404, \"cartNotFound\");\n      }\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      // Ürün bilgilerini getirme (Cart'taki productId'leri kullanarak)\n      const productIds = cart.products.map((item) => item.productId);\n      const products = await Products.find({\n        _id: { $in: productIds },\n      }).populate(\"seller\");\n\n      // Ürün bilgilerini cart'a ekliyoruz\n      const enrichedProducts = cart.products.map((cartProduct) => {\n        const productDetail = products.find(\n          (product) => String(product._id) === String(cartProduct.productId)\n        );\n        return {\n          ...cartProduct._doc,\n          productDetail,\n        };\n      });\n\n      // Ödenecek miktar hesaplama\n      const paidPrice = enrichedProducts\n        .reduce(\n          (acc, product) =>\n            acc + product.productDetail.price * product.quantity,\n          0\n        )\n        .toFixed(2);\n\n      const basketItems = enrichedProducts.map((cartProduct) => {\n        const product = cartProduct.productDetail;\n        console.log(`Processing product: ${product.name}`);\n        console.log(`subMerchantKey: ${product.seller.subMerchantKey}`);\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product?.categories?.[0] || \"Uncategorized\",\n          category2: product?.categories?.[1] || \"\",\n          itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n          price: (product?.price * cartProduct.quantity).toFixed(2), // Birim fiyatı çarpıyoruz ve virgülden sonra 2 basamak tutuyoruz\n          subMerchantKey: product?.seller?.subMerchantKey,\n          subMerchantPrice: (\n            product.price *\n            cartProduct.quantity *\n            0.9\n          ).toFixed(2),\n        };\n      });\n      console.log(\"Items:\", basketItems);\n\n      // Sepetteki ürünlerin toplam fiyatını hesaplıyoruz\n      const basketTotal = basketItems\n        .reduce((acc, item) => acc + parseFloat(item.price), 0)\n        .toFixed(2); // Fiyatları alıp float'a çeviriyoruz\n\n      // Ödeme ve sepet toplamları kontrolü\n      if (basketTotal !== paidPrice) {\n        throw new ApiError(\n          \"Gönderilen tutar tüm kırılımların toplam tutarına eşit olmalıdır\",\n          400,\n          \"priceMismatch\"\n        );\n      }\n\n      // Ödeme verisi\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: basketTotal, // İyzico için yuvarlanmış toplam sepet tutarı\n        paidPrice: basketTotal, // Aynı değeri paidPrice'a da gönderiyoruz\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        paymentCard: {\n          cardToken,\n          cardUserKey: req.user?.cardUserKey,\n        },\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationDate: moment(req.user?.createdAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \" \" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \" \" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems, // Doğru hesaplanan sepet öğelerini gönderiyoruz\n      };\n      console.log(data);\n\n      try {\n        let result = await Payments.createPayment(data);\n        await CompletePayment(result);\n\n        const productStockUpdates = {};\n\n        // Sepetteki ürünleri döngüyle işleyerek aynı ürünlerden kaç tane olduğunu hesapla\n        for (const cartProduct of cart.products) {\n          const productId = String(cartProduct.productId); // Doğru ürün ID'si buradan alınmalı\n          const quantity = cartProduct.quantity; // Sepetteki miktar\n\n          if (productStockUpdates[productId]) {\n            productStockUpdates[productId] += quantity;\n          } else {\n            productStockUpdates[productId] = quantity;\n          }\n        }\n\n        // Stokları güncelle\n        for (const productId in productStockUpdates) {\n          const quantityToDecrease = productStockUpdates[productId];\n          await Products.updateOne(\n            { _id: productId },\n            { $inc: { stock: -quantityToDecrease } }\n          );\n        }\n\n        res.json(result);\n        next();\n      } catch (error) {\n        next(error);\n      }\n    },\n    OrderCompleteMail,\n    (req, res) => {\n      return res\n        .status(200)\n        .json(`${req.user.email} mail adresine sipariş detayı gönderilmiştir.`);\n    }\n  );\n  router.post(\n    \"/payments/:cartId/with-registered-card-token\",\n    Session,\n    async (req, res, next) => {\n      // Get cardToken from the request body\n      let { cardToken } = req.body;\n\n      // Ensure cardToken is provided\n      if (!cardToken) {\n        throw new ApiError(\"Card token is required\", 400, \"cardTokenRequired\");\n      }\n\n      // Ensure the user has a registered card (cardUserKey)\n      if (!req.user?.cardUserKey) {\n        throw new ApiError(\n          \"No registered card available\",\n          400,\n          \"cardUserKeyRequired\"\n        );\n      }\n\n      // Ensure cartId is provided in the request params\n      if (!req.params?.cartId) {\n        throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      }\n\n      // Find the cart using cartId\n      const cart = await Carts.findOne({ _id: req.params?.cartId }).populate(\n        \"buyer\"\n      );\n      if (!cart) {\n        throw new ApiError(\"Cart not found\", 404, \"cartNotFound\");\n      }\n\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      // Fetch product details for the cart\n      const productIds = cart.products.map((item) => item.productId);\n      const products = await Products.find({\n        _id: { $in: productIds },\n      }).populate(\"seller\");\n\n      // Enrich cart with product details\n      const enrichedProducts = cart.products.map((cartProduct) => {\n        const productDetail = products.find(\n          (product) => String(product._id) === String(cartProduct.productId)\n        );\n        return {\n          ...cartProduct._doc,\n          productDetail,\n        };\n      });\n\n      // Calculate total price\n      const paidPrice = enrichedProducts\n        .reduce(\n          (acc, product) =>\n            acc + product.productDetail.price * product.quantity,\n          0\n        )\n        .toFixed(2);\n\n      // Create basket items for payment\n      const basketItems = enrichedProducts.map((cartProduct) => {\n        const product = cartProduct.productDetail;\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product?.categories?.[0] || \"Uncategorized\",\n          category2: product?.categories?.[1] || \"\",\n          itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n          price: (product?.price * cartProduct.quantity).toFixed(2),\n          subMerchantKey: product?.seller?.subMerchantKey,\n          subMerchantPrice: (\n            product.price *\n            cartProduct.quantity *\n            0.9\n          ).toFixed(2),\n        };\n      });\n\n      const basketTotal = basketItems\n        .reduce((acc, item) => acc + parseFloat(item.price), 0)\n        .toFixed(2);\n\n      if (basketTotal !== paidPrice) {\n        throw new ApiError(\n          \"Gönderilen tutar tüm kırılımların toplam tutarına eşit olmalıdır\",\n          400,\n          \"priceMismatch\"\n        );\n      }\n\n      // Prepare payment data\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: basketTotal,\n        paidPrice: basketTotal,\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        paymentCard: {\n          cardToken,\n          cardUserKey: req.user?.cardUserKey,\n        },\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationDate: moment(req.user?.createdAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \" \" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \" \" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems,\n      };\n\n      try {\n        // Process payment\n        let result = await Payments.createPayment(data);\n        await CompletePayment(result);\n\n        const productStockUpdates = {};\n\n        // Update stock for each product\n        for (const cartProduct of cart.products) {\n          const productId = String(cartProduct.productId);\n          const quantity = cartProduct.quantity;\n          if (productStockUpdates[productId]) {\n            productStockUpdates[productId] += quantity;\n          } else {\n            productStockUpdates[productId] = quantity;\n          }\n        }\n\n        // Decrease stock based on the quantities\n        for (const productId in productStockUpdates) {\n          const quantityToDecrease = productStockUpdates[productId];\n          await Products.updateOne(\n            { _id: productId },\n            { $inc: { stock: -quantityToDecrease } }\n          );\n        }\n\n        res.json(result);\n        next();\n      } catch (error) {\n        next(error);\n      }\n    },\n    OrderCompleteMail,\n    (req, res) => {\n      return res\n        .status(200)\n        .json(`${req.user.email} mail adresine sipariş detayı gönderilmiştir.`);\n    }\n  );\n\n  // router.post(\n  //   \"/payments/:cartId/with-registered-card-token\",\n  //   Session,\n  //   async (req, res) => {\n  //     let { cardToken } = req.body;\n  //     if (!cardToken) {\n  //       throw new ApiError(\"Card Token is required\", 400, \"cardTokenRequired\");\n  //     }\n  //     if (!req.user?.cardUserKey) {\n  //       throw new ApiError(\n  //         \"No registered card available\",\n  //         400,\n  //         \"cardUserKeyRequired\"\n  //       );\n  //     }\n\n  //     if (!req.params?.cartId) {\n  //       throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n  //     }\n  //     const cart = await Carts.findOne({ _id: req.params?.cartId })\n  //       .populate(\"buyer\")\n  //       .populate(\"products\");\n  //     if (!cart) {\n  //       throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n  //     }\n  //     if (cart?.completed) {\n  //       throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n  //     }\n\n  //     const paidPrice = cart.products\n  //       .map((product) => product.price)\n  //       .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n  //     const card = {\n  //       cardToken,\n  //       cardUserKey: req.user?.cardUserKey,\n  //     };\n\n  //     const data = {\n  //       locale: req.user.locale,\n  //       conversationId: id(),\n  //       price: paidPrice,\n  //       paidPrice: paidPrice,\n  //       currency: Iyzipay.CURRENCY.TRY,\n  //       installments: \"1\",\n  //       basketId: String(cart?._id),\n  //       paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n  //       paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n  //       paymentCard: card,\n  //       buyer: {\n  //         id: String(req.user._id),\n  //         name: req.user?.name,\n  //         surname: req.user?.surname,\n  //         gsmNumber: req.user?.phoneNumber,\n  //         email: req.user?.email,\n  //         identityNumber: req.user?.identityNumber,\n  //         lastLoginDate: moment(req.user?.updatedAt).format(\n  //           \"YYYY-MM-DD HH:mm:ss\"\n  //         ), //iyizpay tarih formatına çevirmek için yapıldı\n  //         registrationDate: moment(req.user?.updatedAt).format(\n  //           \"YYYY-MM-DD HH:mm:ss\"\n  //         ),\n  //         registrationAddress: req.user?.address,\n  //         ip: req.user?.ip,\n  //         city: req.user?.city,\n  //         country: req.user?.country,\n  //         zipCode: req.user?.zipCode,\n  //       },\n  //       shippingAddress: {\n  //         contactName: req.user?.name + \"\" + req.user?.surname,\n  //         city: req.user?.city,\n  //         country: req.user?.country,\n  //         address: req.user?.address,\n  //         zipCode: req.user?.zipCode,\n  //       },\n  //       billingAddress: {\n  //         contactName: req.user?.name + \"\" + req.user?.surname,\n  //         city: req.user?.city,\n  //         country: req.user?.country,\n  //         address: req.user?.address,\n  //         zipCode: req.user?.zipCode,\n  //       },\n  //       basketItems: cart.products.map((product, index) => {\n  //         return {\n  //           id: String(product?._id),\n  //           name: product?.name,\n  //           category1: product.categories[0],\n  //           category2: product.categories[1],\n  //           itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n  //           price: product?.price,\n  //         };\n  //       }),\n  //     };\n\n  //     let result = await Payments.createPayment(data);\n  //     await CompletePayment(result);\n  //     res.json(result);\n  //   }\n  // );\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1733223942299},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/payments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _iyzipay = _interopRequireDefault(require(\"iyzipay\"));\nvar _moment = _interopRequireDefault(require(\"moment\"));\nvar _cart = _interopRequireDefault(require(\"../db/cart\"));\nvar _products = _interopRequireDefault(require(\"../db/products\"));\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _RequiredCheck = require(\"../helpers/RequiredCheck\");\nvar _OrderCompleteMail = _interopRequireDefault(require(\"../middlewares/OrderCompleteMail\"));\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nvar Cards = _interopRequireWildcard(require(\"../services/iyzico/methods/cards\"));\nvar Payments = _interopRequireWildcard(require(\"../services/iyzico/methods/payments\"));\nvar _payments2 = require(\"../utils/payments\");\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function (e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = router => {\n  /*çalışıyor*/router.post(\"/payments/:cartId/with-new-card\", _Session.default, async (req, res, next) => {\n    const {\n      card\n    } = req.body;\n    // if (!card) {\n    //   throw new ApiError(\"Card is required\", 400, \"cardRequired\");\n    // }\n    (0, _RequiredCheck.checkRequiredField)(card, \"Card\");\n    (0, _RequiredCheck.checkRequiredField)(req.params?.cartId, \"CartId\");\n    // if (!req.params?.cartId) {\n    //   throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n    // }\n    const cart = await _cart.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    card.registerCard = \"0\"; //methodslarda registerCard:1 yani kartı kaydet demek ama şuan kaydetme dediğim için 0 yaptım\n\n    // Ürün bilgilerini getirme (Cart'taki productId'leri kullanarak)\n    const productIds = cart.products.map(item => item.productId);\n    const products = await _products.default.find({\n      _id: {\n        $in: productIds\n      }\n    }).populate(\"seller\");\n\n    // Ürün bilgilerini cart'a ekliyoruz\n    const enrichedProducts = cart.products.map(cartProduct => {\n      const productDetail = products.find(product => String(product._id) === String(cartProduct.productId));\n      return {\n        ...cartProduct._doc,\n        productDetail\n      };\n    });\n\n    // Ödenecek miktar hesaplama\n    // const paidPrice = enrichedProducts\n    //   .map((product) => product.productDetail.price * product.quantity)\n    //   .reduce((a, b) => a + b, 0);\n\n    const paidPrice = enrichedProducts.reduce((acc, product) => acc + product.productDetail.price * product.quantity, 0).toFixed(2);\n    const basketItems = enrichedProducts.map(cartProduct => {\n      const product = cartProduct.productDetail;\n      // Log subMerchantKey to ensure it's present\n      console.log(`Processing product: ${product.name}`);\n      console.log(`subMerchantKey: ${product.seller.subMerchantKey}`);\n      return {\n        id: String(product?._id),\n        name: product?.name,\n        category1: product?.categories?.[0] || \"Uncategorized\",\n        category2: product?.categories?.[1] || \"\",\n        itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n        price: (product?.price * cartProduct.quantity).toFixed(2),\n        // Birim fiyatı çarpıyoruz ve virgülden sonra 2 basamak tutuyoruz\n        subMerchantKey: product?.seller?.subMerchantKey,\n        subMerchantPrice: (product.price * cartProduct.quantity * 0.9).toFixed(2)\n      };\n    });\n    console.log(\"Final basketItems array:\", basketItems);\n\n    // Sepetteki ürünlerin toplam fiyatını hesaplıyoruz\n    const basketTotal = basketItems.reduce((acc, item) => acc + parseFloat(item.price), 0).toFixed(2); // Fiyatları alıp float'a çeviriyoruz\n\n    // Ödeme ve sepet toplamları kontrolü\n    if (basketTotal !== paidPrice) {\n      console.log(basketTotal);\n      throw new _ApiError.default(\"Gönderilen tutar tüm kırılımların toplam tutarına eşit olmalıdır\", 400, \"priceMismatch\");\n    }\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: basketTotal,\n      //toFixed(2) vardı\n      paidPrice: basketTotal,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems\n    };\n    try {\n      let result = await Payments.createPayment(data);\n      await (0, _payments2.CompletePayment)(result);\n\n      // Ürün stoklarını güncelleme\n      const productStockUpdates = {};\n\n      // Sepetteki ürünleri döngüyle işleyerek aynı ürünlerden kaç tane olduğunu hesapla\n      for (const cartProduct of cart.products) {\n        const productId = String(cartProduct.productId); // Doğru ürün ID'si buradan alınmalı\n        const quantity = cartProduct.quantity; // Sepetteki miktar\n\n        if (productStockUpdates[productId]) {\n          productStockUpdates[productId] += quantity;\n        } else {\n          productStockUpdates[productId] = quantity;\n        }\n      }\n\n      // Stokları güncelle\n      for (const productId in productStockUpdates) {\n        const quantityToDecrease = productStockUpdates[productId];\n        await _products.default.updateOne({\n          _id: productId\n        }, {\n          $inc: {\n            stock: -quantityToDecrease\n          }\n        });\n      }\n      await (0, _OrderCompleteMail.default)(req, res);\n      res.json(result);\n    } catch (error) {\n      next(error);\n    }\n  });\n\n  //yeni bir ödeme oluştur ve kart kaydet\n  router.post(\"/payments/:cartId/with-new-card/register-card\", _Session.default, async (req, res) => {\n    const {\n      card\n    } = req.body;\n    if (!card) {\n      throw new _ApiError.default(\"Card is required\", 400, \"cardRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _cart.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    if (req.user?.cardUserKey) {\n      card.cardUserKey = req.user?.cardUserKey;\n    }\n    card.registerCard = \"1\"; //methodslarda registerCard:1 yani kartı kaydet\n\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    let result = await Payments.createPayment(data);\n    if (req.user?.cardUserKey) {\n      const user = await _users.default.findOne({\n        _id: req.user?._id\n      });\n      user.cardUserKey = result?.cardUserKey;\n      await user.save();\n    }\n    await (0, _payments2.CompletePayment)(result);\n    res.json(result);\n  });\n\n  /*çalışıyor*/\n  router.post(\"/payments/:cartId/:cardIndex/with-registered-card-index\", _Session.default, async (req, res, next) => {\n    //çalışıyor bu endpoint\n    let {\n      cardIndex\n    } = req.params;\n    if (!cardIndex) {\n      throw new _ApiError.default(\"Card index is required\", 400, \"cardIndexRequired\");\n    }\n    if (!req.user?.cardUserKey) {\n      throw new _ApiError.default(\"No registered card available\", 400, \"cardUserKeyRequired\");\n    }\n    const cards = await Cards.getUserCards({\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      cardUserKey: req.user?.cardUserKey\n    });\n    const index = parseInt(cardIndex);\n    if (index >= cards?.cardDetails?.length) {\n      throw new _ApiError.default(\"Card does not exist\", 400, \"cardIndexInvalid\");\n    }\n    const {\n      cardToken\n    } = cards?.cardDetails[index];\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n\n    // Cart'ı bul\n    const cart = await _cart.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\"); // Sadece buyer'ı populate ediyoruz.\n\n    if (!cart) {\n      throw new _ApiError.default(\"Cart not found\", 404, \"cartNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n\n    // Ürün bilgilerini getirme (Cart'taki productId'leri kullanarak)\n    const productIds = cart.products.map(item => item.productId);\n    const products = await _products.default.find({\n      _id: {\n        $in: productIds\n      }\n    }).populate(\"seller\");\n\n    // Ürün bilgilerini cart'a ekliyoruz\n    const enrichedProducts = cart.products.map(cartProduct => {\n      const productDetail = products.find(product => String(product._id) === String(cartProduct.productId));\n      return {\n        ...cartProduct._doc,\n        productDetail\n      };\n    });\n\n    // Ödenecek miktar hesaplama\n    const paidPrice = enrichedProducts.reduce((acc, product) => acc + product.productDetail.price * product.quantity, 0).toFixed(2);\n    const basketItems = enrichedProducts.map(cartProduct => {\n      const product = cartProduct.productDetail;\n      console.log(`Processing product: ${product.name}`);\n      console.log(`subMerchantKey: ${product.seller.subMerchantKey}`);\n      return {\n        id: String(product?._id),\n        name: product?.name,\n        category1: product?.categories?.[0] || \"Uncategorized\",\n        category2: product?.categories?.[1] || \"\",\n        itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n        price: (product?.price * cartProduct.quantity).toFixed(2),\n        // Birim fiyatı çarpıyoruz ve virgülden sonra 2 basamak tutuyoruz\n        subMerchantKey: product?.seller?.subMerchantKey,\n        subMerchantPrice: (product.price * cartProduct.quantity * 0.9).toFixed(2)\n      };\n    });\n    console.log(\"Items:\", basketItems);\n\n    // Sepetteki ürünlerin toplam fiyatını hesaplıyoruz\n    const basketTotal = basketItems.reduce((acc, item) => acc + parseFloat(item.price), 0).toFixed(2); // Fiyatları alıp float'a çeviriyoruz\n\n    // Ödeme ve sepet toplamları kontrolü\n    if (basketTotal !== paidPrice) {\n      throw new _ApiError.default(\"Gönderilen tutar tüm kırılımların toplam tutarına eşit olmalıdır\", 400, \"priceMismatch\");\n    }\n\n    // Ödeme verisi\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: basketTotal,\n      // İyzico için yuvarlanmış toplam sepet tutarı\n      paidPrice: basketTotal,\n      // Aynı değeri paidPrice'a da gönderiyoruz\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: {\n        cardToken,\n        cardUserKey: req.user?.cardUserKey\n      },\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationDate: (0, _moment.default)(req.user?.createdAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \" \" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \" \" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems // Doğru hesaplanan sepet öğelerini gönderiyoruz\n    };\n    console.log(data);\n    try {\n      let result = await Payments.createPayment(data);\n      await (0, _payments2.CompletePayment)(result);\n      const productStockUpdates = {};\n\n      // Sepetteki ürünleri döngüyle işleyerek aynı ürünlerden kaç tane olduğunu hesapla\n      for (const cartProduct of cart.products) {\n        const productId = String(cartProduct.productId); // Doğru ürün ID'si buradan alınmalı\n        const quantity = cartProduct.quantity; // Sepetteki miktar\n\n        if (productStockUpdates[productId]) {\n          productStockUpdates[productId] += quantity;\n        } else {\n          productStockUpdates[productId] = quantity;\n        }\n      }\n\n      // Stokları güncelle\n      for (const productId in productStockUpdates) {\n        const quantityToDecrease = productStockUpdates[productId];\n        await _products.default.updateOne({\n          _id: productId\n        }, {\n          $inc: {\n            stock: -quantityToDecrease\n          }\n        });\n      }\n      res.json(result);\n      next();\n    } catch (error) {\n      next(error);\n    }\n  }, _OrderCompleteMail.default, (req, res) => {\n    return res.status(200).json(`${req.user.email} mail adresine sipariş detayı gönderilmiştir.`);\n  });\n  router.post(\"/payments/:cartId/with-registered-card-token\", _Session.default, async (req, res, next) => {\n    // Get cardToken from the request body\n    let {\n      cardToken\n    } = req.body;\n\n    // Ensure cardToken is provided\n    if (!cardToken) {\n      throw new _ApiError.default(\"Card token is required\", 400, \"cardTokenRequired\");\n    }\n\n    // Ensure the user has a registered card (cardUserKey)\n    if (!req.user?.cardUserKey) {\n      throw new _ApiError.default(\"No registered card available\", 400, \"cardUserKeyRequired\");\n    }\n\n    // Ensure cartId is provided in the request params\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n\n    // Find the cart using cartId\n    const cart = await _cart.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\");\n    if (!cart) {\n      throw new _ApiError.default(\"Cart not found\", 404, \"cartNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n\n    // Fetch product details for the cart\n    const productIds = cart.products.map(item => item.productId);\n    const products = await _products.default.find({\n      _id: {\n        $in: productIds\n      }\n    }).populate(\"seller\");\n\n    // Enrich cart with product details\n    const enrichedProducts = cart.products.map(cartProduct => {\n      const productDetail = products.find(product => String(product._id) === String(cartProduct.productId));\n      return {\n        ...cartProduct._doc,\n        productDetail\n      };\n    });\n\n    // Calculate total price\n    const paidPrice = enrichedProducts.reduce((acc, product) => acc + product.productDetail.price * product.quantity, 0).toFixed(2);\n\n    // Create basket items for payment\n    const basketItems = enrichedProducts.map(cartProduct => {\n      const product = cartProduct.productDetail;\n      return {\n        id: String(product?._id),\n        name: product?.name,\n        category1: product?.categories?.[0] || \"Uncategorized\",\n        category2: product?.categories?.[1] || \"\",\n        itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n        price: (product?.price * cartProduct.quantity).toFixed(2),\n        subMerchantKey: product?.seller?.subMerchantKey,\n        subMerchantPrice: (product.price * cartProduct.quantity * 0.9).toFixed(2)\n      };\n    });\n    const basketTotal = basketItems.reduce((acc, item) => acc + parseFloat(item.price), 0).toFixed(2);\n    if (basketTotal !== paidPrice) {\n      throw new _ApiError.default(\"Gönderilen tutar tüm kırılımların toplam tutarına eşit olmalıdır\", 400, \"priceMismatch\");\n    }\n\n    // Prepare payment data\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: basketTotal,\n      paidPrice: basketTotal,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: {\n        cardToken,\n        cardUserKey: req.user?.cardUserKey\n      },\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationDate: (0, _moment.default)(req.user?.createdAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \" \" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \" \" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems\n    };\n    try {\n      // Process payment\n      let result = await Payments.createPayment(data);\n      await (0, _payments2.CompletePayment)(result);\n      const productStockUpdates = {};\n\n      // Update stock for each product\n      for (const cartProduct of cart.products) {\n        const productId = String(cartProduct.productId);\n        const quantity = cartProduct.quantity;\n        if (productStockUpdates[productId]) {\n          productStockUpdates[productId] += quantity;\n        } else {\n          productStockUpdates[productId] = quantity;\n        }\n      }\n\n      // Decrease stock based on the quantities\n      for (const productId in productStockUpdates) {\n        const quantityToDecrease = productStockUpdates[productId];\n        await _products.default.updateOne({\n          _id: productId\n        }, {\n          $inc: {\n            stock: -quantityToDecrease\n          }\n        });\n      }\n      res.json(result);\n      next();\n    } catch (error) {\n      next(error);\n    }\n  }, _OrderCompleteMail.default, (req, res) => {\n    return res.status(200).json(`${req.user.email} mail adresine sipariş detayı gönderilmiştir.`);\n  });\n\n  // router.post(\n  //   \"/payments/:cartId/with-registered-card-token\",\n  //   Session,\n  //   async (req, res) => {\n  //     let { cardToken } = req.body;\n  //     if (!cardToken) {\n  //       throw new ApiError(\"Card Token is required\", 400, \"cardTokenRequired\");\n  //     }\n  //     if (!req.user?.cardUserKey) {\n  //       throw new ApiError(\n  //         \"No registered card available\",\n  //         400,\n  //         \"cardUserKeyRequired\"\n  //       );\n  //     }\n\n  //     if (!req.params?.cartId) {\n  //       throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n  //     }\n  //     const cart = await Carts.findOne({ _id: req.params?.cartId })\n  //       .populate(\"buyer\")\n  //       .populate(\"products\");\n  //     if (!cart) {\n  //       throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n  //     }\n  //     if (cart?.completed) {\n  //       throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n  //     }\n\n  //     const paidPrice = cart.products\n  //       .map((product) => product.price)\n  //       .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n  //     const card = {\n  //       cardToken,\n  //       cardUserKey: req.user?.cardUserKey,\n  //     };\n\n  //     const data = {\n  //       locale: req.user.locale,\n  //       conversationId: id(),\n  //       price: paidPrice,\n  //       paidPrice: paidPrice,\n  //       currency: Iyzipay.CURRENCY.TRY,\n  //       installments: \"1\",\n  //       basketId: String(cart?._id),\n  //       paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n  //       paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n  //       paymentCard: card,\n  //       buyer: {\n  //         id: String(req.user._id),\n  //         name: req.user?.name,\n  //         surname: req.user?.surname,\n  //         gsmNumber: req.user?.phoneNumber,\n  //         email: req.user?.email,\n  //         identityNumber: req.user?.identityNumber,\n  //         lastLoginDate: moment(req.user?.updatedAt).format(\n  //           \"YYYY-MM-DD HH:mm:ss\"\n  //         ), //iyizpay tarih formatına çevirmek için yapıldı\n  //         registrationDate: moment(req.user?.updatedAt).format(\n  //           \"YYYY-MM-DD HH:mm:ss\"\n  //         ),\n  //         registrationAddress: req.user?.address,\n  //         ip: req.user?.ip,\n  //         city: req.user?.city,\n  //         country: req.user?.country,\n  //         zipCode: req.user?.zipCode,\n  //       },\n  //       shippingAddress: {\n  //         contactName: req.user?.name + \"\" + req.user?.surname,\n  //         city: req.user?.city,\n  //         country: req.user?.country,\n  //         address: req.user?.address,\n  //         zipCode: req.user?.zipCode,\n  //       },\n  //       billingAddress: {\n  //         contactName: req.user?.name + \"\" + req.user?.surname,\n  //         city: req.user?.city,\n  //         country: req.user?.country,\n  //         address: req.user?.address,\n  //         zipCode: req.user?.zipCode,\n  //       },\n  //       basketItems: cart.products.map((product, index) => {\n  //         return {\n  //           id: String(product?._id),\n  //           name: product?.name,\n  //           category1: product.categories[0],\n  //           category2: product.categories[1],\n  //           itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n  //           price: product?.price,\n  //         };\n  //       }),\n  //     };\n\n  //     let result = await Payments.createPayment(data);\n  //     await CompletePayment(result);\n  //     res.json(result);\n  //   }\n  // );\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaXl6aXBheSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX21vbWVudCIsIl9jYXJ0IiwiX3Byb2R1Y3RzIiwiX3VzZXJzIiwiX0FwaUVycm9yIiwiX1JlcXVpcmVkQ2hlY2siLCJfT3JkZXJDb21wbGV0ZU1haWwiLCJfU2Vzc2lvbiIsIkNhcmRzIiwiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJQYXltZW50cyIsIl9wYXltZW50czIiLCJfdXVpZCIsIl9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSIsImUiLCJXZWFrTWFwIiwiciIsInQiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImhhcyIsImdldCIsIm4iLCJfX3Byb3RvX18iLCJhIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJ1IiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiaSIsInNldCIsIl9kZWZhdWx0Iiwicm91dGVyIiwicG9zdCIsIlNlc3Npb24iLCJyZXEiLCJyZXMiLCJuZXh0IiwiY2FyZCIsImJvZHkiLCJjaGVja1JlcXVpcmVkRmllbGQiLCJwYXJhbXMiLCJjYXJ0SWQiLCJjYXJ0IiwiQ2FydHMiLCJmaW5kT25lIiwiX2lkIiwicG9wdWxhdGUiLCJBcGlFcnJvciIsImNvbXBsZXRlZCIsInJlZ2lzdGVyQ2FyZCIsInByb2R1Y3RJZHMiLCJwcm9kdWN0cyIsIm1hcCIsIml0ZW0iLCJwcm9kdWN0SWQiLCJQcm9kdWN0cyIsImZpbmQiLCIkaW4iLCJlbnJpY2hlZFByb2R1Y3RzIiwiY2FydFByb2R1Y3QiLCJwcm9kdWN0RGV0YWlsIiwicHJvZHVjdCIsIlN0cmluZyIsIl9kb2MiLCJwYWlkUHJpY2UiLCJyZWR1Y2UiLCJhY2MiLCJwcmljZSIsInF1YW50aXR5IiwidG9GaXhlZCIsImJhc2tldEl0ZW1zIiwiY29uc29sZSIsImxvZyIsIm5hbWUiLCJzZWxsZXIiLCJzdWJNZXJjaGFudEtleSIsImlkIiwiY2F0ZWdvcnkxIiwiY2F0ZWdvcmllcyIsImNhdGVnb3J5MiIsIml0ZW1UeXBlIiwiSXl6aXBheSIsIkJBU0tFVF9JVEVNX1RZUEUiLCJzdWJNZXJjaGFudFByaWNlIiwiYmFza2V0VG90YWwiLCJwYXJzZUZsb2F0IiwiZGF0YSIsImxvY2FsZSIsInVzZXIiLCJjb252ZXJzYXRpb25JZCIsImN1cnJlbmN5IiwiQ1VSUkVOQ1kiLCJUUlkiLCJpbnN0YWxsbWVudHMiLCJiYXNrZXRJZCIsInBheW1lbnRDaGFubmVsIiwiUEFZTUVOVF9DSEFOTkVMIiwiV0VCIiwicGF5bWVudEdyb3VwIiwiUEFZTUVOVF9HUk9VUCIsIlBST0RVQ1QiLCJwYXltZW50Q2FyZCIsImJ1eWVyIiwic3VybmFtZSIsImdzbU51bWJlciIsInBob25lTnVtYmVyIiwiZW1haWwiLCJpZGVudGl0eU51bWJlciIsImxhc3RMb2dpbkRhdGUiLCJtb21lbnQiLCJ1cGRhdGVkQXQiLCJmb3JtYXQiLCJyZWdpc3RyYXRpb25EYXRlIiwicmVnaXN0cmF0aW9uQWRkcmVzcyIsImFkZHJlc3MiLCJpcCIsImNpdHkiLCJjb3VudHJ5IiwiemlwQ29kZSIsInNoaXBwaW5nQWRkcmVzcyIsImNvbnRhY3ROYW1lIiwiYmlsbGluZ0FkZHJlc3MiLCJyZXN1bHQiLCJjcmVhdGVQYXltZW50IiwiQ29tcGxldGVQYXltZW50IiwicHJvZHVjdFN0b2NrVXBkYXRlcyIsInF1YW50aXR5VG9EZWNyZWFzZSIsInVwZGF0ZU9uZSIsIiRpbmMiLCJzdG9jayIsIk9yZGVyQ29tcGxldGVNYWlsIiwianNvbiIsImVycm9yIiwiY2FyZFVzZXJLZXkiLCJiIiwiaW5kZXgiLCJVc2VycyIsInNhdmUiLCJjYXJkSW5kZXgiLCJjYXJkcyIsImdldFVzZXJDYXJkcyIsInBhcnNlSW50IiwiY2FyZERldGFpbHMiLCJsZW5ndGgiLCJjYXJkVG9rZW4iLCJjcmVhdGVkQXQiLCJzdGF0dXMiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvcm91dGVzLyIsInNvdXJjZXMiOlsicGF5bWVudHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEl5emlwYXkgZnJvbSBcIml5emlwYXlcIjtcbmltcG9ydCBtb21lbnQgZnJvbSBcIm1vbWVudFwiO1xuaW1wb3J0IENhcnRzIGZyb20gXCIuLi9kYi9jYXJ0XCI7XG5pbXBvcnQgUHJvZHVjdHMgZnJvbSBcIi4uL2RiL3Byb2R1Y3RzXCI7XG5pbXBvcnQgVXNlcnMgZnJvbSBcIi4uL2RiL3VzZXJzXCI7XG5pbXBvcnQgQXBpRXJyb3IgZnJvbSBcIi4uL2Vycm9ycy9BcGlFcnJvclwiO1xuaW1wb3J0IHsgY2hlY2tSZXF1aXJlZEZpZWxkIH0gZnJvbSBcIi4uL2hlbHBlcnMvUmVxdWlyZWRDaGVja1wiO1xuaW1wb3J0IE9yZGVyQ29tcGxldGVNYWlsIGZyb20gXCIuLi9taWRkbGV3YXJlcy9PcmRlckNvbXBsZXRlTWFpbFwiO1xuaW1wb3J0IFNlc3Npb24gZnJvbSBcIi4uL21pZGRsZXdhcmVzL1Nlc3Npb25cIjtcbmltcG9ydCAqIGFzIENhcmRzIGZyb20gXCIuLi9zZXJ2aWNlcy9peXppY28vbWV0aG9kcy9jYXJkc1wiO1xuaW1wb3J0ICogYXMgUGF5bWVudHMgZnJvbSBcIi4uL3NlcnZpY2VzL2l5emljby9tZXRob2RzL3BheW1lbnRzXCI7XG5pbXBvcnQgeyBDb21wbGV0ZVBheW1lbnQgfSBmcm9tIFwiLi4vdXRpbHMvcGF5bWVudHNcIjtcbmltcG9ydCBpZCBmcm9tIFwiLi4vdXRpbHMvdXVpZFwiO1xuXG5leHBvcnQgZGVmYXVsdCAocm91dGVyKSA9PiB7XG4gIC8qw6dhbMSxxZ/EsXlvciovIHJvdXRlci5wb3N0KFxuICAgIFwiL3BheW1lbnRzLzpjYXJ0SWQvd2l0aC1uZXctY2FyZFwiLFxuICAgIFNlc3Npb24sXG4gICAgYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgICBjb25zdCB7IGNhcmQgfSA9IHJlcS5ib2R5O1xuICAgICAgLy8gaWYgKCFjYXJkKSB7XG4gICAgICAvLyAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgaXMgcmVxdWlyZWRcIiwgNDAwLCBcImNhcmRSZXF1aXJlZFwiKTtcbiAgICAgIC8vIH1cbiAgICAgIGNoZWNrUmVxdWlyZWRGaWVsZChjYXJkLCBcIkNhcmRcIik7XG4gICAgICBjaGVja1JlcXVpcmVkRmllbGQocmVxLnBhcmFtcz8uY2FydElkLCBcIkNhcnRJZFwiKTtcbiAgICAgIC8vIGlmICghcmVxLnBhcmFtcz8uY2FydElkKSB7XG4gICAgICAvLyAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnRJRCBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FydElkUmVxdWlyZWRcIik7XG4gICAgICAvLyB9XG4gICAgICBjb25zdCBjYXJ0ID0gYXdhaXQgQ2FydHMuZmluZE9uZSh7IF9pZDogcmVxLnBhcmFtcz8uY2FydElkIH0pXG4gICAgICAgIC5wb3B1bGF0ZShcImJ1eWVyXCIpXG4gICAgICAgIC5wb3B1bGF0ZShcInByb2R1Y3RzXCIpO1xuICAgICAgaWYgKCFjYXJ0KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgbm90IGZvdW5kXCIsIDQwNCwgXCJjYXJkTm90Rm91bmRcIik7XG4gICAgICB9XG4gICAgICBpZiAoY2FydD8uY29tcGxldGVkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgaXMgY29tcGxldGVkXCIsIDQwMCwgXCJjYXJ0Q29tcGxldGVkXCIpO1xuICAgICAgfVxuXG4gICAgICBjYXJkLnJlZ2lzdGVyQ2FyZCA9IFwiMFwiOyAvL21ldGhvZHNsYXJkYSByZWdpc3RlckNhcmQ6MSB5YW5pIGthcnTEsSBrYXlkZXQgZGVtZWsgYW1hIMWfdWFuIGtheWRldG1lIGRlZGnEn2ltIGnDp2luIDAgeWFwdMSxbVxuXG4gICAgICAvLyDDnHLDvG4gYmlsZ2lsZXJpbmkgZ2V0aXJtZSAoQ2FydCd0YWtpIHByb2R1Y3RJZCdsZXJpIGt1bGxhbmFyYWspXG4gICAgICBjb25zdCBwcm9kdWN0SWRzID0gY2FydC5wcm9kdWN0cy5tYXAoKGl0ZW0pID0+IGl0ZW0ucHJvZHVjdElkKTtcbiAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgUHJvZHVjdHMuZmluZCh7XG4gICAgICAgIF9pZDogeyAkaW46IHByb2R1Y3RJZHMgfSxcbiAgICAgIH0pLnBvcHVsYXRlKFwic2VsbGVyXCIpO1xuXG4gICAgICAvLyDDnHLDvG4gYmlsZ2lsZXJpbmkgY2FydCdhIGVrbGl5b3J1elxuICAgICAgY29uc3QgZW5yaWNoZWRQcm9kdWN0cyA9IGNhcnQucHJvZHVjdHMubWFwKChjYXJ0UHJvZHVjdCkgPT4ge1xuICAgICAgICBjb25zdCBwcm9kdWN0RGV0YWlsID0gcHJvZHVjdHMuZmluZChcbiAgICAgICAgICAocHJvZHVjdCkgPT4gU3RyaW5nKHByb2R1Y3QuX2lkKSA9PT0gU3RyaW5nKGNhcnRQcm9kdWN0LnByb2R1Y3RJZClcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAuLi5jYXJ0UHJvZHVjdC5fZG9jLFxuICAgICAgICAgIHByb2R1Y3REZXRhaWwsXG4gICAgICAgIH07XG4gICAgICB9KTtcblxuICAgICAgLy8gw5ZkZW5lY2VrIG1pa3RhciBoZXNhcGxhbWFcbiAgICAgIC8vIGNvbnN0IHBhaWRQcmljZSA9IGVucmljaGVkUHJvZHVjdHNcbiAgICAgIC8vICAgLm1hcCgocHJvZHVjdCkgPT4gcHJvZHVjdC5wcm9kdWN0RGV0YWlsLnByaWNlICogcHJvZHVjdC5xdWFudGl0eSlcbiAgICAgIC8vICAgLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApO1xuXG4gICAgICBjb25zdCBwYWlkUHJpY2UgPSBlbnJpY2hlZFByb2R1Y3RzXG4gICAgICAgIC5yZWR1Y2UoXG4gICAgICAgICAgKGFjYywgcHJvZHVjdCkgPT5cbiAgICAgICAgICAgIGFjYyArIHByb2R1Y3QucHJvZHVjdERldGFpbC5wcmljZSAqIHByb2R1Y3QucXVhbnRpdHksXG4gICAgICAgICAgMFxuICAgICAgICApXG4gICAgICAgIC50b0ZpeGVkKDIpO1xuXG4gICAgICBjb25zdCBiYXNrZXRJdGVtcyA9IGVucmljaGVkUHJvZHVjdHMubWFwKChjYXJ0UHJvZHVjdCkgPT4ge1xuICAgICAgICBjb25zdCBwcm9kdWN0ID0gY2FydFByb2R1Y3QucHJvZHVjdERldGFpbDtcbiAgICAgICAgLy8gTG9nIHN1Yk1lcmNoYW50S2V5IHRvIGVuc3VyZSBpdCdzIHByZXNlbnRcbiAgICAgICAgY29uc29sZS5sb2coYFByb2Nlc3NpbmcgcHJvZHVjdDogJHtwcm9kdWN0Lm5hbWV9YCk7XG4gICAgICAgIGNvbnNvbGUubG9nKGBzdWJNZXJjaGFudEtleTogJHtwcm9kdWN0LnNlbGxlci5zdWJNZXJjaGFudEtleX1gKTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGlkOiBTdHJpbmcocHJvZHVjdD8uX2lkKSxcbiAgICAgICAgICBuYW1lOiBwcm9kdWN0Py5uYW1lLFxuICAgICAgICAgIGNhdGVnb3J5MTogcHJvZHVjdD8uY2F0ZWdvcmllcz8uWzBdIHx8IFwiVW5jYXRlZ29yaXplZFwiLFxuICAgICAgICAgIGNhdGVnb3J5MjogcHJvZHVjdD8uY2F0ZWdvcmllcz8uWzFdIHx8IFwiXCIsXG4gICAgICAgICAgaXRlbVR5cGU6IEl5emlwYXkuQkFTS0VUX0lURU1fVFlQRVtwcm9kdWN0Py5pdGVtVHlwZV0sXG4gICAgICAgICAgcHJpY2U6IChwcm9kdWN0Py5wcmljZSAqIGNhcnRQcm9kdWN0LnF1YW50aXR5KS50b0ZpeGVkKDIpLCAvLyBCaXJpbSBmaXlhdMSxIMOnYXJwxLF5b3J1eiB2ZSB2aXJnw7xsZGVuIHNvbnJhIDIgYmFzYW1hayB0dXR1eW9ydXpcbiAgICAgICAgICBzdWJNZXJjaGFudEtleTogcHJvZHVjdD8uc2VsbGVyPy5zdWJNZXJjaGFudEtleSxcbiAgICAgICAgICBzdWJNZXJjaGFudFByaWNlOiAoXG4gICAgICAgICAgICBwcm9kdWN0LnByaWNlICpcbiAgICAgICAgICAgIGNhcnRQcm9kdWN0LnF1YW50aXR5ICpcbiAgICAgICAgICAgIDAuOVxuICAgICAgICAgICkudG9GaXhlZCgyKSxcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgICAgY29uc29sZS5sb2coXCJGaW5hbCBiYXNrZXRJdGVtcyBhcnJheTpcIiwgYmFza2V0SXRlbXMpO1xuXG4gICAgICAvLyBTZXBldHRla2kgw7xyw7xubGVyaW4gdG9wbGFtIGZpeWF0xLFuxLEgaGVzYXBsxLF5b3J1elxuICAgICAgY29uc3QgYmFza2V0VG90YWwgPSBiYXNrZXRJdGVtc1xuICAgICAgICAucmVkdWNlKChhY2MsIGl0ZW0pID0+IGFjYyArIHBhcnNlRmxvYXQoaXRlbS5wcmljZSksIDApXG4gICAgICAgIC50b0ZpeGVkKDIpOyAvLyBGaXlhdGxhcsSxIGFsxLFwIGZsb2F0J2Egw6dldmlyaXlvcnV6XG5cbiAgICAgIC8vIMOWZGVtZSB2ZSBzZXBldCB0b3BsYW1sYXLEsSBrb250cm9sw7xcbiAgICAgIGlmIChiYXNrZXRUb3RhbCAhPT0gcGFpZFByaWNlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGJhc2tldFRvdGFsKTtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIFwiR8O2bmRlcmlsZW4gdHV0YXIgdMO8bSBrxLFyxLFsxLFtbGFyxLFuIHRvcGxhbSB0dXRhcsSxbmEgZcWfaXQgb2xtYWzEsWTEsXJcIixcbiAgICAgICAgICA0MDAsXG4gICAgICAgICAgXCJwcmljZU1pc21hdGNoXCJcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZGF0YSA9IHtcbiAgICAgICAgbG9jYWxlOiByZXEudXNlci5sb2NhbGUsXG4gICAgICAgIGNvbnZlcnNhdGlvbklkOiBpZCgpLFxuICAgICAgICBwcmljZTogYmFza2V0VG90YWwsIC8vdG9GaXhlZCgyKSB2YXJkxLFcbiAgICAgICAgcGFpZFByaWNlOiBiYXNrZXRUb3RhbCxcbiAgICAgICAgY3VycmVuY3k6IEl5emlwYXkuQ1VSUkVOQ1kuVFJZLFxuICAgICAgICBpbnN0YWxsbWVudHM6IFwiMVwiLFxuICAgICAgICBiYXNrZXRJZDogU3RyaW5nKGNhcnQ/Ll9pZCksXG4gICAgICAgIHBheW1lbnRDaGFubmVsOiBJeXppcGF5LlBBWU1FTlRfQ0hBTk5FTC5XRUIsXG4gICAgICAgIHBheW1lbnRHcm91cDogSXl6aXBheS5QQVlNRU5UX0dST1VQLlBST0RVQ1QsXG4gICAgICAgIHBheW1lbnRDYXJkOiBjYXJkLFxuICAgICAgICBidXllcjoge1xuICAgICAgICAgIGlkOiBTdHJpbmcocmVxLnVzZXIuX2lkKSxcbiAgICAgICAgICBuYW1lOiByZXEudXNlcj8ubmFtZSxcbiAgICAgICAgICBzdXJuYW1lOiByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBnc21OdW1iZXI6IHJlcS51c2VyPy5waG9uZU51bWJlcixcbiAgICAgICAgICBlbWFpbDogcmVxLnVzZXI/LmVtYWlsLFxuICAgICAgICAgIGlkZW50aXR5TnVtYmVyOiByZXEudXNlcj8uaWRlbnRpdHlOdW1iZXIsXG4gICAgICAgICAgbGFzdExvZ2luRGF0ZTogbW9tZW50KHJlcS51c2VyPy51cGRhdGVkQXQpLmZvcm1hdChcbiAgICAgICAgICAgIFwiWVlZWS1NTS1ERCBISDptbTpzc1wiXG4gICAgICAgICAgKSwgLy9peWl6cGF5IHRhcmloIGZvcm1hdMSxbmEgw6dldmlybWVrIGnDp2luIHlhcMSxbGTEsVxuICAgICAgICAgIHJlZ2lzdHJhdGlvbkRhdGU6IG1vbWVudChyZXEudXNlcj8udXBkYXRlZEF0KS5mb3JtYXQoXG4gICAgICAgICAgICBcIllZWVktTU0tREQgSEg6bW06c3NcIlxuICAgICAgICAgICksXG4gICAgICAgICAgcmVnaXN0cmF0aW9uQWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgaXA6IHJlcS51c2VyPy5pcCxcbiAgICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgICAgfSxcbiAgICAgICAgc2hpcHBpbmdBZGRyZXNzOiB7XG4gICAgICAgICAgY29udGFjdE5hbWU6IHJlcS51c2VyPy5uYW1lICsgXCJcIiArIHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIGFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBiaWxsaW5nQWRkcmVzczoge1xuICAgICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiXCIgKyByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgICBhZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgICAgfSxcbiAgICAgICAgYmFza2V0SXRlbXMsXG4gICAgICB9O1xuXG4gICAgICB0cnkge1xuICAgICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgUGF5bWVudHMuY3JlYXRlUGF5bWVudChkYXRhKTtcbiAgICAgICAgYXdhaXQgQ29tcGxldGVQYXltZW50KHJlc3VsdCk7XG5cbiAgICAgICAgLy8gw5xyw7xuIHN0b2tsYXLEsW7EsSBnw7xuY2VsbGVtZVxuICAgICAgICBjb25zdCBwcm9kdWN0U3RvY2tVcGRhdGVzID0ge307XG5cbiAgICAgICAgLy8gU2VwZXR0ZWtpIMO8csO8bmxlcmkgZMO2bmfDvHlsZSBpxZ9sZXllcmVrIGF5bsSxIMO8csO8bmxlcmRlbiBrYcOnIHRhbmUgb2xkdcSfdW51IGhlc2FwbGFcbiAgICAgICAgZm9yIChjb25zdCBjYXJ0UHJvZHVjdCBvZiBjYXJ0LnByb2R1Y3RzKSB7XG4gICAgICAgICAgY29uc3QgcHJvZHVjdElkID0gU3RyaW5nKGNhcnRQcm9kdWN0LnByb2R1Y3RJZCk7IC8vIERvxJ9ydSDDvHLDvG4gSUQnc2kgYnVyYWRhbiBhbMSxbm1hbMSxXG4gICAgICAgICAgY29uc3QgcXVhbnRpdHkgPSBjYXJ0UHJvZHVjdC5xdWFudGl0eTsgLy8gU2VwZXR0ZWtpIG1pa3RhclxuXG4gICAgICAgICAgaWYgKHByb2R1Y3RTdG9ja1VwZGF0ZXNbcHJvZHVjdElkXSkge1xuICAgICAgICAgICAgcHJvZHVjdFN0b2NrVXBkYXRlc1twcm9kdWN0SWRdICs9IHF1YW50aXR5O1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwcm9kdWN0U3RvY2tVcGRhdGVzW3Byb2R1Y3RJZF0gPSBxdWFudGl0eTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvLyBTdG9rbGFyxLEgZ8O8bmNlbGxlXG4gICAgICAgIGZvciAoY29uc3QgcHJvZHVjdElkIGluIHByb2R1Y3RTdG9ja1VwZGF0ZXMpIHtcbiAgICAgICAgICBjb25zdCBxdWFudGl0eVRvRGVjcmVhc2UgPSBwcm9kdWN0U3RvY2tVcGRhdGVzW3Byb2R1Y3RJZF07XG4gICAgICAgICAgYXdhaXQgUHJvZHVjdHMudXBkYXRlT25lKFxuICAgICAgICAgICAgeyBfaWQ6IHByb2R1Y3RJZCB9LFxuICAgICAgICAgICAgeyAkaW5jOiB7IHN0b2NrOiAtcXVhbnRpdHlUb0RlY3JlYXNlIH0gfVxuICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICBhd2FpdCBPcmRlckNvbXBsZXRlTWFpbChyZXEsIHJlcyk7XG4gICAgICAgIHJlcy5qc29uKHJlc3VsdCk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBuZXh0KGVycm9yKTtcbiAgICAgIH1cbiAgICB9XG4gICk7XG5cbiAgLy95ZW5pIGJpciDDtmRlbWUgb2x1xZ90dXIgdmUga2FydCBrYXlkZXRcbiAgcm91dGVyLnBvc3QoXG4gICAgXCIvcGF5bWVudHMvOmNhcnRJZC93aXRoLW5ldy1jYXJkL3JlZ2lzdGVyLWNhcmRcIixcbiAgICBTZXNzaW9uLFxuICAgIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgICAgY29uc3QgeyBjYXJkIH0gPSByZXEuYm9keTtcbiAgICAgIGlmICghY2FyZCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIGlzIHJlcXVpcmVkXCIsIDQwMCwgXCJjYXJkUmVxdWlyZWRcIik7XG4gICAgICB9XG4gICAgICBpZiAoIXJlcS5wYXJhbXM/LmNhcnRJZCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJ0SUQgaXMgcmVxdWlyZWRcIiwgNDAwLCBcImNhcnRJZFJlcXVpcmVkXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgY2FydCA9IGF3YWl0IENhcnRzLmZpbmRPbmUoeyBfaWQ6IHJlcS5wYXJhbXM/LmNhcnRJZCB9KVxuICAgICAgICAucG9wdWxhdGUoXCJidXllclwiKVxuICAgICAgICAucG9wdWxhdGUoXCJwcm9kdWN0c1wiKTtcbiAgICAgIGlmICghY2FydCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIG5vdCBmb3VuZFwiLCA0MDQsIFwiY2FyZE5vdEZvdW5kXCIpO1xuICAgICAgfVxuICAgICAgaWYgKGNhcnQ/LmNvbXBsZXRlZCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJ0IGlzIGNvbXBsZXRlZFwiLCA0MDAsIFwiY2FydENvbXBsZXRlZFwiKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHJlcS51c2VyPy5jYXJkVXNlcktleSkge1xuICAgICAgICBjYXJkLmNhcmRVc2VyS2V5ID0gcmVxLnVzZXI/LmNhcmRVc2VyS2V5O1xuICAgICAgfVxuICAgICAgY2FyZC5yZWdpc3RlckNhcmQgPSBcIjFcIjsgLy9tZXRob2RzbGFyZGEgcmVnaXN0ZXJDYXJkOjEgeWFuaSBrYXJ0xLEga2F5ZGV0XG5cbiAgICAgIGNvbnN0IHBhaWRQcmljZSA9IGNhcnQucHJvZHVjdHNcbiAgICAgICAgLm1hcCgocHJvZHVjdCkgPT4gcHJvZHVjdC5wcmljZSlcbiAgICAgICAgLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApOyAvL8O2ZGVuZWNlayBtaWt0YXJsYXLEsW4gdG9wbGFtxLFcblxuICAgICAgY29uc3QgZGF0YSA9IHtcbiAgICAgICAgbG9jYWxlOiByZXEudXNlci5sb2NhbGUsXG4gICAgICAgIGNvbnZlcnNhdGlvbklkOiBpZCgpLFxuICAgICAgICBwcmljZTogcGFpZFByaWNlLFxuICAgICAgICBwYWlkUHJpY2U6IHBhaWRQcmljZSxcbiAgICAgICAgY3VycmVuY3k6IEl5emlwYXkuQ1VSUkVOQ1kuVFJZLFxuICAgICAgICBpbnN0YWxsbWVudHM6IFwiMVwiLFxuICAgICAgICBiYXNrZXRJZDogU3RyaW5nKGNhcnQ/Ll9pZCksXG4gICAgICAgIHBheW1lbnRDaGFubmVsOiBJeXppcGF5LlBBWU1FTlRfQ0hBTk5FTC5XRUIsXG4gICAgICAgIHBheW1lbnRHcm91cDogSXl6aXBheS5QQVlNRU5UX0dST1VQLlBST0RVQ1QsXG4gICAgICAgIHBheW1lbnRDYXJkOiBjYXJkLFxuICAgICAgICBidXllcjoge1xuICAgICAgICAgIGlkOiBTdHJpbmcocmVxLnVzZXIuX2lkKSxcbiAgICAgICAgICBuYW1lOiByZXEudXNlcj8ubmFtZSxcbiAgICAgICAgICBzdXJuYW1lOiByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBnc21OdW1iZXI6IHJlcS51c2VyPy5waG9uZU51bWJlcixcbiAgICAgICAgICBlbWFpbDogcmVxLnVzZXI/LmVtYWlsLFxuICAgICAgICAgIGlkZW50aXR5TnVtYmVyOiByZXEudXNlcj8uaWRlbnRpdHlOdW1iZXIsXG4gICAgICAgICAgbGFzdExvZ2luRGF0ZTogbW9tZW50KHJlcS51c2VyPy51cGRhdGVkQXQpLmZvcm1hdChcbiAgICAgICAgICAgIFwiWVlZWS1NTS1ERCBISDptbTpzc1wiXG4gICAgICAgICAgKSwgLy9peWl6cGF5IHRhcmloIGZvcm1hdMSxbmEgw6dldmlybWVrIGnDp2luIHlhcMSxbGTEsVxuICAgICAgICAgIHJlZ2lzdHJhdGlvbkRhdGU6IG1vbWVudChyZXEudXNlcj8udXBkYXRlZEF0KS5mb3JtYXQoXG4gICAgICAgICAgICBcIllZWVktTU0tREQgSEg6bW06c3NcIlxuICAgICAgICAgICksXG4gICAgICAgICAgcmVnaXN0cmF0aW9uQWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgaXA6IHJlcS51c2VyPy5pcCxcbiAgICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgICAgfSxcbiAgICAgICAgc2hpcHBpbmdBZGRyZXNzOiB7XG4gICAgICAgICAgY29udGFjdE5hbWU6IHJlcS51c2VyPy5uYW1lICsgXCJcIiArIHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIGFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBiaWxsaW5nQWRkcmVzczoge1xuICAgICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiXCIgKyByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgICBhZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgICAgfSxcbiAgICAgICAgYmFza2V0SXRlbXM6IGNhcnQucHJvZHVjdHMubWFwKChwcm9kdWN0LCBpbmRleCkgPT4ge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpZDogU3RyaW5nKHByb2R1Y3Q/Ll9pZCksXG4gICAgICAgICAgICBuYW1lOiBwcm9kdWN0Py5uYW1lLFxuICAgICAgICAgICAgY2F0ZWdvcnkxOiBwcm9kdWN0LmNhdGVnb3JpZXNbMF0sXG4gICAgICAgICAgICBjYXRlZ29yeTI6IHByb2R1Y3QuY2F0ZWdvcmllc1sxXSxcbiAgICAgICAgICAgIGl0ZW1UeXBlOiBJeXppcGF5LkJBU0tFVF9JVEVNX1RZUEVbcHJvZHVjdD8uaXRlbVR5cGVdLFxuICAgICAgICAgICAgcHJpY2U6IHByb2R1Y3Q/LnByaWNlLFxuICAgICAgICAgIH07XG4gICAgICAgIH0pLFxuICAgICAgfTtcblxuICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IFBheW1lbnRzLmNyZWF0ZVBheW1lbnQoZGF0YSk7XG4gICAgICBpZiAocmVxLnVzZXI/LmNhcmRVc2VyS2V5KSB7XG4gICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2Vycy5maW5kT25lKHsgX2lkOiByZXEudXNlcj8uX2lkIH0pO1xuICAgICAgICB1c2VyLmNhcmRVc2VyS2V5ID0gcmVzdWx0Py5jYXJkVXNlcktleTtcbiAgICAgICAgYXdhaXQgdXNlci5zYXZlKCk7XG4gICAgICB9XG4gICAgICBhd2FpdCBDb21wbGV0ZVBheW1lbnQocmVzdWx0KTtcbiAgICAgIHJlcy5qc29uKHJlc3VsdCk7XG4gICAgfVxuICApO1xuXG4gIC8qw6dhbMSxxZ/EsXlvciovIHJvdXRlci5wb3N0KFxuICAgIFwiL3BheW1lbnRzLzpjYXJ0SWQvOmNhcmRJbmRleC93aXRoLXJlZ2lzdGVyZWQtY2FyZC1pbmRleFwiLFxuICAgIFNlc3Npb24sXG4gICAgYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgICAvL8OnYWzEscWfxLF5b3IgYnUgZW5kcG9pbnRcbiAgICAgIGxldCB7IGNhcmRJbmRleCB9ID0gcmVxLnBhcmFtcztcbiAgICAgIGlmICghY2FyZEluZGV4KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgaW5kZXggaXMgcmVxdWlyZWRcIiwgNDAwLCBcImNhcmRJbmRleFJlcXVpcmVkXCIpO1xuICAgICAgfVxuICAgICAgaWYgKCFyZXEudXNlcj8uY2FyZFVzZXJLZXkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIFwiTm8gcmVnaXN0ZXJlZCBjYXJkIGF2YWlsYWJsZVwiLFxuICAgICAgICAgIDQwMCxcbiAgICAgICAgICBcImNhcmRVc2VyS2V5UmVxdWlyZWRcIlxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBjYXJkcyA9IGF3YWl0IENhcmRzLmdldFVzZXJDYXJkcyh7XG4gICAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgICBjb252ZXJzYXRpb25JZDogaWQoKSxcbiAgICAgICAgY2FyZFVzZXJLZXk6IHJlcS51c2VyPy5jYXJkVXNlcktleSxcbiAgICAgIH0pO1xuICAgICAgY29uc3QgaW5kZXggPSBwYXJzZUludChjYXJkSW5kZXgpO1xuICAgICAgaWYgKGluZGV4ID49IGNhcmRzPy5jYXJkRGV0YWlscz8ubGVuZ3RoKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgZG9lcyBub3QgZXhpc3RcIiwgNDAwLCBcImNhcmRJbmRleEludmFsaWRcIik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGNhcmRUb2tlbiB9ID0gY2FyZHM/LmNhcmREZXRhaWxzW2luZGV4XTtcbiAgICAgIGlmICghcmVxLnBhcmFtcz8uY2FydElkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnRJRCBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FydElkUmVxdWlyZWRcIik7XG4gICAgICB9XG5cbiAgICAgIC8vIENhcnQnxLEgYnVsXG4gICAgICBjb25zdCBjYXJ0ID0gYXdhaXQgQ2FydHMuZmluZE9uZSh7IF9pZDogcmVxLnBhcmFtcz8uY2FydElkIH0pLnBvcHVsYXRlKFxuICAgICAgICBcImJ1eWVyXCJcbiAgICAgICk7IC8vIFNhZGVjZSBidXllcifEsSBwb3B1bGF0ZSBlZGl5b3J1ei5cblxuICAgICAgaWYgKCFjYXJ0KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgbm90IGZvdW5kXCIsIDQwNCwgXCJjYXJ0Tm90Rm91bmRcIik7XG4gICAgICB9XG4gICAgICBpZiAoY2FydD8uY29tcGxldGVkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgaXMgY29tcGxldGVkXCIsIDQwMCwgXCJjYXJ0Q29tcGxldGVkXCIpO1xuICAgICAgfVxuXG4gICAgICAvLyDDnHLDvG4gYmlsZ2lsZXJpbmkgZ2V0aXJtZSAoQ2FydCd0YWtpIHByb2R1Y3RJZCdsZXJpIGt1bGxhbmFyYWspXG4gICAgICBjb25zdCBwcm9kdWN0SWRzID0gY2FydC5wcm9kdWN0cy5tYXAoKGl0ZW0pID0+IGl0ZW0ucHJvZHVjdElkKTtcbiAgICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgUHJvZHVjdHMuZmluZCh7XG4gICAgICAgIF9pZDogeyAkaW46IHByb2R1Y3RJZHMgfSxcbiAgICAgIH0pLnBvcHVsYXRlKFwic2VsbGVyXCIpO1xuXG4gICAgICAvLyDDnHLDvG4gYmlsZ2lsZXJpbmkgY2FydCdhIGVrbGl5b3J1elxuICAgICAgY29uc3QgZW5yaWNoZWRQcm9kdWN0cyA9IGNhcnQucHJvZHVjdHMubWFwKChjYXJ0UHJvZHVjdCkgPT4ge1xuICAgICAgICBjb25zdCBwcm9kdWN0RGV0YWlsID0gcHJvZHVjdHMuZmluZChcbiAgICAgICAgICAocHJvZHVjdCkgPT4gU3RyaW5nKHByb2R1Y3QuX2lkKSA9PT0gU3RyaW5nKGNhcnRQcm9kdWN0LnByb2R1Y3RJZClcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAuLi5jYXJ0UHJvZHVjdC5fZG9jLFxuICAgICAgICAgIHByb2R1Y3REZXRhaWwsXG4gICAgICAgIH07XG4gICAgICB9KTtcblxuICAgICAgLy8gw5ZkZW5lY2VrIG1pa3RhciBoZXNhcGxhbWFcbiAgICAgIGNvbnN0IHBhaWRQcmljZSA9IGVucmljaGVkUHJvZHVjdHNcbiAgICAgICAgLnJlZHVjZShcbiAgICAgICAgICAoYWNjLCBwcm9kdWN0KSA9PlxuICAgICAgICAgICAgYWNjICsgcHJvZHVjdC5wcm9kdWN0RGV0YWlsLnByaWNlICogcHJvZHVjdC5xdWFudGl0eSxcbiAgICAgICAgICAwXG4gICAgICAgIClcbiAgICAgICAgLnRvRml4ZWQoMik7XG5cbiAgICAgIGNvbnN0IGJhc2tldEl0ZW1zID0gZW5yaWNoZWRQcm9kdWN0cy5tYXAoKGNhcnRQcm9kdWN0KSA9PiB7XG4gICAgICAgIGNvbnN0IHByb2R1Y3QgPSBjYXJ0UHJvZHVjdC5wcm9kdWN0RGV0YWlsO1xuICAgICAgICBjb25zb2xlLmxvZyhgUHJvY2Vzc2luZyBwcm9kdWN0OiAke3Byb2R1Y3QubmFtZX1gKTtcbiAgICAgICAgY29uc29sZS5sb2coYHN1Yk1lcmNoYW50S2V5OiAke3Byb2R1Y3Quc2VsbGVyLnN1Yk1lcmNoYW50S2V5fWApO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGlkOiBTdHJpbmcocHJvZHVjdD8uX2lkKSxcbiAgICAgICAgICBuYW1lOiBwcm9kdWN0Py5uYW1lLFxuICAgICAgICAgIGNhdGVnb3J5MTogcHJvZHVjdD8uY2F0ZWdvcmllcz8uWzBdIHx8IFwiVW5jYXRlZ29yaXplZFwiLFxuICAgICAgICAgIGNhdGVnb3J5MjogcHJvZHVjdD8uY2F0ZWdvcmllcz8uWzFdIHx8IFwiXCIsXG4gICAgICAgICAgaXRlbVR5cGU6IEl5emlwYXkuQkFTS0VUX0lURU1fVFlQRVtwcm9kdWN0Py5pdGVtVHlwZV0sXG4gICAgICAgICAgcHJpY2U6IChwcm9kdWN0Py5wcmljZSAqIGNhcnRQcm9kdWN0LnF1YW50aXR5KS50b0ZpeGVkKDIpLCAvLyBCaXJpbSBmaXlhdMSxIMOnYXJwxLF5b3J1eiB2ZSB2aXJnw7xsZGVuIHNvbnJhIDIgYmFzYW1hayB0dXR1eW9ydXpcbiAgICAgICAgICBzdWJNZXJjaGFudEtleTogcHJvZHVjdD8uc2VsbGVyPy5zdWJNZXJjaGFudEtleSxcbiAgICAgICAgICBzdWJNZXJjaGFudFByaWNlOiAoXG4gICAgICAgICAgICBwcm9kdWN0LnByaWNlICpcbiAgICAgICAgICAgIGNhcnRQcm9kdWN0LnF1YW50aXR5ICpcbiAgICAgICAgICAgIDAuOVxuICAgICAgICAgICkudG9GaXhlZCgyKSxcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuICAgICAgY29uc29sZS5sb2coXCJJdGVtczpcIiwgYmFza2V0SXRlbXMpO1xuXG4gICAgICAvLyBTZXBldHRla2kgw7xyw7xubGVyaW4gdG9wbGFtIGZpeWF0xLFuxLEgaGVzYXBsxLF5b3J1elxuICAgICAgY29uc3QgYmFza2V0VG90YWwgPSBiYXNrZXRJdGVtc1xuICAgICAgICAucmVkdWNlKChhY2MsIGl0ZW0pID0+IGFjYyArIHBhcnNlRmxvYXQoaXRlbS5wcmljZSksIDApXG4gICAgICAgIC50b0ZpeGVkKDIpOyAvLyBGaXlhdGxhcsSxIGFsxLFwIGZsb2F0J2Egw6dldmlyaXlvcnV6XG5cbiAgICAgIC8vIMOWZGVtZSB2ZSBzZXBldCB0b3BsYW1sYXLEsSBrb250cm9sw7xcbiAgICAgIGlmIChiYXNrZXRUb3RhbCAhPT0gcGFpZFByaWNlKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgICBcIkfDtm5kZXJpbGVuIHR1dGFyIHTDvG0ga8SxcsSxbMSxbWxhcsSxbiB0b3BsYW0gdHV0YXLEsW5hIGXFn2l0IG9sbWFsxLFkxLFyXCIsXG4gICAgICAgICAgNDAwLFxuICAgICAgICAgIFwicHJpY2VNaXNtYXRjaFwiXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIC8vIMOWZGVtZSB2ZXJpc2lcbiAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgICBjb252ZXJzYXRpb25JZDogaWQoKSxcbiAgICAgICAgcHJpY2U6IGJhc2tldFRvdGFsLCAvLyDEsHl6aWNvIGnDp2luIHl1dmFybGFubcSxxZ8gdG9wbGFtIHNlcGV0IHR1dGFyxLFcbiAgICAgICAgcGFpZFByaWNlOiBiYXNrZXRUb3RhbCwgLy8gQXluxLEgZGXEn2VyaSBwYWlkUHJpY2UnYSBkYSBnw7ZuZGVyaXlvcnV6XG4gICAgICAgIGN1cnJlbmN5OiBJeXppcGF5LkNVUlJFTkNZLlRSWSxcbiAgICAgICAgaW5zdGFsbG1lbnRzOiBcIjFcIixcbiAgICAgICAgYmFza2V0SWQ6IFN0cmluZyhjYXJ0Py5faWQpLFxuICAgICAgICBwYXltZW50Q2hhbm5lbDogSXl6aXBheS5QQVlNRU5UX0NIQU5ORUwuV0VCLFxuICAgICAgICBwYXltZW50R3JvdXA6IEl5emlwYXkuUEFZTUVOVF9HUk9VUC5QUk9EVUNULFxuICAgICAgICBwYXltZW50Q2FyZDoge1xuICAgICAgICAgIGNhcmRUb2tlbixcbiAgICAgICAgICBjYXJkVXNlcktleTogcmVxLnVzZXI/LmNhcmRVc2VyS2V5LFxuICAgICAgICB9LFxuICAgICAgICBidXllcjoge1xuICAgICAgICAgIGlkOiBTdHJpbmcocmVxLnVzZXIuX2lkKSxcbiAgICAgICAgICBuYW1lOiByZXEudXNlcj8ubmFtZSxcbiAgICAgICAgICBzdXJuYW1lOiByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBnc21OdW1iZXI6IHJlcS51c2VyPy5waG9uZU51bWJlcixcbiAgICAgICAgICBlbWFpbDogcmVxLnVzZXI/LmVtYWlsLFxuICAgICAgICAgIGlkZW50aXR5TnVtYmVyOiByZXEudXNlcj8uaWRlbnRpdHlOdW1iZXIsXG4gICAgICAgICAgbGFzdExvZ2luRGF0ZTogbW9tZW50KHJlcS51c2VyPy51cGRhdGVkQXQpLmZvcm1hdChcbiAgICAgICAgICAgIFwiWVlZWS1NTS1ERCBISDptbTpzc1wiXG4gICAgICAgICAgKSxcbiAgICAgICAgICByZWdpc3RyYXRpb25EYXRlOiBtb21lbnQocmVxLnVzZXI/LmNyZWF0ZWRBdCkuZm9ybWF0KFxuICAgICAgICAgICAgXCJZWVlZLU1NLUREIEhIOm1tOnNzXCJcbiAgICAgICAgICApLFxuICAgICAgICAgIHJlZ2lzdHJhdGlvbkFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIGlwOiByZXEudXNlcj8uaXAsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIHNoaXBwaW5nQWRkcmVzczoge1xuICAgICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiIFwiICsgcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgYWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIGJpbGxpbmdBZGRyZXNzOiB7XG4gICAgICAgICAgY29udGFjdE5hbWU6IHJlcS51c2VyPy5uYW1lICsgXCIgXCIgKyByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgICBhZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgICAgfSxcbiAgICAgICAgYmFza2V0SXRlbXMsIC8vIERvxJ9ydSBoZXNhcGxhbmFuIHNlcGV0IMO2xJ9lbGVyaW5pIGfDtm5kZXJpeW9ydXpcbiAgICAgIH07XG4gICAgICBjb25zb2xlLmxvZyhkYXRhKTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IFBheW1lbnRzLmNyZWF0ZVBheW1lbnQoZGF0YSk7XG4gICAgICAgIGF3YWl0IENvbXBsZXRlUGF5bWVudChyZXN1bHQpO1xuXG4gICAgICAgIGNvbnN0IHByb2R1Y3RTdG9ja1VwZGF0ZXMgPSB7fTtcblxuICAgICAgICAvLyBTZXBldHRla2kgw7xyw7xubGVyaSBkw7ZuZ8O8eWxlIGnFn2xleWVyZWsgYXluxLEgw7xyw7xubGVyZGVuIGthw6cgdGFuZSBvbGR1xJ91bnUgaGVzYXBsYVxuICAgICAgICBmb3IgKGNvbnN0IGNhcnRQcm9kdWN0IG9mIGNhcnQucHJvZHVjdHMpIHtcbiAgICAgICAgICBjb25zdCBwcm9kdWN0SWQgPSBTdHJpbmcoY2FydFByb2R1Y3QucHJvZHVjdElkKTsgLy8gRG/En3J1IMO8csO8biBJRCdzaSBidXJhZGFuIGFsxLFubWFsxLFcbiAgICAgICAgICBjb25zdCBxdWFudGl0eSA9IGNhcnRQcm9kdWN0LnF1YW50aXR5OyAvLyBTZXBldHRla2kgbWlrdGFyXG5cbiAgICAgICAgICBpZiAocHJvZHVjdFN0b2NrVXBkYXRlc1twcm9kdWN0SWRdKSB7XG4gICAgICAgICAgICBwcm9kdWN0U3RvY2tVcGRhdGVzW3Byb2R1Y3RJZF0gKz0gcXVhbnRpdHk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHByb2R1Y3RTdG9ja1VwZGF0ZXNbcHJvZHVjdElkXSA9IHF1YW50aXR5O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFN0b2tsYXLEsSBnw7xuY2VsbGVcbiAgICAgICAgZm9yIChjb25zdCBwcm9kdWN0SWQgaW4gcHJvZHVjdFN0b2NrVXBkYXRlcykge1xuICAgICAgICAgIGNvbnN0IHF1YW50aXR5VG9EZWNyZWFzZSA9IHByb2R1Y3RTdG9ja1VwZGF0ZXNbcHJvZHVjdElkXTtcbiAgICAgICAgICBhd2FpdCBQcm9kdWN0cy51cGRhdGVPbmUoXG4gICAgICAgICAgICB7IF9pZDogcHJvZHVjdElkIH0sXG4gICAgICAgICAgICB7ICRpbmM6IHsgc3RvY2s6IC1xdWFudGl0eVRvRGVjcmVhc2UgfSB9XG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJlcy5qc29uKHJlc3VsdCk7XG4gICAgICAgIG5leHQoKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIG5leHQoZXJyb3IpO1xuICAgICAgfVxuICAgIH0sXG4gICAgT3JkZXJDb21wbGV0ZU1haWwsXG4gICAgKHJlcSwgcmVzKSA9PiB7XG4gICAgICByZXR1cm4gcmVzXG4gICAgICAgIC5zdGF0dXMoMjAwKVxuICAgICAgICAuanNvbihgJHtyZXEudXNlci5lbWFpbH0gbWFpbCBhZHJlc2luZSBzaXBhcmnFnyBkZXRhecSxIGfDtm5kZXJpbG1pxZ90aXIuYCk7XG4gICAgfVxuICApO1xuICByb3V0ZXIucG9zdChcbiAgICBcIi9wYXltZW50cy86Y2FydElkL3dpdGgtcmVnaXN0ZXJlZC1jYXJkLXRva2VuXCIsXG4gICAgU2Vzc2lvbixcbiAgICBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICAgIC8vIEdldCBjYXJkVG9rZW4gZnJvbSB0aGUgcmVxdWVzdCBib2R5XG4gICAgICBsZXQgeyBjYXJkVG9rZW4gfSA9IHJlcS5ib2R5O1xuXG4gICAgICAvLyBFbnN1cmUgY2FyZFRva2VuIGlzIHByb3ZpZGVkXG4gICAgICBpZiAoIWNhcmRUb2tlbikge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIHRva2VuIGlzIHJlcXVpcmVkXCIsIDQwMCwgXCJjYXJkVG9rZW5SZXF1aXJlZFwiKTtcbiAgICAgIH1cblxuICAgICAgLy8gRW5zdXJlIHRoZSB1c2VyIGhhcyBhIHJlZ2lzdGVyZWQgY2FyZCAoY2FyZFVzZXJLZXkpXG4gICAgICBpZiAoIXJlcS51c2VyPy5jYXJkVXNlcktleSkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgXCJObyByZWdpc3RlcmVkIGNhcmQgYXZhaWxhYmxlXCIsXG4gICAgICAgICAgNDAwLFxuICAgICAgICAgIFwiY2FyZFVzZXJLZXlSZXF1aXJlZFwiXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIC8vIEVuc3VyZSBjYXJ0SWQgaXMgcHJvdmlkZWQgaW4gdGhlIHJlcXVlc3QgcGFyYW1zXG4gICAgICBpZiAoIXJlcS5wYXJhbXM/LmNhcnRJZCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJ0SUQgaXMgcmVxdWlyZWRcIiwgNDAwLCBcImNhcnRJZFJlcXVpcmVkXCIpO1xuICAgICAgfVxuXG4gICAgICAvLyBGaW5kIHRoZSBjYXJ0IHVzaW5nIGNhcnRJZFxuICAgICAgY29uc3QgY2FydCA9IGF3YWl0IENhcnRzLmZpbmRPbmUoeyBfaWQ6IHJlcS5wYXJhbXM/LmNhcnRJZCB9KS5wb3B1bGF0ZShcbiAgICAgICAgXCJidXllclwiXG4gICAgICApO1xuICAgICAgaWYgKCFjYXJ0KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgbm90IGZvdW5kXCIsIDQwNCwgXCJjYXJ0Tm90Rm91bmRcIik7XG4gICAgICB9XG5cbiAgICAgIGlmIChjYXJ0Py5jb21wbGV0ZWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FydCBpcyBjb21wbGV0ZWRcIiwgNDAwLCBcImNhcnRDb21wbGV0ZWRcIik7XG4gICAgICB9XG5cbiAgICAgIC8vIEZldGNoIHByb2R1Y3QgZGV0YWlscyBmb3IgdGhlIGNhcnRcbiAgICAgIGNvbnN0IHByb2R1Y3RJZHMgPSBjYXJ0LnByb2R1Y3RzLm1hcCgoaXRlbSkgPT4gaXRlbS5wcm9kdWN0SWQpO1xuICAgICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBQcm9kdWN0cy5maW5kKHtcbiAgICAgICAgX2lkOiB7ICRpbjogcHJvZHVjdElkcyB9LFxuICAgICAgfSkucG9wdWxhdGUoXCJzZWxsZXJcIik7XG5cbiAgICAgIC8vIEVucmljaCBjYXJ0IHdpdGggcHJvZHVjdCBkZXRhaWxzXG4gICAgICBjb25zdCBlbnJpY2hlZFByb2R1Y3RzID0gY2FydC5wcm9kdWN0cy5tYXAoKGNhcnRQcm9kdWN0KSA9PiB7XG4gICAgICAgIGNvbnN0IHByb2R1Y3REZXRhaWwgPSBwcm9kdWN0cy5maW5kKFxuICAgICAgICAgIChwcm9kdWN0KSA9PiBTdHJpbmcocHJvZHVjdC5faWQpID09PSBTdHJpbmcoY2FydFByb2R1Y3QucHJvZHVjdElkKVxuICAgICAgICApO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLmNhcnRQcm9kdWN0Ll9kb2MsXG4gICAgICAgICAgcHJvZHVjdERldGFpbCxcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBDYWxjdWxhdGUgdG90YWwgcHJpY2VcbiAgICAgIGNvbnN0IHBhaWRQcmljZSA9IGVucmljaGVkUHJvZHVjdHNcbiAgICAgICAgLnJlZHVjZShcbiAgICAgICAgICAoYWNjLCBwcm9kdWN0KSA9PlxuICAgICAgICAgICAgYWNjICsgcHJvZHVjdC5wcm9kdWN0RGV0YWlsLnByaWNlICogcHJvZHVjdC5xdWFudGl0eSxcbiAgICAgICAgICAwXG4gICAgICAgIClcbiAgICAgICAgLnRvRml4ZWQoMik7XG5cbiAgICAgIC8vIENyZWF0ZSBiYXNrZXQgaXRlbXMgZm9yIHBheW1lbnRcbiAgICAgIGNvbnN0IGJhc2tldEl0ZW1zID0gZW5yaWNoZWRQcm9kdWN0cy5tYXAoKGNhcnRQcm9kdWN0KSA9PiB7XG4gICAgICAgIGNvbnN0IHByb2R1Y3QgPSBjYXJ0UHJvZHVjdC5wcm9kdWN0RGV0YWlsO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGlkOiBTdHJpbmcocHJvZHVjdD8uX2lkKSxcbiAgICAgICAgICBuYW1lOiBwcm9kdWN0Py5uYW1lLFxuICAgICAgICAgIGNhdGVnb3J5MTogcHJvZHVjdD8uY2F0ZWdvcmllcz8uWzBdIHx8IFwiVW5jYXRlZ29yaXplZFwiLFxuICAgICAgICAgIGNhdGVnb3J5MjogcHJvZHVjdD8uY2F0ZWdvcmllcz8uWzFdIHx8IFwiXCIsXG4gICAgICAgICAgaXRlbVR5cGU6IEl5emlwYXkuQkFTS0VUX0lURU1fVFlQRVtwcm9kdWN0Py5pdGVtVHlwZV0sXG4gICAgICAgICAgcHJpY2U6IChwcm9kdWN0Py5wcmljZSAqIGNhcnRQcm9kdWN0LnF1YW50aXR5KS50b0ZpeGVkKDIpLFxuICAgICAgICAgIHN1Yk1lcmNoYW50S2V5OiBwcm9kdWN0Py5zZWxsZXI/LnN1Yk1lcmNoYW50S2V5LFxuICAgICAgICAgIHN1Yk1lcmNoYW50UHJpY2U6IChcbiAgICAgICAgICAgIHByb2R1Y3QucHJpY2UgKlxuICAgICAgICAgICAgY2FydFByb2R1Y3QucXVhbnRpdHkgKlxuICAgICAgICAgICAgMC45XG4gICAgICAgICAgKS50b0ZpeGVkKDIpLFxuICAgICAgICB9O1xuICAgICAgfSk7XG5cbiAgICAgIGNvbnN0IGJhc2tldFRvdGFsID0gYmFza2V0SXRlbXNcbiAgICAgICAgLnJlZHVjZSgoYWNjLCBpdGVtKSA9PiBhY2MgKyBwYXJzZUZsb2F0KGl0ZW0ucHJpY2UpLCAwKVxuICAgICAgICAudG9GaXhlZCgyKTtcblxuICAgICAgaWYgKGJhc2tldFRvdGFsICE9PSBwYWlkUHJpY2UpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIFwiR8O2bmRlcmlsZW4gdHV0YXIgdMO8bSBrxLFyxLFsxLFtbGFyxLFuIHRvcGxhbSB0dXRhcsSxbmEgZcWfaXQgb2xtYWzEsWTEsXJcIixcbiAgICAgICAgICA0MDAsXG4gICAgICAgICAgXCJwcmljZU1pc21hdGNoXCJcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgLy8gUHJlcGFyZSBwYXltZW50IGRhdGFcbiAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgICBjb252ZXJzYXRpb25JZDogaWQoKSxcbiAgICAgICAgcHJpY2U6IGJhc2tldFRvdGFsLFxuICAgICAgICBwYWlkUHJpY2U6IGJhc2tldFRvdGFsLFxuICAgICAgICBjdXJyZW5jeTogSXl6aXBheS5DVVJSRU5DWS5UUlksXG4gICAgICAgIGluc3RhbGxtZW50czogXCIxXCIsXG4gICAgICAgIGJhc2tldElkOiBTdHJpbmcoY2FydD8uX2lkKSxcbiAgICAgICAgcGF5bWVudENoYW5uZWw6IEl5emlwYXkuUEFZTUVOVF9DSEFOTkVMLldFQixcbiAgICAgICAgcGF5bWVudEdyb3VwOiBJeXppcGF5LlBBWU1FTlRfR1JPVVAuUFJPRFVDVCxcbiAgICAgICAgcGF5bWVudENhcmQ6IHtcbiAgICAgICAgICBjYXJkVG9rZW4sXG4gICAgICAgICAgY2FyZFVzZXJLZXk6IHJlcS51c2VyPy5jYXJkVXNlcktleSxcbiAgICAgICAgfSxcbiAgICAgICAgYnV5ZXI6IHtcbiAgICAgICAgICBpZDogU3RyaW5nKHJlcS51c2VyLl9pZCksXG4gICAgICAgICAgbmFtZTogcmVxLnVzZXI/Lm5hbWUsXG4gICAgICAgICAgc3VybmFtZTogcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgZ3NtTnVtYmVyOiByZXEudXNlcj8ucGhvbmVOdW1iZXIsXG4gICAgICAgICAgZW1haWw6IHJlcS51c2VyPy5lbWFpbCxcbiAgICAgICAgICBpZGVudGl0eU51bWJlcjogcmVxLnVzZXI/LmlkZW50aXR5TnVtYmVyLFxuICAgICAgICAgIGxhc3RMb2dpbkRhdGU6IG1vbWVudChyZXEudXNlcj8udXBkYXRlZEF0KS5mb3JtYXQoXG4gICAgICAgICAgICBcIllZWVktTU0tREQgSEg6bW06c3NcIlxuICAgICAgICAgICksXG4gICAgICAgICAgcmVnaXN0cmF0aW9uRGF0ZTogbW9tZW50KHJlcS51c2VyPy5jcmVhdGVkQXQpLmZvcm1hdChcbiAgICAgICAgICAgIFwiWVlZWS1NTS1ERCBISDptbTpzc1wiXG4gICAgICAgICAgKSxcbiAgICAgICAgICByZWdpc3RyYXRpb25BZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICBpcDogcmVxLnVzZXI/LmlwLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBzaGlwcGluZ0FkZHJlc3M6IHtcbiAgICAgICAgICBjb250YWN0TmFtZTogcmVxLnVzZXI/Lm5hbWUgKyBcIiBcIiArIHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIGFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBiaWxsaW5nQWRkcmVzczoge1xuICAgICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiIFwiICsgcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgYWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIGJhc2tldEl0ZW1zLFxuICAgICAgfTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gUHJvY2VzcyBwYXltZW50XG4gICAgICAgIGxldCByZXN1bHQgPSBhd2FpdCBQYXltZW50cy5jcmVhdGVQYXltZW50KGRhdGEpO1xuICAgICAgICBhd2FpdCBDb21wbGV0ZVBheW1lbnQocmVzdWx0KTtcblxuICAgICAgICBjb25zdCBwcm9kdWN0U3RvY2tVcGRhdGVzID0ge307XG5cbiAgICAgICAgLy8gVXBkYXRlIHN0b2NrIGZvciBlYWNoIHByb2R1Y3RcbiAgICAgICAgZm9yIChjb25zdCBjYXJ0UHJvZHVjdCBvZiBjYXJ0LnByb2R1Y3RzKSB7XG4gICAgICAgICAgY29uc3QgcHJvZHVjdElkID0gU3RyaW5nKGNhcnRQcm9kdWN0LnByb2R1Y3RJZCk7XG4gICAgICAgICAgY29uc3QgcXVhbnRpdHkgPSBjYXJ0UHJvZHVjdC5xdWFudGl0eTtcbiAgICAgICAgICBpZiAocHJvZHVjdFN0b2NrVXBkYXRlc1twcm9kdWN0SWRdKSB7XG4gICAgICAgICAgICBwcm9kdWN0U3RvY2tVcGRhdGVzW3Byb2R1Y3RJZF0gKz0gcXVhbnRpdHk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHByb2R1Y3RTdG9ja1VwZGF0ZXNbcHJvZHVjdElkXSA9IHF1YW50aXR5O1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIERlY3JlYXNlIHN0b2NrIGJhc2VkIG9uIHRoZSBxdWFudGl0aWVzXG4gICAgICAgIGZvciAoY29uc3QgcHJvZHVjdElkIGluIHByb2R1Y3RTdG9ja1VwZGF0ZXMpIHtcbiAgICAgICAgICBjb25zdCBxdWFudGl0eVRvRGVjcmVhc2UgPSBwcm9kdWN0U3RvY2tVcGRhdGVzW3Byb2R1Y3RJZF07XG4gICAgICAgICAgYXdhaXQgUHJvZHVjdHMudXBkYXRlT25lKFxuICAgICAgICAgICAgeyBfaWQ6IHByb2R1Y3RJZCB9LFxuICAgICAgICAgICAgeyAkaW5jOiB7IHN0b2NrOiAtcXVhbnRpdHlUb0RlY3JlYXNlIH0gfVxuICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICByZXMuanNvbihyZXN1bHQpO1xuICAgICAgICBuZXh0KCk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBuZXh0KGVycm9yKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIE9yZGVyQ29tcGxldGVNYWlsLFxuICAgIChyZXEsIHJlcykgPT4ge1xuICAgICAgcmV0dXJuIHJlc1xuICAgICAgICAuc3RhdHVzKDIwMClcbiAgICAgICAgLmpzb24oYCR7cmVxLnVzZXIuZW1haWx9IG1haWwgYWRyZXNpbmUgc2lwYXJpxZ8gZGV0YXnEsSBnw7ZuZGVyaWxtacWfdGlyLmApO1xuICAgIH1cbiAgKTtcblxuICAvLyByb3V0ZXIucG9zdChcbiAgLy8gICBcIi9wYXltZW50cy86Y2FydElkL3dpdGgtcmVnaXN0ZXJlZC1jYXJkLXRva2VuXCIsXG4gIC8vICAgU2Vzc2lvbixcbiAgLy8gICBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgLy8gICAgIGxldCB7IGNhcmRUb2tlbiB9ID0gcmVxLmJvZHk7XG4gIC8vICAgICBpZiAoIWNhcmRUb2tlbikge1xuICAvLyAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIFRva2VuIGlzIHJlcXVpcmVkXCIsIDQwMCwgXCJjYXJkVG9rZW5SZXF1aXJlZFwiKTtcbiAgLy8gICAgIH1cbiAgLy8gICAgIGlmICghcmVxLnVzZXI/LmNhcmRVc2VyS2V5KSB7XG4gIC8vICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgLy8gICAgICAgICBcIk5vIHJlZ2lzdGVyZWQgY2FyZCBhdmFpbGFibGVcIixcbiAgLy8gICAgICAgICA0MDAsXG4gIC8vICAgICAgICAgXCJjYXJkVXNlcktleVJlcXVpcmVkXCJcbiAgLy8gICAgICAgKTtcbiAgLy8gICAgIH1cblxuICAvLyAgICAgaWYgKCFyZXEucGFyYW1zPy5jYXJ0SWQpIHtcbiAgLy8gICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FydElEIGlzIHJlcXVpcmVkXCIsIDQwMCwgXCJjYXJ0SWRSZXF1aXJlZFwiKTtcbiAgLy8gICAgIH1cbiAgLy8gICAgIGNvbnN0IGNhcnQgPSBhd2FpdCBDYXJ0cy5maW5kT25lKHsgX2lkOiByZXEucGFyYW1zPy5jYXJ0SWQgfSlcbiAgLy8gICAgICAgLnBvcHVsYXRlKFwiYnV5ZXJcIilcbiAgLy8gICAgICAgLnBvcHVsYXRlKFwicHJvZHVjdHNcIik7XG4gIC8vICAgICBpZiAoIWNhcnQpIHtcbiAgLy8gICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FyZCBub3QgZm91bmRcIiwgNDA0LCBcImNhcmROb3RGb3VuZFwiKTtcbiAgLy8gICAgIH1cbiAgLy8gICAgIGlmIChjYXJ0Py5jb21wbGV0ZWQpIHtcbiAgLy8gICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FydCBpcyBjb21wbGV0ZWRcIiwgNDAwLCBcImNhcnRDb21wbGV0ZWRcIik7XG4gIC8vICAgICB9XG5cbiAgLy8gICAgIGNvbnN0IHBhaWRQcmljZSA9IGNhcnQucHJvZHVjdHNcbiAgLy8gICAgICAgLm1hcCgocHJvZHVjdCkgPT4gcHJvZHVjdC5wcmljZSlcbiAgLy8gICAgICAgLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApOyAvL8O2ZGVuZWNlayBtaWt0YXJsYXLEsW4gdG9wbGFtxLFcblxuICAvLyAgICAgY29uc3QgY2FyZCA9IHtcbiAgLy8gICAgICAgY2FyZFRva2VuLFxuICAvLyAgICAgICBjYXJkVXNlcktleTogcmVxLnVzZXI/LmNhcmRVc2VyS2V5LFxuICAvLyAgICAgfTtcblxuICAvLyAgICAgY29uc3QgZGF0YSA9IHtcbiAgLy8gICAgICAgbG9jYWxlOiByZXEudXNlci5sb2NhbGUsXG4gIC8vICAgICAgIGNvbnZlcnNhdGlvbklkOiBpZCgpLFxuICAvLyAgICAgICBwcmljZTogcGFpZFByaWNlLFxuICAvLyAgICAgICBwYWlkUHJpY2U6IHBhaWRQcmljZSxcbiAgLy8gICAgICAgY3VycmVuY3k6IEl5emlwYXkuQ1VSUkVOQ1kuVFJZLFxuICAvLyAgICAgICBpbnN0YWxsbWVudHM6IFwiMVwiLFxuICAvLyAgICAgICBiYXNrZXRJZDogU3RyaW5nKGNhcnQ/Ll9pZCksXG4gIC8vICAgICAgIHBheW1lbnRDaGFubmVsOiBJeXppcGF5LlBBWU1FTlRfQ0hBTk5FTC5XRUIsXG4gIC8vICAgICAgIHBheW1lbnRHcm91cDogSXl6aXBheS5QQVlNRU5UX0dST1VQLlBST0RVQ1QsXG4gIC8vICAgICAgIHBheW1lbnRDYXJkOiBjYXJkLFxuICAvLyAgICAgICBidXllcjoge1xuICAvLyAgICAgICAgIGlkOiBTdHJpbmcocmVxLnVzZXIuX2lkKSxcbiAgLy8gICAgICAgICBuYW1lOiByZXEudXNlcj8ubmFtZSxcbiAgLy8gICAgICAgICBzdXJuYW1lOiByZXEudXNlcj8uc3VybmFtZSxcbiAgLy8gICAgICAgICBnc21OdW1iZXI6IHJlcS51c2VyPy5waG9uZU51bWJlcixcbiAgLy8gICAgICAgICBlbWFpbDogcmVxLnVzZXI/LmVtYWlsLFxuICAvLyAgICAgICAgIGlkZW50aXR5TnVtYmVyOiByZXEudXNlcj8uaWRlbnRpdHlOdW1iZXIsXG4gIC8vICAgICAgICAgbGFzdExvZ2luRGF0ZTogbW9tZW50KHJlcS51c2VyPy51cGRhdGVkQXQpLmZvcm1hdChcbiAgLy8gICAgICAgICAgIFwiWVlZWS1NTS1ERCBISDptbTpzc1wiXG4gIC8vICAgICAgICAgKSwgLy9peWl6cGF5IHRhcmloIGZvcm1hdMSxbmEgw6dldmlybWVrIGnDp2luIHlhcMSxbGTEsVxuICAvLyAgICAgICAgIHJlZ2lzdHJhdGlvbkRhdGU6IG1vbWVudChyZXEudXNlcj8udXBkYXRlZEF0KS5mb3JtYXQoXG4gIC8vICAgICAgICAgICBcIllZWVktTU0tREQgSEg6bW06c3NcIlxuICAvLyAgICAgICAgICksXG4gIC8vICAgICAgICAgcmVnaXN0cmF0aW9uQWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gIC8vICAgICAgICAgaXA6IHJlcS51c2VyPy5pcCxcbiAgLy8gICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgLy8gICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgLy8gICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgLy8gICAgICAgfSxcbiAgLy8gICAgICAgc2hpcHBpbmdBZGRyZXNzOiB7XG4gIC8vICAgICAgICAgY29udGFjdE5hbWU6IHJlcS51c2VyPy5uYW1lICsgXCJcIiArIHJlcS51c2VyPy5zdXJuYW1lLFxuICAvLyAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAvLyAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAvLyAgICAgICAgIGFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAvLyAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAvLyAgICAgICB9LFxuICAvLyAgICAgICBiaWxsaW5nQWRkcmVzczoge1xuICAvLyAgICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiXCIgKyByZXEudXNlcj8uc3VybmFtZSxcbiAgLy8gICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgLy8gICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgLy8gICAgICAgICBhZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgLy8gICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgLy8gICAgICAgfSxcbiAgLy8gICAgICAgYmFza2V0SXRlbXM6IGNhcnQucHJvZHVjdHMubWFwKChwcm9kdWN0LCBpbmRleCkgPT4ge1xuICAvLyAgICAgICAgIHJldHVybiB7XG4gIC8vICAgICAgICAgICBpZDogU3RyaW5nKHByb2R1Y3Q/Ll9pZCksXG4gIC8vICAgICAgICAgICBuYW1lOiBwcm9kdWN0Py5uYW1lLFxuICAvLyAgICAgICAgICAgY2F0ZWdvcnkxOiBwcm9kdWN0LmNhdGVnb3JpZXNbMF0sXG4gIC8vICAgICAgICAgICBjYXRlZ29yeTI6IHByb2R1Y3QuY2F0ZWdvcmllc1sxXSxcbiAgLy8gICAgICAgICAgIGl0ZW1UeXBlOiBJeXppcGF5LkJBU0tFVF9JVEVNX1RZUEVbcHJvZHVjdD8uaXRlbVR5cGVdLFxuICAvLyAgICAgICAgICAgcHJpY2U6IHByb2R1Y3Q/LnByaWNlLFxuICAvLyAgICAgICAgIH07XG4gIC8vICAgICAgIH0pLFxuICAvLyAgICAgfTtcblxuICAvLyAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IFBheW1lbnRzLmNyZWF0ZVBheW1lbnQoZGF0YSk7XG4gIC8vICAgICBhd2FpdCBDb21wbGV0ZVBheW1lbnQocmVzdWx0KTtcbiAgLy8gICAgIHJlcy5qc29uKHJlc3VsdCk7XG4gIC8vICAgfVxuICAvLyApO1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsUUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsT0FBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsS0FBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUcsU0FBQSxHQUFBSixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUksTUFBQSxHQUFBTCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUssU0FBQSxHQUFBTixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQU0sY0FBQSxHQUFBTixPQUFBO0FBQ0EsSUFBQU8sa0JBQUEsR0FBQVIsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFRLFFBQUEsR0FBQVQsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFTLEtBQUEsR0FBQUMsdUJBQUEsQ0FBQVYsT0FBQTtBQUNBLElBQUFXLFFBQUEsR0FBQUQsdUJBQUEsQ0FBQVYsT0FBQTtBQUNBLElBQUFZLFVBQUEsR0FBQVosT0FBQTtBQUNBLElBQUFhLEtBQUEsR0FBQWQsc0JBQUEsQ0FBQUMsT0FBQTtBQUErQixTQUFBYyx5QkFBQUMsQ0FBQSw2QkFBQUMsT0FBQSxtQkFBQUMsQ0FBQSxPQUFBRCxPQUFBLElBQUFFLENBQUEsT0FBQUYsT0FBQSxZQUFBRix3QkFBQSxZQUFBQSxDQUFBQyxDQUFBLFdBQUFBLENB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","map":{"version":3,"names":["_iyzipay","_interopRequireDefault","require","_moment","_cart","_products","_users","_ApiError","_RequiredCheck","_OrderCompleteMail","_Session","Cards","_interopRequireWildcard","Payments","_payments2","_uuid","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","_default","router","post","Session","req","res","next","card","body","checkRequiredField","params","cartId","cart","Carts","findOne","_id","populate","ApiError","completed","registerCard","productIds","products","map","item","productId","Products","find","$in","enrichedProducts","cartProduct","productDetail","product","String","_doc","paidPrice","reduce","acc","price","quantity","toFixed","basketItems","console","log","name","seller","subMerchantKey","id","category1","categories","category2","itemType","Iyzipay","BASKET_ITEM_TYPE","subMerchantPrice","basketTotal","parseFloat","data","locale","user","conversationId","currency","CURRENCY","TRY","installments","basketId","paymentChannel","PAYMENT_CHANNEL","WEB","paymentGroup","PAYMENT_GROUP","PRODUCT","paymentCard","buyer","surname","gsmNumber","phoneNumber","email","identityNumber","lastLoginDate","moment","updatedAt","format","registrationDate","registrationAddress","address","ip","city","country","zipCode","shippingAddress","contactName","billingAddress","result","createPayment","CompletePayment","productStockUpdates","quantityToDecrease","updateOne","$inc","stock","OrderCompleteMail","json","error","cardUserKey","b","index","Users","save","cardIndex","cards","getUserCards","parseInt","cardDetails","length","cardToken","createdAt","status","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["payments.js"],"sourcesContent":["import Iyzipay from \"iyzipay\";\nimport moment from \"moment\";\nimport Carts from \"../db/cart\";\nimport Products from \"../db/products\";\nimport Users from \"../db/users\";\nimport ApiError from \"../errors/ApiError\";\nimport { checkRequiredField } from \"../helpers/RequiredCheck\";\nimport OrderCompleteMail from \"../middlewares/OrderCompleteMail\";\nimport Session from \"../middlewares/Session\";\nimport * as Cards from \"../services/iyzico/methods/cards\";\nimport * as Payments from \"../services/iyzico/methods/payments\";\nimport { CompletePayment } from \"../utils/payments\";\nimport id from \"../utils/uuid\";\n\nexport default (router) => {\n  /*çalışıyor*/ router.post(\n    \"/payments/:cartId/with-new-card\",\n    Session,\n    async (req, res, next) => {\n      const { card } = req.body;\n      // if (!card) {\n      //   throw new ApiError(\"Card is required\", 400, \"cardRequired\");\n      // }\n      checkRequiredField(card, \"Card\");\n      checkRequiredField(req.params?.cartId, \"CartId\");\n      // if (!req.params?.cartId) {\n      //   throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      // }\n      const cart = await Carts.findOne({ _id: req.params?.cartId })\n        .populate(\"buyer\")\n        .populate(\"products\");\n      if (!cart) {\n        throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n      }\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      card.registerCard = \"0\"; //methodslarda registerCard:1 yani kartı kaydet demek ama şuan kaydetme dediğim için 0 yaptım\n\n      // Ürün bilgilerini getirme (Cart'taki productId'leri kullanarak)\n      const productIds = cart.products.map((item) => item.productId);\n      const products = await Products.find({\n        _id: { $in: productIds },\n      }).populate(\"seller\");\n\n      // Ürün bilgilerini cart'a ekliyoruz\n      const enrichedProducts = cart.products.map((cartProduct) => {\n        const productDetail = products.find(\n          (product) => String(product._id) === String(cartProduct.productId)\n        );\n        return {\n          ...cartProduct._doc,\n          productDetail,\n        };\n      });\n\n      // Ödenecek miktar hesaplama\n      // const paidPrice = enrichedProducts\n      //   .map((product) => product.productDetail.price * product.quantity)\n      //   .reduce((a, b) => a + b, 0);\n\n      const paidPrice = enrichedProducts\n        .reduce(\n          (acc, product) =>\n            acc + product.productDetail.price * product.quantity,\n          0\n        )\n        .toFixed(2);\n\n      const basketItems = enrichedProducts.map((cartProduct) => {\n        const product = cartProduct.productDetail;\n        // Log subMerchantKey to ensure it's present\n        console.log(`Processing product: ${product.name}`);\n        console.log(`subMerchantKey: ${product.seller.subMerchantKey}`);\n\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product?.categories?.[0] || \"Uncategorized\",\n          category2: product?.categories?.[1] || \"\",\n          itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n          price: (product?.price * cartProduct.quantity).toFixed(2), // Birim fiyatı çarpıyoruz ve virgülden sonra 2 basamak tutuyoruz\n          subMerchantKey: product?.seller?.subMerchantKey,\n          subMerchantPrice: (\n            product.price *\n            cartProduct.quantity *\n            0.9\n          ).toFixed(2),\n        };\n      });\n      console.log(\"Final basketItems array:\", basketItems);\n\n      // Sepetteki ürünlerin toplam fiyatını hesaplıyoruz\n      const basketTotal = basketItems\n        .reduce((acc, item) => acc + parseFloat(item.price), 0)\n        .toFixed(2); // Fiyatları alıp float'a çeviriyoruz\n\n      // Ödeme ve sepet toplamları kontrolü\n      if (basketTotal !== paidPrice) {\n        console.log(basketTotal);\n        throw new ApiError(\n          \"Gönderilen tutar tüm kırılımların toplam tutarına eşit olmalıdır\",\n          400,\n          \"priceMismatch\"\n        );\n      }\n\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: basketTotal, //toFixed(2) vardı\n        paidPrice: basketTotal,\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        paymentCard: card,\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ), //iyizpay tarih formatına çevirmek için yapıldı\n          registrationDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems,\n      };\n\n      try {\n        let result = await Payments.createPayment(data);\n        await CompletePayment(result);\n\n        // Ürün stoklarını güncelleme\n        const productStockUpdates = {};\n\n        // Sepetteki ürünleri döngüyle işleyerek aynı ürünlerden kaç tane olduğunu hesapla\n        for (const cartProduct of cart.products) {\n          const productId = String(cartProduct.productId); // Doğru ürün ID'si buradan alınmalı\n          const quantity = cartProduct.quantity; // Sepetteki miktar\n\n          if (productStockUpdates[productId]) {\n            productStockUpdates[productId] += quantity;\n          } else {\n            productStockUpdates[productId] = quantity;\n          }\n        }\n\n        // Stokları güncelle\n        for (const productId in productStockUpdates) {\n          const quantityToDecrease = productStockUpdates[productId];\n          await Products.updateOne(\n            { _id: productId },\n            { $inc: { stock: -quantityToDecrease } }\n          );\n        }\n\n        await OrderCompleteMail(req, res);\n        res.json(result);\n      } catch (error) {\n        next(error);\n      }\n    }\n  );\n\n  //yeni bir ödeme oluştur ve kart kaydet\n  router.post(\n    \"/payments/:cartId/with-new-card/register-card\",\n    Session,\n    async (req, res) => {\n      const { card } = req.body;\n      if (!card) {\n        throw new ApiError(\"Card is required\", 400, \"cardRequired\");\n      }\n      if (!req.params?.cartId) {\n        throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      }\n      const cart = await Carts.findOne({ _id: req.params?.cartId })\n        .populate(\"buyer\")\n        .populate(\"products\");\n      if (!cart) {\n        throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n      }\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      if (req.user?.cardUserKey) {\n        card.cardUserKey = req.user?.cardUserKey;\n      }\n      card.registerCard = \"1\"; //methodslarda registerCard:1 yani kartı kaydet\n\n      const paidPrice = cart.products\n        .map((product) => product.price)\n        .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: paidPrice,\n        paidPrice: paidPrice,\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        paymentCard: card,\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ), //iyizpay tarih formatına çevirmek için yapıldı\n          registrationDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems: cart.products.map((product, index) => {\n          return {\n            id: String(product?._id),\n            name: product?.name,\n            category1: product.categories[0],\n            category2: product.categories[1],\n            itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n            price: product?.price,\n          };\n        }),\n      };\n\n      let result = await Payments.createPayment(data);\n      if (req.user?.cardUserKey) {\n        const user = await Users.findOne({ _id: req.user?._id });\n        user.cardUserKey = result?.cardUserKey;\n        await user.save();\n      }\n      await CompletePayment(result);\n      res.json(result);\n    }\n  );\n\n  /*çalışıyor*/ router.post(\n    \"/payments/:cartId/:cardIndex/with-registered-card-index\",\n    Session,\n    async (req, res, next) => {\n      //çalışıyor bu endpoint\n      let { cardIndex } = req.params;\n      if (!cardIndex) {\n        throw new ApiError(\"Card index is required\", 400, \"cardIndexRequired\");\n      }\n      if (!req.user?.cardUserKey) {\n        throw new ApiError(\n          \"No registered card available\",\n          400,\n          \"cardUserKeyRequired\"\n        );\n      }\n\n      const cards = await Cards.getUserCards({\n        locale: req.user.locale,\n        conversationId: id(),\n        cardUserKey: req.user?.cardUserKey,\n      });\n      const index = parseInt(cardIndex);\n      if (index >= cards?.cardDetails?.length) {\n        throw new ApiError(\"Card does not exist\", 400, \"cardIndexInvalid\");\n      }\n      const { cardToken } = cards?.cardDetails[index];\n      if (!req.params?.cartId) {\n        throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      }\n\n      // Cart'ı bul\n      const cart = await Carts.findOne({ _id: req.params?.cartId }).populate(\n        \"buyer\"\n      ); // Sadece buyer'ı populate ediyoruz.\n\n      if (!cart) {\n        throw new ApiError(\"Cart not found\", 404, \"cartNotFound\");\n      }\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      // Ürün bilgilerini getirme (Cart'taki productId'leri kullanarak)\n      const productIds = cart.products.map((item) => item.productId);\n      const products = await Products.find({\n        _id: { $in: productIds },\n      }).populate(\"seller\");\n\n      // Ürün bilgilerini cart'a ekliyoruz\n      const enrichedProducts = cart.products.map((cartProduct) => {\n        const productDetail = products.find(\n          (product) => String(product._id) === String(cartProduct.productId)\n        );\n        return {\n          ...cartProduct._doc,\n          productDetail,\n        };\n      });\n\n      // Ödenecek miktar hesaplama\n      const paidPrice = enrichedProducts\n        .reduce(\n          (acc, product) =>\n            acc + product.productDetail.price * product.quantity,\n          0\n        )\n        .toFixed(2);\n\n      const basketItems = enrichedProducts.map((cartProduct) => {\n        const product = cartProduct.productDetail;\n        console.log(`Processing product: ${product.name}`);\n        console.log(`subMerchantKey: ${product.seller.subMerchantKey}`);\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product?.categories?.[0] || \"Uncategorized\",\n          category2: product?.categories?.[1] || \"\",\n          itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n          price: (product?.price * cartProduct.quantity).toFixed(2), // Birim fiyatı çarpıyoruz ve virgülden sonra 2 basamak tutuyoruz\n          subMerchantKey: product?.seller?.subMerchantKey,\n          subMerchantPrice: (\n            product.price *\n            cartProduct.quantity *\n            0.9\n          ).toFixed(2),\n        };\n      });\n      console.log(\"Items:\", basketItems);\n\n      // Sepetteki ürünlerin toplam fiyatını hesaplıyoruz\n      const basketTotal = basketItems\n        .reduce((acc, item) => acc + parseFloat(item.price), 0)\n        .toFixed(2); // Fiyatları alıp float'a çeviriyoruz\n\n      // Ödeme ve sepet toplamları kontrolü\n      if (basketTotal !== paidPrice) {\n        throw new ApiError(\n          \"Gönderilen tutar tüm kırılımların toplam tutarına eşit olmalıdır\",\n          400,\n          \"priceMismatch\"\n        );\n      }\n\n      // Ödeme verisi\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: basketTotal, // İyzico için yuvarlanmış toplam sepet tutarı\n        paidPrice: basketTotal, // Aynı değeri paidPrice'a da gönderiyoruz\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        paymentCard: {\n          cardToken,\n          cardUserKey: req.user?.cardUserKey,\n        },\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationDate: moment(req.user?.createdAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \" \" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \" \" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems, // Doğru hesaplanan sepet öğelerini gönderiyoruz\n      };\n      console.log(data);\n\n      try {\n        let result = await Payments.createPayment(data);\n        await CompletePayment(result);\n\n        const productStockUpdates = {};\n\n        // Sepetteki ürünleri döngüyle işleyerek aynı ürünlerden kaç tane olduğunu hesapla\n        for (const cartProduct of cart.products) {\n          const productId = String(cartProduct.productId); // Doğru ürün ID'si buradan alınmalı\n          const quantity = cartProduct.quantity; // Sepetteki miktar\n\n          if (productStockUpdates[productId]) {\n            productStockUpdates[productId] += quantity;\n          } else {\n            productStockUpdates[productId] = quantity;\n          }\n        }\n\n        // Stokları güncelle\n        for (const productId in productStockUpdates) {\n          const quantityToDecrease = productStockUpdates[productId];\n          await Products.updateOne(\n            { _id: productId },\n            { $inc: { stock: -quantityToDecrease } }\n          );\n        }\n\n        res.json(result);\n        next();\n      } catch (error) {\n        next(error);\n      }\n    },\n    OrderCompleteMail,\n    (req, res) => {\n      return res\n        .status(200)\n        .json(`${req.user.email} mail adresine sipariş detayı gönderilmiştir.`);\n    }\n  );\n  router.post(\n    \"/payments/:cartId/with-registered-card-token\",\n    Session,\n    async (req, res, next) => {\n      // Get cardToken from the request body\n      let { cardToken } = req.body;\n\n      // Ensure cardToken is provided\n      if (!cardToken) {\n        throw new ApiError(\"Card token is required\", 400, \"cardTokenRequired\");\n      }\n\n      // Ensure the user has a registered card (cardUserKey)\n      if (!req.user?.cardUserKey) {\n        throw new ApiError(\n          \"No registered card available\",\n          400,\n          \"cardUserKeyRequired\"\n        );\n      }\n\n      // Ensure cartId is provided in the request params\n      if (!req.params?.cartId) {\n        throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      }\n\n      // Find the cart using cartId\n      const cart = await Carts.findOne({ _id: req.params?.cartId }).populate(\n        \"buyer\"\n      );\n      if (!cart) {\n        throw new ApiError(\"Cart not found\", 404, \"cartNotFound\");\n      }\n\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      // Fetch product details for the cart\n      const productIds = cart.products.map((item) => item.productId);\n      const products = await Products.find({\n        _id: { $in: productIds },\n      }).populate(\"seller\");\n\n      // Enrich cart with product details\n      const enrichedProducts = cart.products.map((cartProduct) => {\n        const productDetail = products.find(\n          (product) => String(product._id) === String(cartProduct.productId)\n        );\n        return {\n          ...cartProduct._doc,\n          productDetail,\n        };\n      });\n\n      // Calculate total price\n      const paidPrice = enrichedProducts\n        .reduce(\n          (acc, product) =>\n            acc + product.productDetail.price * product.quantity,\n          0\n        )\n        .toFixed(2);\n\n      // Create basket items for payment\n      const basketItems = enrichedProducts.map((cartProduct) => {\n        const product = cartProduct.productDetail;\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product?.categories?.[0] || \"Uncategorized\",\n          category2: product?.categories?.[1] || \"\",\n          itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n          price: (product?.price * cartProduct.quantity).toFixed(2),\n          subMerchantKey: product?.seller?.subMerchantKey,\n          subMerchantPrice: (\n            product.price *\n            cartProduct.quantity *\n            0.9\n          ).toFixed(2),\n        };\n      });\n\n      const basketTotal = basketItems\n        .reduce((acc, item) => acc + parseFloat(item.price), 0)\n        .toFixed(2);\n\n      if (basketTotal !== paidPrice) {\n        throw new ApiError(\n          \"Gönderilen tutar tüm kırılımların toplam tutarına eşit olmalıdır\",\n          400,\n          \"priceMismatch\"\n        );\n      }\n\n      // Prepare payment data\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: basketTotal,\n        paidPrice: basketTotal,\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        paymentCard: {\n          cardToken,\n          cardUserKey: req.user?.cardUserKey,\n        },\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationDate: moment(req.user?.createdAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \" \" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \" \" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems,\n      };\n\n      try {\n        // Process payment\n        let result = await Payments.createPayment(data);\n        await CompletePayment(result);\n\n        const productStockUpdates = {};\n\n        // Update stock for each product\n        for (const cartProduct of cart.products) {\n          const productId = String(cartProduct.productId);\n          const quantity = cartProduct.quantity;\n          if (productStockUpdates[productId]) {\n            productStockUpdates[productId] += quantity;\n          } else {\n            productStockUpdates[productId] = quantity;\n          }\n        }\n\n        // Decrease stock based on the quantities\n        for (const productId in productStockUpdates) {\n          const quantityToDecrease = productStockUpdates[productId];\n          await Products.updateOne(\n            { _id: productId },\n            { $inc: { stock: -quantityToDecrease } }\n          );\n        }\n\n        res.json(result);\n        next();\n      } catch (error) {\n        next(error);\n      }\n    },\n    OrderCompleteMail,\n    (req, res) => {\n      return res\n        .status(200)\n        .json(`${req.user.email} mail adresine sipariş detayı gönderilmiştir.`);\n    }\n  );\n\n  // router.post(\n  //   \"/payments/:cartId/with-registered-card-token\",\n  //   Session,\n  //   async (req, res) => {\n  //     let { cardToken } = req.body;\n  //     if (!cardToken) {\n  //       throw new ApiError(\"Card Token is required\", 400, \"cardTokenRequired\");\n  //     }\n  //     if (!req.user?.cardUserKey) {\n  //       throw new ApiError(\n  //         \"No registered card available\",\n  //         400,\n  //         \"cardUserKeyRequired\"\n  //       );\n  //     }\n\n  //     if (!req.params?.cartId) {\n  //       throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n  //     }\n  //     const cart = await Carts.findOne({ _id: req.params?.cartId })\n  //       .populate(\"buyer\")\n  //       .populate(\"products\");\n  //     if (!cart) {\n  //       throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n  //     }\n  //     if (cart?.completed) {\n  //       throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n  //     }\n\n  //     const paidPrice = cart.products\n  //       .map((product) => product.price)\n  //       .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n  //     const card = {\n  //       cardToken,\n  //       cardUserKey: req.user?.cardUserKey,\n  //     };\n\n  //     const data = {\n  //       locale: req.user.locale,\n  //       conversationId: id(),\n  //       price: paidPrice,\n  //       paidPrice: paidPrice,\n  //       currency: Iyzipay.CURRENCY.TRY,\n  //       installments: \"1\",\n  //       basketId: String(cart?._id),\n  //       paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n  //       paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n  //       paymentCard: card,\n  //       buyer: {\n  //         id: String(req.user._id),\n  //         name: req.user?.name,\n  //         surname: req.user?.surname,\n  //         gsmNumber: req.user?.phoneNumber,\n  //         email: req.user?.email,\n  //         identityNumber: req.user?.identityNumber,\n  //         lastLoginDate: moment(req.user?.updatedAt).format(\n  //           \"YYYY-MM-DD HH:mm:ss\"\n  //         ), //iyizpay tarih formatına çevirmek için yapıldı\n  //         registrationDate: moment(req.user?.updatedAt).format(\n  //           \"YYYY-MM-DD HH:mm:ss\"\n  //         ),\n  //         registrationAddress: req.user?.address,\n  //         ip: req.user?.ip,\n  //         city: req.user?.city,\n  //         country: req.user?.country,\n  //         zipCode: req.user?.zipCode,\n  //       },\n  //       shippingAddress: {\n  //         contactName: req.user?.name + \"\" + req.user?.surname,\n  //         city: req.user?.city,\n  //         country: req.user?.country,\n  //         address: req.user?.address,\n  //         zipCode: req.user?.zipCode,\n  //       },\n  //       billingAddress: {\n  //         contactName: req.user?.name + \"\" + req.user?.surname,\n  //         city: req.user?.city,\n  //         country: req.user?.country,\n  //         address: req.user?.address,\n  //         zipCode: req.user?.zipCode,\n  //       },\n  //       basketItems: cart.products.map((product, index) => {\n  //         return {\n  //           id: String(product?._id),\n  //           name: product?.name,\n  //           category1: product.categories[0],\n  //           category2: product.categories[1],\n  //           itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n  //           price: product?.price,\n  //         };\n  //       }),\n  //     };\n\n  //     let result = await Payments.createPayment(data);\n  //     await CompletePayment(result);\n  //     res.json(result);\n  //   }\n  // );\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1733223942299},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/Payments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _moment = _interopRequireDefault(require(\"moment\"));\nvar _iyzipay = _interopRequireDefault(require(\"iyzipay\"));\nvar _cart = _interopRequireDefault(require(\"../db/cart\"));\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nvar Payments = _interopRequireWildcard(require(\"../services/iyzico/methods/payments\"));\nvar Cards = _interopRequireWildcard(require(\"../services/iyzico/methods/cards\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nvar _payments2 = require(\"../utils/payments\");\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function (e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = router => {\n  //yeni bir kartla ödeme oluştur ve kartı kaydetme\n  router.post(\"/payments/:cartId/with-new-card\", _Session.default, async (req, res) => {\n    const {\n      card\n    } = req.body;\n    if (!card) {\n      throw new _ApiError.default(\"Card is required\", 400, \"cardRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _cart.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    card.registerCard = \"0\"; //methodslarda registerCard:1 yani kartı kaydet demek ama şuan kaydetme dediğim için 0 yaptım\n\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    let result = await Payments.createPayment(data);\n    await (0, _payments2.CompletePayment)(result);\n    res.json(result);\n  });\n\n  //yeni bir ödeme oluştur ve kart kaydet\n  router.post(\"/payments/:cartId/with-new-card/register-card\", _Session.default, async (req, res) => {\n    const {\n      card\n    } = req.body;\n    if (!card) {\n      throw new _ApiError.default(\"Card is required\", 400, \"cardRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _cart.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    if (req.user?.cardUserKey) {\n      card.cardUserKey = req.user?.cardUserKey;\n    }\n    card.registerCard = \"1\"; //methodslarda registerCard:1 yani kartı kaydet\n\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    let result = await Payments.createPayment(data);\n    if (req.user?.cardUserKey) {\n      const user = await _users.default.findOne({\n        _id: req.user?._id\n      });\n      user.cardUserKey = result?.cardUserKey;\n      await user.save();\n    }\n    await (0, _payments2.CompletePayment)(result);\n    res.json(result);\n  });\n\n  //hali hazırda bulunan kart ile ödeme\n  router.post(\"/payments/:cartId/:cardIndex/with-registered-card-index\", _Session.default, async (req, res) => {\n    let {\n      cardIndex\n    } = req.params;\n    if (!cardIndex) {\n      throw new _ApiError.default(\"Card index is required\", 400, \"cardIndexRequired\");\n    }\n    if (!req.user?.cardUserKey) {\n      throw new _ApiError.default(\"No registered card available\", 400, \"cardUserKeyRequired\");\n    }\n    const cards = await Cards.getUserCards({\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      cardUserKey: req.user?.cardUserKey\n    });\n    const index = parseInt(cardIndex);\n    if (index >= cards?.cardDetails?.length) {\n      throw new _ApiError.default(\"Card does not exist\", 400, \"cardIndexInvalid\");\n    }\n    const {\n      cardToken\n    } = cards?.cardDetails[index];\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _cart.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const card = {\n      cardToken,\n      cardUserKey: req.user?.cardUserKey\n    };\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    let result = await Payments.createPayment(data);\n    await (0, _payments2.CompletePayment)(result);\n    res.json(result);\n  });\n  router.post(\"/payments/:cartId/with-registered-card-token\", _Session.default, async (req, res) => {\n    let {\n      cardToken\n    } = req.body;\n    if (!cardToken) {\n      throw new _ApiError.default(\"Card Token is required\", 400, \"cardTokenRequired\");\n    }\n    if (!req.user?.cardUserKey) {\n      throw new _ApiError.default(\"No registered card available\", 400, \"cardUserKeyRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _cart.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const card = {\n      cardToken,\n      cardUserKey: req.user?.cardUserKey\n    };\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    let result = await Payments.createPayment(data);\n    await (0, _payments2.CompletePayment)(result);\n    res.json(result);\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9tZW50IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfaXl6aXBheSIsIl9jYXJ0IiwiX3VzZXJzIiwiX0FwaUVycm9yIiwiX1Nlc3Npb24iLCJQYXltZW50cyIsIl9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkIiwiQ2FyZHMiLCJfdXVpZCIsIl9wYXltZW50czIiLCJfZ2V0UmVxdWlyZVdpbGRjYXJkQ2FjaGUiLCJlIiwiV2Vha01hcCIsInIiLCJ0IiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJoYXMiLCJnZXQiLCJuIiwiX19wcm90b19fIiwiYSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwidSIsImhhc093blByb3BlcnR5IiwiY2FsbCIsImkiLCJzZXQiLCJfZGVmYXVsdCIsInJvdXRlciIsInBvc3QiLCJTZXNzaW9uIiwicmVxIiwicmVzIiwiY2FyZCIsImJvZHkiLCJBcGlFcnJvciIsInBhcmFtcyIsImNhcnRJZCIsImNhcnQiLCJDYXJ0cyIsImZpbmRPbmUiLCJfaWQiLCJwb3B1bGF0ZSIsImNvbXBsZXRlZCIsInJlZ2lzdGVyQ2FyZCIsInBhaWRQcmljZSIsInByb2R1Y3RzIiwibWFwIiwicHJvZHVjdCIsInByaWNlIiwicmVkdWNlIiwiYiIsImRhdGEiLCJsb2NhbGUiLCJ1c2VyIiwiY29udmVyc2F0aW9uSWQiLCJpZCIsImN1cnJlbmN5IiwiSXl6aXBheSIsIkNVUlJFTkNZIiwiVFJZIiwiaW5zdGFsbG1lbnRzIiwiYmFza2V0SWQiLCJTdHJpbmciLCJwYXltZW50Q2hhbm5lbCIsIlBBWU1FTlRfQ0hBTk5FTCIsIldFQiIsInBheW1lbnRHcm91cCIsIlBBWU1FTlRfR1JPVVAiLCJQUk9EVUNUIiwicGF5bWVudENhcmQiLCJidXllciIsIm5hbWUiLCJzdXJuYW1lIiwiZ3NtTnVtYmVyIiwicGhvbmVOdW1iZXIiLCJlbWFpbCIsImlkZW50aXR5TnVtYmVyIiwibGFzdExvZ2luRGF0ZSIsIm1vbWVudCIsInVwZGF0ZWRBdCIsImZvcm1hdCIsInJlZ2lzdHJhdGlvbkRhdGUiLCJyZWdpc3RyYXRpb25BZGRyZXNzIiwiYWRkcmVzcyIsImlwIiwiY2l0eSIsImNvdW50cnkiLCJ6aXBDb2RlIiwic2hpcHBpbmdBZGRyZXNzIiwiY29udGFjdE5hbWUiLCJiaWxsaW5nQWRkcmVzcyIsImJhc2tldEl0ZW1zIiwiaW5kZXgiLCJjYXRlZ29yeTEiLCJjYXRlZ29yaWVzIiwiY2F0ZWdvcnkyIiwiaXRlbVR5cGUiLCJCQVNLRVRfSVRFTV9UWVBFIiwicmVzdWx0IiwiY3JlYXRlUGF5bWVudCIsIkNvbXBsZXRlUGF5bWVudCIsImpzb24iLCJjYXJkVXNlcktleSIsIlVzZXJzIiwic2F2ZSIsImNhcmRJbmRleCIsImNhcmRzIiwiZ2V0VXNlckNhcmRzIiwicGFyc2VJbnQiLCJjYXJkRGV0YWlscyIsImxlbmd0aCIsImNhcmRUb2tlbiIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9yb3V0ZXMvIiwic291cmNlcyI6WyJQYXltZW50cy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9tZW50IGZyb20gXCJtb21lbnRcIjtcbmltcG9ydCBJeXppcGF5IGZyb20gXCJpeXppcGF5XCI7XG5pbXBvcnQgQ2FydHMgZnJvbSBcIi4uL2RiL2NhcnRcIjtcbmltcG9ydCBVc2VycyBmcm9tIFwiLi4vZGIvdXNlcnNcIjtcbmltcG9ydCBBcGlFcnJvciBmcm9tIFwiLi4vZXJyb3JzL0FwaUVycm9yXCI7XG5pbXBvcnQgU2Vzc2lvbiBmcm9tIFwiLi4vbWlkZGxld2FyZXMvU2Vzc2lvblwiO1xuaW1wb3J0ICogYXMgUGF5bWVudHMgZnJvbSBcIi4uL3NlcnZpY2VzL2l5emljby9tZXRob2RzL3BheW1lbnRzXCI7XG5pbXBvcnQgKiBhcyBDYXJkcyBmcm9tIFwiLi4vc2VydmljZXMvaXl6aWNvL21ldGhvZHMvY2FyZHNcIjtcbmltcG9ydCBpZCBmcm9tIFwiLi4vdXRpbHMvdXVpZFwiO1xuaW1wb3J0IHsgQ29tcGxldGVQYXltZW50IH0gZnJvbSBcIi4uL3V0aWxzL3BheW1lbnRzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IChyb3V0ZXIpID0+IHtcbiAgLy95ZW5pIGJpciBrYXJ0bGEgw7ZkZW1lIG9sdcWfdHVyIHZlIGthcnTEsSBrYXlkZXRtZVxuICByb3V0ZXIucG9zdChcIi9wYXltZW50cy86Y2FydElkL3dpdGgtbmV3LWNhcmRcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyBjYXJkIH0gPSByZXEuYm9keTtcbiAgICBpZiAoIWNhcmQpIHtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgaXMgcmVxdWlyZWRcIiwgNDAwLCBcImNhcmRSZXF1aXJlZFwiKTtcbiAgICB9XG4gICAgaWYgKCFyZXEucGFyYW1zPy5jYXJ0SWQpIHtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnRJRCBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FydElkUmVxdWlyZWRcIik7XG4gICAgfVxuICAgIGNvbnN0IGNhcnQgPSBhd2FpdCBDYXJ0cy5maW5kT25lKHsgX2lkOiByZXEucGFyYW1zPy5jYXJ0SWQgfSlcbiAgICAgIC5wb3B1bGF0ZShcImJ1eWVyXCIpXG4gICAgICAucG9wdWxhdGUoXCJwcm9kdWN0c1wiKTtcbiAgICBpZiAoIWNhcnQpIHtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgbm90IGZvdW5kXCIsIDQwNCwgXCJjYXJkTm90Rm91bmRcIik7XG4gICAgfVxuICAgIGlmIChjYXJ0Py5jb21wbGV0ZWQpIHtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgaXMgY29tcGxldGVkXCIsIDQwMCwgXCJjYXJ0Q29tcGxldGVkXCIpO1xuICAgIH1cblxuICAgIGNhcmQucmVnaXN0ZXJDYXJkID0gXCIwXCI7IC8vbWV0aG9kc2xhcmRhIHJlZ2lzdGVyQ2FyZDoxIHlhbmkga2FydMSxIGtheWRldCBkZW1layBhbWEgxZ91YW4ga2F5ZGV0bWUgZGVkacSfaW0gacOnaW4gMCB5YXB0xLFtXG5cbiAgICBjb25zdCBwYWlkUHJpY2UgPSBjYXJ0LnByb2R1Y3RzXG4gICAgICAubWFwKChwcm9kdWN0KSA9PiBwcm9kdWN0LnByaWNlKVxuICAgICAgLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApOyAvL8O2ZGVuZWNlayBtaWt0YXJsYXLEsW4gdG9wbGFtxLFcblxuICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICBsb2NhbGU6IHJlcS51c2VyLmxvY2FsZSxcbiAgICAgIGNvbnZlcnNhdGlvbklkOiBpZCgpLFxuICAgICAgcHJpY2U6IHBhaWRQcmljZSxcbiAgICAgIHBhaWRQcmljZTogcGFpZFByaWNlLFxuICAgICAgY3VycmVuY3k6IEl5emlwYXkuQ1VSUkVOQ1kuVFJZLFxuICAgICAgaW5zdGFsbG1lbnRzOiBcIjFcIixcbiAgICAgIGJhc2tldElkOiBTdHJpbmcoY2FydD8uX2lkKSxcbiAgICAgIHBheW1lbnRDaGFubmVsOiBJeXppcGF5LlBBWU1FTlRfQ0hBTk5FTC5XRUIsXG4gICAgICBwYXltZW50R3JvdXA6IEl5emlwYXkuUEFZTUVOVF9HUk9VUC5QUk9EVUNULFxuICAgICAgcGF5bWVudENhcmQ6IGNhcmQsXG4gICAgICBidXllcjoge1xuICAgICAgICBpZDogU3RyaW5nKHJlcS51c2VyLl9pZCksXG4gICAgICAgIG5hbWU6IHJlcS51c2VyPy5uYW1lLFxuICAgICAgICBzdXJuYW1lOiByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgZ3NtTnVtYmVyOiByZXEudXNlcj8ucGhvbmVOdW1iZXIsXG4gICAgICAgIGVtYWlsOiByZXEudXNlcj8uZW1haWwsXG4gICAgICAgIGlkZW50aXR5TnVtYmVyOiByZXEudXNlcj8uaWRlbnRpdHlOdW1iZXIsXG4gICAgICAgIGxhc3RMb2dpbkRhdGU6IG1vbWVudChyZXEudXNlcj8udXBkYXRlZEF0KS5mb3JtYXQoXG4gICAgICAgICAgXCJZWVlZLU1NLUREIEhIOm1tOnNzXCJcbiAgICAgICAgKSwgLy9peWl6cGF5IHRhcmloIGZvcm1hdMSxbmEgw6dldmlybWVrIGnDp2luIHlhcMSxbGTEsVxuICAgICAgICByZWdpc3RyYXRpb25EYXRlOiBtb21lbnQocmVxLnVzZXI/LnVwZGF0ZWRBdCkuZm9ybWF0KFxuICAgICAgICAgIFwiWVlZWS1NTS1ERCBISDptbTpzc1wiXG4gICAgICAgICksXG4gICAgICAgIHJlZ2lzdHJhdGlvbkFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICBpcDogcmVxLnVzZXI/LmlwLFxuICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgfSxcbiAgICAgIHNoaXBwaW5nQWRkcmVzczoge1xuICAgICAgICBjb250YWN0TmFtZTogcmVxLnVzZXI/Lm5hbWUgKyBcIlwiICsgcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgYWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgfSxcbiAgICAgIGJpbGxpbmdBZGRyZXNzOiB7XG4gICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiXCIgKyByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICBhZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICB9LFxuICAgICAgYmFza2V0SXRlbXM6IGNhcnQucHJvZHVjdHMubWFwKChwcm9kdWN0LCBpbmRleCkgPT4ge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGlkOiBTdHJpbmcocHJvZHVjdD8uX2lkKSxcbiAgICAgICAgICBuYW1lOiBwcm9kdWN0Py5uYW1lLFxuICAgICAgICAgIGNhdGVnb3J5MTogcHJvZHVjdC5jYXRlZ29yaWVzWzBdLFxuICAgICAgICAgIGNhdGVnb3J5MjogcHJvZHVjdC5jYXRlZ29yaWVzWzFdLFxuICAgICAgICAgIGl0ZW1UeXBlOiBJeXppcGF5LkJBU0tFVF9JVEVNX1RZUEVbcHJvZHVjdD8uaXRlbVR5cGVdLFxuICAgICAgICAgIHByaWNlOiBwcm9kdWN0Py5wcmljZSxcbiAgICAgICAgfTtcbiAgICAgIH0pLFxuICAgIH07XG5cbiAgICBsZXQgcmVzdWx0ID0gYXdhaXQgUGF5bWVudHMuY3JlYXRlUGF5bWVudChkYXRhKTtcbiAgICBhd2FpdCBDb21wbGV0ZVBheW1lbnQocmVzdWx0KTtcbiAgICByZXMuanNvbihyZXN1bHQpO1xuICB9KTtcblxuICAvL3llbmkgYmlyIMO2ZGVtZSBvbHXFn3R1ciB2ZSBrYXJ0IGtheWRldFxuICByb3V0ZXIucG9zdChcbiAgICBcIi9wYXltZW50cy86Y2FydElkL3dpdGgtbmV3LWNhcmQvcmVnaXN0ZXItY2FyZFwiLFxuICAgIFNlc3Npb24sXG4gICAgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgICBjb25zdCB7IGNhcmQgfSA9IHJlcS5ib2R5O1xuICAgICAgaWYgKCFjYXJkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgaXMgcmVxdWlyZWRcIiwgNDAwLCBcImNhcmRSZXF1aXJlZFwiKTtcbiAgICAgIH1cbiAgICAgIGlmICghcmVxLnBhcmFtcz8uY2FydElkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnRJRCBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FydElkUmVxdWlyZWRcIik7XG4gICAgICB9XG4gICAgICBjb25zdCBjYXJ0ID0gYXdhaXQgQ2FydHMuZmluZE9uZSh7IF9pZDogcmVxLnBhcmFtcz8uY2FydElkIH0pXG4gICAgICAgIC5wb3B1bGF0ZShcImJ1eWVyXCIpXG4gICAgICAgIC5wb3B1bGF0ZShcInByb2R1Y3RzXCIpO1xuICAgICAgaWYgKCFjYXJ0KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgbm90IGZvdW5kXCIsIDQwNCwgXCJjYXJkTm90Rm91bmRcIik7XG4gICAgICB9XG4gICAgICBpZiAoY2FydD8uY29tcGxldGVkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgaXMgY29tcGxldGVkXCIsIDQwMCwgXCJjYXJ0Q29tcGxldGVkXCIpO1xuICAgICAgfVxuXG4gICAgICBpZiAocmVxLnVzZXI/LmNhcmRVc2VyS2V5KSB7XG4gICAgICAgIGNhcmQuY2FyZFVzZXJLZXkgPSByZXEudXNlcj8uY2FyZFVzZXJLZXk7XG4gICAgICB9XG4gICAgICBjYXJkLnJlZ2lzdGVyQ2FyZCA9IFwiMVwiOyAvL21ldGhvZHNsYXJkYSByZWdpc3RlckNhcmQ6MSB5YW5pIGthcnTEsSBrYXlkZXRcblxuICAgICAgY29uc3QgcGFpZFByaWNlID0gY2FydC5wcm9kdWN0c1xuICAgICAgICAubWFwKChwcm9kdWN0KSA9PiBwcm9kdWN0LnByaWNlKVxuICAgICAgICAucmVkdWNlKChhLCBiKSA9PiBhICsgYiwgMCk7IC8vw7ZkZW5lY2VrIG1pa3RhcmxhcsSxbiB0b3BsYW3EsVxuXG4gICAgICBjb25zdCBkYXRhID0ge1xuICAgICAgICBsb2NhbGU6IHJlcS51c2VyLmxvY2FsZSxcbiAgICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICAgIHByaWNlOiBwYWlkUHJpY2UsXG4gICAgICAgIHBhaWRQcmljZTogcGFpZFByaWNlLFxuICAgICAgICBjdXJyZW5jeTogSXl6aXBheS5DVVJSRU5DWS5UUlksXG4gICAgICAgIGluc3RhbGxtZW50czogXCIxXCIsXG4gICAgICAgIGJhc2tldElkOiBTdHJpbmcoY2FydD8uX2lkKSxcbiAgICAgICAgcGF5bWVudENoYW5uZWw6IEl5emlwYXkuUEFZTUVOVF9DSEFOTkVMLldFQixcbiAgICAgICAgcGF5bWVudEdyb3VwOiBJeXppcGF5LlBBWU1FTlRfR1JPVVAuUFJPRFVDVCxcbiAgICAgICAgcGF5bWVudENhcmQ6IGNhcmQsXG4gICAgICAgIGJ1eWVyOiB7XG4gICAgICAgICAgaWQ6IFN0cmluZyhyZXEudXNlci5faWQpLFxuICAgICAgICAgIG5hbWU6IHJlcS51c2VyPy5uYW1lLFxuICAgICAgICAgIHN1cm5hbWU6IHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICAgIGdzbU51bWJlcjogcmVxLnVzZXI/LnBob25lTnVtYmVyLFxuICAgICAgICAgIGVtYWlsOiByZXEudXNlcj8uZW1haWwsXG4gICAgICAgICAgaWRlbnRpdHlOdW1iZXI6IHJlcS51c2VyPy5pZGVudGl0eU51bWJlcixcbiAgICAgICAgICBsYXN0TG9naW5EYXRlOiBtb21lbnQocmVxLnVzZXI/LnVwZGF0ZWRBdCkuZm9ybWF0KFxuICAgICAgICAgICAgXCJZWVlZLU1NLUREIEhIOm1tOnNzXCJcbiAgICAgICAgICApLCAvL2l5aXpwYXkgdGFyaWggZm9ybWF0xLFuYSDDp2V2aXJtZWsgacOnaW4geWFwxLFsZMSxXG4gICAgICAgICAgcmVnaXN0cmF0aW9uRGF0ZTogbW9tZW50KHJlcS51c2VyPy51cGRhdGVkQXQpLmZvcm1hdChcbiAgICAgICAgICAgIFwiWVlZWS1NTS1ERCBISDptbTpzc1wiXG4gICAgICAgICAgKSxcbiAgICAgICAgICByZWdpc3RyYXRpb25BZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICBpcDogcmVxLnVzZXI/LmlwLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBzaGlwcGluZ0FkZHJlc3M6IHtcbiAgICAgICAgICBjb250YWN0TmFtZTogcmVxLnVzZXI/Lm5hbWUgKyBcIlwiICsgcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgYWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIGJpbGxpbmdBZGRyZXNzOiB7XG4gICAgICAgICAgY29udGFjdE5hbWU6IHJlcS51c2VyPy5uYW1lICsgXCJcIiArIHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIGFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBiYXNrZXRJdGVtczogY2FydC5wcm9kdWN0cy5tYXAoKHByb2R1Y3QsIGluZGV4KSA9PiB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlkOiBTdHJpbmcocHJvZHVjdD8uX2lkKSxcbiAgICAgICAgICAgIG5hbWU6IHByb2R1Y3Q/Lm5hbWUsXG4gICAgICAgICAgICBjYXRlZ29yeTE6IHByb2R1Y3QuY2F0ZWdvcmllc1swXSxcbiAgICAgICAgICAgIGNhdGVnb3J5MjogcHJvZHVjdC5jYXRlZ29yaWVzWzFdLFxuICAgICAgICAgICAgaXRlbVR5cGU6IEl5emlwYXkuQkFTS0VUX0lURU1fVFlQRVtwcm9kdWN0Py5pdGVtVHlwZV0sXG4gICAgICAgICAgICBwcmljZTogcHJvZHVjdD8ucHJpY2UsXG4gICAgICAgICAgfTtcbiAgICAgICAgfSksXG4gICAgICB9O1xuXG4gICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgUGF5bWVudHMuY3JlYXRlUGF5bWVudChkYXRhKTtcbiAgICAgIGlmIChyZXEudXNlcj8uY2FyZFVzZXJLZXkpIHtcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXJzLmZpbmRPbmUoeyBfaWQ6IHJlcS51c2VyPy5faWQgfSk7XG4gICAgICAgIHVzZXIuY2FyZFVzZXJLZXkgPSByZXN1bHQ/LmNhcmRVc2VyS2V5O1xuICAgICAgICBhd2FpdCB1c2VyLnNhdmUoKTtcbiAgICAgIH1cbiAgICAgIGF3YWl0IENvbXBsZXRlUGF5bWVudChyZXN1bHQpO1xuICAgICAgcmVzLmpzb24ocmVzdWx0KTtcbiAgICB9XG4gICk7XG5cbiAgLy9oYWxpIGhhesSxcmRhIGJ1bHVuYW4ga2FydCBpbGUgw7ZkZW1lXG4gIHJvdXRlci5wb3N0KFxuICAgIFwiL3BheW1lbnRzLzpjYXJ0SWQvOmNhcmRJbmRleC93aXRoLXJlZ2lzdGVyZWQtY2FyZC1pbmRleFwiLFxuICAgIFNlc3Npb24sXG4gICAgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgICBsZXQgeyBjYXJkSW5kZXggfSA9IHJlcS5wYXJhbXM7XG4gICAgICBpZiAoIWNhcmRJbmRleCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIGluZGV4IGlzIHJlcXVpcmVkXCIsIDQwMCwgXCJjYXJkSW5kZXhSZXF1aXJlZFwiKTtcbiAgICAgIH1cbiAgICAgIGlmICghcmVxLnVzZXI/LmNhcmRVc2VyS2V5KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgICBcIk5vIHJlZ2lzdGVyZWQgY2FyZCBhdmFpbGFibGVcIixcbiAgICAgICAgICA0MDAsXG4gICAgICAgICAgXCJjYXJkVXNlcktleVJlcXVpcmVkXCJcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgY2FyZHMgPSBhd2FpdCBDYXJkcy5nZXRVc2VyQ2FyZHMoe1xuICAgICAgICBsb2NhbGU6IHJlcS51c2VyLmxvY2FsZSxcbiAgICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICAgIGNhcmRVc2VyS2V5OiByZXEudXNlcj8uY2FyZFVzZXJLZXksXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IGluZGV4ID0gcGFyc2VJbnQoY2FyZEluZGV4KTtcbiAgICAgIGlmIChpbmRleCA+PSBjYXJkcz8uY2FyZERldGFpbHM/Lmxlbmd0aCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIGRvZXMgbm90IGV4aXN0XCIsIDQwMCwgXCJjYXJkSW5kZXhJbnZhbGlkXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBjYXJkVG9rZW4gfSA9IGNhcmRzPy5jYXJkRGV0YWlsc1tpbmRleF07XG4gICAgICBpZiAoIXJlcS5wYXJhbXM/LmNhcnRJZCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJ0SUQgaXMgcmVxdWlyZWRcIiwgNDAwLCBcImNhcnRJZFJlcXVpcmVkXCIpO1xuICAgICAgfVxuICAgICAgY29uc3QgY2FydCA9IGF3YWl0IENhcnRzLmZpbmRPbmUoeyBfaWQ6IHJlcS5wYXJhbXM/LmNhcnRJZCB9KVxuICAgICAgICAucG9wdWxhdGUoXCJidXllclwiKVxuICAgICAgICAucG9wdWxhdGUoXCJwcm9kdWN0c1wiKTtcbiAgICAgIGlmICghY2FydCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIG5vdCBmb3VuZFwiLCA0MDQsIFwiY2FyZE5vdEZvdW5kXCIpO1xuICAgICAgfVxuICAgICAgaWYgKGNhcnQ/LmNvbXBsZXRlZCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJ0IGlzIGNvbXBsZXRlZFwiLCA0MDAsIFwiY2FydENvbXBsZXRlZFwiKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcGFpZFByaWNlID0gY2FydC5wcm9kdWN0c1xuICAgICAgICAubWFwKChwcm9kdWN0KSA9PiBwcm9kdWN0LnByaWNlKVxuICAgICAgICAucmVkdWNlKChhLCBiKSA9PiBhICsgYiwgMCk7IC8vw7ZkZW5lY2VrIG1pa3RhcmxhcsSxbiB0b3BsYW3EsVxuXG4gICAgICBjb25zdCBjYXJkID0ge1xuICAgICAgICBjYXJkVG9rZW4sXG4gICAgICAgIGNhcmRVc2VyS2V5OiByZXEudXNlcj8uY2FyZFVzZXJLZXksXG4gICAgICB9O1xuXG4gICAgICBjb25zdCBkYXRhID0ge1xuICAgICAgICBsb2NhbGU6IHJlcS51c2VyLmxvY2FsZSxcbiAgICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICAgIHByaWNlOiBwYWlkUHJpY2UsXG4gICAgICAgIHBhaWRQcmljZTogcGFpZFByaWNlLFxuICAgICAgICBjdXJyZW5jeTogSXl6aXBheS5DVVJSRU5DWS5UUlksXG4gICAgICAgIGluc3RhbGxtZW50czogXCIxXCIsXG4gICAgICAgIGJhc2tldElkOiBTdHJpbmcoY2FydD8uX2lkKSxcbiAgICAgICAgcGF5bWVudENoYW5uZWw6IEl5emlwYXkuUEFZTUVOVF9DSEFOTkVMLldFQixcbiAgICAgICAgcGF5bWVudEdyb3VwOiBJeXppcGF5LlBBWU1FTlRfR1JPVVAuUFJPRFVDVCxcbiAgICAgICAgcGF5bWVudENhcmQ6IGNhcmQsXG4gICAgICAgIGJ1eWVyOiB7XG4gICAgICAgICAgaWQ6IFN0cmluZyhyZXEudXNlci5faWQpLFxuICAgICAgICAgIG5hbWU6IHJlcS51c2VyPy5uYW1lLFxuICAgICAgICAgIHN1cm5hbWU6IHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICAgIGdzbU51bWJlcjogcmVxLnVzZXI/LnBob25lTnVtYmVyLFxuICAgICAgICAgIGVtYWlsOiByZXEudXNlcj8uZW1haWwsXG4gICAgICAgICAgaWRlbnRpdHlOdW1iZXI6IHJlcS51c2VyPy5pZGVudGl0eU51bWJlcixcbiAgICAgICAgICBsYXN0TG9naW5EYXRlOiBtb21lbnQocmVxLnVzZXI/LnVwZGF0ZWRBdCkuZm9ybWF0KFxuICAgICAgICAgICAgXCJZWVlZLU1NLUREIEhIOm1tOnNzXCJcbiAgICAgICAgICApLCAvL2l5aXpwYXkgdGFyaWggZm9ybWF0xLFuYSDDp2V2aXJtZWsgacOnaW4geWFwxLFsZMSxXG4gICAgICAgICAgcmVnaXN0cmF0aW9uRGF0ZTogbW9tZW50KHJlcS51c2VyPy51cGRhdGVkQXQpLmZvcm1hdChcbiAgICAgICAgICAgIFwiWVlZWS1NTS1ERCBISDptbTpzc1wiXG4gICAgICAgICAgKSxcbiAgICAgICAgICByZWdpc3RyYXRpb25BZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICBpcDogcmVxLnVzZXI/LmlwLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBzaGlwcGluZ0FkZHJlc3M6IHtcbiAgICAgICAgICBjb250YWN0TmFtZTogcmVxLnVzZXI/Lm5hbWUgKyBcIlwiICsgcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgYWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIGJpbGxpbmdBZGRyZXNzOiB7XG4gICAgICAgICAgY29udGFjdE5hbWU6IHJlcS51c2VyPy5uYW1lICsgXCJcIiArIHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIGFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBiYXNrZXRJdGVtczogY2FydC5wcm9kdWN0cy5tYXAoKHByb2R1Y3QsIGluZGV4KSA9PiB7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGlkOiBTdHJpbmcocHJvZHVjdD8uX2lkKSxcbiAgICAgICAgICAgIG5hbWU6IHByb2R1Y3Q/Lm5hbWUsXG4gICAgICAgICAgICBjYXRlZ29yeTE6IHByb2R1Y3QuY2F0ZWdvcmllc1swXSxcbiAgICAgICAgICAgIGNhdGVnb3J5MjogcHJvZHVjdC5jYXRlZ29yaWVzWzFdLFxuICAgICAgICAgICAgaXRlbVR5cGU6IEl5emlwYXkuQkFTS0VUX0lURU1fVFlQRVtwcm9kdWN0Py5pdGVtVHlwZV0sXG4gICAgICAgICAgICBwcmljZTogcHJvZHVjdD8ucHJpY2UsXG4gICAgICAgICAgfTtcbiAgICAgICAgfSksXG4gICAgICB9O1xuXG4gICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgUGF5bWVudHMuY3JlYXRlUGF5bWVudChkYXRhKTtcbiAgICAgIGF3YWl0IENvbXBsZXRlUGF5bWVudChyZXN1bHQpO1xuICAgICAgcmVzLmpzb24ocmVzdWx0KTtcbiAgICB9XG4gICk7XG5cbiAgcm91dGVyLnBvc3QoXG4gICAgXCIvcGF5bWVudHMvOmNhcnRJZC93aXRoLXJlZ2lzdGVyZWQtY2FyZC10b2tlblwiLFxuICAgIFNlc3Npb24sXG4gICAgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgICBsZXQgeyBjYXJkVG9rZW4gfSA9IHJlcS5ib2R5O1xuICAgICAgaWYgKCFjYXJkVG9rZW4pIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FyZCBUb2tlbiBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FyZFRva2VuUmVxdWlyZWRcIik7XG4gICAgICB9XG4gICAgICBpZiAoIXJlcS51c2VyPy5jYXJkVXNlcktleSkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgXCJObyByZWdpc3RlcmVkIGNhcmQgYXZhaWxhYmxlXCIsXG4gICAgICAgICAgNDAwLFxuICAgICAgICAgIFwiY2FyZFVzZXJLZXlSZXF1aXJlZFwiXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGlmICghcmVxLnBhcmFtcz8uY2FydElkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnRJRCBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FydElkUmVxdWlyZWRcIik7XG4gICAgICB9XG4gICAgICBjb25zdCBjYXJ0ID0gYXdhaXQgQ2FydHMuZmluZE9uZSh7IF9pZDogcmVxLnBhcmFtcz8uY2FydElkIH0pXG4gICAgICAgIC5wb3B1bGF0ZShcImJ1eWVyXCIpXG4gICAgICAgIC5wb3B1bGF0ZShcInByb2R1Y3RzXCIpO1xuICAgICAgaWYgKCFjYXJ0KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgbm90IGZvdW5kXCIsIDQwNCwgXCJjYXJkTm90Rm91bmRcIik7XG4gICAgICB9XG4gICAgICBpZiAoY2FydD8uY29tcGxldGVkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgaXMgY29tcGxldGVkXCIsIDQwMCwgXCJjYXJ0Q29tcGxldGVkXCIpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBwYWlkUHJpY2UgPSBjYXJ0LnByb2R1Y3RzXG4gICAgICAgIC5tYXAoKHByb2R1Y3QpID0+IHByb2R1Y3QucHJpY2UpXG4gICAgICAgIC5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiLCAwKTsgLy/DtmRlbmVjZWsgbWlrdGFybGFyxLFuIHRvcGxhbcSxXG5cbiAgICAgIGNvbnN0IGNhcmQgPSB7XG4gICAgICAgIGNhcmRUb2tlbixcbiAgICAgICAgY2FyZFVzZXJLZXk6IHJlcS51c2VyPy5jYXJkVXNlcktleSxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgICBjb252ZXJzYXRpb25JZDogaWQoKSxcbiAgICAgICAgcHJpY2U6IHBhaWRQcmljZSxcbiAgICAgICAgcGFpZFByaWNlOiBwYWlkUHJpY2UsXG4gICAgICAgIGN1cnJlbmN5OiBJeXppcGF5LkNVUlJFTkNZLlRSWSxcbiAgICAgICAgaW5zdGFsbG1lbnRzOiBcIjFcIixcbiAgICAgICAgYmFza2V0SWQ6IFN0cmluZyhjYXJ0Py5faWQpLFxuICAgICAgICBwYXltZW50Q2hhbm5lbDogSXl6aXBheS5QQVlNRU5UX0NIQU5ORUwuV0VCLFxuICAgICAgICBwYXltZW50R3JvdXA6IEl5emlwYXkuUEFZTUVOVF9HUk9VUC5QUk9EVUNULFxuICAgICAgICBwYXltZW50Q2FyZDogY2FyZCxcbiAgICAgICAgYnV5ZXI6IHtcbiAgICAgICAgICBpZDogU3RyaW5nKHJlcS51c2VyLl9pZCksXG4gICAgICAgICAgbmFtZTogcmVxLnVzZXI/Lm5hbWUsXG4gICAgICAgICAgc3VybmFtZTogcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgZ3NtTnVtYmVyOiByZXEudXNlcj8ucGhvbmVOdW1iZXIsXG4gICAgICAgICAgZW1haWw6IHJlcS51c2VyPy5lbWFpbCxcbiAgICAgICAgICBpZGVudGl0eU51bWJlcjogcmVxLnVzZXI/LmlkZW50aXR5TnVtYmVyLFxuICAgICAgICAgIGxhc3RMb2dpbkRhdGU6IG1vbWVudChyZXEudXNlcj8udXBkYXRlZEF0KS5mb3JtYXQoXG4gICAgICAgICAgICBcIllZWVktTU0tREQgSEg6bW06c3NcIlxuICAgICAgICAgICksIC8vaXlpenBheSB0YXJpaCBmb3JtYXTEsW5hIMOnZXZpcm1layBpw6dpbiB5YXDEsWxkxLFcbiAgICAgICAgICByZWdpc3RyYXRpb25EYXRlOiBtb21lbnQocmVxLnVzZXI/LnVwZGF0ZWRBdCkuZm9ybWF0KFxuICAgICAgICAgICAgXCJZWVlZLU1NLUREIEhIOm1tOnNzXCJcbiAgICAgICAgICApLFxuICAgICAgICAgIHJlZ2lzdHJhdGlvbkFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIGlwOiByZXEudXNlcj8uaXAsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIHNoaXBwaW5nQWRkcmVzczoge1xuICAgICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiXCIgKyByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgICBhZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgICAgfSxcbiAgICAgICAgYmlsbGluZ0FkZHJlc3M6IHtcbiAgICAgICAgICBjb250YWN0TmFtZTogcmVxLnVzZXI/Lm5hbWUgKyBcIlwiICsgcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgYWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIGJhc2tldEl0ZW1zOiBjYXJ0LnByb2R1Y3RzLm1hcCgocHJvZHVjdCwgaW5kZXgpID0+IHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaWQ6IFN0cmluZyhwcm9kdWN0Py5faWQpLFxuICAgICAgICAgICAgbmFtZTogcHJvZHVjdD8ubmFtZSxcbiAgICAgICAgICAgIGNhdGVnb3J5MTogcHJvZHVjdC5jYXRlZ29yaWVzWzBdLFxuICAgICAgICAgICAgY2F0ZWdvcnkyOiBwcm9kdWN0LmNhdGVnb3JpZXNbMV0sXG4gICAgICAgICAgICBpdGVtVHlwZTogSXl6aXBheS5CQVNLRVRfSVRFTV9UWVBFW3Byb2R1Y3Q/Lml0ZW1UeXBlXSxcbiAgICAgICAgICAgIHByaWNlOiBwcm9kdWN0Py5wcmljZSxcbiAgICAgICAgICB9O1xuICAgICAgICB9KSxcbiAgICAgIH07XG5cbiAgICAgIGxldCByZXN1bHQgPSBhd2FpdCBQYXltZW50cy5jcmVhdGVQYXltZW50KGRhdGEpO1xuICAgICAgYXdhaXQgQ29tcGxldGVQYXltZW50KHJlc3VsdCk7XG4gICAgICByZXMuanNvbihyZXN1bHQpO1xuICAgIH1cbiAgKTtcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLE9BQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFFBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLEtBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFHLE1BQUEsR0FBQUosc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFJLFNBQUEsR0FBQUwsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFLLFFBQUEsR0FBQU4sc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFNLFFBQUEsR0FBQUMsdUJBQUEsQ0FBQVAsT0FBQTtBQUNBLElBQUFRLEtBQUEsR0FBQUQsdUJBQUEsQ0FBQVAsT0FBQTtBQUNBLElBQUFTLEtBQUEsR0FBQVYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFVLFVBQUEsR0FBQVYsT0FBQTtBQUFvRCxTQUFBVyx5QkFBQUMsQ0FBQSw2QkFBQUMsT0FBQSxtQkFBQUMsQ0FBQSxPQUFBRCxPQUFBLElBQUFFLENBQUEsT0FBQUYsT0FBQSxZQUFBRix3QkFBQSxZQUFBQSxDQUFBQyxDQUFBLFdBQUFBLENBQUEsR0FBQUcsQ0FBQSxHQUFBRCxDQUFBLEtBQUFGLENBQUE7QUFBQSxTQUFBTCx3QkFBQUssQ0FBQSxFQUFBRSxDQUFBLFNBQUFBLENBQUEsSUFBQUYsQ0FBQSxJQUFBQSxDQUFBLENBQUFJLFVBQUEsU0FBQUosQ0FBQSxlQUFBQSxDQUFBLHVCQUFBQSxDQUFBLHlCQUFBQSxDQUFBLFdBQUFLLE9BQUEsRUFBQUwsQ0FBQSxRQUFBRyxDQUFBLEdBQUFKLHdCQUFBLENBQUFHLENBQUEsT0FBQUMsQ0FBQSxJQUFBQSxDQUFBLENBQUFHLEdBQUEsQ0FBQU4sQ0FBQSxVQUFBRyxDQUFBLENBQUFJLEdBQUEsQ0FBQVAsQ0FBQSxPQUFBUSxDQUFBLEtBQUFDLFNBQUEsVUFBQUMsQ0FBQSxHQUFBQyxNQUFBLENBQUFDLGNBQUEsSUFBQUQsTUFBQSxDQUFBRSx3QkFBQSxXQUFBQyxDQUFBLElBQUFkLENBQUEsb0JBQUFjLENBQUEsT0FBQUMsY0FBQSxDQUFBQyxJQUFBLENBQUFoQixDQUFBLEVBQUFjLENBQUEsU0FBQUcsQ0FBQSxHQUFBUCxDQUFBLEdBQUFDLE1BQUEsQ0FBQUUsd0JBQUEsQ0FBQWIsQ0FBQSxFQUFBYyxDQUFBLFVBQUFHLENBQUEsS0FBQUEsQ0FBQSxDQUFBVixHQUFBLElBQUFVLENBQUEsQ0FBQUMsR0FBQSxJQUFBUCxNQUFBLENBQUFDLGNBQUEsQ0FBQUosQ0FBQSxFQUFBTSxDQUFBLEVBQUFHLENBQUEsSUFBQVQsQ0FBQSxDQUFBTSxDQUFBLElBQUFkLENBQUEsQ0FBQWMsQ0FBQSxZQUFBTixDQUFBLENBQUFILE9BQUEsR0FBQUwsQ0FBQSxFQUFBRyxDQUFBLElBQUFBLENBQUEsQ0FBQWUsR0FBQSxDQUFBbEIsQ0FBQSxFQUFBUSxDQUFBLEdBQUFBLENBQUE7QUFBQSxTQUFBckIsdUJBQUFhLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFJLFVBQUEsR0FBQUosQ0FBQSxLQUFBSyxPQUFBLEVBQUFMLENBQUE7QUFBQSxJQUFBbUIsUUFBQSxHQUVwQ0MsTUFBTSxJQUFLO0VBQ3pCO0VBQ0FBLE1BQU0sQ0FBQ0MsSUFBSSxDQUFDLGlDQUFpQyxFQUFFQyxnQkFBTyxFQUFFLE9BQU9DLEdBQUcsRUFBRUMsR0FBRyxLQUFLO0lBQzFFLE1BQU07TUFBRUM7SUFBSyxDQUFDLEdBQUdGLEdBQUcsQ0FBQ0csSUFBSTtJQUN6QixJQUFJLENBQUNELElBQUksRUFBRTtNQUNULE1BQU0sSUFBSUUsaUJBQVEsQ0FBQyxrQkFBa0IsRUFBRSxHQUFHLEVBQUUsY0FBYyxDQUFDO0lBQzdEO0lBQ0EsSUFBSSxDQUFDSixHQUFHLENBQUNLLE1BQU0sRUFBRUMsTUFBTSxFQUFFO01BQ3ZCLE1BQU0sSUFBSUYsaUJBQVEsQ0FBQyxvQkFBb0IsRUFBRSxHQUFHLEVBQUUsZ0JBQWdCLENBQUM7SUFDakU7SUFDQSxNQUFNRyxJQUFJLEdBQUcsTUFBTUMsYUFBSyxDQUFDQyxPQUFPLENBQUM7TUFBRUMsR0FBRyxFQUFFVixHQUFHLENBQUNLLE1BQU0sRUFBRUM7SUFBTyxDQUFDLENBQUMsQ0FDMURLLFFBQVEsQ0FBQyxPQUFPLENBQUMsQ0FDakJBLFFBQVEsQ0FBQyxVQUFVLENBQUM7SUFDdkIsSUFBSSxDQUFDSixJQUFJLEVBQUU7TUFDVCxNQUFNLElBQUlILGlCQUFRLENBQUMsZ0JBQWdCLEVBQUUsR0FBRyxFQUFFLGNBQWMsQ0FBQztJQUMzRDtJQUNBLElBQUlHLElBQUksRUFBRUssU0FBUyxFQUFFO01BQ25CLE1BQU0sSUFBSVIsaUJBQVEsQ0FBQyxtQkFBbUIsRUFBRSxHQUFHLEVBQUUsZUFBZSxDQUFDO0lBQy9EO0lBRUFGLElBQUksQ0FBQ1csWUFBWSxHQUFHLEdBQUcsQ0FBQyxDQUFDOztJQUV6QixNQUFNQyxTQUFTLEdBQUdQLElBQUksQ0FBQ1EsUUFBUSxDQUM1QkMsR0FBRyxDQUFFQyxPQUFPLElBQUtBLE9BQU8sQ0FBQ0MsS0FBSyxDQUFDLENBQy9CQyxNQUFNLENBQUMsQ0FBQ2hDLENBQUMsRUFBRWlDLENBQUMsS0FBS2pDLENBQUMsR0FBR2lDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDOztJQUUvQixNQUFNQyxJQUFJLEdBQUc7TUFDWEMsTUFBTSxFQUFFdEIsR0FBRyxDQUFDdUIsSUFBSSxDQUFDRCxNQUFNO01BQ3ZCRSxjQUFjLEVBQUUsSUFBQUMsYUFBRSxFQUFDLENBQUM7TUFDcEJQLEtBQUssRUFBRUosU0FBUztNQUNoQkEsU0FBUyxFQUFFQSxTQUFTO01BQ3BCWSxRQUFRLEVBQUVDLGdCQUFPLENBQUNDLFFBQVEsQ0FBQ0MsR0FBRztNQUM5QkMsWUFBWSxFQUFFLEdBQUc7TUFDakJDLFFBQVEsRUFBRUMsTUFBTSxDQUFDekIsSUFBSSxFQUFFRyxHQUFHLENBQUM7TUFDM0J1QixjQUFjLEVBQUVOLGdCQUFPLENBQUNPLGVBQWUsQ0FBQ0MsR0FBRztNQUMzQ0MsWUFBWSxFQUFFVCxnQkFBTyxDQUFDVSxhQUFhLENBQUNDLE9BQU87TUFDM0NDLFdBQVcsRUFBRXJDLElBQUk7TUFDakJzQyxLQUFLLEVBQUU7UUFDTGYsRUFBRSxFQUFFTyxNQUFNLENBQUNoQyxHQUFHLENBQUN1QixJQUFJLENBQUNiLEdBQUcsQ0FBQztRQUN4QitCLElBQUksRUFBRXpDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRWtCLElBQUk7UUFDcEJDLE9BQU8sRUFBRTFDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRW1CLE9BQU87UUFDMUJDLFNBQVMsRUFBRTNDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRXFCLFdBQVc7UUFDaENDLEtBQUssRUFBRTdDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRXNCLEtBQUs7UUFDdEJDLGNBQWMsRUFBRTlDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRXVCLGNBQWM7UUFDeENDLGFBQWEsRUFBRSxJQUFBQyxlQUFNLEVBQUNoRCxHQUFHLENBQUN1QixJQUFJLEVBQUUwQixTQUFTLENBQUMsQ0FBQ0MsTUFBTSxDQUMvQyxxQkFDRixDQUFDO1FBQUU7UUFDSEMsZ0JBQWdCLEVBQUUsSUFBQUgsZUFBTSxFQUFDaEQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFMEIsU0FBUyxDQUFDLENBQUNDLE1BQU0sQ0FDbEQscUJBQ0YsQ0FBQztRQUNERSxtQkFBbUIsRUFBRXBELEdBQUcsQ0FBQ3VCLElBQUksRUFBRThCLE9BQU87UUFDdENDLEVBQUUsRUFBRXRELEdBQUcsQ0FBQ3VCLElBQUksRUFBRStCLEVBQUU7UUFDaEJDLElBQUksRUFBRXZELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWdDLElBQUk7UUFDcEJDLE9BQU8sRUFBRXhELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWlDLE9BQU87UUFDMUJDLE9BQU8sRUFBRXpELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWtDO01BQ3JCLENBQUM7TUFDREMsZUFBZSxFQUFFO1FBQ2ZDLFdBQVcsRUFBRTNELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWtCLElBQUksR0FBRyxFQUFFLEdBQUd6QyxHQUFHLENBQUN1QixJQUFJLEVBQUVtQixPQUFPO1FBQ3BEYSxJQUFJLEVBQUV2RCxHQUFHLENBQUN1QixJQUFJLEVBQUVnQyxJQUFJO1FBQ3BCQyxPQUFPLEVBQUV4RCxHQUFHLENBQUN1QixJQUFJLEVBQUVpQyxPQUFPO1FBQzFCSCxPQUFPLEVBQUVyRCxHQUFHLENBQUN1QixJQUFJLEVBQUU4QixPQUFPO1FBQzFCSSxPQUFPLEVBQUV6RCxHQUFHLENBQUN1QixJQUFJLEVBQUVrQztNQUNyQixDQUFDO01BQ0RHLGNBQWMsRUFBRTtRQUNkRCxXQUFXLEVBQUUzRCxHQUFHLENBQUN1QixJQUFJLEVBQUVrQixJQUFJLEdBQUcsRUFBRSxHQUFHekMsR0FBRyxDQUFDdUIsSUFBSSxFQUFFbUIsT0FBTztRQUNwRGEsSUFBSSxFQUFFdkQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFZ0MsSUFBSTtRQUNwQkMsT0FBTyxFQUFFeEQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFaUMsT0FBTztRQUMxQkgsT0FBTyxFQUFFckQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFOEIsT0FBTztRQUMxQkksT0FBTyxFQUFFekQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFa0M7TUFDckIsQ0FBQztNQUNESSxXQUFXLEVBQUV0RCxJQUFJLENBQUNRLFFBQVEsQ0FBQ0MsR0FBRyxDQUFDLENBQUNDLE9BQU8sRUFBRTZDLEtBQUssS0FBSztRQUNqRCxPQUFPO1VBQ0xyQyxFQUFFLEVBQUVPLE1BQU0sQ0FBQ2YsT0FBTyxFQUFFUCxHQUFHLENBQUM7VUFDeEIrQixJQUFJLEVBQUV4QixPQUFPLEVBQUV3QixJQUFJO1VBQ25Cc0IsU0FBUyxFQUFFOUMsT0FBTyxDQUFDK0MsVUFBVSxDQUFDLENBQUMsQ0FBQztVQUNoQ0MsU0FBUyxFQUFFaEQsT0FBTyxDQUFDK0MsVUFBVSxDQUFDLENBQUMsQ0FBQztVQUNoQ0UsUUFBUSxFQUFFdkMsZ0JBQU8sQ0FBQ3dDLGdCQUFnQixDQUFDbEQsT0FBTyxFQUFFaUQsUUFBUSxDQUFDO1VBQ3JEaEQsS0FBSyxFQUFFRCxPQUFPLEVBQUVDO1FBQ2xCLENBQUM7TUFDSCxDQUFDO0lBQ0gsQ0FBQztJQUVELElBQUlrRCxNQUFNLEdBQUcsTUFBTWpHLFFBQVEsQ0FBQ2tHLGFBQWEsQ0FBQ2hELElBQUksQ0FBQztJQUMvQyxNQUFNLElBQUFpRCwwQkFBZSxFQUFDRixNQUFNLENBQUM7SUFDN0JuRSxHQUFHLENBQUNzRSxJQUFJLENBQUNILE1BQU0sQ0FBQztFQUNsQixDQUFDLENBQUM7O0VBRUY7RUFDQXZFLE1BQU0sQ0FBQ0MsSUFBSSxDQUNULCtDQUErQyxFQUMvQ0MsZ0JBQU8sRUFDUCxPQUFPQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztJQUNsQixNQUFNO01BQUVDO0lBQUssQ0FBQyxHQUFHRixHQUFHLENBQUNHLElBQUk7SUFDekIsSUFBSSxDQUFDRCxJQUFJLEVBQUU7TUFDVCxNQUFNLElBQUlFLGlCQUFRLENBQUMsa0JBQWtCLEVBQUUsR0FBRyxFQUFFLGNBQWMsQ0FBQztJQUM3RDtJQUNBLElBQUksQ0FBQ0osR0FBRyxDQUFDSyxNQUFNLEVBQUVDLE1BQU0sRUFBRTtNQUN2QixNQUFNLElBQUlGLGlCQUFRLENBQUMsb0JBQW9CLEVBQUUsR0FBRyxFQUFFLGdCQUFnQixDQUFDO0lBQ2pFO0lBQ0EsTUFBTUcsSUFBSSxHQUFHLE1BQU1DLGFBQUssQ0FBQ0MsT0FBTyxDQUFDO01BQUVDLEdBQUcsRUFBRVYsR0FBRyxDQUFDSyxNQUFNLEVBQUVDO0lBQU8sQ0FBQyxDQUFDLENBQzFESyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQ2pCQSxRQUFRLENBQUMsVUFBVSxDQUFDO0lBQ3ZCLElBQUksQ0FBQ0osSUFBSSxFQUFFO01BQ1QsTUFBTSxJQUFJSCxpQkFBUSxDQUFDLGdCQUFnQixFQUFFLEdBQUcsRUFBRSxjQUFjLENBQUM7SUFDM0Q7SUFDQSxJQUFJRyxJQUFJLEVBQUVLLFNBQVMsRUFBRTtNQUNuQixNQUFNLElBQUlSLGlCQUFRLENBQUMsbUJBQW1CLEVBQUUsR0FBRyxFQUFFLGVBQWUsQ0FBQztJQUMvRDtJQUVBLElBQUlKLEdBQUcsQ0FBQ3VCLElBQUksRUFBRWlELFdBQVcsRUFBRTtNQUN6QnRFLElBQUksQ0FBQ3NFLFdBQVcsR0FBR3hFLEdBQUcsQ0FBQ3VCLElBQUksRUFBRWlELFdBQVc7SUFDMUM7SUFDQXRFLElBQUksQ0FBQ1csWUFBWSxHQUFHLEdBQUcsQ0FBQyxDQUFDOztJQUV6QixNQUFNQyxTQUFTLEdBQUdQLElBQUksQ0FBQ1EsUUFBUSxDQUM1QkMsR0FBRyxDQUFFQyxPQUFPLElBQUtBLE9BQU8sQ0FBQ0MsS0FBSyxDQUFDLENBQy9CQyxNQUFNLENBQUMsQ0FBQ2hDLENBQUMsRUFBRWlDLENBQUMsS0FBS2pDLENBQUMsR0FBR2lDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDOztJQUUvQixNQUFNQyxJQUFJLEdBQUc7TUFDWEMsTUFBTSxFQUFFdEIsR0FBRyxDQUFDdUIsSUFBSSxDQUFDRCxNQUFNO01BQ3ZCRSxjQUFjLEVBQUUsSUFBQUMsYUFBRSxFQUFDLENBQUM7TUFDcEJQLEtBQUssRUFBRUosU0FBUztNQUNoQkEsU0FBUyxFQUFFQSxTQUFTO01BQ3BCWSxRQUFRLEVBQUVDLGdCQUFPLENBQUNDLFFBQVEsQ0FBQ0MsR0FBRztNQUM5QkMsWUFBWSxFQUFFLEdBQUc7TUFDakJDLFFBQVEsRUFBRUMsTUFBTSxDQUFDekIsSUFBSSxFQUFFRyxHQUFHLENBQUM7TUFDM0J1QixjQUFjLEVBQUVOLGdCQUFPLENBQUNPLGVBQWUsQ0FBQ0MsR0FBRztNQUMzQ0MsWUFBWSxFQUFFVCxnQkFBTyxDQUFDVSxhQUFhLENBQUNDLE9BQU87TUFDM0NDLFdBQVcsRUFBRXJDLElBQUk7TUFDakJzQyxLQUFLLEVBQUU7UUFDTGYsRUFBRSxFQUFFTyxNQUFNLENBQUNoQyxHQUFHLENBQUN1QixJQUFJLENBQUNiLEdBQUcsQ0FBQztRQUN4QitCLElBQUksRUFBRXpDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRWtCLElBQUk7UUFDcEJDLE9BQU8sRUFBRTFDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRW1CLE9BQU87UUFDMUJDLFNBQVMsRUFBRTNDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRXFCLFdBQVc7UUFDaENDLEtBQUssRUFBRTdDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRXNCLEtBQUs7UUFDdEJDLGNBQWMsRUFBRTlDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRXVCLGNBQWM7UUFDeENDLGFBQWEsRUFBRSxJQUFBQyxlQUFNLEVBQUNoRCxHQUFHLENBQUN1QixJQUFJLEVBQUUwQixTQUFTLENBQUMsQ0FBQ0MsTUFBTSxDQUMvQyxxQkFDRixDQUFDO1FBQUU7UUFDSEMsZ0JBQWdCLEVBQUUsSUFBQUgsZUFBTSxFQUFDaEQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFMEIsU0FBUyxDQUFDLENBQUNDLE1BQU0sQ0FDbEQscUJBQ0YsQ0FBQztRQUNERSxtQkFBbUIsRUFBRXBELEdBQUcsQ0FBQ3VCLElBQUksRUFBRThCLE9BQU87UUFDdENDLEVBQUUsRUFBRXRELEdBQUcsQ0FBQ3VCLElBQUksRUFBRStCLEVBQUU7UUFDaEJDLElBQUksRUFBRXZELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWdDLElBQUk7UUFDcEJDLE9BQU8sRUFBRXhELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWlDLE9BQU87UUFDMUJDLE9BQU8sRUFBRXpELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWtDO01BQ3JCLENBQUM7TUFDREMsZUFBZSxFQUFFO1FBQ2ZDLFdBQVcsRUFBRTNELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWtCLElBQUksR0FBRyxFQUFFLEdBQUd6QyxHQUFHLENBQUN1QixJQUFJLEVBQUVtQixPQUFPO1FBQ3BEYSxJQUFJLEVBQUV2RCxHQUFHLENBQUN1QixJQUFJLEVBQUVnQyxJQUFJO1FBQ3BCQyxPQUFPLEVBQUV4RCxHQUFHLENBQUN1QixJQUFJLEVBQUVpQyxPQUFPO1FBQzFCSCxPQUFPLEVBQUVyRCxHQUFHLENBQUN1QixJQUFJLEVBQUU4QixPQUFPO1FBQzFCSSxPQUFPLEVBQUV6RCxHQUFHLENBQUN1QixJQUFJLEVBQUVrQztNQUNyQixDQUFDO01BQ0RHLGNBQWMsRUFBRTtRQUNkRCxXQUFXLEVBQUUzRCxHQUFHLENBQUN1QixJQUFJLEVBQUVrQixJQUFJLEdBQUcsRUFBRSxHQUFHekMsR0FBRyxDQUFDdUIsSUFBSSxFQUFFbUIsT0FBTztRQUNwRGEsSUFBSSxFQUFFdkQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFZ0MsSUFBSTtRQUNwQkMsT0FBTyxFQUFFeEQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFaUMsT0FBTztRQUMxQkgsT0FBTyxFQUFFckQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFOEIsT0FBTztRQUMxQkksT0FBTyxFQUFFekQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFa0M7TUFDckIsQ0FBQztNQUNESSxXQUFXLEVBQUV0RCxJQUFJLENBQUNRLFFBQVEsQ0FBQ0MsR0FBRyxDQUFDLENBQUNDLE9BQU8sRUFBRTZDLEtBQUssS0FBSztRQUNqRCxPQUFPO1VBQ0xyQyxFQUFFLEVBQUVPLE1BQU0sQ0FBQ2YsT0FBTyxFQUFFUCxHQUFHLENBQUM7VUFDeEIrQixJQUFJLEVBQUV4QixPQUFPLEVBQUV3QixJQUFJO1VBQ25Cc0IsU0FBUyxFQUFFOUMsT0FBTyxDQUFDK0MsVUFBVSxDQUFDLENBQUMsQ0FBQztVQUNoQ0MsU0FBUyxFQUFFaEQsT0FBTyxDQUFDK0MsVUFBVSxDQUFDLENBQUMsQ0FBQztVQUNoQ0UsUUFBUSxFQUFFdkMsZ0JBQU8sQ0FBQ3dDLGdCQUFnQixDQUFDbEQsT0FBTyxFQUFFaUQsUUFBUSxDQUFDO1VBQ3JEaEQsS0FBSyxFQUFFRCxPQUFPLEVBQUVDO1FBQ2xCLENBQUM7TUFDSCxDQUFDO0lBQ0gsQ0FBQztJQUVELElBQUlrRCxNQUFNLEdBQUcsTUFBTWpHLFFBQVEsQ0FBQ2tHLGFBQWEsQ0FBQ2hELElBQUksQ0FBQztJQUMvQyxJQUFJckIsR0FBRyxDQUFDdUIsSUFBSSxFQUFFaUQsV0FBVyxFQUFFO01BQ3pCLE1BQU1qRCxJQUFJLEdBQUcsTUFBTWtELGNBQUssQ0FBQ2hFLE9BQU8sQ0FBQztRQUFFQyxHQUFHLEVBQUVWLEdBQUcsQ0FBQ3VCLElBQUksRUFBRWI7TUFBSSxDQUFDLENBQUM7TUFDeERhLElBQUksQ0FBQ2lELFdBQVcsR0FBR0osTUFBTSxFQUFFSSxXQUFXO01BQ3RDLE1BQU1qRCxJQUFJLENBQUNtRCxJQUFJLENBQUMsQ0FBQztJQUNuQjtJQUNBLE1BQU0sSUFBQUosMEJBQWUsRUFBQ0YsTUFBTSxDQUFDO0lBQzdCbkUsR0FBRyxDQUFDc0UsSUFBSSxDQUFDSCxNQUFNLENBQUM7RUFDbEIsQ0FDRixDQUFDOztFQUVEO0VBQ0F2RSxNQUFNLENBQUNDLElBQUksQ0FDVCx5REFBeUQsRUFDekRDLGdCQUFPLEVBQ1AsT0FBT0MsR0FBRyxFQUFFQyxHQUFHLEtBQUs7SUFDbEIsSUFBSTtNQUFFMEU7SUFBVSxDQUFDLEdBQUczRSxHQUFHLENBQUNLLE1BQU07SUFDOUIsSUFBSSxDQUFDc0UsU0FBUyxFQUFFO01BQ2QsTUFBTSxJQUFJdkUsaUJBQVEsQ0FBQyx3QkFBd0IsRUFBRSxHQUFHLEVBQUUsbUJBQW1CLENBQUM7SUFDeEU7SUFDQSxJQUFJLENBQUNKLEdBQUcsQ0FBQ3VCLElBQUksRUFBRWlELFdBQVcsRUFBRTtNQUMxQixNQUFNLElBQUlwRSxpQkFBUSxDQUNoQiw4QkFBOEIsRUFDOUIsR0FBRyxFQUNILHFCQUNGLENBQUM7SUFDSDtJQUVBLE1BQU13RSxLQUFLLEdBQUcsTUFBTXZHLEtBQUssQ0FBQ3dHLFlBQVksQ0FBQztNQUNyQ3ZELE1BQU0sRUFBRXRCLEdBQUcsQ0FBQ3VCLElBQUksQ0FBQ0QsTUFBTTtNQUN2QkUsY0FBYyxFQUFFLElBQUFDLGFBQUUsRUFBQyxDQUFDO01BQ3BCK0MsV0FBVyxFQUFFeEUsR0FBRyxDQUFDdUIsSUFBSSxFQUFFaUQ7SUFDekIsQ0FBQyxDQUFDO0lBQ0YsTUFBTVYsS0FBSyxHQUFHZ0IsUUFBUSxDQUFDSCxTQUFTLENBQUM7SUFDakMsSUFBSWIsS0FBSyxJQUFJYyxLQUFLLEVBQUVHLFdBQVcsRUFBRUMsTUFBTSxFQUFFO01BQ3ZDLE1BQU0sSUFBSTVFLGlCQUFRLENBQUMscUJBQXFCLEVBQUUsR0FBRyxFQUFFLGtCQUFrQixDQUFDO0lBQ3BFO0lBQ0EsTUFBTTtNQUFFNkU7SUFBVSxDQUFDLEdBQUdMLEtBQUssRUFBRUcsV0FBVyxDQUFDakIsS0FBSyxDQUFDO0lBQy9DLElBQUksQ0FBQzlELEdBQUcsQ0FBQ0ssTUFBTSxFQUFFQyxNQUFNLEVBQUU7TUFDdkIsTUFBTSxJQUFJRixpQkFBUSxDQUFDLG9CQUFvQixFQUFFLEdBQUcsRUFBRSxnQkFBZ0IsQ0FBQztJQUNqRTtJQUNBLE1BQU1HLElBQUksR0FBRyxNQUFNQyxhQUFLLENBQUNDLE9BQU8sQ0FBQztNQUFFQyxHQUFHLEVBQUVWLEdBQUcsQ0FBQ0ssTUFBTSxFQUFFQztJQUFPLENBQUMsQ0FBQyxDQUMxREssUUFBUSxDQUFDLE9BQU8sQ0FBQyxDQUNqQkEsUUFBUSxDQUFDLFVBQVUsQ0FBQztJQUN2QixJQUFJLENBQUNKLElBQUksRUFBRTtNQUNULE1BQU0sSUFBSUgsaUJBQVEsQ0FBQyxnQkFBZ0IsRUFBRSxHQUFHLEVBQUUsY0FBYyxDQUFDO0lBQzNEO0lBQ0EsSUFBSUcsSUFBSSxFQUFFSyxTQUFTLEVBQUU7TUFDbkIsTUFBTSxJQUFJUixpQkFBUSxDQUFDLG1CQUFtQixFQUFFLEdBQUcsRUFBRSxlQUFlLENBQUM7SUFDL0Q7SUFFQSxNQUFNVSxTQUFTLEdBQUdQLElBQUksQ0FBQ1EsUUFBUSxDQUM1QkMsR0FBRyxDQUFFQyxPQUFPLElBQUtBLE9BQU8sQ0FBQ0MsS0FBSyxDQUFDLENBQy9CQyxNQUFNLENBQUMsQ0FBQ2hDLENBQUMsRUFBRWlDLENBQUMsS0FBS2pDLENBQUMsR0FBR2lDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDOztJQUUvQixNQUFNbEIsSUFBSSxHQUFHO01BQ1grRSxTQUFTO01BQ1RULFdBQVcsRUFBRXhFLEdBQUcsQ0FBQ3VCLElBQUksRUFBRWlEO0lBQ3pCLENBQUM7SUFFRCxNQUFNbkQsSUFBSSxHQUFHO01BQ1hDLE1BQU0sRUFBRXRCLEdBQUcsQ0FBQ3VCLElBQUksQ0FBQ0QsTUFBTTtNQUN2QkUsY0FBYyxFQUFFLElBQUFDLGFBQUUsRUFBQyxDQUFDO01BQ3BCUCxLQUFLLEVBQUVKLFNBQVM7TUFDaEJBLFNBQVMsRUFBRUEsU0FBUztNQUNwQlksUUFBUSxFQUFFQyxnQkFBTyxDQUFDQyxRQUFRLENBQUNDLEdBQUc7TUFDOUJDLFlBQVksRUFBRSxHQUFHO01BQ2pCQyxRQUFRLEVBQUVDLE1BQU0sQ0FBQ3pCLElBQUksRUFBRUcsR0FBRyxDQUFDO01BQzNCdUIsY0FBYyxFQUFFTixnQkFBTyxDQUFDTyxlQUFlLENBQUNDLEdBQUc7TUFDM0NDLFlBQVksRUFBRVQsZ0JBQU8sQ0FBQ1UsYUFBYSxDQUFDQyxPQUFPO01BQzNDQyxXQUFXLEVBQUVyQyxJQUFJO01BQ2pCc0MsS0FBSyxFQUFFO1FBQ0xmLEVBQUUsRUFBRU8sTUFBTSxDQUFDaEMsR0FBRyxDQUFDdUIsSUFBSSxDQUFDYixHQUFHLENBQUM7UUFDeEIrQixJQUFJLEVBQUV6QyxHQUFHLENBQUN1QixJQUFJLEVBQUVrQixJQUFJO1FBQ3BCQyxPQUFPLEVBQUUxQyxHQUFHLENBQUN1QixJQUFJLEVBQUVtQixPQUFPO1FBQzFCQyxTQUFTLEVBQUUzQyxHQUFHLENBQUN1QixJQUFJLEVBQUVxQixXQUFXO1FBQ2hDQyxLQUFLLEVBQUU3QyxHQUFHLENBQUN1QixJQUFJLEVBQUVzQixLQUFLO1FBQ3RCQyxjQUFjLEVBQUU5QyxHQUFHLENBQUN1QixJQUFJLEVBQUV1QixjQUFjO1FBQ3hDQyxhQUFhLEVBQUUsSUFBQUMsZUFBTSxFQUFDaEQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFMEIsU0FBUyxDQUFDLENBQUNDLE1BQU0sQ0FDL0MscUJBQ0YsQ0FBQztRQUFFO1FBQ0hDLGdCQUFnQixFQUFFLElBQUFILGVBQU0sRUFBQ2hELEdBQUcsQ0FBQ3VCLElBQUksRUFBRTBCLFNBQVMsQ0FBQyxDQUFDQyxNQUFNLENBQ2xELHFCQUNGLENBQUM7UUFDREUsbUJBQW1CLEVBQUVwRCxHQUFHLENBQUN1QixJQUFJLEVBQUU4QixPQUFPO1FBQ3RDQyxFQUFFLEVBQUV0RCxHQUFHLENBQUN1QixJQUFJLEVBQUUrQixFQUFFO1FBQ2hCQyxJQUFJLEVBQUV2RCxHQUFHLENBQUN1QixJQUFJLEVBQUVnQyxJQUFJO1FBQ3BCQyxPQUFPLEVBQUV4RCxHQUFHLENBQUN1QixJQUFJLEVBQUVpQyxPQUFPO1FBQzFCQyxPQUFPLEVBQUV6RCxHQUFHLENBQUN1QixJQUFJLEVBQUVrQztNQUNyQixDQUFDO01BQ0RDLGVBQWUsRUFBRTtRQUNmQyxXQUFXLEVBQUUzRCxHQUFHLENBQUN1QixJQUFJLEVBQUVrQixJQUFJLEdBQUcsRUFBRSxHQUFHekMsR0FBRyxDQUFDdUIsSUFBSSxFQUFFbUIsT0FBTztRQUNwRGEsSUFBSSxFQUFFdkQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFZ0MsSUFBSTtRQUNwQkMsT0FBTyxFQUFFeEQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFaUMsT0FBTztRQUMxQkgsT0FBTyxFQUFFckQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFOEIsT0FBTztRQUMxQkksT0FBTyxFQUFFekQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFa0M7TUFDckIsQ0FBQztNQUNERyxjQUFjLEVBQUU7UUFDZEQsV0FBVyxFQUFFM0QsR0FBRyxDQUFDdUIsSUFBSSxFQUFFa0IsSUFBSSxHQUFHLEVBQUUsR0FBR3pDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRW1CLE9BQU87UUFDcERhLElBQUksRUFBRXZELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWdDLElBQUk7UUFDcEJDLE9BQU8sRUFBRXhELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWlDLE9BQU87UUFDMUJILE9BQU8sRUFBRXJELEdBQUcsQ0FBQ3VCLElBQUksRUFBRThCLE9BQU87UUFDMUJJLE9BQU8sRUFBRXpELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWtDO01BQ3JCLENBQUM7TUFDREksV0FBVyxFQUFFdEQsSUFBSSxDQUFDUSxRQUFRLENBQUNDLEdBQUcsQ0FBQyxDQUFDQyxPQUFPLEVBQUU2QyxLQUFLLEtBQUs7UUFDakQsT0FBTztVQUNMckMsRUFBRSxFQUFFTyxNQUFNLENBQUNmLE9BQU8sRUFBRVAsR0FBRyxDQUFDO1VBQ3hCK0IsSUFBSSxFQUFFeEIsT0FBTyxFQUFFd0IsSUFBSTtVQUNuQnNCLFNBQVMsRUFBRTlDLE9BQU8sQ0FBQytDLFVBQVUsQ0FBQyxDQUFDLENBQUM7VUFDaENDLFNBQVMsRUFBRWhELE9BQU8sQ0FBQytDLFVBQVUsQ0FBQyxDQUFDLENBQUM7VUFDaENFLFFBQVEsRUFBRXZDLGdCQUFPLENBQUN3QyxnQkFBZ0IsQ0FBQ2xELE9BQU8sRUFBRWlELFFBQVEsQ0FBQztVQUNyRGhELEtBQUssRUFBRUQsT0FBTyxFQUFFQztRQUNsQixDQUFDO01BQ0gsQ0FBQztJQUNILENBQUM7SUFFRCxJQUFJa0QsTUFBTSxHQUFHLE1BQU1qRyxRQUFRLENBQUNrRyxhQUFhLENBQUNoRCxJQUFJLENBQUM7SUFDL0MsTUFBTSxJQUFBaUQsMEJBQWUsRUFBQ0YsTUFBTSxDQUFDO0lBQzdCbkUsR0FBRyxDQUFDc0UsSUFBSSxDQUFDSCxNQUFNLENBQUM7RUFDbEIsQ0FDRixDQUFDO0VBRUR2RSxNQUFNLENBQUNDLElBQUksQ0FDVCw4Q0FBOEMsRUFDOUNDLGdCQUFPLEVBQ1AsT0FBT0MsR0FBRyxFQUFFQyxHQUFHLEtBQUs7SUFDbEIsSUFBSTtNQUFFZ0Y7SUFBVSxDQUFDLEdBQUdqRixHQUFHLENBQUNHLElBQUk7SUFDNUIsSUFBSSxDQUFDOEUsU0FBUyxFQUFFO01BQ2QsTUFBTSxJQUFJN0UsaUJBQVEsQ0FBQyx3QkFBd0IsRUFBRSxHQUFHLEVBQUUsbUJBQW1CLENBQUM7SUFDeEU7SUFDQSxJQUFJLENBQUNKLEdBQUcsQ0FBQ3VCLElBQUksRUFBRWlELFdBQVcsRUFBRTtNQUMxQixNQUFNLElBQUlwRSxpQkFBUSxDQUNoQiw4QkFBOEIsRUFDOUIsR0FBRyxFQUNILHFCQUNGLENBQUM7SUFDSDtJQUVBLElBQUksQ0FBQ0osR0FBRyxDQUFDSyxNQUFNLEVBQUVDLE1BQU0sRUFBRTtNQUN2QixNQUFNLElBQUlGLGlCQUFRLENBQUMsb0JBQW9CLEVBQUUsR0FBRyxFQUFFLGdCQUFnQixDQUFDO0lBQ2pFO0lBQ0EsTUFBTUcsSUFBSSxHQUFHLE1BQU1DLGFBQUssQ0FBQ0MsT0FBTyxDQUFDO01BQUVDLEdBQUcsRUFBRVYsR0FBRyxDQUFDSyxNQUFNLEVBQUVDO0lBQU8sQ0FBQyxDQUFDLENBQzFESyxRQUFRLENBQUMsT0FBTyxDQUFDLENBQ2pCQSxRQUFRLENBQUMsVUFBVSxDQUFDO0lBQ3ZCLElBQUksQ0FBQ0osSUFBSSxFQUFFO01BQ1QsTUFBTSxJQUFJSCxpQkFBUSxDQUFDLGdCQUFnQixFQUFFLEdBQUcsRUFBRSxjQUFjLENBQUM7SUFDM0Q7SUFDQSxJQUFJRyxJQUFJLEVBQUVLLFNBQVMsRUFBRTtNQUNuQixNQUFNLElBQUlSLGlCQUFRLENBQUMsbUJBQW1CLEVBQUUsR0FBRyxFQUFFLGVBQWUsQ0FBQztJQUMvRDtJQUVBLE1BQU1VLFNBQVMsR0FBR1AsSUFBSSxDQUFDUSxRQUFRLENBQzVCQyxHQUFHLENBQUVDLE9BQU8sSUFBS0EsT0FBTyxDQUFDQyxLQUFLLENBQUMsQ0FDL0JDLE1BQU0sQ0FBQyxDQUFDaEMsQ0FBQyxFQUFFaUMsQ0FBQyxLQUFLakMsQ0FBQyxHQUFHaUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7O0lBRS9CLE1BQU1sQixJQUFJLEdBQUc7TUFDWCtFLFNBQVM7TUFDVFQsV0FBVyxFQUFFeEUsR0FBRyxDQUFDdUIsSUFBSSxFQUFFaUQ7SUFDekIsQ0FBQztJQUVELE1BQU1uRCxJQUFJLEdBQUc7TUFDWEMsTUFBTSxFQUFFdEIsR0FBRyxDQUFDdUIsSUFBSSxDQUFDRCxNQUFNO01BQ3ZCRSxjQUFjLEVBQUUsSUFBQUMsYUFBRSxFQUFDLENBQUM7TUFDcEJQLEtBQUssRUFBRUosU0FBUztNQUNoQkEsU0FBUyxFQUFFQSxTQUFTO01BQ3BCWSxRQUFRLEVBQUVDLGdCQUFPLENBQUNDLFFBQVEsQ0FBQ0MsR0FBRztNQUM5QkMsWUFBWSxFQUFFLEdBQUc7TUFDakJDLFFBQVEsRUFBRUMsTUFBTSxDQUFDekIsSUFBSSxFQUFFRyxHQUFHLENBQUM7TUFDM0J1QixjQUFjLEVBQUVOLGdCQUFPLENBQUNPLGVBQWUsQ0FBQ0MsR0FBRztNQUMzQ0MsWUFBWSxFQUFFVCxnQkFBTyxDQUFDVSxhQUFhLENBQUNDLE9BQU87TUFDM0NDLFdBQVcsRUFBRXJDLElBQUk7TUFDakJzQyxLQUFLLEVBQUU7UUFDTGYsRUFBRSxFQUFFTyxNQUFNLENBQUNoQyxHQUFHLENBQUN1QixJQUFJLENBQUNiLEdBQUcsQ0FBQztRQUN4QitCLElBQUksRUFBRXpDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRWtCLElBQUk7UUFDcEJDLE9BQU8sRUFBRTFDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRW1CLE9BQU87UUFDMUJDLFNBQVMsRUFBRTNDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRXFCLFdBQVc7UUFDaENDLEtBQUssRUFBRTdDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRXNCLEtBQUs7UUFDdEJDLGNBQWMsRUFBRTlDLEdBQUcsQ0FBQ3VCLElBQUksRUFBRXVCLGNBQWM7UUFDeENDLGFBQWEsRUFBRSxJQUFBQyxlQUFNLEVBQUNoRCxHQUFHLENBQUN1QixJQUFJLEVBQUUwQixTQUFTLENBQUMsQ0FBQ0MsTUFBTSxDQUMvQyxxQkFDRixDQUFDO1FBQUU7UUFDSEMsZ0JBQWdCLEVBQUUsSUFBQUgsZUFBTSxFQUFDaEQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFMEIsU0FBUyxDQUFDLENBQUNDLE1BQU0sQ0FDbEQscUJBQ0YsQ0FBQztRQUNERSxtQkFBbUIsRUFBRXBELEdBQUcsQ0FBQ3VCLElBQUksRUFBRThCLE9BQU87UUFDdENDLEVBQUUsRUFBRXRELEdBQUcsQ0FBQ3VCLElBQUksRUFBRStCLEVBQUU7UUFDaEJDLElBQUksRUFBRXZELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWdDLElBQUk7UUFDcEJDLE9BQU8sRUFBRXhELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWlDLE9BQU87UUFDMUJDLE9BQU8sRUFBRXpELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWtDO01BQ3JCLENBQUM7TUFDREMsZUFBZSxFQUFFO1FBQ2ZDLFdBQVcsRUFBRTNELEdBQUcsQ0FBQ3VCLElBQUksRUFBRWtCLElBQUksR0FBRyxFQUFFLEdBQUd6QyxHQUFHLENBQUN1QixJQUFJLEVBQUVtQixPQUFPO1FBQ3BEYSxJQUFJLEVBQUV2RCxHQUFHLENBQUN1QixJQUFJLEVBQUVnQyxJQUFJO1FBQ3BCQyxPQUFPLEVBQUV4RCxHQUFHLENBQUN1QixJQUFJLEVBQUVpQyxPQUFPO1FBQzFCSCxPQUFPLEVBQUVyRCxHQUFHLENBQUN1QixJQUFJLEVBQUU4QixPQUFPO1FBQzFCSSxPQUFPLEVBQUV6RCxHQUFHLENBQUN1QixJQUFJLEVBQUVrQztNQUNyQixDQUFDO01BQ0RHLGNBQWMsRUFBRTtRQUNkRCxXQUFXLEVBQUUzRCxHQUFHLENBQUN1QixJQUFJLEVBQUVrQixJQUFJLEdBQUcsRUFBRSxHQUFHekMsR0FBRyxDQUFDdUIsSUFBSSxFQUFFbUIsT0FBTztRQUNwRGEsSUFBSSxFQUFFdkQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFZ0MsSUFBSTtRQUNwQkMsT0FBTyxFQUFFeEQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFaUMsT0FBTztRQUMxQkgsT0FBTyxFQUFFckQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFOEIsT0FBTztRQUMxQkksT0FBTyxFQUFFekQsR0FBRyxDQUFDdUIsSUFBSSxFQUFFa0M7TUFDckIsQ0FBQztNQUNESSxXQUFXLEVBQUV0RCxJQUFJLENBQUNRLFFBQVEsQ0FBQ0MsR0FBRyxDQUFDLENBQUNDLE9BQU8sRUFBRTZDLEtBQUssS0FBSztRQUNqRCxPQUFPO1VBQ0xyQyxFQUFFLEVBQUVPLE1BQU0sQ0FBQ2YsT0FBTyxFQUFFUCxHQUFHLENBQUM7VUFDeEIrQixJQUFJLEVBQUV4QixPQUFPLEVBQUV3QixJQUFJO1VBQ25Cc0IsU0FBUyxFQUFFOUMsT0FBTyxDQUFDK0MsVUFBVSxDQUFDLENBQUMsQ0FBQztVQUNoQ0MsU0FBUyxFQUFFaEQsT0FBTyxDQUFDK0MsVUFBVSxDQUFDLENBQUMsQ0FBQztVQUNoQ0UsUUFBUSxFQUFFdkMsZ0JBQU8sQ0FBQ3dDLGdCQUFnQixDQUFDbEQsT0FBTyxFQUFFaUQsUUFBUSxDQUFDO1VBQ3JEaEQsS0FBSyxFQUFFRCxPQUFPLEVBQUVDO1FBQ2xCLENBQUM7TUFDSCxDQUFDO0lBQ0gsQ0FBQztJQUVELElBQUlrRCxNQUFNLEdBQUcsTUFBTWpHLFFBQVEsQ0FBQ2tHLGFBQWEsQ0FBQ2hELElBQUksQ0FBQztJQUMvQyxNQUFNLElBQUFpRCwwQkFBZSxFQUFDRixNQUFNLENBQUM7SUFDN0JuRSxHQUFHLENBQUNzRSxJQUFJLENBQUNILE1BQU0sQ0FBQztFQUNsQixDQUNGLENBQUM7QUFDSCxDQUFDO0FBQUFjLE9BQUEsQ0FBQXBHLE9BQUEsR0FBQWMsUUFBQSIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_moment","_interopRequireDefault","require","_iyzipay","_cart","_users","_ApiError","_Session","Payments","_interopRequireWildcard","Cards","_uuid","_payments2","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","_default","router","post","Session","req","res","card","body","ApiError","params","cartId","cart","Carts","findOne","_id","populate","completed","registerCard","paidPrice","products","map","product","price","reduce","b","data","locale","user","conversationId","id","currency","Iyzipay","CURRENCY","TRY","installments","basketId","String","paymentChannel","PAYMENT_CHANNEL","WEB","paymentGroup","PAYMENT_GROUP","PRODUCT","paymentCard","buyer","name","surname","gsmNumber","phoneNumber","email","identityNumber","lastLoginDate","moment","updatedAt","format","registrationDate","registrationAddress","address","ip","city","country","zipCode","shippingAddress","contactName","billingAddress","basketItems","index","category1","categories","category2","itemType","BASKET_ITEM_TYPE","result","createPayment","CompletePayment","json","cardUserKey","Users","save","cardIndex","cards","getUserCards","parseInt","cardDetails","length","cardToken","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["Payments.js"],"sourcesContent":["import moment from \"moment\";\nimport Iyzipay from \"iyzipay\";\nimport Carts from \"../db/cart\";\nimport Users from \"../db/users\";\nimport ApiError from \"../errors/ApiError\";\nimport Session from \"../middlewares/Session\";\nimport * as Payments from \"../services/iyzico/methods/payments\";\nimport * as Cards from \"../services/iyzico/methods/cards\";\nimport id from \"../utils/uuid\";\nimport { CompletePayment } from \"../utils/payments\";\n\nexport default (router) => {\n  //yeni bir kartla ödeme oluştur ve kartı kaydetme\n  router.post(\"/payments/:cartId/with-new-card\", Session, async (req, res) => {\n    const { card } = req.body;\n    if (!card) {\n      throw new ApiError(\"Card is required\", 400, \"cardRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await Carts.findOne({ _id: req.params?.cartId })\n      .populate(\"buyer\")\n      .populate(\"products\");\n    if (!cart) {\n      throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n\n    card.registerCard = \"0\"; //methodslarda registerCard:1 yani kartı kaydet demek ama şuan kaydetme dediğim için 0 yaptım\n\n    const paidPrice = cart.products\n      .map((product) => product.price)\n      .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const data = {\n      locale: req.user.locale,\n      conversationId: id(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: Iyzipay.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n      paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: moment(req.user?.updatedAt).format(\n          \"YYYY-MM-DD HH:mm:ss\"\n        ), //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: moment(req.user?.updatedAt).format(\n          \"YYYY-MM-DD HH:mm:ss\"\n        ),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode,\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode,\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode,\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price,\n        };\n      }),\n    };\n\n    let result = await Payments.createPayment(data);\n    await CompletePayment(result);\n    res.json(result);\n  });\n\n  //yeni bir ödeme oluştur ve kart kaydet\n  router.post(\n    \"/payments/:cartId/with-new-card/register-card\",\n    Session,\n    async (req, res) => {\n      const { card } = req.body;\n      if (!card) {\n        throw new ApiError(\"Card is required\", 400, \"cardRequired\");\n      }\n      if (!req.params?.cartId) {\n        throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      }\n      const cart = await Carts.findOne({ _id: req.params?.cartId })\n        .populate(\"buyer\")\n        .populate(\"products\");\n      if (!cart) {\n        throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n      }\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      if (req.user?.cardUserKey) {\n        card.cardUserKey = req.user?.cardUserKey;\n      }\n      card.registerCard = \"1\"; //methodslarda registerCard:1 yani kartı kaydet\n\n      const paidPrice = cart.products\n        .map((product) => product.price)\n        .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: paidPrice,\n        paidPrice: paidPrice,\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        paymentCard: card,\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ), //iyizpay tarih formatına çevirmek için yapıldı\n          registrationDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems: cart.products.map((product, index) => {\n          return {\n            id: String(product?._id),\n            name: product?.name,\n            category1: product.categories[0],\n            category2: product.categories[1],\n            itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n            price: product?.price,\n          };\n        }),\n      };\n\n      let result = await Payments.createPayment(data);\n      if (req.user?.cardUserKey) {\n        const user = await Users.findOne({ _id: req.user?._id });\n        user.cardUserKey = result?.cardUserKey;\n        await user.save();\n      }\n      await CompletePayment(result);\n      res.json(result);\n    }\n  );\n\n  //hali hazırda bulunan kart ile ödeme\n  router.post(\n    \"/payments/:cartId/:cardIndex/with-registered-card-index\",\n    Session,\n    async (req, res) => {\n      let { cardIndex } = req.params;\n      if (!cardIndex) {\n        throw new ApiError(\"Card index is required\", 400, \"cardIndexRequired\");\n      }\n      if (!req.user?.cardUserKey) {\n        throw new ApiError(\n          \"No registered card available\",\n          400,\n          \"cardUserKeyRequired\"\n        );\n      }\n\n      const cards = await Cards.getUserCards({\n        locale: req.user.locale,\n        conversationId: id(),\n        cardUserKey: req.user?.cardUserKey,\n      });\n      const index = parseInt(cardIndex);\n      if (index >= cards?.cardDetails?.length) {\n        throw new ApiError(\"Card does not exist\", 400, \"cardIndexInvalid\");\n      }\n      const { cardToken } = cards?.cardDetails[index];\n      if (!req.params?.cartId) {\n        throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      }\n      const cart = await Carts.findOne({ _id: req.params?.cartId })\n        .populate(\"buyer\")\n        .populate(\"products\");\n      if (!cart) {\n        throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n      }\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      const paidPrice = cart.products\n        .map((product) => product.price)\n        .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n      const card = {\n        cardToken,\n        cardUserKey: req.user?.cardUserKey,\n      };\n\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: paidPrice,\n        paidPrice: paidPrice,\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        paymentCard: card,\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ), //iyizpay tarih formatına çevirmek için yapıldı\n          registrationDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems: cart.products.map((product, index) => {\n          return {\n            id: String(product?._id),\n            name: product?.name,\n            category1: product.categories[0],\n            category2: product.categories[1],\n            itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n            price: product?.price,\n          };\n        }),\n      };\n\n      let result = await Payments.createPayment(data);\n      await CompletePayment(result);\n      res.json(result);\n    }\n  );\n\n  router.post(\n    \"/payments/:cartId/with-registered-card-token\",\n    Session,\n    async (req, res) => {\n      let { cardToken } = req.body;\n      if (!cardToken) {\n        throw new ApiError(\"Card Token is required\", 400, \"cardTokenRequired\");\n      }\n      if (!req.user?.cardUserKey) {\n        throw new ApiError(\n          \"No registered card available\",\n          400,\n          \"cardUserKeyRequired\"\n        );\n      }\n\n      if (!req.params?.cartId) {\n        throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      }\n      const cart = await Carts.findOne({ _id: req.params?.cartId })\n        .populate(\"buyer\")\n        .populate(\"products\");\n      if (!cart) {\n        throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n      }\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      const paidPrice = cart.products\n        .map((product) => product.price)\n        .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n      const card = {\n        cardToken,\n        cardUserKey: req.user?.cardUserKey,\n      };\n\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: paidPrice,\n        paidPrice: paidPrice,\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        paymentCard: card,\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ), //iyizpay tarih formatına çevirmek için yapıldı\n          registrationDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems: cart.products.map((product, index) => {\n          return {\n            id: String(product?._id),\n            name: product?.name,\n            category1: product.categories[0],\n            category2: product.categories[1],\n            itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n            price: product?.price,\n          };\n        }),\n      };\n\n      let result = await Payments.createPayment(data);\n      await CompletePayment(result);\n      res.json(result);\n    }\n  );\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1723544661896},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/payments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createPayment = void 0;\nvar _iyzipay = _interopRequireDefault(require(\"../connection/iyzipay\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst createPayment = data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.payment.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.createPayment = createPayment;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaXl6aXBheSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiY3JlYXRlUGF5bWVudCIsImRhdGEiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIml5emlwYXkiLCJwYXltZW50IiwiY3JlYXRlIiwiZXJyIiwicmVzdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3NlcnZpY2VzL2l5emljby9tZXRob2RzLyIsInNvdXJjZXMiOlsicGF5bWVudHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGl5emlwYXkgZnJvbSBcIi4uL2Nvbm5lY3Rpb24vaXl6aXBheVwiO1xuXG5leHBvcnQgY29uc3QgY3JlYXRlUGF5bWVudCA9IChkYXRhKSA9PiB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgaXl6aXBheS5wYXltZW50LmNyZWF0ZShkYXRhLCAoZXJyLCByZXN1bHQpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsUUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQTRDLFNBQUFELHVCQUFBRSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBRXJDLE1BQU1HLGFBQWEsR0FBSUMsSUFBSSxJQUFLO0VBQ3JDLE9BQU8sSUFBSUMsT0FBTyxDQUFDLENBQUNDLE9BQU8sRUFBRUMsTUFBTSxLQUFLO0lBQ3RDQyxnQkFBTyxDQUFDQyxPQUFPLENBQUNDLE1BQU0sQ0FBQ04sSUFBSSxFQUFFLENBQUNPLEdBQUcsRUFBRUMsTUFBTSxLQUFLO01BQzVDLElBQUlELEdBQUcsRUFBRTtRQUNQSixNQUFNLENBQUNJLEdBQUcsQ0FBQztNQUNiLENBQUMsTUFBTTtRQUNMTCxPQUFPLENBQUNNLE1BQU0sQ0FBQztNQUNqQjtJQUNGLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztBQUNKLENBQUM7QUFBQ0MsT0FBQSxDQUFBVixhQUFBLEdBQUFBLGFBQUEiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_iyzipay","_interopRequireDefault","require","e","__esModule","default","createPayment","data","Promise","resolve","reject","iyzipay","payment","create","err","result","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/","sources":["payments.js"],"sourcesContent":["import iyzipay from \"../connection/iyzipay\";\n\nexport const createPayment = (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.payment.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA4C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAErC,MAAMG,aAAa,GAAIC,IAAI,IAAK;EACrC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,OAAO,CAACC,MAAM,CAACN,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MAC5C,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAV,aAAA,GAAAA,aAAA","ignoreList":[]}},"mtime":1723543937124},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/connection/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/connection/iyzipay.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _iyzipay = _interopRequireDefault(require(\"iyzipay\"));\nvar _config = _interopRequireDefault(require(\"../config/config\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst iyzipay = new _iyzipay.default(_config.default);\nvar _default = exports.default = iyzipay;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaXl6aXBheSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2NvbmZpZyIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIml5emlwYXkiLCJJeXppcGF5IiwiY29uZmlnIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvc2VydmljZXMvaXl6aWNvL2Nvbm5lY3Rpb24vIiwic291cmNlcyI6WyJpeXppcGF5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBJeXppcGF5IGZyb20gXCJpeXppcGF5XCI7XG5pbXBvcnQgY29uZmlnIGZyb20gXCIuLi9jb25maWcvY29uZmlnXCI7XG5cbmNvbnN0IGl5emlwYXkgPSBuZXcgSXl6aXBheShjb25maWcpO1xuXG5leHBvcnQgZGVmYXVsdCBpeXppcGF5O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxRQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxPQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFBc0MsU0FBQUQsdUJBQUFHLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFdEMsTUFBTUcsT0FBTyxHQUFHLElBQUlDLGdCQUFPLENBQUNDLGVBQU0sQ0FBQztBQUFDLElBQUFDLFFBQUEsR0FBQUMsT0FBQSxDQUFBTCxPQUFBLEdBRXJCQyxPQUFPIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["_iyzipay","_interopRequireDefault","require","_config","e","__esModule","default","iyzipay","Iyzipay","config","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/connection/","sources":["iyzipay.js"],"sourcesContent":["import Iyzipay from \"iyzipay\";\nimport config from \"../config/config\";\n\nconst iyzipay = new Iyzipay(config);\n\nexport default iyzipay;\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,OAAA,GAAAF,sBAAA,CAAAC,OAAA;AAAsC,SAAAD,uBAAAG,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEtC,MAAMG,OAAO,GAAG,IAAIC,gBAAO,CAACC,eAAM,CAAC;AAAC,IAAAC,QAAA,GAAAC,OAAA,CAAAL,OAAA,GAErBC,OAAO","ignoreList":[]}},"mtime":1723543937086},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/config/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/config/config.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\n//atkahmed9924@gmail.com\n// module.exports = {\n//   apiKey: \"sandbox-bkqCdxvCL1VB4bIisfgw9jIjhGHnanvp\",\n//   secretKey: \"7dvI95bSaaTgGKKolbDaOclal0iItwKg\",\n//   uri: \"https://sandbox-api.iyzipay.com\",\n// };\n\n//ahmed@turkotrend.com\nmodule.exports = {\n  apiKey: \"sandbox-6JrPHZxVTHmEzlLtD26I4mPoJDwUF07L\",\n  secretKey: \"sandbox-gvP5g1t24UWymP9K04JDuWjIWzZZwIDs\",\n  uri: \"https://sandbox-api.iyzipay.com\"\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb2R1bGUiLCJleHBvcnRzIiwiYXBpS2V5Iiwic2VjcmV0S2V5IiwidXJpIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvc2VydmljZXMvaXl6aWNvL2NvbmZpZy8iLCJzb3VyY2VzIjpbImNvbmZpZy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvL2F0a2FobWVkOTkyNEBnbWFpbC5jb21cbi8vIG1vZHVsZS5leHBvcnRzID0ge1xuLy8gICBhcGlLZXk6IFwic2FuZGJveC1ia3FDZHh2Q0wxVkI0Yklpc2ZndzlqSWpoR0huYW52cFwiLFxuLy8gICBzZWNyZXRLZXk6IFwiN2R2STk1YlNhYVRnR0tLb2xiRGFPY2xhbDBpSXR3S2dcIixcbi8vICAgdXJpOiBcImh0dHBzOi8vc2FuZGJveC1hcGkuaXl6aXBheS5jb21cIixcbi8vIH07XG5cbi8vYWhtZWRAdHVya290cmVuZC5jb21cbm1vZHVsZS5leHBvcnRzID0ge1xuICBhcGlLZXk6IFwic2FuZGJveC02SnJQSFp4VlRIbUV6bEx0RDI2STRtUG9KRHdVRjA3TFwiLFxuICBzZWNyZXRLZXk6IFwic2FuZGJveC1ndlA1ZzF0MjRVV3ltUDlLMDRKRHVXaklXelpad0lEc1wiLFxuICB1cmk6IFwiaHR0cHM6Ly9zYW5kYm94LWFwaS5peXppcGF5LmNvbVwiLFxufTtcbiJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQUEsTUFBTSxDQUFDQyxPQUFPLEdBQUc7RUFDZkMsTUFBTSxFQUFFLDBDQUEwQztFQUNsREMsU0FBUyxFQUFFLDBDQUEwQztFQUNyREMsR0FBRyxFQUFFO0FBQ1AsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["module","exports","apiKey","secretKey","uri"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/config/","sources":["config.js"],"sourcesContent":["//atkahmed9924@gmail.com\n// module.exports = {\n//   apiKey: \"sandbox-bkqCdxvCL1VB4bIisfgw9jIjhGHnanvp\",\n//   secretKey: \"7dvI95bSaaTgGKKolbDaOclal0iItwKg\",\n//   uri: \"https://sandbox-api.iyzipay.com\",\n// };\n\n//ahmed@turkotrend.com\nmodule.exports = {\n  apiKey: \"sandbox-6JrPHZxVTHmEzlLtD26I4mPoJDwUF07L\",\n  secretKey: \"sandbox-gvP5g1t24UWymP9K04JDuWjIWzZZwIDs\",\n  uri: \"https://sandbox-api.iyzipay.com\",\n};\n"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACAA,MAAM,CAACC,OAAO,GAAG;EACfC,MAAM,EAAE,0CAA0C;EAClDC,SAAS,EAAE,0CAA0C;EACrDC,GAAG,EAAE;AACP,CAAC","ignoreList":[]}},"mtime":1731316713759},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/cards.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getUserCards = exports.deleteUserCard = exports.createUserCard = void 0;\nvar _iyzipay = _interopRequireDefault(require(\"../connection/iyzipay\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst createUserCard = async data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.card.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.createUserCard = createUserCard;\nconst getUserCards = async data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.cardList.retrieve(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.getUserCards = getUserCards;\nconst deleteUserCard = async data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.card.delete(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.deleteUserCard = deleteUserCard;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaXl6aXBheSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiY3JlYXRlVXNlckNhcmQiLCJkYXRhIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJpeXppcGF5IiwiY2FyZCIsImNyZWF0ZSIsImVyciIsInJlc3VsdCIsImV4cG9ydHMiLCJnZXRVc2VyQ2FyZHMiLCJjYXJkTGlzdCIsInJldHJpZXZlIiwiZGVsZXRlVXNlckNhcmQiLCJkZWxldGUiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9zZXJ2aWNlcy9peXppY28vbWV0aG9kcy8iLCJzb3VyY2VzIjpbImNhcmRzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBpeXppcGF5IGZyb20gXCIuLi9jb25uZWN0aW9uL2l5emlwYXlcIjtcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZVVzZXJDYXJkID0gYXN5bmMgKGRhdGEpID0+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBpeXppcGF5LmNhcmQuY3JlYXRlKGRhdGEsIChlcnIsIHJlc3VsdCkgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0VXNlckNhcmRzID0gYXN5bmMgKGRhdGEpID0+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBpeXppcGF5LmNhcmRMaXN0LnJldHJpZXZlKGRhdGEsIChlcnIsIHJlc3VsdCkgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59O1xuXG5leHBvcnQgY29uc3QgZGVsZXRlVXNlckNhcmQgPSBhc3luYyAoZGF0YSkgPT4ge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGl5emlwYXkuY2FyZC5kZWxldGUoZGF0YSwgKGVyciwgcmVzdWx0KSA9PiB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFFBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUE0QyxTQUFBRCx1QkFBQUUsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUVyQyxNQUFNRyxjQUFjLEdBQUcsTUFBT0MsSUFBSSxJQUFLO0VBQzVDLE9BQU8sSUFBSUMsT0FBTyxDQUFDLENBQUNDLE9BQU8sRUFBRUMsTUFBTSxLQUFLO0lBQ3RDQyxnQkFBTyxDQUFDQyxJQUFJLENBQUNDLE1BQU0sQ0FBQ04sSUFBSSxFQUFFLENBQUNPLEdBQUcsRUFBRUMsTUFBTSxLQUFLO01BQ3pDLElBQUlELEdBQUcsRUFBRTtRQUNQSixNQUFNLENBQUNJLEdBQUcsQ0FBQztNQUNiLENBQUMsTUFBTTtRQUNMTCxPQUFPLENBQUNNLE1BQU0sQ0FBQztNQUNqQjtJQUNGLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztBQUNKLENBQUM7QUFBQ0MsT0FBQSxDQUFBVixjQUFBLEdBQUFBLGNBQUE7QUFFSyxNQUFNVyxZQUFZLEdBQUcsTUFBT1YsSUFBSSxJQUFLO0VBQzFDLE9BQU8sSUFBSUMsT0FBTyxDQUFDLENBQUNDLE9BQU8sRUFBRUMsTUFBTSxLQUFLO0lBQ3RDQyxnQkFBTyxDQUFDTyxRQUFRLENBQUNDLFFBQVEsQ0FBQ1osSUFBSSxFQUFFLENBQUNPLEdBQUcsRUFBRUMsTUFBTSxLQUFLO01BQy9DLElBQUlELEdBQUcsRUFBRTtRQUNQSixNQUFNLENBQUNJLEdBQUcsQ0FBQztNQUNiLENBQUMsTUFBTTtRQUNMTCxPQUFPLENBQUNNLE1BQU0sQ0FBQztNQUNqQjtJQUNGLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztBQUNKLENBQUM7QUFBQ0MsT0FBQSxDQUFBQyxZQUFBLEdBQUFBLFlBQUE7QUFFSyxNQUFNRyxjQUFjLEdBQUcsTUFBT2IsSUFBSSxJQUFLO0VBQzVDLE9BQU8sSUFBSUMsT0FBTyxDQUFDLENBQUNDLE9BQU8sRUFBRUMsTUFBTSxLQUFLO0lBQ3RDQyxnQkFBTyxDQUFDQyxJQUFJLENBQUNTLE1BQU0sQ0FBQ2QsSUFBSSxFQUFFLENBQUNPLEdBQUcsRUFBRUMsTUFBTSxLQUFLO01BQ3pDLElBQUlELEdBQUcsRUFBRTtRQUNQSixNQUFNLENBQUNJLEdBQUcsQ0FBQztNQUNiLENBQUMsTUFBTTtRQUNMTCxPQUFPLENBQUNNLE1BQU0sQ0FBQztNQUNqQjtJQUNGLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztBQUNKLENBQUM7QUFBQ0MsT0FBQSxDQUFBSSxjQUFBLEdBQUFBLGNBQUEiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_iyzipay","_interopRequireDefault","require","e","__esModule","default","createUserCard","data","Promise","resolve","reject","iyzipay","card","create","err","result","exports","getUserCards","cardList","retrieve","deleteUserCard","delete"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/","sources":["cards.js"],"sourcesContent":["import iyzipay from \"../connection/iyzipay\";\n\nexport const createUserCard = async (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.card.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n\nexport const getUserCards = async (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.cardList.retrieve(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n\nexport const deleteUserCard = async (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.card.delete(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA4C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAErC,MAAMG,cAAc,GAAG,MAAOC,IAAI,IAAK;EAC5C,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,IAAI,CAACC,MAAM,CAACN,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MACzC,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAV,cAAA,GAAAA,cAAA;AAEK,MAAMW,YAAY,GAAG,MAAOV,IAAI,IAAK;EAC1C,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACO,QAAQ,CAACC,QAAQ,CAACZ,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MAC/C,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAC,YAAA,GAAAA,YAAA;AAEK,MAAMG,cAAc,GAAG,MAAOb,IAAI,IAAK;EAC5C,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,IAAI,CAACS,MAAM,CAACd,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MACzC,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAI,cAAA,GAAAA,cAAA","ignoreList":[]}},"mtime":1723543937120},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/utils/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/utils/payments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CompletePayment = void 0;\nvar _mongoose = require(\"mongoose\");\nvar _paymentSuccess = _interopRequireDefault(require(\"../db/payment-success\"));\nvar _paymentFailed = _interopRequireDefault(require(\"../db/payment-failed\"));\nvar _cart = _interopRequireDefault(require(\"../db/cart\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst {\n  ObjectId\n} = _mongoose.Types;\nconst CompletePayment = async result => {\n  if (result?.status === \"success\") {\n    await _cart.default.updateOne({\n      _id: new ObjectId(result.basketId)\n    }, {\n      $set: {\n        completed: true\n      }\n    });\n    await _paymentSuccess.default.create({\n      status: result?.status,\n      cartId: result?.basketId,\n      conversationId: result?.conversationId,\n      currency: result?.currency,\n      paymentId: result?.paymentId,\n      price: result?.price,\n      paidPrice: result?.paidPrice,\n      itemTransactions: result?.itemTransactions.map(item => {\n        return {\n          itemId: item?.itemId,\n          paymentTransactionId: item?.paymentTransactionId,\n          price: item?.price,\n          paidPrice: item?.paidPrice\n        };\n      }),\n      log: result\n    });\n  } else {\n    await _paymentFailed.default.create({\n      status: result?.status,\n      conversationId: result?.conversationId,\n      errorCode: result?.errorCode,\n      errorMessage: result?.errorMessage,\n      log: result\n    });\n  }\n};\nexports.CompletePayment = CompletePayment;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJyZXF1aXJlIiwiX3BheW1lbnRTdWNjZXNzIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIl9wYXltZW50RmFpbGVkIiwiX2NhcnQiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJPYmplY3RJZCIsIlR5cGVzIiwiQ29tcGxldGVQYXltZW50IiwicmVzdWx0Iiwic3RhdHVzIiwiQ2FydHMiLCJ1cGRhdGVPbmUiLCJfaWQiLCJiYXNrZXRJZCIsIiRzZXQiLCJjb21wbGV0ZWQiLCJQYXltZW50U3VjY2VzcyIsImNyZWF0ZSIsImNhcnRJZCIsImNvbnZlcnNhdGlvbklkIiwiY3VycmVuY3kiLCJwYXltZW50SWQiLCJwcmljZSIsInBhaWRQcmljZSIsIml0ZW1UcmFuc2FjdGlvbnMiLCJtYXAiLCJpdGVtIiwiaXRlbUlkIiwicGF5bWVudFRyYW5zYWN0aW9uSWQiLCJsb2ciLCJQYXltZW50RmFpbGVkIiwiZXJyb3JDb2RlIiwiZXJyb3JNZXNzYWdlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3V0aWxzLyIsInNvdXJjZXMiOlsicGF5bWVudHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVHlwZXMgfSBmcm9tIFwibW9uZ29vc2VcIjtcbmltcG9ydCBQYXltZW50U3VjY2VzcyBmcm9tIFwiLi4vZGIvcGF5bWVudC1zdWNjZXNzXCI7XG5pbXBvcnQgUGF5bWVudEZhaWxlZCBmcm9tIFwiLi4vZGIvcGF5bWVudC1mYWlsZWRcIjtcbmltcG9ydCBDYXJ0cyBmcm9tIFwiLi4vZGIvY2FydFwiO1xuY29uc3QgeyBPYmplY3RJZCB9ID0gVHlwZXM7XG5cbmV4cG9ydCBjb25zdCBDb21wbGV0ZVBheW1lbnQgPSBhc3luYyAocmVzdWx0KSA9PiB7XG4gIGlmIChyZXN1bHQ/LnN0YXR1cyA9PT0gXCJzdWNjZXNzXCIpIHtcbiAgICBhd2FpdCBDYXJ0cy51cGRhdGVPbmUoXG4gICAgICB7IF9pZDogbmV3IE9iamVjdElkKHJlc3VsdC5iYXNrZXRJZCkgfSxcbiAgICAgIHsgJHNldDogeyBjb21wbGV0ZWQ6IHRydWUgfSB9XG4gICAgKTtcbiAgICBhd2FpdCBQYXltZW50U3VjY2Vzcy5jcmVhdGUoe1xuICAgICAgc3RhdHVzOiByZXN1bHQ/LnN0YXR1cyxcbiAgICAgIGNhcnRJZDogcmVzdWx0Py5iYXNrZXRJZCxcbiAgICAgIGNvbnZlcnNhdGlvbklkOiByZXN1bHQ/LmNvbnZlcnNhdGlvbklkLFxuICAgICAgY3VycmVuY3k6IHJlc3VsdD8uY3VycmVuY3ksXG4gICAgICBwYXltZW50SWQ6IHJlc3VsdD8ucGF5bWVudElkLFxuICAgICAgcHJpY2U6IHJlc3VsdD8ucHJpY2UsXG4gICAgICBwYWlkUHJpY2U6IHJlc3VsdD8ucGFpZFByaWNlLFxuICAgICAgaXRlbVRyYW5zYWN0aW9uczogcmVzdWx0Py5pdGVtVHJhbnNhY3Rpb25zLm1hcCgoaXRlbSkgPT4ge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGl0ZW1JZDogaXRlbT8uaXRlbUlkLFxuICAgICAgICAgIHBheW1lbnRUcmFuc2FjdGlvbklkOiBpdGVtPy5wYXltZW50VHJhbnNhY3Rpb25JZCxcbiAgICAgICAgICBwcmljZTogaXRlbT8ucHJpY2UsXG4gICAgICAgICAgcGFpZFByaWNlOiBpdGVtPy5wYWlkUHJpY2UsXG4gICAgICAgIH07XG4gICAgICB9KSxcbiAgICAgIGxvZzogcmVzdWx0LFxuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIGF3YWl0IFBheW1lbnRGYWlsZWQuY3JlYXRlKHtcbiAgICAgIHN0YXR1czogcmVzdWx0Py5zdGF0dXMsXG4gICAgICBjb252ZXJzYXRpb25JZDogcmVzdWx0Py5jb252ZXJzYXRpb25JZCxcbiAgICAgIGVycm9yQ29kZTogcmVzdWx0Py5lcnJvckNvZGUsXG4gICAgICBlcnJvck1lc3NhZ2U6IHJlc3VsdD8uZXJyb3JNZXNzYWdlLFxuICAgICAgbG9nOiByZXN1bHQsXG4gICAgfSk7XG4gIH1cbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsT0FBQTtBQUNBLElBQUFDLGVBQUEsR0FBQUMsc0JBQUEsQ0FBQUYsT0FBQTtBQUNBLElBQUFHLGNBQUEsR0FBQUQsc0JBQUEsQ0FBQUYsT0FBQTtBQUNBLElBQUFJLEtBQUEsR0FBQUYsc0JBQUEsQ0FBQUYsT0FBQTtBQUErQixTQUFBRSx1QkFBQUcsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUMvQixNQUFNO0VBQUVHO0FBQVMsQ0FBQyxHQUFHQyxlQUFLO0FBRW5CLE1BQU1DLGVBQWUsR0FBRyxNQUFPQyxNQUFNLElBQUs7RUFDL0MsSUFBSUEsTUFBTSxFQUFFQyxNQUFNLEtBQUssU0FBUyxFQUFFO0lBQ2hDLE1BQU1DLGFBQUssQ0FBQ0MsU0FBUyxDQUNuQjtNQUFFQyxHQUFHLEVBQUUsSUFBSVAsUUFBUSxDQUFDRyxNQUFNLENBQUNLLFFBQVE7SUFBRSxDQUFDLEVBQ3RDO01BQUVDLElBQUksRUFBRTtRQUFFQyxTQUFTLEVBQUU7TUFBSztJQUFFLENBQzlCLENBQUM7SUFDRCxNQUFNQyx1QkFBYyxDQUFDQyxNQUFNLENBQUM7TUFDMUJSLE1BQU0sRUFBRUQsTUFBTSxFQUFFQyxNQUFNO01BQ3RCUyxNQUFNLEVBQUVWLE1BQU0sRUFBRUssUUFBUTtNQUN4Qk0sY0FBYyxFQUFFWCxNQUFNLEVBQUVXLGNBQWM7TUFDdENDLFFBQVEsRUFBRVosTUFBTSxFQUFFWSxRQUFRO01BQzFCQyxTQUFTLEVBQUViLE1BQU0sRUFBRWEsU0FBUztNQUM1QkMsS0FBSyxFQUFFZCxNQUFNLEVBQUVjLEtBQUs7TUFDcEJDLFNBQVMsRUFBRWYsTUFBTSxFQUFFZSxTQUFTO01BQzVCQyxnQkFBZ0IsRUFBRWhCLE1BQU0sRUFBRWdCLGdCQUFnQixDQUFDQyxHQUFHLENBQUVDLElBQUksSUFBSztRQUN2RCxPQUFPO1VBQ0xDLE1BQU0sRUFBRUQsSUFBSSxFQUFFQyxNQUFNO1VBQ3BCQyxvQkFBb0IsRUFBRUYsSUFBSSxFQUFFRSxvQkFBb0I7VUFDaEROLEtBQUssRUFBRUksSUFBSSxFQUFFSixLQUFLO1VBQ2xCQyxTQUFTLEVBQUVHLElBQUksRUFBRUg7UUFDbkIsQ0FBQztNQUNILENBQUMsQ0FBQztNQUNGTSxHQUFHLEVBQUVyQjtJQUNQLENBQUMsQ0FBQztFQUNKLENBQUMsTUFBTTtJQUNMLE1BQU1zQixzQkFBYSxDQUFDYixNQUFNLENBQUM7TUFDekJSLE1BQU0sRUFBRUQsTUFBTSxFQUFFQyxNQUFNO01BQ3RCVSxjQUFjLEVBQUVYLE1BQU0sRUFBRVcsY0FBYztNQUN0Q1ksU0FBUyxFQUFFdkIsTUFBTSxFQUFFdUIsU0FBUztNQUM1QkMsWUFBWSxFQUFFeEIsTUFBTSxFQUFFd0IsWUFBWTtNQUNsQ0gsR0FBRyxFQUFFckI7SUFDUCxDQUFDLENBQUM7RUFDSjtBQUNGLENBQUM7QUFBQ3lCLE9BQUEsQ0FBQTFCLGVBQUEsR0FBQUEsZUFBQSIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_mongoose","require","_paymentSuccess","_interopRequireDefault","_paymentFailed","_cart","e","__esModule","default","ObjectId","Types","CompletePayment","result","status","Carts","updateOne","_id","basketId","$set","completed","PaymentSuccess","create","cartId","conversationId","currency","paymentId","price","paidPrice","itemTransactions","map","item","itemId","paymentTransactionId","log","PaymentFailed","errorCode","errorMessage","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/utils/","sources":["payments.js"],"sourcesContent":["import { Types } from \"mongoose\";\nimport PaymentSuccess from \"../db/payment-success\";\nimport PaymentFailed from \"../db/payment-failed\";\nimport Carts from \"../db/cart\";\nconst { ObjectId } = Types;\n\nexport const CompletePayment = async (result) => {\n  if (result?.status === \"success\") {\n    await Carts.updateOne(\n      { _id: new ObjectId(result.basketId) },\n      { $set: { completed: true } }\n    );\n    await PaymentSuccess.create({\n      status: result?.status,\n      cartId: result?.basketId,\n      conversationId: result?.conversationId,\n      currency: result?.currency,\n      paymentId: result?.paymentId,\n      price: result?.price,\n      paidPrice: result?.paidPrice,\n      itemTransactions: result?.itemTransactions.map((item) => {\n        return {\n          itemId: item?.itemId,\n          paymentTransactionId: item?.paymentTransactionId,\n          price: item?.price,\n          paidPrice: item?.paidPrice,\n        };\n      }),\n      log: result,\n    });\n  } else {\n    await PaymentFailed.create({\n      status: result?.status,\n      conversationId: result?.conversationId,\n      errorCode: result?.errorCode,\n      errorMessage: result?.errorMessage,\n      log: result,\n    });\n  }\n};\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,OAAA;AACA,IAAAC,eAAA,GAAAC,sBAAA,CAAAF,OAAA;AACA,IAAAG,cAAA,GAAAD,sBAAA,CAAAF,OAAA;AACA,IAAAI,KAAA,GAAAF,sBAAA,CAAAF,OAAA;AAA+B,SAAAE,uBAAAG,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAC/B,MAAM;EAAEG;AAAS,CAAC,GAAGC,eAAK;AAEnB,MAAMC,eAAe,GAAG,MAAOC,MAAM,IAAK;EAC/C,IAAIA,MAAM,EAAEC,MAAM,KAAK,SAAS,EAAE;IAChC,MAAMC,aAAK,CAACC,SAAS,CACnB;MAAEC,GAAG,EAAE,IAAIP,QAAQ,CAACG,MAAM,CAACK,QAAQ;IAAE,CAAC,EACtC;MAAEC,IAAI,EAAE;QAAEC,SAAS,EAAE;MAAK;IAAE,CAC9B,CAAC;IACD,MAAMC,uBAAc,CAACC,MAAM,CAAC;MAC1BR,MAAM,EAAED,MAAM,EAAEC,MAAM;MACtBS,MAAM,EAAEV,MAAM,EAAEK,QAAQ;MACxBM,cAAc,EAAEX,MAAM,EAAEW,cAAc;MACtCC,QAAQ,EAAEZ,MAAM,EAAEY,QAAQ;MAC1BC,SAAS,EAAEb,MAAM,EAAEa,SAAS;MAC5BC,KAAK,EAAEd,MAAM,EAAEc,KAAK;MACpBC,SAAS,EAAEf,MAAM,EAAEe,SAAS;MAC5BC,gBAAgB,EAAEhB,MAAM,EAAEgB,gBAAgB,CAACC,GAAG,CAAEC,IAAI,IAAK;QACvD,OAAO;UACLC,MAAM,EAAED,IAAI,EAAEC,MAAM;UACpBC,oBAAoB,EAAEF,IAAI,EAAEE,oBAAoB;UAChDN,KAAK,EAAEI,IAAI,EAAEJ,KAAK;UAClBC,SAAS,EAAEG,IAAI,EAAEH;QACnB,CAAC;MACH,CAAC,CAAC;MACFM,GAAG,EAAErB;IACP,CAAC,CAAC;EACJ,CAAC,MAAM;IACL,MAAMsB,sBAAa,CAACb,MAAM,CAAC;MACzBR,MAAM,EAAED,MAAM,EAAEC,MAAM;MACtBU,cAAc,EAAEX,MAAM,EAAEW,cAAc;MACtCY,SAAS,EAAEvB,MAAM,EAAEuB,SAAS;MAC5BC,YAAY,EAAExB,MAAM,EAAEwB,YAAY;MAClCH,GAAG,EAAErB;IACP,CAAC,CAAC;EACJ;AACF,CAAC;AAACyB,OAAA,CAAA1B,eAAA,GAAAA,eAAA","ignoreList":[]}},"mtime":1727341006723},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/Payments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _moment = _interopRequireDefault(require(\"moment\"));\nvar _iyzipay = _interopRequireDefault(require(\"iyzipay\"));\nvar _carts = _interopRequireDefault(require(\"../db/carts\"));\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nvar Payments = _interopRequireWildcard(require(\"../services/iyzico/methods/payments\"));\nvar Cards = _interopRequireWildcard(require(\"../services/iyzico/methods/cards\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nvar _payments2 = require(\"../utils/payments\");\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function (e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = router => {\n  //yeni bir kartla ödeme oluştur ve kartı kaydetme\n  router.post(\"/payments/:cartId/with-new-card\", _Session.default, async (req, res) => {\n    const {\n      card\n    } = req.body;\n    if (!card) {\n      throw new _ApiError.default(\"Card is required\", 400, \"cardRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _carts.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    card.registerCard = \"0\"; //methodslarda registerCard:1 yani kartı kaydet demek ama şuan kaydetme dediğim için 0 yaptım\n\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    let result = await Payments.createPayment(data);\n    await (0, _payments2.CompletePayment)(result);\n    res.json(result);\n  });\n\n  //yeni bir ödeme oluştur ve kart kaydet\n  router.post(\"/payments/:cartId/with-new-card/register-card\", _Session.default, async (req, res) => {\n    const {\n      card\n    } = req.body;\n    if (!card) {\n      throw new _ApiError.default(\"Card is required\", 400, \"cardRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _carts.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    if (req.user?.cardUserKey) {\n      card.cardUserKey = req.user?.cardUserKey;\n    }\n    card.registerCard = \"1\"; //methodslarda registerCard:1 yani kartı kaydet\n\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    let result = await Payments.createPayment(data);\n    if (req.user?.cardUserKey) {\n      const user = await _users.default.findOne({\n        _id: req.user?._id\n      });\n      user.cardUserKey = result?.cardUserKey;\n      await user.save();\n    }\n    await (0, _payments2.CompletePayment)(result);\n    res.json(result);\n  });\n\n  //hali hazırda bulunan kart ile ödeme\n  router.post(\"/payments/:cartId/:cardIndex/with-registered-card-index\", _Session.default, async (req, res) => {\n    let {\n      cardIndex\n    } = req.params;\n    if (!cardIndex) {\n      throw new _ApiError.default(\"Card index is required\", 400, \"cardIndexRequired\");\n    }\n    if (!req.user?.cardUserKey) {\n      throw new _ApiError.default(\"No registered card available\", 400, \"cardUserKeyRequired\");\n    }\n    const cards = await Cards.getUserCards({\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      cardUserKey: req.user?.cardUserKey\n    });\n    const index = parseInt(cardIndex);\n    if (index >= cards?.cardDetails?.length) {\n      throw new _ApiError.default(\"Card does not exist\", 400, \"cardIndexInvalid\");\n    }\n    const {\n      cardToken\n    } = cards?.cardDetails[index];\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _carts.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const card = {\n      cardToken,\n      cardUserKey: req.user?.cardUserKey\n    };\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    let result = await Payments.createPayment(data);\n    await (0, _payments2.CompletePayment)(result);\n    res.json(result);\n  });\n  router.post(\"/payments/:cartId/with-registered-card-token\", _Session.default, async (req, res) => {\n    let {\n      cardToken\n    } = req.body;\n    if (!cardToken) {\n      throw new _ApiError.default(\"Card Token is required\", 400, \"cardTokenRequired\");\n    }\n    if (!req.user?.cardUserKey) {\n      throw new _ApiError.default(\"No registered card available\", 400, \"cardUserKeyRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _carts.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const card = {\n      cardToken,\n      cardUserKey: req.user?.cardUserKey\n    };\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    let result = await Payments.createPayment(data);\n    await (0, _payments2.CompletePayment)(result);\n    res.json(result);\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9tZW50IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfaXl6aXBheSIsIl9jYXJ0cyIsIl91c2VycyIsIl9BcGlFcnJvciIsIl9TZXNzaW9uIiwiUGF5bWVudHMiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsIkNhcmRzIiwiX3V1aWQiLCJfcGF5bWVudHMyIiwiX2dldFJlcXVpcmVXaWxkY2FyZENhY2hlIiwiZSIsIldlYWtNYXAiLCJyIiwidCIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiaGFzIiwiZ2V0IiwibiIsIl9fcHJvdG9fXyIsImEiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsInUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJpIiwic2V0IiwiX2RlZmF1bHQiLCJyb3V0ZXIiLCJwb3N0IiwiU2Vzc2lvbiIsInJlcSIsInJlcyIsImNhcmQiLCJib2R5IiwiQXBpRXJyb3IiLCJwYXJhbXMiLCJjYXJ0SWQiLCJjYXJ0IiwiQ2FydHMiLCJmaW5kT25lIiwiX2lkIiwicG9wdWxhdGUiLCJjb21wbGV0ZWQiLCJyZWdpc3RlckNhcmQiLCJwYWlkUHJpY2UiLCJwcm9kdWN0cyIsIm1hcCIsInByb2R1Y3QiLCJwcmljZSIsInJlZHVjZSIsImIiLCJkYXRhIiwibG9jYWxlIiwidXNlciIsImNvbnZlcnNhdGlvbklkIiwiaWQiLCJjdXJyZW5jeSIsIkl5emlwYXkiLCJDVVJSRU5DWSIsIlRSWSIsImluc3RhbGxtZW50cyIsImJhc2tldElkIiwiU3RyaW5nIiwicGF5bWVudENoYW5uZWwiLCJQQVlNRU5UX0NIQU5ORUwiLCJXRUIiLCJwYXltZW50R3JvdXAiLCJQQVlNRU5UX0dST1VQIiwiUFJPRFVDVCIsInBheW1lbnRDYXJkIiwiYnV5ZXIiLCJuYW1lIiwic3VybmFtZSIsImdzbU51bWJlciIsInBob25lTnVtYmVyIiwiZW1haWwiLCJpZGVudGl0eU51bWJlciIsImxhc3RMb2dpbkRhdGUiLCJtb21lbnQiLCJ1cGRhdGVkQXQiLCJmb3JtYXQiLCJyZWdpc3RyYXRpb25EYXRlIiwicmVnaXN0cmF0aW9uQWRkcmVzcyIsImFkZHJlc3MiLCJpcCIsImNpdHkiLCJjb3VudHJ5IiwiemlwQ29kZSIsInNoaXBwaW5nQWRkcmVzcyIsImNvbnRhY3ROYW1lIiwiYmlsbGluZ0FkZHJlc3MiLCJiYXNrZXRJdGVtcyIsImluZGV4IiwiY2F0ZWdvcnkxIiwiY2F0ZWdvcmllcyIsImNhdGVnb3J5MiIsIml0ZW1UeXBlIiwiQkFTS0VUX0lURU1fVFlQRSIsInJlc3VsdCIsImNyZWF0ZVBheW1lbnQiLCJDb21wbGV0ZVBheW1lbnQiLCJqc29uIiwiY2FyZFVzZXJLZXkiLCJVc2VycyIsInNhdmUiLCJjYXJkSW5kZXgiLCJjYXJkcyIsImdldFVzZXJDYXJkcyIsInBhcnNlSW50IiwiY2FyZERldGFpbHMiLCJsZW5ndGgiLCJjYXJkVG9rZW4iLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvcm91dGVzLyIsInNvdXJjZXMiOlsiUGF5bWVudHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbWVudCBmcm9tIFwibW9tZW50XCI7XG5pbXBvcnQgSXl6aXBheSBmcm9tIFwiaXl6aXBheVwiO1xuaW1wb3J0IENhcnRzIGZyb20gXCIuLi9kYi9jYXJ0c1wiO1xuaW1wb3J0IFVzZXJzIGZyb20gXCIuLi9kYi91c2Vyc1wiO1xuaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuLi9lcnJvcnMvQXBpRXJyb3JcIjtcbmltcG9ydCBTZXNzaW9uIGZyb20gXCIuLi9taWRkbGV3YXJlcy9TZXNzaW9uXCI7XG5pbXBvcnQgKiBhcyBQYXltZW50cyBmcm9tIFwiLi4vc2VydmljZXMvaXl6aWNvL21ldGhvZHMvcGF5bWVudHNcIjtcbmltcG9ydCAqIGFzIENhcmRzIGZyb20gXCIuLi9zZXJ2aWNlcy9peXppY28vbWV0aG9kcy9jYXJkc1wiO1xuaW1wb3J0IGlkIGZyb20gXCIuLi91dGlscy91dWlkXCI7XG5pbXBvcnQgeyBDb21wbGV0ZVBheW1lbnQgfSBmcm9tIFwiLi4vdXRpbHMvcGF5bWVudHNcIjtcblxuZXhwb3J0IGRlZmF1bHQgKHJvdXRlcikgPT4ge1xuICAvL3llbmkgYmlyIGthcnRsYSDDtmRlbWUgb2x1xZ90dXIgdmUga2FydMSxIGtheWRldG1lXG4gIHJvdXRlci5wb3N0KFwiL3BheW1lbnRzLzpjYXJ0SWQvd2l0aC1uZXctY2FyZFwiLCBTZXNzaW9uLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICBjb25zdCB7IGNhcmQgfSA9IHJlcS5ib2R5O1xuICAgIGlmICghY2FyZCkge1xuICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FyZCBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FyZFJlcXVpcmVkXCIpO1xuICAgIH1cbiAgICBpZiAoIXJlcS5wYXJhbXM/LmNhcnRJZCkge1xuICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FydElEIGlzIHJlcXVpcmVkXCIsIDQwMCwgXCJjYXJ0SWRSZXF1aXJlZFwiKTtcbiAgICB9XG4gICAgY29uc3QgY2FydCA9IGF3YWl0IENhcnRzLmZpbmRPbmUoeyBfaWQ6IHJlcS5wYXJhbXM/LmNhcnRJZCB9KVxuICAgICAgLnBvcHVsYXRlKFwiYnV5ZXJcIilcbiAgICAgIC5wb3B1bGF0ZShcInByb2R1Y3RzXCIpO1xuICAgIGlmICghY2FydCkge1xuICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FyZCBub3QgZm91bmRcIiwgNDA0LCBcImNhcmROb3RGb3VuZFwiKTtcbiAgICB9XG4gICAgaWYgKGNhcnQ/LmNvbXBsZXRlZCkge1xuICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FydCBpcyBjb21wbGV0ZWRcIiwgNDAwLCBcImNhcnRDb21wbGV0ZWRcIik7XG4gICAgfVxuXG4gICAgY2FyZC5yZWdpc3RlckNhcmQgPSBcIjBcIjsgLy9tZXRob2RzbGFyZGEgcmVnaXN0ZXJDYXJkOjEgeWFuaSBrYXJ0xLEga2F5ZGV0IGRlbWVrIGFtYSDFn3VhbiBrYXlkZXRtZSBkZWRpxJ9pbSBpw6dpbiAwIHlhcHTEsW1cblxuICAgIGNvbnN0IHBhaWRQcmljZSA9IGNhcnQucHJvZHVjdHNcbiAgICAgIC5tYXAoKHByb2R1Y3QpID0+IHByb2R1Y3QucHJpY2UpXG4gICAgICAucmVkdWNlKChhLCBiKSA9PiBhICsgYiwgMCk7IC8vw7ZkZW5lY2VrIG1pa3RhcmxhcsSxbiB0b3BsYW3EsVxuXG4gICAgY29uc3QgZGF0YSA9IHtcbiAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICBwcmljZTogcGFpZFByaWNlLFxuICAgICAgcGFpZFByaWNlOiBwYWlkUHJpY2UsXG4gICAgICBjdXJyZW5jeTogSXl6aXBheS5DVVJSRU5DWS5UUlksXG4gICAgICBpbnN0YWxsbWVudHM6IFwiMVwiLFxuICAgICAgYmFza2V0SWQ6IFN0cmluZyhjYXJ0Py5faWQpLFxuICAgICAgcGF5bWVudENoYW5uZWw6IEl5emlwYXkuUEFZTUVOVF9DSEFOTkVMLldFQixcbiAgICAgIHBheW1lbnRHcm91cDogSXl6aXBheS5QQVlNRU5UX0dST1VQLlBST0RVQ1QsXG4gICAgICBwYXltZW50Q2FyZDogY2FyZCxcbiAgICAgIGJ1eWVyOiB7XG4gICAgICAgIGlkOiBTdHJpbmcocmVxLnVzZXIuX2lkKSxcbiAgICAgICAgbmFtZTogcmVxLnVzZXI/Lm5hbWUsXG4gICAgICAgIHN1cm5hbWU6IHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICBnc21OdW1iZXI6IHJlcS51c2VyPy5waG9uZU51bWJlcixcbiAgICAgICAgZW1haWw6IHJlcS51c2VyPy5lbWFpbCxcbiAgICAgICAgaWRlbnRpdHlOdW1iZXI6IHJlcS51c2VyPy5pZGVudGl0eU51bWJlcixcbiAgICAgICAgbGFzdExvZ2luRGF0ZTogbW9tZW50KHJlcS51c2VyPy51cGRhdGVkQXQpLmZvcm1hdChcbiAgICAgICAgICBcIllZWVktTU0tREQgSEg6bW06c3NcIlxuICAgICAgICApLCAvL2l5aXpwYXkgdGFyaWggZm9ybWF0xLFuYSDDp2V2aXJtZWsgacOnaW4geWFwxLFsZMSxXG4gICAgICAgIHJlZ2lzdHJhdGlvbkRhdGU6IG1vbWVudChyZXEudXNlcj8udXBkYXRlZEF0KS5mb3JtYXQoXG4gICAgICAgICAgXCJZWVlZLU1NLUREIEhIOm1tOnNzXCJcbiAgICAgICAgKSxcbiAgICAgICAgcmVnaXN0cmF0aW9uQWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgIGlwOiByZXEudXNlcj8uaXAsXG4gICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICB9LFxuICAgICAgc2hpcHBpbmdBZGRyZXNzOiB7XG4gICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiXCIgKyByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICBhZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICB9LFxuICAgICAgYmlsbGluZ0FkZHJlc3M6IHtcbiAgICAgICAgY29udGFjdE5hbWU6IHJlcS51c2VyPy5uYW1lICsgXCJcIiArIHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgIGFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgIH0sXG4gICAgICBiYXNrZXRJdGVtczogY2FydC5wcm9kdWN0cy5tYXAoKHByb2R1Y3QsIGluZGV4KSA9PiB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgaWQ6IFN0cmluZyhwcm9kdWN0Py5faWQpLFxuICAgICAgICAgIG5hbWU6IHByb2R1Y3Q/Lm5hbWUsXG4gICAgICAgICAgY2F0ZWdvcnkxOiBwcm9kdWN0LmNhdGVnb3JpZXNbMF0sXG4gICAgICAgICAgY2F0ZWdvcnkyOiBwcm9kdWN0LmNhdGVnb3JpZXNbMV0sXG4gICAgICAgICAgaXRlbVR5cGU6IEl5emlwYXkuQkFTS0VUX0lURU1fVFlQRVtwcm9kdWN0Py5pdGVtVHlwZV0sXG4gICAgICAgICAgcHJpY2U6IHByb2R1Y3Q/LnByaWNlLFxuICAgICAgICB9O1xuICAgICAgfSksXG4gICAgfTtcblxuICAgIGxldCByZXN1bHQgPSBhd2FpdCBQYXltZW50cy5jcmVhdGVQYXltZW50KGRhdGEpO1xuICAgIGF3YWl0IENvbXBsZXRlUGF5bWVudChyZXN1bHQpO1xuICAgIHJlcy5qc29uKHJlc3VsdCk7XG4gIH0pO1xuXG4gIC8veWVuaSBiaXIgw7ZkZW1lIG9sdcWfdHVyIHZlIGthcnQga2F5ZGV0XG4gIHJvdXRlci5wb3N0KFxuICAgIFwiL3BheW1lbnRzLzpjYXJ0SWQvd2l0aC1uZXctY2FyZC9yZWdpc3Rlci1jYXJkXCIsXG4gICAgU2Vzc2lvbixcbiAgICBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICAgIGNvbnN0IHsgY2FyZCB9ID0gcmVxLmJvZHk7XG4gICAgICBpZiAoIWNhcmQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FyZCBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FyZFJlcXVpcmVkXCIpO1xuICAgICAgfVxuICAgICAgaWYgKCFyZXEucGFyYW1zPy5jYXJ0SWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FydElEIGlzIHJlcXVpcmVkXCIsIDQwMCwgXCJjYXJ0SWRSZXF1aXJlZFwiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGNhcnQgPSBhd2FpdCBDYXJ0cy5maW5kT25lKHsgX2lkOiByZXEucGFyYW1zPy5jYXJ0SWQgfSlcbiAgICAgICAgLnBvcHVsYXRlKFwiYnV5ZXJcIilcbiAgICAgICAgLnBvcHVsYXRlKFwicHJvZHVjdHNcIik7XG4gICAgICBpZiAoIWNhcnQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FyZCBub3QgZm91bmRcIiwgNDA0LCBcImNhcmROb3RGb3VuZFwiKTtcbiAgICAgIH1cbiAgICAgIGlmIChjYXJ0Py5jb21wbGV0ZWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FydCBpcyBjb21wbGV0ZWRcIiwgNDAwLCBcImNhcnRDb21wbGV0ZWRcIik7XG4gICAgICB9XG5cbiAgICAgIGlmIChyZXEudXNlcj8uY2FyZFVzZXJLZXkpIHtcbiAgICAgICAgY2FyZC5jYXJkVXNlcktleSA9IHJlcS51c2VyPy5jYXJkVXNlcktleTtcbiAgICAgIH1cbiAgICAgIGNhcmQucmVnaXN0ZXJDYXJkID0gXCIxXCI7IC8vbWV0aG9kc2xhcmRhIHJlZ2lzdGVyQ2FyZDoxIHlhbmkga2FydMSxIGtheWRldFxuXG4gICAgICBjb25zdCBwYWlkUHJpY2UgPSBjYXJ0LnByb2R1Y3RzXG4gICAgICAgIC5tYXAoKHByb2R1Y3QpID0+IHByb2R1Y3QucHJpY2UpXG4gICAgICAgIC5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiLCAwKTsgLy/DtmRlbmVjZWsgbWlrdGFybGFyxLFuIHRvcGxhbcSxXG5cbiAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgICBjb252ZXJzYXRpb25JZDogaWQoKSxcbiAgICAgICAgcHJpY2U6IHBhaWRQcmljZSxcbiAgICAgICAgcGFpZFByaWNlOiBwYWlkUHJpY2UsXG4gICAgICAgIGN1cnJlbmN5OiBJeXppcGF5LkNVUlJFTkNZLlRSWSxcbiAgICAgICAgaW5zdGFsbG1lbnRzOiBcIjFcIixcbiAgICAgICAgYmFza2V0SWQ6IFN0cmluZyhjYXJ0Py5faWQpLFxuICAgICAgICBwYXltZW50Q2hhbm5lbDogSXl6aXBheS5QQVlNRU5UX0NIQU5ORUwuV0VCLFxuICAgICAgICBwYXltZW50R3JvdXA6IEl5emlwYXkuUEFZTUVOVF9HUk9VUC5QUk9EVUNULFxuICAgICAgICBwYXltZW50Q2FyZDogY2FyZCxcbiAgICAgICAgYnV5ZXI6IHtcbiAgICAgICAgICBpZDogU3RyaW5nKHJlcS51c2VyLl9pZCksXG4gICAgICAgICAgbmFtZTogcmVxLnVzZXI/Lm5hbWUsXG4gICAgICAgICAgc3VybmFtZTogcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgZ3NtTnVtYmVyOiByZXEudXNlcj8ucGhvbmVOdW1iZXIsXG4gICAgICAgICAgZW1haWw6IHJlcS51c2VyPy5lbWFpbCxcbiAgICAgICAgICBpZGVudGl0eU51bWJlcjogcmVxLnVzZXI/LmlkZW50aXR5TnVtYmVyLFxuICAgICAgICAgIGxhc3RMb2dpbkRhdGU6IG1vbWVudChyZXEudXNlcj8udXBkYXRlZEF0KS5mb3JtYXQoXG4gICAgICAgICAgICBcIllZWVktTU0tREQgSEg6bW06c3NcIlxuICAgICAgICAgICksIC8vaXlpenBheSB0YXJpaCBmb3JtYXTEsW5hIMOnZXZpcm1layBpw6dpbiB5YXDEsWxkxLFcbiAgICAgICAgICByZWdpc3RyYXRpb25EYXRlOiBtb21lbnQocmVxLnVzZXI/LnVwZGF0ZWRBdCkuZm9ybWF0KFxuICAgICAgICAgICAgXCJZWVlZLU1NLUREIEhIOm1tOnNzXCJcbiAgICAgICAgICApLFxuICAgICAgICAgIHJlZ2lzdHJhdGlvbkFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIGlwOiByZXEudXNlcj8uaXAsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIHNoaXBwaW5nQWRkcmVzczoge1xuICAgICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiXCIgKyByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgICBhZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgICAgfSxcbiAgICAgICAgYmlsbGluZ0FkZHJlc3M6IHtcbiAgICAgICAgICBjb250YWN0TmFtZTogcmVxLnVzZXI/Lm5hbWUgKyBcIlwiICsgcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgYWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIGJhc2tldEl0ZW1zOiBjYXJ0LnByb2R1Y3RzLm1hcCgocHJvZHVjdCwgaW5kZXgpID0+IHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaWQ6IFN0cmluZyhwcm9kdWN0Py5faWQpLFxuICAgICAgICAgICAgbmFtZTogcHJvZHVjdD8ubmFtZSxcbiAgICAgICAgICAgIGNhdGVnb3J5MTogcHJvZHVjdC5jYXRlZ29yaWVzWzBdLFxuICAgICAgICAgICAgY2F0ZWdvcnkyOiBwcm9kdWN0LmNhdGVnb3JpZXNbMV0sXG4gICAgICAgICAgICBpdGVtVHlwZTogSXl6aXBheS5CQVNLRVRfSVRFTV9UWVBFW3Byb2R1Y3Q/Lml0ZW1UeXBlXSxcbiAgICAgICAgICAgIHByaWNlOiBwcm9kdWN0Py5wcmljZSxcbiAgICAgICAgICB9O1xuICAgICAgICB9KSxcbiAgICAgIH07XG5cbiAgICAgIGxldCByZXN1bHQgPSBhd2FpdCBQYXltZW50cy5jcmVhdGVQYXltZW50KGRhdGEpO1xuICAgICAgaWYgKHJlcS51c2VyPy5jYXJkVXNlcktleSkge1xuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgVXNlcnMuZmluZE9uZSh7IF9pZDogcmVxLnVzZXI/Ll9pZCB9KTtcbiAgICAgICAgdXNlci5jYXJkVXNlcktleSA9IHJlc3VsdD8uY2FyZFVzZXJLZXk7XG4gICAgICAgIGF3YWl0IHVzZXIuc2F2ZSgpO1xuICAgICAgfVxuICAgICAgYXdhaXQgQ29tcGxldGVQYXltZW50KHJlc3VsdCk7XG4gICAgICByZXMuanNvbihyZXN1bHQpO1xuICAgIH1cbiAgKTtcblxuICAvL2hhbGkgaGF6xLFyZGEgYnVsdW5hbiBrYXJ0IGlsZSDDtmRlbWVcbiAgcm91dGVyLnBvc3QoXG4gICAgXCIvcGF5bWVudHMvOmNhcnRJZC86Y2FyZEluZGV4L3dpdGgtcmVnaXN0ZXJlZC1jYXJkLWluZGV4XCIsXG4gICAgU2Vzc2lvbixcbiAgICBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICAgIGxldCB7IGNhcmRJbmRleCB9ID0gcmVxLnBhcmFtcztcbiAgICAgIGlmICghY2FyZEluZGV4KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgaW5kZXggaXMgcmVxdWlyZWRcIiwgNDAwLCBcImNhcmRJbmRleFJlcXVpcmVkXCIpO1xuICAgICAgfVxuICAgICAgaWYgKCFyZXEudXNlcj8uY2FyZFVzZXJLZXkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIFwiTm8gcmVnaXN0ZXJlZCBjYXJkIGF2YWlsYWJsZVwiLFxuICAgICAgICAgIDQwMCxcbiAgICAgICAgICBcImNhcmRVc2VyS2V5UmVxdWlyZWRcIlxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBjYXJkcyA9IGF3YWl0IENhcmRzLmdldFVzZXJDYXJkcyh7XG4gICAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgICBjb252ZXJzYXRpb25JZDogaWQoKSxcbiAgICAgICAgY2FyZFVzZXJLZXk6IHJlcS51c2VyPy5jYXJkVXNlcktleSxcbiAgICAgIH0pO1xuICAgICAgY29uc3QgaW5kZXggPSBwYXJzZUludChjYXJkSW5kZXgpO1xuICAgICAgaWYgKGluZGV4ID49IGNhcmRzPy5jYXJkRGV0YWlscz8ubGVuZ3RoKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgZG9lcyBub3QgZXhpc3RcIiwgNDAwLCBcImNhcmRJbmRleEludmFsaWRcIik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGNhcmRUb2tlbiB9ID0gY2FyZHM/LmNhcmREZXRhaWxzW2luZGV4XTtcbiAgICAgIGlmICghcmVxLnBhcmFtcz8uY2FydElkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnRJRCBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FydElkUmVxdWlyZWRcIik7XG4gICAgICB9XG4gICAgICBjb25zdCBjYXJ0ID0gYXdhaXQgQ2FydHMuZmluZE9uZSh7IF9pZDogcmVxLnBhcmFtcz8uY2FydElkIH0pXG4gICAgICAgIC5wb3B1bGF0ZShcImJ1eWVyXCIpXG4gICAgICAgIC5wb3B1bGF0ZShcInByb2R1Y3RzXCIpO1xuICAgICAgaWYgKCFjYXJ0KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcmQgbm90IGZvdW5kXCIsIDQwNCwgXCJjYXJkTm90Rm91bmRcIik7XG4gICAgICB9XG4gICAgICBpZiAoY2FydD8uY29tcGxldGVkKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgaXMgY29tcGxldGVkXCIsIDQwMCwgXCJjYXJ0Q29tcGxldGVkXCIpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBwYWlkUHJpY2UgPSBjYXJ0LnByb2R1Y3RzXG4gICAgICAgIC5tYXAoKHByb2R1Y3QpID0+IHByb2R1Y3QucHJpY2UpXG4gICAgICAgIC5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiLCAwKTsgLy/DtmRlbmVjZWsgbWlrdGFybGFyxLFuIHRvcGxhbcSxXG5cbiAgICAgIGNvbnN0IGNhcmQgPSB7XG4gICAgICAgIGNhcmRUb2tlbixcbiAgICAgICAgY2FyZFVzZXJLZXk6IHJlcS51c2VyPy5jYXJkVXNlcktleSxcbiAgICAgIH07XG5cbiAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgICBjb252ZXJzYXRpb25JZDogaWQoKSxcbiAgICAgICAgcHJpY2U6IHBhaWRQcmljZSxcbiAgICAgICAgcGFpZFByaWNlOiBwYWlkUHJpY2UsXG4gICAgICAgIGN1cnJlbmN5OiBJeXppcGF5LkNVUlJFTkNZLlRSWSxcbiAgICAgICAgaW5zdGFsbG1lbnRzOiBcIjFcIixcbiAgICAgICAgYmFza2V0SWQ6IFN0cmluZyhjYXJ0Py5faWQpLFxuICAgICAgICBwYXltZW50Q2hhbm5lbDogSXl6aXBheS5QQVlNRU5UX0NIQU5ORUwuV0VCLFxuICAgICAgICBwYXltZW50R3JvdXA6IEl5emlwYXkuUEFZTUVOVF9HUk9VUC5QUk9EVUNULFxuICAgICAgICBwYXltZW50Q2FyZDogY2FyZCxcbiAgICAgICAgYnV5ZXI6IHtcbiAgICAgICAgICBpZDogU3RyaW5nKHJlcS51c2VyLl9pZCksXG4gICAgICAgICAgbmFtZTogcmVxLnVzZXI/Lm5hbWUsXG4gICAgICAgICAgc3VybmFtZTogcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgZ3NtTnVtYmVyOiByZXEudXNlcj8ucGhvbmVOdW1iZXIsXG4gICAgICAgICAgZW1haWw6IHJlcS51c2VyPy5lbWFpbCxcbiAgICAgICAgICBpZGVudGl0eU51bWJlcjogcmVxLnVzZXI/LmlkZW50aXR5TnVtYmVyLFxuICAgICAgICAgIGxhc3RMb2dpbkRhdGU6IG1vbWVudChyZXEudXNlcj8udXBkYXRlZEF0KS5mb3JtYXQoXG4gICAgICAgICAgICBcIllZWVktTU0tREQgSEg6bW06c3NcIlxuICAgICAgICAgICksIC8vaXlpenBheSB0YXJpaCBmb3JtYXTEsW5hIMOnZXZpcm1layBpw6dpbiB5YXDEsWxkxLFcbiAgICAgICAgICByZWdpc3RyYXRpb25EYXRlOiBtb21lbnQocmVxLnVzZXI/LnVwZGF0ZWRBdCkuZm9ybWF0KFxuICAgICAgICAgICAgXCJZWVlZLU1NLUREIEhIOm1tOnNzXCJcbiAgICAgICAgICApLFxuICAgICAgICAgIHJlZ2lzdHJhdGlvbkFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIGlwOiByZXEudXNlcj8uaXAsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIHNoaXBwaW5nQWRkcmVzczoge1xuICAgICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiXCIgKyByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgICBhZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgICAgfSxcbiAgICAgICAgYmlsbGluZ0FkZHJlc3M6IHtcbiAgICAgICAgICBjb250YWN0TmFtZTogcmVxLnVzZXI/Lm5hbWUgKyBcIlwiICsgcmVxLnVzZXI/LnN1cm5hbWUsXG4gICAgICAgICAgY2l0eTogcmVxLnVzZXI/LmNpdHksXG4gICAgICAgICAgY291bnRyeTogcmVxLnVzZXI/LmNvdW50cnksXG4gICAgICAgICAgYWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgemlwQ29kZTogcmVxLnVzZXI/LnppcENvZGUsXG4gICAgICAgIH0sXG4gICAgICAgIGJhc2tldEl0ZW1zOiBjYXJ0LnByb2R1Y3RzLm1hcCgocHJvZHVjdCwgaW5kZXgpID0+IHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgaWQ6IFN0cmluZyhwcm9kdWN0Py5faWQpLFxuICAgICAgICAgICAgbmFtZTogcHJvZHVjdD8ubmFtZSxcbiAgICAgICAgICAgIGNhdGVnb3J5MTogcHJvZHVjdC5jYXRlZ29yaWVzWzBdLFxuICAgICAgICAgICAgY2F0ZWdvcnkyOiBwcm9kdWN0LmNhdGVnb3JpZXNbMV0sXG4gICAgICAgICAgICBpdGVtVHlwZTogSXl6aXBheS5CQVNLRVRfSVRFTV9UWVBFW3Byb2R1Y3Q/Lml0ZW1UeXBlXSxcbiAgICAgICAgICAgIHByaWNlOiBwcm9kdWN0Py5wcmljZSxcbiAgICAgICAgICB9O1xuICAgICAgICB9KSxcbiAgICAgIH07XG5cbiAgICAgIGxldCByZXN1bHQgPSBhd2FpdCBQYXltZW50cy5jcmVhdGVQYXltZW50KGRhdGEpO1xuICAgICAgYXdhaXQgQ29tcGxldGVQYXltZW50KHJlc3VsdCk7XG4gICAgICByZXMuanNvbihyZXN1bHQpO1xuICAgIH1cbiAgKTtcblxuICByb3V0ZXIucG9zdChcbiAgICBcIi9wYXltZW50cy86Y2FydElkL3dpdGgtcmVnaXN0ZXJlZC1jYXJkLXRva2VuXCIsXG4gICAgU2Vzc2lvbixcbiAgICBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICAgIGxldCB7IGNhcmRUb2tlbiB9ID0gcmVxLmJvZHk7XG4gICAgICBpZiAoIWNhcmRUb2tlbikge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIFRva2VuIGlzIHJlcXVpcmVkXCIsIDQwMCwgXCJjYXJkVG9rZW5SZXF1aXJlZFwiKTtcbiAgICAgIH1cbiAgICAgIGlmICghcmVxLnVzZXI/LmNhcmRVc2VyS2V5KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgICBcIk5vIHJlZ2lzdGVyZWQgY2FyZCBhdmFpbGFibGVcIixcbiAgICAgICAgICA0MDAsXG4gICAgICAgICAgXCJjYXJkVXNlcktleVJlcXVpcmVkXCJcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFyZXEucGFyYW1zPy5jYXJ0SWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FydElEIGlzIHJlcXVpcmVkXCIsIDQwMCwgXCJjYXJ0SWRSZXF1aXJlZFwiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGNhcnQgPSBhd2FpdCBDYXJ0cy5maW5kT25lKHsgX2lkOiByZXEucGFyYW1zPy5jYXJ0SWQgfSlcbiAgICAgICAgLnBvcHVsYXRlKFwiYnV5ZXJcIilcbiAgICAgICAgLnBvcHVsYXRlKFwicHJvZHVjdHNcIik7XG4gICAgICBpZiAoIWNhcnQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FyZCBub3QgZm91bmRcIiwgNDA0LCBcImNhcmROb3RGb3VuZFwiKTtcbiAgICAgIH1cbiAgICAgIGlmIChjYXJ0Py5jb21wbGV0ZWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FydCBpcyBjb21wbGV0ZWRcIiwgNDAwLCBcImNhcnRDb21wbGV0ZWRcIik7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHBhaWRQcmljZSA9IGNhcnQucHJvZHVjdHNcbiAgICAgICAgLm1hcCgocHJvZHVjdCkgPT4gcHJvZHVjdC5wcmljZSlcbiAgICAgICAgLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApOyAvL8O2ZGVuZWNlayBtaWt0YXJsYXLEsW4gdG9wbGFtxLFcblxuICAgICAgY29uc3QgY2FyZCA9IHtcbiAgICAgICAgY2FyZFRva2VuLFxuICAgICAgICBjYXJkVXNlcktleTogcmVxLnVzZXI/LmNhcmRVc2VyS2V5LFxuICAgICAgfTtcblxuICAgICAgY29uc3QgZGF0YSA9IHtcbiAgICAgICAgbG9jYWxlOiByZXEudXNlci5sb2NhbGUsXG4gICAgICAgIGNvbnZlcnNhdGlvbklkOiBpZCgpLFxuICAgICAgICBwcmljZTogcGFpZFByaWNlLFxuICAgICAgICBwYWlkUHJpY2U6IHBhaWRQcmljZSxcbiAgICAgICAgY3VycmVuY3k6IEl5emlwYXkuQ1VSUkVOQ1kuVFJZLFxuICAgICAgICBpbnN0YWxsbWVudHM6IFwiMVwiLFxuICAgICAgICBiYXNrZXRJZDogU3RyaW5nKGNhcnQ/Ll9pZCksXG4gICAgICAgIHBheW1lbnRDaGFubmVsOiBJeXppcGF5LlBBWU1FTlRfQ0hBTk5FTC5XRUIsXG4gICAgICAgIHBheW1lbnRHcm91cDogSXl6aXBheS5QQVlNRU5UX0dST1VQLlBST0RVQ1QsXG4gICAgICAgIHBheW1lbnRDYXJkOiBjYXJkLFxuICAgICAgICBidXllcjoge1xuICAgICAgICAgIGlkOiBTdHJpbmcocmVxLnVzZXIuX2lkKSxcbiAgICAgICAgICBuYW1lOiByZXEudXNlcj8ubmFtZSxcbiAgICAgICAgICBzdXJuYW1lOiByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBnc21OdW1iZXI6IHJlcS51c2VyPy5waG9uZU51bWJlcixcbiAgICAgICAgICBlbWFpbDogcmVxLnVzZXI/LmVtYWlsLFxuICAgICAgICAgIGlkZW50aXR5TnVtYmVyOiByZXEudXNlcj8uaWRlbnRpdHlOdW1iZXIsXG4gICAgICAgICAgbGFzdExvZ2luRGF0ZTogbW9tZW50KHJlcS51c2VyPy51cGRhdGVkQXQpLmZvcm1hdChcbiAgICAgICAgICAgIFwiWVlZWS1NTS1ERCBISDptbTpzc1wiXG4gICAgICAgICAgKSwgLy9peWl6cGF5IHRhcmloIGZvcm1hdMSxbmEgw6dldmlybWVrIGnDp2luIHlhcMSxbGTEsVxuICAgICAgICAgIHJlZ2lzdHJhdGlvbkRhdGU6IG1vbWVudChyZXEudXNlcj8udXBkYXRlZEF0KS5mb3JtYXQoXG4gICAgICAgICAgICBcIllZWVktTU0tREQgSEg6bW06c3NcIlxuICAgICAgICAgICksXG4gICAgICAgICAgcmVnaXN0cmF0aW9uQWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgaXA6IHJlcS51c2VyPy5pcCxcbiAgICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgICAgfSxcbiAgICAgICAgc2hpcHBpbmdBZGRyZXNzOiB7XG4gICAgICAgICAgY29udGFjdE5hbWU6IHJlcS51c2VyPy5uYW1lICsgXCJcIiArIHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIGFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBiaWxsaW5nQWRkcmVzczoge1xuICAgICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiXCIgKyByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgICBhZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgICAgfSxcbiAgICAgICAgYmFza2V0SXRlbXM6IGNhcnQucHJvZHVjdHMubWFwKChwcm9kdWN0LCBpbmRleCkgPT4ge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpZDogU3RyaW5nKHByb2R1Y3Q/Ll9pZCksXG4gICAgICAgICAgICBuYW1lOiBwcm9kdWN0Py5uYW1lLFxuICAgICAgICAgICAgY2F0ZWdvcnkxOiBwcm9kdWN0LmNhdGVnb3JpZXNbMF0sXG4gICAgICAgICAgICBjYXRlZ29yeTI6IHByb2R1Y3QuY2F0ZWdvcmllc1sxXSxcbiAgICAgICAgICAgIGl0ZW1UeXBlOiBJeXppcGF5LkJBU0tFVF9JVEVNX1RZUEVbcHJvZHVjdD8uaXRlbVR5cGVdLFxuICAgICAgICAgICAgcHJpY2U6IHByb2R1Y3Q/LnByaWNlLFxuICAgICAgICAgIH07XG4gICAgICAgIH0pLFxuICAgICAgfTtcblxuICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IFBheW1lbnRzLmNyZWF0ZVBheW1lbnQoZGF0YSk7XG4gICAgICBhd2FpdCBDb21wbGV0ZVBheW1lbnQocmVzdWx0KTtcbiAgICAgIHJlcy5qc29uKHJlc3VsdCk7XG4gICAgfVxuICApO1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsT0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsUUFBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsTUFBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUcsTUFBQSxHQUFBSixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUksU0FBQSxHQUFBTCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUssUUFBQSxHQUFBTixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQU0sUUFBQSxHQUFBQyx1QkFBQSxDQUFBUCxPQUFBO0FBQ0EsSUFBQVEsS0FBQSxHQUFBRCx1QkFBQSxDQUFBUCxPQUFBO0FBQ0EsSUFBQVMsS0FBQSxHQUFBVixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQVUsVUFBQSxHQUFBVixPQUFBO0FBQW9ELFNBQUFXLHlCQUFBQyxDQUFBLDZCQUFBQyxPQUFBLG1CQUFBQyxDQUFBLE9BQUFELE9BQUEsSUFBQUUsQ0FBQSxPQUFBRixPQUFBLFlBQUFGLHdCQUFBLFlBQUFBLENBQUFDLENBQUEsV0FBQUEsQ0FBQSxHQUFBRyxDQUFBLEdBQUFELENBQUEsS0FBQUYsQ0FBQTtBQUFBLFNBQUFMLHdCQUFB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","map":{"version":3,"names":["_moment","_interopRequireDefault","require","_iyzipay","_carts","_users","_ApiError","_Session","Payments","_interopRequireWildcard","Cards","_uuid","_payments2","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","_default","router","post","Session","req","res","card","body","ApiError","params","cartId","cart","Carts","findOne","_id","populate","completed","registerCard","paidPrice","products","map","product","price","reduce","b","data","locale","user","conversationId","id","currency","Iyzipay","CURRENCY","TRY","installments","basketId","String","paymentChannel","PAYMENT_CHANNEL","WEB","paymentGroup","PAYMENT_GROUP","PRODUCT","paymentCard","buyer","name","surname","gsmNumber","phoneNumber","email","identityNumber","lastLoginDate","moment","updatedAt","format","registrationDate","registrationAddress","address","ip","city","country","zipCode","shippingAddress","contactName","billingAddress","basketItems","index","category1","categories","category2","itemType","BASKET_ITEM_TYPE","result","createPayment","CompletePayment","json","cardUserKey","Users","save","cardIndex","cards","getUserCards","parseInt","cardDetails","length","cardToken","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["Payments.js"],"sourcesContent":["import moment from \"moment\";\nimport Iyzipay from \"iyzipay\";\nimport Carts from \"../db/carts\";\nimport Users from \"../db/users\";\nimport ApiError from \"../errors/ApiError\";\nimport Session from \"../middlewares/Session\";\nimport * as Payments from \"../services/iyzico/methods/payments\";\nimport * as Cards from \"../services/iyzico/methods/cards\";\nimport id from \"../utils/uuid\";\nimport { CompletePayment } from \"../utils/payments\";\n\nexport default (router) => {\n  //yeni bir kartla ödeme oluştur ve kartı kaydetme\n  router.post(\"/payments/:cartId/with-new-card\", Session, async (req, res) => {\n    const { card } = req.body;\n    if (!card) {\n      throw new ApiError(\"Card is required\", 400, \"cardRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await Carts.findOne({ _id: req.params?.cartId })\n      .populate(\"buyer\")\n      .populate(\"products\");\n    if (!cart) {\n      throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n\n    card.registerCard = \"0\"; //methodslarda registerCard:1 yani kartı kaydet demek ama şuan kaydetme dediğim için 0 yaptım\n\n    const paidPrice = cart.products\n      .map((product) => product.price)\n      .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const data = {\n      locale: req.user.locale,\n      conversationId: id(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: Iyzipay.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n      paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n      paymentCard: card,\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: moment(req.user?.updatedAt).format(\n          \"YYYY-MM-DD HH:mm:ss\"\n        ), //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: moment(req.user?.updatedAt).format(\n          \"YYYY-MM-DD HH:mm:ss\"\n        ),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode,\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode,\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode,\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price,\n        };\n      }),\n    };\n\n    let result = await Payments.createPayment(data);\n    await CompletePayment(result);\n    res.json(result);\n  });\n\n  //yeni bir ödeme oluştur ve kart kaydet\n  router.post(\n    \"/payments/:cartId/with-new-card/register-card\",\n    Session,\n    async (req, res) => {\n      const { card } = req.body;\n      if (!card) {\n        throw new ApiError(\"Card is required\", 400, \"cardRequired\");\n      }\n      if (!req.params?.cartId) {\n        throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      }\n      const cart = await Carts.findOne({ _id: req.params?.cartId })\n        .populate(\"buyer\")\n        .populate(\"products\");\n      if (!cart) {\n        throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n      }\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      if (req.user?.cardUserKey) {\n        card.cardUserKey = req.user?.cardUserKey;\n      }\n      card.registerCard = \"1\"; //methodslarda registerCard:1 yani kartı kaydet\n\n      const paidPrice = cart.products\n        .map((product) => product.price)\n        .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: paidPrice,\n        paidPrice: paidPrice,\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        paymentCard: card,\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ), //iyizpay tarih formatına çevirmek için yapıldı\n          registrationDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems: cart.products.map((product, index) => {\n          return {\n            id: String(product?._id),\n            name: product?.name,\n            category1: product.categories[0],\n            category2: product.categories[1],\n            itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n            price: product?.price,\n          };\n        }),\n      };\n\n      let result = await Payments.createPayment(data);\n      if (req.user?.cardUserKey) {\n        const user = await Users.findOne({ _id: req.user?._id });\n        user.cardUserKey = result?.cardUserKey;\n        await user.save();\n      }\n      await CompletePayment(result);\n      res.json(result);\n    }\n  );\n\n  //hali hazırda bulunan kart ile ödeme\n  router.post(\n    \"/payments/:cartId/:cardIndex/with-registered-card-index\",\n    Session,\n    async (req, res) => {\n      let { cardIndex } = req.params;\n      if (!cardIndex) {\n        throw new ApiError(\"Card index is required\", 400, \"cardIndexRequired\");\n      }\n      if (!req.user?.cardUserKey) {\n        throw new ApiError(\n          \"No registered card available\",\n          400,\n          \"cardUserKeyRequired\"\n        );\n      }\n\n      const cards = await Cards.getUserCards({\n        locale: req.user.locale,\n        conversationId: id(),\n        cardUserKey: req.user?.cardUserKey,\n      });\n      const index = parseInt(cardIndex);\n      if (index >= cards?.cardDetails?.length) {\n        throw new ApiError(\"Card does not exist\", 400, \"cardIndexInvalid\");\n      }\n      const { cardToken } = cards?.cardDetails[index];\n      if (!req.params?.cartId) {\n        throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      }\n      const cart = await Carts.findOne({ _id: req.params?.cartId })\n        .populate(\"buyer\")\n        .populate(\"products\");\n      if (!cart) {\n        throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n      }\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      const paidPrice = cart.products\n        .map((product) => product.price)\n        .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n      const card = {\n        cardToken,\n        cardUserKey: req.user?.cardUserKey,\n      };\n\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: paidPrice,\n        paidPrice: paidPrice,\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        paymentCard: card,\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ), //iyizpay tarih formatına çevirmek için yapıldı\n          registrationDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems: cart.products.map((product, index) => {\n          return {\n            id: String(product?._id),\n            name: product?.name,\n            category1: product.categories[0],\n            category2: product.categories[1],\n            itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n            price: product?.price,\n          };\n        }),\n      };\n\n      let result = await Payments.createPayment(data);\n      await CompletePayment(result);\n      res.json(result);\n    }\n  );\n\n  router.post(\n    \"/payments/:cartId/with-registered-card-token\",\n    Session,\n    async (req, res) => {\n      let { cardToken } = req.body;\n      if (!cardToken) {\n        throw new ApiError(\"Card Token is required\", 400, \"cardTokenRequired\");\n      }\n      if (!req.user?.cardUserKey) {\n        throw new ApiError(\n          \"No registered card available\",\n          400,\n          \"cardUserKeyRequired\"\n        );\n      }\n\n      if (!req.params?.cartId) {\n        throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      }\n      const cart = await Carts.findOne({ _id: req.params?.cartId })\n        .populate(\"buyer\")\n        .populate(\"products\");\n      if (!cart) {\n        throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n      }\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      const paidPrice = cart.products\n        .map((product) => product.price)\n        .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n      const card = {\n        cardToken,\n        cardUserKey: req.user?.cardUserKey,\n      };\n\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: paidPrice,\n        paidPrice: paidPrice,\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        paymentCard: card,\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ), //iyizpay tarih formatına çevirmek için yapıldı\n          registrationDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems: cart.products.map((product, index) => {\n          return {\n            id: String(product?._id),\n            name: product?.name,\n            category1: product.categories[0],\n            category2: product.categories[1],\n            itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n            price: product?.price,\n          };\n        }),\n      };\n\n      let result = await Payments.createPayment(data);\n      await CompletePayment(result);\n      res.json(result);\n    }\n  );\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1723544779433},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/payments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.createPayment = void 0;\nvar _iyzipay = _interopRequireDefault(require(\"../connection/iyzipay\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst createPayment = data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.payment.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.createPayment = createPayment;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaXl6aXBheSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiY3JlYXRlUGF5bWVudCIsImRhdGEiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIml5emlwYXkiLCJwYXltZW50IiwiY3JlYXRlIiwiZXJyIiwicmVzdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3NlcnZpY2VzL2l5emljby9tZXRob2RzLyIsInNvdXJjZXMiOlsicGF5bWVudHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGl5emlwYXkgZnJvbSBcIi4uL2Nvbm5lY3Rpb24vaXl6aXBheVwiO1xuXG5leHBvcnQgY29uc3QgY3JlYXRlUGF5bWVudCA9IChkYXRhKSA9PiB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgaXl6aXBheS5wYXltZW50LmNyZWF0ZShkYXRhLCAoZXJyLCByZXN1bHQpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsUUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQTRDLFNBQUFELHVCQUFBRSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBRXJDLE1BQU1HLGFBQWEsR0FBSUMsSUFBSSxJQUFLO0VBQ3JDLE9BQU8sSUFBSUMsT0FBTyxDQUFDLENBQUNDLE9BQU8sRUFBRUMsTUFBTSxLQUFLO0lBQ3RDQyxnQkFBTyxDQUFDQyxPQUFPLENBQUNDLE1BQU0sQ0FBQ04sSUFBSSxFQUFFLENBQUNPLEdBQUcsRUFBRUMsTUFBTSxLQUFLO01BQzVDLElBQUlELEdBQUcsRUFBRTtRQUNQSixNQUFNLENBQUNJLEdBQUcsQ0FBQztNQUNiLENBQUMsTUFBTTtRQUNMTCxPQUFPLENBQUNNLE1BQU0sQ0FBQztNQUNqQjtJQUNGLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztBQUNKLENBQUM7QUFBQ0MsT0FBQSxDQUFBVixhQUFBLEdBQUFBLGFBQUEiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_iyzipay","_interopRequireDefault","require","e","__esModule","default","createPayment","data","Promise","resolve","reject","iyzipay","payment","create","err","result","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/","sources":["payments.js"],"sourcesContent":["import iyzipay from \"../connection/iyzipay\";\n\nexport const createPayment = (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.payment.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA4C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAErC,MAAMG,aAAa,GAAIC,IAAI,IAAK;EACrC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,OAAO,CAACC,MAAM,CAACN,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MAC5C,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAV,aAAA,GAAAA,aAAA","ignoreList":[]}},"mtime":1723543937124},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/connection/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/connection/iyzipay.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _iyzipay = _interopRequireDefault(require(\"iyzipay\"));\nvar _config = _interopRequireDefault(require(\"../config/config\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst iyzipay = new _iyzipay.default(_config.default);\nvar _default = exports.default = iyzipay;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaXl6aXBheSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2NvbmZpZyIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIml5emlwYXkiLCJJeXppcGF5IiwiY29uZmlnIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvc2VydmljZXMvaXl6aWNvL2Nvbm5lY3Rpb24vIiwic291cmNlcyI6WyJpeXppcGF5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBJeXppcGF5IGZyb20gXCJpeXppcGF5XCI7XG5pbXBvcnQgY29uZmlnIGZyb20gXCIuLi9jb25maWcvY29uZmlnXCI7XG5cbmNvbnN0IGl5emlwYXkgPSBuZXcgSXl6aXBheShjb25maWcpO1xuXG5leHBvcnQgZGVmYXVsdCBpeXppcGF5O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxRQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxPQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFBc0MsU0FBQUQsdUJBQUFHLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFdEMsTUFBTUcsT0FBTyxHQUFHLElBQUlDLGdCQUFPLENBQUNDLGVBQU0sQ0FBQztBQUFDLElBQUFDLFFBQUEsR0FBQUMsT0FBQSxDQUFBTCxPQUFBLEdBRXJCQyxPQUFPIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["_iyzipay","_interopRequireDefault","require","_config","e","__esModule","default","iyzipay","Iyzipay","config","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/connection/","sources":["iyzipay.js"],"sourcesContent":["import Iyzipay from \"iyzipay\";\nimport config from \"../config/config\";\n\nconst iyzipay = new Iyzipay(config);\n\nexport default iyzipay;\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,OAAA,GAAAF,sBAAA,CAAAC,OAAA;AAAsC,SAAAD,uBAAAG,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEtC,MAAMG,OAAO,GAAG,IAAIC,gBAAO,CAACC,eAAM,CAAC;AAAC,IAAAC,QAAA,GAAAC,OAAA,CAAAL,OAAA,GAErBC,OAAO","ignoreList":[]}},"mtime":1723543937086},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/config/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/config/config.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\n//atkahmed9924@gmail.com\n// module.exports = {\n//   apiKey: \"sandbox-bkqCdxvCL1VB4bIisfgw9jIjhGHnanvp\",\n//   secretKey: \"7dvI95bSaaTgGKKolbDaOclal0iItwKg\",\n//   uri: \"https://sandbox-api.iyzipay.com\",\n// };\n\n//ahmed@turkotrend.com\nmodule.exports = {\n  apiKey: \"sandbox-6JrPHZxVTHmEzlLtD26I4mPoJDwUF07L\",\n  secretKey: \"sandbox-gvP5g1t24UWymP9K04JDuWjIWzZZwIDs\",\n  uri: \"https://sandbox-api.iyzipay.com\"\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb2R1bGUiLCJleHBvcnRzIiwiYXBpS2V5Iiwic2VjcmV0S2V5IiwidXJpIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvc2VydmljZXMvaXl6aWNvL2NvbmZpZy8iLCJzb3VyY2VzIjpbImNvbmZpZy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvL2F0a2FobWVkOTkyNEBnbWFpbC5jb21cbi8vIG1vZHVsZS5leHBvcnRzID0ge1xuLy8gICBhcGlLZXk6IFwic2FuZGJveC1ia3FDZHh2Q0wxVkI0Yklpc2ZndzlqSWpoR0huYW52cFwiLFxuLy8gICBzZWNyZXRLZXk6IFwiN2R2STk1YlNhYVRnR0tLb2xiRGFPY2xhbDBpSXR3S2dcIixcbi8vICAgdXJpOiBcImh0dHBzOi8vc2FuZGJveC1hcGkuaXl6aXBheS5jb21cIixcbi8vIH07XG5cbi8vYWhtZWRAdHVya290cmVuZC5jb21cbm1vZHVsZS5leHBvcnRzID0ge1xuICBhcGlLZXk6IFwic2FuZGJveC02SnJQSFp4VlRIbUV6bEx0RDI2STRtUG9KRHdVRjA3TFwiLFxuICBzZWNyZXRLZXk6IFwic2FuZGJveC1ndlA1ZzF0MjRVV3ltUDlLMDRKRHVXaklXelpad0lEc1wiLFxuICB1cmk6IFwiaHR0cHM6Ly9zYW5kYm94LWFwaS5peXppcGF5LmNvbVwiLFxufTtcbiJdLCJtYXBwaW5ncyI6Ijs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQUEsTUFBTSxDQUFDQyxPQUFPLEdBQUc7RUFDZkMsTUFBTSxFQUFFLDBDQUEwQztFQUNsREMsU0FBUyxFQUFFLDBDQUEwQztFQUNyREMsR0FBRyxFQUFFO0FBQ1AsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["module","exports","apiKey","secretKey","uri"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/config/","sources":["config.js"],"sourcesContent":["//atkahmed9924@gmail.com\n// module.exports = {\n//   apiKey: \"sandbox-bkqCdxvCL1VB4bIisfgw9jIjhGHnanvp\",\n//   secretKey: \"7dvI95bSaaTgGKKolbDaOclal0iItwKg\",\n//   uri: \"https://sandbox-api.iyzipay.com\",\n// };\n\n//ahmed@turkotrend.com\nmodule.exports = {\n  apiKey: \"sandbox-6JrPHZxVTHmEzlLtD26I4mPoJDwUF07L\",\n  secretKey: \"sandbox-gvP5g1t24UWymP9K04JDuWjIWzZZwIDs\",\n  uri: \"https://sandbox-api.iyzipay.com\",\n};\n"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACAA,MAAM,CAACC,OAAO,GAAG;EACfC,MAAM,EAAE,0CAA0C;EAClDC,SAAS,EAAE,0CAA0C;EACrDC,GAAG,EAAE;AACP,CAAC","ignoreList":[]}},"mtime":1731316713759},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/cards.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar Cards = _interopRequireWildcard(require(\"../services/iyzico/methods/cards\"));\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function (e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\n//varolan kullanıcıya kart ekleme methodu (yeni kart ekliyor o yüzden var olan db verisinin içerisine yeni satır ile cardUserKey eklendi)\nvar _default = router => {\n  //session koyma sebebi kullanıcı login olduğu zaman bu sayfaya erişeceği için\n  router.post(\"/cards\", _Session.default, async (req, res) => {\n    const {\n      card\n    } = req.body;\n    let result = await Cards.createUserCard({\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      email: req.user.email,\n      externalId: (0, _uuid.default)(),\n      ...(req.user?.cardUserKey && {\n        cardUserKey: req.user.cardUserKey\n      }),\n      card: card\n    });\n    if (!req.user.cardUserKey) {\n      if (result?.status === \"success\" && result?.cardUserKey) {\n        const user = await _users.default.findOne({\n          _id: req.user?._id\n        });\n        user.cardUserKey = result?.cardUserKey;\n        await user.save();\n      }\n    }\n    res.json(result);\n  });\n\n  //kullanıcıya ait olan kartları okuma\n  router.get(\"/cards\", _Session.default, async (req, res) => {\n    if (!req.user?.cardUserKey) {\n      throw new _ApiError.default(\"User has no credit card\", 403, \"userHasNoCard\");\n    }\n    let cards = await Cards.getUserCards({\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      cardUserKey: req.user?.cardUserKey\n    });\n    res.status(200).json(cards);\n  });\n\n  //kullanıcıya tanımlı olan kartı silmek\n  router.delete(\"/cards/delete-by-token\", _Session.default, async (req, res) => {\n    const {\n      cardToken\n    } = req.body;\n    if (!cardToken) {\n      throw new _ApiError.default(\"Card token is required\", 400, \"cardTokenRequired\");\n    }\n    let deleteResult = await Cards.deleteUserCard({\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      cardUserKey: req.user?.cardUserKey,\n      cardToken: cardToken\n    });\n    res.status(200).json(deleteResult);\n  });\n\n  //kart silme index\n  router.delete(\"/cards/:cardIndex/delete-by-index\", _Session.default, async (req, res) => {\n    if (!req.params?.cardIndex) {\n      throw new _ApiError.default(\"Card Index is required\", 400, \"cardIndexRequired\");\n    }\n    let cards = await Cards.getUserCards({\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      cardUserKey: req.user?.cardUserKey\n    });\n    const index = parseInt(req.params?.cardIndex); //urldeki cardIndex kısmındaki sayıyı int olarak alır(defaultu string normalde)\n    if (index >= cards?.cardDetails.length) {\n      throw new _ApiError.default(\"Card Does not exists\", 400, \"cardIndexInvalid\");\n    }\n    const {\n      cardToken\n    } = cards?.cardDetails[index];\n    let deleteResult = await Cards.deleteUserCard({\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      cardUserKey: req.user?.cardUserKey,\n      cardToken: cardToken\n    });\n    res.json(deleteResult);\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQXBpRXJyb3IiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIkNhcmRzIiwiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJfdXNlcnMiLCJfdXVpZCIsIl9TZXNzaW9uIiwiX2dldFJlcXVpcmVXaWxkY2FyZENhY2hlIiwiZSIsIldlYWtNYXAiLCJyIiwidCIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiaGFzIiwiZ2V0IiwibiIsIl9fcHJvdG9fXyIsImEiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsInUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJpIiwic2V0IiwiX2RlZmF1bHQiLCJyb3V0ZXIiLCJwb3N0IiwiU2Vzc2lvbiIsInJlcSIsInJlcyIsImNhcmQiLCJib2R5IiwicmVzdWx0IiwiY3JlYXRlVXNlckNhcmQiLCJsb2NhbGUiLCJ1c2VyIiwiY29udmVyc2F0aW9uSWQiLCJpZCIsImVtYWlsIiwiZXh0ZXJuYWxJZCIsImNhcmRVc2VyS2V5Iiwic3RhdHVzIiwiVXNlcnMiLCJmaW5kT25lIiwiX2lkIiwic2F2ZSIsImpzb24iLCJBcGlFcnJvciIsImNhcmRzIiwiZ2V0VXNlckNhcmRzIiwiZGVsZXRlIiwiY2FyZFRva2VuIiwiZGVsZXRlUmVzdWx0IiwiZGVsZXRlVXNlckNhcmQiLCJwYXJhbXMiLCJjYXJkSW5kZXgiLCJpbmRleCIsInBhcnNlSW50IiwiY2FyZERldGFpbHMiLCJsZW5ndGgiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvcm91dGVzLyIsInNvdXJjZXMiOlsiY2FyZHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuLi9lcnJvcnMvQXBpRXJyb3JcIjtcbmltcG9ydCAqIGFzIENhcmRzIGZyb20gXCIuLi9zZXJ2aWNlcy9peXppY28vbWV0aG9kcy9jYXJkc1wiO1xuaW1wb3J0IFVzZXJzIGZyb20gXCIuLi9kYi91c2Vyc1wiO1xuaW1wb3J0IGlkIGZyb20gXCIuLi91dGlscy91dWlkXCI7XG5pbXBvcnQgU2Vzc2lvbiBmcm9tIFwiLi4vbWlkZGxld2FyZXMvU2Vzc2lvblwiO1xuXG4vL3Zhcm9sYW4ga3VsbGFuxLFjxLF5YSBrYXJ0IGVrbGVtZSBtZXRob2R1ICh5ZW5pIGthcnQgZWtsaXlvciBvIHnDvHpkZW4gdmFyIG9sYW4gZGIgdmVyaXNpbmluIGnDp2VyaXNpbmUgeWVuaSBzYXTEsXIgaWxlIGNhcmRVc2VyS2V5IGVrbGVuZGkpXG5leHBvcnQgZGVmYXVsdCAocm91dGVyKSA9PiB7XG4gIC8vc2Vzc2lvbiBrb3ltYSBzZWJlYmkga3VsbGFuxLFjxLEgbG9naW4gb2xkdcSfdSB6YW1hbiBidSBzYXlmYXlhIGVyacWfZWNlxJ9pIGnDp2luXG4gIHJvdXRlci5wb3N0KFwiL2NhcmRzXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGNvbnN0IHsgY2FyZCB9ID0gcmVxLmJvZHk7XG4gICAgbGV0IHJlc3VsdCA9IGF3YWl0IENhcmRzLmNyZWF0ZVVzZXJDYXJkKHtcbiAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICBlbWFpbDogcmVxLnVzZXIuZW1haWwsXG4gICAgICBleHRlcm5hbElkOiBpZCgpLFxuICAgICAgLi4uKHJlcS51c2VyPy5jYXJkVXNlcktleSAmJiB7XG4gICAgICAgIGNhcmRVc2VyS2V5OiByZXEudXNlci5jYXJkVXNlcktleSxcbiAgICAgIH0pLFxuICAgICAgY2FyZDogY2FyZCxcbiAgICB9KTtcbiAgICBpZiAoIXJlcS51c2VyLmNhcmRVc2VyS2V5KSB7XG4gICAgICBpZiAocmVzdWx0Py5zdGF0dXMgPT09IFwic3VjY2Vzc1wiICYmIHJlc3VsdD8uY2FyZFVzZXJLZXkpIHtcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXJzLmZpbmRPbmUoe1xuICAgICAgICAgIF9pZDogcmVxLnVzZXI/Ll9pZCxcbiAgICAgICAgfSk7XG4gICAgICAgIHVzZXIuY2FyZFVzZXJLZXkgPSByZXN1bHQ/LmNhcmRVc2VyS2V5O1xuICAgICAgICBhd2FpdCB1c2VyLnNhdmUoKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmVzLmpzb24ocmVzdWx0KTtcbiAgfSk7XG5cbiAgLy9rdWxsYW7EsWPEsXlhIGFpdCBvbGFuIGthcnRsYXLEsSBva3VtYVxuICByb3V0ZXIuZ2V0KFwiL2NhcmRzXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGlmICghcmVxLnVzZXI/LmNhcmRVc2VyS2V5KSB7XG4gICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJVc2VyIGhhcyBubyBjcmVkaXQgY2FyZFwiLCA0MDMsIFwidXNlckhhc05vQ2FyZFwiKTtcbiAgICB9XG4gICAgbGV0IGNhcmRzID0gYXdhaXQgQ2FyZHMuZ2V0VXNlckNhcmRzKHtcbiAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICBjYXJkVXNlcktleTogcmVxLnVzZXI/LmNhcmRVc2VyS2V5LFxuICAgIH0pO1xuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKGNhcmRzKTtcbiAgfSk7XG5cbiAgLy9rdWxsYW7EsWPEsXlhIHRhbsSxbWzEsSBvbGFuIGthcnTEsSBzaWxtZWtcbiAgcm91dGVyLmRlbGV0ZShcIi9jYXJkcy9kZWxldGUtYnktdG9rZW5cIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyBjYXJkVG9rZW4gfSA9IHJlcS5ib2R5O1xuICAgIGlmICghY2FyZFRva2VuKSB7XG4gICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIHRva2VuIGlzIHJlcXVpcmVkXCIsIDQwMCwgXCJjYXJkVG9rZW5SZXF1aXJlZFwiKTtcbiAgICB9XG4gICAgbGV0IGRlbGV0ZVJlc3VsdCA9IGF3YWl0IENhcmRzLmRlbGV0ZVVzZXJDYXJkKHtcbiAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICBjYXJkVXNlcktleTogcmVxLnVzZXI/LmNhcmRVc2VyS2V5LFxuICAgICAgY2FyZFRva2VuOiBjYXJkVG9rZW4sXG4gICAgfSk7XG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oZGVsZXRlUmVzdWx0KTtcbiAgfSk7XG5cbiAgLy9rYXJ0IHNpbG1lIGluZGV4XG4gIHJvdXRlci5kZWxldGUoXG4gICAgXCIvY2FyZHMvOmNhcmRJbmRleC9kZWxldGUtYnktaW5kZXhcIixcbiAgICBTZXNzaW9uLFxuICAgIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgICAgaWYgKCFyZXEucGFyYW1zPy5jYXJkSW5kZXgpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FyZCBJbmRleCBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FyZEluZGV4UmVxdWlyZWRcIik7XG4gICAgICB9XG4gICAgICBsZXQgY2FyZHMgPSBhd2FpdCBDYXJkcy5nZXRVc2VyQ2FyZHMoe1xuICAgICAgICBsb2NhbGU6IHJlcS51c2VyLmxvY2FsZSxcbiAgICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICAgIGNhcmRVc2VyS2V5OiByZXEudXNlcj8uY2FyZFVzZXJLZXksXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IGluZGV4ID0gcGFyc2VJbnQocmVxLnBhcmFtcz8uY2FyZEluZGV4KTsgLy91cmxkZWtpIGNhcmRJbmRleCBrxLFzbcSxbmRha2kgc2F5xLF5xLEgaW50IG9sYXJhayBhbMSxcihkZWZhdWx0dSBzdHJpbmcgbm9ybWFsZGUpXG4gICAgICBpZiAoaW5kZXggPj0gY2FyZHM/LmNhcmREZXRhaWxzLmxlbmd0aCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIERvZXMgbm90IGV4aXN0c1wiLCA0MDAsIFwiY2FyZEluZGV4SW52YWxpZFwiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgY2FyZFRva2VuIH0gPSBjYXJkcz8uY2FyZERldGFpbHNbaW5kZXhdO1xuICAgICAgbGV0IGRlbGV0ZVJlc3VsdCA9IGF3YWl0IENhcmRzLmRlbGV0ZVVzZXJDYXJkKHtcbiAgICAgICAgbG9jYWxlOiByZXEudXNlci5sb2NhbGUsXG4gICAgICAgIGNvbnZlcnNhdGlvbklkOiBpZCgpLFxuICAgICAgICBjYXJkVXNlcktleTogcmVxLnVzZXI/LmNhcmRVc2VyS2V5LFxuICAgICAgICBjYXJkVG9rZW46IGNhcmRUb2tlbixcbiAgICAgIH0pO1xuXG4gICAgICByZXMuanNvbihkZWxldGVSZXN1bHQpO1xuICAgIH1cbiAgKTtcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLEtBQUEsR0FBQUMsdUJBQUEsQ0FBQUYsT0FBQTtBQUNBLElBQUFHLE1BQUEsR0FBQUosc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFJLEtBQUEsR0FBQUwsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFLLFFBQUEsR0FBQU4sc0JBQUEsQ0FBQUMsT0FBQTtBQUE2QyxTQUFBTSx5QkFBQUMsQ0FBQSw2QkFBQUMsT0FBQSxtQkFBQUMsQ0FBQSxPQUFBRCxPQUFBLElBQUFFLENBQUEsT0FBQUYsT0FBQSxZQUFBRix3QkFBQSxZQUFBQSxDQUFBQyxDQUFBLFdBQUFBLENBQUEsR0FBQUcsQ0FBQSxHQUFBRCxDQUFBLEtBQUFGLENBQUE7QUFBQSxTQUFBTCx3QkFBQUssQ0FBQSxFQUFBRSxDQUFBLFNBQUFBLENBQUEsSUFBQUYsQ0FBQSxJQUFBQSxDQUFBLENBQUFJLFVBQUEsU0FBQUosQ0FBQSxlQUFBQSxDQUFBLHVCQUFBQSxDQUFBLHlCQUFBQSxDQUFBLFdBQUFLLE9BQUEsRUFBQUwsQ0FBQSxRQUFBRyxDQUFBLEdBQUFKLHdCQUFBLENB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","map":{"version":3,"names":["_ApiError","_interopRequireDefault","require","Cards","_interopRequireWildcard","_users","_uuid","_Session","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","_default","router","post","Session","req","res","card","body","result","createUserCard","locale","user","conversationId","id","email","externalId","cardUserKey","status","Users","findOne","_id","save","json","ApiError","cards","getUserCards","delete","cardToken","deleteResult","deleteUserCard","params","cardIndex","index","parseInt","cardDetails","length","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["cards.js"],"sourcesContent":["import ApiError from \"../errors/ApiError\";\nimport * as Cards from \"../services/iyzico/methods/cards\";\nimport Users from \"../db/users\";\nimport id from \"../utils/uuid\";\nimport Session from \"../middlewares/Session\";\n\n//varolan kullanıcıya kart ekleme methodu (yeni kart ekliyor o yüzden var olan db verisinin içerisine yeni satır ile cardUserKey eklendi)\nexport default (router) => {\n  //session koyma sebebi kullanıcı login olduğu zaman bu sayfaya erişeceği için\n  router.post(\"/cards\", Session, async (req, res) => {\n    const { card } = req.body;\n    let result = await Cards.createUserCard({\n      locale: req.user.locale,\n      conversationId: id(),\n      email: req.user.email,\n      externalId: id(),\n      ...(req.user?.cardUserKey && {\n        cardUserKey: req.user.cardUserKey,\n      }),\n      card: card,\n    });\n    if (!req.user.cardUserKey) {\n      if (result?.status === \"success\" && result?.cardUserKey) {\n        const user = await Users.findOne({\n          _id: req.user?._id,\n        });\n        user.cardUserKey = result?.cardUserKey;\n        await user.save();\n      }\n    }\n    res.json(result);\n  });\n\n  //kullanıcıya ait olan kartları okuma\n  router.get(\"/cards\", Session, async (req, res) => {\n    if (!req.user?.cardUserKey) {\n      throw new ApiError(\"User has no credit card\", 403, \"userHasNoCard\");\n    }\n    let cards = await Cards.getUserCards({\n      locale: req.user.locale,\n      conversationId: id(),\n      cardUserKey: req.user?.cardUserKey,\n    });\n    res.status(200).json(cards);\n  });\n\n  //kullanıcıya tanımlı olan kartı silmek\n  router.delete(\"/cards/delete-by-token\", Session, async (req, res) => {\n    const { cardToken } = req.body;\n    if (!cardToken) {\n      throw new ApiError(\"Card token is required\", 400, \"cardTokenRequired\");\n    }\n    let deleteResult = await Cards.deleteUserCard({\n      locale: req.user.locale,\n      conversationId: id(),\n      cardUserKey: req.user?.cardUserKey,\n      cardToken: cardToken,\n    });\n    res.status(200).json(deleteResult);\n  });\n\n  //kart silme index\n  router.delete(\n    \"/cards/:cardIndex/delete-by-index\",\n    Session,\n    async (req, res) => {\n      if (!req.params?.cardIndex) {\n        throw new ApiError(\"Card Index is required\", 400, \"cardIndexRequired\");\n      }\n      let cards = await Cards.getUserCards({\n        locale: req.user.locale,\n        conversationId: id(),\n        cardUserKey: req.user?.cardUserKey,\n      });\n      const index = parseInt(req.params?.cardIndex); //urldeki cardIndex kısmındaki sayıyı int olarak alır(defaultu string normalde)\n      if (index >= cards?.cardDetails.length) {\n        throw new ApiError(\"Card Does not exists\", 400, \"cardIndexInvalid\");\n      }\n      const { cardToken } = cards?.cardDetails[index];\n      let deleteResult = await Cards.deleteUserCard({\n        locale: req.user.locale,\n        conversationId: id(),\n        cardUserKey: req.user?.cardUserKey,\n        cardToken: cardToken,\n      });\n\n      res.json(deleteResult);\n    }\n  );\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1724662769652},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/cards.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getUserCards = exports.deleteUserCard = exports.createUserCard = void 0;\nvar _iyzipay = _interopRequireDefault(require(\"../connection/iyzipay\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst createUserCard = async data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.card.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.createUserCard = createUserCard;\nconst getUserCards = async data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.cardList.retrieve(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.getUserCards = getUserCards;\nconst deleteUserCard = async data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.card.delete(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.deleteUserCard = deleteUserCard;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaXl6aXBheSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiY3JlYXRlVXNlckNhcmQiLCJkYXRhIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJpeXppcGF5IiwiY2FyZCIsImNyZWF0ZSIsImVyciIsInJlc3VsdCIsImV4cG9ydHMiLCJnZXRVc2VyQ2FyZHMiLCJjYXJkTGlzdCIsInJldHJpZXZlIiwiZGVsZXRlVXNlckNhcmQiLCJkZWxldGUiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9zZXJ2aWNlcy9peXppY28vbWV0aG9kcy8iLCJzb3VyY2VzIjpbImNhcmRzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBpeXppcGF5IGZyb20gXCIuLi9jb25uZWN0aW9uL2l5emlwYXlcIjtcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZVVzZXJDYXJkID0gYXN5bmMgKGRhdGEpID0+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBpeXppcGF5LmNhcmQuY3JlYXRlKGRhdGEsIChlcnIsIHJlc3VsdCkgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0VXNlckNhcmRzID0gYXN5bmMgKGRhdGEpID0+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBpeXppcGF5LmNhcmRMaXN0LnJldHJpZXZlKGRhdGEsIChlcnIsIHJlc3VsdCkgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59O1xuXG5leHBvcnQgY29uc3QgZGVsZXRlVXNlckNhcmQgPSBhc3luYyAoZGF0YSkgPT4ge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGl5emlwYXkuY2FyZC5kZWxldGUoZGF0YSwgKGVyciwgcmVzdWx0KSA9PiB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFFBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUE0QyxTQUFBRCx1QkFBQUUsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUVyQyxNQUFNRyxjQUFjLEdBQUcsTUFBT0MsSUFBSSxJQUFLO0VBQzVDLE9BQU8sSUFBSUMsT0FBTyxDQUFDLENBQUNDLE9BQU8sRUFBRUMsTUFBTSxLQUFLO0lBQ3RDQyxnQkFBTyxDQUFDQyxJQUFJLENBQUNDLE1BQU0sQ0FBQ04sSUFBSSxFQUFFLENBQUNPLEdBQUcsRUFBRUMsTUFBTSxLQUFLO01BQ3pDLElBQUlELEdBQUcsRUFBRTtRQUNQSixNQUFNLENBQUNJLEdBQUcsQ0FBQztNQUNiLENBQUMsTUFBTTtRQUNMTCxPQUFPLENBQUNNLE1BQU0sQ0FBQztNQUNqQjtJQUNGLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztBQUNKLENBQUM7QUFBQ0MsT0FBQSxDQUFBVixjQUFBLEdBQUFBLGNBQUE7QUFFSyxNQUFNVyxZQUFZLEdBQUcsTUFBT1YsSUFBSSxJQUFLO0VBQzFDLE9BQU8sSUFBSUMsT0FBTyxDQUFDLENBQUNDLE9BQU8sRUFBRUMsTUFBTSxLQUFLO0lBQ3RDQyxnQkFBTyxDQUFDTyxRQUFRLENBQUNDLFFBQVEsQ0FBQ1osSUFBSSxFQUFFLENBQUNPLEdBQUcsRUFBRUMsTUFBTSxLQUFLO01BQy9DLElBQUlELEdBQUcsRUFBRTtRQUNQSixNQUFNLENBQUNJLEdBQUcsQ0FBQztNQUNiLENBQUMsTUFBTTtRQUNMTCxPQUFPLENBQUNNLE1BQU0sQ0FBQztNQUNqQjtJQUNGLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztBQUNKLENBQUM7QUFBQ0MsT0FBQSxDQUFBQyxZQUFBLEdBQUFBLFlBQUE7QUFFSyxNQUFNRyxjQUFjLEdBQUcsTUFBT2IsSUFBSSxJQUFLO0VBQzVDLE9BQU8sSUFBSUMsT0FBTyxDQUFDLENBQUNDLE9BQU8sRUFBRUMsTUFBTSxLQUFLO0lBQ3RDQyxnQkFBTyxDQUFDQyxJQUFJLENBQUNTLE1BQU0sQ0FBQ2QsSUFBSSxFQUFFLENBQUNPLEdBQUcsRUFBRUMsTUFBTSxLQUFLO01BQ3pDLElBQUlELEdBQUcsRUFBRTtRQUNQSixNQUFNLENBQUNJLEdBQUcsQ0FBQztNQUNiLENBQUMsTUFBTTtRQUNMTCxPQUFPLENBQUNNLE1BQU0sQ0FBQztNQUNqQjtJQUNGLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztBQUNKLENBQUM7QUFBQ0MsT0FBQSxDQUFBSSxjQUFBLEdBQUFBLGNBQUEiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_iyzipay","_interopRequireDefault","require","e","__esModule","default","createUserCard","data","Promise","resolve","reject","iyzipay","card","create","err","result","exports","getUserCards","cardList","retrieve","deleteUserCard","delete"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/","sources":["cards.js"],"sourcesContent":["import iyzipay from \"../connection/iyzipay\";\n\nexport const createUserCard = async (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.card.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n\nexport const getUserCards = async (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.cardList.retrieve(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n\nexport const deleteUserCard = async (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.card.delete(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA4C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAErC,MAAMG,cAAc,GAAG,MAAOC,IAAI,IAAK;EAC5C,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,IAAI,CAACC,MAAM,CAACN,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MACzC,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAV,cAAA,GAAAA,cAAA;AAEK,MAAMW,YAAY,GAAG,MAAOV,IAAI,IAAK;EAC1C,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACO,QAAQ,CAACC,QAAQ,CAACZ,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MAC/C,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAC,YAAA,GAAAA,YAAA;AAEK,MAAMG,cAAc,GAAG,MAAOb,IAAI,IAAK;EAC5C,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,IAAI,CAACS,MAAM,CAACd,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MACzC,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAI,cAAA,GAAAA,cAAA","ignoreList":[]}},"mtime":1723543937120},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/utils/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/utils/payments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.CompletePayment = void 0;\nvar _mongoose = require(\"mongoose\");\nvar _paymentSuccess = _interopRequireDefault(require(\"../db/payment-success\"));\nvar _paymentFailed = _interopRequireDefault(require(\"../db/payment-failed\"));\nvar _cart = _interopRequireDefault(require(\"../db/cart\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst {\n  ObjectId\n} = _mongoose.Types;\nconst CompletePayment = async result => {\n  if (result?.status === \"success\") {\n    await _cart.default.updateOne({\n      _id: new ObjectId(result.basketId)\n    }, {\n      $set: {\n        completed: true\n      }\n    });\n    await _paymentSuccess.default.create({\n      status: result?.status,\n      cartId: result?.basketId,\n      conversationId: result?.conversationId,\n      currency: result?.currency,\n      paymentId: result?.paymentId,\n      price: result?.price,\n      paidPrice: result?.paidPrice,\n      itemTransactions: result?.itemTransactions.map(item => {\n        return {\n          itemId: item?.itemId,\n          paymentTransactionId: item?.paymentTransactionId,\n          price: item?.price,\n          paidPrice: item?.paidPrice\n        };\n      }),\n      log: result\n    });\n  } else {\n    await _paymentFailed.default.create({\n      status: result?.status,\n      conversationId: result?.conversationId,\n      errorCode: result?.errorCode,\n      errorMessage: result?.errorMessage,\n      log: result\n    });\n  }\n};\nexports.CompletePayment = CompletePayment;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJyZXF1aXJlIiwiX3BheW1lbnRTdWNjZXNzIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIl9wYXltZW50RmFpbGVkIiwiX2NhcnQiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJPYmplY3RJZCIsIlR5cGVzIiwiQ29tcGxldGVQYXltZW50IiwicmVzdWx0Iiwic3RhdHVzIiwiQ2FydHMiLCJ1cGRhdGVPbmUiLCJfaWQiLCJiYXNrZXRJZCIsIiRzZXQiLCJjb21wbGV0ZWQiLCJQYXltZW50U3VjY2VzcyIsImNyZWF0ZSIsImNhcnRJZCIsImNvbnZlcnNhdGlvbklkIiwiY3VycmVuY3kiLCJwYXltZW50SWQiLCJwcmljZSIsInBhaWRQcmljZSIsIml0ZW1UcmFuc2FjdGlvbnMiLCJtYXAiLCJpdGVtIiwiaXRlbUlkIiwicGF5bWVudFRyYW5zYWN0aW9uSWQiLCJsb2ciLCJQYXltZW50RmFpbGVkIiwiZXJyb3JDb2RlIiwiZXJyb3JNZXNzYWdlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3V0aWxzLyIsInNvdXJjZXMiOlsicGF5bWVudHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVHlwZXMgfSBmcm9tIFwibW9uZ29vc2VcIjtcbmltcG9ydCBQYXltZW50U3VjY2VzcyBmcm9tIFwiLi4vZGIvcGF5bWVudC1zdWNjZXNzXCI7XG5pbXBvcnQgUGF5bWVudEZhaWxlZCBmcm9tIFwiLi4vZGIvcGF5bWVudC1mYWlsZWRcIjtcbmltcG9ydCBDYXJ0cyBmcm9tIFwiLi4vZGIvY2FydFwiO1xuY29uc3QgeyBPYmplY3RJZCB9ID0gVHlwZXM7XG5cbmV4cG9ydCBjb25zdCBDb21wbGV0ZVBheW1lbnQgPSBhc3luYyAocmVzdWx0KSA9PiB7XG4gIGlmIChyZXN1bHQ/LnN0YXR1cyA9PT0gXCJzdWNjZXNzXCIpIHtcbiAgICBhd2FpdCBDYXJ0cy51cGRhdGVPbmUoXG4gICAgICB7IF9pZDogbmV3IE9iamVjdElkKHJlc3VsdC5iYXNrZXRJZCkgfSxcbiAgICAgIHsgJHNldDogeyBjb21wbGV0ZWQ6IHRydWUgfSB9XG4gICAgKTtcbiAgICBhd2FpdCBQYXltZW50U3VjY2Vzcy5jcmVhdGUoe1xuICAgICAgc3RhdHVzOiByZXN1bHQ/LnN0YXR1cyxcbiAgICAgIGNhcnRJZDogcmVzdWx0Py5iYXNrZXRJZCxcbiAgICAgIGNvbnZlcnNhdGlvbklkOiByZXN1bHQ/LmNvbnZlcnNhdGlvbklkLFxuICAgICAgY3VycmVuY3k6IHJlc3VsdD8uY3VycmVuY3ksXG4gICAgICBwYXltZW50SWQ6IHJlc3VsdD8ucGF5bWVudElkLFxuICAgICAgcHJpY2U6IHJlc3VsdD8ucHJpY2UsXG4gICAgICBwYWlkUHJpY2U6IHJlc3VsdD8ucGFpZFByaWNlLFxuICAgICAgaXRlbVRyYW5zYWN0aW9uczogcmVzdWx0Py5pdGVtVHJhbnNhY3Rpb25zLm1hcCgoaXRlbSkgPT4ge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGl0ZW1JZDogaXRlbT8uaXRlbUlkLFxuICAgICAgICAgIHBheW1lbnRUcmFuc2FjdGlvbklkOiBpdGVtPy5wYXltZW50VHJhbnNhY3Rpb25JZCxcbiAgICAgICAgICBwcmljZTogaXRlbT8ucHJpY2UsXG4gICAgICAgICAgcGFpZFByaWNlOiBpdGVtPy5wYWlkUHJpY2UsXG4gICAgICAgIH07XG4gICAgICB9KSxcbiAgICAgIGxvZzogcmVzdWx0LFxuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIGF3YWl0IFBheW1lbnRGYWlsZWQuY3JlYXRlKHtcbiAgICAgIHN0YXR1czogcmVzdWx0Py5zdGF0dXMsXG4gICAgICBjb252ZXJzYXRpb25JZDogcmVzdWx0Py5jb252ZXJzYXRpb25JZCxcbiAgICAgIGVycm9yQ29kZTogcmVzdWx0Py5lcnJvckNvZGUsXG4gICAgICBlcnJvck1lc3NhZ2U6IHJlc3VsdD8uZXJyb3JNZXNzYWdlLFxuICAgICAgbG9nOiByZXN1bHQsXG4gICAgfSk7XG4gIH1cbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsT0FBQTtBQUNBLElBQUFDLGVBQUEsR0FBQUMsc0JBQUEsQ0FBQUYsT0FBQTtBQUNBLElBQUFHLGNBQUEsR0FBQUQsc0JBQUEsQ0FBQUYsT0FBQTtBQUNBLElBQUFJLEtBQUEsR0FBQUYsc0JBQUEsQ0FBQUYsT0FBQTtBQUErQixTQUFBRSx1QkFBQUcsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUMvQixNQUFNO0VBQUVHO0FBQVMsQ0FBQyxHQUFHQyxlQUFLO0FBRW5CLE1BQU1DLGVBQWUsR0FBRyxNQUFPQyxNQUFNLElBQUs7RUFDL0MsSUFBSUEsTUFBTSxFQUFFQyxNQUFNLEtBQUssU0FBUyxFQUFFO0lBQ2hDLE1BQU1DLGFBQUssQ0FBQ0MsU0FBUyxDQUNuQjtNQUFFQyxHQUFHLEVBQUUsSUFBSVAsUUFBUSxDQUFDRyxNQUFNLENBQUNLLFFBQVE7SUFBRSxDQUFDLEVBQ3RDO01BQUVDLElBQUksRUFBRTtRQUFFQyxTQUFTLEVBQUU7TUFBSztJQUFFLENBQzlCLENBQUM7SUFDRCxNQUFNQyx1QkFBYyxDQUFDQyxNQUFNLENBQUM7TUFDMUJSLE1BQU0sRUFBRUQsTUFBTSxFQUFFQyxNQUFNO01BQ3RCUyxNQUFNLEVBQUVWLE1BQU0sRUFBRUssUUFBUTtNQUN4Qk0sY0FBYyxFQUFFWCxNQUFNLEVBQUVXLGNBQWM7TUFDdENDLFFBQVEsRUFBRVosTUFBTSxFQUFFWSxRQUFRO01BQzFCQyxTQUFTLEVBQUViLE1BQU0sRUFBRWEsU0FBUztNQUM1QkMsS0FBSyxFQUFFZCxNQUFNLEVBQUVjLEtBQUs7TUFDcEJDLFNBQVMsRUFBRWYsTUFBTSxFQUFFZSxTQUFTO01BQzVCQyxnQkFBZ0IsRUFBRWhCLE1BQU0sRUFBRWdCLGdCQUFnQixDQUFDQyxHQUFHLENBQUVDLElBQUksSUFBSztRQUN2RCxPQUFPO1VBQ0xDLE1BQU0sRUFBRUQsSUFBSSxFQUFFQyxNQUFNO1VBQ3BCQyxvQkFBb0IsRUFBRUYsSUFBSSxFQUFFRSxvQkFBb0I7VUFDaEROLEtBQUssRUFBRUksSUFBSSxFQUFFSixLQUFLO1VBQ2xCQyxTQUFTLEVBQUVHLElBQUksRUFBRUg7UUFDbkIsQ0FBQztNQUNILENBQUMsQ0FBQztNQUNGTSxHQUFHLEVBQUVyQjtJQUNQLENBQUMsQ0FBQztFQUNKLENBQUMsTUFBTTtJQUNMLE1BQU1zQixzQkFBYSxDQUFDYixNQUFNLENBQUM7TUFDekJSLE1BQU0sRUFBRUQsTUFBTSxFQUFFQyxNQUFNO01BQ3RCVSxjQUFjLEVBQUVYLE1BQU0sRUFBRVcsY0FBYztNQUN0Q1ksU0FBUyxFQUFFdkIsTUFBTSxFQUFFdUIsU0FBUztNQUM1QkMsWUFBWSxFQUFFeEIsTUFBTSxFQUFFd0IsWUFBWTtNQUNsQ0gsR0FBRyxFQUFFckI7SUFDUCxDQUFDLENBQUM7RUFDSjtBQUNGLENBQUM7QUFBQ3lCLE9BQUEsQ0FBQTFCLGVBQUEsR0FBQUEsZUFBQSIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_mongoose","require","_paymentSuccess","_interopRequireDefault","_paymentFailed","_cart","e","__esModule","default","ObjectId","Types","CompletePayment","result","status","Carts","updateOne","_id","basketId","$set","completed","PaymentSuccess","create","cartId","conversationId","currency","paymentId","price","paidPrice","itemTransactions","map","item","itemId","paymentTransactionId","log","PaymentFailed","errorCode","errorMessage","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/utils/","sources":["payments.js"],"sourcesContent":["import { Types } from \"mongoose\";\nimport PaymentSuccess from \"../db/payment-success\";\nimport PaymentFailed from \"../db/payment-failed\";\nimport Carts from \"../db/cart\";\nconst { ObjectId } = Types;\n\nexport const CompletePayment = async (result) => {\n  if (result?.status === \"success\") {\n    await Carts.updateOne(\n      { _id: new ObjectId(result.basketId) },\n      { $set: { completed: true } }\n    );\n    await PaymentSuccess.create({\n      status: result?.status,\n      cartId: result?.basketId,\n      conversationId: result?.conversationId,\n      currency: result?.currency,\n      paymentId: result?.paymentId,\n      price: result?.price,\n      paidPrice: result?.paidPrice,\n      itemTransactions: result?.itemTransactions.map((item) => {\n        return {\n          itemId: item?.itemId,\n          paymentTransactionId: item?.paymentTransactionId,\n          price: item?.price,\n          paidPrice: item?.paidPrice,\n        };\n      }),\n      log: result,\n    });\n  } else {\n    await PaymentFailed.create({\n      status: result?.status,\n      conversationId: result?.conversationId,\n      errorCode: result?.errorCode,\n      errorMessage: result?.errorMessage,\n      log: result,\n    });\n  }\n};\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,OAAA;AACA,IAAAC,eAAA,GAAAC,sBAAA,CAAAF,OAAA;AACA,IAAAG,cAAA,GAAAD,sBAAA,CAAAF,OAAA;AACA,IAAAI,KAAA,GAAAF,sBAAA,CAAAF,OAAA;AAA+B,SAAAE,uBAAAG,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAC/B,MAAM;EAAEG;AAAS,CAAC,GAAGC,eAAK;AAEnB,MAAMC,eAAe,GAAG,MAAOC,MAAM,IAAK;EAC/C,IAAIA,MAAM,EAAEC,MAAM,KAAK,SAAS,EAAE;IAChC,MAAMC,aAAK,CAACC,SAAS,CACnB;MAAEC,GAAG,EAAE,IAAIP,QAAQ,CAACG,MAAM,CAACK,QAAQ;IAAE,CAAC,EACtC;MAAEC,IAAI,EAAE;QAAEC,SAAS,EAAE;MAAK;IAAE,CAC9B,CAAC;IACD,MAAMC,uBAAc,CAACC,MAAM,CAAC;MAC1BR,MAAM,EAAED,MAAM,EAAEC,MAAM;MACtBS,MAAM,EAAEV,MAAM,EAAEK,QAAQ;MACxBM,cAAc,EAAEX,MAAM,EAAEW,cAAc;MACtCC,QAAQ,EAAEZ,MAAM,EAAEY,QAAQ;MAC1BC,SAAS,EAAEb,MAAM,EAAEa,SAAS;MAC5BC,KAAK,EAAEd,MAAM,EAAEc,KAAK;MACpBC,SAAS,EAAEf,MAAM,EAAEe,SAAS;MAC5BC,gBAAgB,EAAEhB,MAAM,EAAEgB,gBAAgB,CAACC,GAAG,CAAEC,IAAI,IAAK;QACvD,OAAO;UACLC,MAAM,EAAED,IAAI,EAAEC,MAAM;UACpBC,oBAAoB,EAAEF,IAAI,EAAEE,oBAAoB;UAChDN,KAAK,EAAEI,IAAI,EAAEJ,KAAK;UAClBC,SAAS,EAAEG,IAAI,EAAEH;QACnB,CAAC;MACH,CAAC,CAAC;MACFM,GAAG,EAAErB;IACP,CAAC,CAAC;EACJ,CAAC,MAAM;IACL,MAAMsB,sBAAa,CAACb,MAAM,CAAC;MACzBR,MAAM,EAAED,MAAM,EAAEC,MAAM;MACtBU,cAAc,EAAEX,MAAM,EAAEW,cAAc;MACtCY,SAAS,EAAEvB,MAAM,EAAEuB,SAAS;MAC5BC,YAAY,EAAExB,MAAM,EAAEwB,YAAY;MAClCH,GAAG,EAAErB;IACP,CAAC,CAAC;EACJ;AACF,CAAC;AAACyB,OAAA,CAAA1B,eAAA,GAAAA,eAAA","ignoreList":[]}},"mtime":1727341006723},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/cancel-payments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = require(\"mongoose\");\nvar _cart = _interopRequireDefault(require(\"../db/cart\"));\nvar _paymentSuccess = _interopRequireDefault(require(\"../db/payment-success\"));\nvar _products = _interopRequireDefault(require(\"../db/products\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _RequiredCheck = require(\"../helpers/RequiredCheck\");\nvar _OrderCanceledMail = _interopRequireDefault(require(\"../middlewares/OrderCanceledMail\"));\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nvar CancelPayments = _interopRequireWildcard(require(\"../services/iyzico/methods/cancel_payments\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function (e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst {\n  ObjectId\n} = _mongoose.Types;\nconst reasonEnum = [\"double_payment\", \"buyer_request\", \"fraud\", \"other\"];\nvar _default = router => {\n  router.post(\"/payments/:paymentSuccessId/cancel\", _Session.default, async (req, res, next) => {\n    const {\n      reason,\n      description\n    } = req.body;\n    const paymentSuccessId = req.params.paymentSuccessId;\n    const reasonObj = {};\n\n    // if (!paymentSuccessId) {\n    //   throw new ApiError(\n    //     \"Payment Success id is required\",\n    //     400,\n    //     \"paymentSuccessIdRequired\"\n    //   );\n    // }\n    (0, _RequiredCheck.checkRequiredField)(paymentSuccessId, \"PaymentSuccessId\");\n    if (reason && description) {\n      if (!reasonEnum.includes(reason)) {\n        throw new _ApiError.default(\"Invalid cancel payment reason\", 400, \"invalidCancelPaymentReason\");\n      }\n      reasonObj.reason = reason;\n      reasonObj.description = description;\n    }\n    try {\n      // PaymentSuccess kaydını bul ve cartId ile populate et\n      const payment = await _paymentSuccess.default.findOne({\n        _id: new ObjectId(paymentSuccessId)\n      }).populate(\"cartId\");\n      if (!payment) {\n        throw new _ApiError.default(\"Payment record not found\", 404, \"paymentNotFound\");\n      }\n      const now = new Date();\n      const paymentDate = new Date(payment.createdAt);\n      const timeDifference = now - paymentDate;\n\n      // 24 saat sınırı kontrolü\n      // if (timeDifference > 86400000) {\n      //   throw new ApiError(\n      //     \"This payment can no longer be canceled as the 24-hour window has passed\",\n      //     400,\n      //     \"cancelTimeExceeded\"\n      //   );\n      // }\n\n      // Ödemeyi iptal et\n      const result = await CancelPayments.cancelPayment({\n        locale: req.user.locale,\n        conversationId: (0, _uuid.default)(),\n        paymentId: payment?.paymentId,\n        ip: req.user?.ip,\n        ...reasonObj\n      });\n\n      // Cart tablosundan ürün bilgilerini al\n      const cart = await _cart.default.findOne({\n        _id: payment.cartId\n      });\n      if (!cart) {\n        throw new _ApiError.default(\"Cart not found\", 404, \"cartNotFound\");\n      }\n      const productStockUpdates = {};\n\n      // Sepetteki ürünleri işle ve quantity miktarlarını al\n      for (const cartProduct of cart.products) {\n        const productId = String(cartProduct.productId); // Ürün ID'si\n        console.log(\"Processing Product ID: \", productId);\n        const quantity = cartProduct.quantity; // Sepetteki miktar\n\n        // Eğer quantity tanımlı değilse bu ürünü atla\n        if (!quantity) {\n          console.warn(`Quantity is undefined for productId: ${productId}`);\n          continue;\n        }\n\n        // Ürün ID'sine göre kaç adet olduğunu hesapla\n        if (productStockUpdates[productId]) {\n          productStockUpdates[productId] += quantity;\n        } else {\n          productStockUpdates[productId] = quantity;\n        }\n        await _cart.default.updateOne(\n        //carttaki status değişir\n        {\n          _id: cart._id,\n          \"products.productId\": productId\n        }, {\n          $set: {\n            \"products.$.status\": \"canceled\"\n          }\n        });\n      }\n\n      // Ürün stoklarını güncelle\n      for (const productId in productStockUpdates) {\n        const quantityToIncrease = productStockUpdates[productId];\n\n        // quantityToIncrease undefined ise stok güncellemesini yapma\n        if (typeof quantityToIncrease === \"undefined\") {\n          console.warn(`quantityToIncrease is undefined for productId: ${productId}`);\n          continue;\n        }\n        await _products.default.updateOne({\n          _id: productId\n        }, {\n          $inc: {\n            stock: quantityToIncrease\n          }\n        } // Stok miktarını artır\n        );\n      }\n      res.json(result);\n    } catch (error) {\n      next(error);\n    }\n  }, _OrderCanceledMail.default,\n  // İptal edilen sipariş için e-posta gönder\n  (req, res) => {\n    return res.status(200).json(`Sipariş iptali mail adresine gönderilmiştir.`);\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJyZXF1aXJlIiwiX2NhcnQiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiX3BheW1lbnRTdWNjZXNzIiwiX3Byb2R1Y3RzIiwiX0FwaUVycm9yIiwiX1JlcXVpcmVkQ2hlY2siLCJfT3JkZXJDYW5jZWxlZE1haWwiLCJfU2Vzc2lvbiIsIkNhbmNlbFBheW1lbnRzIiwiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJfdXVpZCIsIl9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSIsImUiLCJXZWFrTWFwIiwiciIsInQiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImhhcyIsImdldCIsIm4iLCJfX3Byb3RvX18iLCJhIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJ1IiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiaSIsInNldCIsIk9iamVjdElkIiwiVHlwZXMiLCJyZWFzb25FbnVtIiwiX2RlZmF1bHQiLCJyb3V0ZXIiLCJwb3N0IiwiU2Vzc2lvbiIsInJlcSIsInJlcyIsIm5leHQiLCJyZWFzb24iLCJkZXNjcmlwdGlvbiIsImJvZHkiLCJwYXltZW50U3VjY2Vzc0lkIiwicGFyYW1zIiwicmVhc29uT2JqIiwiY2hlY2tSZXF1aXJlZEZpZWxkIiwiaW5jbHVkZXMiLCJBcGlFcnJvciIsInBheW1lbnQiLCJQYXltZW50U3VjY2VzcyIsImZpbmRPbmUiLCJfaWQiLCJwb3B1bGF0ZSIsIm5vdyIsIkRhdGUiLCJwYXltZW50RGF0ZSIsImNyZWF0ZWRBdCIsInRpbWVEaWZmZXJlbmNlIiwicmVzdWx0IiwiY2FuY2VsUGF5bWVudCIsImxvY2FsZSIsInVzZXIiLCJjb252ZXJzYXRpb25JZCIsImlkIiwicGF5bWVudElkIiwiaXAiLCJjYXJ0IiwiQ2FydCIsImNhcnRJZCIsInByb2R1Y3RTdG9ja1VwZGF0ZXMiLCJjYXJ0UHJvZHVjdCIsInByb2R1Y3RzIiwicHJvZHVjdElkIiwiU3RyaW5nIiwiY29uc29sZSIsImxvZyIsInF1YW50aXR5Iiwid2FybiIsInVwZGF0ZU9uZSIsIiRzZXQiLCJxdWFudGl0eVRvSW5jcmVhc2UiLCJQcm9kdWN0cyIsIiRpbmMiLCJzdG9jayIsImpzb24iLCJlcnJvciIsInNlbmRDYW5jZWxlZE9yZGVyTWFpbCIsInN0YXR1cyIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9yb3V0ZXMvIiwic291cmNlcyI6WyJjYW5jZWwtcGF5bWVudHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVHlwZXMgfSBmcm9tIFwibW9uZ29vc2VcIjtcbmltcG9ydCBDYXJ0IGZyb20gXCIuLi9kYi9jYXJ0XCI7XG5pbXBvcnQgUGF5bWVudFN1Y2Nlc3MgZnJvbSBcIi4uL2RiL3BheW1lbnQtc3VjY2Vzc1wiO1xuaW1wb3J0IFByb2R1Y3RzIGZyb20gXCIuLi9kYi9wcm9kdWN0c1wiO1xuaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuLi9lcnJvcnMvQXBpRXJyb3JcIjtcbmltcG9ydCB7IGNoZWNrUmVxdWlyZWRGaWVsZCB9IGZyb20gXCIuLi9oZWxwZXJzL1JlcXVpcmVkQ2hlY2tcIjtcbmltcG9ydCBzZW5kQ2FuY2VsZWRPcmRlck1haWwgZnJvbSBcIi4uL21pZGRsZXdhcmVzL09yZGVyQ2FuY2VsZWRNYWlsXCI7XG5pbXBvcnQgU2Vzc2lvbiBmcm9tIFwiLi4vbWlkZGxld2FyZXMvU2Vzc2lvblwiO1xuaW1wb3J0ICogYXMgQ2FuY2VsUGF5bWVudHMgZnJvbSBcIi4uL3NlcnZpY2VzL2l5emljby9tZXRob2RzL2NhbmNlbF9wYXltZW50c1wiO1xuaW1wb3J0IGlkIGZyb20gXCIuLi91dGlscy91dWlkXCI7XG5cbmNvbnN0IHsgT2JqZWN0SWQgfSA9IFR5cGVzO1xuXG5jb25zdCByZWFzb25FbnVtID0gW1wiZG91YmxlX3BheW1lbnRcIiwgXCJidXllcl9yZXF1ZXN0XCIsIFwiZnJhdWRcIiwgXCJvdGhlclwiXTtcblxuZXhwb3J0IGRlZmF1bHQgKHJvdXRlcikgPT4ge1xuICByb3V0ZXIucG9zdChcbiAgICBcIi9wYXltZW50cy86cGF5bWVudFN1Y2Nlc3NJZC9jYW5jZWxcIixcbiAgICBTZXNzaW9uLFxuICAgIGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgICAgY29uc3QgeyByZWFzb24sIGRlc2NyaXB0aW9uIH0gPSByZXEuYm9keTtcbiAgICAgIGNvbnN0IHBheW1lbnRTdWNjZXNzSWQgPSByZXEucGFyYW1zLnBheW1lbnRTdWNjZXNzSWQ7XG4gICAgICBjb25zdCByZWFzb25PYmogPSB7fTtcblxuICAgICAgLy8gaWYgKCFwYXltZW50U3VjY2Vzc0lkKSB7XG4gICAgICAvLyAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgIC8vICAgICBcIlBheW1lbnQgU3VjY2VzcyBpZCBpcyByZXF1aXJlZFwiLFxuICAgICAgLy8gICAgIDQwMCxcbiAgICAgIC8vICAgICBcInBheW1lbnRTdWNjZXNzSWRSZXF1aXJlZFwiXG4gICAgICAvLyAgICk7XG4gICAgICAvLyB9XG4gICAgICBjaGVja1JlcXVpcmVkRmllbGQocGF5bWVudFN1Y2Nlc3NJZCwgXCJQYXltZW50U3VjY2Vzc0lkXCIpO1xuXG4gICAgICBpZiAocmVhc29uICYmIGRlc2NyaXB0aW9uKSB7XG4gICAgICAgIGlmICghcmVhc29uRW51bS5pbmNsdWRlcyhyZWFzb24pKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgICAgXCJJbnZhbGlkIGNhbmNlbCBwYXltZW50IHJlYXNvblwiLFxuICAgICAgICAgICAgNDAwLFxuICAgICAgICAgICAgXCJpbnZhbGlkQ2FuY2VsUGF5bWVudFJlYXNvblwiXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZWFzb25PYmoucmVhc29uID0gcmVhc29uO1xuICAgICAgICByZWFzb25PYmouZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICAgIH1cblxuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gUGF5bWVudFN1Y2Nlc3Mga2F5ZMSxbsSxIGJ1bCB2ZSBjYXJ0SWQgaWxlIHBvcHVsYXRlIGV0XG4gICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCBQYXltZW50U3VjY2Vzcy5maW5kT25lKHtcbiAgICAgICAgICBfaWQ6IG5ldyBPYmplY3RJZChwYXltZW50U3VjY2Vzc0lkKSxcbiAgICAgICAgfSkucG9wdWxhdGUoXCJjYXJ0SWRcIik7XG5cbiAgICAgICAgaWYgKCFwYXltZW50KSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgICAgXCJQYXltZW50IHJlY29yZCBub3QgZm91bmRcIixcbiAgICAgICAgICAgIDQwNCxcbiAgICAgICAgICAgIFwicGF5bWVudE5vdEZvdW5kXCJcbiAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcbiAgICAgICAgY29uc3QgcGF5bWVudERhdGUgPSBuZXcgRGF0ZShwYXltZW50LmNyZWF0ZWRBdCk7XG4gICAgICAgIGNvbnN0IHRpbWVEaWZmZXJlbmNlID0gbm93IC0gcGF5bWVudERhdGU7XG5cbiAgICAgICAgLy8gMjQgc2FhdCBzxLFuxLFyxLEga29udHJvbMO8XG4gICAgICAgIC8vIGlmICh0aW1lRGlmZmVyZW5jZSA+IDg2NDAwMDAwKSB7XG4gICAgICAgIC8vICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAvLyAgICAgXCJUaGlzIHBheW1lbnQgY2FuIG5vIGxvbmdlciBiZSBjYW5jZWxlZCBhcyB0aGUgMjQtaG91ciB3aW5kb3cgaGFzIHBhc3NlZFwiLFxuICAgICAgICAvLyAgICAgNDAwLFxuICAgICAgICAvLyAgICAgXCJjYW5jZWxUaW1lRXhjZWVkZWRcIlxuICAgICAgICAvLyAgICk7XG4gICAgICAgIC8vIH1cblxuICAgICAgICAvLyDDlmRlbWV5aSBpcHRhbCBldFxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBDYW5jZWxQYXltZW50cy5jYW5jZWxQYXltZW50KHtcbiAgICAgICAgICBsb2NhbGU6IHJlcS51c2VyLmxvY2FsZSxcbiAgICAgICAgICBjb252ZXJzYXRpb25JZDogaWQoKSxcbiAgICAgICAgICBwYXltZW50SWQ6IHBheW1lbnQ/LnBheW1lbnRJZCxcbiAgICAgICAgICBpcDogcmVxLnVzZXI/LmlwLFxuICAgICAgICAgIC4uLnJlYXNvbk9iaixcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQ2FydCB0YWJsb3N1bmRhbiDDvHLDvG4gYmlsZ2lsZXJpbmkgYWxcbiAgICAgICAgY29uc3QgY2FydCA9IGF3YWl0IENhcnQuZmluZE9uZSh7IF9pZDogcGF5bWVudC5jYXJ0SWQgfSk7XG4gICAgICAgIGlmICghY2FydCkge1xuICAgICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgbm90IGZvdW5kXCIsIDQwNCwgXCJjYXJ0Tm90Rm91bmRcIik7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBwcm9kdWN0U3RvY2tVcGRhdGVzID0ge307XG5cbiAgICAgICAgLy8gU2VwZXR0ZWtpIMO8csO8bmxlcmkgacWfbGUgdmUgcXVhbnRpdHkgbWlrdGFybGFyxLFuxLEgYWxcbiAgICAgICAgZm9yIChjb25zdCBjYXJ0UHJvZHVjdCBvZiBjYXJ0LnByb2R1Y3RzKSB7XG4gICAgICAgICAgY29uc3QgcHJvZHVjdElkID0gU3RyaW5nKGNhcnRQcm9kdWN0LnByb2R1Y3RJZCk7IC8vIMOccsO8biBJRCdzaVxuICAgICAgICAgIGNvbnNvbGUubG9nKFwiUHJvY2Vzc2luZyBQcm9kdWN0IElEOiBcIiwgcHJvZHVjdElkKTtcbiAgICAgICAgICBjb25zdCBxdWFudGl0eSA9IGNhcnRQcm9kdWN0LnF1YW50aXR5OyAvLyBTZXBldHRla2kgbWlrdGFyXG5cbiAgICAgICAgICAvLyBFxJ9lciBxdWFudGl0eSB0YW7EsW1sxLEgZGXEn2lsc2UgYnUgw7xyw7xuw7wgYXRsYVxuICAgICAgICAgIGlmICghcXVhbnRpdHkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgUXVhbnRpdHkgaXMgdW5kZWZpbmVkIGZvciBwcm9kdWN0SWQ6ICR7cHJvZHVjdElkfWApO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gw5xyw7xuIElEJ3NpbmUgZ8O2cmUga2HDpyBhZGV0IG9sZHXEn3VudSBoZXNhcGxhXG4gICAgICAgICAgaWYgKHByb2R1Y3RTdG9ja1VwZGF0ZXNbcHJvZHVjdElkXSkge1xuICAgICAgICAgICAgcHJvZHVjdFN0b2NrVXBkYXRlc1twcm9kdWN0SWRdICs9IHF1YW50aXR5O1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwcm9kdWN0U3RvY2tVcGRhdGVzW3Byb2R1Y3RJZF0gPSBxdWFudGl0eTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYXdhaXQgQ2FydC51cGRhdGVPbmUoXG4gICAgICAgICAgICAvL2NhcnR0YWtpIHN0YXR1cyBkZcSfacWfaXJcbiAgICAgICAgICAgIHsgX2lkOiBjYXJ0Ll9pZCwgXCJwcm9kdWN0cy5wcm9kdWN0SWRcIjogcHJvZHVjdElkIH0sXG4gICAgICAgICAgICB7ICRzZXQ6IHsgXCJwcm9kdWN0cy4kLnN0YXR1c1wiOiBcImNhbmNlbGVkXCIgfSB9XG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIMOccsO8biBzdG9rbGFyxLFuxLEgZ8O8bmNlbGxlXG4gICAgICAgIGZvciAoY29uc3QgcHJvZHVjdElkIGluIHByb2R1Y3RTdG9ja1VwZGF0ZXMpIHtcbiAgICAgICAgICBjb25zdCBxdWFudGl0eVRvSW5jcmVhc2UgPSBwcm9kdWN0U3RvY2tVcGRhdGVzW3Byb2R1Y3RJZF07XG5cbiAgICAgICAgICAvLyBxdWFudGl0eVRvSW5jcmVhc2UgdW5kZWZpbmVkIGlzZSBzdG9rIGfDvG5jZWxsZW1lc2luaSB5YXBtYVxuICAgICAgICAgIGlmICh0eXBlb2YgcXVhbnRpdHlUb0luY3JlYXNlID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgICAgIGBxdWFudGl0eVRvSW5jcmVhc2UgaXMgdW5kZWZpbmVkIGZvciBwcm9kdWN0SWQ6ICR7cHJvZHVjdElkfWBcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBhd2FpdCBQcm9kdWN0cy51cGRhdGVPbmUoXG4gICAgICAgICAgICB7IF9pZDogcHJvZHVjdElkIH0sXG4gICAgICAgICAgICB7ICRpbmM6IHsgc3RvY2s6IHF1YW50aXR5VG9JbmNyZWFzZSB9IH0gLy8gU3RvayBtaWt0YXLEsW7EsSBhcnTEsXJcbiAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgcmVzLmpzb24ocmVzdWx0KTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIG5leHQoZXJyb3IpO1xuICAgICAgfVxuICAgIH0sXG4gICAgc2VuZENhbmNlbGVkT3JkZXJNYWlsLCAvLyDEsHB0YWwgZWRpbGVuIHNpcGFyacWfIGnDp2luIGUtcG9zdGEgZ8O2bmRlclxuICAgIChyZXEsIHJlcykgPT4ge1xuICAgICAgcmV0dXJuIHJlc1xuICAgICAgICAuc3RhdHVzKDIwMClcbiAgICAgICAgLmpzb24oYFNpcGFyacWfIGlwdGFsaSBtYWlsIGFkcmVzaW5lIGfDtm5kZXJpbG1pxZ90aXIuYCk7XG4gICAgfVxuICApO1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsU0FBQSxHQUFBQyxPQUFBO0FBQ0EsSUFBQUMsS0FBQSxHQUFBQyxzQkFBQSxDQUFBRixPQUFBO0FBQ0EsSUFBQUcsZUFBQSxHQUFBRCxzQkFBQSxDQUFBRixPQUFBO0FBQ0EsSUFBQUksU0FBQSxHQUFBRixzQkFBQSxDQUFBRixPQUFBO0FBQ0EsSUFBQUssU0FBQSxHQUFBSCxzQkFBQSxDQUFBRixPQUFBO0FB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","map":{"version":3,"names":["_mongoose","require","_cart","_interopRequireDefault","_paymentSuccess","_products","_ApiError","_RequiredCheck","_OrderCanceledMail","_Session","CancelPayments","_interopRequireWildcard","_uuid","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","ObjectId","Types","reasonEnum","_default","router","post","Session","req","res","next","reason","description","body","paymentSuccessId","params","reasonObj","checkRequiredField","includes","ApiError","payment","PaymentSuccess","findOne","_id","populate","now","Date","paymentDate","createdAt","timeDifference","result","cancelPayment","locale","user","conversationId","id","paymentId","ip","cart","Cart","cartId","productStockUpdates","cartProduct","products","productId","String","console","log","quantity","warn","updateOne","$set","quantityToIncrease","Products","$inc","stock","json","error","sendCanceledOrderMail","status","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["cancel-payments.js"],"sourcesContent":["import { Types } from \"mongoose\";\nimport Cart from \"../db/cart\";\nimport PaymentSuccess from \"../db/payment-success\";\nimport Products from \"../db/products\";\nimport ApiError from \"../errors/ApiError\";\nimport { checkRequiredField } from \"../helpers/RequiredCheck\";\nimport sendCanceledOrderMail from \"../middlewares/OrderCanceledMail\";\nimport Session from \"../middlewares/Session\";\nimport * as CancelPayments from \"../services/iyzico/methods/cancel_payments\";\nimport id from \"../utils/uuid\";\n\nconst { ObjectId } = Types;\n\nconst reasonEnum = [\"double_payment\", \"buyer_request\", \"fraud\", \"other\"];\n\nexport default (router) => {\n  router.post(\n    \"/payments/:paymentSuccessId/cancel\",\n    Session,\n    async (req, res, next) => {\n      const { reason, description } = req.body;\n      const paymentSuccessId = req.params.paymentSuccessId;\n      const reasonObj = {};\n\n      // if (!paymentSuccessId) {\n      //   throw new ApiError(\n      //     \"Payment Success id is required\",\n      //     400,\n      //     \"paymentSuccessIdRequired\"\n      //   );\n      // }\n      checkRequiredField(paymentSuccessId, \"PaymentSuccessId\");\n\n      if (reason && description) {\n        if (!reasonEnum.includes(reason)) {\n          throw new ApiError(\n            \"Invalid cancel payment reason\",\n            400,\n            \"invalidCancelPaymentReason\"\n          );\n        }\n        reasonObj.reason = reason;\n        reasonObj.description = description;\n      }\n\n      try {\n        // PaymentSuccess kaydını bul ve cartId ile populate et\n        const payment = await PaymentSuccess.findOne({\n          _id: new ObjectId(paymentSuccessId),\n        }).populate(\"cartId\");\n\n        if (!payment) {\n          throw new ApiError(\n            \"Payment record not found\",\n            404,\n            \"paymentNotFound\"\n          );\n        }\n\n        const now = new Date();\n        const paymentDate = new Date(payment.createdAt);\n        const timeDifference = now - paymentDate;\n\n        // 24 saat sınırı kontrolü\n        // if (timeDifference > 86400000) {\n        //   throw new ApiError(\n        //     \"This payment can no longer be canceled as the 24-hour window has passed\",\n        //     400,\n        //     \"cancelTimeExceeded\"\n        //   );\n        // }\n\n        // Ödemeyi iptal et\n        const result = await CancelPayments.cancelPayment({\n          locale: req.user.locale,\n          conversationId: id(),\n          paymentId: payment?.paymentId,\n          ip: req.user?.ip,\n          ...reasonObj,\n        });\n\n        // Cart tablosundan ürün bilgilerini al\n        const cart = await Cart.findOne({ _id: payment.cartId });\n        if (!cart) {\n          throw new ApiError(\"Cart not found\", 404, \"cartNotFound\");\n        }\n\n        const productStockUpdates = {};\n\n        // Sepetteki ürünleri işle ve quantity miktarlarını al\n        for (const cartProduct of cart.products) {\n          const productId = String(cartProduct.productId); // Ürün ID'si\n          console.log(\"Processing Product ID: \", productId);\n          const quantity = cartProduct.quantity; // Sepetteki miktar\n\n          // Eğer quantity tanımlı değilse bu ürünü atla\n          if (!quantity) {\n            console.warn(`Quantity is undefined for productId: ${productId}`);\n            continue;\n          }\n\n          // Ürün ID'sine göre kaç adet olduğunu hesapla\n          if (productStockUpdates[productId]) {\n            productStockUpdates[productId] += quantity;\n          } else {\n            productStockUpdates[productId] = quantity;\n          }\n          await Cart.updateOne(\n            //carttaki status değişir\n            { _id: cart._id, \"products.productId\": productId },\n            { $set: { \"products.$.status\": \"canceled\" } }\n          );\n        }\n\n        // Ürün stoklarını güncelle\n        for (const productId in productStockUpdates) {\n          const quantityToIncrease = productStockUpdates[productId];\n\n          // quantityToIncrease undefined ise stok güncellemesini yapma\n          if (typeof quantityToIncrease === \"undefined\") {\n            console.warn(\n              `quantityToIncrease is undefined for productId: ${productId}`\n            );\n            continue;\n          }\n\n          await Products.updateOne(\n            { _id: productId },\n            { $inc: { stock: quantityToIncrease } } // Stok miktarını artır\n          );\n        }\n\n        res.json(result);\n      } catch (error) {\n        next(error);\n      }\n    },\n    sendCanceledOrderMail, // İptal edilen sipariş için e-posta gönder\n    (req, res) => {\n      return res\n        .status(200)\n        .json(`Sipariş iptali mail adresine gönderilmiştir.`);\n    }\n  );\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1734952190083},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/cancel_payments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.cancelPayment = void 0;\nvar _iyzipay = _interopRequireDefault(require(\"../connection/iyzipay\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst cancelPayment = data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.cancel.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.cancelPayment = cancelPayment;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaXl6aXBheSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiY2FuY2VsUGF5bWVudCIsImRhdGEiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIml5emlwYXkiLCJjYW5jZWwiLCJjcmVhdGUiLCJlcnIiLCJyZXN1bHQiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvc2VydmljZXMvaXl6aWNvL21ldGhvZHMvIiwic291cmNlcyI6WyJjYW5jZWxfcGF5bWVudHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGl5emlwYXkgZnJvbSBcIi4uL2Nvbm5lY3Rpb24vaXl6aXBheVwiO1xuXG5leHBvcnQgY29uc3QgY2FuY2VsUGF5bWVudCA9IChkYXRhKSA9PiB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgaXl6aXBheS5jYW5jZWwuY3JlYXRlKGRhdGEsIChlcnIsIHJlc3VsdCkgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxRQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFBNEMsU0FBQUQsdUJBQUFFLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFckMsTUFBTUcsYUFBYSxHQUFJQyxJQUFJLElBQUs7RUFDckMsT0FBTyxJQUFJQyxPQUFPLENBQUMsQ0FBQ0MsT0FBTyxFQUFFQyxNQUFNLEtBQUs7SUFDdENDLGdCQUFPLENBQUNDLE1BQU0sQ0FBQ0MsTUFBTSxDQUFDTixJQUFJLEVBQUUsQ0FBQ08sR0FBRyxFQUFFQyxNQUFNLEtBQUs7TUFDM0MsSUFBSUQsR0FBRyxFQUFFO1FBQ1BKLE1BQU0sQ0FBQ0ksR0FBRyxDQUFDO01BQ2IsQ0FBQyxNQUFNO1FBQ0xMLE9BQU8sQ0FBQ00sTUFBTSxDQUFDO01BQ2pCO0lBQ0YsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUFDQyxPQUFBLENBQUFWLGFBQUEsR0FBQUEsYUFBQSIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_iyzipay","_interopRequireDefault","require","e","__esModule","default","cancelPayment","data","Promise","resolve","reject","iyzipay","cancel","create","err","result","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/","sources":["cancel_payments.js"],"sourcesContent":["import iyzipay from \"../connection/iyzipay\";\n\nexport const cancelPayment = (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.cancel.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA4C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAErC,MAAMG,aAAa,GAAIC,IAAI,IAAK;EACrC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,MAAM,CAACC,MAAM,CAACN,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MAC3C,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAV,aAAA,GAAAA,aAAA","ignoreList":[]}},"mtime":1723543937119},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/cards.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar Cards = _interopRequireWildcard(require(\"../services/iyzico/methods/cards\"));\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function (e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\n//varolan kullanıcıya kart ekleme methodu (yeni kart ekliyor o yüzden var olan db verisinin içerisine yeni satır ile cardUserKey eklendi)\nvar _default = router => {\n  //session koyma sebebi kullanıcı login olduğu zaman bu sayfaya erişeceği için\n  router.post(\"/cards\", _Session.default, async (req, res) => {\n    const {\n      card\n    } = req.body;\n    let result = await Cards.createUserCard({\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      email: req.user.email,\n      externalId: (0, _uuid.default)(),\n      ...(req.user?.cardUserKey && {\n        cardUserKey: req.user.cardUserKey\n      }),\n      card: card\n    });\n    if (!req.user.cardUserKey) {\n      if (result?.status === \"success\" && result?.cardUserKey) {\n        const user = await _users.default.findOne({\n          _id: req.user?._id\n        });\n        user.cardUserKey = result?.cardUserKey;\n        await user.save();\n      }\n    }\n    res.json(result);\n  });\n\n  //kullanıcıya ait olan kartları okuma\n  router.get(\"/cards\", _Session.default, async (req, res) => {\n    if (!req.user?.cardUserKey) {\n      throw new _ApiError.default(\"User has no credit card\", 403, \"userHasNoCard\");\n    }\n    let cards = await Cards.getUserCards({\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      cardUserKey: req.user?.cardUserKey\n    });\n    res.status(200).json(cards);\n  });\n\n  //kullanıcıya tanımlı olan kartı silmek\n  router.delete(\"/cards/delete-by-token\", _Session.default, async (req, res) => {\n    const {\n      cardToken\n    } = req.body;\n    if (!cardToken) {\n      throw new _ApiError.default(\"Card token is required\", 400, \"cardTokenRequired\");\n    }\n    let deleteResult = await Cards.deleteUserCard({\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      cardUserKey: req.user?.cardUserKey,\n      cardToken: cardToken\n    });\n    res.status(200).json(deleteResult);\n  });\n\n  //kart silme index\n  router.delete(\"/cards/:cardIndex/delete-by-index\", _Session.default, async (req, res) => {\n    if (!req.params?.cardIndex) {\n      throw new _ApiError.default(\"Card Index is required\", 400, \"cardIndexRequired\");\n    }\n    let cards = await Cards.getUserCards({\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      cardUserKey: req.user?.cardUserKey\n    });\n    const index = parseInt(req.params?.cardIndex); //urldeki cardIndex kısmındaki sayıyı int olarak alır(defaultu string normalde)\n    if (index >= cards?.cardDetails.length) {\n      throw new _ApiError.default(\"Card Does not exists\", 400, \"cardIndexInvalid\");\n    }\n    const {\n      cardToken\n    } = cards?.cardDetails[index];\n    let deleteResult = await Cards.deleteUserCard({\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      cardUserKey: req.user?.cardUserKey,\n      cardToken: cardToken\n    });\n    res.json(deleteResult);\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQXBpRXJyb3IiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIkNhcmRzIiwiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJfdXNlcnMiLCJfdXVpZCIsIl9TZXNzaW9uIiwiX2dldFJlcXVpcmVXaWxkY2FyZENhY2hlIiwiZSIsIldlYWtNYXAiLCJyIiwidCIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiaGFzIiwiZ2V0IiwibiIsIl9fcHJvdG9fXyIsImEiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsInUiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJpIiwic2V0IiwiX2RlZmF1bHQiLCJyb3V0ZXIiLCJwb3N0IiwiU2Vzc2lvbiIsInJlcSIsInJlcyIsImNhcmQiLCJib2R5IiwicmVzdWx0IiwiY3JlYXRlVXNlckNhcmQiLCJsb2NhbGUiLCJ1c2VyIiwiY29udmVyc2F0aW9uSWQiLCJpZCIsImVtYWlsIiwiZXh0ZXJuYWxJZCIsImNhcmRVc2VyS2V5Iiwic3RhdHVzIiwiVXNlcnMiLCJmaW5kT25lIiwiX2lkIiwic2F2ZSIsImpzb24iLCJBcGlFcnJvciIsImNhcmRzIiwiZ2V0VXNlckNhcmRzIiwiZGVsZXRlIiwiY2FyZFRva2VuIiwiZGVsZXRlUmVzdWx0IiwiZGVsZXRlVXNlckNhcmQiLCJwYXJhbXMiLCJjYXJkSW5kZXgiLCJpbmRleCIsInBhcnNlSW50IiwiY2FyZERldGFpbHMiLCJsZW5ndGgiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvcm91dGVzLyIsInNvdXJjZXMiOlsiY2FyZHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuLi9lcnJvcnMvQXBpRXJyb3JcIjtcbmltcG9ydCAqIGFzIENhcmRzIGZyb20gXCIuLi9zZXJ2aWNlcy9peXppY28vbWV0aG9kcy9jYXJkc1wiO1xuaW1wb3J0IFVzZXJzIGZyb20gXCIuLi9kYi91c2Vyc1wiO1xuaW1wb3J0IGlkIGZyb20gXCIuLi91dGlscy91dWlkXCI7XG5pbXBvcnQgU2Vzc2lvbiBmcm9tIFwiLi4vbWlkZGxld2FyZXMvU2Vzc2lvblwiO1xuXG4vL3Zhcm9sYW4ga3VsbGFuxLFjxLF5YSBrYXJ0IGVrbGVtZSBtZXRob2R1ICh5ZW5pIGthcnQgZWtsaXlvciBvIHnDvHpkZW4gdmFyIG9sYW4gZGIgdmVyaXNpbmluIGnDp2VyaXNpbmUgeWVuaSBzYXTEsXIgaWxlIGNhcmRVc2VyS2V5IGVrbGVuZGkpXG5leHBvcnQgZGVmYXVsdCAocm91dGVyKSA9PiB7XG4gIC8vc2Vzc2lvbiBrb3ltYSBzZWJlYmkga3VsbGFuxLFjxLEgbG9naW4gb2xkdcSfdSB6YW1hbiBidSBzYXlmYXlhIGVyacWfZWNlxJ9pIGnDp2luXG4gIHJvdXRlci5wb3N0KFwiL2NhcmRzXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGNvbnN0IHsgY2FyZCB9ID0gcmVxLmJvZHk7XG4gICAgbGV0IHJlc3VsdCA9IGF3YWl0IENhcmRzLmNyZWF0ZVVzZXJDYXJkKHtcbiAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICBlbWFpbDogcmVxLnVzZXIuZW1haWwsXG4gICAgICBleHRlcm5hbElkOiBpZCgpLFxuICAgICAgLi4uKHJlcS51c2VyPy5jYXJkVXNlcktleSAmJiB7XG4gICAgICAgIGNhcmRVc2VyS2V5OiByZXEudXNlci5jYXJkVXNlcktleSxcbiAgICAgIH0pLFxuICAgICAgY2FyZDogY2FyZCxcbiAgICB9KTtcbiAgICBpZiAoIXJlcS51c2VyLmNhcmRVc2VyS2V5KSB7XG4gICAgICBpZiAocmVzdWx0Py5zdGF0dXMgPT09IFwic3VjY2Vzc1wiICYmIHJlc3VsdD8uY2FyZFVzZXJLZXkpIHtcbiAgICAgICAgY29uc3QgdXNlciA9IGF3YWl0IFVzZXJzLmZpbmRPbmUoe1xuICAgICAgICAgIF9pZDogcmVxLnVzZXI/Ll9pZCxcbiAgICAgICAgfSk7XG4gICAgICAgIHVzZXIuY2FyZFVzZXJLZXkgPSByZXN1bHQ/LmNhcmRVc2VyS2V5O1xuICAgICAgICBhd2FpdCB1c2VyLnNhdmUoKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmVzLmpzb24ocmVzdWx0KTtcbiAgfSk7XG5cbiAgLy9rdWxsYW7EsWPEsXlhIGFpdCBvbGFuIGthcnRsYXLEsSBva3VtYVxuICByb3V0ZXIuZ2V0KFwiL2NhcmRzXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGlmICghcmVxLnVzZXI/LmNhcmRVc2VyS2V5KSB7XG4gICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJVc2VyIGhhcyBubyBjcmVkaXQgY2FyZFwiLCA0MDMsIFwidXNlckhhc05vQ2FyZFwiKTtcbiAgICB9XG4gICAgbGV0IGNhcmRzID0gYXdhaXQgQ2FyZHMuZ2V0VXNlckNhcmRzKHtcbiAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICBjYXJkVXNlcktleTogcmVxLnVzZXI/LmNhcmRVc2VyS2V5LFxuICAgIH0pO1xuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKGNhcmRzKTtcbiAgfSk7XG5cbiAgLy9rdWxsYW7EsWPEsXlhIHRhbsSxbWzEsSBvbGFuIGthcnTEsSBzaWxtZWtcbiAgcm91dGVyLmRlbGV0ZShcIi9jYXJkcy9kZWxldGUtYnktdG9rZW5cIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyBjYXJkVG9rZW4gfSA9IHJlcS5ib2R5O1xuICAgIGlmICghY2FyZFRva2VuKSB7XG4gICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIHRva2VuIGlzIHJlcXVpcmVkXCIsIDQwMCwgXCJjYXJkVG9rZW5SZXF1aXJlZFwiKTtcbiAgICB9XG4gICAgbGV0IGRlbGV0ZVJlc3VsdCA9IGF3YWl0IENhcmRzLmRlbGV0ZVVzZXJDYXJkKHtcbiAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICBjYXJkVXNlcktleTogcmVxLnVzZXI/LmNhcmRVc2VyS2V5LFxuICAgICAgY2FyZFRva2VuOiBjYXJkVG9rZW4sXG4gICAgfSk7XG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oZGVsZXRlUmVzdWx0KTtcbiAgfSk7XG5cbiAgLy9rYXJ0IHNpbG1lIGluZGV4XG4gIHJvdXRlci5kZWxldGUoXG4gICAgXCIvY2FyZHMvOmNhcmRJbmRleC9kZWxldGUtYnktaW5kZXhcIixcbiAgICBTZXNzaW9uLFxuICAgIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgICAgaWYgKCFyZXEucGFyYW1zPy5jYXJkSW5kZXgpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FyZCBJbmRleCBpcyByZXF1aXJlZFwiLCA0MDAsIFwiY2FyZEluZGV4UmVxdWlyZWRcIik7XG4gICAgICB9XG4gICAgICBsZXQgY2FyZHMgPSBhd2FpdCBDYXJkcy5nZXRVc2VyQ2FyZHMoe1xuICAgICAgICBsb2NhbGU6IHJlcS51c2VyLmxvY2FsZSxcbiAgICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICAgIGNhcmRVc2VyS2V5OiByZXEudXNlcj8uY2FyZFVzZXJLZXksXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IGluZGV4ID0gcGFyc2VJbnQocmVxLnBhcmFtcz8uY2FyZEluZGV4KTsgLy91cmxkZWtpIGNhcmRJbmRleCBrxLFzbcSxbmRha2kgc2F5xLF5xLEgaW50IG9sYXJhayBhbMSxcihkZWZhdWx0dSBzdHJpbmcgbm9ybWFsZGUpXG4gICAgICBpZiAoaW5kZXggPj0gY2FyZHM/LmNhcmREZXRhaWxzLmxlbmd0aCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJkIERvZXMgbm90IGV4aXN0c1wiLCA0MDAsIFwiY2FyZEluZGV4SW52YWxpZFwiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgY2FyZFRva2VuIH0gPSBjYXJkcz8uY2FyZERldGFpbHNbaW5kZXhdO1xuICAgICAgbGV0IGRlbGV0ZVJlc3VsdCA9IGF3YWl0IENhcmRzLmRlbGV0ZVVzZXJDYXJkKHtcbiAgICAgICAgbG9jYWxlOiByZXEudXNlci5sb2NhbGUsXG4gICAgICAgIGNvbnZlcnNhdGlvbklkOiBpZCgpLFxuICAgICAgICBjYXJkVXNlcktleTogcmVxLnVzZXI/LmNhcmRVc2VyS2V5LFxuICAgICAgICBjYXJkVG9rZW46IGNhcmRUb2tlbixcbiAgICAgIH0pO1xuXG4gICAgICByZXMuanNvbihkZWxldGVSZXN1bHQpO1xuICAgIH1cbiAgKTtcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLEtBQUEsR0FBQUMsdUJBQUEsQ0FBQUYsT0FBQTtBQUNBLElBQUFHLE1BQUEsR0FBQUosc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFJLEtBQUEsR0FBQUwsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFLLFFBQUEsR0FBQU4sc0JBQUEsQ0FBQUMsT0FBQTtBQUE2QyxTQUFBTSx5QkFBQUMsQ0FBQSw2QkFBQUMsT0FBQSxtQkFBQUMsQ0FBQSxPQUFBRCxPQUFBLElBQUFFLENBQUEsT0FBQUYsT0FBQSxZQUFBRix3QkFBQSxZQUFBQSxDQUFBQyxDQUFBLFdBQUFBLENBQUEsR0FBQUcsQ0FBQSxHQUFBRCxDQUFBLEtBQUFGLENBQUE7QUFBQSxTQUFBTCx3QkFBQUssQ0FBQSxFQUFBRSxDQUFBLFNBQUFBLENBQUEsSUFBQUYsQ0FBQSxJQUFBQSxDQUFBLENBQUFJLFVBQUEsU0FBQUosQ0FBQSxlQUFBQSxDQUFBLHVCQUFBQSxDQUFBLHlCQUFBQSxDQUFBLFdBQUFLLE9BQUEsRUFBQUwsQ0FBQSxRQUFBRyxDQUFBLEdBQUFKLHdCQUFBLENB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","map":{"version":3,"names":["_ApiError","_interopRequireDefault","require","Cards","_interopRequireWildcard","_users","_uuid","_Session","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","_default","router","post","Session","req","res","card","body","result","createUserCard","locale","user","conversationId","id","email","externalId","cardUserKey","status","Users","findOne","_id","save","json","ApiError","cards","getUserCards","delete","cardToken","deleteResult","deleteUserCard","params","cardIndex","index","parseInt","cardDetails","length","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["cards.js"],"sourcesContent":["import ApiError from \"../errors/ApiError\";\nimport * as Cards from \"../services/iyzico/methods/cards\";\nimport Users from \"../db/users\";\nimport id from \"../utils/uuid\";\nimport Session from \"../middlewares/Session\";\n\n//varolan kullanıcıya kart ekleme methodu (yeni kart ekliyor o yüzden var olan db verisinin içerisine yeni satır ile cardUserKey eklendi)\nexport default (router) => {\n  //session koyma sebebi kullanıcı login olduğu zaman bu sayfaya erişeceği için\n  router.post(\"/cards\", Session, async (req, res) => {\n    const { card } = req.body;\n    let result = await Cards.createUserCard({\n      locale: req.user.locale,\n      conversationId: id(),\n      email: req.user.email,\n      externalId: id(),\n      ...(req.user?.cardUserKey && {\n        cardUserKey: req.user.cardUserKey,\n      }),\n      card: card,\n    });\n    if (!req.user.cardUserKey) {\n      if (result?.status === \"success\" && result?.cardUserKey) {\n        const user = await Users.findOne({\n          _id: req.user?._id,\n        });\n        user.cardUserKey = result?.cardUserKey;\n        await user.save();\n      }\n    }\n    res.json(result);\n  });\n\n  //kullanıcıya ait olan kartları okuma\n  router.get(\"/cards\", Session, async (req, res) => {\n    if (!req.user?.cardUserKey) {\n      throw new ApiError(\"User has no credit card\", 403, \"userHasNoCard\");\n    }\n    let cards = await Cards.getUserCards({\n      locale: req.user.locale,\n      conversationId: id(),\n      cardUserKey: req.user?.cardUserKey,\n    });\n    res.status(200).json(cards);\n  });\n\n  //kullanıcıya tanımlı olan kartı silmek\n  router.delete(\"/cards/delete-by-token\", Session, async (req, res) => {\n    const { cardToken } = req.body;\n    if (!cardToken) {\n      throw new ApiError(\"Card token is required\", 400, \"cardTokenRequired\");\n    }\n    let deleteResult = await Cards.deleteUserCard({\n      locale: req.user.locale,\n      conversationId: id(),\n      cardUserKey: req.user?.cardUserKey,\n      cardToken: cardToken,\n    });\n    res.status(200).json(deleteResult);\n  });\n\n  //kart silme index\n  router.delete(\n    \"/cards/:cardIndex/delete-by-index\",\n    Session,\n    async (req, res) => {\n      if (!req.params?.cardIndex) {\n        throw new ApiError(\"Card Index is required\", 400, \"cardIndexRequired\");\n      }\n      let cards = await Cards.getUserCards({\n        locale: req.user.locale,\n        conversationId: id(),\n        cardUserKey: req.user?.cardUserKey,\n      });\n      const index = parseInt(req.params?.cardIndex); //urldeki cardIndex kısmındaki sayıyı int olarak alır(defaultu string normalde)\n      if (index >= cards?.cardDetails.length) {\n        throw new ApiError(\"Card Does not exists\", 400, \"cardIndexInvalid\");\n      }\n      const { cardToken } = cards?.cardDetails[index];\n      let deleteResult = await Cards.deleteUserCard({\n        locale: req.user.locale,\n        conversationId: id(),\n        cardUserKey: req.user?.cardUserKey,\n        cardToken: cardToken,\n      });\n\n      res.json(deleteResult);\n    }\n  );\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1724662769652},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/cancel-payments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = require(\"mongoose\");\nvar _cart = _interopRequireDefault(require(\"../db/cart\"));\nvar _paymentSuccess = _interopRequireDefault(require(\"../db/payment-success\"));\nvar _products = _interopRequireDefault(require(\"../db/products\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _RequiredCheck = require(\"../helpers/RequiredCheck\");\nvar _OrderCanceledMail = _interopRequireDefault(require(\"../middlewares/OrderCanceledMail\"));\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nvar CancelPayments = _interopRequireWildcard(require(\"../services/iyzico/methods/cancel_payments\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function (e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst {\n  ObjectId\n} = _mongoose.Types;\nconst reasonEnum = [\"double_payment\", \"buyer_request\", \"fraud\", \"other\"];\nvar _default = router => {\n  router.post(\"/payments/:paymentSuccessId/cancel\", _Session.default, async (req, res, next) => {\n    const {\n      reason,\n      description\n    } = req.body;\n    const paymentSuccessId = req.params.paymentSuccessId;\n    const reasonObj = {};\n\n    // if (!paymentSuccessId) {\n    //   throw new ApiError(\n    //     \"Payment Success id is required\",\n    //     400,\n    //     \"paymentSuccessIdRequired\"\n    //   );\n    // }\n    (0, _RequiredCheck.checkRequiredField)(paymentSuccessId, \"PaymentSuccessId\");\n    if (reason && description) {\n      if (!reasonEnum.includes(reason)) {\n        throw new _ApiError.default(\"Invalid cancel payment reason\", 400, \"invalidCancelPaymentReason\");\n      }\n      reasonObj.reason = reason;\n      reasonObj.description = description;\n    }\n    try {\n      // PaymentSuccess kaydını bul ve cartId ile populate et\n      const payment = await _paymentSuccess.default.findOne({\n        _id: new ObjectId(paymentSuccessId)\n      }).populate(\"cartId\");\n      if (!payment) {\n        throw new _ApiError.default(\"Payment record not found\", 404, \"paymentNotFound\");\n      }\n      const now = new Date();\n      const paymentDate = new Date(payment.createdAt);\n      const timeDifference = now - paymentDate;\n\n      // 24 saat sınırı kontrolü\n      // if (timeDifference > 86400000) {\n      //   throw new ApiError(\n      //     \"This payment can no longer be canceled as the 24-hour window has passed\",\n      //     400,\n      //     \"cancelTimeExceeded\"\n      //   );\n      // }\n\n      // Ödemeyi iptal et\n      const result = await CancelPayments.cancelPayment({\n        locale: req.user.locale,\n        conversationId: (0, _uuid.default)(),\n        paymentId: payment?.paymentId,\n        ip: req.user?.ip,\n        ...reasonObj\n      });\n\n      // Cart tablosundan ürün bilgilerini al\n      const cart = await _cart.default.findOne({\n        _id: payment.cartId\n      });\n      if (!cart) {\n        throw new _ApiError.default(\"Cart not found\", 404, \"cartNotFound\");\n      }\n      const productStockUpdates = {};\n\n      // Sepetteki ürünleri işle ve quantity miktarlarını al\n      for (const cartProduct of cart.products) {\n        const productId = String(cartProduct.productId); // Ürün ID'si\n        console.log(\"Processing Product ID: \", productId);\n        const quantity = cartProduct.quantity; // Sepetteki miktar\n\n        // Eğer quantity tanımlı değilse bu ürünü atla\n        if (!quantity) {\n          console.warn(`Quantity is undefined for productId: ${productId}`);\n          continue;\n        }\n\n        // Ürün ID'sine göre kaç adet olduğunu hesapla\n        if (productStockUpdates[productId]) {\n          productStockUpdates[productId] += quantity;\n        } else {\n          productStockUpdates[productId] = quantity;\n        }\n        await _cart.default.updateOne(\n        //carttaki status değişir\n        {\n          _id: cart._id,\n          \"products.productId\": productId\n        }, {\n          $set: {\n            \"products.$.status\": \"canceled\"\n          }\n        });\n      }\n\n      // Ürün stoklarını güncelle\n      for (const productId in productStockUpdates) {\n        const quantityToIncrease = productStockUpdates[productId];\n\n        // quantityToIncrease undefined ise stok güncellemesini yapma\n        if (typeof quantityToIncrease === \"undefined\") {\n          console.warn(`quantityToIncrease is undefined for productId: ${productId}`);\n          continue;\n        }\n        await _products.default.updateOne({\n          _id: productId\n        }, {\n          $inc: {\n            stock: quantityToIncrease\n          }\n        } // Stok miktarını artır\n        );\n      }\n      res.json(result);\n    } catch (error) {\n      next(error);\n    }\n  }, _OrderCanceledMail.default,\n  // İptal edilen sipariş için e-posta gönder\n  (req, res) => {\n    return res.status(200).json(`Sipariş iptali mail adresine gönderilmiştir.`);\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJyZXF1aXJlIiwiX2NhcnQiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiX3BheW1lbnRTdWNjZXNzIiwiX3Byb2R1Y3RzIiwiX0FwaUVycm9yIiwiX1JlcXVpcmVkQ2hlY2siLCJfT3JkZXJDYW5jZWxlZE1haWwiLCJfU2Vzc2lvbiIsIkNhbmNlbFBheW1lbnRzIiwiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJfdXVpZCIsIl9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSIsImUiLCJXZWFrTWFwIiwiciIsInQiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImhhcyIsImdldCIsIm4iLCJfX3Byb3RvX18iLCJhIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJ1IiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiaSIsInNldCIsIk9iamVjdElkIiwiVHlwZXMiLCJyZWFzb25FbnVtIiwiX2RlZmF1bHQiLCJyb3V0ZXIiLCJwb3N0IiwiU2Vzc2lvbiIsInJlcSIsInJlcyIsIm5leHQiLCJyZWFzb24iLCJkZXNjcmlwdGlvbiIsImJvZHkiLCJwYXltZW50U3VjY2Vzc0lkIiwicGFyYW1zIiwicmVhc29uT2JqIiwiY2hlY2tSZXF1aXJlZEZpZWxkIiwiaW5jbHVkZXMiLCJBcGlFcnJvciIsInBheW1lbnQiLCJQYXltZW50U3VjY2VzcyIsImZpbmRPbmUiLCJfaWQiLCJwb3B1bGF0ZSIsIm5vdyIsIkRhdGUiLCJwYXltZW50RGF0ZSIsImNyZWF0ZWRBdCIsInRpbWVEaWZmZXJlbmNlIiwicmVzdWx0IiwiY2FuY2VsUGF5bWVudCIsImxvY2FsZSIsInVzZXIiLCJjb252ZXJzYXRpb25JZCIsImlkIiwicGF5bWVudElkIiwiaXAiLCJjYXJ0IiwiQ2FydCIsImNhcnRJZCIsInByb2R1Y3RTdG9ja1VwZGF0ZXMiLCJjYXJ0UHJvZHVjdCIsInByb2R1Y3RzIiwicHJvZHVjdElkIiwiU3RyaW5nIiwiY29uc29sZSIsImxvZyIsInF1YW50aXR5Iiwid2FybiIsInVwZGF0ZU9uZSIsIiRzZXQiLCJxdWFudGl0eVRvSW5jcmVhc2UiLCJQcm9kdWN0cyIsIiRpbmMiLCJzdG9jayIsImpzb24iLCJlcnJvciIsInNlbmRDYW5jZWxlZE9yZGVyTWFpbCIsInN0YXR1cyIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9yb3V0ZXMvIiwic291cmNlcyI6WyJjYW5jZWwtcGF5bWVudHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVHlwZXMgfSBmcm9tIFwibW9uZ29vc2VcIjtcbmltcG9ydCBDYXJ0IGZyb20gXCIuLi9kYi9jYXJ0XCI7XG5pbXBvcnQgUGF5bWVudFN1Y2Nlc3MgZnJvbSBcIi4uL2RiL3BheW1lbnQtc3VjY2Vzc1wiO1xuaW1wb3J0IFByb2R1Y3RzIGZyb20gXCIuLi9kYi9wcm9kdWN0c1wiO1xuaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuLi9lcnJvcnMvQXBpRXJyb3JcIjtcbmltcG9ydCB7IGNoZWNrUmVxdWlyZWRGaWVsZCB9IGZyb20gXCIuLi9oZWxwZXJzL1JlcXVpcmVkQ2hlY2tcIjtcbmltcG9ydCBzZW5kQ2FuY2VsZWRPcmRlck1haWwgZnJvbSBcIi4uL21pZGRsZXdhcmVzL09yZGVyQ2FuY2VsZWRNYWlsXCI7XG5pbXBvcnQgU2Vzc2lvbiBmcm9tIFwiLi4vbWlkZGxld2FyZXMvU2Vzc2lvblwiO1xuaW1wb3J0ICogYXMgQ2FuY2VsUGF5bWVudHMgZnJvbSBcIi4uL3NlcnZpY2VzL2l5emljby9tZXRob2RzL2NhbmNlbF9wYXltZW50c1wiO1xuaW1wb3J0IGlkIGZyb20gXCIuLi91dGlscy91dWlkXCI7XG5cbmNvbnN0IHsgT2JqZWN0SWQgfSA9IFR5cGVzO1xuXG5jb25zdCByZWFzb25FbnVtID0gW1wiZG91YmxlX3BheW1lbnRcIiwgXCJidXllcl9yZXF1ZXN0XCIsIFwiZnJhdWRcIiwgXCJvdGhlclwiXTtcblxuZXhwb3J0IGRlZmF1bHQgKHJvdXRlcikgPT4ge1xuICByb3V0ZXIucG9zdChcbiAgICBcIi9wYXltZW50cy86cGF5bWVudFN1Y2Nlc3NJZC9jYW5jZWxcIixcbiAgICBTZXNzaW9uLFxuICAgIGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgICAgY29uc3QgeyByZWFzb24sIGRlc2NyaXB0aW9uIH0gPSByZXEuYm9keTtcbiAgICAgIGNvbnN0IHBheW1lbnRTdWNjZXNzSWQgPSByZXEucGFyYW1zLnBheW1lbnRTdWNjZXNzSWQ7XG4gICAgICBjb25zdCByZWFzb25PYmogPSB7fTtcblxuICAgICAgLy8gaWYgKCFwYXltZW50U3VjY2Vzc0lkKSB7XG4gICAgICAvLyAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgIC8vICAgICBcIlBheW1lbnQgU3VjY2VzcyBpZCBpcyByZXF1aXJlZFwiLFxuICAgICAgLy8gICAgIDQwMCxcbiAgICAgIC8vICAgICBcInBheW1lbnRTdWNjZXNzSWRSZXF1aXJlZFwiXG4gICAgICAvLyAgICk7XG4gICAgICAvLyB9XG4gICAgICBjaGVja1JlcXVpcmVkRmllbGQocGF5bWVudFN1Y2Nlc3NJZCwgXCJQYXltZW50U3VjY2Vzc0lkXCIpO1xuXG4gICAgICBpZiAocmVhc29uICYmIGRlc2NyaXB0aW9uKSB7XG4gICAgICAgIGlmICghcmVhc29uRW51bS5pbmNsdWRlcyhyZWFzb24pKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgICAgXCJJbnZhbGlkIGNhbmNlbCBwYXltZW50IHJlYXNvblwiLFxuICAgICAgICAgICAgNDAwLFxuICAgICAgICAgICAgXCJpbnZhbGlkQ2FuY2VsUGF5bWVudFJlYXNvblwiXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZWFzb25PYmoucmVhc29uID0gcmVhc29uO1xuICAgICAgICByZWFzb25PYmouZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICAgIH1cblxuICAgICAgdHJ5IHtcbiAgICAgICAgLy8gUGF5bWVudFN1Y2Nlc3Mga2F5ZMSxbsSxIGJ1bCB2ZSBjYXJ0SWQgaWxlIHBvcHVsYXRlIGV0XG4gICAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCBQYXltZW50U3VjY2Vzcy5maW5kT25lKHtcbiAgICAgICAgICBfaWQ6IG5ldyBPYmplY3RJZChwYXltZW50U3VjY2Vzc0lkKSxcbiAgICAgICAgfSkucG9wdWxhdGUoXCJjYXJ0SWRcIik7XG5cbiAgICAgICAgaWYgKCFwYXltZW50KSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgICAgXCJQYXltZW50IHJlY29yZCBub3QgZm91bmRcIixcbiAgICAgICAgICAgIDQwNCxcbiAgICAgICAgICAgIFwicGF5bWVudE5vdEZvdW5kXCJcbiAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3Qgbm93ID0gbmV3IERhdGUoKTtcbiAgICAgICAgY29uc3QgcGF5bWVudERhdGUgPSBuZXcgRGF0ZShwYXltZW50LmNyZWF0ZWRBdCk7XG4gICAgICAgIGNvbnN0IHRpbWVEaWZmZXJlbmNlID0gbm93IC0gcGF5bWVudERhdGU7XG5cbiAgICAgICAgLy8gMjQgc2FhdCBzxLFuxLFyxLEga29udHJvbMO8XG4gICAgICAgIC8vIGlmICh0aW1lRGlmZmVyZW5jZSA+IDg2NDAwMDAwKSB7XG4gICAgICAgIC8vICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAvLyAgICAgXCJUaGlzIHBheW1lbnQgY2FuIG5vIGxvbmdlciBiZSBjYW5jZWxlZCBhcyB0aGUgMjQtaG91ciB3aW5kb3cgaGFzIHBhc3NlZFwiLFxuICAgICAgICAvLyAgICAgNDAwLFxuICAgICAgICAvLyAgICAgXCJjYW5jZWxUaW1lRXhjZWVkZWRcIlxuICAgICAgICAvLyAgICk7XG4gICAgICAgIC8vIH1cblxuICAgICAgICAvLyDDlmRlbWV5aSBpcHRhbCBldFxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBDYW5jZWxQYXltZW50cy5jYW5jZWxQYXltZW50KHtcbiAgICAgICAgICBsb2NhbGU6IHJlcS51c2VyLmxvY2FsZSxcbiAgICAgICAgICBjb252ZXJzYXRpb25JZDogaWQoKSxcbiAgICAgICAgICBwYXltZW50SWQ6IHBheW1lbnQ/LnBheW1lbnRJZCxcbiAgICAgICAgICBpcDogcmVxLnVzZXI/LmlwLFxuICAgICAgICAgIC4uLnJlYXNvbk9iaixcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQ2FydCB0YWJsb3N1bmRhbiDDvHLDvG4gYmlsZ2lsZXJpbmkgYWxcbiAgICAgICAgY29uc3QgY2FydCA9IGF3YWl0IENhcnQuZmluZE9uZSh7IF9pZDogcGF5bWVudC5jYXJ0SWQgfSk7XG4gICAgICAgIGlmICghY2FydCkge1xuICAgICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgbm90IGZvdW5kXCIsIDQwNCwgXCJjYXJ0Tm90Rm91bmRcIik7XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBwcm9kdWN0U3RvY2tVcGRhdGVzID0ge307XG5cbiAgICAgICAgLy8gU2VwZXR0ZWtpIMO8csO8bmxlcmkgacWfbGUgdmUgcXVhbnRpdHkgbWlrdGFybGFyxLFuxLEgYWxcbiAgICAgICAgZm9yIChjb25zdCBjYXJ0UHJvZHVjdCBvZiBjYXJ0LnByb2R1Y3RzKSB7XG4gICAgICAgICAgY29uc3QgcHJvZHVjdElkID0gU3RyaW5nKGNhcnRQcm9kdWN0LnByb2R1Y3RJZCk7IC8vIMOccsO8biBJRCdzaVxuICAgICAgICAgIGNvbnNvbGUubG9nKFwiUHJvY2Vzc2luZyBQcm9kdWN0IElEOiBcIiwgcHJvZHVjdElkKTtcbiAgICAgICAgICBjb25zdCBxdWFudGl0eSA9IGNhcnRQcm9kdWN0LnF1YW50aXR5OyAvLyBTZXBldHRla2kgbWlrdGFyXG5cbiAgICAgICAgICAvLyBFxJ9lciBxdWFudGl0eSB0YW7EsW1sxLEgZGXEn2lsc2UgYnUgw7xyw7xuw7wgYXRsYVxuICAgICAgICAgIGlmICghcXVhbnRpdHkpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybihgUXVhbnRpdHkgaXMgdW5kZWZpbmVkIGZvciBwcm9kdWN0SWQ6ICR7cHJvZHVjdElkfWApO1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgLy8gw5xyw7xuIElEJ3NpbmUgZ8O2cmUga2HDpyBhZGV0IG9sZHXEn3VudSBoZXNhcGxhXG4gICAgICAgICAgaWYgKHByb2R1Y3RTdG9ja1VwZGF0ZXNbcHJvZHVjdElkXSkge1xuICAgICAgICAgICAgcHJvZHVjdFN0b2NrVXBkYXRlc1twcm9kdWN0SWRdICs9IHF1YW50aXR5O1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwcm9kdWN0U3RvY2tVcGRhdGVzW3Byb2R1Y3RJZF0gPSBxdWFudGl0eTtcbiAgICAgICAgICB9XG4gICAgICAgICAgYXdhaXQgQ2FydC51cGRhdGVPbmUoXG4gICAgICAgICAgICAvL2NhcnR0YWtpIHN0YXR1cyBkZcSfacWfaXJcbiAgICAgICAgICAgIHsgX2lkOiBjYXJ0Ll9pZCwgXCJwcm9kdWN0cy5wcm9kdWN0SWRcIjogcHJvZHVjdElkIH0sXG4gICAgICAgICAgICB7ICRzZXQ6IHsgXCJwcm9kdWN0cy4kLnN0YXR1c1wiOiBcImNhbmNlbGVkXCIgfSB9XG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIMOccsO8biBzdG9rbGFyxLFuxLEgZ8O8bmNlbGxlXG4gICAgICAgIGZvciAoY29uc3QgcHJvZHVjdElkIGluIHByb2R1Y3RTdG9ja1VwZGF0ZXMpIHtcbiAgICAgICAgICBjb25zdCBxdWFudGl0eVRvSW5jcmVhc2UgPSBwcm9kdWN0U3RvY2tVcGRhdGVzW3Byb2R1Y3RJZF07XG5cbiAgICAgICAgICAvLyBxdWFudGl0eVRvSW5jcmVhc2UgdW5kZWZpbmVkIGlzZSBzdG9rIGfDvG5jZWxsZW1lc2luaSB5YXBtYVxuICAgICAgICAgIGlmICh0eXBlb2YgcXVhbnRpdHlUb0luY3JlYXNlID09PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgICAgIGBxdWFudGl0eVRvSW5jcmVhc2UgaXMgdW5kZWZpbmVkIGZvciBwcm9kdWN0SWQ6ICR7cHJvZHVjdElkfWBcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBhd2FpdCBQcm9kdWN0cy51cGRhdGVPbmUoXG4gICAgICAgICAgICB7IF9pZDogcHJvZHVjdElkIH0sXG4gICAgICAgICAgICB7ICRpbmM6IHsgc3RvY2s6IHF1YW50aXR5VG9JbmNyZWFzZSB9IH0gLy8gU3RvayBtaWt0YXLEsW7EsSBhcnTEsXJcbiAgICAgICAgICApO1xuICAgICAgICB9XG5cbiAgICAgICAgcmVzLmpzb24ocmVzdWx0KTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIG5leHQoZXJyb3IpO1xuICAgICAgfVxuICAgIH0sXG4gICAgc2VuZENhbmNlbGVkT3JkZXJNYWlsLCAvLyDEsHB0YWwgZWRpbGVuIHNpcGFyacWfIGnDp2luIGUtcG9zdGEgZ8O2bmRlclxuICAgIChyZXEsIHJlcykgPT4ge1xuICAgICAgcmV0dXJuIHJlc1xuICAgICAgICAuc3RhdHVzKDIwMClcbiAgICAgICAgLmpzb24oYFNpcGFyacWfIGlwdGFsaSBtYWlsIGFkcmVzaW5lIGfDtm5kZXJpbG1pxZ90aXIuYCk7XG4gICAgfVxuICApO1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsU0FBQSxHQUFBQyxPQUFBO0FBQ0EsSUFBQUMsS0FBQSxHQUFBQyxzQkFBQSxDQUFBRixPQUFBO0FBQ0EsSUFBQUcsZUFBQSxHQUFBRCxzQkFBQSxDQUFBRixPQUFBO0FBQ0EsSUFBQUksU0FBQSxHQUFBRixzQkFBQSxDQUFBRixPQUFBO0FBQ0EsSUFBQUssU0FBQSxHQUFBSCxzQkFBQSxDQUFBRixPQUFBO0FB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","map":{"version":3,"names":["_mongoose","require","_cart","_interopRequireDefault","_paymentSuccess","_products","_ApiError","_RequiredCheck","_OrderCanceledMail","_Session","CancelPayments","_interopRequireWildcard","_uuid","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","ObjectId","Types","reasonEnum","_default","router","post","Session","req","res","next","reason","description","body","paymentSuccessId","params","reasonObj","checkRequiredField","includes","ApiError","payment","PaymentSuccess","findOne","_id","populate","now","Date","paymentDate","createdAt","timeDifference","result","cancelPayment","locale","user","conversationId","id","paymentId","ip","cart","Cart","cartId","productStockUpdates","cartProduct","products","productId","String","console","log","quantity","warn","updateOne","$set","quantityToIncrease","Products","$inc","stock","json","error","sendCanceledOrderMail","status","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["cancel-payments.js"],"sourcesContent":["import { Types } from \"mongoose\";\nimport Cart from \"../db/cart\";\nimport PaymentSuccess from \"../db/payment-success\";\nimport Products from \"../db/products\";\nimport ApiError from \"../errors/ApiError\";\nimport { checkRequiredField } from \"../helpers/RequiredCheck\";\nimport sendCanceledOrderMail from \"../middlewares/OrderCanceledMail\";\nimport Session from \"../middlewares/Session\";\nimport * as CancelPayments from \"../services/iyzico/methods/cancel_payments\";\nimport id from \"../utils/uuid\";\n\nconst { ObjectId } = Types;\n\nconst reasonEnum = [\"double_payment\", \"buyer_request\", \"fraud\", \"other\"];\n\nexport default (router) => {\n  router.post(\n    \"/payments/:paymentSuccessId/cancel\",\n    Session,\n    async (req, res, next) => {\n      const { reason, description } = req.body;\n      const paymentSuccessId = req.params.paymentSuccessId;\n      const reasonObj = {};\n\n      // if (!paymentSuccessId) {\n      //   throw new ApiError(\n      //     \"Payment Success id is required\",\n      //     400,\n      //     \"paymentSuccessIdRequired\"\n      //   );\n      // }\n      checkRequiredField(paymentSuccessId, \"PaymentSuccessId\");\n\n      if (reason && description) {\n        if (!reasonEnum.includes(reason)) {\n          throw new ApiError(\n            \"Invalid cancel payment reason\",\n            400,\n            \"invalidCancelPaymentReason\"\n          );\n        }\n        reasonObj.reason = reason;\n        reasonObj.description = description;\n      }\n\n      try {\n        // PaymentSuccess kaydını bul ve cartId ile populate et\n        const payment = await PaymentSuccess.findOne({\n          _id: new ObjectId(paymentSuccessId),\n        }).populate(\"cartId\");\n\n        if (!payment) {\n          throw new ApiError(\n            \"Payment record not found\",\n            404,\n            \"paymentNotFound\"\n          );\n        }\n\n        const now = new Date();\n        const paymentDate = new Date(payment.createdAt);\n        const timeDifference = now - paymentDate;\n\n        // 24 saat sınırı kontrolü\n        // if (timeDifference > 86400000) {\n        //   throw new ApiError(\n        //     \"This payment can no longer be canceled as the 24-hour window has passed\",\n        //     400,\n        //     \"cancelTimeExceeded\"\n        //   );\n        // }\n\n        // Ödemeyi iptal et\n        const result = await CancelPayments.cancelPayment({\n          locale: req.user.locale,\n          conversationId: id(),\n          paymentId: payment?.paymentId,\n          ip: req.user?.ip,\n          ...reasonObj,\n        });\n\n        // Cart tablosundan ürün bilgilerini al\n        const cart = await Cart.findOne({ _id: payment.cartId });\n        if (!cart) {\n          throw new ApiError(\"Cart not found\", 404, \"cartNotFound\");\n        }\n\n        const productStockUpdates = {};\n\n        // Sepetteki ürünleri işle ve quantity miktarlarını al\n        for (const cartProduct of cart.products) {\n          const productId = String(cartProduct.productId); // Ürün ID'si\n          console.log(\"Processing Product ID: \", productId);\n          const quantity = cartProduct.quantity; // Sepetteki miktar\n\n          // Eğer quantity tanımlı değilse bu ürünü atla\n          if (!quantity) {\n            console.warn(`Quantity is undefined for productId: ${productId}`);\n            continue;\n          }\n\n          // Ürün ID'sine göre kaç adet olduğunu hesapla\n          if (productStockUpdates[productId]) {\n            productStockUpdates[productId] += quantity;\n          } else {\n            productStockUpdates[productId] = quantity;\n          }\n          await Cart.updateOne(\n            //carttaki status değişir\n            { _id: cart._id, \"products.productId\": productId },\n            { $set: { \"products.$.status\": \"canceled\" } }\n          );\n        }\n\n        // Ürün stoklarını güncelle\n        for (const productId in productStockUpdates) {\n          const quantityToIncrease = productStockUpdates[productId];\n\n          // quantityToIncrease undefined ise stok güncellemesini yapma\n          if (typeof quantityToIncrease === \"undefined\") {\n            console.warn(\n              `quantityToIncrease is undefined for productId: ${productId}`\n            );\n            continue;\n          }\n\n          await Products.updateOne(\n            { _id: productId },\n            { $inc: { stock: quantityToIncrease } } // Stok miktarını artır\n          );\n        }\n\n        res.json(result);\n      } catch (error) {\n        next(error);\n      }\n    },\n    sendCanceledOrderMail, // İptal edilen sipariş için e-posta gönder\n    (req, res) => {\n      return res\n        .status(200)\n        .json(`Sipariş iptali mail adresine gönderilmiştir.`);\n    }\n  );\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1734952190083},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/cancel_payments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.cancelPayment = void 0;\nvar _iyzipay = _interopRequireDefault(require(\"../connection/iyzipay\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst cancelPayment = data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.cancel.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.cancelPayment = cancelPayment;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaXl6aXBheSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiY2FuY2VsUGF5bWVudCIsImRhdGEiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIml5emlwYXkiLCJjYW5jZWwiLCJjcmVhdGUiLCJlcnIiLCJyZXN1bHQiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvc2VydmljZXMvaXl6aWNvL21ldGhvZHMvIiwic291cmNlcyI6WyJjYW5jZWxfcGF5bWVudHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGl5emlwYXkgZnJvbSBcIi4uL2Nvbm5lY3Rpb24vaXl6aXBheVwiO1xuXG5leHBvcnQgY29uc3QgY2FuY2VsUGF5bWVudCA9IChkYXRhKSA9PiB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgaXl6aXBheS5jYW5jZWwuY3JlYXRlKGRhdGEsIChlcnIsIHJlc3VsdCkgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxRQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFBNEMsU0FBQUQsdUJBQUFFLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFckMsTUFBTUcsYUFBYSxHQUFJQyxJQUFJLElBQUs7RUFDckMsT0FBTyxJQUFJQyxPQUFPLENBQUMsQ0FBQ0MsT0FBTyxFQUFFQyxNQUFNLEtBQUs7SUFDdENDLGdCQUFPLENBQUNDLE1BQU0sQ0FBQ0MsTUFBTSxDQUFDTixJQUFJLEVBQUUsQ0FBQ08sR0FBRyxFQUFFQyxNQUFNLEtBQUs7TUFDM0MsSUFBSUQsR0FBRyxFQUFFO1FBQ1BKLE1BQU0sQ0FBQ0ksR0FBRyxDQUFDO01BQ2IsQ0FBQyxNQUFNO1FBQ0xMLE9BQU8sQ0FBQ00sTUFBTSxDQUFDO01BQ2pCO0lBQ0YsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUFDQyxPQUFBLENBQUFWLGFBQUEsR0FBQUEsYUFBQSIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_iyzipay","_interopRequireDefault","require","e","__esModule","default","cancelPayment","data","Promise","resolve","reject","iyzipay","cancel","create","err","result","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/","sources":["cancel_payments.js"],"sourcesContent":["import iyzipay from \"../connection/iyzipay\";\n\nexport const cancelPayment = (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.cancel.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA4C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAErC,MAAMG,aAAa,GAAIC,IAAI,IAAK;EACrC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,MAAM,CAACC,MAAM,CAACN,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MAC3C,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAV,aAAA,GAAAA,aAAA","ignoreList":[]}},"mtime":1723543937119},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/checkouts.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _moment = _interopRequireDefault(require(\"moment\"));\nvar _iyzipay = _interopRequireDefault(require(\"iyzipay\"));\nvar _cart = _interopRequireDefault(require(\"../db/cart\"));\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nvar Checkout = _interopRequireWildcard(require(\"../services/iyzico/methods/checkouts\"));\nvar Cards = _interopRequireWildcard(require(\"../services/iyzico/methods/cards\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nvar _payments = require(\"../utils/payments\");\nvar _OrderCompleteMail = _interopRequireDefault(require(\"../middlewares/OrderCompleteMail\"));\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function (e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = router => {\n  //Checkout from complete payment\n\n  router.post(\"/checkout/complete/payment\", async (req, res) => {\n    let result = await Checkout.getForPayment({\n      locale: \"tr\",\n      conversationId: (0, _uuid.default)(),\n      token: req.body.token\n    });\n    await (0, _payments.CompletePayment)(result);\n    res.json(result);\n  });\n\n  //CHECKOUT FORM İNİTİALİZE\n  router.post(\"/checkout/:cartId\", _Session.default, async (req, res, next) => {\n    if (!req.user?.cardUserKey) {\n      throw new _ApiError.default(\"No registered card available\", 400, \"cardUserKeyRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _cart.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      enabledInstallments: [1, 2, 3, 4, 6, 9],\n      callbackUrl: `${process.env.END_POINT}/checkout/complete/payment`,\n      ...(req.user?.cardUserKey && {\n        cardUserKey: req.user?.cardUserKey\n      }),\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    try {\n      let result = await Checkout.initialize(data);\n      const html = `<!DOCTYPE html>\n    <html>\n    <head>\n    <title>Ödeme yap</title>\n    <meta charset=\"UTF-8\"/>\n    ${result?.checkoutFormContent}\n    </head>\n    </html>`;\n      res.send(html);\n      next();\n    } catch (error) {\n      next(error);\n    }\n  }, _OrderCompleteMail.default, (req, res) => {\n    return res.status(200).json(`${req.user.email} mail adresine sipariş detayı gönderilmiştir.`);\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9tZW50IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfaXl6aXBheSIsIl9jYXJ0IiwiX3VzZXJzIiwiX0FwaUVycm9yIiwiX1Nlc3Npb24iLCJDaGVja291dCIsIl9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkIiwiQ2FyZHMiLCJfdXVpZCIsIl9wYXltZW50cyIsIl9PcmRlckNvbXBsZXRlTWFpbCIsIl9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSIsImUiLCJXZWFrTWFwIiwiciIsInQiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImhhcyIsImdldCIsIm4iLCJfX3Byb3RvX18iLCJhIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJ1IiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiaSIsInNldCIsIl9kZWZhdWx0Iiwicm91dGVyIiwicG9zdCIsInJlcSIsInJlcyIsInJlc3VsdCIsImdldEZvclBheW1lbnQiLCJsb2NhbGUiLCJjb252ZXJzYXRpb25JZCIsImlkIiwidG9rZW4iLCJib2R5IiwiQ29tcGxldGVQYXltZW50IiwianNvbiIsIlNlc3Npb24iLCJuZXh0IiwidXNlciIsImNhcmRVc2VyS2V5IiwiQXBpRXJyb3IiLCJwYXJhbXMiLCJjYXJ0SWQiLCJjYXJ0IiwiQ2FydHMiLCJmaW5kT25lIiwiX2lkIiwicG9wdWxhdGUiLCJjb21wbGV0ZWQiLCJwYWlkUHJpY2UiLCJwcm9kdWN0cyIsIm1hcCIsInByb2R1Y3QiLCJwcmljZSIsInJlZHVjZSIsImIiLCJkYXRhIiwiY3VycmVuY3kiLCJJeXppcGF5IiwiQ1VSUkVOQ1kiLCJUUlkiLCJpbnN0YWxsbWVudHMiLCJiYXNrZXRJZCIsIlN0cmluZyIsInBheW1lbnRDaGFubmVsIiwiUEFZTUVOVF9DSEFOTkVMIiwiV0VCIiwicGF5bWVudEdyb3VwIiwiUEFZTUVOVF9HUk9VUCIsIlBST0RVQ1QiLCJlbmFibGVkSW5zdGFsbG1lbnRzIiwiY2FsbGJhY2tVcmwiLCJwcm9jZXNzIiwiZW52IiwiRU5EX1BPSU5UIiwiYnV5ZXIiLCJuYW1lIiwic3VybmFtZSIsImdzbU51bWJlciIsInBob25lTnVtYmVyIiwiZW1haWwiLCJpZGVudGl0eU51bWJlciIsImxhc3RMb2dpbkRhdGUiLCJtb21lbnQiLCJ1cGRhdGVkQXQiLCJmb3JtYXQiLCJyZWdpc3RyYXRpb25EYXRlIiwicmVnaXN0cmF0aW9uQWRkcmVzcyIsImFkZHJlc3MiLCJpcCIsImNpdHkiLCJjb3VudHJ5IiwiemlwQ29kZSIsInNoaXBwaW5nQWRkcmVzcyIsImNvbnRhY3ROYW1lIiwiYmlsbGluZ0FkZHJlc3MiLCJiYXNrZXRJdGVtcyIsImluZGV4IiwiY2F0ZWdvcnkxIiwiY2F0ZWdvcmllcyIsImNhdGVnb3J5MiIsIml0ZW1UeXBlIiwiQkFTS0VUX0lURU1fVFlQRSIsImluaXRpYWxpemUiLCJodG1sIiwiY2hlY2tvdXRGb3JtQ29udGVudCIsInNlbmQiLCJlcnJvciIsIk9yZGVyQ29tcGxldGVNYWlsIiwic3RhdHVzIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3JvdXRlcy8iLCJzb3VyY2VzIjpbImNoZWNrb3V0cy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9tZW50IGZyb20gXCJtb21lbnRcIjtcbmltcG9ydCBJeXppcGF5IGZyb20gXCJpeXppcGF5XCI7XG5pbXBvcnQgQ2FydHMgZnJvbSBcIi4uL2RiL2NhcnRcIjtcbmltcG9ydCBVc2VycyBmcm9tIFwiLi4vZGIvdXNlcnNcIjtcbmltcG9ydCBBcGlFcnJvciBmcm9tIFwiLi4vZXJyb3JzL0FwaUVycm9yXCI7XG5pbXBvcnQgU2Vzc2lvbiBmcm9tIFwiLi4vbWlkZGxld2FyZXMvU2Vzc2lvblwiO1xuaW1wb3J0ICogYXMgQ2hlY2tvdXQgZnJvbSBcIi4uL3NlcnZpY2VzL2l5emljby9tZXRob2RzL2NoZWNrb3V0c1wiO1xuaW1wb3J0ICogYXMgQ2FyZHMgZnJvbSBcIi4uL3NlcnZpY2VzL2l5emljby9tZXRob2RzL2NhcmRzXCI7XG5pbXBvcnQgaWQgZnJvbSBcIi4uL3V0aWxzL3V1aWRcIjtcbmltcG9ydCB7IENvbXBsZXRlUGF5bWVudCB9IGZyb20gXCIuLi91dGlscy9wYXltZW50c1wiO1xuaW1wb3J0IE9yZGVyQ29tcGxldGVNYWlsIGZyb20gXCIuLi9taWRkbGV3YXJlcy9PcmRlckNvbXBsZXRlTWFpbFwiO1xuXG5leHBvcnQgZGVmYXVsdCAocm91dGVyKSA9PiB7XG4gIC8vQ2hlY2tvdXQgZnJvbSBjb21wbGV0ZSBwYXltZW50XG5cbiAgcm91dGVyLnBvc3QoXCIvY2hlY2tvdXQvY29tcGxldGUvcGF5bWVudFwiLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICBsZXQgcmVzdWx0ID0gYXdhaXQgQ2hlY2tvdXQuZ2V0Rm9yUGF5bWVudCh7XG4gICAgICBsb2NhbGU6IFwidHJcIixcbiAgICAgIGNvbnZlcnNhdGlvbklkOiBpZCgpLFxuICAgICAgdG9rZW46IHJlcS5ib2R5LnRva2VuLFxuICAgIH0pO1xuICAgIGF3YWl0IENvbXBsZXRlUGF5bWVudChyZXN1bHQpO1xuICAgIHJlcy5qc29uKHJlc3VsdCk7XG4gIH0pO1xuXG4gIC8vQ0hFQ0tPVVQgRk9STSDEsE7EsFTEsEFMxLBaRVxuICByb3V0ZXIucG9zdChcbiAgICBcIi9jaGVja291dC86Y2FydElkXCIsXG4gICAgU2Vzc2lvbixcbiAgICBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICAgIGlmICghcmVxLnVzZXI/LmNhcmRVc2VyS2V5KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgICBcIk5vIHJlZ2lzdGVyZWQgY2FyZCBhdmFpbGFibGVcIixcbiAgICAgICAgICA0MDAsXG4gICAgICAgICAgXCJjYXJkVXNlcktleVJlcXVpcmVkXCJcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFyZXEucGFyYW1zPy5jYXJ0SWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FydElEIGlzIHJlcXVpcmVkXCIsIDQwMCwgXCJjYXJ0SWRSZXF1aXJlZFwiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGNhcnQgPSBhd2FpdCBDYXJ0cy5maW5kT25lKHsgX2lkOiByZXEucGFyYW1zPy5jYXJ0SWQgfSlcbiAgICAgICAgLnBvcHVsYXRlKFwiYnV5ZXJcIilcbiAgICAgICAgLnBvcHVsYXRlKFwicHJvZHVjdHNcIik7XG4gICAgICBpZiAoIWNhcnQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FyZCBub3QgZm91bmRcIiwgNDA0LCBcImNhcmROb3RGb3VuZFwiKTtcbiAgICAgIH1cbiAgICAgIGlmIChjYXJ0Py5jb21wbGV0ZWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FydCBpcyBjb21wbGV0ZWRcIiwgNDAwLCBcImNhcnRDb21wbGV0ZWRcIik7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHBhaWRQcmljZSA9IGNhcnQucHJvZHVjdHNcbiAgICAgICAgLm1hcCgocHJvZHVjdCkgPT4gcHJvZHVjdC5wcmljZSlcbiAgICAgICAgLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApOyAvL8O2ZGVuZWNlayBtaWt0YXJsYXLEsW4gdG9wbGFtxLFcblxuICAgICAgY29uc3QgZGF0YSA9IHtcbiAgICAgICAgbG9jYWxlOiByZXEudXNlci5sb2NhbGUsXG4gICAgICAgIGNvbnZlcnNhdGlvbklkOiBpZCgpLFxuICAgICAgICBwcmljZTogcGFpZFByaWNlLFxuICAgICAgICBwYWlkUHJpY2U6IHBhaWRQcmljZSxcbiAgICAgICAgY3VycmVuY3k6IEl5emlwYXkuQ1VSUkVOQ1kuVFJZLFxuICAgICAgICBpbnN0YWxsbWVudHM6IFwiMVwiLFxuICAgICAgICBiYXNrZXRJZDogU3RyaW5nKGNhcnQ/Ll9pZCksXG4gICAgICAgIHBheW1lbnRDaGFubmVsOiBJeXppcGF5LlBBWU1FTlRfQ0hBTk5FTC5XRUIsXG4gICAgICAgIHBheW1lbnRHcm91cDogSXl6aXBheS5QQVlNRU5UX0dST1VQLlBST0RVQ1QsXG4gICAgICAgIGVuYWJsZWRJbnN0YWxsbWVudHM6IFsxLCAyLCAzLCA0LCA2LCA5XSxcbiAgICAgICAgY2FsbGJhY2tVcmw6IGAke3Byb2Nlc3MuZW52LkVORF9QT0lOVH0vY2hlY2tvdXQvY29tcGxldGUvcGF5bWVudGAsXG4gICAgICAgIC4uLihyZXEudXNlcj8uY2FyZFVzZXJLZXkgJiYge1xuICAgICAgICAgIGNhcmRVc2VyS2V5OiByZXEudXNlcj8uY2FyZFVzZXJLZXksXG4gICAgICAgIH0pLFxuICAgICAgICBidXllcjoge1xuICAgICAgICAgIGlkOiBTdHJpbmcocmVxLnVzZXIuX2lkKSxcbiAgICAgICAgICBuYW1lOiByZXEudXNlcj8ubmFtZSxcbiAgICAgICAgICBzdXJuYW1lOiByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBnc21OdW1iZXI6IHJlcS51c2VyPy5waG9uZU51bWJlcixcbiAgICAgICAgICBlbWFpbDogcmVxLnVzZXI/LmVtYWlsLFxuICAgICAgICAgIGlkZW50aXR5TnVtYmVyOiByZXEudXNlcj8uaWRlbnRpdHlOdW1iZXIsXG4gICAgICAgICAgbGFzdExvZ2luRGF0ZTogbW9tZW50KHJlcS51c2VyPy51cGRhdGVkQXQpLmZvcm1hdChcbiAgICAgICAgICAgIFwiWVlZWS1NTS1ERCBISDptbTpzc1wiXG4gICAgICAgICAgKSwgLy9peWl6cGF5IHRhcmloIGZvcm1hdMSxbmEgw6dldmlybWVrIGnDp2luIHlhcMSxbGTEsVxuICAgICAgICAgIHJlZ2lzdHJhdGlvbkRhdGU6IG1vbWVudChyZXEudXNlcj8udXBkYXRlZEF0KS5mb3JtYXQoXG4gICAgICAgICAgICBcIllZWVktTU0tREQgSEg6bW06c3NcIlxuICAgICAgICAgICksXG4gICAgICAgICAgcmVnaXN0cmF0aW9uQWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgaXA6IHJlcS51c2VyPy5pcCxcbiAgICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgICAgfSxcbiAgICAgICAgc2hpcHBpbmdBZGRyZXNzOiB7XG4gICAgICAgICAgY29udGFjdE5hbWU6IHJlcS51c2VyPy5uYW1lICsgXCJcIiArIHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIGFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBiaWxsaW5nQWRkcmVzczoge1xuICAgICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiXCIgKyByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgICBhZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgICAgfSxcbiAgICAgICAgYmFza2V0SXRlbXM6IGNhcnQucHJvZHVjdHMubWFwKChwcm9kdWN0LCBpbmRleCkgPT4ge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpZDogU3RyaW5nKHByb2R1Y3Q/Ll9pZCksXG4gICAgICAgICAgICBuYW1lOiBwcm9kdWN0Py5uYW1lLFxuICAgICAgICAgICAgY2F0ZWdvcnkxOiBwcm9kdWN0LmNhdGVnb3JpZXNbMF0sXG4gICAgICAgICAgICBjYXRlZ29yeTI6IHByb2R1Y3QuY2F0ZWdvcmllc1sxXSxcbiAgICAgICAgICAgIGl0ZW1UeXBlOiBJeXppcGF5LkJBU0tFVF9JVEVNX1RZUEVbcHJvZHVjdD8uaXRlbVR5cGVdLFxuICAgICAgICAgICAgcHJpY2U6IHByb2R1Y3Q/LnByaWNlLFxuICAgICAgICAgIH07XG4gICAgICAgIH0pLFxuICAgICAgfTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IENoZWNrb3V0LmluaXRpYWxpemUoZGF0YSk7XG4gICAgICAgIGNvbnN0IGh0bWwgPSBgPCFET0NUWVBFIGh0bWw+XG4gICAgPGh0bWw+XG4gICAgPGhlYWQ+XG4gICAgPHRpdGxlPsOWZGVtZSB5YXA8L3RpdGxlPlxuICAgIDxtZXRhIGNoYXJzZXQ9XCJVVEYtOFwiLz5cbiAgICAke3Jlc3VsdD8uY2hlY2tvdXRGb3JtQ29udGVudH1cbiAgICA8L2hlYWQ+XG4gICAgPC9odG1sPmA7XG4gICAgICAgIHJlcy5zZW5kKGh0bWwpO1xuICAgICAgICBuZXh0KCk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBuZXh0KGVycm9yKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIE9yZGVyQ29tcGxldGVNYWlsLFxuICAgIChyZXEsIHJlcykgPT4ge1xuICAgICAgcmV0dXJuIHJlc1xuICAgICAgICAuc3RhdHVzKDIwMClcbiAgICAgICAgLmpzb24oYCR7cmVxLnVzZXIuZW1haWx9IG1haWwgYWRyZXNpbmUgc2lwYXJpxZ8gZGV0YXnEsSBnw7ZuZGVyaWxtacWfdGlyLmApO1xuICAgIH1cbiAgKTtcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLE9BQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFFBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLEtBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFHLE1BQUEsR0FBQUosc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFJLFNBQUEs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","map":{"version":3,"names":["_moment","_interopRequireDefault","require","_iyzipay","_cart","_users","_ApiError","_Session","Checkout","_interopRequireWildcard","Cards","_uuid","_payments","_OrderCompleteMail","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","_default","router","post","req","res","result","getForPayment","locale","conversationId","id","token","body","CompletePayment","json","Session","next","user","cardUserKey","ApiError","params","cartId","cart","Carts","findOne","_id","populate","completed","paidPrice","products","map","product","price","reduce","b","data","currency","Iyzipay","CURRENCY","TRY","installments","basketId","String","paymentChannel","PAYMENT_CHANNEL","WEB","paymentGroup","PAYMENT_GROUP","PRODUCT","enabledInstallments","callbackUrl","process","env","END_POINT","buyer","name","surname","gsmNumber","phoneNumber","email","identityNumber","lastLoginDate","moment","updatedAt","format","registrationDate","registrationAddress","address","ip","city","country","zipCode","shippingAddress","contactName","billingAddress","basketItems","index","category1","categories","category2","itemType","BASKET_ITEM_TYPE","initialize","html","checkoutFormContent","send","error","OrderCompleteMail","status","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["checkouts.js"],"sourcesContent":["import moment from \"moment\";\nimport Iyzipay from \"iyzipay\";\nimport Carts from \"../db/cart\";\nimport Users from \"../db/users\";\nimport ApiError from \"../errors/ApiError\";\nimport Session from \"../middlewares/Session\";\nimport * as Checkout from \"../services/iyzico/methods/checkouts\";\nimport * as Cards from \"../services/iyzico/methods/cards\";\nimport id from \"../utils/uuid\";\nimport { CompletePayment } from \"../utils/payments\";\nimport OrderCompleteMail from \"../middlewares/OrderCompleteMail\";\n\nexport default (router) => {\n  //Checkout from complete payment\n\n  router.post(\"/checkout/complete/payment\", async (req, res) => {\n    let result = await Checkout.getForPayment({\n      locale: \"tr\",\n      conversationId: id(),\n      token: req.body.token,\n    });\n    await CompletePayment(result);\n    res.json(result);\n  });\n\n  //CHECKOUT FORM İNİTİALİZE\n  router.post(\n    \"/checkout/:cartId\",\n    Session,\n    async (req, res, next) => {\n      if (!req.user?.cardUserKey) {\n        throw new ApiError(\n          \"No registered card available\",\n          400,\n          \"cardUserKeyRequired\"\n        );\n      }\n\n      if (!req.params?.cartId) {\n        throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      }\n      const cart = await Carts.findOne({ _id: req.params?.cartId })\n        .populate(\"buyer\")\n        .populate(\"products\");\n      if (!cart) {\n        throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n      }\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      const paidPrice = cart.products\n        .map((product) => product.price)\n        .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: paidPrice,\n        paidPrice: paidPrice,\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        enabledInstallments: [1, 2, 3, 4, 6, 9],\n        callbackUrl: `${process.env.END_POINT}/checkout/complete/payment`,\n        ...(req.user?.cardUserKey && {\n          cardUserKey: req.user?.cardUserKey,\n        }),\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ), //iyizpay tarih formatına çevirmek için yapıldı\n          registrationDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems: cart.products.map((product, index) => {\n          return {\n            id: String(product?._id),\n            name: product?.name,\n            category1: product.categories[0],\n            category2: product.categories[1],\n            itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n            price: product?.price,\n          };\n        }),\n      };\n\n      try {\n        let result = await Checkout.initialize(data);\n        const html = `<!DOCTYPE html>\n    <html>\n    <head>\n    <title>Ödeme yap</title>\n    <meta charset=\"UTF-8\"/>\n    ${result?.checkoutFormContent}\n    </head>\n    </html>`;\n        res.send(html);\n        next();\n      } catch (error) {\n        next(error);\n      }\n    },\n    OrderCompleteMail,\n    (req, res) => {\n      return res\n        .status(200)\n        .json(`${req.user.email} mail adresine sipariş detayı gönderilmiştir.`);\n    }\n  );\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1724323812541},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/checkouts.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.initialize = exports.getForPayment = void 0;\nvar _iyzipay = _interopRequireDefault(require(\"../connection/iyzipay\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst initialize = data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.checkoutFormInitialize.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.initialize = initialize;\nconst getForPayment = data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.checkoutForm.retrieve(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.getForPayment = getForPayment;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaXl6aXBheSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiaW5pdGlhbGl6ZSIsImRhdGEiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIml5emlwYXkiLCJjaGVja291dEZvcm1Jbml0aWFsaXplIiwiY3JlYXRlIiwiZXJyIiwicmVzdWx0IiwiZXhwb3J0cyIsImdldEZvclBheW1lbnQiLCJjaGVja291dEZvcm0iLCJyZXRyaWV2ZSJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3NlcnZpY2VzL2l5emljby9tZXRob2RzLyIsInNvdXJjZXMiOlsiY2hlY2tvdXRzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBpeXppcGF5IGZyb20gXCIuLi9jb25uZWN0aW9uL2l5emlwYXlcIjtcblxuZXhwb3J0IGNvbnN0IGluaXRpYWxpemUgPSAoZGF0YSkgPT4ge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGl5emlwYXkuY2hlY2tvdXRGb3JtSW5pdGlhbGl6ZS5jcmVhdGUoZGF0YSwgKGVyciwgcmVzdWx0KSA9PiB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRGb3JQYXltZW50ID0gKGRhdGEpID0+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBpeXppcGF5LmNoZWNrb3V0Rm9ybS5yZXRyaWV2ZShkYXRhLCAoZXJyLCByZXN1bHQpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsUUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQTRDLFNBQUFELHVCQUFBRSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBRXJDLE1BQU1HLFVBQVUsR0FBSUMsSUFBSSxJQUFLO0VBQ2xDLE9BQU8sSUFBSUMsT0FBTyxDQUFDLENBQUNDLE9BQU8sRUFBRUMsTUFBTSxLQUFLO0lBQ3RDQyxnQkFBTyxDQUFDQyxzQkFBc0IsQ0FBQ0MsTUFBTSxDQUFDTixJQUFJLEVBQUUsQ0FBQ08sR0FBRyxFQUFFQyxNQUFNLEtBQUs7TUFDM0QsSUFBSUQsR0FBRyxFQUFFO1FBQ1BKLE1BQU0sQ0FBQ0ksR0FBRyxDQUFDO01BQ2IsQ0FBQyxNQUFNO1FBQ0xMLE9BQU8sQ0FBQ00sTUFBTSxDQUFDO01BQ2pCO0lBQ0YsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUFDQyxPQUFBLENBQUFWLFVBQUEsR0FBQUEsVUFBQTtBQUVLLE1BQU1XLGFBQWEsR0FBSVYsSUFBSSxJQUFLO0VBQ3JDLE9BQU8sSUFBSUMsT0FBTyxDQUFDLENBQUNDLE9BQU8sRUFBRUMsTUFBTSxLQUFLO0lBQ3RDQyxnQkFBTyxDQUFDTyxZQUFZLENBQUNDLFFBQVEsQ0FBQ1osSUFBSSxFQUFFLENBQUNPLEdBQUcsRUFBRUMsTUFBTSxLQUFLO01BQ25ELElBQUlELEdBQUcsRUFBRTtRQUNQSixNQUFNLENBQUNJLEdBQUcsQ0FBQztNQUNiLENBQUMsTUFBTTtRQUNMTCxPQUFPLENBQUNNLE1BQU0sQ0FBQztNQUNqQjtJQUNGLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztBQUNKLENBQUM7QUFBQ0MsT0FBQSxDQUFBQyxhQUFBLEdBQUFBLGFBQUEiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_iyzipay","_interopRequireDefault","require","e","__esModule","default","initialize","data","Promise","resolve","reject","iyzipay","checkoutFormInitialize","create","err","result","exports","getForPayment","checkoutForm","retrieve"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/","sources":["checkouts.js"],"sourcesContent":["import iyzipay from \"../connection/iyzipay\";\n\nexport const initialize = (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.checkoutFormInitialize.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n\nexport const getForPayment = (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.checkoutForm.retrieve(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA4C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAErC,MAAMG,UAAU,GAAIC,IAAI,IAAK;EAClC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,sBAAsB,CAACC,MAAM,CAACN,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MAC3D,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAV,UAAA,GAAAA,UAAA;AAEK,MAAMW,aAAa,GAAIV,IAAI,IAAK;EACrC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACO,YAAY,CAACC,QAAQ,CAACZ,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MACnD,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAC,aAAA,GAAAA,aAAA","ignoreList":[]}},"mtime":1723543937122},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/refund-payments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nvar _RequiredCheck = require(\"../helpers/RequiredCheck\");\nvar RefundPayments = _interopRequireWildcard(require(\"../services/iyzico/methods/refund_payments\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nvar _iyzipay = _interopRequireDefault(require(\"iyzipay\"));\nvar _paymentSuccess = _interopRequireDefault(require(\"../db/payment-success\"));\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function (e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst reasonEnum = [\"double_payment\", \"buyer_request\", \"fraud\", \"other\"];\nvar _default = router => {\n  router.post(\"/payments/:paymentTransactionId/refund\", _Session.default, async (req, res) => {\n    const {\n      paymentTransactionId\n    } = req.params;\n    const reasonObj = {};\n    const {\n      reason,\n      description\n    } = req.body;\n    // if (!paymentTransactionId) {\n    //   throw new ApiError(\n    //     \"PaymentTransactionId is required\",\n    //     400,\n    //     \"paymentTransactionRequired\"\n    //   );\n    // }\n    (0, _RequiredCheck.checkRequiredField)(paymentTransactionId, \"PaymentTransactionId\");\n    if (reason && description) {\n      if (!reasonEnum.includes(reason)) {\n        throw new _ApiError.default(\"Invalid canlcel payment reason\", 400, \"invalidCancelPaymentReason\");\n      }\n      reasonObj.reason = reason;\n      reasonObj.description = description;\n    }\n    const payment = await _paymentSuccess.default.findOne({\n      \"itemTransactions.paymentTransactionId\": paymentTransactionId\n    });\n    //saat sınırı koy kısmi iptal için\n\n    const currentItemTransaction = payment.itemTransactions.find((itemTransaction, index) => {\n      return itemTransaction.paymentTransactionId === paymentTransactionId;\n    });\n    const result = await RefundPayments.refundPayment({\n      locale: req.user?.locale,\n      conversationId: (0, _uuid.default)(),\n      paymentTransactionId: currentItemTransaction?.paymentTransactionId,\n      price: req.body?.refundPrice || currentItemTransaction?.paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      ip: req.user?.ip,\n      ...reasonObj\n    });\n    res.json(result);\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQXBpRXJyb3IiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9TZXNzaW9uIiwiX1JlcXVpcmVkQ2hlY2siLCJSZWZ1bmRQYXltZW50cyIsIl9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkIiwiX3V1aWQiLCJfaXl6aXBheSIsIl9wYXltZW50U3VjY2VzcyIsIl9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSIsImUiLCJXZWFrTWFwIiwiciIsInQiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImhhcyIsImdldCIsIm4iLCJfX3Byb3RvX18iLCJhIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJ1IiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiaSIsInNldCIsInJlYXNvbkVudW0iLCJfZGVmYXVsdCIsInJvdXRlciIsInBvc3QiLCJTZXNzaW9uIiwicmVxIiwicmVzIiwicGF5bWVudFRyYW5zYWN0aW9uSWQiLCJwYXJhbXMiLCJyZWFzb25PYmoiLCJyZWFzb24iLCJkZXNjcmlwdGlvbiIsImJvZHkiLCJjaGVja1JlcXVpcmVkRmllbGQiLCJpbmNsdWRlcyIsIkFwaUVycm9yIiwicGF5bWVudCIsIlBheW1lbnRTdWNjZXNzIiwiZmluZE9uZSIsImN1cnJlbnRJdGVtVHJhbnNhY3Rpb24iLCJpdGVtVHJhbnNhY3Rpb25zIiwiZmluZCIsIml0ZW1UcmFuc2FjdGlvbiIsImluZGV4IiwicmVzdWx0IiwicmVmdW5kUGF5bWVudCIsImxvY2FsZSIsInVzZXIiLCJjb252ZXJzYXRpb25JZCIsImlkIiwicHJpY2UiLCJyZWZ1bmRQcmljZSIsInBhaWRQcmljZSIsImN1cnJlbmN5IiwiSXl6aXBheSIsIkNVUlJFTkNZIiwiVFJZIiwiaXAiLCJqc29uIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3JvdXRlcy8iLCJzb3VyY2VzIjpbInJlZnVuZC1wYXltZW50cy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQXBpRXJyb3IgZnJvbSBcIi4uL2Vycm9ycy9BcGlFcnJvclwiO1xuaW1wb3J0IFNlc3Npb24gZnJvbSBcIi4uL21pZGRsZXdhcmVzL1Nlc3Npb25cIjtcbmltcG9ydCB7IGNoZWNrUmVxdWlyZWRGaWVsZCB9IGZyb20gXCIuLi9oZWxwZXJzL1JlcXVpcmVkQ2hlY2tcIjtcbmltcG9ydCAqIGFzIFJlZnVuZFBheW1lbnRzIGZyb20gXCIuLi9zZXJ2aWNlcy9peXppY28vbWV0aG9kcy9yZWZ1bmRfcGF5bWVudHNcIjtcbmltcG9ydCBpZCBmcm9tIFwiLi4vdXRpbHMvdXVpZFwiO1xuaW1wb3J0IEl5emlwYXkgZnJvbSBcIml5emlwYXlcIjtcbmltcG9ydCBQYXltZW50U3VjY2VzcyBmcm9tIFwiLi4vZGIvcGF5bWVudC1zdWNjZXNzXCI7XG5cbmNvbnN0IHJlYXNvbkVudW0gPSBbXCJkb3VibGVfcGF5bWVudFwiLCBcImJ1eWVyX3JlcXVlc3RcIiwgXCJmcmF1ZFwiLCBcIm90aGVyXCJdO1xuXG5leHBvcnQgZGVmYXVsdCAocm91dGVyKSA9PiB7XG4gIHJvdXRlci5wb3N0KFxuICAgIFwiL3BheW1lbnRzLzpwYXltZW50VHJhbnNhY3Rpb25JZC9yZWZ1bmRcIixcbiAgICBTZXNzaW9uLFxuICAgIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgICAgY29uc3QgeyBwYXltZW50VHJhbnNhY3Rpb25JZCB9ID0gcmVxLnBhcmFtcztcbiAgICAgIGNvbnN0IHJlYXNvbk9iaiA9IHt9O1xuICAgICAgY29uc3QgeyByZWFzb24sIGRlc2NyaXB0aW9uIH0gPSByZXEuYm9keTtcbiAgICAgIC8vIGlmICghcGF5bWVudFRyYW5zYWN0aW9uSWQpIHtcbiAgICAgIC8vICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgLy8gICAgIFwiUGF5bWVudFRyYW5zYWN0aW9uSWQgaXMgcmVxdWlyZWRcIixcbiAgICAgIC8vICAgICA0MDAsXG4gICAgICAvLyAgICAgXCJwYXltZW50VHJhbnNhY3Rpb25SZXF1aXJlZFwiXG4gICAgICAvLyAgICk7XG4gICAgICAvLyB9XG4gICAgICBjaGVja1JlcXVpcmVkRmllbGQocGF5bWVudFRyYW5zYWN0aW9uSWQsIFwiUGF5bWVudFRyYW5zYWN0aW9uSWRcIik7XG5cbiAgICAgIGlmIChyZWFzb24gJiYgZGVzY3JpcHRpb24pIHtcbiAgICAgICAgaWYgKCFyZWFzb25FbnVtLmluY2x1ZGVzKHJlYXNvbikpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgICBcIkludmFsaWQgY2FubGNlbCBwYXltZW50IHJlYXNvblwiLFxuICAgICAgICAgICAgNDAwLFxuICAgICAgICAgICAgXCJpbnZhbGlkQ2FuY2VsUGF5bWVudFJlYXNvblwiXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZWFzb25PYmoucmVhc29uID0gcmVhc29uO1xuICAgICAgICByZWFzb25PYmouZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcGF5bWVudCA9IGF3YWl0IFBheW1lbnRTdWNjZXNzLmZpbmRPbmUoe1xuICAgICAgICBcIml0ZW1UcmFuc2FjdGlvbnMucGF5bWVudFRyYW5zYWN0aW9uSWRcIjogcGF5bWVudFRyYW5zYWN0aW9uSWQsXG4gICAgICB9KTtcbiAgICAgIC8vc2FhdCBzxLFuxLFyxLEga295IGvEsXNtaSBpcHRhbCBpw6dpblxuXG4gICAgICBjb25zdCBjdXJyZW50SXRlbVRyYW5zYWN0aW9uID0gcGF5bWVudC5pdGVtVHJhbnNhY3Rpb25zLmZpbmQoXG4gICAgICAgIChpdGVtVHJhbnNhY3Rpb24sIGluZGV4KSA9PiB7XG4gICAgICAgICAgcmV0dXJuIGl0ZW1UcmFuc2FjdGlvbi5wYXltZW50VHJhbnNhY3Rpb25JZCA9PT0gcGF5bWVudFRyYW5zYWN0aW9uSWQ7XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBSZWZ1bmRQYXltZW50cy5yZWZ1bmRQYXltZW50KHtcbiAgICAgICAgbG9jYWxlOiByZXEudXNlcj8ubG9jYWxlLFxuICAgICAgICBjb252ZXJzYXRpb25JZDogaWQoKSxcbiAgICAgICAgcGF5bWVudFRyYW5zYWN0aW9uSWQ6IGN1cnJlbnRJdGVtVHJhbnNhY3Rpb24/LnBheW1lbnRUcmFuc2FjdGlvbklkLFxuICAgICAgICBwcmljZTogcmVxLmJvZHk/LnJlZnVuZFByaWNlIHx8IGN1cnJlbnRJdGVtVHJhbnNhY3Rpb24/LnBhaWRQcmljZSxcbiAgICAgICAgY3VycmVuY3k6IEl5emlwYXkuQ1VSUkVOQ1kuVFJZLFxuICAgICAgICBpcDogcmVxLnVzZXI/LmlwLFxuICAgICAgICAuLi5yZWFzb25PYmosXG4gICAgICB9KTtcbiAgICAgIHJlcy5qc29uKHJlc3VsdCk7XG4gICAgfVxuICApO1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsU0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsUUFBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsY0FBQSxHQUFBRixPQUFBO0FBQ0EsSUFBQUcsY0FBQSxHQUFBQyx1QkFBQSxDQUFBSixPQUFBO0FBQ0EsSUFBQUssS0FBQSxHQUFBTixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQU0sUUFBQSxHQUFBUCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQU8sZUFBQSxHQUFBUixzQkFBQSxDQUFBQyxPQUFBO0FBQW1ELFNBQUFRLHlCQUFBQyxDQUFBLDZCQUFBQyxPQUFBLG1CQUFBQyxDQUFBLE9BQUFELE9BQUEsSUFBQUUsQ0FBQSxPQUFBRixPQUFBLFlBQUFGLHdCQUFBLFlBQUFBLENBQUFDLENBQUEsV0FBQUEsQ0FBQSxHQUFBRyxDQUFBLEdBQUFELENBQUEsS0FBQUYsQ0FBQTtBQUFBLFNBQUFMLHdCQUFBSyxDQUFBLEVBQUFFLENBQUEs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","map":{"version":3,"names":["_ApiError","_interopRequireDefault","require","_Session","_RequiredCheck","RefundPayments","_interopRequireWildcard","_uuid","_iyzipay","_paymentSuccess","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","reasonEnum","_default","router","post","Session","req","res","paymentTransactionId","params","reasonObj","reason","description","body","checkRequiredField","includes","ApiError","payment","PaymentSuccess","findOne","currentItemTransaction","itemTransactions","find","itemTransaction","index","result","refundPayment","locale","user","conversationId","id","price","refundPrice","paidPrice","currency","Iyzipay","CURRENCY","TRY","ip","json","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["refund-payments.js"],"sourcesContent":["import ApiError from \"../errors/ApiError\";\nimport Session from \"../middlewares/Session\";\nimport { checkRequiredField } from \"../helpers/RequiredCheck\";\nimport * as RefundPayments from \"../services/iyzico/methods/refund_payments\";\nimport id from \"../utils/uuid\";\nimport Iyzipay from \"iyzipay\";\nimport PaymentSuccess from \"../db/payment-success\";\n\nconst reasonEnum = [\"double_payment\", \"buyer_request\", \"fraud\", \"other\"];\n\nexport default (router) => {\n  router.post(\n    \"/payments/:paymentTransactionId/refund\",\n    Session,\n    async (req, res) => {\n      const { paymentTransactionId } = req.params;\n      const reasonObj = {};\n      const { reason, description } = req.body;\n      // if (!paymentTransactionId) {\n      //   throw new ApiError(\n      //     \"PaymentTransactionId is required\",\n      //     400,\n      //     \"paymentTransactionRequired\"\n      //   );\n      // }\n      checkRequiredField(paymentTransactionId, \"PaymentTransactionId\");\n\n      if (reason && description) {\n        if (!reasonEnum.includes(reason)) {\n          throw new ApiError(\n            \"Invalid canlcel payment reason\",\n            400,\n            \"invalidCancelPaymentReason\"\n          );\n        }\n        reasonObj.reason = reason;\n        reasonObj.description = description;\n      }\n\n      const payment = await PaymentSuccess.findOne({\n        \"itemTransactions.paymentTransactionId\": paymentTransactionId,\n      });\n      //saat sınırı koy kısmi iptal için\n\n      const currentItemTransaction = payment.itemTransactions.find(\n        (itemTransaction, index) => {\n          return itemTransaction.paymentTransactionId === paymentTransactionId;\n        }\n      );\n      const result = await RefundPayments.refundPayment({\n        locale: req.user?.locale,\n        conversationId: id(),\n        paymentTransactionId: currentItemTransaction?.paymentTransactionId,\n        price: req.body?.refundPrice || currentItemTransaction?.paidPrice,\n        currency: Iyzipay.CURRENCY.TRY,\n        ip: req.user?.ip,\n        ...reasonObj,\n      });\n      res.json(result);\n    }\n  );\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1728656313930},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/refund_payments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.refundPayment = void 0;\nvar _iyzipay = _interopRequireDefault(require(\"../connection/iyzipay\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst refundPayment = data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.refund.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.refundPayment = refundPayment;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaXl6aXBheSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwicmVmdW5kUGF5bWVudCIsImRhdGEiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIml5emlwYXkiLCJyZWZ1bmQiLCJjcmVhdGUiLCJlcnIiLCJyZXN1bHQiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvc2VydmljZXMvaXl6aWNvL21ldGhvZHMvIiwic291cmNlcyI6WyJyZWZ1bmRfcGF5bWVudHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGl5emlwYXkgZnJvbSBcIi4uL2Nvbm5lY3Rpb24vaXl6aXBheVwiO1xuXG5leHBvcnQgY29uc3QgcmVmdW5kUGF5bWVudCA9IChkYXRhKSA9PiB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgaXl6aXBheS5yZWZ1bmQuY3JlYXRlKGRhdGEsIChlcnIsIHJlc3VsdCkgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxRQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFBNEMsU0FBQUQsdUJBQUFFLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFckMsTUFBTUcsYUFBYSxHQUFJQyxJQUFJLElBQUs7RUFDckMsT0FBTyxJQUFJQyxPQUFPLENBQUMsQ0FBQ0MsT0FBTyxFQUFFQyxNQUFNLEtBQUs7SUFDdENDLGdCQUFPLENBQUNDLE1BQU0sQ0FBQ0MsTUFBTSxDQUFDTixJQUFJLEVBQUUsQ0FBQ08sR0FBRyxFQUFFQyxNQUFNLEtBQUs7TUFDM0MsSUFBSUQsR0FBRyxFQUFFO1FBQ1BKLE1BQU0sQ0FBQ0ksR0FBRyxDQUFDO01BQ2IsQ0FBQyxNQUFNO1FBQ0xMLE9BQU8sQ0FBQ00sTUFBTSxDQUFDO01BQ2pCO0lBQ0YsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUFDQyxPQUFBLENBQUFWLGFBQUEsR0FBQUEsYUFBQSIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_iyzipay","_interopRequireDefault","require","e","__esModule","default","refundPayment","data","Promise","resolve","reject","iyzipay","refund","create","err","result","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/","sources":["refund_payments.js"],"sourcesContent":["import iyzipay from \"../connection/iyzipay\";\n\nexport const refundPayment = (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.refund.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA4C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAErC,MAAMG,aAAa,GAAIC,IAAI,IAAK;EACrC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,MAAM,CAACC,MAAM,CAACN,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MAC3C,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAV,aAAA,GAAAA,aAAA","ignoreList":[]}},"mtime":1723543937125},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/checkouts.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _moment = _interopRequireDefault(require(\"moment\"));\nvar _iyzipay = _interopRequireDefault(require(\"iyzipay\"));\nvar _cart = _interopRequireDefault(require(\"../db/cart\"));\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nvar Checkout = _interopRequireWildcard(require(\"../services/iyzico/methods/checkouts\"));\nvar Cards = _interopRequireWildcard(require(\"../services/iyzico/methods/cards\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nvar _payments = require(\"../utils/payments\");\nvar _OrderCompleteMail = _interopRequireDefault(require(\"../middlewares/OrderCompleteMail\"));\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function (e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = router => {\n  //Checkout from complete payment\n\n  router.post(\"/checkout/complete/payment\", async (req, res) => {\n    let result = await Checkout.getForPayment({\n      locale: \"tr\",\n      conversationId: (0, _uuid.default)(),\n      token: req.body.token\n    });\n    await (0, _payments.CompletePayment)(result);\n    res.json(result);\n  });\n\n  //CHECKOUT FORM İNİTİALİZE\n  router.post(\"/checkout/:cartId\", _Session.default, async (req, res, next) => {\n    if (!req.user?.cardUserKey) {\n      throw new _ApiError.default(\"No registered card available\", 400, \"cardUserKeyRequired\");\n    }\n    if (!req.params?.cartId) {\n      throw new _ApiError.default(\"CartID is required\", 400, \"cartIdRequired\");\n    }\n    const cart = await _cart.default.findOne({\n      _id: req.params?.cartId\n    }).populate(\"buyer\").populate(\"products\");\n    if (!cart) {\n      throw new _ApiError.default(\"Card not found\", 404, \"cardNotFound\");\n    }\n    if (cart?.completed) {\n      throw new _ApiError.default(\"Cart is completed\", 400, \"cartCompleted\");\n    }\n    const paidPrice = cart.products.map(product => product.price).reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n    const data = {\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      price: paidPrice,\n      paidPrice: paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      installments: \"1\",\n      basketId: String(cart?._id),\n      paymentChannel: _iyzipay.default.PAYMENT_CHANNEL.WEB,\n      paymentGroup: _iyzipay.default.PAYMENT_GROUP.PRODUCT,\n      enabledInstallments: [1, 2, 3, 4, 6, 9],\n      callbackUrl: `${process.env.END_POINT}/checkout/complete/payment`,\n      ...(req.user?.cardUserKey && {\n        cardUserKey: req.user?.cardUserKey\n      }),\n      buyer: {\n        id: String(req.user._id),\n        name: req.user?.name,\n        surname: req.user?.surname,\n        gsmNumber: req.user?.phoneNumber,\n        email: req.user?.email,\n        identityNumber: req.user?.identityNumber,\n        lastLoginDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        //iyizpay tarih formatına çevirmek için yapıldı\n        registrationDate: (0, _moment.default)(req.user?.updatedAt).format(\"YYYY-MM-DD HH:mm:ss\"),\n        registrationAddress: req.user?.address,\n        ip: req.user?.ip,\n        city: req.user?.city,\n        country: req.user?.country,\n        zipCode: req.user?.zipCode\n      },\n      shippingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      billingAddress: {\n        contactName: req.user?.name + \"\" + req.user?.surname,\n        city: req.user?.city,\n        country: req.user?.country,\n        address: req.user?.address,\n        zipCode: req.user?.zipCode\n      },\n      basketItems: cart.products.map((product, index) => {\n        return {\n          id: String(product?._id),\n          name: product?.name,\n          category1: product.categories[0],\n          category2: product.categories[1],\n          itemType: _iyzipay.default.BASKET_ITEM_TYPE[product?.itemType],\n          price: product?.price\n        };\n      })\n    };\n    try {\n      let result = await Checkout.initialize(data);\n      const html = `<!DOCTYPE html>\n    <html>\n    <head>\n    <title>Ödeme yap</title>\n    <meta charset=\"UTF-8\"/>\n    ${result?.checkoutFormContent}\n    </head>\n    </html>`;\n      res.send(html);\n      next();\n    } catch (error) {\n      next(error);\n    }\n  }, _OrderCompleteMail.default, (req, res) => {\n    return res.status(200).json(`${req.user.email} mail adresine sipariş detayı gönderilmiştir.`);\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9tZW50IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfaXl6aXBheSIsIl9jYXJ0IiwiX3VzZXJzIiwiX0FwaUVycm9yIiwiX1Nlc3Npb24iLCJDaGVja291dCIsIl9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkIiwiQ2FyZHMiLCJfdXVpZCIsIl9wYXltZW50cyIsIl9PcmRlckNvbXBsZXRlTWFpbCIsIl9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSIsImUiLCJXZWFrTWFwIiwiciIsInQiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImhhcyIsImdldCIsIm4iLCJfX3Byb3RvX18iLCJhIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJ1IiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiaSIsInNldCIsIl9kZWZhdWx0Iiwicm91dGVyIiwicG9zdCIsInJlcSIsInJlcyIsInJlc3VsdCIsImdldEZvclBheW1lbnQiLCJsb2NhbGUiLCJjb252ZXJzYXRpb25JZCIsImlkIiwidG9rZW4iLCJib2R5IiwiQ29tcGxldGVQYXltZW50IiwianNvbiIsIlNlc3Npb24iLCJuZXh0IiwidXNlciIsImNhcmRVc2VyS2V5IiwiQXBpRXJyb3IiLCJwYXJhbXMiLCJjYXJ0SWQiLCJjYXJ0IiwiQ2FydHMiLCJmaW5kT25lIiwiX2lkIiwicG9wdWxhdGUiLCJjb21wbGV0ZWQiLCJwYWlkUHJpY2UiLCJwcm9kdWN0cyIsIm1hcCIsInByb2R1Y3QiLCJwcmljZSIsInJlZHVjZSIsImIiLCJkYXRhIiwiY3VycmVuY3kiLCJJeXppcGF5IiwiQ1VSUkVOQ1kiLCJUUlkiLCJpbnN0YWxsbWVudHMiLCJiYXNrZXRJZCIsIlN0cmluZyIsInBheW1lbnRDaGFubmVsIiwiUEFZTUVOVF9DSEFOTkVMIiwiV0VCIiwicGF5bWVudEdyb3VwIiwiUEFZTUVOVF9HUk9VUCIsIlBST0RVQ1QiLCJlbmFibGVkSW5zdGFsbG1lbnRzIiwiY2FsbGJhY2tVcmwiLCJwcm9jZXNzIiwiZW52IiwiRU5EX1BPSU5UIiwiYnV5ZXIiLCJuYW1lIiwic3VybmFtZSIsImdzbU51bWJlciIsInBob25lTnVtYmVyIiwiZW1haWwiLCJpZGVudGl0eU51bWJlciIsImxhc3RMb2dpbkRhdGUiLCJtb21lbnQiLCJ1cGRhdGVkQXQiLCJmb3JtYXQiLCJyZWdpc3RyYXRpb25EYXRlIiwicmVnaXN0cmF0aW9uQWRkcmVzcyIsImFkZHJlc3MiLCJpcCIsImNpdHkiLCJjb3VudHJ5IiwiemlwQ29kZSIsInNoaXBwaW5nQWRkcmVzcyIsImNvbnRhY3ROYW1lIiwiYmlsbGluZ0FkZHJlc3MiLCJiYXNrZXRJdGVtcyIsImluZGV4IiwiY2F0ZWdvcnkxIiwiY2F0ZWdvcmllcyIsImNhdGVnb3J5MiIsIml0ZW1UeXBlIiwiQkFTS0VUX0lURU1fVFlQRSIsImluaXRpYWxpemUiLCJodG1sIiwiY2hlY2tvdXRGb3JtQ29udGVudCIsInNlbmQiLCJlcnJvciIsIk9yZGVyQ29tcGxldGVNYWlsIiwic3RhdHVzIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3JvdXRlcy8iLCJzb3VyY2VzIjpbImNoZWNrb3V0cy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbW9tZW50IGZyb20gXCJtb21lbnRcIjtcbmltcG9ydCBJeXppcGF5IGZyb20gXCJpeXppcGF5XCI7XG5pbXBvcnQgQ2FydHMgZnJvbSBcIi4uL2RiL2NhcnRcIjtcbmltcG9ydCBVc2VycyBmcm9tIFwiLi4vZGIvdXNlcnNcIjtcbmltcG9ydCBBcGlFcnJvciBmcm9tIFwiLi4vZXJyb3JzL0FwaUVycm9yXCI7XG5pbXBvcnQgU2Vzc2lvbiBmcm9tIFwiLi4vbWlkZGxld2FyZXMvU2Vzc2lvblwiO1xuaW1wb3J0ICogYXMgQ2hlY2tvdXQgZnJvbSBcIi4uL3NlcnZpY2VzL2l5emljby9tZXRob2RzL2NoZWNrb3V0c1wiO1xuaW1wb3J0ICogYXMgQ2FyZHMgZnJvbSBcIi4uL3NlcnZpY2VzL2l5emljby9tZXRob2RzL2NhcmRzXCI7XG5pbXBvcnQgaWQgZnJvbSBcIi4uL3V0aWxzL3V1aWRcIjtcbmltcG9ydCB7IENvbXBsZXRlUGF5bWVudCB9IGZyb20gXCIuLi91dGlscy9wYXltZW50c1wiO1xuaW1wb3J0IE9yZGVyQ29tcGxldGVNYWlsIGZyb20gXCIuLi9taWRkbGV3YXJlcy9PcmRlckNvbXBsZXRlTWFpbFwiO1xuXG5leHBvcnQgZGVmYXVsdCAocm91dGVyKSA9PiB7XG4gIC8vQ2hlY2tvdXQgZnJvbSBjb21wbGV0ZSBwYXltZW50XG5cbiAgcm91dGVyLnBvc3QoXCIvY2hlY2tvdXQvY29tcGxldGUvcGF5bWVudFwiLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICBsZXQgcmVzdWx0ID0gYXdhaXQgQ2hlY2tvdXQuZ2V0Rm9yUGF5bWVudCh7XG4gICAgICBsb2NhbGU6IFwidHJcIixcbiAgICAgIGNvbnZlcnNhdGlvbklkOiBpZCgpLFxuICAgICAgdG9rZW46IHJlcS5ib2R5LnRva2VuLFxuICAgIH0pO1xuICAgIGF3YWl0IENvbXBsZXRlUGF5bWVudChyZXN1bHQpO1xuICAgIHJlcy5qc29uKHJlc3VsdCk7XG4gIH0pO1xuXG4gIC8vQ0hFQ0tPVVQgRk9STSDEsE7EsFTEsEFMxLBaRVxuICByb3V0ZXIucG9zdChcbiAgICBcIi9jaGVja291dC86Y2FydElkXCIsXG4gICAgU2Vzc2lvbixcbiAgICBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICAgIGlmICghcmVxLnVzZXI/LmNhcmRVc2VyS2V5KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgICBcIk5vIHJlZ2lzdGVyZWQgY2FyZCBhdmFpbGFibGVcIixcbiAgICAgICAgICA0MDAsXG4gICAgICAgICAgXCJjYXJkVXNlcktleVJlcXVpcmVkXCJcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCFyZXEucGFyYW1zPy5jYXJ0SWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FydElEIGlzIHJlcXVpcmVkXCIsIDQwMCwgXCJjYXJ0SWRSZXF1aXJlZFwiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGNhcnQgPSBhd2FpdCBDYXJ0cy5maW5kT25lKHsgX2lkOiByZXEucGFyYW1zPy5jYXJ0SWQgfSlcbiAgICAgICAgLnBvcHVsYXRlKFwiYnV5ZXJcIilcbiAgICAgICAgLnBvcHVsYXRlKFwicHJvZHVjdHNcIik7XG4gICAgICBpZiAoIWNhcnQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FyZCBub3QgZm91bmRcIiwgNDA0LCBcImNhcmROb3RGb3VuZFwiKTtcbiAgICAgIH1cbiAgICAgIGlmIChjYXJ0Py5jb21wbGV0ZWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiQ2FydCBpcyBjb21wbGV0ZWRcIiwgNDAwLCBcImNhcnRDb21wbGV0ZWRcIik7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHBhaWRQcmljZSA9IGNhcnQucHJvZHVjdHNcbiAgICAgICAgLm1hcCgocHJvZHVjdCkgPT4gcHJvZHVjdC5wcmljZSlcbiAgICAgICAgLnJlZHVjZSgoYSwgYikgPT4gYSArIGIsIDApOyAvL8O2ZGVuZWNlayBtaWt0YXJsYXLEsW4gdG9wbGFtxLFcblxuICAgICAgY29uc3QgZGF0YSA9IHtcbiAgICAgICAgbG9jYWxlOiByZXEudXNlci5sb2NhbGUsXG4gICAgICAgIGNvbnZlcnNhdGlvbklkOiBpZCgpLFxuICAgICAgICBwcmljZTogcGFpZFByaWNlLFxuICAgICAgICBwYWlkUHJpY2U6IHBhaWRQcmljZSxcbiAgICAgICAgY3VycmVuY3k6IEl5emlwYXkuQ1VSUkVOQ1kuVFJZLFxuICAgICAgICBpbnN0YWxsbWVudHM6IFwiMVwiLFxuICAgICAgICBiYXNrZXRJZDogU3RyaW5nKGNhcnQ/Ll9pZCksXG4gICAgICAgIHBheW1lbnRDaGFubmVsOiBJeXppcGF5LlBBWU1FTlRfQ0hBTk5FTC5XRUIsXG4gICAgICAgIHBheW1lbnRHcm91cDogSXl6aXBheS5QQVlNRU5UX0dST1VQLlBST0RVQ1QsXG4gICAgICAgIGVuYWJsZWRJbnN0YWxsbWVudHM6IFsxLCAyLCAzLCA0LCA2LCA5XSxcbiAgICAgICAgY2FsbGJhY2tVcmw6IGAke3Byb2Nlc3MuZW52LkVORF9QT0lOVH0vY2hlY2tvdXQvY29tcGxldGUvcGF5bWVudGAsXG4gICAgICAgIC4uLihyZXEudXNlcj8uY2FyZFVzZXJLZXkgJiYge1xuICAgICAgICAgIGNhcmRVc2VyS2V5OiByZXEudXNlcj8uY2FyZFVzZXJLZXksXG4gICAgICAgIH0pLFxuICAgICAgICBidXllcjoge1xuICAgICAgICAgIGlkOiBTdHJpbmcocmVxLnVzZXIuX2lkKSxcbiAgICAgICAgICBuYW1lOiByZXEudXNlcj8ubmFtZSxcbiAgICAgICAgICBzdXJuYW1lOiByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBnc21OdW1iZXI6IHJlcS51c2VyPy5waG9uZU51bWJlcixcbiAgICAgICAgICBlbWFpbDogcmVxLnVzZXI/LmVtYWlsLFxuICAgICAgICAgIGlkZW50aXR5TnVtYmVyOiByZXEudXNlcj8uaWRlbnRpdHlOdW1iZXIsXG4gICAgICAgICAgbGFzdExvZ2luRGF0ZTogbW9tZW50KHJlcS51c2VyPy51cGRhdGVkQXQpLmZvcm1hdChcbiAgICAgICAgICAgIFwiWVlZWS1NTS1ERCBISDptbTpzc1wiXG4gICAgICAgICAgKSwgLy9peWl6cGF5IHRhcmloIGZvcm1hdMSxbmEgw6dldmlybWVrIGnDp2luIHlhcMSxbGTEsVxuICAgICAgICAgIHJlZ2lzdHJhdGlvbkRhdGU6IG1vbWVudChyZXEudXNlcj8udXBkYXRlZEF0KS5mb3JtYXQoXG4gICAgICAgICAgICBcIllZWVktTU0tREQgSEg6bW06c3NcIlxuICAgICAgICAgICksXG4gICAgICAgICAgcmVnaXN0cmF0aW9uQWRkcmVzczogcmVxLnVzZXI/LmFkZHJlc3MsXG4gICAgICAgICAgaXA6IHJlcS51c2VyPy5pcCxcbiAgICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgICAgfSxcbiAgICAgICAgc2hpcHBpbmdBZGRyZXNzOiB7XG4gICAgICAgICAgY29udGFjdE5hbWU6IHJlcS51c2VyPy5uYW1lICsgXCJcIiArIHJlcS51c2VyPy5zdXJuYW1lLFxuICAgICAgICAgIGNpdHk6IHJlcS51c2VyPy5jaXR5LFxuICAgICAgICAgIGNvdW50cnk6IHJlcS51c2VyPy5jb3VudHJ5LFxuICAgICAgICAgIGFkZHJlc3M6IHJlcS51c2VyPy5hZGRyZXNzLFxuICAgICAgICAgIHppcENvZGU6IHJlcS51c2VyPy56aXBDb2RlLFxuICAgICAgICB9LFxuICAgICAgICBiaWxsaW5nQWRkcmVzczoge1xuICAgICAgICAgIGNvbnRhY3ROYW1lOiByZXEudXNlcj8ubmFtZSArIFwiXCIgKyByZXEudXNlcj8uc3VybmFtZSxcbiAgICAgICAgICBjaXR5OiByZXEudXNlcj8uY2l0eSxcbiAgICAgICAgICBjb3VudHJ5OiByZXEudXNlcj8uY291bnRyeSxcbiAgICAgICAgICBhZGRyZXNzOiByZXEudXNlcj8uYWRkcmVzcyxcbiAgICAgICAgICB6aXBDb2RlOiByZXEudXNlcj8uemlwQ29kZSxcbiAgICAgICAgfSxcbiAgICAgICAgYmFza2V0SXRlbXM6IGNhcnQucHJvZHVjdHMubWFwKChwcm9kdWN0LCBpbmRleCkgPT4ge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBpZDogU3RyaW5nKHByb2R1Y3Q/Ll9pZCksXG4gICAgICAgICAgICBuYW1lOiBwcm9kdWN0Py5uYW1lLFxuICAgICAgICAgICAgY2F0ZWdvcnkxOiBwcm9kdWN0LmNhdGVnb3JpZXNbMF0sXG4gICAgICAgICAgICBjYXRlZ29yeTI6IHByb2R1Y3QuY2F0ZWdvcmllc1sxXSxcbiAgICAgICAgICAgIGl0ZW1UeXBlOiBJeXppcGF5LkJBU0tFVF9JVEVNX1RZUEVbcHJvZHVjdD8uaXRlbVR5cGVdLFxuICAgICAgICAgICAgcHJpY2U6IHByb2R1Y3Q/LnByaWNlLFxuICAgICAgICAgIH07XG4gICAgICAgIH0pLFxuICAgICAgfTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgbGV0IHJlc3VsdCA9IGF3YWl0IENoZWNrb3V0LmluaXRpYWxpemUoZGF0YSk7XG4gICAgICAgIGNvbnN0IGh0bWwgPSBgPCFET0NUWVBFIGh0bWw+XG4gICAgPGh0bWw+XG4gICAgPGhlYWQ+XG4gICAgPHRpdGxlPsOWZGVtZSB5YXA8L3RpdGxlPlxuICAgIDxtZXRhIGNoYXJzZXQ9XCJVVEYtOFwiLz5cbiAgICAke3Jlc3VsdD8uY2hlY2tvdXRGb3JtQ29udGVudH1cbiAgICA8L2hlYWQ+XG4gICAgPC9odG1sPmA7XG4gICAgICAgIHJlcy5zZW5kKGh0bWwpO1xuICAgICAgICBuZXh0KCk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBuZXh0KGVycm9yKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIE9yZGVyQ29tcGxldGVNYWlsLFxuICAgIChyZXEsIHJlcykgPT4ge1xuICAgICAgcmV0dXJuIHJlc1xuICAgICAgICAuc3RhdHVzKDIwMClcbiAgICAgICAgLmpzb24oYCR7cmVxLnVzZXIuZW1haWx9IG1haWwgYWRyZXNpbmUgc2lwYXJpxZ8gZGV0YXnEsSBnw7ZuZGVyaWxtacWfdGlyLmApO1xuICAgIH1cbiAgKTtcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLE9BQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFFBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLEtBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFHLE1BQUEsR0FBQUosc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFJLFNBQUEs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","map":{"version":3,"names":["_moment","_interopRequireDefault","require","_iyzipay","_cart","_users","_ApiError","_Session","Checkout","_interopRequireWildcard","Cards","_uuid","_payments","_OrderCompleteMail","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","_default","router","post","req","res","result","getForPayment","locale","conversationId","id","token","body","CompletePayment","json","Session","next","user","cardUserKey","ApiError","params","cartId","cart","Carts","findOne","_id","populate","completed","paidPrice","products","map","product","price","reduce","b","data","currency","Iyzipay","CURRENCY","TRY","installments","basketId","String","paymentChannel","PAYMENT_CHANNEL","WEB","paymentGroup","PAYMENT_GROUP","PRODUCT","enabledInstallments","callbackUrl","process","env","END_POINT","buyer","name","surname","gsmNumber","phoneNumber","email","identityNumber","lastLoginDate","moment","updatedAt","format","registrationDate","registrationAddress","address","ip","city","country","zipCode","shippingAddress","contactName","billingAddress","basketItems","index","category1","categories","category2","itemType","BASKET_ITEM_TYPE","initialize","html","checkoutFormContent","send","error","OrderCompleteMail","status","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["checkouts.js"],"sourcesContent":["import moment from \"moment\";\nimport Iyzipay from \"iyzipay\";\nimport Carts from \"../db/cart\";\nimport Users from \"../db/users\";\nimport ApiError from \"../errors/ApiError\";\nimport Session from \"../middlewares/Session\";\nimport * as Checkout from \"../services/iyzico/methods/checkouts\";\nimport * as Cards from \"../services/iyzico/methods/cards\";\nimport id from \"../utils/uuid\";\nimport { CompletePayment } from \"../utils/payments\";\nimport OrderCompleteMail from \"../middlewares/OrderCompleteMail\";\n\nexport default (router) => {\n  //Checkout from complete payment\n\n  router.post(\"/checkout/complete/payment\", async (req, res) => {\n    let result = await Checkout.getForPayment({\n      locale: \"tr\",\n      conversationId: id(),\n      token: req.body.token,\n    });\n    await CompletePayment(result);\n    res.json(result);\n  });\n\n  //CHECKOUT FORM İNİTİALİZE\n  router.post(\n    \"/checkout/:cartId\",\n    Session,\n    async (req, res, next) => {\n      if (!req.user?.cardUserKey) {\n        throw new ApiError(\n          \"No registered card available\",\n          400,\n          \"cardUserKeyRequired\"\n        );\n      }\n\n      if (!req.params?.cartId) {\n        throw new ApiError(\"CartID is required\", 400, \"cartIdRequired\");\n      }\n      const cart = await Carts.findOne({ _id: req.params?.cartId })\n        .populate(\"buyer\")\n        .populate(\"products\");\n      if (!cart) {\n        throw new ApiError(\"Card not found\", 404, \"cardNotFound\");\n      }\n      if (cart?.completed) {\n        throw new ApiError(\"Cart is completed\", 400, \"cartCompleted\");\n      }\n\n      const paidPrice = cart.products\n        .map((product) => product.price)\n        .reduce((a, b) => a + b, 0); //ödenecek miktarların toplamı\n\n      const data = {\n        locale: req.user.locale,\n        conversationId: id(),\n        price: paidPrice,\n        paidPrice: paidPrice,\n        currency: Iyzipay.CURRENCY.TRY,\n        installments: \"1\",\n        basketId: String(cart?._id),\n        paymentChannel: Iyzipay.PAYMENT_CHANNEL.WEB,\n        paymentGroup: Iyzipay.PAYMENT_GROUP.PRODUCT,\n        enabledInstallments: [1, 2, 3, 4, 6, 9],\n        callbackUrl: `${process.env.END_POINT}/checkout/complete/payment`,\n        ...(req.user?.cardUserKey && {\n          cardUserKey: req.user?.cardUserKey,\n        }),\n        buyer: {\n          id: String(req.user._id),\n          name: req.user?.name,\n          surname: req.user?.surname,\n          gsmNumber: req.user?.phoneNumber,\n          email: req.user?.email,\n          identityNumber: req.user?.identityNumber,\n          lastLoginDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ), //iyizpay tarih formatına çevirmek için yapıldı\n          registrationDate: moment(req.user?.updatedAt).format(\n            \"YYYY-MM-DD HH:mm:ss\"\n          ),\n          registrationAddress: req.user?.address,\n          ip: req.user?.ip,\n          city: req.user?.city,\n          country: req.user?.country,\n          zipCode: req.user?.zipCode,\n        },\n        shippingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        billingAddress: {\n          contactName: req.user?.name + \"\" + req.user?.surname,\n          city: req.user?.city,\n          country: req.user?.country,\n          address: req.user?.address,\n          zipCode: req.user?.zipCode,\n        },\n        basketItems: cart.products.map((product, index) => {\n          return {\n            id: String(product?._id),\n            name: product?.name,\n            category1: product.categories[0],\n            category2: product.categories[1],\n            itemType: Iyzipay.BASKET_ITEM_TYPE[product?.itemType],\n            price: product?.price,\n          };\n        }),\n      };\n\n      try {\n        let result = await Checkout.initialize(data);\n        const html = `<!DOCTYPE html>\n    <html>\n    <head>\n    <title>Ödeme yap</title>\n    <meta charset=\"UTF-8\"/>\n    ${result?.checkoutFormContent}\n    </head>\n    </html>`;\n        res.send(html);\n        next();\n      } catch (error) {\n        next(error);\n      }\n    },\n    OrderCompleteMail,\n    (req, res) => {\n      return res\n        .status(200)\n        .json(`${req.user.email} mail adresine sipariş detayı gönderilmiştir.`);\n    }\n  );\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1724323812541},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/checkouts.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.initialize = exports.getForPayment = void 0;\nvar _iyzipay = _interopRequireDefault(require(\"../connection/iyzipay\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst initialize = data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.checkoutFormInitialize.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.initialize = initialize;\nconst getForPayment = data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.checkoutForm.retrieve(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.getForPayment = getForPayment;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaXl6aXBheSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiaW5pdGlhbGl6ZSIsImRhdGEiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIml5emlwYXkiLCJjaGVja291dEZvcm1Jbml0aWFsaXplIiwiY3JlYXRlIiwiZXJyIiwicmVzdWx0IiwiZXhwb3J0cyIsImdldEZvclBheW1lbnQiLCJjaGVja291dEZvcm0iLCJyZXRyaWV2ZSJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3NlcnZpY2VzL2l5emljby9tZXRob2RzLyIsInNvdXJjZXMiOlsiY2hlY2tvdXRzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBpeXppcGF5IGZyb20gXCIuLi9jb25uZWN0aW9uL2l5emlwYXlcIjtcblxuZXhwb3J0IGNvbnN0IGluaXRpYWxpemUgPSAoZGF0YSkgPT4ge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGl5emlwYXkuY2hlY2tvdXRGb3JtSW5pdGlhbGl6ZS5jcmVhdGUoZGF0YSwgKGVyciwgcmVzdWx0KSA9PiB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIHJlamVjdChlcnIpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRGb3JQYXltZW50ID0gKGRhdGEpID0+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBpeXppcGF5LmNoZWNrb3V0Rm9ybS5yZXRyaWV2ZShkYXRhLCAoZXJyLCByZXN1bHQpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsUUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQTRDLFNBQUFELHVCQUFBRSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBRXJDLE1BQU1HLFVBQVUsR0FBSUMsSUFBSSxJQUFLO0VBQ2xDLE9BQU8sSUFBSUMsT0FBTyxDQUFDLENBQUNDLE9BQU8sRUFBRUMsTUFBTSxLQUFLO0lBQ3RDQyxnQkFBTyxDQUFDQyxzQkFBc0IsQ0FBQ0MsTUFBTSxDQUFDTixJQUFJLEVBQUUsQ0FBQ08sR0FBRyxFQUFFQyxNQUFNLEtBQUs7TUFDM0QsSUFBSUQsR0FBRyxFQUFFO1FBQ1BKLE1BQU0sQ0FBQ0ksR0FBRyxDQUFDO01BQ2IsQ0FBQyxNQUFNO1FBQ0xMLE9BQU8sQ0FBQ00sTUFBTSxDQUFDO01BQ2pCO0lBQ0YsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUFDQyxPQUFBLENBQUFWLFVBQUEsR0FBQUEsVUFBQTtBQUVLLE1BQU1XLGFBQWEsR0FBSVYsSUFBSSxJQUFLO0VBQ3JDLE9BQU8sSUFBSUMsT0FBTyxDQUFDLENBQUNDLE9BQU8sRUFBRUMsTUFBTSxLQUFLO0lBQ3RDQyxnQkFBTyxDQUFDTyxZQUFZLENBQUNDLFFBQVEsQ0FBQ1osSUFBSSxFQUFFLENBQUNPLEdBQUcsRUFBRUMsTUFBTSxLQUFLO01BQ25ELElBQUlELEdBQUcsRUFBRTtRQUNQSixNQUFNLENBQUNJLEdBQUcsQ0FBQztNQUNiLENBQUMsTUFBTTtRQUNMTCxPQUFPLENBQUNNLE1BQU0sQ0FBQztNQUNqQjtJQUNGLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztBQUNKLENBQUM7QUFBQ0MsT0FBQSxDQUFBQyxhQUFBLEdBQUFBLGFBQUEiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_iyzipay","_interopRequireDefault","require","e","__esModule","default","initialize","data","Promise","resolve","reject","iyzipay","checkoutFormInitialize","create","err","result","exports","getForPayment","checkoutForm","retrieve"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/","sources":["checkouts.js"],"sourcesContent":["import iyzipay from \"../connection/iyzipay\";\n\nexport const initialize = (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.checkoutFormInitialize.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n\nexport const getForPayment = (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.checkoutForm.retrieve(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA4C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAErC,MAAMG,UAAU,GAAIC,IAAI,IAAK;EAClC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,sBAAsB,CAACC,MAAM,CAACN,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MAC3D,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAV,UAAA,GAAAA,UAAA;AAEK,MAAMW,aAAa,GAAIV,IAAI,IAAK;EACrC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACO,YAAY,CAACC,QAAQ,CAACZ,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MACnD,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAC,aAAA,GAAAA,aAAA","ignoreList":[]}},"mtime":1723543937122},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/installments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireWildcard(require(\"mongoose\"));\nvar _moment = _interopRequireDefault(require(\"moment\"));\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nvar Installments = _interopRequireWildcard(require(\"../services/iyzico/methods/installments\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _cart = _interopRequireDefault(require(\"../db/cart\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function (e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }\nconst {\n  ObjectId\n} = _mongoose.Types;\nvar _default = router => {\n  //fiyata göre taksit kontrolü\n  router.post(\"/installments\", _Session.default, async (req, res) => {\n    const {\n      binNumber,\n      price\n    } = req.body;\n    if (!binNumber || !price) {\n      throw new _ApiError.default(\"Missing Parameters\", 400, \"missingParameters\");\n    }\n    const result = await Installments.checkInstallment({\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      binNumber: binNumber,\n      price: price\n    });\n    res.json(result);\n  });\n\n  //sepet tutarına göre taksit\n  router.post(\"/installments/:cartId\", _Session.default, async (req, res, next) => {\n    try {\n      const {\n        binNumber\n      } = req.body;\n      const {\n        cartId\n      } = req.params;\n      if (!cartId) {\n        throw new _ApiError.default(\"Cart id is required\", 400, \"cartIdRequired\");\n      }\n      const cart = await _cart.default.findOne({\n        _id: new ObjectId(cartId)\n      }).populate(\"products\", {\n        _id: 1,\n        price: 1\n      });\n      if (!cart) {\n        throw new _ApiError.default(\"Cart not found\", 404, \"cartNotFound\");\n      }\n      const price = cart.products.map(product => product.price).reduce((a, b) => a + b, 0);\n      if (!binNumber || price === undefined) {\n        throw new _ApiError.default(\"Missing parameters\", 400, \"missingParameters\");\n      }\n      const result = await Installments.checkInstallment({\n        locale: req.user.locale,\n        conversationId: (0, _uuid.default)(),\n        binNumber: binNumber,\n        price: price\n      });\n      res.json(result);\n    } catch (error) {\n      next(error);\n    }\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsInJlcXVpcmUiLCJfbW9tZW50IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIl9TZXNzaW9uIiwiX3V1aWQiLCJJbnN0YWxsbWVudHMiLCJfQXBpRXJyb3IiLCJfY2FydCIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIl9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSIsIldlYWtNYXAiLCJyIiwidCIsImhhcyIsImdldCIsIm4iLCJfX3Byb3RvX18iLCJhIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJ1IiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiaSIsInNldCIsIk9iamVjdElkIiwiVHlwZXMiLCJfZGVmYXVsdCIsInJvdXRlciIsInBvc3QiLCJTZXNzaW9uIiwicmVxIiwicmVzIiwiYmluTnVtYmVyIiwicHJpY2UiLCJib2R5IiwiQXBpRXJyb3IiLCJyZXN1bHQiLCJjaGVja0luc3RhbGxtZW50IiwibG9jYWxlIiwidXNlciIsImNvbnZlcnNhdGlvbklkIiwiaWQiLCJqc29uIiwibmV4dCIsImNhcnRJZCIsInBhcmFtcyIsImNhcnQiLCJDYXJ0cyIsImZpbmRPbmUiLCJfaWQiLCJwb3B1bGF0ZSIsInByb2R1Y3RzIiwibWFwIiwicHJvZHVjdCIsInJlZHVjZSIsImIiLCJ1bmRlZmluZWQiLCJlcnJvciIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9yb3V0ZXMvIiwic291cmNlcyI6WyJpbnN0YWxsbWVudHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVHlwZXMgfSBmcm9tIFwibW9uZ29vc2VcIjtcbmltcG9ydCBtb21lbnQgZnJvbSBcIm1vbWVudFwiO1xuaW1wb3J0IG1vbmdvb3NlIGZyb20gXCJtb25nb29zZVwiO1xuaW1wb3J0IFNlc3Npb24gZnJvbSBcIi4uL21pZGRsZXdhcmVzL1Nlc3Npb25cIjtcbmltcG9ydCBpZCBmcm9tIFwiLi4vdXRpbHMvdXVpZFwiO1xuaW1wb3J0ICogYXMgSW5zdGFsbG1lbnRzIGZyb20gXCIuLi9zZXJ2aWNlcy9peXppY28vbWV0aG9kcy9pbnN0YWxsbWVudHNcIjtcbmltcG9ydCBBcGlFcnJvciBmcm9tIFwiLi4vZXJyb3JzL0FwaUVycm9yXCI7XG5pbXBvcnQgQ2FydHMgZnJvbSBcIi4uL2RiL2NhcnRcIjtcblxuY29uc3QgeyBPYmplY3RJZCB9ID0gVHlwZXM7XG5cbmV4cG9ydCBkZWZhdWx0IChyb3V0ZXIpID0+IHtcbiAgLy9maXlhdGEgZ8O2cmUgdGFrc2l0IGtvbnRyb2zDvFxuICByb3V0ZXIucG9zdChcIi9pbnN0YWxsbWVudHNcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyBiaW5OdW1iZXIsIHByaWNlIH0gPSByZXEuYm9keTtcbiAgICBpZiAoIWJpbk51bWJlciB8fCAhcHJpY2UpIHtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIk1pc3NpbmcgUGFyYW1ldGVyc1wiLCA0MDAsIFwibWlzc2luZ1BhcmFtZXRlcnNcIik7XG4gICAgfVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IEluc3RhbGxtZW50cy5jaGVja0luc3RhbGxtZW50KHtcbiAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICBiaW5OdW1iZXI6IGJpbk51bWJlcixcbiAgICAgIHByaWNlOiBwcmljZSxcbiAgICB9KTtcbiAgICByZXMuanNvbihyZXN1bHQpO1xuICB9KTtcblxuICAvL3NlcGV0IHR1dGFyxLFuYSBnw7ZyZSB0YWtzaXRcbiAgcm91dGVyLnBvc3QoXCIvaW5zdGFsbG1lbnRzLzpjYXJ0SWRcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgYmluTnVtYmVyIH0gPSByZXEuYm9keTtcbiAgICAgIGNvbnN0IHsgY2FydElkIH0gPSByZXEucGFyYW1zO1xuXG4gICAgICBpZiAoIWNhcnRJZCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJ0IGlkIGlzIHJlcXVpcmVkXCIsIDQwMCwgXCJjYXJ0SWRSZXF1aXJlZFwiKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgY2FydCA9IGF3YWl0IENhcnRzLmZpbmRPbmUoe1xuICAgICAgICBfaWQ6IG5ldyBPYmplY3RJZChjYXJ0SWQpLFxuICAgICAgfSkucG9wdWxhdGUoXCJwcm9kdWN0c1wiLCB7XG4gICAgICAgIF9pZDogMSxcbiAgICAgICAgcHJpY2U6IDEsXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFjYXJ0KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgbm90IGZvdW5kXCIsIDQwNCwgXCJjYXJ0Tm90Rm91bmRcIik7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHByaWNlID0gY2FydC5wcm9kdWN0c1xuICAgICAgICAubWFwKChwcm9kdWN0KSA9PiBwcm9kdWN0LnByaWNlKVxuICAgICAgICAucmVkdWNlKChhLCBiKSA9PiBhICsgYiwgMCk7XG5cbiAgICAgIGlmICghYmluTnVtYmVyIHx8IHByaWNlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiTWlzc2luZyBwYXJhbWV0ZXJzXCIsIDQwMCwgXCJtaXNzaW5nUGFyYW1ldGVyc1wiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IEluc3RhbGxtZW50cy5jaGVja0luc3RhbGxtZW50KHtcbiAgICAgICAgbG9jYWxlOiByZXEudXNlci5sb2NhbGUsXG4gICAgICAgIGNvbnZlcnNhdGlvbklkOiBpZCgpLFxuICAgICAgICBiaW5OdW1iZXI6IGJpbk51bWJlcixcbiAgICAgICAgcHJpY2U6IHByaWNlLFxuICAgICAgfSk7XG4gICAgICByZXMuanNvbihyZXN1bHQpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBuZXh0KGVycm9yKTtcbiAgICB9XG4gIH0pO1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsU0FBQSxHQUFBQyx1QkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsT0FBQSxHQUFBQyxzQkFBQSxDQUFBRixPQUFBO0FBRUEsSUFBQUcsUUFBQSxHQUFBRCxzQkFBQSxDQUFBRixPQUFBO0FBQ0EsSUFBQUksS0FBQSxHQUFBRixzQkFBQSxDQUFBRixPQUFBO0FBQ0EsSUFBQUssWUFBQSxHQUFBTix1QkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQU0sU0FBQSxHQUFBSixzQkFBQSxDQUFBRixPQUFBO0FBQ0EsSUFBQU8sS0FBQSxHQUFBTCxzQkFBQSxDQUFBRixPQUFBO0FBQStCLFNBQUFFLHVCQUFBTSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBQUEsU0FBQUcseUJBQUFILENBQUEsNkJBQUFJLE9BQUEsbUJBQUFDLENBQUEsT0FBQUQsT0FBQSxJQUFBRSxDQUFBLE9BQUFGLE9BQUEsWUFBQUQsd0JBQUEsWUFBQUEsQ0FBQUgsQ0FBQSxXQUFBQSxDQUFBLEdBQUFNLENBQUEsR0FBQUQsQ0FBQSxLQUFBTCxDQUFBO0FBQUEsU0FBQVQsd0JBQUFTLENBQUEsRUFBQUssQ0FBQSxTQUFBQSxDQUFBLElBQUFMLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLFNBQUFELENBQUEsZUFBQUEsQ0FBQSx1QkFBQUEsQ0FBQSx5QkFBQUEsQ0FBQSxXQUFBRSxPQUFBLEVBQUFGLENBQUEsUUFBQU0sQ0FBQSxHQUFBSCx3QkFBQSxDQUFBRSxDQUFBLE9BQUFDLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxHQUFBLENBQUFQLENBQUEsVUFBQU0sQ0FBQSxDQUFBRSxHQUFBLENBQUFSLENBQUEsT0FBQVMsQ0FB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","map":{"version":3,"names":["_mongoose","_interopRequireWildcard","require","_moment","_interopRequireDefault","_Session","_uuid","Installments","_ApiError","_cart","e","__esModule","default","_getRequireWildcardCache","WeakMap","r","t","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","ObjectId","Types","_default","router","post","Session","req","res","binNumber","price","body","ApiError","result","checkInstallment","locale","user","conversationId","id","json","next","cartId","params","cart","Carts","findOne","_id","populate","products","map","product","reduce","b","undefined","error","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["installments.js"],"sourcesContent":["import { Types } from \"mongoose\";\nimport moment from \"moment\";\nimport mongoose from \"mongoose\";\nimport Session from \"../middlewares/Session\";\nimport id from \"../utils/uuid\";\nimport * as Installments from \"../services/iyzico/methods/installments\";\nimport ApiError from \"../errors/ApiError\";\nimport Carts from \"../db/cart\";\n\nconst { ObjectId } = Types;\n\nexport default (router) => {\n  //fiyata göre taksit kontrolü\n  router.post(\"/installments\", Session, async (req, res) => {\n    const { binNumber, price } = req.body;\n    if (!binNumber || !price) {\n      throw new ApiError(\"Missing Parameters\", 400, \"missingParameters\");\n    }\n    const result = await Installments.checkInstallment({\n      locale: req.user.locale,\n      conversationId: id(),\n      binNumber: binNumber,\n      price: price,\n    });\n    res.json(result);\n  });\n\n  //sepet tutarına göre taksit\n  router.post(\"/installments/:cartId\", Session, async (req, res, next) => {\n    try {\n      const { binNumber } = req.body;\n      const { cartId } = req.params;\n\n      if (!cartId) {\n        throw new ApiError(\"Cart id is required\", 400, \"cartIdRequired\");\n      }\n\n      const cart = await Carts.findOne({\n        _id: new ObjectId(cartId),\n      }).populate(\"products\", {\n        _id: 1,\n        price: 1,\n      });\n\n      if (!cart) {\n        throw new ApiError(\"Cart not found\", 404, \"cartNotFound\");\n      }\n\n      const price = cart.products\n        .map((product) => product.price)\n        .reduce((a, b) => a + b, 0);\n\n      if (!binNumber || price === undefined) {\n        throw new ApiError(\"Missing parameters\", 400, \"missingParameters\");\n      }\n      const result = await Installments.checkInstallment({\n        locale: req.user.locale,\n        conversationId: id(),\n        binNumber: binNumber,\n        price: price,\n      });\n      res.json(result);\n    } catch (error) {\n      next(error);\n    }\n  });\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1724323812543},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/installments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.checkInstallment = void 0;\nvar _iyzipay = _interopRequireDefault(require(\"../connection/iyzipay\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst checkInstallment = data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.installmentInfo.retrieve(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.checkInstallment = checkInstallment;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaXl6aXBheSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiY2hlY2tJbnN0YWxsbWVudCIsImRhdGEiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIml5emlwYXkiLCJpbnN0YWxsbWVudEluZm8iLCJyZXRyaWV2ZSIsImVyciIsInJlc3VsdCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9zZXJ2aWNlcy9peXppY28vbWV0aG9kcy8iLCJzb3VyY2VzIjpbImluc3RhbGxtZW50cy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgaXl6aXBheSBmcm9tIFwiLi4vY29ubmVjdGlvbi9peXppcGF5XCI7XG5cbmV4cG9ydCBjb25zdCBjaGVja0luc3RhbGxtZW50ID0gKGRhdGEpID0+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBpeXppcGF5Lmluc3RhbGxtZW50SW5mby5yZXRyaWV2ZShkYXRhLCAoZXJyLCByZXN1bHQpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsUUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQTRDLFNBQUFELHVCQUFBRSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBRXJDLE1BQU1HLGdCQUFnQixHQUFJQyxJQUFJLElBQUs7RUFDeEMsT0FBTyxJQUFJQyxPQUFPLENBQUMsQ0FBQ0MsT0FBTyxFQUFFQyxNQUFNLEtBQUs7SUFDdENDLGdCQUFPLENBQUNDLGVBQWUsQ0FBQ0MsUUFBUSxDQUFDTixJQUFJLEVBQUUsQ0FBQ08sR0FBRyxFQUFFQyxNQUFNLEtBQUs7TUFDdEQsSUFBSUQsR0FBRyxFQUFFO1FBQ1BKLE1BQU0sQ0FBQ0ksR0FBRyxDQUFDO01BQ2IsQ0FBQyxNQUFNO1FBQ0xMLE9BQU8sQ0FBQ00sTUFBTSxDQUFDO01BQ2pCO0lBQ0YsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUFDQyxPQUFBLENBQUFWLGdCQUFBLEdBQUFBLGdCQUFBIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["_iyzipay","_interopRequireDefault","require","e","__esModule","default","checkInstallment","data","Promise","resolve","reject","iyzipay","installmentInfo","retrieve","err","result","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/","sources":["installments.js"],"sourcesContent":["import iyzipay from \"../connection/iyzipay\";\n\nexport const checkInstallment = (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.installmentInfo.retrieve(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA4C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAErC,MAAMG,gBAAgB,GAAIC,IAAI,IAAK;EACxC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,eAAe,CAACC,QAAQ,CAACN,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MACtD,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAV,gBAAA,GAAAA,gBAAA","ignoreList":[]}},"mtime":1723543937123},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/refund-payments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nvar _RequiredCheck = require(\"../helpers/RequiredCheck\");\nvar RefundPayments = _interopRequireWildcard(require(\"../services/iyzico/methods/refund_payments\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nvar _iyzipay = _interopRequireDefault(require(\"iyzipay\"));\nvar _paymentSuccess = _interopRequireDefault(require(\"../db/payment-success\"));\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function (e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst reasonEnum = [\"double_payment\", \"buyer_request\", \"fraud\", \"other\"];\nvar _default = router => {\n  router.post(\"/payments/:paymentTransactionId/refund\", _Session.default, async (req, res) => {\n    const {\n      paymentTransactionId\n    } = req.params;\n    const reasonObj = {};\n    const {\n      reason,\n      description\n    } = req.body;\n    // if (!paymentTransactionId) {\n    //   throw new ApiError(\n    //     \"PaymentTransactionId is required\",\n    //     400,\n    //     \"paymentTransactionRequired\"\n    //   );\n    // }\n    (0, _RequiredCheck.checkRequiredField)(paymentTransactionId, \"PaymentTransactionId\");\n    if (reason && description) {\n      if (!reasonEnum.includes(reason)) {\n        throw new _ApiError.default(\"Invalid canlcel payment reason\", 400, \"invalidCancelPaymentReason\");\n      }\n      reasonObj.reason = reason;\n      reasonObj.description = description;\n    }\n    const payment = await _paymentSuccess.default.findOne({\n      \"itemTransactions.paymentTransactionId\": paymentTransactionId\n    });\n    //saat sınırı koy kısmi iptal için\n\n    const currentItemTransaction = payment.itemTransactions.find((itemTransaction, index) => {\n      return itemTransaction.paymentTransactionId === paymentTransactionId;\n    });\n    const result = await RefundPayments.refundPayment({\n      locale: req.user?.locale,\n      conversationId: (0, _uuid.default)(),\n      paymentTransactionId: currentItemTransaction?.paymentTransactionId,\n      price: req.body?.refundPrice || currentItemTransaction?.paidPrice,\n      currency: _iyzipay.default.CURRENCY.TRY,\n      ip: req.user?.ip,\n      ...reasonObj\n    });\n    res.json(result);\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQXBpRXJyb3IiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9TZXNzaW9uIiwiX1JlcXVpcmVkQ2hlY2siLCJSZWZ1bmRQYXltZW50cyIsIl9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkIiwiX3V1aWQiLCJfaXl6aXBheSIsIl9wYXltZW50U3VjY2VzcyIsIl9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSIsImUiLCJXZWFrTWFwIiwiciIsInQiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImhhcyIsImdldCIsIm4iLCJfX3Byb3RvX18iLCJhIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJ1IiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiaSIsInNldCIsInJlYXNvbkVudW0iLCJfZGVmYXVsdCIsInJvdXRlciIsInBvc3QiLCJTZXNzaW9uIiwicmVxIiwicmVzIiwicGF5bWVudFRyYW5zYWN0aW9uSWQiLCJwYXJhbXMiLCJyZWFzb25PYmoiLCJyZWFzb24iLCJkZXNjcmlwdGlvbiIsImJvZHkiLCJjaGVja1JlcXVpcmVkRmllbGQiLCJpbmNsdWRlcyIsIkFwaUVycm9yIiwicGF5bWVudCIsIlBheW1lbnRTdWNjZXNzIiwiZmluZE9uZSIsImN1cnJlbnRJdGVtVHJhbnNhY3Rpb24iLCJpdGVtVHJhbnNhY3Rpb25zIiwiZmluZCIsIml0ZW1UcmFuc2FjdGlvbiIsImluZGV4IiwicmVzdWx0IiwicmVmdW5kUGF5bWVudCIsImxvY2FsZSIsInVzZXIiLCJjb252ZXJzYXRpb25JZCIsImlkIiwicHJpY2UiLCJyZWZ1bmRQcmljZSIsInBhaWRQcmljZSIsImN1cnJlbmN5IiwiSXl6aXBheSIsIkNVUlJFTkNZIiwiVFJZIiwiaXAiLCJqc29uIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3JvdXRlcy8iLCJzb3VyY2VzIjpbInJlZnVuZC1wYXltZW50cy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQXBpRXJyb3IgZnJvbSBcIi4uL2Vycm9ycy9BcGlFcnJvclwiO1xuaW1wb3J0IFNlc3Npb24gZnJvbSBcIi4uL21pZGRsZXdhcmVzL1Nlc3Npb25cIjtcbmltcG9ydCB7IGNoZWNrUmVxdWlyZWRGaWVsZCB9IGZyb20gXCIuLi9oZWxwZXJzL1JlcXVpcmVkQ2hlY2tcIjtcbmltcG9ydCAqIGFzIFJlZnVuZFBheW1lbnRzIGZyb20gXCIuLi9zZXJ2aWNlcy9peXppY28vbWV0aG9kcy9yZWZ1bmRfcGF5bWVudHNcIjtcbmltcG9ydCBpZCBmcm9tIFwiLi4vdXRpbHMvdXVpZFwiO1xuaW1wb3J0IEl5emlwYXkgZnJvbSBcIml5emlwYXlcIjtcbmltcG9ydCBQYXltZW50U3VjY2VzcyBmcm9tIFwiLi4vZGIvcGF5bWVudC1zdWNjZXNzXCI7XG5cbmNvbnN0IHJlYXNvbkVudW0gPSBbXCJkb3VibGVfcGF5bWVudFwiLCBcImJ1eWVyX3JlcXVlc3RcIiwgXCJmcmF1ZFwiLCBcIm90aGVyXCJdO1xuXG5leHBvcnQgZGVmYXVsdCAocm91dGVyKSA9PiB7XG4gIHJvdXRlci5wb3N0KFxuICAgIFwiL3BheW1lbnRzLzpwYXltZW50VHJhbnNhY3Rpb25JZC9yZWZ1bmRcIixcbiAgICBTZXNzaW9uLFxuICAgIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgICAgY29uc3QgeyBwYXltZW50VHJhbnNhY3Rpb25JZCB9ID0gcmVxLnBhcmFtcztcbiAgICAgIGNvbnN0IHJlYXNvbk9iaiA9IHt9O1xuICAgICAgY29uc3QgeyByZWFzb24sIGRlc2NyaXB0aW9uIH0gPSByZXEuYm9keTtcbiAgICAgIC8vIGlmICghcGF5bWVudFRyYW5zYWN0aW9uSWQpIHtcbiAgICAgIC8vICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgLy8gICAgIFwiUGF5bWVudFRyYW5zYWN0aW9uSWQgaXMgcmVxdWlyZWRcIixcbiAgICAgIC8vICAgICA0MDAsXG4gICAgICAvLyAgICAgXCJwYXltZW50VHJhbnNhY3Rpb25SZXF1aXJlZFwiXG4gICAgICAvLyAgICk7XG4gICAgICAvLyB9XG4gICAgICBjaGVja1JlcXVpcmVkRmllbGQocGF5bWVudFRyYW5zYWN0aW9uSWQsIFwiUGF5bWVudFRyYW5zYWN0aW9uSWRcIik7XG5cbiAgICAgIGlmIChyZWFzb24gJiYgZGVzY3JpcHRpb24pIHtcbiAgICAgICAgaWYgKCFyZWFzb25FbnVtLmluY2x1ZGVzKHJlYXNvbikpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgICBcIkludmFsaWQgY2FubGNlbCBwYXltZW50IHJlYXNvblwiLFxuICAgICAgICAgICAgNDAwLFxuICAgICAgICAgICAgXCJpbnZhbGlkQ2FuY2VsUGF5bWVudFJlYXNvblwiXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZWFzb25PYmoucmVhc29uID0gcmVhc29uO1xuICAgICAgICByZWFzb25PYmouZGVzY3JpcHRpb24gPSBkZXNjcmlwdGlvbjtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcGF5bWVudCA9IGF3YWl0IFBheW1lbnRTdWNjZXNzLmZpbmRPbmUoe1xuICAgICAgICBcIml0ZW1UcmFuc2FjdGlvbnMucGF5bWVudFRyYW5zYWN0aW9uSWRcIjogcGF5bWVudFRyYW5zYWN0aW9uSWQsXG4gICAgICB9KTtcbiAgICAgIC8vc2FhdCBzxLFuxLFyxLEga295IGvEsXNtaSBpcHRhbCBpw6dpblxuXG4gICAgICBjb25zdCBjdXJyZW50SXRlbVRyYW5zYWN0aW9uID0gcGF5bWVudC5pdGVtVHJhbnNhY3Rpb25zLmZpbmQoXG4gICAgICAgIChpdGVtVHJhbnNhY3Rpb24sIGluZGV4KSA9PiB7XG4gICAgICAgICAgcmV0dXJuIGl0ZW1UcmFuc2FjdGlvbi5wYXltZW50VHJhbnNhY3Rpb25JZCA9PT0gcGF5bWVudFRyYW5zYWN0aW9uSWQ7XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBSZWZ1bmRQYXltZW50cy5yZWZ1bmRQYXltZW50KHtcbiAgICAgICAgbG9jYWxlOiByZXEudXNlcj8ubG9jYWxlLFxuICAgICAgICBjb252ZXJzYXRpb25JZDogaWQoKSxcbiAgICAgICAgcGF5bWVudFRyYW5zYWN0aW9uSWQ6IGN1cnJlbnRJdGVtVHJhbnNhY3Rpb24/LnBheW1lbnRUcmFuc2FjdGlvbklkLFxuICAgICAgICBwcmljZTogcmVxLmJvZHk/LnJlZnVuZFByaWNlIHx8IGN1cnJlbnRJdGVtVHJhbnNhY3Rpb24/LnBhaWRQcmljZSxcbiAgICAgICAgY3VycmVuY3k6IEl5emlwYXkuQ1VSUkVOQ1kuVFJZLFxuICAgICAgICBpcDogcmVxLnVzZXI/LmlwLFxuICAgICAgICAuLi5yZWFzb25PYmosXG4gICAgICB9KTtcbiAgICAgIHJlcy5qc29uKHJlc3VsdCk7XG4gICAgfVxuICApO1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsU0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsUUFBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsY0FBQSxHQUFBRixPQUFBO0FBQ0EsSUFBQUcsY0FBQSxHQUFBQyx1QkFBQSxDQUFBSixPQUFBO0FBQ0EsSUFBQUssS0FBQSxHQUFBTixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQU0sUUFBQSxHQUFBUCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQU8sZUFBQSxHQUFBUixzQkFBQSxDQUFBQyxPQUFBO0FBQW1ELFNBQUFRLHlCQUFBQyxDQUFBLDZCQUFBQyxPQUFBLG1CQUFBQyxDQUFBLE9BQUFELE9BQUEsSUFBQUUsQ0FBQSxPQUFBRixPQUFBLFlBQUFGLHdCQUFBLFlBQUFBLENBQUFDLENBQUEsV0FBQUEsQ0FBQSxHQUFBRyxDQUFBLEdBQUFELENBQUEsS0FBQUYsQ0FBQTtBQUFBLFNBQUFMLHdCQUFBSyxDQUFBLEVBQUFFLENBQUEsU0FBQUEsQ0FBQSxJQUFBRixDQUFBLElBQUFBLENBQUEsQ0FBQUksVUFBQSxTQUFBSixDQUFBLGVBQUFBLENBQUEsdUJBQUFBLENBQUEseUJBQUFBLENBQUEsV0FBQUssT0FBQSxFQUFBTCxDQUFBLFFBQUFHLENBQUEsR0FBQUosd0JBQUEsQ0FBQUcsQ0FBQSxPQUFBQyxDQUFBLElBQUFBLENBQUEsQ0FBQUcsR0FBQSxDQUFBTixDQUFBLFVBQUFHLENBQUEsQ0FBQUksR0FBQSxDQUFBUCxDQUFBLE9BQUFRLENBQUEsS0FBQUMsU0FBQSxVQUFBQyxDQUFBLEdBQUFDLE1BQUEsQ0FBQUMsY0FBQSxJQUFBRCxNQUFBLENBQUFFLHdCQUFBLFdBQUFDLENBQUEsSUFBQWQsQ0FBQSxvQkFBQWMsQ0FBQSxPQUFBQyxjQUFBLENBQUFDLElBQUEsQ0FBQWhCLENBQUEsRUFBQWMsQ0FBQSxTQUFBRyxDQUFBLEdBQUFQLENBQUEsR0FBQUMsTUFBQSxDQUFBRSx3QkFBQSxDQUFBYixDQUFBLEVBQUFjLENBQUEsVUFBQUcsQ0FBQSxLQUFBQSxDQUFBLENBQUFWLEdBQUEsSUFBQVUsQ0FBQSxDQUFBQyxHQUFBLElBQUFQLE1BQUEsQ0FBQUMsY0FBQSxDQUFBSixDQUFBLEVBQUFNLENBQUEsRUFBQUcsQ0FBQSxJQUFBVCxDQUFBLENBQUFNLENBQUEsSUFBQWQsQ0FBQSxDQUFBYyxDQUFBLFlBQUFOLENBQUEsQ0FBQUgsT0FBQSxHQUFBTCxDQUFBLEVBQUFHLENBQUEsSUFBQUEsQ0FBQSxDQUFBZSxHQUFBLENBQUFsQixDQUFBLEVBQUFRLENBQUEsR0FBQUEsQ0FBQTtBQUFBLFNBQUFsQix1QkFBQVUsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUksVUFBQSxHQUFBSixDQUFBLEtBQUFLLE9BQUEsRUFBQUwsQ0FBQTtBQUVuRCxNQUFNbUIsVUFBVSxHQUFHLENBQUMsZ0JBQWdCLEVBQUUsZUFBZSxFQUFFLE9BQU8sRUFBRSxPQUFPLENBQUM7QUFBQyxJQUFBQyxRQUFBLEdBRXpEQyxNQUFNLElBQUs7RUFDekJBLE1BQU0sQ0FBQ0MsSUFBSSxDQUNULHdDQUF3QyxFQUN4Q0MsZ0JBQU8sRUFDUCxPQUFPQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztJQUNsQixNQUFNO01BQUVDO0lBQXFCLENBQUMsR0FBR0YsR0FBRyxDQUFDRyxNQUFNO0lBQzNDLE1BQU1DLFNBQVMsR0FBRyxDQUFDLENBQUM7SUFDcEIsTUFBTTtNQUFFQyxNQUFNO01BQUVDO0lBQVksQ0FBQyxHQUFHTixHQUFHLENBQUNPLElBQUk7SUFDeEM7SUFDQTtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQSxJQUFBQyxpQ0FBa0IsRUFBQ04sb0JBQW9CLEVBQUUsc0JBQXNCLENBQUM7SUFFaEUsSUFBSUcsTUFBTSxJQUFJQyxXQUFXLEVBQUU7TUFDekIsSUFBSSxDQUFDWCxVQUFVLENBQUNjLFFBQVEsQ0FBQ0osTUFBTSxDQUFDLEVBQUU7UUFDaEMsTUFBTSxJQUFJSyxpQkFBUSxDQUNoQixnQ0FBZ0MsRUFDaEMsR0FBRyxFQUNILDRCQUNGLENBQUM7TUFDSDtNQUNBTixTQUFTLENBQUNDLE1BQU0sR0FBR0EsTUFBTTtNQUN6QkQsU0FBUyxDQUFDRSxXQUFXLEdBQUdBLFdBQVc7SUFDckM7SUFFQSxNQUFNSyxPQUFPLEdBQUcsTUFBTUMsdUJBQWMsQ0FBQ0MsT0FBTyxDQUFDO01BQzNDLHVDQUF1QyxFQUFFWDtJQUMzQyxDQUFDLENBQUM7SUFDRjs7SUFFQSxNQUFNWSxzQkFBc0IsR0FBR0gsT0FBTyxDQUFDSSxnQkFBZ0IsQ0FBQ0MsSUFBSSxDQUMxRCxDQUFDQyxlQUFlLEVBQUVDLEtBQUssS0FBSztNQUMxQixPQUFPRCxlQUFlLENBQUNmLG9CQUFvQixLQUFLQSxvQkFBb0I7SUFDdEUsQ0FDRixDQUFDO0lBQ0QsTUFBTWlCLE1BQU0sR0FBRyxNQUFNakQsY0FBYyxDQUFDa0QsYUFBYSxDQUFDO01BQ2hEQyxNQUFNLEVBQUVyQixHQUFHLENBQUNzQixJQUFJLEVBQUVELE1BQU07TUFDeEJFLGNBQWMsRUFBRSxJQUFBQyxhQUFFLEVBQUMsQ0FBQztNQUNwQnRCLG9CQUFvQixFQUFFWSxzQkFBc0IsRUFBRVosb0JBQW9CO01BQ2xFdUIsS0FBSyxFQUFFekIsR0FBRyxDQUFDTyxJQUFJLEVBQUVtQixXQUFXLElBQUlaLHNCQUFzQixFQUFFYSxTQUFTO01BQ2pFQyxRQUFRLEVBQUVDLGdCQUFPLENBQUNDLFFBQVEsQ0FBQ0MsR0FBRztNQUM5QkMsRUFBRSxFQUFFaEMsR0FBRyxDQUFDc0IsSUFBSSxFQUFFVSxFQUFFO01BQ2hCLEdBQUc1QjtJQUNMLENBQUMsQ0FBQztJQUNGSCxHQUFHLENBQUNnQyxJQUFJLENBQUNkLE1BQU0sQ0FBQztFQUNsQixDQUNGLENBQUM7QUFDSCxDQUFDO0FBQUFlLE9BQUEsQ0FBQXJELE9BQUEsR0FBQWUsUUFBQSIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_ApiError","_interopRequireDefault","require","_Session","_RequiredCheck","RefundPayments","_interopRequireWildcard","_uuid","_iyzipay","_paymentSuccess","_getRequireWildcardCache","e","WeakMap","r","t","__esModule","default","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","reasonEnum","_default","router","post","Session","req","res","paymentTransactionId","params","reasonObj","reason","description","body","checkRequiredField","includes","ApiError","payment","PaymentSuccess","findOne","currentItemTransaction","itemTransactions","find","itemTransaction","index","result","refundPayment","locale","user","conversationId","id","price","refundPrice","paidPrice","currency","Iyzipay","CURRENCY","TRY","ip","json","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["refund-payments.js"],"sourcesContent":["import ApiError from \"../errors/ApiError\";\nimport Session from \"../middlewares/Session\";\nimport { checkRequiredField } from \"../helpers/RequiredCheck\";\nimport * as RefundPayments from \"../services/iyzico/methods/refund_payments\";\nimport id from \"../utils/uuid\";\nimport Iyzipay from \"iyzipay\";\nimport PaymentSuccess from \"../db/payment-success\";\n\nconst reasonEnum = [\"double_payment\", \"buyer_request\", \"fraud\", \"other\"];\n\nexport default (router) => {\n  router.post(\n    \"/payments/:paymentTransactionId/refund\",\n    Session,\n    async (req, res) => {\n      const { paymentTransactionId } = req.params;\n      const reasonObj = {};\n      const { reason, description } = req.body;\n      // if (!paymentTransactionId) {\n      //   throw new ApiError(\n      //     \"PaymentTransactionId is required\",\n      //     400,\n      //     \"paymentTransactionRequired\"\n      //   );\n      // }\n      checkRequiredField(paymentTransactionId, \"PaymentTransactionId\");\n\n      if (reason && description) {\n        if (!reasonEnum.includes(reason)) {\n          throw new ApiError(\n            \"Invalid canlcel payment reason\",\n            400,\n            \"invalidCancelPaymentReason\"\n          );\n        }\n        reasonObj.reason = reason;\n        reasonObj.description = description;\n      }\n\n      const payment = await PaymentSuccess.findOne({\n        \"itemTransactions.paymentTransactionId\": paymentTransactionId,\n      });\n      //saat sınırı koy kısmi iptal için\n\n      const currentItemTransaction = payment.itemTransactions.find(\n        (itemTransaction, index) => {\n          return itemTransaction.paymentTransactionId === paymentTransactionId;\n        }\n      );\n      const result = await RefundPayments.refundPayment({\n        locale: req.user?.locale,\n        conversationId: id(),\n        paymentTransactionId: currentItemTransaction?.paymentTransactionId,\n        price: req.body?.refundPrice || currentItemTransaction?.paidPrice,\n        currency: Iyzipay.CURRENCY.TRY,\n        ip: req.user?.ip,\n        ...reasonObj,\n      });\n      res.json(result);\n    }\n  );\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1728656313930},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/refund_payments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.refundPayment = void 0;\nvar _iyzipay = _interopRequireDefault(require(\"../connection/iyzipay\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst refundPayment = data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.refund.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.refundPayment = refundPayment;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaXl6aXBheSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwicmVmdW5kUGF5bWVudCIsImRhdGEiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIml5emlwYXkiLCJyZWZ1bmQiLCJjcmVhdGUiLCJlcnIiLCJyZXN1bHQiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvc2VydmljZXMvaXl6aWNvL21ldGhvZHMvIiwic291cmNlcyI6WyJyZWZ1bmRfcGF5bWVudHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGl5emlwYXkgZnJvbSBcIi4uL2Nvbm5lY3Rpb24vaXl6aXBheVwiO1xuXG5leHBvcnQgY29uc3QgcmVmdW5kUGF5bWVudCA9IChkYXRhKSA9PiB7XG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgaXl6aXBheS5yZWZ1bmQuY3JlYXRlKGRhdGEsIChlcnIsIHJlc3VsdCkgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxRQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFBNEMsU0FBQUQsdUJBQUFFLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFckMsTUFBTUcsYUFBYSxHQUFJQyxJQUFJLElBQUs7RUFDckMsT0FBTyxJQUFJQyxPQUFPLENBQUMsQ0FBQ0MsT0FBTyxFQUFFQyxNQUFNLEtBQUs7SUFDdENDLGdCQUFPLENBQUNDLE1BQU0sQ0FBQ0MsTUFBTSxDQUFDTixJQUFJLEVBQUUsQ0FBQ08sR0FBRyxFQUFFQyxNQUFNLEtBQUs7TUFDM0MsSUFBSUQsR0FBRyxFQUFFO1FBQ1BKLE1BQU0sQ0FBQ0ksR0FBRyxDQUFDO01BQ2IsQ0FBQyxNQUFNO1FBQ0xMLE9BQU8sQ0FBQ00sTUFBTSxDQUFDO01BQ2pCO0lBQ0YsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUFDQyxPQUFBLENBQUFWLGFBQUEsR0FBQUEsYUFBQSIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_iyzipay","_interopRequireDefault","require","e","__esModule","default","refundPayment","data","Promise","resolve","reject","iyzipay","refund","create","err","result","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/","sources":["refund_payments.js"],"sourcesContent":["import iyzipay from \"../connection/iyzipay\";\n\nexport const refundPayment = (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.refund.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA4C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAErC,MAAMG,aAAa,GAAIC,IAAI,IAAK;EACrC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,MAAM,CAACC,MAAM,CAACN,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MAC3C,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAV,aAAA,GAAAA,aAAA","ignoreList":[]}},"mtime":1723543937125},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/installments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireWildcard(require(\"mongoose\"));\nvar _moment = _interopRequireDefault(require(\"moment\"));\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nvar Installments = _interopRequireWildcard(require(\"../services/iyzico/methods/installments\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _cart = _interopRequireDefault(require(\"../db/cart\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nfunction _getRequireWildcardCache(e) { if (\"function\" != typeof WeakMap) return null; var r = new WeakMap(), t = new WeakMap(); return (_getRequireWildcardCache = function (e) { return e ? t : r; })(e); }\nfunction _interopRequireWildcard(e, r) { if (!r && e && e.__esModule) return e; if (null === e || \"object\" != typeof e && \"function\" != typeof e) return { default: e }; var t = _getRequireWildcardCache(r); if (t && t.has(e)) return t.get(e); var n = { __proto__: null }, a = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var u in e) if (\"default\" !== u && {}.hasOwnProperty.call(e, u)) { var i = a ? Object.getOwnPropertyDescriptor(e, u) : null; i && (i.get || i.set) ? Object.defineProperty(n, u, i) : n[u] = e[u]; } return n.default = e, t && t.set(e, n), n; }\nconst {\n  ObjectId\n} = _mongoose.Types;\nvar _default = router => {\n  //fiyata göre taksit kontrolü\n  router.post(\"/installments\", _Session.default, async (req, res) => {\n    const {\n      binNumber,\n      price\n    } = req.body;\n    if (!binNumber || !price) {\n      throw new _ApiError.default(\"Missing Parameters\", 400, \"missingParameters\");\n    }\n    const result = await Installments.checkInstallment({\n      locale: req.user.locale,\n      conversationId: (0, _uuid.default)(),\n      binNumber: binNumber,\n      price: price\n    });\n    res.json(result);\n  });\n\n  //sepet tutarına göre taksit\n  router.post(\"/installments/:cartId\", _Session.default, async (req, res, next) => {\n    try {\n      const {\n        binNumber\n      } = req.body;\n      const {\n        cartId\n      } = req.params;\n      if (!cartId) {\n        throw new _ApiError.default(\"Cart id is required\", 400, \"cartIdRequired\");\n      }\n      const cart = await _cart.default.findOne({\n        _id: new ObjectId(cartId)\n      }).populate(\"products\", {\n        _id: 1,\n        price: 1\n      });\n      if (!cart) {\n        throw new _ApiError.default(\"Cart not found\", 404, \"cartNotFound\");\n      }\n      const price = cart.products.map(product => product.price).reduce((a, b) => a + b, 0);\n      if (!binNumber || price === undefined) {\n        throw new _ApiError.default(\"Missing parameters\", 400, \"missingParameters\");\n      }\n      const result = await Installments.checkInstallment({\n        locale: req.user.locale,\n        conversationId: (0, _uuid.default)(),\n        binNumber: binNumber,\n        price: price\n      });\n      res.json(result);\n    } catch (error) {\n      next(error);\n    }\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsInJlcXVpcmUiLCJfbW9tZW50IiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsIl9TZXNzaW9uIiwiX3V1aWQiLCJJbnN0YWxsbWVudHMiLCJfQXBpRXJyb3IiLCJfY2FydCIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIl9nZXRSZXF1aXJlV2lsZGNhcmRDYWNoZSIsIldlYWtNYXAiLCJyIiwidCIsImhhcyIsImdldCIsIm4iLCJfX3Byb3RvX18iLCJhIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJ1IiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiaSIsInNldCIsIk9iamVjdElkIiwiVHlwZXMiLCJfZGVmYXVsdCIsInJvdXRlciIsInBvc3QiLCJTZXNzaW9uIiwicmVxIiwicmVzIiwiYmluTnVtYmVyIiwicHJpY2UiLCJib2R5IiwiQXBpRXJyb3IiLCJyZXN1bHQiLCJjaGVja0luc3RhbGxtZW50IiwibG9jYWxlIiwidXNlciIsImNvbnZlcnNhdGlvbklkIiwiaWQiLCJqc29uIiwibmV4dCIsImNhcnRJZCIsInBhcmFtcyIsImNhcnQiLCJDYXJ0cyIsImZpbmRPbmUiLCJfaWQiLCJwb3B1bGF0ZSIsInByb2R1Y3RzIiwibWFwIiwicHJvZHVjdCIsInJlZHVjZSIsImIiLCJ1bmRlZmluZWQiLCJlcnJvciIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9yb3V0ZXMvIiwic291cmNlcyI6WyJpbnN0YWxsbWVudHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgVHlwZXMgfSBmcm9tIFwibW9uZ29vc2VcIjtcbmltcG9ydCBtb21lbnQgZnJvbSBcIm1vbWVudFwiO1xuaW1wb3J0IG1vbmdvb3NlIGZyb20gXCJtb25nb29zZVwiO1xuaW1wb3J0IFNlc3Npb24gZnJvbSBcIi4uL21pZGRsZXdhcmVzL1Nlc3Npb25cIjtcbmltcG9ydCBpZCBmcm9tIFwiLi4vdXRpbHMvdXVpZFwiO1xuaW1wb3J0ICogYXMgSW5zdGFsbG1lbnRzIGZyb20gXCIuLi9zZXJ2aWNlcy9peXppY28vbWV0aG9kcy9pbnN0YWxsbWVudHNcIjtcbmltcG9ydCBBcGlFcnJvciBmcm9tIFwiLi4vZXJyb3JzL0FwaUVycm9yXCI7XG5pbXBvcnQgQ2FydHMgZnJvbSBcIi4uL2RiL2NhcnRcIjtcblxuY29uc3QgeyBPYmplY3RJZCB9ID0gVHlwZXM7XG5cbmV4cG9ydCBkZWZhdWx0IChyb3V0ZXIpID0+IHtcbiAgLy9maXlhdGEgZ8O2cmUgdGFrc2l0IGtvbnRyb2zDvFxuICByb3V0ZXIucG9zdChcIi9pbnN0YWxsbWVudHNcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyBiaW5OdW1iZXIsIHByaWNlIH0gPSByZXEuYm9keTtcbiAgICBpZiAoIWJpbk51bWJlciB8fCAhcHJpY2UpIHtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIk1pc3NpbmcgUGFyYW1ldGVyc1wiLCA0MDAsIFwibWlzc2luZ1BhcmFtZXRlcnNcIik7XG4gICAgfVxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IEluc3RhbGxtZW50cy5jaGVja0luc3RhbGxtZW50KHtcbiAgICAgIGxvY2FsZTogcmVxLnVzZXIubG9jYWxlLFxuICAgICAgY29udmVyc2F0aW9uSWQ6IGlkKCksXG4gICAgICBiaW5OdW1iZXI6IGJpbk51bWJlcixcbiAgICAgIHByaWNlOiBwcmljZSxcbiAgICB9KTtcbiAgICByZXMuanNvbihyZXN1bHQpO1xuICB9KTtcblxuICAvL3NlcGV0IHR1dGFyxLFuYSBnw7ZyZSB0YWtzaXRcbiAgcm91dGVyLnBvc3QoXCIvaW5zdGFsbG1lbnRzLzpjYXJ0SWRcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHsgYmluTnVtYmVyIH0gPSByZXEuYm9keTtcbiAgICAgIGNvbnN0IHsgY2FydElkIH0gPSByZXEucGFyYW1zO1xuXG4gICAgICBpZiAoIWNhcnRJZCkge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYXJ0IGlkIGlzIHJlcXVpcmVkXCIsIDQwMCwgXCJjYXJ0SWRSZXF1aXJlZFwiKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgY2FydCA9IGF3YWl0IENhcnRzLmZpbmRPbmUoe1xuICAgICAgICBfaWQ6IG5ldyBPYmplY3RJZChjYXJ0SWQpLFxuICAgICAgfSkucG9wdWxhdGUoXCJwcm9kdWN0c1wiLCB7XG4gICAgICAgIF9pZDogMSxcbiAgICAgICAgcHJpY2U6IDEsXG4gICAgICB9KTtcblxuICAgICAgaWYgKCFjYXJ0KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhcnQgbm90IGZvdW5kXCIsIDQwNCwgXCJjYXJ0Tm90Rm91bmRcIik7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHByaWNlID0gY2FydC5wcm9kdWN0c1xuICAgICAgICAubWFwKChwcm9kdWN0KSA9PiBwcm9kdWN0LnByaWNlKVxuICAgICAgICAucmVkdWNlKChhLCBiKSA9PiBhICsgYiwgMCk7XG5cbiAgICAgIGlmICghYmluTnVtYmVyIHx8IHByaWNlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiTWlzc2luZyBwYXJhbWV0ZXJzXCIsIDQwMCwgXCJtaXNzaW5nUGFyYW1ldGVyc1wiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IEluc3RhbGxtZW50cy5jaGVja0luc3RhbGxtZW50KHtcbiAgICAgICAgbG9jYWxlOiByZXEudXNlci5sb2NhbGUsXG4gICAgICAgIGNvbnZlcnNhdGlvbklkOiBpZCgpLFxuICAgICAgICBiaW5OdW1iZXI6IGJpbk51bWJlcixcbiAgICAgICAgcHJpY2U6IHByaWNlLFxuICAgICAgfSk7XG4gICAgICByZXMuanNvbihyZXN1bHQpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBuZXh0KGVycm9yKTtcbiAgICB9XG4gIH0pO1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsU0FBQSxHQUFBQyx1QkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsT0FBQSxHQUFBQyxzQkFBQSxDQUFBRixPQUFBO0FBRUEsSUFBQUcsUUFBQSxHQUFBRCxzQkFBQSxDQUFBRixPQUFBO0FBQ0EsSUFBQUksS0FBQSxHQUFBRixzQkFBQSxDQUFBRixPQUFBO0FBQ0EsSUFBQUssWUFBQSxHQUFBTix1QkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQU0sU0FBQSxHQUFBSixzQkFBQSxDQUFBRixPQUFBO0FBQ0EsSUFBQU8sS0FBQSxHQUFBTCxzQkFBQSxDQUFBRixPQUFBO0FBQStCLFNBQUFFLHVCQUFBTSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBQUEsU0FBQUcseUJBQUFILENBQUEsNkJBQUFJLE9BQUEsbUJBQUFDLENBQUEsT0FBQUQsT0FBQSxJQUFBRSxDQUFBLE9BQUFGLE9BQUEsWUFBQUQsd0JBQUEsWUFBQUEsQ0FBQUgsQ0FBQSxXQUFBQSxDQUFBLEdBQUFNLENBQUEsR0FBQUQsQ0FBQSxLQUFBTCxDQUFBO0FBQUEsU0FBQVQsd0JBQUFTLENBQUEsRUFBQUssQ0FBQSxTQUFBQSxDQUFBLElBQUFMLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLFNBQUFELENBQUEsZUFBQUEsQ0FBQSx1QkFBQUEsQ0FBQSx5QkFBQUEsQ0FBQSxXQUFBRSxPQUFBLEVBQUFGLENBQUEsUUFBQU0sQ0FBQSxHQUFBSCx3QkFBQSxDQUFBRSxDQUFBLE9BQUFDLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxHQUFBLENBQUFQLENBQUEsVUFBQU0sQ0FBQSxDQUFBRSxHQUFBLENBQUFSLENBQUEsT0FBQVMsQ0FB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","map":{"version":3,"names":["_mongoose","_interopRequireWildcard","require","_moment","_interopRequireDefault","_Session","_uuid","Installments","_ApiError","_cart","e","__esModule","default","_getRequireWildcardCache","WeakMap","r","t","has","get","n","__proto__","a","Object","defineProperty","getOwnPropertyDescriptor","u","hasOwnProperty","call","i","set","ObjectId","Types","_default","router","post","Session","req","res","binNumber","price","body","ApiError","result","checkInstallment","locale","user","conversationId","id","json","next","cartId","params","cart","Carts","findOne","_id","populate","products","map","product","reduce","b","undefined","error","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["installments.js"],"sourcesContent":["import { Types } from \"mongoose\";\nimport moment from \"moment\";\nimport mongoose from \"mongoose\";\nimport Session from \"../middlewares/Session\";\nimport id from \"../utils/uuid\";\nimport * as Installments from \"../services/iyzico/methods/installments\";\nimport ApiError from \"../errors/ApiError\";\nimport Carts from \"../db/cart\";\n\nconst { ObjectId } = Types;\n\nexport default (router) => {\n  //fiyata göre taksit kontrolü\n  router.post(\"/installments\", Session, async (req, res) => {\n    const { binNumber, price } = req.body;\n    if (!binNumber || !price) {\n      throw new ApiError(\"Missing Parameters\", 400, \"missingParameters\");\n    }\n    const result = await Installments.checkInstallment({\n      locale: req.user.locale,\n      conversationId: id(),\n      binNumber: binNumber,\n      price: price,\n    });\n    res.json(result);\n  });\n\n  //sepet tutarına göre taksit\n  router.post(\"/installments/:cartId\", Session, async (req, res, next) => {\n    try {\n      const { binNumber } = req.body;\n      const { cartId } = req.params;\n\n      if (!cartId) {\n        throw new ApiError(\"Cart id is required\", 400, \"cartIdRequired\");\n      }\n\n      const cart = await Carts.findOne({\n        _id: new ObjectId(cartId),\n      }).populate(\"products\", {\n        _id: 1,\n        price: 1,\n      });\n\n      if (!cart) {\n        throw new ApiError(\"Cart not found\", 404, \"cartNotFound\");\n      }\n\n      const price = cart.products\n        .map((product) => product.price)\n        .reduce((a, b) => a + b, 0);\n\n      if (!binNumber || price === undefined) {\n        throw new ApiError(\"Missing parameters\", 400, \"missingParameters\");\n      }\n      const result = await Installments.checkInstallment({\n        locale: req.user.locale,\n        conversationId: id(),\n        binNumber: binNumber,\n        price: price,\n      });\n      res.json(result);\n    } catch (error) {\n      next(error);\n    }\n  });\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1724323812543},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/installments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.checkInstallment = void 0;\nvar _iyzipay = _interopRequireDefault(require(\"../connection/iyzipay\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst checkInstallment = data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.installmentInfo.retrieve(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.checkInstallment = checkInstallment;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaXl6aXBheSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiY2hlY2tJbnN0YWxsbWVudCIsImRhdGEiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIml5emlwYXkiLCJpbnN0YWxsbWVudEluZm8iLCJyZXRyaWV2ZSIsImVyciIsInJlc3VsdCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9zZXJ2aWNlcy9peXppY28vbWV0aG9kcy8iLCJzb3VyY2VzIjpbImluc3RhbGxtZW50cy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgaXl6aXBheSBmcm9tIFwiLi4vY29ubmVjdGlvbi9peXppcGF5XCI7XG5cbmV4cG9ydCBjb25zdCBjaGVja0luc3RhbGxtZW50ID0gKGRhdGEpID0+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBpeXppcGF5Lmluc3RhbGxtZW50SW5mby5yZXRyaWV2ZShkYXRhLCAoZXJyLCByZXN1bHQpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsUUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQTRDLFNBQUFELHVCQUFBRSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBRXJDLE1BQU1HLGdCQUFnQixHQUFJQyxJQUFJLElBQUs7RUFDeEMsT0FBTyxJQUFJQyxPQUFPLENBQUMsQ0FBQ0MsT0FBTyxFQUFFQyxNQUFNLEtBQUs7SUFDdENDLGdCQUFPLENBQUNDLGVBQWUsQ0FBQ0MsUUFBUSxDQUFDTixJQUFJLEVBQUUsQ0FBQ08sR0FBRyxFQUFFQyxNQUFNLEtBQUs7TUFDdEQsSUFBSUQsR0FBRyxFQUFFO1FBQ1BKLE1BQU0sQ0FBQ0ksR0FBRyxDQUFDO01BQ2IsQ0FBQyxNQUFNO1FBQ0xMLE9BQU8sQ0FBQ00sTUFBTSxDQUFDO01BQ2pCO0lBQ0YsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUFDQyxPQUFBLENBQUFWLGdCQUFBLEdBQUFBLGdCQUFBIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["_iyzipay","_interopRequireDefault","require","e","__esModule","default","checkInstallment","data","Promise","resolve","reject","iyzipay","installmentInfo","retrieve","err","result","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/","sources":["installments.js"],"sourcesContent":["import iyzipay from \"../connection/iyzipay\";\n\nexport const checkInstallment = (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.installmentInfo.retrieve(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA4C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAErC,MAAMG,gBAAgB,GAAIC,IAAI,IAAK;EACxC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,eAAe,CAACC,QAAQ,CAACN,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MACtD,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAV,gBAAA,GAAAA,gBAAA","ignoreList":[]}},"mtime":1723543937123},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/OrderCompleteMail.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _nodemailer = _interopRequireDefault(require(\"nodemailer\"));\nvar _cart = _interopRequireDefault(require(\"../db/cart\"));\nvar _products = _interopRequireDefault(require(\"../db/products\"));\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\n// Products modelini ekleyin\n\nconst sendCompletedOrderEmail = async (req, res, next) => {\n  const email = req.user?.email;\n  const user = await _users.default.findOne({\n    email\n  });\n  if (!user) {\n    return next(new _ApiError.default(400, \"Can not find user\"));\n  }\n\n  // En son oluşturulan sepeti buluyoruz\n  const cart = await _cart.default.findOne({\n    buyer: user._id\n  }).sort({\n    createdAt: -1\n  });\n  if (!cart) {\n    throw new _ApiError.default(\"Can not find cart\", 400, \"canNotFindCart\");\n  }\n\n  // Cart içindeki productId'leri ve miktarları kullanarak ürün detaylarını çekiyoruz\n  const productIds = cart.products.map(item => item.productId);\n  const products = await _products.default.find({\n    _id: {\n      $in: productIds\n    }\n  }).populate(\"seller\", \"SellerName\");\n\n  // Sepet içindeki ürünlerin detaylarını zenginleştiriyoruz\n  const enrichedProducts = cart.products.map(cartProduct => {\n    const productDetail = products.find(product => String(product._id) === String(cartProduct.productId));\n    return {\n      ...cartProduct._doc,\n      productDetail\n    };\n  });\n\n  // Ürünlerin HTML formatında listesini oluşturuyoruz\n  const productsList = enrichedProducts.map(cartProduct => {\n    const productDetail = cartProduct.productDetail;\n    return `\n    <div style=\"border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px; margin-bottom: 15px; display: flex; align-items: center; background-color: #f9f9f9;\">\n      <img src=\"https://localhost:3000/public/images/${productDetail.images}\" alt=\"${productDetail.name}\" style=\"max-width: 100px; height: auto; border-radius: 5px; margin-right: 15px;\" />\n      <div style=\"flex-grow: 1;\">\n        <h4 style=\"margin: 0; font-size: 16px; color: #333;\">${productDetail.name}</h4>\n        <p style=\"margin: 5px 0; font-size: 14px; color: #666;\">Marka: ${productDetail.seller?.SellerName //name olacak\n    }</p>\n        <p style=\"margin: 5px 0; font-size: 14px; color: #666;\">Adet: ${cartProduct.quantity}</p>\n        <p style=\"margin: 5px 0; font-size: 14px; color: #666;\">Fiyat: ${productDetail.price} TL</p>\n        <p style=\"margin: 5px 0; font-size: 14px; color: #666;\"><strong>Toplam: ${(productDetail.price * cartProduct.quantity).toFixed(2)} TL</strong></p>\n      </div>\n    </div>\n    <hr style=\"border: 1px solid #e0e0e0;\">\n  `;\n  }).join(\"\");\n\n  // Toplam fiyatı hesaplıyoruz (ürün fiyatı * adet)\n  const totalPrice = enrichedProducts.map(product => product.productDetail.price * product.quantity).reduce((total, price) => total + price, 0).toFixed(2);\n\n  // E-posta gönderimi için mail transporter oluşturuyoruz\n  const transporter = _nodemailer.default.createTransport({\n    host: \"smtp.yandex.com\",\n    port: 465,\n    secure: true,\n    auth: {\n      user: process.env.MAIL_SENDER,\n      pass: process.env.MAIL_SENDER_PASSWORD\n    },\n    debug: true,\n    logger: true\n  });\n\n  // Gönderilecek e-posta içeriğini hazırlıyoruz\n  const mailOptions = {\n    from: `\"TURKOTREND\" <${process.env.MAIL_SENDER}>`,\n    to: email,\n    subject: \"Siparişiniz alındı\",\n    html: `\n    <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #f0f0f0; border-radius: 10px; background-color: #fafafa;\">\n      <div style=\"text-align: center; padding-bottom: 20px;\">\n        <img src=\"https://example.com/logo.png\" alt=\"Logo\" style=\"max-width: 150px;\">\n      </div>\n      <div style=\"background-color: #ffffff; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\">\n        <h2 style=\"color: #333333; text-align: center;\">Siparişiniz Başarıyla Alındı!</h2>\n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">Merhaba <strong>${user.name}</strong>,</p>\n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">\n          <strong>${cart.uuid}</strong> numaralı siparişiniz alındı ve en kısa zamanda kargoya verilecektir.\n        </p>\n\n        <div style=\"margin: 20px 0;\">\n          <h3 style=\"font-size: 18px; color: #333333; text-align: center;\">Sipariş Detayları:</h3>\n          ${productsList}\n        </div>\n\n        <div style=\"background-color: #f8f9fa; padding: 15px; margin: 20px 0; border-left: 5px solid #17a2b8; border-radius: 5px;\">\n          <p style=\"margin: 0; font-size: 16px; text-align: center;\">\n            <strong>Toplam Tutar: ${totalPrice} TL</strong>\n          </p>\n        </div>\n\n        \n      </div>\n\n      <div style=\"text-align: center; margin-top: 20px;\">\n        <p style=\"font-size: 14px; color: #999999;\">Sorularınız için bize ulaşmaktan çekinmeyin.</p>\n        <p style=\"font-size: 14px; color: #999999;\">© 2024 TURKOTREND. Tüm hakları saklıdır.</p>\n      </div>\n    </div>\n  `\n  };\n  try {\n    await transporter.sendMail(mailOptions);\n    return res.status(200);\n  } catch (error) {\n    console.error(error);\n    return next(new _ApiError.default(500, \"Doğrulama e-postası gönderilemedi\"));\n  }\n};\nvar _default = exports.default = sendCompletedOrderEmail;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbm9kZW1haWxlciIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2NhcnQiLCJfcHJvZHVjdHMiLCJfdXNlcnMiLCJfQXBpRXJyb3IiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJzZW5kQ29tcGxldGVkT3JkZXJFbWFpbCIsInJlcSIsInJlcyIsIm5leHQiLCJlbWFpbCIsInVzZXIiLCJVc2VycyIsImZpbmRPbmUiLCJBcGlFcnJvciIsImNhcnQiLCJDYXJ0cyIsImJ1eWVyIiwiX2lkIiwic29ydCIsImNyZWF0ZWRBdCIsInByb2R1Y3RJZHMiLCJwcm9kdWN0cyIsIm1hcCIsIml0ZW0iLCJwcm9kdWN0SWQiLCJQcm9kdWN0cyIsImZpbmQiLCIkaW4iLCJwb3B1bGF0ZSIsImVucmljaGVkUHJvZHVjdHMiLCJjYXJ0UHJvZHVjdCIsInByb2R1Y3REZXRhaWwiLCJwcm9kdWN0IiwiU3RyaW5nIiwiX2RvYyIsInByb2R1Y3RzTGlzdCIsImltYWdlcyIsIm5hbWUiLCJzZWxsZXIiLCJTZWxsZXJOYW1lIiwicXVhbnRpdHkiLCJwcmljZSIsInRvRml4ZWQiLCJqb2luIiwidG90YWxQcmljZSIsInJlZHVjZSIsInRvdGFsIiwidHJhbnNwb3J0ZXIiLCJub2RlbWFpbGVyIiwiY3JlYXRlVHJhbnNwb3J0IiwiaG9zdCIsInBvcnQiLCJzZWN1cmUiLCJhdXRoIiwicHJvY2VzcyIsImVudiIsIk1BSUxfU0VOREVSIiwicGFzcyIsIk1BSUxfU0VOREVSX1BBU1NXT1JEIiwiZGVidWciLCJsb2dnZXIiLCJtYWlsT3B0aW9ucyIsImZyb20iLCJ0byIsInN1YmplY3QiLCJodG1sIiwidXVpZCIsInNlbmRNYWlsIiwic3RhdHVzIiwiZXJyb3IiLCJjb25zb2xlIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvbWlkZGxld2FyZXMvIiwic291cmNlcyI6WyJPcmRlckNvbXBsZXRlTWFpbC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbm9kZW1haWxlciBmcm9tIFwibm9kZW1haWxlclwiO1xuaW1wb3J0IENhcnRzIGZyb20gXCIuLi9kYi9jYXJ0XCI7XG5pbXBvcnQgUHJvZHVjdHMgZnJvbSBcIi4uL2RiL3Byb2R1Y3RzXCI7IC8vIFByb2R1Y3RzIG1vZGVsaW5pIGVrbGV5aW5cbmltcG9ydCBVc2VycyBmcm9tIFwiLi4vZGIvdXNlcnNcIjtcbmltcG9ydCBBcGlFcnJvciBmcm9tIFwiLi4vZXJyb3JzL0FwaUVycm9yXCI7XG5cbmNvbnN0IHNlbmRDb21wbGV0ZWRPcmRlckVtYWlsID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIGNvbnN0IGVtYWlsID0gcmVxLnVzZXI/LmVtYWlsO1xuICBjb25zdCB1c2VyID0gYXdhaXQgVXNlcnMuZmluZE9uZSh7IGVtYWlsIH0pO1xuXG4gIGlmICghdXNlcikge1xuICAgIHJldHVybiBuZXh0KG5ldyBBcGlFcnJvcig0MDAsIFwiQ2FuIG5vdCBmaW5kIHVzZXJcIikpO1xuICB9XG5cbiAgLy8gRW4gc29uIG9sdcWfdHVydWxhbiBzZXBldGkgYnVsdXlvcnV6XG4gIGNvbnN0IGNhcnQgPSBhd2FpdCBDYXJ0cy5maW5kT25lKHsgYnV5ZXI6IHVzZXIuX2lkIH0pLnNvcnQoeyBjcmVhdGVkQXQ6IC0xIH0pO1xuXG4gIGlmICghY2FydCkge1xuICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhbiBub3QgZmluZCBjYXJ0XCIsIDQwMCwgXCJjYW5Ob3RGaW5kQ2FydFwiKTtcbiAgfVxuXG4gIC8vIENhcnQgacOnaW5kZWtpIHByb2R1Y3RJZCdsZXJpIHZlIG1pa3RhcmxhcsSxIGt1bGxhbmFyYWsgw7xyw7xuIGRldGF5bGFyxLFuxLEgw6dla2l5b3J1elxuICBjb25zdCBwcm9kdWN0SWRzID0gY2FydC5wcm9kdWN0cy5tYXAoKGl0ZW0pID0+IGl0ZW0ucHJvZHVjdElkKTtcbiAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBQcm9kdWN0cy5maW5kKHsgX2lkOiB7ICRpbjogcHJvZHVjdElkcyB9IH0pLnBvcHVsYXRlKFxuICAgIFwic2VsbGVyXCIsXG4gICAgXCJTZWxsZXJOYW1lXCJcbiAgKTtcblxuICAvLyBTZXBldCBpw6dpbmRla2kgw7xyw7xubGVyaW4gZGV0YXlsYXLEsW7EsSB6ZW5naW5sZcWfdGlyaXlvcnV6XG4gIGNvbnN0IGVucmljaGVkUHJvZHVjdHMgPSBjYXJ0LnByb2R1Y3RzLm1hcCgoY2FydFByb2R1Y3QpID0+IHtcbiAgICBjb25zdCBwcm9kdWN0RGV0YWlsID0gcHJvZHVjdHMuZmluZChcbiAgICAgIChwcm9kdWN0KSA9PiBTdHJpbmcocHJvZHVjdC5faWQpID09PSBTdHJpbmcoY2FydFByb2R1Y3QucHJvZHVjdElkKVxuICAgICk7XG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLmNhcnRQcm9kdWN0Ll9kb2MsXG4gICAgICBwcm9kdWN0RGV0YWlsLFxuICAgIH07XG4gIH0pO1xuXG4gIC8vIMOccsO8bmxlcmluIEhUTUwgZm9ybWF0xLFuZGEgbGlzdGVzaW5pIG9sdcWfdHVydXlvcnV6XG4gIGNvbnN0IHByb2R1Y3RzTGlzdCA9IGVucmljaGVkUHJvZHVjdHNcbiAgICAubWFwKChjYXJ0UHJvZHVjdCkgPT4ge1xuICAgICAgY29uc3QgcHJvZHVjdERldGFpbCA9IGNhcnRQcm9kdWN0LnByb2R1Y3REZXRhaWw7XG4gICAgICByZXR1cm4gYFxuICAgIDxkaXYgc3R5bGU9XCJib3JkZXI6IDFweCBzb2xpZCAjZTBlMGUwOyBib3JkZXItcmFkaXVzOiA4cHg7IHBhZGRpbmc6IDE1cHg7IG1hcmdpbi1ib3R0b206IDE1cHg7IGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGJhY2tncm91bmQtY29sb3I6ICNmOWY5Zjk7XCI+XG4gICAgICA8aW1nIHNyYz1cImh0dHBzOi8vbG9jYWxob3N0OjMwMDAvcHVibGljL2ltYWdlcy8ke1xuICAgICAgICBwcm9kdWN0RGV0YWlsLmltYWdlc1xuICAgICAgfVwiIGFsdD1cIiR7XG4gICAgICAgIHByb2R1Y3REZXRhaWwubmFtZVxuICAgICAgfVwiIHN0eWxlPVwibWF4LXdpZHRoOiAxMDBweDsgaGVpZ2h0OiBhdXRvOyBib3JkZXItcmFkaXVzOiA1cHg7IG1hcmdpbi1yaWdodDogMTVweDtcIiAvPlxuICAgICAgPGRpdiBzdHlsZT1cImZsZXgtZ3JvdzogMTtcIj5cbiAgICAgICAgPGg0IHN0eWxlPVwibWFyZ2luOiAwOyBmb250LXNpemU6IDE2cHg7IGNvbG9yOiAjMzMzO1wiPiR7XG4gICAgICAgICAgcHJvZHVjdERldGFpbC5uYW1lXG4gICAgICAgIH08L2g0PlxuICAgICAgICA8cCBzdHlsZT1cIm1hcmdpbjogNXB4IDA7IGZvbnQtc2l6ZTogMTRweDsgY29sb3I6ICM2NjY7XCI+TWFya2E6ICR7XG4gICAgICAgICAgcHJvZHVjdERldGFpbC5zZWxsZXI/LlNlbGxlck5hbWUgLy9uYW1lIG9sYWNha1xuICAgICAgICB9PC9wPlxuICAgICAgICA8cCBzdHlsZT1cIm1hcmdpbjogNXB4IDA7IGZvbnQtc2l6ZTogMTRweDsgY29sb3I6ICM2NjY7XCI+QWRldDogJHtcbiAgICAgICAgICBjYXJ0UHJvZHVjdC5xdWFudGl0eVxuICAgICAgICB9PC9wPlxuICAgICAgICA8cCBzdHlsZT1cIm1hcmdpbjogNXB4IDA7IGZvbnQtc2l6ZTogMTRweDsgY29sb3I6ICM2NjY7XCI+Rml5YXQ6ICR7XG4gICAgICAgICAgcHJvZHVjdERldGFpbC5wcmljZVxuICAgICAgICB9IFRMPC9wPlxuICAgICAgICA8cCBzdHlsZT1cIm1hcmdpbjogNXB4IDA7IGZvbnQtc2l6ZTogMTRweDsgY29sb3I6ICM2NjY7XCI+PHN0cm9uZz5Ub3BsYW06ICR7KFxuICAgICAgICAgIHByb2R1Y3REZXRhaWwucHJpY2UgKiBjYXJ0UHJvZHVjdC5xdWFudGl0eVxuICAgICAgICApLnRvRml4ZWQoMil9IFRMPC9zdHJvbmc+PC9wPlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gICAgPGhyIHN0eWxlPVwiYm9yZGVyOiAxcHggc29saWQgI2UwZTBlMDtcIj5cbiAgYDtcbiAgICB9KVxuICAgIC5qb2luKFwiXCIpO1xuXG4gIC8vIFRvcGxhbSBmaXlhdMSxIGhlc2FwbMSxeW9ydXogKMO8csO8biBmaXlhdMSxICogYWRldClcbiAgY29uc3QgdG90YWxQcmljZSA9IGVucmljaGVkUHJvZHVjdHNcbiAgICAubWFwKChwcm9kdWN0KSA9PiBwcm9kdWN0LnByb2R1Y3REZXRhaWwucHJpY2UgKiBwcm9kdWN0LnF1YW50aXR5KVxuICAgIC5yZWR1Y2UoKHRvdGFsLCBwcmljZSkgPT4gdG90YWwgKyBwcmljZSwgMClcbiAgICAudG9GaXhlZCgyKTtcblxuICAvLyBFLXBvc3RhIGfDtm5kZXJpbWkgacOnaW4gbWFpbCB0cmFuc3BvcnRlciBvbHXFn3R1cnV5b3J1elxuICBjb25zdCB0cmFuc3BvcnRlciA9IG5vZGVtYWlsZXIuY3JlYXRlVHJhbnNwb3J0KHtcbiAgICBob3N0OiBcInNtdHAueWFuZGV4LmNvbVwiLFxuICAgIHBvcnQ6IDQ2NSxcbiAgICBzZWN1cmU6IHRydWUsXG4gICAgYXV0aDoge1xuICAgICAgdXNlcjogcHJvY2Vzcy5lbnYuTUFJTF9TRU5ERVIsXG4gICAgICBwYXNzOiBwcm9jZXNzLmVudi5NQUlMX1NFTkRFUl9QQVNTV09SRCxcbiAgICB9LFxuICAgIGRlYnVnOiB0cnVlLFxuICAgIGxvZ2dlcjogdHJ1ZSxcbiAgfSk7XG5cbiAgLy8gR8O2bmRlcmlsZWNlayBlLXBvc3RhIGnDp2VyacSfaW5pIGhhesSxcmzEsXlvcnV6XG4gIGNvbnN0IG1haWxPcHRpb25zID0ge1xuICAgIGZyb206IGBcIlRVUktPVFJFTkRcIiA8JHtwcm9jZXNzLmVudi5NQUlMX1NFTkRFUn0+YCxcbiAgICB0bzogZW1haWwsXG4gICAgc3ViamVjdDogXCJTaXBhcmnFn2luaXogYWzEsW5kxLFcIixcbiAgICBodG1sOiBgXG4gICAgPGRpdiBzdHlsZT1cImZvbnQtZmFtaWx5OiBBcmlhbCwgc2Fucy1zZXJpZjsgbWF4LXdpZHRoOiA2MDBweDsgbWFyZ2luOiAwIGF1dG87IHBhZGRpbmc6IDIwcHg7IGJvcmRlcjogMXB4IHNvbGlkICNmMGYwZjA7IGJvcmRlci1yYWRpdXM6IDEwcHg7IGJhY2tncm91bmQtY29sb3I6ICNmYWZhZmE7XCI+XG4gICAgICA8ZGl2IHN0eWxlPVwidGV4dC1hbGlnbjogY2VudGVyOyBwYWRkaW5nLWJvdHRvbTogMjBweDtcIj5cbiAgICAgICAgPGltZyBzcmM9XCJodHRwczovL2V4YW1wbGUuY29tL2xvZ28ucG5nXCIgYWx0PVwiTG9nb1wiIHN0eWxlPVwibWF4LXdpZHRoOiAxNTBweDtcIj5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6ICNmZmZmZmY7IHBhZGRpbmc6IDIwcHg7IGJvcmRlci1yYWRpdXM6IDEwcHg7IGJveC1zaGFkb3c6IDAgMCAxMHB4IHJnYmEoMCwgMCwgMCwgMC4xKTtcIj5cbiAgICAgICAgPGgyIHN0eWxlPVwiY29sb3I6ICMzMzMzMzM7IHRleHQtYWxpZ246IGNlbnRlcjtcIj5TaXBhcmnFn2luaXogQmHFn2FyxLF5bGEgQWzEsW5kxLEhPC9oMj5cbiAgICAgICAgPHAgc3R5bGU9XCJmb250LXNpemU6IDE2cHg7IGNvbG9yOiAjNTU1NTU1OyB0ZXh0LWFsaWduOiBjZW50ZXI7XCI+TWVyaGFiYSA8c3Ryb25nPiR7dXNlci5uYW1lfTwvc3Ryb25nPiw8L3A+XG4gICAgICAgIDxwIHN0eWxlPVwiZm9udC1zaXplOiAxNnB4OyBjb2xvcjogIzU1NTU1NTsgdGV4dC1hbGlnbjogY2VudGVyO1wiPlxuICAgICAgICAgIDxzdHJvbmc+JHtjYXJ0LnV1aWR9PC9zdHJvbmc+IG51bWFyYWzEsSBzaXBhcmnFn2luaXogYWzEsW5kxLEgdmUgZW4ga8Sxc2EgemFtYW5kYSBrYXJnb3lhIHZlcmlsZWNla3Rpci5cbiAgICAgICAgPC9wPlxuXG4gICAgICAgIDxkaXYgc3R5bGU9XCJtYXJnaW46IDIwcHggMDtcIj5cbiAgICAgICAgICA8aDMgc3R5bGU9XCJmb250LXNpemU6IDE4cHg7IGNvbG9yOiAjMzMzMzMzOyB0ZXh0LWFsaWduOiBjZW50ZXI7XCI+U2lwYXJpxZ8gRGV0YXlsYXLEsTo8L2gzPlxuICAgICAgICAgICR7cHJvZHVjdHNMaXN0fVxuICAgICAgICA8L2Rpdj5cblxuICAgICAgICA8ZGl2IHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjogI2Y4ZjlmYTsgcGFkZGluZzogMTVweDsgbWFyZ2luOiAyMHB4IDA7IGJvcmRlci1sZWZ0OiA1cHggc29saWQgIzE3YTJiODsgYm9yZGVyLXJhZGl1czogNXB4O1wiPlxuICAgICAgICAgIDxwIHN0eWxlPVwibWFyZ2luOiAwOyBmb250LXNpemU6IDE2cHg7IHRleHQtYWxpZ246IGNlbnRlcjtcIj5cbiAgICAgICAgICAgIDxzdHJvbmc+VG9wbGFtIFR1dGFyOiAke3RvdGFsUHJpY2V9IFRMPC9zdHJvbmc+XG4gICAgICAgICAgPC9wPlxuICAgICAgICA8L2Rpdj5cblxuICAgICAgICBcbiAgICAgIDwvZGl2PlxuXG4gICAgICA8ZGl2IHN0eWxlPVwidGV4dC1hbGlnbjogY2VudGVyOyBtYXJnaW4tdG9wOiAyMHB4O1wiPlxuICAgICAgICA8cCBzdHlsZT1cImZvbnQtc2l6ZTogMTRweDsgY29sb3I6ICM5OTk5OTk7XCI+U29ydWxhcsSxbsSxeiBpw6dpbiBiaXplIHVsYcWfbWFrdGFuIMOnZWtpbm1leWluLjwvcD5cbiAgICAgICAgPHAgc3R5bGU9XCJmb250LXNpemU6IDE0cHg7IGNvbG9yOiAjOTk5OTk5O1wiPsKpIDIwMjQgVFVSS09UUkVORC4gVMO8bSBoYWtsYXLEsSBzYWtsxLFkxLFyLjwvcD5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICBgLFxuICB9O1xuXG4gIHRyeSB7XG4gICAgYXdhaXQgdHJhbnNwb3J0ZXIuc2VuZE1haWwobWFpbE9wdGlvbnMpO1xuICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgcmV0dXJuIG5leHQobmV3IEFwaUVycm9yKDUwMCwgXCJEb8SfcnVsYW1hIGUtcG9zdGFzxLEgZ8O2bmRlcmlsZW1lZGlcIikpO1xuICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBzZW5kQ29tcGxldGVkT3JkZXJFbWFpbDtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsV0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsS0FBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsU0FBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUcsTUFBQSxHQUFBSixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUksU0FBQSxHQUFBTCxzQkFBQSxDQUFBQyxPQUFBO0FBQTBDLFNBQUFELHVCQUFBTSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBRkg7O0FBSXZDLE1BQU1HLHVCQUF1QixHQUFHLE1BQUFBLENBQU9DLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxJQUFJLEtBQUs7RUFDeEQsTUFBTUMsS0FBSyxHQUFHSCxHQUFHLENBQUNJLElBQUksRUFBRUQsS0FBSztFQUM3QixNQUFNQyxJQUFJLEdBQUcsTUFBTUMsY0FBSyxDQUFDQyxPQUFPLENBQUM7SUFBRUg7RUFBTSxDQUFDLENBQUM7RUFFM0MsSUFBSSxDQUFDQyxJQUFJLEVBQUU7SUFDVCxPQUFPRixJQUFJLENBQUMsSUFBSUssaUJBQVEsQ0FBQyxHQUFHLEVBQUUsbUJBQW1CLENBQUMsQ0FBQztFQUNyRDs7RUFFQTtFQUNBLE1BQU1DLElBQUksR0FBRyxNQUFNQyxhQUFLLENBQUNILE9BQU8sQ0FBQztJQUFFSSxLQUFLLEVBQUVOLElBQUksQ0FBQ087RUFBSSxDQUFDLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO0lBQUVDLFNBQVMs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","map":{"version":3,"names":["_nodemailer","_interopRequireDefault","require","_cart","_products","_users","_ApiError","e","__esModule","default","sendCompletedOrderEmail","req","res","next","email","user","Users","findOne","ApiError","cart","Carts","buyer","_id","sort","createdAt","productIds","products","map","item","productId","Products","find","$in","populate","enrichedProducts","cartProduct","productDetail","product","String","_doc","productsList","images","name","seller","SellerName","quantity","price","toFixed","join","totalPrice","reduce","total","transporter","nodemailer","createTransport","host","port","secure","auth","process","env","MAIL_SENDER","pass","MAIL_SENDER_PASSWORD","debug","logger","mailOptions","from","to","subject","html","uuid","sendMail","status","error","console","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["OrderCompleteMail.js"],"sourcesContent":["import nodemailer from \"nodemailer\";\nimport Carts from \"../db/cart\";\nimport Products from \"../db/products\"; // Products modelini ekleyin\nimport Users from \"../db/users\";\nimport ApiError from \"../errors/ApiError\";\n\nconst sendCompletedOrderEmail = async (req, res, next) => {\n  const email = req.user?.email;\n  const user = await Users.findOne({ email });\n\n  if (!user) {\n    return next(new ApiError(400, \"Can not find user\"));\n  }\n\n  // En son oluşturulan sepeti buluyoruz\n  const cart = await Carts.findOne({ buyer: user._id }).sort({ createdAt: -1 });\n\n  if (!cart) {\n    throw new ApiError(\"Can not find cart\", 400, \"canNotFindCart\");\n  }\n\n  // Cart içindeki productId'leri ve miktarları kullanarak ürün detaylarını çekiyoruz\n  const productIds = cart.products.map((item) => item.productId);\n  const products = await Products.find({ _id: { $in: productIds } }).populate(\n    \"seller\",\n    \"SellerName\"\n  );\n\n  // Sepet içindeki ürünlerin detaylarını zenginleştiriyoruz\n  const enrichedProducts = cart.products.map((cartProduct) => {\n    const productDetail = products.find(\n      (product) => String(product._id) === String(cartProduct.productId)\n    );\n    return {\n      ...cartProduct._doc,\n      productDetail,\n    };\n  });\n\n  // Ürünlerin HTML formatında listesini oluşturuyoruz\n  const productsList = enrichedProducts\n    .map((cartProduct) => {\n      const productDetail = cartProduct.productDetail;\n      return `\n    <div style=\"border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px; margin-bottom: 15px; display: flex; align-items: center; background-color: #f9f9f9;\">\n      <img src=\"https://localhost:3000/public/images/${\n        productDetail.images\n      }\" alt=\"${\n        productDetail.name\n      }\" style=\"max-width: 100px; height: auto; border-radius: 5px; margin-right: 15px;\" />\n      <div style=\"flex-grow: 1;\">\n        <h4 style=\"margin: 0; font-size: 16px; color: #333;\">${\n          productDetail.name\n        }</h4>\n        <p style=\"margin: 5px 0; font-size: 14px; color: #666;\">Marka: ${\n          productDetail.seller?.SellerName //name olacak\n        }</p>\n        <p style=\"margin: 5px 0; font-size: 14px; color: #666;\">Adet: ${\n          cartProduct.quantity\n        }</p>\n        <p style=\"margin: 5px 0; font-size: 14px; color: #666;\">Fiyat: ${\n          productDetail.price\n        } TL</p>\n        <p style=\"margin: 5px 0; font-size: 14px; color: #666;\"><strong>Toplam: ${(\n          productDetail.price * cartProduct.quantity\n        ).toFixed(2)} TL</strong></p>\n      </div>\n    </div>\n    <hr style=\"border: 1px solid #e0e0e0;\">\n  `;\n    })\n    .join(\"\");\n\n  // Toplam fiyatı hesaplıyoruz (ürün fiyatı * adet)\n  const totalPrice = enrichedProducts\n    .map((product) => product.productDetail.price * product.quantity)\n    .reduce((total, price) => total + price, 0)\n    .toFixed(2);\n\n  // E-posta gönderimi için mail transporter oluşturuyoruz\n  const transporter = nodemailer.createTransport({\n    host: \"smtp.yandex.com\",\n    port: 465,\n    secure: true,\n    auth: {\n      user: process.env.MAIL_SENDER,\n      pass: process.env.MAIL_SENDER_PASSWORD,\n    },\n    debug: true,\n    logger: true,\n  });\n\n  // Gönderilecek e-posta içeriğini hazırlıyoruz\n  const mailOptions = {\n    from: `\"TURKOTREND\" <${process.env.MAIL_SENDER}>`,\n    to: email,\n    subject: \"Siparişiniz alındı\",\n    html: `\n    <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #f0f0f0; border-radius: 10px; background-color: #fafafa;\">\n      <div style=\"text-align: center; padding-bottom: 20px;\">\n        <img src=\"https://example.com/logo.png\" alt=\"Logo\" style=\"max-width: 150px;\">\n      </div>\n      <div style=\"background-color: #ffffff; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\">\n        <h2 style=\"color: #333333; text-align: center;\">Siparişiniz Başarıyla Alındı!</h2>\n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">Merhaba <strong>${user.name}</strong>,</p>\n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">\n          <strong>${cart.uuid}</strong> numaralı siparişiniz alındı ve en kısa zamanda kargoya verilecektir.\n        </p>\n\n        <div style=\"margin: 20px 0;\">\n          <h3 style=\"font-size: 18px; color: #333333; text-align: center;\">Sipariş Detayları:</h3>\n          ${productsList}\n        </div>\n\n        <div style=\"background-color: #f8f9fa; padding: 15px; margin: 20px 0; border-left: 5px solid #17a2b8; border-radius: 5px;\">\n          <p style=\"margin: 0; font-size: 16px; text-align: center;\">\n            <strong>Toplam Tutar: ${totalPrice} TL</strong>\n          </p>\n        </div>\n\n        \n      </div>\n\n      <div style=\"text-align: center; margin-top: 20px;\">\n        <p style=\"font-size: 14px; color: #999999;\">Sorularınız için bize ulaşmaktan çekinmeyin.</p>\n        <p style=\"font-size: 14px; color: #999999;\">© 2024 TURKOTREND. Tüm hakları saklıdır.</p>\n      </div>\n    </div>\n  `,\n  };\n\n  try {\n    await transporter.sendMail(mailOptions);\n    return res.status(200);\n  } catch (error) {\n    console.error(error);\n    return next(new ApiError(500, \"Doğrulama e-postası gönderilemedi\"));\n  }\n};\n\nexport default sendCompletedOrderEmail;\n"],"mappings":"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","ignoreList":[]}},"mtime":1733223942298},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/OrderCompleteMail.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _nodemailer = _interopRequireDefault(require(\"nodemailer\"));\nvar _cart = _interopRequireDefault(require(\"../db/cart\"));\nvar _products = _interopRequireDefault(require(\"../db/products\"));\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\n// Products modelini ekleyin\n\nconst sendCompletedOrderEmail = async (req, res, next) => {\n  const email = req.user?.email;\n  const user = await _users.default.findOne({\n    email\n  });\n  if (!user) {\n    return next(new _ApiError.default(400, \"Can not find user\"));\n  }\n\n  // En son oluşturulan sepeti buluyoruz\n  const cart = await _cart.default.findOne({\n    buyer: user._id\n  }).sort({\n    createdAt: -1\n  });\n  if (!cart) {\n    throw new _ApiError.default(\"Can not find cart\", 400, \"canNotFindCart\");\n  }\n\n  // Cart içindeki productId'leri ve miktarları kullanarak ürün detaylarını çekiyoruz\n  const productIds = cart.products.map(item => item.productId);\n  const products = await _products.default.find({\n    _id: {\n      $in: productIds\n    }\n  }).populate(\"seller\", \"SellerName\");\n\n  // Sepet içindeki ürünlerin detaylarını zenginleştiriyoruz\n  const enrichedProducts = cart.products.map(cartProduct => {\n    const productDetail = products.find(product => String(product._id) === String(cartProduct.productId));\n    return {\n      ...cartProduct._doc,\n      productDetail\n    };\n  });\n\n  // Ürünlerin HTML formatında listesini oluşturuyoruz\n  const productsList = enrichedProducts.map(cartProduct => {\n    const productDetail = cartProduct.productDetail;\n    return `\n    <div style=\"border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px; margin-bottom: 15px; display: flex; align-items: center; background-color: #f9f9f9;\">\n      <img src=\"https://localhost:3000/public/images/${productDetail.images}\" alt=\"${productDetail.name}\" style=\"max-width: 100px; height: auto; border-radius: 5px; margin-right: 15px;\" />\n      <div style=\"flex-grow: 1;\">\n        <h4 style=\"margin: 0; font-size: 16px; color: #333;\">${productDetail.name}</h4>\n        <p style=\"margin: 5px 0; font-size: 14px; color: #666;\">Marka: ${productDetail.seller?.SellerName //name olacak\n    }</p>\n        <p style=\"margin: 5px 0; font-size: 14px; color: #666;\">Adet: ${cartProduct.quantity}</p>\n        <p style=\"margin: 5px 0; font-size: 14px; color: #666;\">Fiyat: ${productDetail.price} TL</p>\n        <p style=\"margin: 5px 0; font-size: 14px; color: #666;\"><strong>Toplam: ${(productDetail.price * cartProduct.quantity).toFixed(2)} TL</strong></p>\n      </div>\n    </div>\n    <hr style=\"border: 1px solid #e0e0e0;\">\n  `;\n  }).join(\"\");\n\n  // Toplam fiyatı hesaplıyoruz (ürün fiyatı * adet)\n  const totalPrice = enrichedProducts.map(product => product.productDetail.price * product.quantity).reduce((total, price) => total + price, 0).toFixed(2);\n\n  // E-posta gönderimi için mail transporter oluşturuyoruz\n  const transporter = _nodemailer.default.createTransport({\n    host: \"smtp.yandex.com\",\n    port: 465,\n    secure: true,\n    auth: {\n      user: process.env.MAIL_SENDER,\n      pass: process.env.MAIL_SENDER_PASSWORD\n    },\n    debug: true,\n    logger: true\n  });\n\n  // Gönderilecek e-posta içeriğini hazırlıyoruz\n  const mailOptions = {\n    from: `\"TURKOTREND\" <${process.env.MAIL_SENDER}>`,\n    to: email,\n    subject: \"Siparişiniz alındı\",\n    html: `\n    <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #f0f0f0; border-radius: 10px; background-color: #fafafa;\">\n      <div style=\"text-align: center; padding-bottom: 20px;\">\n        <img src=\"https://example.com/logo.png\" alt=\"Logo\" style=\"max-width: 150px;\">\n      </div>\n      <div style=\"background-color: #ffffff; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\">\n        <h2 style=\"color: #333333; text-align: center;\">Siparişiniz Başarıyla Alındı!</h2>\n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">Merhaba <strong>${user.name}</strong>,</p>\n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">\n          <strong>${cart.uuid}</strong> numaralı siparişiniz alındı ve en kısa zamanda kargoya verilecektir.\n        </p>\n\n        <div style=\"margin: 20px 0;\">\n          <h3 style=\"font-size: 18px; color: #333333; text-align: center;\">Sipariş Detayları:</h3>\n          ${productsList}\n        </div>\n\n        <div style=\"background-color: #f8f9fa; padding: 15px; margin: 20px 0; border-left: 5px solid #17a2b8; border-radius: 5px;\">\n          <p style=\"margin: 0; font-size: 16px; text-align: center;\">\n            <strong>Toplam Tutar: ${totalPrice} TL</strong>\n          </p>\n        </div>\n\n        \n      </div>\n\n      <div style=\"text-align: center; margin-top: 20px;\">\n        <p style=\"font-size: 14px; color: #999999;\">Sorularınız için bize ulaşmaktan çekinmeyin.</p>\n        <p style=\"font-size: 14px; color: #999999;\">© 2024 TURKOTREND. Tüm hakları saklıdır.</p>\n      </div>\n    </div>\n  `\n  };\n  try {\n    await transporter.sendMail(mailOptions);\n    return res.status(200);\n  } catch (error) {\n    console.error(error);\n    return next(new _ApiError.default(500, \"Doğrulama e-postası gönderilemedi\"));\n  }\n};\nvar _default = exports.default = sendCompletedOrderEmail;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbm9kZW1haWxlciIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2NhcnQiLCJfcHJvZHVjdHMiLCJfdXNlcnMiLCJfQXBpRXJyb3IiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJzZW5kQ29tcGxldGVkT3JkZXJFbWFpbCIsInJlcSIsInJlcyIsIm5leHQiLCJlbWFpbCIsInVzZXIiLCJVc2VycyIsImZpbmRPbmUiLCJBcGlFcnJvciIsImNhcnQiLCJDYXJ0cyIsImJ1eWVyIiwiX2lkIiwic29ydCIsImNyZWF0ZWRBdCIsInByb2R1Y3RJZHMiLCJwcm9kdWN0cyIsIm1hcCIsIml0ZW0iLCJwcm9kdWN0SWQiLCJQcm9kdWN0cyIsImZpbmQiLCIkaW4iLCJwb3B1bGF0ZSIsImVucmljaGVkUHJvZHVjdHMiLCJjYXJ0UHJvZHVjdCIsInByb2R1Y3REZXRhaWwiLCJwcm9kdWN0IiwiU3RyaW5nIiwiX2RvYyIsInByb2R1Y3RzTGlzdCIsImltYWdlcyIsIm5hbWUiLCJzZWxsZXIiLCJTZWxsZXJOYW1lIiwicXVhbnRpdHkiLCJwcmljZSIsInRvRml4ZWQiLCJqb2luIiwidG90YWxQcmljZSIsInJlZHVjZSIsInRvdGFsIiwidHJhbnNwb3J0ZXIiLCJub2RlbWFpbGVyIiwiY3JlYXRlVHJhbnNwb3J0IiwiaG9zdCIsInBvcnQiLCJzZWN1cmUiLCJhdXRoIiwicHJvY2VzcyIsImVudiIsIk1BSUxfU0VOREVSIiwicGFzcyIsIk1BSUxfU0VOREVSX1BBU1NXT1JEIiwiZGVidWciLCJsb2dnZXIiLCJtYWlsT3B0aW9ucyIsImZyb20iLCJ0byIsInN1YmplY3QiLCJodG1sIiwidXVpZCIsInNlbmRNYWlsIiwic3RhdHVzIiwiZXJyb3IiLCJjb25zb2xlIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvbWlkZGxld2FyZXMvIiwic291cmNlcyI6WyJPcmRlckNvbXBsZXRlTWFpbC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgbm9kZW1haWxlciBmcm9tIFwibm9kZW1haWxlclwiO1xuaW1wb3J0IENhcnRzIGZyb20gXCIuLi9kYi9jYXJ0XCI7XG5pbXBvcnQgUHJvZHVjdHMgZnJvbSBcIi4uL2RiL3Byb2R1Y3RzXCI7IC8vIFByb2R1Y3RzIG1vZGVsaW5pIGVrbGV5aW5cbmltcG9ydCBVc2VycyBmcm9tIFwiLi4vZGIvdXNlcnNcIjtcbmltcG9ydCBBcGlFcnJvciBmcm9tIFwiLi4vZXJyb3JzL0FwaUVycm9yXCI7XG5cbmNvbnN0IHNlbmRDb21wbGV0ZWRPcmRlckVtYWlsID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIGNvbnN0IGVtYWlsID0gcmVxLnVzZXI/LmVtYWlsO1xuICBjb25zdCB1c2VyID0gYXdhaXQgVXNlcnMuZmluZE9uZSh7IGVtYWlsIH0pO1xuXG4gIGlmICghdXNlcikge1xuICAgIHJldHVybiBuZXh0KG5ldyBBcGlFcnJvcig0MDAsIFwiQ2FuIG5vdCBmaW5kIHVzZXJcIikpO1xuICB9XG5cbiAgLy8gRW4gc29uIG9sdcWfdHVydWxhbiBzZXBldGkgYnVsdXlvcnV6XG4gIGNvbnN0IGNhcnQgPSBhd2FpdCBDYXJ0cy5maW5kT25lKHsgYnV5ZXI6IHVzZXIuX2lkIH0pLnNvcnQoeyBjcmVhdGVkQXQ6IC0xIH0pO1xuXG4gIGlmICghY2FydCkge1xuICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhbiBub3QgZmluZCBjYXJ0XCIsIDQwMCwgXCJjYW5Ob3RGaW5kQ2FydFwiKTtcbiAgfVxuXG4gIC8vIENhcnQgacOnaW5kZWtpIHByb2R1Y3RJZCdsZXJpIHZlIG1pa3RhcmxhcsSxIGt1bGxhbmFyYWsgw7xyw7xuIGRldGF5bGFyxLFuxLEgw6dla2l5b3J1elxuICBjb25zdCBwcm9kdWN0SWRzID0gY2FydC5wcm9kdWN0cy5tYXAoKGl0ZW0pID0+IGl0ZW0ucHJvZHVjdElkKTtcbiAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBQcm9kdWN0cy5maW5kKHsgX2lkOiB7ICRpbjogcHJvZHVjdElkcyB9IH0pLnBvcHVsYXRlKFxuICAgIFwic2VsbGVyXCIsXG4gICAgXCJTZWxsZXJOYW1lXCJcbiAgKTtcblxuICAvLyBTZXBldCBpw6dpbmRla2kgw7xyw7xubGVyaW4gZGV0YXlsYXLEsW7EsSB6ZW5naW5sZcWfdGlyaXlvcnV6XG4gIGNvbnN0IGVucmljaGVkUHJvZHVjdHMgPSBjYXJ0LnByb2R1Y3RzLm1hcCgoY2FydFByb2R1Y3QpID0+IHtcbiAgICBjb25zdCBwcm9kdWN0RGV0YWlsID0gcHJvZHVjdHMuZmluZChcbiAgICAgIChwcm9kdWN0KSA9PiBTdHJpbmcocHJvZHVjdC5faWQpID09PSBTdHJpbmcoY2FydFByb2R1Y3QucHJvZHVjdElkKVxuICAgICk7XG4gICAgcmV0dXJuIHtcbiAgICAgIC4uLmNhcnRQcm9kdWN0Ll9kb2MsXG4gICAgICBwcm9kdWN0RGV0YWlsLFxuICAgIH07XG4gIH0pO1xuXG4gIC8vIMOccsO8bmxlcmluIEhUTUwgZm9ybWF0xLFuZGEgbGlzdGVzaW5pIG9sdcWfdHVydXlvcnV6XG4gIGNvbnN0IHByb2R1Y3RzTGlzdCA9IGVucmljaGVkUHJvZHVjdHNcbiAgICAubWFwKChjYXJ0UHJvZHVjdCkgPT4ge1xuICAgICAgY29uc3QgcHJvZHVjdERldGFpbCA9IGNhcnRQcm9kdWN0LnByb2R1Y3REZXRhaWw7XG4gICAgICByZXR1cm4gYFxuICAgIDxkaXYgc3R5bGU9XCJib3JkZXI6IDFweCBzb2xpZCAjZTBlMGUwOyBib3JkZXItcmFkaXVzOiA4cHg7IHBhZGRpbmc6IDE1cHg7IG1hcmdpbi1ib3R0b206IDE1cHg7IGRpc3BsYXk6IGZsZXg7IGFsaWduLWl0ZW1zOiBjZW50ZXI7IGJhY2tncm91bmQtY29sb3I6ICNmOWY5Zjk7XCI+XG4gICAgICA8aW1nIHNyYz1cImh0dHBzOi8vbG9jYWxob3N0OjMwMDAvcHVibGljL2ltYWdlcy8ke1xuICAgICAgICBwcm9kdWN0RGV0YWlsLmltYWdlc1xuICAgICAgfVwiIGFsdD1cIiR7XG4gICAgICAgIHByb2R1Y3REZXRhaWwubmFtZVxuICAgICAgfVwiIHN0eWxlPVwibWF4LXdpZHRoOiAxMDBweDsgaGVpZ2h0OiBhdXRvOyBib3JkZXItcmFkaXVzOiA1cHg7IG1hcmdpbi1yaWdodDogMTVweDtcIiAvPlxuICAgICAgPGRpdiBzdHlsZT1cImZsZXgtZ3JvdzogMTtcIj5cbiAgICAgICAgPGg0IHN0eWxlPVwibWFyZ2luOiAwOyBmb250LXNpemU6IDE2cHg7IGNvbG9yOiAjMzMzO1wiPiR7XG4gICAgICAgICAgcHJvZHVjdERldGFpbC5uYW1lXG4gICAgICAgIH08L2g0PlxuICAgICAgICA8cCBzdHlsZT1cIm1hcmdpbjogNXB4IDA7IGZvbnQtc2l6ZTogMTRweDsgY29sb3I6ICM2NjY7XCI+TWFya2E6ICR7XG4gICAgICAgICAgcHJvZHVjdERldGFpbC5zZWxsZXI/LlNlbGxlck5hbWUgLy9uYW1lIG9sYWNha1xuICAgICAgICB9PC9wPlxuICAgICAgICA8cCBzdHlsZT1cIm1hcmdpbjogNXB4IDA7IGZvbnQtc2l6ZTogMTRweDsgY29sb3I6ICM2NjY7XCI+QWRldDogJHtcbiAgICAgICAgICBjYXJ0UHJvZHVjdC5xdWFudGl0eVxuICAgICAgICB9PC9wPlxuICAgICAgICA8cCBzdHlsZT1cIm1hcmdpbjogNXB4IDA7IGZvbnQtc2l6ZTogMTRweDsgY29sb3I6ICM2NjY7XCI+Rml5YXQ6ICR7XG4gICAgICAgICAgcHJvZHVjdERldGFpbC5wcmljZVxuICAgICAgICB9IFRMPC9wPlxuICAgICAgICA8cCBzdHlsZT1cIm1hcmdpbjogNXB4IDA7IGZvbnQtc2l6ZTogMTRweDsgY29sb3I6ICM2NjY7XCI+PHN0cm9uZz5Ub3BsYW06ICR7KFxuICAgICAgICAgIHByb2R1Y3REZXRhaWwucHJpY2UgKiBjYXJ0UHJvZHVjdC5xdWFudGl0eVxuICAgICAgICApLnRvRml4ZWQoMil9IFRMPC9zdHJvbmc+PC9wPlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gICAgPGhyIHN0eWxlPVwiYm9yZGVyOiAxcHggc29saWQgI2UwZTBlMDtcIj5cbiAgYDtcbiAgICB9KVxuICAgIC5qb2luKFwiXCIpO1xuXG4gIC8vIFRvcGxhbSBmaXlhdMSxIGhlc2FwbMSxeW9ydXogKMO8csO8biBmaXlhdMSxICogYWRldClcbiAgY29uc3QgdG90YWxQcmljZSA9IGVucmljaGVkUHJvZHVjdHNcbiAgICAubWFwKChwcm9kdWN0KSA9PiBwcm9kdWN0LnByb2R1Y3REZXRhaWwucHJpY2UgKiBwcm9kdWN0LnF1YW50aXR5KVxuICAgIC5yZWR1Y2UoKHRvdGFsLCBwcmljZSkgPT4gdG90YWwgKyBwcmljZSwgMClcbiAgICAudG9GaXhlZCgyKTtcblxuICAvLyBFLXBvc3RhIGfDtm5kZXJpbWkgacOnaW4gbWFpbCB0cmFuc3BvcnRlciBvbHXFn3R1cnV5b3J1elxuICBjb25zdCB0cmFuc3BvcnRlciA9IG5vZGVtYWlsZXIuY3JlYXRlVHJhbnNwb3J0KHtcbiAgICBob3N0OiBcInNtdHAueWFuZGV4LmNvbVwiLFxuICAgIHBvcnQ6IDQ2NSxcbiAgICBzZWN1cmU6IHRydWUsXG4gICAgYXV0aDoge1xuICAgICAgdXNlcjogcHJvY2Vzcy5lbnYuTUFJTF9TRU5ERVIsXG4gICAgICBwYXNzOiBwcm9jZXNzLmVudi5NQUlMX1NFTkRFUl9QQVNTV09SRCxcbiAgICB9LFxuICAgIGRlYnVnOiB0cnVlLFxuICAgIGxvZ2dlcjogdHJ1ZSxcbiAgfSk7XG5cbiAgLy8gR8O2bmRlcmlsZWNlayBlLXBvc3RhIGnDp2VyacSfaW5pIGhhesSxcmzEsXlvcnV6XG4gIGNvbnN0IG1haWxPcHRpb25zID0ge1xuICAgIGZyb206IGBcIlRVUktPVFJFTkRcIiA8JHtwcm9jZXNzLmVudi5NQUlMX1NFTkRFUn0+YCxcbiAgICB0bzogZW1haWwsXG4gICAgc3ViamVjdDogXCJTaXBhcmnFn2luaXogYWzEsW5kxLFcIixcbiAgICBodG1sOiBgXG4gICAgPGRpdiBzdHlsZT1cImZvbnQtZmFtaWx5OiBBcmlhbCwgc2Fucy1zZXJpZjsgbWF4LXdpZHRoOiA2MDBweDsgbWFyZ2luOiAwIGF1dG87IHBhZGRpbmc6IDIwcHg7IGJvcmRlcjogMXB4IHNvbGlkICNmMGYwZjA7IGJvcmRlci1yYWRpdXM6IDEwcHg7IGJhY2tncm91bmQtY29sb3I6ICNmYWZhZmE7XCI+XG4gICAgICA8ZGl2IHN0eWxlPVwidGV4dC1hbGlnbjogY2VudGVyOyBwYWRkaW5nLWJvdHRvbTogMjBweDtcIj5cbiAgICAgICAgPGltZyBzcmM9XCJodHRwczovL2V4YW1wbGUuY29tL2xvZ28ucG5nXCIgYWx0PVwiTG9nb1wiIHN0eWxlPVwibWF4LXdpZHRoOiAxNTBweDtcIj5cbiAgICAgIDwvZGl2PlxuICAgICAgPGRpdiBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6ICNmZmZmZmY7IHBhZGRpbmc6IDIwcHg7IGJvcmRlci1yYWRpdXM6IDEwcHg7IGJveC1zaGFkb3c6IDAgMCAxMHB4IHJnYmEoMCwgMCwgMCwgMC4xKTtcIj5cbiAgICAgICAgPGgyIHN0eWxlPVwiY29sb3I6ICMzMzMzMzM7IHRleHQtYWxpZ246IGNlbnRlcjtcIj5TaXBhcmnFn2luaXogQmHFn2FyxLF5bGEgQWzEsW5kxLEhPC9oMj5cbiAgICAgICAgPHAgc3R5bGU9XCJmb250LXNpemU6IDE2cHg7IGNvbG9yOiAjNTU1NTU1OyB0ZXh0LWFsaWduOiBjZW50ZXI7XCI+TWVyaGFiYSA8c3Ryb25nPiR7dXNlci5uYW1lfTwvc3Ryb25nPiw8L3A+XG4gICAgICAgIDxwIHN0eWxlPVwiZm9udC1zaXplOiAxNnB4OyBjb2xvcjogIzU1NTU1NTsgdGV4dC1hbGlnbjogY2VudGVyO1wiPlxuICAgICAgICAgIDxzdHJvbmc+JHtjYXJ0LnV1aWR9PC9zdHJvbmc+IG51bWFyYWzEsSBzaXBhcmnFn2luaXogYWzEsW5kxLEgdmUgZW4ga8Sxc2EgemFtYW5kYSBrYXJnb3lhIHZlcmlsZWNla3Rpci5cbiAgICAgICAgPC9wPlxuXG4gICAgICAgIDxkaXYgc3R5bGU9XCJtYXJnaW46IDIwcHggMDtcIj5cbiAgICAgICAgICA8aDMgc3R5bGU9XCJmb250LXNpemU6IDE4cHg7IGNvbG9yOiAjMzMzMzMzOyB0ZXh0LWFsaWduOiBjZW50ZXI7XCI+U2lwYXJpxZ8gRGV0YXlsYXLEsTo8L2gzPlxuICAgICAgICAgICR7cHJvZHVjdHNMaXN0fVxuICAgICAgICA8L2Rpdj5cblxuICAgICAgICA8ZGl2IHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjogI2Y4ZjlmYTsgcGFkZGluZzogMTVweDsgbWFyZ2luOiAyMHB4IDA7IGJvcmRlci1sZWZ0OiA1cHggc29saWQgIzE3YTJiODsgYm9yZGVyLXJhZGl1czogNXB4O1wiPlxuICAgICAgICAgIDxwIHN0eWxlPVwibWFyZ2luOiAwOyBmb250LXNpemU6IDE2cHg7IHRleHQtYWxpZ246IGNlbnRlcjtcIj5cbiAgICAgICAgICAgIDxzdHJvbmc+VG9wbGFtIFR1dGFyOiAke3RvdGFsUHJpY2V9IFRMPC9zdHJvbmc+XG4gICAgICAgICAgPC9wPlxuICAgICAgICA8L2Rpdj5cblxuICAgICAgICBcbiAgICAgIDwvZGl2PlxuXG4gICAgICA8ZGl2IHN0eWxlPVwidGV4dC1hbGlnbjogY2VudGVyOyBtYXJnaW4tdG9wOiAyMHB4O1wiPlxuICAgICAgICA8cCBzdHlsZT1cImZvbnQtc2l6ZTogMTRweDsgY29sb3I6ICM5OTk5OTk7XCI+U29ydWxhcsSxbsSxeiBpw6dpbiBiaXplIHVsYcWfbWFrdGFuIMOnZWtpbm1leWluLjwvcD5cbiAgICAgICAgPHAgc3R5bGU9XCJmb250LXNpemU6IDE0cHg7IGNvbG9yOiAjOTk5OTk5O1wiPsKpIDIwMjQgVFVSS09UUkVORC4gVMO8bSBoYWtsYXLEsSBzYWtsxLFkxLFyLjwvcD5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICBgLFxuICB9O1xuXG4gIHRyeSB7XG4gICAgYXdhaXQgdHJhbnNwb3J0ZXIuc2VuZE1haWwobWFpbE9wdGlvbnMpO1xuICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgcmV0dXJuIG5leHQobmV3IEFwaUVycm9yKDUwMCwgXCJEb8SfcnVsYW1hIGUtcG9zdGFzxLEgZ8O2bmRlcmlsZW1lZGlcIikpO1xuICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBzZW5kQ29tcGxldGVkT3JkZXJFbWFpbDtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsV0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsS0FBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsU0FBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUcsTUFBQSxHQUFBSixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUksU0FBQSxHQUFBTCxzQkFBQSxDQUFBQyxPQUFBO0FBQTBDLFNBQUFELHVCQUFBTSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBRkg7O0FBSXZDLE1BQU1HLHVCQUF1QixHQUFHLE1BQUFBLENBQU9DLEdBQUcsRUFBRUMsR0FBRyxFQUFFQyxJQUFJLEtBQUs7RUFDeEQsTUFBTUMsS0FBSyxHQUFHSCxHQUFHLENBQUNJLElBQUksRUFBRUQsS0FBSztFQUM3QixNQUFNQyxJQUFJLEdBQUcsTUFBTUMsY0FBSyxDQUFDQyxPQUFPLENBQUM7SUFBRUg7RUFBTSxDQUFDLENBQUM7RUFFM0MsSUFBSSxDQUFDQyxJQUFJLEVBQUU7SUFDVCxPQUFPRixJQUFJLENBQUMsSUFBSUssaUJBQVEsQ0FBQyxHQUFHLEVBQUUsbUJBQW1CLENBQUMsQ0FBQztFQUNyRDs7RUFFQTtFQUNBLE1BQU1DLElBQUksR0FBRyxNQUFNQyxhQUFLLENBQUNILE9BQU8sQ0FBQztJQUFFSSxLQUFLLEVBQUVOLElBQUksQ0FBQ087RUFBSSxDQUFDLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO0lBQUVDLFNBQVMs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","map":{"version":3,"names":["_nodemailer","_interopRequireDefault","require","_cart","_products","_users","_ApiError","e","__esModule","default","sendCompletedOrderEmail","req","res","next","email","user","Users","findOne","ApiError","cart","Carts","buyer","_id","sort","createdAt","productIds","products","map","item","productId","Products","find","$in","populate","enrichedProducts","cartProduct","productDetail","product","String","_doc","productsList","images","name","seller","SellerName","quantity","price","toFixed","join","totalPrice","reduce","total","transporter","nodemailer","createTransport","host","port","secure","auth","process","env","MAIL_SENDER","pass","MAIL_SENDER_PASSWORD","debug","logger","mailOptions","from","to","subject","html","uuid","sendMail","status","error","console","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["OrderCompleteMail.js"],"sourcesContent":["import nodemailer from \"nodemailer\";\nimport Carts from \"../db/cart\";\nimport Products from \"../db/products\"; // Products modelini ekleyin\nimport Users from \"../db/users\";\nimport ApiError from \"../errors/ApiError\";\n\nconst sendCompletedOrderEmail = async (req, res, next) => {\n  const email = req.user?.email;\n  const user = await Users.findOne({ email });\n\n  if (!user) {\n    return next(new ApiError(400, \"Can not find user\"));\n  }\n\n  // En son oluşturulan sepeti buluyoruz\n  const cart = await Carts.findOne({ buyer: user._id }).sort({ createdAt: -1 });\n\n  if (!cart) {\n    throw new ApiError(\"Can not find cart\", 400, \"canNotFindCart\");\n  }\n\n  // Cart içindeki productId'leri ve miktarları kullanarak ürün detaylarını çekiyoruz\n  const productIds = cart.products.map((item) => item.productId);\n  const products = await Products.find({ _id: { $in: productIds } }).populate(\n    \"seller\",\n    \"SellerName\"\n  );\n\n  // Sepet içindeki ürünlerin detaylarını zenginleştiriyoruz\n  const enrichedProducts = cart.products.map((cartProduct) => {\n    const productDetail = products.find(\n      (product) => String(product._id) === String(cartProduct.productId)\n    );\n    return {\n      ...cartProduct._doc,\n      productDetail,\n    };\n  });\n\n  // Ürünlerin HTML formatında listesini oluşturuyoruz\n  const productsList = enrichedProducts\n    .map((cartProduct) => {\n      const productDetail = cartProduct.productDetail;\n      return `\n    <div style=\"border: 1px solid #e0e0e0; border-radius: 8px; padding: 15px; margin-bottom: 15px; display: flex; align-items: center; background-color: #f9f9f9;\">\n      <img src=\"https://localhost:3000/public/images/${\n        productDetail.images\n      }\" alt=\"${\n        productDetail.name\n      }\" style=\"max-width: 100px; height: auto; border-radius: 5px; margin-right: 15px;\" />\n      <div style=\"flex-grow: 1;\">\n        <h4 style=\"margin: 0; font-size: 16px; color: #333;\">${\n          productDetail.name\n        }</h4>\n        <p style=\"margin: 5px 0; font-size: 14px; color: #666;\">Marka: ${\n          productDetail.seller?.SellerName //name olacak\n        }</p>\n        <p style=\"margin: 5px 0; font-size: 14px; color: #666;\">Adet: ${\n          cartProduct.quantity\n        }</p>\n        <p style=\"margin: 5px 0; font-size: 14px; color: #666;\">Fiyat: ${\n          productDetail.price\n        } TL</p>\n        <p style=\"margin: 5px 0; font-size: 14px; color: #666;\"><strong>Toplam: ${(\n          productDetail.price * cartProduct.quantity\n        ).toFixed(2)} TL</strong></p>\n      </div>\n    </div>\n    <hr style=\"border: 1px solid #e0e0e0;\">\n  `;\n    })\n    .join(\"\");\n\n  // Toplam fiyatı hesaplıyoruz (ürün fiyatı * adet)\n  const totalPrice = enrichedProducts\n    .map((product) => product.productDetail.price * product.quantity)\n    .reduce((total, price) => total + price, 0)\n    .toFixed(2);\n\n  // E-posta gönderimi için mail transporter oluşturuyoruz\n  const transporter = nodemailer.createTransport({\n    host: \"smtp.yandex.com\",\n    port: 465,\n    secure: true,\n    auth: {\n      user: process.env.MAIL_SENDER,\n      pass: process.env.MAIL_SENDER_PASSWORD,\n    },\n    debug: true,\n    logger: true,\n  });\n\n  // Gönderilecek e-posta içeriğini hazırlıyoruz\n  const mailOptions = {\n    from: `\"TURKOTREND\" <${process.env.MAIL_SENDER}>`,\n    to: email,\n    subject: \"Siparişiniz alındı\",\n    html: `\n    <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #f0f0f0; border-radius: 10px; background-color: #fafafa;\">\n      <div style=\"text-align: center; padding-bottom: 20px;\">\n        <img src=\"https://example.com/logo.png\" alt=\"Logo\" style=\"max-width: 150px;\">\n      </div>\n      <div style=\"background-color: #ffffff; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\">\n        <h2 style=\"color: #333333; text-align: center;\">Siparişiniz Başarıyla Alındı!</h2>\n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">Merhaba <strong>${user.name}</strong>,</p>\n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">\n          <strong>${cart.uuid}</strong> numaralı siparişiniz alındı ve en kısa zamanda kargoya verilecektir.\n        </p>\n\n        <div style=\"margin: 20px 0;\">\n          <h3 style=\"font-size: 18px; color: #333333; text-align: center;\">Sipariş Detayları:</h3>\n          ${productsList}\n        </div>\n\n        <div style=\"background-color: #f8f9fa; padding: 15px; margin: 20px 0; border-left: 5px solid #17a2b8; border-radius: 5px;\">\n          <p style=\"margin: 0; font-size: 16px; text-align: center;\">\n            <strong>Toplam Tutar: ${totalPrice} TL</strong>\n          </p>\n        </div>\n\n        \n      </div>\n\n      <div style=\"text-align: center; margin-top: 20px;\">\n        <p style=\"font-size: 14px; color: #999999;\">Sorularınız için bize ulaşmaktan çekinmeyin.</p>\n        <p style=\"font-size: 14px; color: #999999;\">© 2024 TURKOTREND. Tüm hakları saklıdır.</p>\n      </div>\n    </div>\n  `,\n  };\n\n  try {\n    await transporter.sendMail(mailOptions);\n    return res.status(200);\n  } catch (error) {\n    console.error(error);\n    return next(new ApiError(500, \"Doğrulama e-postası gönderilemedi\"));\n  }\n};\n\nexport default sendCompletedOrderEmail;\n"],"mappings":"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","ignoreList":[]}},"mtime":1733223942298},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/OrderCanceledMail.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _nodemailer = _interopRequireDefault(require(\"nodemailer\"));\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _paymentSuccess = _interopRequireDefault(require(\"../db/payment-success\"));\nvar _cart = _interopRequireDefault(require(\"../db/cart\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst sendCanceledOrderEmail = async (req, res, next) => {\n  const email = req.user?.email;\n  const user = await _users.default.findOne({\n    email\n  });\n  const cart = await _cart.default.findOne({\n    buyer: user._id\n  }).populate(\"products\").sort({\n    createdAt: -1\n  });\n  if (!user) {\n    return next(new _ApiError.default(400, \"Can not find user\"));\n  }\n  const payment = await _paymentSuccess.default.findOne({\n    cartId: user._id\n  }).populate(\"products\").sort({\n    createdAt: -1\n  });\n  if (!cart) {\n    throw new _ApiError.default(\"Can not find cart\", 400, \"canNotFindCart\");\n  }\n  const transporter = _nodemailer.default.createTransport({\n    service: \"gmail\",\n    auth: {\n      user: \"atkahmed9924@gmail.com\",\n      //yandex mail yazılacak\n      pass: \"pwyh yojo pdaw welz\" // gmail uygulama şifresi bölümünden alındı\n    }\n  });\n  console.log(cart.products); // Tüm ürünlerin bu array içinde olup olmadığını kontrol edin\n\n  const productsList = cart.products.map(product => `\n      <div style=\"margin-bottom: 20px;\">\n      <img src=\"${product.images}\" alt=\"${product.name}\" style=\"max-width: 200px; height: auto;\" />\n      <p>Ürün Adı: ${product.name}</p>\n      <p>Ürün Markası: ${product.brand}</p>\n      <p>Ürün Fiyatı: ${product.price}</p>\n    </div>\n    <hr>\n  `).join(\"\");\n  console.log(productsList);\n  const totalPrice = cart.products.reduce((total, product) => total + product.price, 0);\n  const mailOptions = {\n    from: \"atkahmed9924@gmail.com\",\n    to: email,\n    subject: \"Siparişiniz İptal Edildi\",\n    html: `\n    <p>Merhaba ${user.name},</p>\n    <p>${payment.paymentId} numaralı Siparişiniz İptal Edilmiştir.</p>\n    ${productsList}\n    <p><strong>Toplam Fiyat: ${totalPrice} TL</strong></p>\n           <p>Teşekkür ederiz</p>`\n  };\n  try {\n    await transporter.sendMail(mailOptions);\n    // next();\n  } catch (error) {\n    console.log(error);\n    return next(new _ApiError.default(500, \"Doğrulama e-postası gönderilemedi\"));\n  }\n};\nvar _default = exports.default = sendCanceledOrderEmail;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbm9kZW1haWxlciIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX3VzZXJzIiwiX0FwaUVycm9yIiwiX3BheW1lbnRTdWNjZXNzIiwiX2NhcnQiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJzZW5kQ2FuY2VsZWRPcmRlckVtYWlsIiwicmVxIiwicmVzIiwibmV4dCIsImVtYWlsIiwidXNlciIsIlVzZXJzIiwiZmluZE9uZSIsImNhcnQiLCJDYXJ0cyIsImJ1eWVyIiwiX2lkIiwicG9wdWxhdGUiLCJzb3J0IiwiY3JlYXRlZEF0IiwiQXBpRXJyb3IiLCJwYXltZW50IiwiUGF5bWVudFN1Y2Nlc3MiLCJjYXJ0SWQiLCJ0cmFuc3BvcnRlciIsIm5vZGVtYWlsZXIiLCJjcmVhdGVUcmFuc3BvcnQiLCJzZXJ2aWNlIiwiYXV0aCIsInBhc3MiLCJjb25zb2xlIiwibG9nIiwicHJvZHVjdHMiLCJwcm9kdWN0c0xpc3QiLCJtYXAiLCJwcm9kdWN0IiwiaW1hZ2VzIiwibmFtZSIsImJyYW5kIiwicHJpY2UiLCJqb2luIiwidG90YWxQcmljZSIsInJlZHVjZSIsInRvdGFsIiwibWFpbE9wdGlvbnMiLCJmcm9tIiwidG8iLCJzdWJqZWN0IiwiaHRtbCIsInBheW1lbnRJZCIsInNlbmRNYWlsIiwiZXJyb3IiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9taWRkbGV3YXJlcy8iLCJzb3VyY2VzIjpbIk9yZGVyQ2FuY2VsZWRNYWlsLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBub2RlbWFpbGVyIGZyb20gXCJub2RlbWFpbGVyXCI7XG5pbXBvcnQgVXNlcnMgZnJvbSBcIi4uL2RiL3VzZXJzXCI7XG5pbXBvcnQgQXBpRXJyb3IgZnJvbSBcIi4uL2Vycm9ycy9BcGlFcnJvclwiO1xuaW1wb3J0IFBheW1lbnRTdWNjZXNzIGZyb20gXCIuLi9kYi9wYXltZW50LXN1Y2Nlc3NcIjtcbmltcG9ydCBDYXJ0cyBmcm9tIFwiLi4vZGIvY2FydFwiO1xuXG5jb25zdCBzZW5kQ2FuY2VsZWRPcmRlckVtYWlsID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIGNvbnN0IGVtYWlsID0gcmVxLnVzZXI/LmVtYWlsO1xuICBjb25zdCB1c2VyID0gYXdhaXQgVXNlcnMuZmluZE9uZSh7IGVtYWlsIH0pO1xuICBjb25zdCBjYXJ0ID0gYXdhaXQgQ2FydHMuZmluZE9uZSh7IGJ1eWVyOiB1c2VyLl9pZCB9KVxuICAgIC5wb3B1bGF0ZShcInByb2R1Y3RzXCIpXG4gICAgLnNvcnQoeyBjcmVhdGVkQXQ6IC0xIH0pO1xuXG4gIGlmICghdXNlcikge1xuICAgIHJldHVybiBuZXh0KG5ldyBBcGlFcnJvcig0MDAsIFwiQ2FuIG5vdCBmaW5kIHVzZXJcIikpO1xuICB9XG4gIGNvbnN0IHBheW1lbnQgPSBhd2FpdCBQYXltZW50U3VjY2Vzcy5maW5kT25lKHsgY2FydElkOiB1c2VyLl9pZCB9KVxuICAgIC5wb3B1bGF0ZShcInByb2R1Y3RzXCIpXG4gICAgLnNvcnQoeyBjcmVhdGVkQXQ6IC0xIH0pO1xuXG4gIGlmICghY2FydCkge1xuICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhbiBub3QgZmluZCBjYXJ0XCIsIDQwMCwgXCJjYW5Ob3RGaW5kQ2FydFwiKTtcbiAgfVxuXG4gIGNvbnN0IHRyYW5zcG9ydGVyID0gbm9kZW1haWxlci5jcmVhdGVUcmFuc3BvcnQoe1xuICAgIHNlcnZpY2U6IFwiZ21haWxcIixcbiAgICBhdXRoOiB7XG4gICAgICB1c2VyOiBcImF0a2FobWVkOTkyNEBnbWFpbC5jb21cIiwgLy95YW5kZXggbWFpbCB5YXrEsWxhY2FrXG4gICAgICBwYXNzOiBcInB3eWggeW9qbyBwZGF3IHdlbHpcIiwgLy8gZ21haWwgdXlndWxhbWEgxZ9pZnJlc2kgYsO2bMO8bcO8bmRlbiBhbMSxbmTEsVxuICAgIH0sXG4gIH0pO1xuICBjb25zb2xlLmxvZyhjYXJ0LnByb2R1Y3RzKTsgLy8gVMO8bSDDvHLDvG5sZXJpbiBidSBhcnJheSBpw6dpbmRlIG9sdXAgb2xtYWTEscSfxLFuxLEga29udHJvbCBlZGluXG5cbiAgY29uc3QgcHJvZHVjdHNMaXN0ID0gY2FydC5wcm9kdWN0c1xuICAgIC5tYXAoXG4gICAgICAocHJvZHVjdCkgPT4gYFxuICAgICAgPGRpdiBzdHlsZT1cIm1hcmdpbi1ib3R0b206IDIwcHg7XCI+XG4gICAgICA8aW1nIHNyYz1cIiR7cHJvZHVjdC5pbWFnZXN9XCIgYWx0PVwiJHtwcm9kdWN0Lm5hbWV9XCIgc3R5bGU9XCJtYXgtd2lkdGg6IDIwMHB4OyBoZWlnaHQ6IGF1dG87XCIgLz5cbiAgICAgIDxwPsOccsO8biBBZMSxOiAke3Byb2R1Y3QubmFtZX08L3A+XG4gICAgICA8cD7DnHLDvG4gTWFya2FzxLE6ICR7cHJvZHVjdC5icmFuZH08L3A+XG4gICAgICA8cD7DnHLDvG4gRml5YXTEsTogJHtwcm9kdWN0LnByaWNlfTwvcD5cbiAgICA8L2Rpdj5cbiAgICA8aHI+XG4gIGBcbiAgICApXG4gICAgLmpvaW4oXCJcIik7XG4gIGNvbnNvbGUubG9nKHByb2R1Y3RzTGlzdCk7XG5cbiAgY29uc3QgdG90YWxQcmljZSA9IGNhcnQucHJvZHVjdHMucmVkdWNlKFxuICAgICh0b3RhbCwgcHJvZHVjdCkgPT4gdG90YWwgKyBwcm9kdWN0LnByaWNlLFxuICAgIDBcbiAgKTtcblxuICBjb25zdCBtYWlsT3B0aW9ucyA9IHtcbiAgICBmcm9tOiBcImF0a2FobWVkOTkyNEBnbWFpbC5jb21cIixcbiAgICB0bzogZW1haWwsXG4gICAgc3ViamVjdDogXCJTaXBhcmnFn2luaXogxLBwdGFsIEVkaWxkaVwiLFxuICAgIGh0bWw6IGBcbiAgICA8cD5NZXJoYWJhICR7dXNlci5uYW1lfSw8L3A+XG4gICAgPHA+JHtwYXltZW50LnBheW1lbnRJZH0gbnVtYXJhbMSxIFNpcGFyacWfaW5peiDEsHB0YWwgRWRpbG1pxZ90aXIuPC9wPlxuICAgICR7cHJvZHVjdHNMaXN0fVxuICAgIDxwPjxzdHJvbmc+VG9wbGFtIEZpeWF0OiAke3RvdGFsUHJpY2V9IFRMPC9zdHJvbmc+PC9wPlxuICAgICAgICAgICA8cD5UZcWfZWtrw7xyIGVkZXJpejwvcD5gLFxuICB9O1xuXG4gIHRyeSB7XG4gICAgYXdhaXQgdHJhbnNwb3J0ZXIuc2VuZE1haWwobWFpbE9wdGlvbnMpO1xuICAgIC8vIG5leHQoKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgcmV0dXJuIG5leHQobmV3IEFwaUVycm9yKDUwMCwgXCJEb8SfcnVsYW1hIGUtcG9zdGFzxLEgZ8O2bmRlcmlsZW1lZGlcIikpO1xuICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBzZW5kQ2FuY2VsZWRPcmRlckVtYWlsO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxXQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxNQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxTQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRyxlQUFBLEdBQUFKLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSSxLQUFBLEdBQUFMLHNCQUFBLENBQUFDLE9BQUE7QUFBK0IsU0FBQUQsdUJBQUFNLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFL0IsTUFBTUcsc0JBQXNCLEdBQUcsTUFBQUEsQ0FBT0MsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksS0FBSztFQUN2RCxNQUFNQyxLQUFLLEdBQUdILEdBQUcsQ0FBQ0ksSUFBSSxFQUFFRCxLQUFLO0VBQzdCLE1BQU1DLElBQUksR0FBRyxNQUFNQyxjQUFLLENBQUNDLE9BQU8sQ0FBQztJQUFFSDtFQUFNLENBQUMsQ0FBQztFQUMzQyxNQUFNSSxJQUFJLEdBQUcs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","map":{"version":3,"names":["_nodemailer","_interopRequireDefault","require","_users","_ApiError","_paymentSuccess","_cart","e","__esModule","default","sendCanceledOrderEmail","req","res","next","email","user","Users","findOne","cart","Carts","buyer","_id","populate","sort","createdAt","ApiError","payment","PaymentSuccess","cartId","transporter","nodemailer","createTransport","service","auth","pass","console","log","products","productsList","map","product","images","name","brand","price","join","totalPrice","reduce","total","mailOptions","from","to","subject","html","paymentId","sendMail","error","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["OrderCanceledMail.js"],"sourcesContent":["import nodemailer from \"nodemailer\";\nimport Users from \"../db/users\";\nimport ApiError from \"../errors/ApiError\";\nimport PaymentSuccess from \"../db/payment-success\";\nimport Carts from \"../db/cart\";\n\nconst sendCanceledOrderEmail = async (req, res, next) => {\n  const email = req.user?.email;\n  const user = await Users.findOne({ email });\n  const cart = await Carts.findOne({ buyer: user._id })\n    .populate(\"products\")\n    .sort({ createdAt: -1 });\n\n  if (!user) {\n    return next(new ApiError(400, \"Can not find user\"));\n  }\n  const payment = await PaymentSuccess.findOne({ cartId: user._id })\n    .populate(\"products\")\n    .sort({ createdAt: -1 });\n\n  if (!cart) {\n    throw new ApiError(\"Can not find cart\", 400, \"canNotFindCart\");\n  }\n\n  const transporter = nodemailer.createTransport({\n    service: \"gmail\",\n    auth: {\n      user: \"atkahmed9924@gmail.com\", //yandex mail yazılacak\n      pass: \"pwyh yojo pdaw welz\", // gmail uygulama şifresi bölümünden alındı\n    },\n  });\n  console.log(cart.products); // Tüm ürünlerin bu array içinde olup olmadığını kontrol edin\n\n  const productsList = cart.products\n    .map(\n      (product) => `\n      <div style=\"margin-bottom: 20px;\">\n      <img src=\"${product.images}\" alt=\"${product.name}\" style=\"max-width: 200px; height: auto;\" />\n      <p>Ürün Adı: ${product.name}</p>\n      <p>Ürün Markası: ${product.brand}</p>\n      <p>Ürün Fiyatı: ${product.price}</p>\n    </div>\n    <hr>\n  `\n    )\n    .join(\"\");\n  console.log(productsList);\n\n  const totalPrice = cart.products.reduce(\n    (total, product) => total + product.price,\n    0\n  );\n\n  const mailOptions = {\n    from: \"atkahmed9924@gmail.com\",\n    to: email,\n    subject: \"Siparişiniz İptal Edildi\",\n    html: `\n    <p>Merhaba ${user.name},</p>\n    <p>${payment.paymentId} numaralı Siparişiniz İptal Edilmiştir.</p>\n    ${productsList}\n    <p><strong>Toplam Fiyat: ${totalPrice} TL</strong></p>\n           <p>Teşekkür ederiz</p>`,\n  };\n\n  try {\n    await transporter.sendMail(mailOptions);\n    // next();\n  } catch (error) {\n    console.log(error);\n    return next(new ApiError(500, \"Doğrulama e-postası gönderilemedi\"));\n  }\n};\n\nexport default sendCanceledOrderEmail;\n"],"mappings":"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","ignoreList":[]}},"mtime":1724584426614},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/OrderCanceledMail.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _nodemailer = _interopRequireDefault(require(\"nodemailer\"));\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _paymentSuccess = _interopRequireDefault(require(\"../db/payment-success\"));\nvar _cart = _interopRequireDefault(require(\"../db/cart\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst sendCanceledOrderEmail = async (req, res, next) => {\n  const email = req.user?.email;\n  const user = await _users.default.findOne({\n    email\n  });\n  const cart = await _cart.default.findOne({\n    buyer: user._id\n  }).populate(\"products\").sort({\n    createdAt: -1\n  });\n  if (!user) {\n    return next(new _ApiError.default(400, \"Can not find user\"));\n  }\n  const payment = await _paymentSuccess.default.findOne({\n    cartId: user._id\n  }).populate(\"products\").sort({\n    createdAt: -1\n  });\n  if (!cart) {\n    throw new _ApiError.default(\"Can not find cart\", 400, \"canNotFindCart\");\n  }\n  const transporter = _nodemailer.default.createTransport({\n    service: \"gmail\",\n    auth: {\n      user: \"atkahmed9924@gmail.com\",\n      //yandex mail yazılacak\n      pass: \"pwyh yojo pdaw welz\" // gmail uygulama şifresi bölümünden alındı\n    }\n  });\n  console.log(cart.products); // Tüm ürünlerin bu array içinde olup olmadığını kontrol edin\n\n  const productsList = cart.products.map(product => `\n      <div style=\"margin-bottom: 20px;\">\n      <img src=\"${product.images}\" alt=\"${product.name}\" style=\"max-width: 200px; height: auto;\" />\n      <p>Ürün Adı: ${product.name}</p>\n      <p>Ürün Markası: ${product.brand}</p>\n      <p>Ürün Fiyatı: ${product.price}</p>\n    </div>\n    <hr>\n  `).join(\"\");\n  console.log(productsList);\n  const totalPrice = cart.products.reduce((total, product) => total + product.price, 0);\n  const mailOptions = {\n    from: \"atkahmed9924@gmail.com\",\n    to: email,\n    subject: \"Siparişiniz İptal Edildi\",\n    html: `\n    <p>Merhaba ${user.name},</p>\n    <p>${payment.paymentId} numaralı Siparişiniz İptal Edilmiştir.</p>\n    ${productsList}\n    <p><strong>Toplam Fiyat: ${totalPrice} TL</strong></p>\n           <p>Teşekkür ederiz</p>`\n  };\n  try {\n    await transporter.sendMail(mailOptions);\n    // next();\n  } catch (error) {\n    console.log(error);\n    return next(new _ApiError.default(500, \"Doğrulama e-postası gönderilemedi\"));\n  }\n};\nvar _default = exports.default = sendCanceledOrderEmail;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbm9kZW1haWxlciIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX3VzZXJzIiwiX0FwaUVycm9yIiwiX3BheW1lbnRTdWNjZXNzIiwiX2NhcnQiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJzZW5kQ2FuY2VsZWRPcmRlckVtYWlsIiwicmVxIiwicmVzIiwibmV4dCIsImVtYWlsIiwidXNlciIsIlVzZXJzIiwiZmluZE9uZSIsImNhcnQiLCJDYXJ0cyIsImJ1eWVyIiwiX2lkIiwicG9wdWxhdGUiLCJzb3J0IiwiY3JlYXRlZEF0IiwiQXBpRXJyb3IiLCJwYXltZW50IiwiUGF5bWVudFN1Y2Nlc3MiLCJjYXJ0SWQiLCJ0cmFuc3BvcnRlciIsIm5vZGVtYWlsZXIiLCJjcmVhdGVUcmFuc3BvcnQiLCJzZXJ2aWNlIiwiYXV0aCIsInBhc3MiLCJjb25zb2xlIiwibG9nIiwicHJvZHVjdHMiLCJwcm9kdWN0c0xpc3QiLCJtYXAiLCJwcm9kdWN0IiwiaW1hZ2VzIiwibmFtZSIsImJyYW5kIiwicHJpY2UiLCJqb2luIiwidG90YWxQcmljZSIsInJlZHVjZSIsInRvdGFsIiwibWFpbE9wdGlvbnMiLCJmcm9tIiwidG8iLCJzdWJqZWN0IiwiaHRtbCIsInBheW1lbnRJZCIsInNlbmRNYWlsIiwiZXJyb3IiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9taWRkbGV3YXJlcy8iLCJzb3VyY2VzIjpbIk9yZGVyQ2FuY2VsZWRNYWlsLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBub2RlbWFpbGVyIGZyb20gXCJub2RlbWFpbGVyXCI7XG5pbXBvcnQgVXNlcnMgZnJvbSBcIi4uL2RiL3VzZXJzXCI7XG5pbXBvcnQgQXBpRXJyb3IgZnJvbSBcIi4uL2Vycm9ycy9BcGlFcnJvclwiO1xuaW1wb3J0IFBheW1lbnRTdWNjZXNzIGZyb20gXCIuLi9kYi9wYXltZW50LXN1Y2Nlc3NcIjtcbmltcG9ydCBDYXJ0cyBmcm9tIFwiLi4vZGIvY2FydFwiO1xuXG5jb25zdCBzZW5kQ2FuY2VsZWRPcmRlckVtYWlsID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIGNvbnN0IGVtYWlsID0gcmVxLnVzZXI/LmVtYWlsO1xuICBjb25zdCB1c2VyID0gYXdhaXQgVXNlcnMuZmluZE9uZSh7IGVtYWlsIH0pO1xuICBjb25zdCBjYXJ0ID0gYXdhaXQgQ2FydHMuZmluZE9uZSh7IGJ1eWVyOiB1c2VyLl9pZCB9KVxuICAgIC5wb3B1bGF0ZShcInByb2R1Y3RzXCIpXG4gICAgLnNvcnQoeyBjcmVhdGVkQXQ6IC0xIH0pO1xuXG4gIGlmICghdXNlcikge1xuICAgIHJldHVybiBuZXh0KG5ldyBBcGlFcnJvcig0MDAsIFwiQ2FuIG5vdCBmaW5kIHVzZXJcIikpO1xuICB9XG4gIGNvbnN0IHBheW1lbnQgPSBhd2FpdCBQYXltZW50U3VjY2Vzcy5maW5kT25lKHsgY2FydElkOiB1c2VyLl9pZCB9KVxuICAgIC5wb3B1bGF0ZShcInByb2R1Y3RzXCIpXG4gICAgLnNvcnQoeyBjcmVhdGVkQXQ6IC0xIH0pO1xuXG4gIGlmICghY2FydCkge1xuICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkNhbiBub3QgZmluZCBjYXJ0XCIsIDQwMCwgXCJjYW5Ob3RGaW5kQ2FydFwiKTtcbiAgfVxuXG4gIGNvbnN0IHRyYW5zcG9ydGVyID0gbm9kZW1haWxlci5jcmVhdGVUcmFuc3BvcnQoe1xuICAgIHNlcnZpY2U6IFwiZ21haWxcIixcbiAgICBhdXRoOiB7XG4gICAgICB1c2VyOiBcImF0a2FobWVkOTkyNEBnbWFpbC5jb21cIiwgLy95YW5kZXggbWFpbCB5YXrEsWxhY2FrXG4gICAgICBwYXNzOiBcInB3eWggeW9qbyBwZGF3IHdlbHpcIiwgLy8gZ21haWwgdXlndWxhbWEgxZ9pZnJlc2kgYsO2bMO8bcO8bmRlbiBhbMSxbmTEsVxuICAgIH0sXG4gIH0pO1xuICBjb25zb2xlLmxvZyhjYXJ0LnByb2R1Y3RzKTsgLy8gVMO8bSDDvHLDvG5sZXJpbiBidSBhcnJheSBpw6dpbmRlIG9sdXAgb2xtYWTEscSfxLFuxLEga29udHJvbCBlZGluXG5cbiAgY29uc3QgcHJvZHVjdHNMaXN0ID0gY2FydC5wcm9kdWN0c1xuICAgIC5tYXAoXG4gICAgICAocHJvZHVjdCkgPT4gYFxuICAgICAgPGRpdiBzdHlsZT1cIm1hcmdpbi1ib3R0b206IDIwcHg7XCI+XG4gICAgICA8aW1nIHNyYz1cIiR7cHJvZHVjdC5pbWFnZXN9XCIgYWx0PVwiJHtwcm9kdWN0Lm5hbWV9XCIgc3R5bGU9XCJtYXgtd2lkdGg6IDIwMHB4OyBoZWlnaHQ6IGF1dG87XCIgLz5cbiAgICAgIDxwPsOccsO8biBBZMSxOiAke3Byb2R1Y3QubmFtZX08L3A+XG4gICAgICA8cD7DnHLDvG4gTWFya2FzxLE6ICR7cHJvZHVjdC5icmFuZH08L3A+XG4gICAgICA8cD7DnHLDvG4gRml5YXTEsTogJHtwcm9kdWN0LnByaWNlfTwvcD5cbiAgICA8L2Rpdj5cbiAgICA8aHI+XG4gIGBcbiAgICApXG4gICAgLmpvaW4oXCJcIik7XG4gIGNvbnNvbGUubG9nKHByb2R1Y3RzTGlzdCk7XG5cbiAgY29uc3QgdG90YWxQcmljZSA9IGNhcnQucHJvZHVjdHMucmVkdWNlKFxuICAgICh0b3RhbCwgcHJvZHVjdCkgPT4gdG90YWwgKyBwcm9kdWN0LnByaWNlLFxuICAgIDBcbiAgKTtcblxuICBjb25zdCBtYWlsT3B0aW9ucyA9IHtcbiAgICBmcm9tOiBcImF0a2FobWVkOTkyNEBnbWFpbC5jb21cIixcbiAgICB0bzogZW1haWwsXG4gICAgc3ViamVjdDogXCJTaXBhcmnFn2luaXogxLBwdGFsIEVkaWxkaVwiLFxuICAgIGh0bWw6IGBcbiAgICA8cD5NZXJoYWJhICR7dXNlci5uYW1lfSw8L3A+XG4gICAgPHA+JHtwYXltZW50LnBheW1lbnRJZH0gbnVtYXJhbMSxIFNpcGFyacWfaW5peiDEsHB0YWwgRWRpbG1pxZ90aXIuPC9wPlxuICAgICR7cHJvZHVjdHNMaXN0fVxuICAgIDxwPjxzdHJvbmc+VG9wbGFtIEZpeWF0OiAke3RvdGFsUHJpY2V9IFRMPC9zdHJvbmc+PC9wPlxuICAgICAgICAgICA8cD5UZcWfZWtrw7xyIGVkZXJpejwvcD5gLFxuICB9O1xuXG4gIHRyeSB7XG4gICAgYXdhaXQgdHJhbnNwb3J0ZXIuc2VuZE1haWwobWFpbE9wdGlvbnMpO1xuICAgIC8vIG5leHQoKTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgcmV0dXJuIG5leHQobmV3IEFwaUVycm9yKDUwMCwgXCJEb8SfcnVsYW1hIGUtcG9zdGFzxLEgZ8O2bmRlcmlsZW1lZGlcIikpO1xuICB9XG59O1xuXG5leHBvcnQgZGVmYXVsdCBzZW5kQ2FuY2VsZWRPcmRlckVtYWlsO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxXQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxNQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxTQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRyxlQUFBLEdBQUFKLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSSxLQUFBLEdBQUFMLHNCQUFBLENBQUFDLE9BQUE7QUFBK0IsU0FBQUQsdUJBQUFNLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFL0IsTUFBTUcsc0JBQXNCLEdBQUcsTUFBQUEsQ0FBT0MsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksS0FBSztFQUN2RCxNQUFNQyxLQUFLLEdBQUdILEdBQUcsQ0FBQ0ksSUFBSSxFQUFFRCxLQUFLO0VBQzdCLE1BQU1DLElBQUksR0FBRyxNQUFNQyxjQUFLLENBQUNDLE9BQU8sQ0FBQztJQUFFSDtFQUFNLENBQUMsQ0FBQztFQUMzQyxNQUFNSSxJQUFJLEdBQUcs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","map":{"version":3,"names":["_nodemailer","_interopRequireDefault","require","_users","_ApiError","_paymentSuccess","_cart","e","__esModule","default","sendCanceledOrderEmail","req","res","next","email","user","Users","findOne","cart","Carts","buyer","_id","populate","sort","createdAt","ApiError","payment","PaymentSuccess","cartId","transporter","nodemailer","createTransport","service","auth","pass","console","log","products","productsList","map","product","images","name","brand","price","join","totalPrice","reduce","total","mailOptions","from","to","subject","html","paymentId","sendMail","error","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["OrderCanceledMail.js"],"sourcesContent":["import nodemailer from \"nodemailer\";\nimport Users from \"../db/users\";\nimport ApiError from \"../errors/ApiError\";\nimport PaymentSuccess from \"../db/payment-success\";\nimport Carts from \"../db/cart\";\n\nconst sendCanceledOrderEmail = async (req, res, next) => {\n  const email = req.user?.email;\n  const user = await Users.findOne({ email });\n  const cart = await Carts.findOne({ buyer: user._id })\n    .populate(\"products\")\n    .sort({ createdAt: -1 });\n\n  if (!user) {\n    return next(new ApiError(400, \"Can not find user\"));\n  }\n  const payment = await PaymentSuccess.findOne({ cartId: user._id })\n    .populate(\"products\")\n    .sort({ createdAt: -1 });\n\n  if (!cart) {\n    throw new ApiError(\"Can not find cart\", 400, \"canNotFindCart\");\n  }\n\n  const transporter = nodemailer.createTransport({\n    service: \"gmail\",\n    auth: {\n      user: \"atkahmed9924@gmail.com\", //yandex mail yazılacak\n      pass: \"pwyh yojo pdaw welz\", // gmail uygulama şifresi bölümünden alındı\n    },\n  });\n  console.log(cart.products); // Tüm ürünlerin bu array içinde olup olmadığını kontrol edin\n\n  const productsList = cart.products\n    .map(\n      (product) => `\n      <div style=\"margin-bottom: 20px;\">\n      <img src=\"${product.images}\" alt=\"${product.name}\" style=\"max-width: 200px; height: auto;\" />\n      <p>Ürün Adı: ${product.name}</p>\n      <p>Ürün Markası: ${product.brand}</p>\n      <p>Ürün Fiyatı: ${product.price}</p>\n    </div>\n    <hr>\n  `\n    )\n    .join(\"\");\n  console.log(productsList);\n\n  const totalPrice = cart.products.reduce(\n    (total, product) => total + product.price,\n    0\n  );\n\n  const mailOptions = {\n    from: \"atkahmed9924@gmail.com\",\n    to: email,\n    subject: \"Siparişiniz İptal Edildi\",\n    html: `\n    <p>Merhaba ${user.name},</p>\n    <p>${payment.paymentId} numaralı Siparişiniz İptal Edilmiştir.</p>\n    ${productsList}\n    <p><strong>Toplam Fiyat: ${totalPrice} TL</strong></p>\n           <p>Teşekkür ederiz</p>`,\n  };\n\n  try {\n    await transporter.sendMail(mailOptions);\n    // next();\n  } catch (error) {\n    console.log(error);\n    return next(new ApiError(500, \"Doğrulama e-postası gönderilemedi\"));\n  }\n};\n\nexport default sendCanceledOrderEmail;\n"],"mappings":"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","ignoreList":[]}},"mtime":1724584426614},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/ForgotPasswordMail.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.forgotSellerPasswordEmail = exports.forgotPasswordEmail = void 0;\nvar _crypto = _interopRequireDefault(require(\"crypto\"));\nvar _nodemailer = _interopRequireDefault(require(\"nodemailer\"));\nvar _seller = _interopRequireDefault(require(\"../db/seller\"));\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _CheckExistence = require(\"../helpers/CheckExistence\");\nvar _RequiredCheck = require(\"../helpers/RequiredCheck\");\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\n// Kullanıcı modelinizi buraya dahil edin\n\n// Rastgele şifre üretme fonksiyonu\nconst generateRandomPassword = (length = 12) => {\n  return _crypto.default.randomBytes(length).toString(\"hex\").slice(0, length);\n};\nconst forgotPasswordEmail = async (req, res, next) => {\n  const {\n    email\n  } = req.body;\n  try {\n    (0, _RequiredCheck.checkRequiredField)(email, \"Email\");\n    const user = await _users.default.findOne({\n      email\n    });\n    (0, _CheckExistence.notFoundVariable)(user, \"User\");\n\n    // Rastgele bir şifre oluştur\n    const newPassword = generateRandomPassword();\n    console.log(\"Yeni Şifre\", newPassword);\n\n    // Kullanıcının şifresini yeni rastgele şifre ile güncelle\n    user.password = newPassword;\n    await user.save();\n\n    // E-posta ayarları\n    const transporter = _nodemailer.default.createTransport({\n      host: \"smtp.yandex.com\",\n      port: 465,\n      secure: true,\n      auth: {\n        user: process.env.MAIL_SENDER,\n        pass: process.env.MAIL_SENDER_PASSWORD\n      },\n      debug: true,\n      logger: true\n    });\n\n    // HTML e-posta tasarımı\n    const emailTemplate = `\n      <div style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; border: 1px solid #e1e4e8; border-radius: 8px; padding: 20px; background-color: #f9f9f9;\">\n        <div style=\"text-align: center; padding: 20px 0;\">\n          <img src=\"https://via.placeholder.com/150x50?text=Your+Logo\" alt=\"Logo\" style=\"max-width: 100px; margin-bottom: 20px;\" />\n          <h2 style=\"color: #444;\">Şifre Sıfırlama Talebiniz Tamamlandı</h2>\n        </div>\n        <p style=\"font-size: 16px;\">Merhaba <strong>${user.name || \"Kullanıcı\"}</strong>,</p>\n        <p style=\"font-size: 16px;\">Hesabınız için yeni bir şifre oluşturuldu. Aşağıda bu şifreyi bulabilirsiniz:</p>\n        <div style=\"background-color: #eef5fc; padding: 15px; text-align: center; margin: 20px 0; border-radius: 8px; border: 1px solid #d6e4f2;\">\n          <p style=\"font-size: 18px; font-weight: bold; color: #2a7ade;\">${newPassword}</p>\n        </div>\n        <p style=\"font-size: 16px;\">Güvenliğiniz için lütfen giriş yaptıktan sonra bu şifreyi değiştirin.</p>\n        <p style=\"font-size: 16px;\">Herhangi bir sorunla karşılaşırsanız lütfen bizimle iletişime geçmekten çekinmeyin.</p>\n        <hr style=\"border: 0; border-top: 1px solid #ddd; margin: 20px 0;\" />\n        <p style=\"font-size: 14px; color: #666; text-align: center;\">\n          Bu e-posta, şifre sıfırlama talebiniz üzerine gönderilmiştir. Eğer bu talebi siz yapmadıysanız, lütfen bizimle iletişime geçin.\n        </p>\n      </div>\n    `;\n    const mailOptions = {\n      from: `\"TURKOTREND\" <${process.env.MAIL_SENDER}>`,\n      to: email,\n      subject: \"Şifre Sıfırlama Talebiniz\",\n      html: emailTemplate\n    };\n\n    // E-postayı gönder\n    await transporter.sendMail(mailOptions);\n\n    // Başarı yanıtı\n    res.status(200).json({\n      message: \"Yeni şifreniz e-posta adresinize gönderildi.\"\n    });\n  } catch (error) {\n    console.error(error);\n    next(new _ApiError.default(\"There was an error sending the password reset email\", 500, \"emailSendingError\"));\n  }\n};\nexports.forgotPasswordEmail = forgotPasswordEmail;\nconst forgotSellerPasswordEmail = async (req, res, next) => {\n  const {\n    email\n  } = req.body;\n  try {\n    (0, _RequiredCheck.checkRequiredField)(email, \"Email\");\n    const seller = await _seller.default.findOne({\n      email\n    });\n    (0, _CheckExistence.notFoundVariable)(seller, \"Seller\");\n\n    // Rastgele bir şifre oluştur\n    const newPassword = generateRandomPassword();\n    console.log(\"Yeni Şifre\", newPassword);\n\n    // Kullanıcının şifresini yeni rastgele şifre ile güncelle\n    seller.password = newPassword;\n    await seller.save();\n\n    // E-posta ayarları\n    const transporter = _nodemailer.default.createTransport({\n      host: \"smtp.yandex.com\",\n      port: 465,\n      secure: true,\n      auth: {\n        user: process.env.MAIL_SENDER,\n        pass: process.env.MAIL_SENDER_PASSWORD\n      },\n      debug: true,\n      logger: true\n    });\n\n    // HTML e-posta tasarımı\n    const emailTemplate = `\n      <div style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; border: 1px solid #e1e4e8; border-radius: 8px; padding: 20px; background-color: #f9f9f9;\">\n        <div style=\"text-align: center; padding: 20px 0;\">\n          <img src=\"https://via.placeholder.com/150x50?text=Your+Logo\" alt=\"Logo\" style=\"max-width: 100px; margin-bottom: 20px;\" />\n          <h2 style=\"color: #444;\">Şifre Sıfırlama Talebiniz Tamamlandı</h2>\n        </div>\n        <p style=\"font-size: 16px;\">Merhaba <strong>${seller.name || \"Kullanıcı\"}</strong>,</p>\n        <p style=\"font-size: 16px;\">Hesabınız için yeni bir şifre oluşturuldu. Aşağıda bu şifreyi bulabilirsiniz:</p>\n        <div style=\"background-color: #eef5fc; padding: 15px; text-align: center; margin: 20px 0; border-radius: 8px; border: 1px solid #d6e4f2;\">\n          <p style=\"font-size: 18px; font-weight: bold; color: #2a7ade;\">${newPassword}</p>\n        </div>\n        <p style=\"font-size: 16px;\">Güvenliğiniz için lütfen giriş yaptıktan sonra bu şifreyi değiştirin.</p>\n        <p style=\"font-size: 16px;\">Herhangi bir sorunla karşılaşırsanız lütfen bizimle iletişime geçmekten çekinmeyin.</p>\n        <hr style=\"border: 0; border-top: 1px solid #ddd; margin: 20px 0;\" />\n        <p style=\"font-size: 14px; color: #666; text-align: center;\">\n          Bu e-posta, şifre sıfırlama talebiniz üzerine gönderilmiştir. Eğer bu talebi siz yapmadıysanız, lütfen bizimle iletişime geçin.\n        </p>\n      </div>\n    `;\n    const mailOptions = {\n      from: `\"TURKOTREND\" <${process.env.MAIL_SENDER}>`,\n      to: email,\n      subject: \"Şifre Sıfırlama Talebiniz\",\n      html: emailTemplate\n    };\n\n    // E-postayı gönder\n    await transporter.sendMail(mailOptions);\n\n    // Başarı yanıtı\n    res.status(200).json({\n      message: \"Yeni şifreniz e-posta adresinize gönderildi.\"\n    });\n  } catch (error) {\n    console.error(error);\n    next(new _ApiError.default(\"There was an error sending the password reset email\", 500, \"emailSendingError\"));\n  }\n};\nexports.forgotSellerPasswordEmail = forgotSellerPasswordEmail;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfY3J5cHRvIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfbm9kZW1haWxlciIsIl9zZWxsZXIiLCJfdXNlcnMiLCJfQXBpRXJyb3IiLCJfQ2hlY2tFeGlzdGVuY2UiLCJfUmVxdWlyZWRDaGVjayIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImdlbmVyYXRlUmFuZG9tUGFzc3dvcmQiLCJsZW5ndGgiLCJjcnlwdG8iLCJyYW5kb21CeXRlcyIsInRvU3RyaW5nIiwic2xpY2UiLCJmb3Jnb3RQYXNzd29yZEVtYWlsIiwicmVxIiwicmVzIiwibmV4dCIsImVtYWlsIiwiYm9keSIsImNoZWNrUmVxdWlyZWRGaWVsZCIsInVzZXIiLCJVc2VycyIsImZpbmRPbmUiLCJub3RGb3VuZFZhcmlhYmxlIiwibmV3UGFzc3dvcmQiLCJjb25zb2xlIiwibG9nIiwicGFzc3dvcmQiLCJzYXZlIiwidHJhbnNwb3J0ZXIiLCJub2RlbWFpbGVyIiwiY3JlYXRlVHJhbnNwb3J0IiwiaG9zdCIsInBvcnQiLCJzZWN1cmUiLCJhdXRoIiwicHJvY2VzcyIsImVudiIsIk1BSUxfU0VOREVSIiwicGFzcyIsIk1BSUxfU0VOREVSX1BBU1NXT1JEIiwiZGVidWciLCJsb2dnZXIiLCJlbWFpbFRlbXBsYXRlIiwibmFtZSIsIm1haWxPcHRpb25zIiwiZnJvbSIsInRvIiwic3ViamVjdCIsImh0bWwiLCJzZW5kTWFpbCIsInN0YXR1cyIsImpzb24iLCJtZXNzYWdlIiwiZXJyb3IiLCJBcGlFcnJvciIsImV4cG9ydHMiLCJmb3Jnb3RTZWxsZXJQYXNzd29yZEVtYWlsIiwic2VsbGVyIiwiU2VsbGVycyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL21pZGRsZXdhcmVzLyIsInNvdXJjZXMiOlsiRm9yZ290UGFzc3dvcmRNYWlsLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjcnlwdG8gZnJvbSBcImNyeXB0b1wiO1xuaW1wb3J0IG5vZGVtYWlsZXIgZnJvbSBcIm5vZGVtYWlsZXJcIjtcbmltcG9ydCBTZWxsZXJzIGZyb20gXCIuLi9kYi9zZWxsZXJcIjtcbmltcG9ydCBVc2VycyBmcm9tIFwiLi4vZGIvdXNlcnNcIjsgLy8gS3VsbGFuxLFjxLEgbW9kZWxpbml6aSBidXJheWEgZGFoaWwgZWRpblxuaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuLi9lcnJvcnMvQXBpRXJyb3JcIjtcbmltcG9ydCB7IG5vdEZvdW5kVmFyaWFibGUgfSBmcm9tIFwiLi4vaGVscGVycy9DaGVja0V4aXN0ZW5jZVwiO1xuaW1wb3J0IHsgY2hlY2tSZXF1aXJlZEZpZWxkIH0gZnJvbSBcIi4uL2hlbHBlcnMvUmVxdWlyZWRDaGVja1wiO1xuXG4vLyBSYXN0Z2VsZSDFn2lmcmUgw7xyZXRtZSBmb25rc2l5b251XG5jb25zdCBnZW5lcmF0ZVJhbmRvbVBhc3N3b3JkID0gKGxlbmd0aCA9IDEyKSA9PiB7XG4gIHJldHVybiBjcnlwdG8ucmFuZG9tQnl0ZXMobGVuZ3RoKS50b1N0cmluZyhcImhleFwiKS5zbGljZSgwLCBsZW5ndGgpO1xufTtcblxuY29uc3QgZm9yZ290UGFzc3dvcmRFbWFpbCA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICBjb25zdCB7IGVtYWlsIH0gPSByZXEuYm9keTtcblxuICB0cnkge1xuICAgIGNoZWNrUmVxdWlyZWRGaWVsZChlbWFpbCwgXCJFbWFpbFwiKTtcblxuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2Vycy5maW5kT25lKHsgZW1haWwgfSk7XG5cbiAgICBub3RGb3VuZFZhcmlhYmxlKHVzZXIsIFwiVXNlclwiKTtcblxuICAgIC8vIFJhc3RnZWxlIGJpciDFn2lmcmUgb2x1xZ90dXJcbiAgICBjb25zdCBuZXdQYXNzd29yZCA9IGdlbmVyYXRlUmFuZG9tUGFzc3dvcmQoKTtcbiAgICBjb25zb2xlLmxvZyhcIlllbmkgxZ5pZnJlXCIsIG5ld1Bhc3N3b3JkKTtcblxuICAgIC8vIEt1bGxhbsSxY8SxbsSxbiDFn2lmcmVzaW5pIHllbmkgcmFzdGdlbGUgxZ9pZnJlIGlsZSBnw7xuY2VsbGVcbiAgICB1c2VyLnBhc3N3b3JkID0gbmV3UGFzc3dvcmQ7XG4gICAgYXdhaXQgdXNlci5zYXZlKCk7XG5cbiAgICAvLyBFLXBvc3RhIGF5YXJsYXLEsVxuICAgIGNvbnN0IHRyYW5zcG9ydGVyID0gbm9kZW1haWxlci5jcmVhdGVUcmFuc3BvcnQoe1xuICAgICAgaG9zdDogXCJzbXRwLnlhbmRleC5jb21cIixcbiAgICAgIHBvcnQ6IDQ2NSxcbiAgICAgIHNlY3VyZTogdHJ1ZSxcbiAgICAgIGF1dGg6IHtcbiAgICAgICAgdXNlcjogcHJvY2Vzcy5lbnYuTUFJTF9TRU5ERVIsXG4gICAgICAgIHBhc3M6IHByb2Nlc3MuZW52Lk1BSUxfU0VOREVSX1BBU1NXT1JELFxuICAgICAgfSxcbiAgICAgIGRlYnVnOiB0cnVlLFxuICAgICAgbG9nZ2VyOiB0cnVlLFxuICAgIH0pO1xuXG4gICAgLy8gSFRNTCBlLXBvc3RhIHRhc2FyxLFtxLFcbiAgICBjb25zdCBlbWFpbFRlbXBsYXRlID0gYFxuICAgICAgPGRpdiBzdHlsZT1cImZvbnQtZmFtaWx5OiBBcmlhbCwgc2Fucy1zZXJpZjsgbGluZS1oZWlnaHQ6IDEuNjsgY29sb3I6ICMzMzM7IG1heC13aWR0aDogNjAwcHg7IG1hcmdpbjogMCBhdXRvOyBib3JkZXI6IDFweCBzb2xpZCAjZTFlNGU4OyBib3JkZXItcmFkaXVzOiA4cHg7IHBhZGRpbmc6IDIwcHg7IGJhY2tncm91bmQtY29sb3I6ICNmOWY5Zjk7XCI+XG4gICAgICAgIDxkaXYgc3R5bGU9XCJ0ZXh0LWFsaWduOiBjZW50ZXI7IHBhZGRpbmc6IDIwcHggMDtcIj5cbiAgICAgICAgICA8aW1nIHNyYz1cImh0dHBzOi8vdmlhLnBsYWNlaG9sZGVyLmNvbS8xNTB4NTA/dGV4dD1Zb3VyK0xvZ29cIiBhbHQ9XCJMb2dvXCIgc3R5bGU9XCJtYXgtd2lkdGg6IDEwMHB4OyBtYXJnaW4tYm90dG9tOiAyMHB4O1wiIC8+XG4gICAgICAgICAgPGgyIHN0eWxlPVwiY29sb3I6ICM0NDQ7XCI+xZ5pZnJlIFPEsWbEsXJsYW1hIFRhbGViaW5peiBUYW1hbWxhbmTEsTwvaDI+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8cCBzdHlsZT1cImZvbnQtc2l6ZTogMTZweDtcIj5NZXJoYWJhIDxzdHJvbmc+JHtcbiAgICAgICAgICB1c2VyLm5hbWUgfHwgXCJLdWxsYW7EsWPEsVwiXG4gICAgICAgIH08L3N0cm9uZz4sPC9wPlxuICAgICAgICA8cCBzdHlsZT1cImZvbnQtc2l6ZTogMTZweDtcIj5IZXNhYsSxbsSxeiBpw6dpbiB5ZW5pIGJpciDFn2lmcmUgb2x1xZ90dXJ1bGR1LiBBxZ9hxJ/EsWRhIGJ1IMWfaWZyZXlpIGJ1bGFiaWxpcnNpbml6OjwvcD5cbiAgICAgICAgPGRpdiBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6ICNlZWY1ZmM7IHBhZGRpbmc6IDE1cHg7IHRleHQtYWxpZ246IGNlbnRlcjsgbWFyZ2luOiAyMHB4IDA7IGJvcmRlci1yYWRpdXM6IDhweDsgYm9yZGVyOiAxcHggc29saWQgI2Q2ZTRmMjtcIj5cbiAgICAgICAgICA8cCBzdHlsZT1cImZvbnQtc2l6ZTogMThweDsgZm9udC13ZWlnaHQ6IGJvbGQ7IGNvbG9yOiAjMmE3YWRlO1wiPiR7bmV3UGFzc3dvcmR9PC9wPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPHAgc3R5bGU9XCJmb250LXNpemU6IDE2cHg7XCI+R8O8dmVubGnEn2luaXogacOnaW4gbMO8dGZlbiBnaXJpxZ8geWFwdMSxa3RhbiBzb25yYSBidSDFn2lmcmV5aSBkZcSfacWfdGlyaW4uPC9wPlxuICAgICAgICA8cCBzdHlsZT1cImZvbnQtc2l6ZTogMTZweDtcIj5IZXJoYW5naSBiaXIgc29ydW5sYSBrYXLFn8SxbGHFn8SxcnNhbsSxeiBsw7x0ZmVuIGJpemltbGUgaWxldGnFn2ltZSBnZcOnbWVrdGVuIMOnZWtpbm1leWluLjwvcD5cbiAgICAgICAgPGhyIHN0eWxlPVwiYm9yZGVyOiAwOyBib3JkZXItdG9wOiAxcHggc29saWQgI2RkZDsgbWFyZ2luOiAyMHB4IDA7XCIgLz5cbiAgICAgICAgPHAgc3R5bGU9XCJmb250LXNpemU6IDE0cHg7IGNvbG9yOiAjNjY2OyB0ZXh0LWFsaWduOiBjZW50ZXI7XCI+XG4gICAgICAgICAgQnUgZS1wb3N0YSwgxZ9pZnJlIHPEsWbEsXJsYW1hIHRhbGViaW5peiDDvHplcmluZSBnw7ZuZGVyaWxtacWfdGlyLiBFxJ9lciBidSB0YWxlYmkgc2l6IHlhcG1hZMSxeXNhbsSxeiwgbMO8dGZlbiBiaXppbWxlIGlsZXRpxZ9pbWUgZ2XDp2luLlxuICAgICAgICA8L3A+XG4gICAgICA8L2Rpdj5cbiAgICBgO1xuXG4gICAgY29uc3QgbWFpbE9wdGlvbnMgPSB7XG4gICAgICBmcm9tOiBgXCJUVVJLT1RSRU5EXCIgPCR7cHJvY2Vzcy5lbnYuTUFJTF9TRU5ERVJ9PmAsXG4gICAgICB0bzogZW1haWwsXG4gICAgICBzdWJqZWN0OiBcIsWeaWZyZSBTxLFmxLFybGFtYSBUYWxlYmluaXpcIixcbiAgICAgIGh0bWw6IGVtYWlsVGVtcGxhdGUsXG4gICAgfTtcblxuICAgIC8vIEUtcG9zdGF5xLEgZ8O2bmRlclxuICAgIGF3YWl0IHRyYW5zcG9ydGVyLnNlbmRNYWlsKG1haWxPcHRpb25zKTtcblxuICAgIC8vIEJhxZ9hcsSxIHlhbsSxdMSxXG4gICAgcmVzXG4gICAgICAuc3RhdHVzKDIwMClcbiAgICAgIC5qc29uKHsgbWVzc2FnZTogXCJZZW5pIMWfaWZyZW5peiBlLXBvc3RhIGFkcmVzaW5pemUgZ8O2bmRlcmlsZGkuXCIgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgbmV4dChcbiAgICAgIG5ldyBBcGlFcnJvcihcbiAgICAgICAgXCJUaGVyZSB3YXMgYW4gZXJyb3Igc2VuZGluZyB0aGUgcGFzc3dvcmQgcmVzZXQgZW1haWxcIixcbiAgICAgICAgNTAwLFxuICAgICAgICBcImVtYWlsU2VuZGluZ0Vycm9yXCJcbiAgICAgIClcbiAgICApO1xuICB9XG59O1xuXG5jb25zdCBmb3Jnb3RTZWxsZXJQYXNzd29yZEVtYWlsID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIGNvbnN0IHsgZW1haWwgfSA9IHJlcS5ib2R5O1xuXG4gIHRyeSB7XG4gICAgY2hlY2tSZXF1aXJlZEZpZWxkKGVtYWlsLCBcIkVtYWlsXCIpO1xuXG4gICAgY29uc3Qgc2VsbGVyID0gYXdhaXQgU2VsbGVycy5maW5kT25lKHsgZW1haWwgfSk7XG5cbiAgICBub3RGb3VuZFZhcmlhYmxlKHNlbGxlciwgXCJTZWxsZXJcIik7XG5cbiAgICAvLyBSYXN0Z2VsZSBiaXIgxZ9pZnJlIG9sdcWfdHVyXG4gICAgY29uc3QgbmV3UGFzc3dvcmQgPSBnZW5lcmF0ZVJhbmRvbVBhc3N3b3JkKCk7XG4gICAgY29uc29sZS5sb2coXCJZZW5pIMWeaWZyZVwiLCBuZXdQYXNzd29yZCk7XG5cbiAgICAvLyBLdWxsYW7EsWPEsW7EsW4gxZ9pZnJlc2luaSB5ZW5pIHJhc3RnZWxlIMWfaWZyZSBpbGUgZ8O8bmNlbGxlXG4gICAgc2VsbGVyLnBhc3N3b3JkID0gbmV3UGFzc3dvcmQ7XG4gICAgYXdhaXQgc2VsbGVyLnNhdmUoKTtcblxuICAgIC8vIEUtcG9zdGEgYXlhcmxhcsSxXG4gICAgY29uc3QgdHJhbnNwb3J0ZXIgPSBub2RlbWFpbGVyLmNyZWF0ZVRyYW5zcG9ydCh7XG4gICAgICBob3N0OiBcInNtdHAueWFuZGV4LmNvbVwiLFxuICAgICAgcG9ydDogNDY1LFxuICAgICAgc2VjdXJlOiB0cnVlLFxuICAgICAgYXV0aDoge1xuICAgICAgICB1c2VyOiBwcm9jZXNzLmVudi5NQUlMX1NFTkRFUixcbiAgICAgICAgcGFzczogcHJvY2Vzcy5lbnYuTUFJTF9TRU5ERVJfUEFTU1dPUkQsXG4gICAgICB9LFxuICAgICAgZGVidWc6IHRydWUsXG4gICAgICBsb2dnZXI6IHRydWUsXG4gICAgfSk7XG5cbiAgICAvLyBIVE1MIGUtcG9zdGEgdGFzYXLEsW3EsVxuICAgIGNvbnN0IGVtYWlsVGVtcGxhdGUgPSBgXG4gICAgICA8ZGl2IHN0eWxlPVwiZm9udC1mYW1pbHk6IEFyaWFsLCBzYW5zLXNlcmlmOyBsaW5lLWhlaWdodDogMS42OyBjb2xvcjogIzMzMzsgbWF4LXdpZHRoOiA2MDBweDsgbWFyZ2luOiAwIGF1dG87IGJvcmRlcjogMXB4IHNvbGlkICNlMWU0ZTg7IGJvcmRlci1yYWRpdXM6IDhweDsgcGFkZGluZzogMjBweDsgYmFja2dyb3VuZC1jb2xvcjogI2Y5ZjlmOTtcIj5cbiAgICAgICAgPGRpdiBzdHlsZT1cInRleHQtYWxpZ246IGNlbnRlcjsgcGFkZGluZzogMjBweCAwO1wiPlxuICAgICAgICAgIDxpbWcgc3JjPVwiaHR0cHM6Ly92aWEucGxhY2Vob2xkZXIuY29tLzE1MHg1MD90ZXh0PVlvdXIrTG9nb1wiIGFsdD1cIkxvZ29cIiBzdHlsZT1cIm1heC13aWR0aDogMTAwcHg7IG1hcmdpbi1ib3R0b206IDIwcHg7XCIgLz5cbiAgICAgICAgICA8aDIgc3R5bGU9XCJjb2xvcjogIzQ0NDtcIj7FnmlmcmUgU8SxZsSxcmxhbWEgVGFsZWJpbml6IFRhbWFtbGFuZMSxPC9oMj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxwIHN0eWxlPVwiZm9udC1zaXplOiAxNnB4O1wiPk1lcmhhYmEgPHN0cm9uZz4ke1xuICAgICAgICAgIHNlbGxlci5uYW1lIHx8IFwiS3VsbGFuxLFjxLFcIlxuICAgICAgICB9PC9zdHJvbmc+LDwvcD5cbiAgICAgICAgPHAgc3R5bGU9XCJmb250LXNpemU6IDE2cHg7XCI+SGVzYWLEsW7EsXogacOnaW4geWVuaSBiaXIgxZ9pZnJlIG9sdcWfdHVydWxkdS4gQcWfYcSfxLFkYSBidSDFn2lmcmV5aSBidWxhYmlsaXJzaW5pejo8L3A+XG4gICAgICAgIDxkaXYgc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiAjZWVmNWZjOyBwYWRkaW5nOiAxNXB4OyB0ZXh0LWFsaWduOiBjZW50ZXI7IG1hcmdpbjogMjBweCAwOyBib3JkZXItcmFkaXVzOiA4cHg7IGJvcmRlcjogMXB4IHNvbGlkICNkNmU0ZjI7XCI+XG4gICAgICAgICAgPHAgc3R5bGU9XCJmb250LXNpemU6IDE4cHg7IGZvbnQtd2VpZ2h0OiBib2xkOyBjb2xvcjogIzJhN2FkZTtcIj4ke25ld1Bhc3N3b3JkfTwvcD5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxwIHN0eWxlPVwiZm9udC1zaXplOiAxNnB4O1wiPkfDvHZlbmxpxJ9pbml6IGnDp2luIGzDvHRmZW4gZ2lyacWfIHlhcHTEsWt0YW4gc29ucmEgYnUgxZ9pZnJleWkgZGXEn2nFn3RpcmluLjwvcD5cbiAgICAgICAgPHAgc3R5bGU9XCJmb250LXNpemU6IDE2cHg7XCI+SGVyaGFuZ2kgYmlyIHNvcnVubGEga2FyxZ/EsWxhxZ/EsXJzYW7EsXogbMO8dGZlbiBiaXppbWxlIGlsZXRpxZ9pbWUgZ2XDp21la3RlbiDDp2VraW5tZXlpbi48L3A+XG4gICAgICAgIDxociBzdHlsZT1cImJvcmRlcjogMDsgYm9yZGVyLXRvcDogMXB4IHNvbGlkICNkZGQ7IG1hcmdpbjogMjBweCAwO1wiIC8+XG4gICAgICAgIDxwIHN0eWxlPVwiZm9udC1zaXplOiAxNHB4OyBjb2xvcjogIzY2NjsgdGV4dC1hbGlnbjogY2VudGVyO1wiPlxuICAgICAgICAgIEJ1IGUtcG9zdGEsIMWfaWZyZSBzxLFmxLFybGFtYSB0YWxlYmluaXogw7x6ZXJpbmUgZ8O2bmRlcmlsbWnFn3Rpci4gRcSfZXIgYnUgdGFsZWJpIHNpeiB5YXBtYWTEsXlzYW7EsXosIGzDvHRmZW4gYml6aW1sZSBpbGV0acWfaW1lIGdlw6dpbi5cbiAgICAgICAgPC9wPlxuICAgICAgPC9kaXY+XG4gICAgYDtcblxuICAgIGNvbnN0IG1haWxPcHRpb25zID0ge1xuICAgICAgZnJvbTogYFwiVFVSS09UUkVORFwiIDwke3Byb2Nlc3MuZW52Lk1BSUxfU0VOREVSfT5gLFxuICAgICAgdG86IGVtYWlsLFxuICAgICAgc3ViamVjdDogXCLFnmlmcmUgU8SxZsSxcmxhbWEgVGFsZWJpbml6XCIsXG4gICAgICBodG1sOiBlbWFpbFRlbXBsYXRlLFxuICAgIH07XG5cbiAgICAvLyBFLXBvc3RhecSxIGfDtm5kZXJcbiAgICBhd2FpdCB0cmFuc3BvcnRlci5zZW5kTWFpbChtYWlsT3B0aW9ucyk7XG5cbiAgICAvLyBCYcWfYXLEsSB5YW7EsXTEsVxuICAgIHJlc1xuICAgICAgLnN0YXR1cygyMDApXG4gICAgICAuanNvbih7IG1lc3NhZ2U6IFwiWWVuaSDFn2lmcmVuaXogZS1wb3N0YSBhZHJlc2luaXplIGfDtm5kZXJpbGRpLlwiIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgIG5leHQoXG4gICAgICBuZXcgQXBpRXJyb3IoXG4gICAgICAgIFwiVGhlcmUgd2FzIGFuIGVycm9yIHNlbmRpbmcgdGhlIHBhc3N3b3JkIHJlc2V0IGVtYWlsXCIsXG4gICAgICAgIDUwMCxcbiAgICAgICAgXCJlbWFpbFNlbmRpbmdFcnJvclwiXG4gICAgICApXG4gICAgKTtcbiAgfVxufTtcblxuZXhwb3J0IHsgZm9yZ290UGFzc3dvcmRFbWFpbCwgZm9yZ290U2VsbGVyUGFzc3dvcmRFbWFpbCB9O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxPQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxXQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxPQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRyxNQUFBLEdBQUFKLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSSxTQUFBLEdBQUFMLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSyxlQUFBLEdBQUFMLE9BQUE7QUFDQSxJQUFBTSxjQUFBLEdBQUFOLE9BQUE7QUFBOEQsU0FBQUQsdUJBQUFRLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVB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","map":{"version":3,"names":["_crypto","_interopRequireDefault","require","_nodemailer","_seller","_users","_ApiError","_CheckExistence","_RequiredCheck","e","__esModule","default","generateRandomPassword","length","crypto","randomBytes","toString","slice","forgotPasswordEmail","req","res","next","email","body","checkRequiredField","user","Users","findOne","notFoundVariable","newPassword","console","log","password","save","transporter","nodemailer","createTransport","host","port","secure","auth","process","env","MAIL_SENDER","pass","MAIL_SENDER_PASSWORD","debug","logger","emailTemplate","name","mailOptions","from","to","subject","html","sendMail","status","json","message","error","ApiError","exports","forgotSellerPasswordEmail","seller","Sellers"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["ForgotPasswordMail.js"],"sourcesContent":["import crypto from \"crypto\";\nimport nodemailer from \"nodemailer\";\nimport Sellers from \"../db/seller\";\nimport Users from \"../db/users\"; // Kullanıcı modelinizi buraya dahil edin\nimport ApiError from \"../errors/ApiError\";\nimport { notFoundVariable } from \"../helpers/CheckExistence\";\nimport { checkRequiredField } from \"../helpers/RequiredCheck\";\n\n// Rastgele şifre üretme fonksiyonu\nconst generateRandomPassword = (length = 12) => {\n  return crypto.randomBytes(length).toString(\"hex\").slice(0, length);\n};\n\nconst forgotPasswordEmail = async (req, res, next) => {\n  const { email } = req.body;\n\n  try {\n    checkRequiredField(email, \"Email\");\n\n    const user = await Users.findOne({ email });\n\n    notFoundVariable(user, \"User\");\n\n    // Rastgele bir şifre oluştur\n    const newPassword = generateRandomPassword();\n    console.log(\"Yeni Şifre\", newPassword);\n\n    // Kullanıcının şifresini yeni rastgele şifre ile güncelle\n    user.password = newPassword;\n    await user.save();\n\n    // E-posta ayarları\n    const transporter = nodemailer.createTransport({\n      host: \"smtp.yandex.com\",\n      port: 465,\n      secure: true,\n      auth: {\n        user: process.env.MAIL_SENDER,\n        pass: process.env.MAIL_SENDER_PASSWORD,\n      },\n      debug: true,\n      logger: true,\n    });\n\n    // HTML e-posta tasarımı\n    const emailTemplate = `\n      <div style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; border: 1px solid #e1e4e8; border-radius: 8px; padding: 20px; background-color: #f9f9f9;\">\n        <div style=\"text-align: center; padding: 20px 0;\">\n          <img src=\"https://via.placeholder.com/150x50?text=Your+Logo\" alt=\"Logo\" style=\"max-width: 100px; margin-bottom: 20px;\" />\n          <h2 style=\"color: #444;\">Şifre Sıfırlama Talebiniz Tamamlandı</h2>\n        </div>\n        <p style=\"font-size: 16px;\">Merhaba <strong>${\n          user.name || \"Kullanıcı\"\n        }</strong>,</p>\n        <p style=\"font-size: 16px;\">Hesabınız için yeni bir şifre oluşturuldu. Aşağıda bu şifreyi bulabilirsiniz:</p>\n        <div style=\"background-color: #eef5fc; padding: 15px; text-align: center; margin: 20px 0; border-radius: 8px; border: 1px solid #d6e4f2;\">\n          <p style=\"font-size: 18px; font-weight: bold; color: #2a7ade;\">${newPassword}</p>\n        </div>\n        <p style=\"font-size: 16px;\">Güvenliğiniz için lütfen giriş yaptıktan sonra bu şifreyi değiştirin.</p>\n        <p style=\"font-size: 16px;\">Herhangi bir sorunla karşılaşırsanız lütfen bizimle iletişime geçmekten çekinmeyin.</p>\n        <hr style=\"border: 0; border-top: 1px solid #ddd; margin: 20px 0;\" />\n        <p style=\"font-size: 14px; color: #666; text-align: center;\">\n          Bu e-posta, şifre sıfırlama talebiniz üzerine gönderilmiştir. Eğer bu talebi siz yapmadıysanız, lütfen bizimle iletişime geçin.\n        </p>\n      </div>\n    `;\n\n    const mailOptions = {\n      from: `\"TURKOTREND\" <${process.env.MAIL_SENDER}>`,\n      to: email,\n      subject: \"Şifre Sıfırlama Talebiniz\",\n      html: emailTemplate,\n    };\n\n    // E-postayı gönder\n    await transporter.sendMail(mailOptions);\n\n    // Başarı yanıtı\n    res\n      .status(200)\n      .json({ message: \"Yeni şifreniz e-posta adresinize gönderildi.\" });\n  } catch (error) {\n    console.error(error);\n    next(\n      new ApiError(\n        \"There was an error sending the password reset email\",\n        500,\n        \"emailSendingError\"\n      )\n    );\n  }\n};\n\nconst forgotSellerPasswordEmail = async (req, res, next) => {\n  const { email } = req.body;\n\n  try {\n    checkRequiredField(email, \"Email\");\n\n    const seller = await Sellers.findOne({ email });\n\n    notFoundVariable(seller, \"Seller\");\n\n    // Rastgele bir şifre oluştur\n    const newPassword = generateRandomPassword();\n    console.log(\"Yeni Şifre\", newPassword);\n\n    // Kullanıcının şifresini yeni rastgele şifre ile güncelle\n    seller.password = newPassword;\n    await seller.save();\n\n    // E-posta ayarları\n    const transporter = nodemailer.createTransport({\n      host: \"smtp.yandex.com\",\n      port: 465,\n      secure: true,\n      auth: {\n        user: process.env.MAIL_SENDER,\n        pass: process.env.MAIL_SENDER_PASSWORD,\n      },\n      debug: true,\n      logger: true,\n    });\n\n    // HTML e-posta tasarımı\n    const emailTemplate = `\n      <div style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; border: 1px solid #e1e4e8; border-radius: 8px; padding: 20px; background-color: #f9f9f9;\">\n        <div style=\"text-align: center; padding: 20px 0;\">\n          <img src=\"https://via.placeholder.com/150x50?text=Your+Logo\" alt=\"Logo\" style=\"max-width: 100px; margin-bottom: 20px;\" />\n          <h2 style=\"color: #444;\">Şifre Sıfırlama Talebiniz Tamamlandı</h2>\n        </div>\n        <p style=\"font-size: 16px;\">Merhaba <strong>${\n          seller.name || \"Kullanıcı\"\n        }</strong>,</p>\n        <p style=\"font-size: 16px;\">Hesabınız için yeni bir şifre oluşturuldu. Aşağıda bu şifreyi bulabilirsiniz:</p>\n        <div style=\"background-color: #eef5fc; padding: 15px; text-align: center; margin: 20px 0; border-radius: 8px; border: 1px solid #d6e4f2;\">\n          <p style=\"font-size: 18px; font-weight: bold; color: #2a7ade;\">${newPassword}</p>\n        </div>\n        <p style=\"font-size: 16px;\">Güvenliğiniz için lütfen giriş yaptıktan sonra bu şifreyi değiştirin.</p>\n        <p style=\"font-size: 16px;\">Herhangi bir sorunla karşılaşırsanız lütfen bizimle iletişime geçmekten çekinmeyin.</p>\n        <hr style=\"border: 0; border-top: 1px solid #ddd; margin: 20px 0;\" />\n        <p style=\"font-size: 14px; color: #666; text-align: center;\">\n          Bu e-posta, şifre sıfırlama talebiniz üzerine gönderilmiştir. Eğer bu talebi siz yapmadıysanız, lütfen bizimle iletişime geçin.\n        </p>\n      </div>\n    `;\n\n    const mailOptions = {\n      from: `\"TURKOTREND\" <${process.env.MAIL_SENDER}>`,\n      to: email,\n      subject: \"Şifre Sıfırlama Talebiniz\",\n      html: emailTemplate,\n    };\n\n    // E-postayı gönder\n    await transporter.sendMail(mailOptions);\n\n    // Başarı yanıtı\n    res\n      .status(200)\n      .json({ message: \"Yeni şifreniz e-posta adresinize gönderildi.\" });\n  } catch (error) {\n    console.error(error);\n    next(\n      new ApiError(\n        \"There was an error sending the password reset email\",\n        500,\n        \"emailSendingError\"\n      )\n    );\n  }\n};\n\nexport { forgotPasswordEmail, forgotSellerPasswordEmail };\n"],"mappings":"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","ignoreList":[]}},"mtime":1734443634302},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/ForgotPasswordMail.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.forgotSellerPasswordEmail = exports.forgotPasswordEmail = void 0;\nvar _crypto = _interopRequireDefault(require(\"crypto\"));\nvar _nodemailer = _interopRequireDefault(require(\"nodemailer\"));\nvar _seller = _interopRequireDefault(require(\"../db/seller\"));\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _CheckExistence = require(\"../helpers/CheckExistence\");\nvar _RequiredCheck = require(\"../helpers/RequiredCheck\");\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\n// Kullanıcı modelinizi buraya dahil edin\n\n// Rastgele şifre üretme fonksiyonu\nconst generateRandomPassword = (length = 12) => {\n  return _crypto.default.randomBytes(length).toString(\"hex\").slice(0, length);\n};\nconst forgotPasswordEmail = async (req, res, next) => {\n  const {\n    email\n  } = req.body;\n  try {\n    (0, _RequiredCheck.checkRequiredField)(email, \"Email\");\n    const user = await _users.default.findOne({\n      email\n    });\n    (0, _CheckExistence.notFoundVariable)(user, \"User\");\n\n    // Rastgele bir şifre oluştur\n    const newPassword = generateRandomPassword();\n    console.log(\"Yeni Şifre\", newPassword);\n\n    // Kullanıcının şifresini yeni rastgele şifre ile güncelle\n    user.password = newPassword;\n    await user.save();\n\n    // E-posta ayarları\n    const transporter = _nodemailer.default.createTransport({\n      host: \"smtp.yandex.com\",\n      port: 465,\n      secure: true,\n      auth: {\n        user: process.env.MAIL_SENDER,\n        pass: process.env.MAIL_SENDER_PASSWORD\n      },\n      debug: true,\n      logger: true\n    });\n\n    // HTML e-posta tasarımı\n    const emailTemplate = `\n      <div style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; border: 1px solid #e1e4e8; border-radius: 8px; padding: 20px; background-color: #f9f9f9;\">\n        <div style=\"text-align: center; padding: 20px 0;\">\n          <img src=\"https://via.placeholder.com/150x50?text=Your+Logo\" alt=\"Logo\" style=\"max-width: 100px; margin-bottom: 20px;\" />\n          <h2 style=\"color: #444;\">Şifre Sıfırlama Talebiniz Tamamlandı</h2>\n        </div>\n        <p style=\"font-size: 16px;\">Merhaba <strong>${user.name || \"Kullanıcı\"}</strong>,</p>\n        <p style=\"font-size: 16px;\">Hesabınız için yeni bir şifre oluşturuldu. Aşağıda bu şifreyi bulabilirsiniz:</p>\n        <div style=\"background-color: #eef5fc; padding: 15px; text-align: center; margin: 20px 0; border-radius: 8px; border: 1px solid #d6e4f2;\">\n          <p style=\"font-size: 18px; font-weight: bold; color: #2a7ade;\">${newPassword}</p>\n        </div>\n        <p style=\"font-size: 16px;\">Güvenliğiniz için lütfen giriş yaptıktan sonra bu şifreyi değiştirin.</p>\n        <p style=\"font-size: 16px;\">Herhangi bir sorunla karşılaşırsanız lütfen bizimle iletişime geçmekten çekinmeyin.</p>\n        <hr style=\"border: 0; border-top: 1px solid #ddd; margin: 20px 0;\" />\n        <p style=\"font-size: 14px; color: #666; text-align: center;\">\n          Bu e-posta, şifre sıfırlama talebiniz üzerine gönderilmiştir. Eğer bu talebi siz yapmadıysanız, lütfen bizimle iletişime geçin.\n        </p>\n      </div>\n    `;\n    const mailOptions = {\n      from: `\"TURKOTREND\" <${process.env.MAIL_SENDER}>`,\n      to: email,\n      subject: \"Şifre Sıfırlama Talebiniz\",\n      html: emailTemplate\n    };\n\n    // E-postayı gönder\n    await transporter.sendMail(mailOptions);\n\n    // Başarı yanıtı\n    res.status(200).json({\n      message: \"Yeni şifreniz e-posta adresinize gönderildi.\"\n    });\n  } catch (error) {\n    console.error(error);\n    next(new _ApiError.default(\"There was an error sending the password reset email\", 500, \"emailSendingError\"));\n  }\n};\nexports.forgotPasswordEmail = forgotPasswordEmail;\nconst forgotSellerPasswordEmail = async (req, res, next) => {\n  const {\n    email\n  } = req.body;\n  try {\n    (0, _RequiredCheck.checkRequiredField)(email, \"Email\");\n    const seller = await _seller.default.findOne({\n      email\n    });\n    (0, _CheckExistence.notFoundVariable)(seller, \"Seller\");\n\n    // Rastgele bir şifre oluştur\n    const newPassword = generateRandomPassword();\n    console.log(\"Yeni Şifre\", newPassword);\n\n    // Kullanıcının şifresini yeni rastgele şifre ile güncelle\n    seller.password = newPassword;\n    await seller.save();\n\n    // E-posta ayarları\n    const transporter = _nodemailer.default.createTransport({\n      host: \"smtp.yandex.com\",\n      port: 465,\n      secure: true,\n      auth: {\n        user: process.env.MAIL_SENDER,\n        pass: process.env.MAIL_SENDER_PASSWORD\n      },\n      debug: true,\n      logger: true\n    });\n\n    // HTML e-posta tasarımı\n    const emailTemplate = `\n      <div style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; border: 1px solid #e1e4e8; border-radius: 8px; padding: 20px; background-color: #f9f9f9;\">\n        <div style=\"text-align: center; padding: 20px 0;\">\n          <img src=\"https://via.placeholder.com/150x50?text=Your+Logo\" alt=\"Logo\" style=\"max-width: 100px; margin-bottom: 20px;\" />\n          <h2 style=\"color: #444;\">Şifre Sıfırlama Talebiniz Tamamlandı</h2>\n        </div>\n        <p style=\"font-size: 16px;\">Merhaba <strong>${seller.name || \"Kullanıcı\"}</strong>,</p>\n        <p style=\"font-size: 16px;\">Hesabınız için yeni bir şifre oluşturuldu. Aşağıda bu şifreyi bulabilirsiniz:</p>\n        <div style=\"background-color: #eef5fc; padding: 15px; text-align: center; margin: 20px 0; border-radius: 8px; border: 1px solid #d6e4f2;\">\n          <p style=\"font-size: 18px; font-weight: bold; color: #2a7ade;\">${newPassword}</p>\n        </div>\n        <p style=\"font-size: 16px;\">Güvenliğiniz için lütfen giriş yaptıktan sonra bu şifreyi değiştirin.</p>\n        <p style=\"font-size: 16px;\">Herhangi bir sorunla karşılaşırsanız lütfen bizimle iletişime geçmekten çekinmeyin.</p>\n        <hr style=\"border: 0; border-top: 1px solid #ddd; margin: 20px 0;\" />\n        <p style=\"font-size: 14px; color: #666; text-align: center;\">\n          Bu e-posta, şifre sıfırlama talebiniz üzerine gönderilmiştir. Eğer bu talebi siz yapmadıysanız, lütfen bizimle iletişime geçin.\n        </p>\n      </div>\n    `;\n    const mailOptions = {\n      from: `\"TURKOTREND\" <${process.env.MAIL_SENDER}>`,\n      to: email,\n      subject: \"Şifre Sıfırlama Talebiniz\",\n      html: emailTemplate\n    };\n\n    // E-postayı gönder\n    await transporter.sendMail(mailOptions);\n\n    // Başarı yanıtı\n    res.status(200).json({\n      message: \"Yeni şifreniz e-posta adresinize gönderildi.\"\n    });\n  } catch (error) {\n    console.error(error);\n    next(new _ApiError.default(\"There was an error sending the password reset email\", 500, \"emailSendingError\"));\n  }\n};\nexports.forgotSellerPasswordEmail = forgotSellerPasswordEmail;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfY3J5cHRvIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfbm9kZW1haWxlciIsIl9zZWxsZXIiLCJfdXNlcnMiLCJfQXBpRXJyb3IiLCJfQ2hlY2tFeGlzdGVuY2UiLCJfUmVxdWlyZWRDaGVjayIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImdlbmVyYXRlUmFuZG9tUGFzc3dvcmQiLCJsZW5ndGgiLCJjcnlwdG8iLCJyYW5kb21CeXRlcyIsInRvU3RyaW5nIiwic2xpY2UiLCJmb3Jnb3RQYXNzd29yZEVtYWlsIiwicmVxIiwicmVzIiwibmV4dCIsImVtYWlsIiwiYm9keSIsImNoZWNrUmVxdWlyZWRGaWVsZCIsInVzZXIiLCJVc2VycyIsImZpbmRPbmUiLCJub3RGb3VuZFZhcmlhYmxlIiwibmV3UGFzc3dvcmQiLCJjb25zb2xlIiwibG9nIiwicGFzc3dvcmQiLCJzYXZlIiwidHJhbnNwb3J0ZXIiLCJub2RlbWFpbGVyIiwiY3JlYXRlVHJhbnNwb3J0IiwiaG9zdCIsInBvcnQiLCJzZWN1cmUiLCJhdXRoIiwicHJvY2VzcyIsImVudiIsIk1BSUxfU0VOREVSIiwicGFzcyIsIk1BSUxfU0VOREVSX1BBU1NXT1JEIiwiZGVidWciLCJsb2dnZXIiLCJlbWFpbFRlbXBsYXRlIiwibmFtZSIsIm1haWxPcHRpb25zIiwiZnJvbSIsInRvIiwic3ViamVjdCIsImh0bWwiLCJzZW5kTWFpbCIsInN0YXR1cyIsImpzb24iLCJtZXNzYWdlIiwiZXJyb3IiLCJBcGlFcnJvciIsImV4cG9ydHMiLCJmb3Jnb3RTZWxsZXJQYXNzd29yZEVtYWlsIiwic2VsbGVyIiwiU2VsbGVycyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL21pZGRsZXdhcmVzLyIsInNvdXJjZXMiOlsiRm9yZ290UGFzc3dvcmRNYWlsLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBjcnlwdG8gZnJvbSBcImNyeXB0b1wiO1xuaW1wb3J0IG5vZGVtYWlsZXIgZnJvbSBcIm5vZGVtYWlsZXJcIjtcbmltcG9ydCBTZWxsZXJzIGZyb20gXCIuLi9kYi9zZWxsZXJcIjtcbmltcG9ydCBVc2VycyBmcm9tIFwiLi4vZGIvdXNlcnNcIjsgLy8gS3VsbGFuxLFjxLEgbW9kZWxpbml6aSBidXJheWEgZGFoaWwgZWRpblxuaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuLi9lcnJvcnMvQXBpRXJyb3JcIjtcbmltcG9ydCB7IG5vdEZvdW5kVmFyaWFibGUgfSBmcm9tIFwiLi4vaGVscGVycy9DaGVja0V4aXN0ZW5jZVwiO1xuaW1wb3J0IHsgY2hlY2tSZXF1aXJlZEZpZWxkIH0gZnJvbSBcIi4uL2hlbHBlcnMvUmVxdWlyZWRDaGVja1wiO1xuXG4vLyBSYXN0Z2VsZSDFn2lmcmUgw7xyZXRtZSBmb25rc2l5b251XG5jb25zdCBnZW5lcmF0ZVJhbmRvbVBhc3N3b3JkID0gKGxlbmd0aCA9IDEyKSA9PiB7XG4gIHJldHVybiBjcnlwdG8ucmFuZG9tQnl0ZXMobGVuZ3RoKS50b1N0cmluZyhcImhleFwiKS5zbGljZSgwLCBsZW5ndGgpO1xufTtcblxuY29uc3QgZm9yZ290UGFzc3dvcmRFbWFpbCA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICBjb25zdCB7IGVtYWlsIH0gPSByZXEuYm9keTtcblxuICB0cnkge1xuICAgIGNoZWNrUmVxdWlyZWRGaWVsZChlbWFpbCwgXCJFbWFpbFwiKTtcblxuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBVc2Vycy5maW5kT25lKHsgZW1haWwgfSk7XG5cbiAgICBub3RGb3VuZFZhcmlhYmxlKHVzZXIsIFwiVXNlclwiKTtcblxuICAgIC8vIFJhc3RnZWxlIGJpciDFn2lmcmUgb2x1xZ90dXJcbiAgICBjb25zdCBuZXdQYXNzd29yZCA9IGdlbmVyYXRlUmFuZG9tUGFzc3dvcmQoKTtcbiAgICBjb25zb2xlLmxvZyhcIlllbmkgxZ5pZnJlXCIsIG5ld1Bhc3N3b3JkKTtcblxuICAgIC8vIEt1bGxhbsSxY8SxbsSxbiDFn2lmcmVzaW5pIHllbmkgcmFzdGdlbGUgxZ9pZnJlIGlsZSBnw7xuY2VsbGVcbiAgICB1c2VyLnBhc3N3b3JkID0gbmV3UGFzc3dvcmQ7XG4gICAgYXdhaXQgdXNlci5zYXZlKCk7XG5cbiAgICAvLyBFLXBvc3RhIGF5YXJsYXLEsVxuICAgIGNvbnN0IHRyYW5zcG9ydGVyID0gbm9kZW1haWxlci5jcmVhdGVUcmFuc3BvcnQoe1xuICAgICAgaG9zdDogXCJzbXRwLnlhbmRleC5jb21cIixcbiAgICAgIHBvcnQ6IDQ2NSxcbiAgICAgIHNlY3VyZTogdHJ1ZSxcbiAgICAgIGF1dGg6IHtcbiAgICAgICAgdXNlcjogcHJvY2Vzcy5lbnYuTUFJTF9TRU5ERVIsXG4gICAgICAgIHBhc3M6IHByb2Nlc3MuZW52Lk1BSUxfU0VOREVSX1BBU1NXT1JELFxuICAgICAgfSxcbiAgICAgIGRlYnVnOiB0cnVlLFxuICAgICAgbG9nZ2VyOiB0cnVlLFxuICAgIH0pO1xuXG4gICAgLy8gSFRNTCBlLXBvc3RhIHRhc2FyxLFtxLFcbiAgICBjb25zdCBlbWFpbFRlbXBsYXRlID0gYFxuICAgICAgPGRpdiBzdHlsZT1cImZvbnQtZmFtaWx5OiBBcmlhbCwgc2Fucy1zZXJpZjsgbGluZS1oZWlnaHQ6IDEuNjsgY29sb3I6ICMzMzM7IG1heC13aWR0aDogNjAwcHg7IG1hcmdpbjogMCBhdXRvOyBib3JkZXI6IDFweCBzb2xpZCAjZTFlNGU4OyBib3JkZXItcmFkaXVzOiA4cHg7IHBhZGRpbmc6IDIwcHg7IGJhY2tncm91bmQtY29sb3I6ICNmOWY5Zjk7XCI+XG4gICAgICAgIDxkaXYgc3R5bGU9XCJ0ZXh0LWFsaWduOiBjZW50ZXI7IHBhZGRpbmc6IDIwcHggMDtcIj5cbiAgICAgICAgICA8aW1nIHNyYz1cImh0dHBzOi8vdmlhLnBsYWNlaG9sZGVyLmNvbS8xNTB4NTA/dGV4dD1Zb3VyK0xvZ29cIiBhbHQ9XCJMb2dvXCIgc3R5bGU9XCJtYXgtd2lkdGg6IDEwMHB4OyBtYXJnaW4tYm90dG9tOiAyMHB4O1wiIC8+XG4gICAgICAgICAgPGgyIHN0eWxlPVwiY29sb3I6ICM0NDQ7XCI+xZ5pZnJlIFPEsWbEsXJsYW1hIFRhbGViaW5peiBUYW1hbWxhbmTEsTwvaDI+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8cCBzdHlsZT1cImZvbnQtc2l6ZTogMTZweDtcIj5NZXJoYWJhIDxzdHJvbmc+JHtcbiAgICAgICAgICB1c2VyLm5hbWUgfHwgXCJLdWxsYW7EsWPEsVwiXG4gICAgICAgIH08L3N0cm9uZz4sPC9wPlxuICAgICAgICA8cCBzdHlsZT1cImZvbnQtc2l6ZTogMTZweDtcIj5IZXNhYsSxbsSxeiBpw6dpbiB5ZW5pIGJpciDFn2lmcmUgb2x1xZ90dXJ1bGR1LiBBxZ9hxJ/EsWRhIGJ1IMWfaWZyZXlpIGJ1bGFiaWxpcnNpbml6OjwvcD5cbiAgICAgICAgPGRpdiBzdHlsZT1cImJhY2tncm91bmQtY29sb3I6ICNlZWY1ZmM7IHBhZGRpbmc6IDE1cHg7IHRleHQtYWxpZ246IGNlbnRlcjsgbWFyZ2luOiAyMHB4IDA7IGJvcmRlci1yYWRpdXM6IDhweDsgYm9yZGVyOiAxcHggc29saWQgI2Q2ZTRmMjtcIj5cbiAgICAgICAgICA8cCBzdHlsZT1cImZvbnQtc2l6ZTogMThweDsgZm9udC13ZWlnaHQ6IGJvbGQ7IGNvbG9yOiAjMmE3YWRlO1wiPiR7bmV3UGFzc3dvcmR9PC9wPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgPHAgc3R5bGU9XCJmb250LXNpemU6IDE2cHg7XCI+R8O8dmVubGnEn2luaXogacOnaW4gbMO8dGZlbiBnaXJpxZ8geWFwdMSxa3RhbiBzb25yYSBidSDFn2lmcmV5aSBkZcSfacWfdGlyaW4uPC9wPlxuICAgICAgICA8cCBzdHlsZT1cImZvbnQtc2l6ZTogMTZweDtcIj5IZXJoYW5naSBiaXIgc29ydW5sYSBrYXLFn8SxbGHFn8SxcnNhbsSxeiBsw7x0ZmVuIGJpemltbGUgaWxldGnFn2ltZSBnZcOnbWVrdGVuIMOnZWtpbm1leWluLjwvcD5cbiAgICAgICAgPGhyIHN0eWxlPVwiYm9yZGVyOiAwOyBib3JkZXItdG9wOiAxcHggc29saWQgI2RkZDsgbWFyZ2luOiAyMHB4IDA7XCIgLz5cbiAgICAgICAgPHAgc3R5bGU9XCJmb250LXNpemU6IDE0cHg7IGNvbG9yOiAjNjY2OyB0ZXh0LWFsaWduOiBjZW50ZXI7XCI+XG4gICAgICAgICAgQnUgZS1wb3N0YSwgxZ9pZnJlIHPEsWbEsXJsYW1hIHRhbGViaW5peiDDvHplcmluZSBnw7ZuZGVyaWxtacWfdGlyLiBFxJ9lciBidSB0YWxlYmkgc2l6IHlhcG1hZMSxeXNhbsSxeiwgbMO8dGZlbiBiaXppbWxlIGlsZXRpxZ9pbWUgZ2XDp2luLlxuICAgICAgICA8L3A+XG4gICAgICA8L2Rpdj5cbiAgICBgO1xuXG4gICAgY29uc3QgbWFpbE9wdGlvbnMgPSB7XG4gICAgICBmcm9tOiBgXCJUVVJLT1RSRU5EXCIgPCR7cHJvY2Vzcy5lbnYuTUFJTF9TRU5ERVJ9PmAsXG4gICAgICB0bzogZW1haWwsXG4gICAgICBzdWJqZWN0OiBcIsWeaWZyZSBTxLFmxLFybGFtYSBUYWxlYmluaXpcIixcbiAgICAgIGh0bWw6IGVtYWlsVGVtcGxhdGUsXG4gICAgfTtcblxuICAgIC8vIEUtcG9zdGF5xLEgZ8O2bmRlclxuICAgIGF3YWl0IHRyYW5zcG9ydGVyLnNlbmRNYWlsKG1haWxPcHRpb25zKTtcblxuICAgIC8vIEJhxZ9hcsSxIHlhbsSxdMSxXG4gICAgcmVzXG4gICAgICAuc3RhdHVzKDIwMClcbiAgICAgIC5qc29uKHsgbWVzc2FnZTogXCJZZW5pIMWfaWZyZW5peiBlLXBvc3RhIGFkcmVzaW5pemUgZ8O2bmRlcmlsZGkuXCIgfSk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgbmV4dChcbiAgICAgIG5ldyBBcGlFcnJvcihcbiAgICAgICAgXCJUaGVyZSB3YXMgYW4gZXJyb3Igc2VuZGluZyB0aGUgcGFzc3dvcmQgcmVzZXQgZW1haWxcIixcbiAgICAgICAgNTAwLFxuICAgICAgICBcImVtYWlsU2VuZGluZ0Vycm9yXCJcbiAgICAgIClcbiAgICApO1xuICB9XG59O1xuXG5jb25zdCBmb3Jnb3RTZWxsZXJQYXNzd29yZEVtYWlsID0gYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gIGNvbnN0IHsgZW1haWwgfSA9IHJlcS5ib2R5O1xuXG4gIHRyeSB7XG4gICAgY2hlY2tSZXF1aXJlZEZpZWxkKGVtYWlsLCBcIkVtYWlsXCIpO1xuXG4gICAgY29uc3Qgc2VsbGVyID0gYXdhaXQgU2VsbGVycy5maW5kT25lKHsgZW1haWwgfSk7XG5cbiAgICBub3RGb3VuZFZhcmlhYmxlKHNlbGxlciwgXCJTZWxsZXJcIik7XG5cbiAgICAvLyBSYXN0Z2VsZSBiaXIgxZ9pZnJlIG9sdcWfdHVyXG4gICAgY29uc3QgbmV3UGFzc3dvcmQgPSBnZW5lcmF0ZVJhbmRvbVBhc3N3b3JkKCk7XG4gICAgY29uc29sZS5sb2coXCJZZW5pIMWeaWZyZVwiLCBuZXdQYXNzd29yZCk7XG5cbiAgICAvLyBLdWxsYW7EsWPEsW7EsW4gxZ9pZnJlc2luaSB5ZW5pIHJhc3RnZWxlIMWfaWZyZSBpbGUgZ8O8bmNlbGxlXG4gICAgc2VsbGVyLnBhc3N3b3JkID0gbmV3UGFzc3dvcmQ7XG4gICAgYXdhaXQgc2VsbGVyLnNhdmUoKTtcblxuICAgIC8vIEUtcG9zdGEgYXlhcmxhcsSxXG4gICAgY29uc3QgdHJhbnNwb3J0ZXIgPSBub2RlbWFpbGVyLmNyZWF0ZVRyYW5zcG9ydCh7XG4gICAgICBob3N0OiBcInNtdHAueWFuZGV4LmNvbVwiLFxuICAgICAgcG9ydDogNDY1LFxuICAgICAgc2VjdXJlOiB0cnVlLFxuICAgICAgYXV0aDoge1xuICAgICAgICB1c2VyOiBwcm9jZXNzLmVudi5NQUlMX1NFTkRFUixcbiAgICAgICAgcGFzczogcHJvY2Vzcy5lbnYuTUFJTF9TRU5ERVJfUEFTU1dPUkQsXG4gICAgICB9LFxuICAgICAgZGVidWc6IHRydWUsXG4gICAgICBsb2dnZXI6IHRydWUsXG4gICAgfSk7XG5cbiAgICAvLyBIVE1MIGUtcG9zdGEgdGFzYXLEsW3EsVxuICAgIGNvbnN0IGVtYWlsVGVtcGxhdGUgPSBgXG4gICAgICA8ZGl2IHN0eWxlPVwiZm9udC1mYW1pbHk6IEFyaWFsLCBzYW5zLXNlcmlmOyBsaW5lLWhlaWdodDogMS42OyBjb2xvcjogIzMzMzsgbWF4LXdpZHRoOiA2MDBweDsgbWFyZ2luOiAwIGF1dG87IGJvcmRlcjogMXB4IHNvbGlkICNlMWU0ZTg7IGJvcmRlci1yYWRpdXM6IDhweDsgcGFkZGluZzogMjBweDsgYmFja2dyb3VuZC1jb2xvcjogI2Y5ZjlmOTtcIj5cbiAgICAgICAgPGRpdiBzdHlsZT1cInRleHQtYWxpZ246IGNlbnRlcjsgcGFkZGluZzogMjBweCAwO1wiPlxuICAgICAgICAgIDxpbWcgc3JjPVwiaHR0cHM6Ly92aWEucGxhY2Vob2xkZXIuY29tLzE1MHg1MD90ZXh0PVlvdXIrTG9nb1wiIGFsdD1cIkxvZ29cIiBzdHlsZT1cIm1heC13aWR0aDogMTAwcHg7IG1hcmdpbi1ib3R0b206IDIwcHg7XCIgLz5cbiAgICAgICAgICA8aDIgc3R5bGU9XCJjb2xvcjogIzQ0NDtcIj7FnmlmcmUgU8SxZsSxcmxhbWEgVGFsZWJpbml6IFRhbWFtbGFuZMSxPC9oMj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxwIHN0eWxlPVwiZm9udC1zaXplOiAxNnB4O1wiPk1lcmhhYmEgPHN0cm9uZz4ke1xuICAgICAgICAgIHNlbGxlci5uYW1lIHx8IFwiS3VsbGFuxLFjxLFcIlxuICAgICAgICB9PC9zdHJvbmc+LDwvcD5cbiAgICAgICAgPHAgc3R5bGU9XCJmb250LXNpemU6IDE2cHg7XCI+SGVzYWLEsW7EsXogacOnaW4geWVuaSBiaXIgxZ9pZnJlIG9sdcWfdHVydWxkdS4gQcWfYcSfxLFkYSBidSDFn2lmcmV5aSBidWxhYmlsaXJzaW5pejo8L3A+XG4gICAgICAgIDxkaXYgc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiAjZWVmNWZjOyBwYWRkaW5nOiAxNXB4OyB0ZXh0LWFsaWduOiBjZW50ZXI7IG1hcmdpbjogMjBweCAwOyBib3JkZXItcmFkaXVzOiA4cHg7IGJvcmRlcjogMXB4IHNvbGlkICNkNmU0ZjI7XCI+XG4gICAgICAgICAgPHAgc3R5bGU9XCJmb250LXNpemU6IDE4cHg7IGZvbnQtd2VpZ2h0OiBib2xkOyBjb2xvcjogIzJhN2FkZTtcIj4ke25ld1Bhc3N3b3JkfTwvcD5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxwIHN0eWxlPVwiZm9udC1zaXplOiAxNnB4O1wiPkfDvHZlbmxpxJ9pbml6IGnDp2luIGzDvHRmZW4gZ2lyacWfIHlhcHTEsWt0YW4gc29ucmEgYnUgxZ9pZnJleWkgZGXEn2nFn3RpcmluLjwvcD5cbiAgICAgICAgPHAgc3R5bGU9XCJmb250LXNpemU6IDE2cHg7XCI+SGVyaGFuZ2kgYmlyIHNvcnVubGEga2FyxZ/EsWxhxZ/EsXJzYW7EsXogbMO8dGZlbiBiaXppbWxlIGlsZXRpxZ9pbWUgZ2XDp21la3RlbiDDp2VraW5tZXlpbi48L3A+XG4gICAgICAgIDxociBzdHlsZT1cImJvcmRlcjogMDsgYm9yZGVyLXRvcDogMXB4IHNvbGlkICNkZGQ7IG1hcmdpbjogMjBweCAwO1wiIC8+XG4gICAgICAgIDxwIHN0eWxlPVwiZm9udC1zaXplOiAxNHB4OyBjb2xvcjogIzY2NjsgdGV4dC1hbGlnbjogY2VudGVyO1wiPlxuICAgICAgICAgIEJ1IGUtcG9zdGEsIMWfaWZyZSBzxLFmxLFybGFtYSB0YWxlYmluaXogw7x6ZXJpbmUgZ8O2bmRlcmlsbWnFn3Rpci4gRcSfZXIgYnUgdGFsZWJpIHNpeiB5YXBtYWTEsXlzYW7EsXosIGzDvHRmZW4gYml6aW1sZSBpbGV0acWfaW1lIGdlw6dpbi5cbiAgICAgICAgPC9wPlxuICAgICAgPC9kaXY+XG4gICAgYDtcblxuICAgIGNvbnN0IG1haWxPcHRpb25zID0ge1xuICAgICAgZnJvbTogYFwiVFVSS09UUkVORFwiIDwke3Byb2Nlc3MuZW52Lk1BSUxfU0VOREVSfT5gLFxuICAgICAgdG86IGVtYWlsLFxuICAgICAgc3ViamVjdDogXCLFnmlmcmUgU8SxZsSxcmxhbWEgVGFsZWJpbml6XCIsXG4gICAgICBodG1sOiBlbWFpbFRlbXBsYXRlLFxuICAgIH07XG5cbiAgICAvLyBFLXBvc3RhecSxIGfDtm5kZXJcbiAgICBhd2FpdCB0cmFuc3BvcnRlci5zZW5kTWFpbChtYWlsT3B0aW9ucyk7XG5cbiAgICAvLyBCYcWfYXLEsSB5YW7EsXTEsVxuICAgIHJlc1xuICAgICAgLnN0YXR1cygyMDApXG4gICAgICAuanNvbih7IG1lc3NhZ2U6IFwiWWVuaSDFn2lmcmVuaXogZS1wb3N0YSBhZHJlc2luaXplIGfDtm5kZXJpbGRpLlwiIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgIG5leHQoXG4gICAgICBuZXcgQXBpRXJyb3IoXG4gICAgICAgIFwiVGhlcmUgd2FzIGFuIGVycm9yIHNlbmRpbmcgdGhlIHBhc3N3b3JkIHJlc2V0IGVtYWlsXCIsXG4gICAgICAgIDUwMCxcbiAgICAgICAgXCJlbWFpbFNlbmRpbmdFcnJvclwiXG4gICAgICApXG4gICAgKTtcbiAgfVxufTtcblxuZXhwb3J0IHsgZm9yZ290UGFzc3dvcmRFbWFpbCwgZm9yZ290U2VsbGVyUGFzc3dvcmRFbWFpbCB9O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxPQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxXQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxPQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRyxNQUFBLEdBQUFKLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSSxTQUFBLEdBQUFMLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBSyxlQUFBLEdBQUFMLE9BQUE7QUFDQSxJQUFBTSxjQUFBLEdBQUFOLE9BQUE7QUFBOEQsU0FBQUQsdUJBQUFRLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFIN0I7O0FBS2pDO0FBQ0EsTUFBTUcsc0JBQXNCLEdBQUdBLENBQUNDLE1BQU0sR0FBRyxFQUFFLEtBQUs7RUFDOUMsT0FBT0MsZUFBTSxDQUFDQyxXQUFXLENBQUNGLE1BQU0sQ0FBQyxDQUFDRyxRQUFRLENBQUMsS0FBSyxDQUFDLENBQUNDLEtBQUssQ0FBQyxDQUFDLEVBQUVKLE1BQU0sQ0FBQztBQUNwRSxDQUFDO0FBRUQsTUFBTUssbUJBQW1CLEdBQUcsTUFBQUEsQ0FBT0MsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksS0FBSztFQUNwRCxNQUFNO0lBQUVDO0VBQU0sQ0FBQyxHQUFHSCxHQUFHLENBQUNJLElBQUk7RUFFMUIsSUFBSTtJQUNGLElBQUFDLGlDQUFrQixFQUFDRixLQUFLLEVBQUUsT0FBTyxDQUFDO0lBRWxDLE1BQU1HLElBQUksR0FBRyxNQUFNQyxjQUFLLENBQUNDLE9BQU8sQ0FBQztNQUFFTDtJQUFNLENBQUMsQ0FBQztJQUUzQyxJQUFBTSxnQ0FBZ0IsRUFBQ0gsSUFBSSxFQUFFLE1BQU0sQ0FBQzs7SUFFOUI7SUFDQSxNQUFNSSxXQUFXLEdBQUdqQixzQkFBc0IsQ0FBQyxDQUFDO0lBQzVDa0IsT0FBTyxDQUFDQyxHQUFHLENBQUMsWUFBWSxFQUFFRixXQUFXLENBQUM7O0lBRXRDO0lBQ0FKLElBQUksQ0FBQ08sUUFBUSxHQUFHSCxXQUFXO0lBQzNCLE1BQU1KLElBQUksQ0FBQ1EsSUFBSSxDQUFDLENBQUM7O0lBRWpCO0lBQ0EsTUFBTUMsV0FBVyxHQUFHQyxtQkFBVSxDQUFDQyxlQUFlLENBQUM7TUFDN0NDLElBQUksRUFBRSxpQkFBaUI7TUFDdkJDLElBQUksRUFBRSxHQUFHO01BQ1RDLE1BQU0sRUFBRSxJQUFJO01BQ1pDLElBQUksRUFBRTtRQUNKZixJQUFJLEVBQUVnQixPQUFPLENBQUNDLEdBQUcsQ0FBQ0MsV0FBVztRQUM3QkMsSUFBSSxFQUFFSCxPQUFPLENBQUNDLEdBQUcsQ0FBQ0c7TUFDcEIsQ0FBQztNQUNEQyxLQUFLLEVBQUUsSUFBSTtNQUNYQyxNQUFNLEVBQUU7SUFDVixDQUFDLENBQUM7O0lBRUY7SUFDQSxNQUFNQyxhQUFhLEdBQUc7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNEQUNVdkIsSUFBSSxDQUFDd0IsSUFBSSxJQUFJLFdBQVc7QUFDbEM7QUFDQTtBQUNBLDJFQUMyRXBCLFdBQVc7QUFDdEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7SUFFRCxNQUFNcUIsV0FBVyxHQUFHO01BQ2xCQyxJQUFJLEVBQUUsaUJBQWlCVixPQUFPLENBQUNDLEdBQUcsQ0FBQ0MsV0FBVyxHQUFHO01BQ2pEUyxFQUFFLEVBQUU5QixLQUFLO01BQ1QrQixPQUFPLEVBQUUsMkJBQTJCO01BQ3BDQyxJQUFJLEVBQUVOO0lBQ1IsQ0FBQzs7SUFFRDtJQUNBLE1BQU1kLFdBQVcsQ0FBQ3FCLFFBQVEsQ0FBQ0wsV0FBVyxDQUFDOztJQUV2QztJQUNBOUIsR0FBRyxDQUNBb0MsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUNYQyxJQUFJLENBQUM7TUFBRUMsT0FBTyxFQUFFO0lBQStDLENBQUMsQ0FBQztFQUN0RSxDQUFDLENBQUMsT0FBT0MsS0FBSyxFQUFFO0lBQ2Q3QixPQUFPLENBQUM2QixLQUFLLENBQUNBLEtBQUssQ0FBQztJQUNwQnRDLElBQUksQ0FDRixJQUFJdUMsaUJBQVEsQ0FDVixxREFBcUQsRUFDckQsR0FBRyxFQUNILG1CQUNGLENBQ0YsQ0FBQztFQUNIO0FBQ0YsQ0FBQztBQUFDQyxPQUFBLENBQUEzQyxtQkFBQSxHQUFBQSxtQkFBQTtBQUVGLE1BQU00Qyx5QkFBeUIsR0FBRyxNQUFBQSxDQUFPM0MsR0FBRyxFQUFFQyxHQUFHLEVBQUVDLElBQUksS0FBSztFQUMxRCxNQUFNO0lBQUVDO0VBQU0sQ0FBQyxHQUFHSCxHQUFHLENBQUNJLElBQUk7RUFFMUIsSUFBSTtJQUNGLElBQUFDLGlDQUFrQixFQUFDRixLQUFLLEVBQUUsT0FBTyxDQUFDO0lBRWxDLE1BQU15QyxNQUFNLEdBQUcsTUFBTUMsZUFBTyxDQUFDckMsT0FBTyxDQUFDO01BQUVMO0lBQU0sQ0FBQyxDQUFDO0lBRS9DLElBQUFNLGdDQUFnQixFQUFDbUMsTUFBTSxFQUFFLFFBQVEsQ0FBQzs7SUFFbEM7SUFDQSxNQUFNbEMsV0FBVyxHQUFHakIsc0JBQXNCLENBQUMsQ0FBQztJQUM1Q2tCLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLFlBQVksRUFBRUYsV0FBVyxDQUFDOztJQUV0QztJQUNBa0MsTUFBTSxDQUFDL0IsUUFBUSxHQUFHSCxXQUFXO0lBQzdCLE1BQU1rQyxNQUFNLENBQUM5QixJQUFJLENBQUMsQ0FBQzs7SUFFbkI7SUFDQSxNQUFNQyxXQUFXLEdBQUdDLG1CQUFVLENBQUNDLGVBQWUsQ0FBQztNQUM3Q0MsSUFBSSxFQUFFLGlCQUFpQjtNQUN2QkMsSUFBSSxFQUFFLEdBQUc7TUFDVEMsTUFBTSxFQUFFLElBQUk7TUFDWkMsSUFBSSxFQUFFO1FBQ0pmLElBQUksRUFBRWdCLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxXQUFXO1FBQzdCQyxJQUFJLEVBQUVILE9BQU8sQ0FBQ0MsR0FBRyxDQUFDRztNQUNwQixDQUFDO01BQ0RDLEtBQUssRUFBRSxJQUFJO01BQ1hDLE1BQU0sRUFBRTtJQUNWLENBQUMsQ0FBQzs7SUFFRjtJQUNBLE1BQU1DLGFBQWEsR0FBRztBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0RBQ1VlLE1BQU0sQ0FBQ2QsSUFBSSxJQUFJLFdBQVc7QUFDcEM7QUFDQTtBQUNBLDJFQUMyRXBCLFdBQVc7QUFDdEY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7SUFFRCxNQUFNcUIsV0FBVyxHQUFHO01BQ2xCQyxJQUFJLEVBQUUsaUJBQWlCVixPQUFPLENBQUNDLEdBQUcsQ0FBQ0MsV0FBVyxHQUFHO01BQ2pEUyxFQUFFLEVBQUU5QixLQUFLO01BQ1QrQixPQUFPLEVBQUUsMkJBQTJCO01BQ3BDQyxJQUFJLEVBQUVOO0lBQ1IsQ0FBQzs7SUFFRDtJQUNBLE1BQU1kLFdBQVcsQ0FBQ3FCLFFBQVEsQ0FBQ0wsV0FBVyxDQUFDOztJQUV2QztJQUNBOUIsR0FBRyxDQUNBb0MsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUNYQyxJQUFJLENBQUM7TUFBRUMsT0FBTyxFQUFFO0lBQStDLENBQUMsQ0FBQztFQUN0RSxDQUFDLENBQUMsT0FBT0MsS0FBSyxFQUFFO0lBQ2Q3QixPQUFPLENBQUM2QixLQUFLLENBQUNBLEtBQUssQ0FBQztJQUNwQnRDLElBQUksQ0FDRixJQUFJdUMsaUJBQVEsQ0FDVixxREFBcUQsRUFDckQsR0FBRyxFQUNILG1CQUNGLENBQ0YsQ0FBQztFQUNIO0FBQ0YsQ0FBQztBQUFDQyxPQUFBLENBQUFDLHlCQUFBLEdBQUFBLHlCQUFBIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["_crypto","_interopRequireDefault","require","_nodemailer","_seller","_users","_ApiError","_CheckExistence","_RequiredCheck","e","__esModule","default","generateRandomPassword","length","crypto","randomBytes","toString","slice","forgotPasswordEmail","req","res","next","email","body","checkRequiredField","user","Users","findOne","notFoundVariable","newPassword","console","log","password","save","transporter","nodemailer","createTransport","host","port","secure","auth","process","env","MAIL_SENDER","pass","MAIL_SENDER_PASSWORD","debug","logger","emailTemplate","name","mailOptions","from","to","subject","html","sendMail","status","json","message","error","ApiError","exports","forgotSellerPasswordEmail","seller","Sellers"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["ForgotPasswordMail.js"],"sourcesContent":["import crypto from \"crypto\";\nimport nodemailer from \"nodemailer\";\nimport Sellers from \"../db/seller\";\nimport Users from \"../db/users\"; // Kullanıcı modelinizi buraya dahil edin\nimport ApiError from \"../errors/ApiError\";\nimport { notFoundVariable } from \"../helpers/CheckExistence\";\nimport { checkRequiredField } from \"../helpers/RequiredCheck\";\n\n// Rastgele şifre üretme fonksiyonu\nconst generateRandomPassword = (length = 12) => {\n  return crypto.randomBytes(length).toString(\"hex\").slice(0, length);\n};\n\nconst forgotPasswordEmail = async (req, res, next) => {\n  const { email } = req.body;\n\n  try {\n    checkRequiredField(email, \"Email\");\n\n    const user = await Users.findOne({ email });\n\n    notFoundVariable(user, \"User\");\n\n    // Rastgele bir şifre oluştur\n    const newPassword = generateRandomPassword();\n    console.log(\"Yeni Şifre\", newPassword);\n\n    // Kullanıcının şifresini yeni rastgele şifre ile güncelle\n    user.password = newPassword;\n    await user.save();\n\n    // E-posta ayarları\n    const transporter = nodemailer.createTransport({\n      host: \"smtp.yandex.com\",\n      port: 465,\n      secure: true,\n      auth: {\n        user: process.env.MAIL_SENDER,\n        pass: process.env.MAIL_SENDER_PASSWORD,\n      },\n      debug: true,\n      logger: true,\n    });\n\n    // HTML e-posta tasarımı\n    const emailTemplate = `\n      <div style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; border: 1px solid #e1e4e8; border-radius: 8px; padding: 20px; background-color: #f9f9f9;\">\n        <div style=\"text-align: center; padding: 20px 0;\">\n          <img src=\"https://via.placeholder.com/150x50?text=Your+Logo\" alt=\"Logo\" style=\"max-width: 100px; margin-bottom: 20px;\" />\n          <h2 style=\"color: #444;\">Şifre Sıfırlama Talebiniz Tamamlandı</h2>\n        </div>\n        <p style=\"font-size: 16px;\">Merhaba <strong>${\n          user.name || \"Kullanıcı\"\n        }</strong>,</p>\n        <p style=\"font-size: 16px;\">Hesabınız için yeni bir şifre oluşturuldu. Aşağıda bu şifreyi bulabilirsiniz:</p>\n        <div style=\"background-color: #eef5fc; padding: 15px; text-align: center; margin: 20px 0; border-radius: 8px; border: 1px solid #d6e4f2;\">\n          <p style=\"font-size: 18px; font-weight: bold; color: #2a7ade;\">${newPassword}</p>\n        </div>\n        <p style=\"font-size: 16px;\">Güvenliğiniz için lütfen giriş yaptıktan sonra bu şifreyi değiştirin.</p>\n        <p style=\"font-size: 16px;\">Herhangi bir sorunla karşılaşırsanız lütfen bizimle iletişime geçmekten çekinmeyin.</p>\n        <hr style=\"border: 0; border-top: 1px solid #ddd; margin: 20px 0;\" />\n        <p style=\"font-size: 14px; color: #666; text-align: center;\">\n          Bu e-posta, şifre sıfırlama talebiniz üzerine gönderilmiştir. Eğer bu talebi siz yapmadıysanız, lütfen bizimle iletişime geçin.\n        </p>\n      </div>\n    `;\n\n    const mailOptions = {\n      from: `\"TURKOTREND\" <${process.env.MAIL_SENDER}>`,\n      to: email,\n      subject: \"Şifre Sıfırlama Talebiniz\",\n      html: emailTemplate,\n    };\n\n    // E-postayı gönder\n    await transporter.sendMail(mailOptions);\n\n    // Başarı yanıtı\n    res\n      .status(200)\n      .json({ message: \"Yeni şifreniz e-posta adresinize gönderildi.\" });\n  } catch (error) {\n    console.error(error);\n    next(\n      new ApiError(\n        \"There was an error sending the password reset email\",\n        500,\n        \"emailSendingError\"\n      )\n    );\n  }\n};\n\nconst forgotSellerPasswordEmail = async (req, res, next) => {\n  const { email } = req.body;\n\n  try {\n    checkRequiredField(email, \"Email\");\n\n    const seller = await Sellers.findOne({ email });\n\n    notFoundVariable(seller, \"Seller\");\n\n    // Rastgele bir şifre oluştur\n    const newPassword = generateRandomPassword();\n    console.log(\"Yeni Şifre\", newPassword);\n\n    // Kullanıcının şifresini yeni rastgele şifre ile güncelle\n    seller.password = newPassword;\n    await seller.save();\n\n    // E-posta ayarları\n    const transporter = nodemailer.createTransport({\n      host: \"smtp.yandex.com\",\n      port: 465,\n      secure: true,\n      auth: {\n        user: process.env.MAIL_SENDER,\n        pass: process.env.MAIL_SENDER_PASSWORD,\n      },\n      debug: true,\n      logger: true,\n    });\n\n    // HTML e-posta tasarımı\n    const emailTemplate = `\n      <div style=\"font-family: Arial, sans-serif; line-height: 1.6; color: #333; max-width: 600px; margin: 0 auto; border: 1px solid #e1e4e8; border-radius: 8px; padding: 20px; background-color: #f9f9f9;\">\n        <div style=\"text-align: center; padding: 20px 0;\">\n          <img src=\"https://via.placeholder.com/150x50?text=Your+Logo\" alt=\"Logo\" style=\"max-width: 100px; margin-bottom: 20px;\" />\n          <h2 style=\"color: #444;\">Şifre Sıfırlama Talebiniz Tamamlandı</h2>\n        </div>\n        <p style=\"font-size: 16px;\">Merhaba <strong>${\n          seller.name || \"Kullanıcı\"\n        }</strong>,</p>\n        <p style=\"font-size: 16px;\">Hesabınız için yeni bir şifre oluşturuldu. Aşağıda bu şifreyi bulabilirsiniz:</p>\n        <div style=\"background-color: #eef5fc; padding: 15px; text-align: center; margin: 20px 0; border-radius: 8px; border: 1px solid #d6e4f2;\">\n          <p style=\"font-size: 18px; font-weight: bold; color: #2a7ade;\">${newPassword}</p>\n        </div>\n        <p style=\"font-size: 16px;\">Güvenliğiniz için lütfen giriş yaptıktan sonra bu şifreyi değiştirin.</p>\n        <p style=\"font-size: 16px;\">Herhangi bir sorunla karşılaşırsanız lütfen bizimle iletişime geçmekten çekinmeyin.</p>\n        <hr style=\"border: 0; border-top: 1px solid #ddd; margin: 20px 0;\" />\n        <p style=\"font-size: 14px; color: #666; text-align: center;\">\n          Bu e-posta, şifre sıfırlama talebiniz üzerine gönderilmiştir. Eğer bu talebi siz yapmadıysanız, lütfen bizimle iletişime geçin.\n        </p>\n      </div>\n    `;\n\n    const mailOptions = {\n      from: `\"TURKOTREND\" <${process.env.MAIL_SENDER}>`,\n      to: email,\n      subject: \"Şifre Sıfırlama Talebiniz\",\n      html: emailTemplate,\n    };\n\n    // E-postayı gönder\n    await transporter.sendMail(mailOptions);\n\n    // Başarı yanıtı\n    res\n      .status(200)\n      .json({ message: \"Yeni şifreniz e-posta adresinize gönderildi.\" });\n  } catch (error) {\n    console.error(error);\n    next(\n      new ApiError(\n        \"There was an error sending the password reset email\",\n        500,\n        \"emailSendingError\"\n      )\n    );\n  }\n};\n\nexport { forgotPasswordEmail, forgotSellerPasswordEmail };\n"],"mappings":";;;;;;AAAA,IAAAA,OAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,WAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,OAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,MAAA,GAAAJ,sBAAA,CAAAC,OAAA;AACA,IAAAI,SAAA,GAAAL,sBAAA,CAAAC,OAAA;AACA,IAAAK,eAAA,GAAAL,OAAA;AACA,IAAAM,cAAA,GAAAN,OAAA;AAA8D,SAAAD,uBAAAQ,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAH7B;;AAKjC;AACA,MAAMG,sBAAsB,GAAGA,CAACC,MAAM,GAAG,EAAE,KAAK;EAC9C,OAAOC,eAAM,CAACC,WAAW,CAACF,MAAM,CAAC,CAACG,QAAQ,CAAC,KAAK,CAAC,CAACC,KAAK,CAAC,CAAC,EAAEJ,MAAM,CAAC;AACpE,CAAC;AAED,MAAMK,mBAAmB,GAAG,MAAAA,CAAOC,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EACpD,MAAM;IAAEC;EAAM,CAAC,GAAGH,GAAG,CAACI,IAAI;EAE1B,IAAI;IACF,IAAAC,iCAAkB,EAACF,KAAK,EAAE,OAAO,CAAC;IAElC,MAAMG,IAAI,GAAG,MAAMC,cAAK,CAACC,OAAO,CAAC;MAAEL;IAAM,CAAC,CAAC;IAE3C,IAAAM,gCAAgB,EAACH,IAAI,EAAE,MAAM,CAAC;;IAE9B;IACA,MAAMI,WAAW,GAAGjB,sBAAsB,CAAC,CAAC;IAC5CkB,OAAO,CAACC,GAAG,CAAC,YAAY,EAAEF,WAAW,CAAC;;IAEtC;IACAJ,IAAI,CAACO,QAAQ,GAAGH,WAAW;IAC3B,MAAMJ,IAAI,CAACQ,IAAI,CAAC,CAAC;;IAEjB;IACA,MAAMC,WAAW,GAAGC,mBAAU,CAACC,eAAe,CAAC;MAC7CC,IAAI,EAAE,iBAAiB;MACvBC,IAAI,EAAE,GAAG;MACTC,MAAM,EAAE,IAAI;MACZC,IAAI,EAAE;QACJf,IAAI,EAAEgB,OAAO,CAACC,GAAG,CAACC,WAAW;QAC7BC,IAAI,EAAEH,OAAO,CAACC,GAAG,CAACG;MACpB,CAAC;MACDC,KAAK,EAAE,IAAI;MACXC,MAAM,EAAE;IACV,CAAC,CAAC;;IAEF;IACA,MAAMC,aAAa,GAAG;AAC1B;AACA;AACA;AACA;AACA;AACA,sDACUvB,IAAI,CAACwB,IAAI,IAAI,WAAW;AAClC;AACA;AACA,2EAC2EpB,WAAW;AACtF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;IAED,MAAMqB,WAAW,GAAG;MAClBC,IAAI,EAAE,iBAAiBV,OAAO,CAACC,GAAG,CAACC,WAAW,GAAG;MACjDS,EAAE,EAAE9B,KAAK;MACT+B,OAAO,EAAE,2BAA2B;MACpCC,IAAI,EAAEN;IACR,CAAC;;IAED;IACA,MAAMd,WAAW,CAACqB,QAAQ,CAACL,WAAW,CAAC;;IAEvC;IACA9B,GAAG,CACAoC,MAAM,CAAC,GAAG,CAAC,CACXC,IAAI,CAAC;MAAEC,OAAO,EAAE;IAA+C,CAAC,CAAC;EACtE,CAAC,CAAC,OAAOC,KAAK,EAAE;IACd7B,OAAO,CAAC6B,KAAK,CAACA,KAAK,CAAC;IACpBtC,IAAI,CACF,IAAIuC,iBAAQ,CACV,qDAAqD,EACrD,GAAG,EACH,mBACF,CACF,CAAC;EACH;AACF,CAAC;AAACC,OAAA,CAAA3C,mBAAA,GAAAA,mBAAA;AAEF,MAAM4C,yBAAyB,GAAG,MAAAA,CAAO3C,GAAG,EAAEC,GAAG,EAAEC,IAAI,KAAK;EAC1D,MAAM;IAAEC;EAAM,CAAC,GAAGH,GAAG,CAACI,IAAI;EAE1B,IAAI;IACF,IAAAC,iCAAkB,EAACF,KAAK,EAAE,OAAO,CAAC;IAElC,MAAMyC,MAAM,GAAG,MAAMC,eAAO,CAACrC,OAAO,CAAC;MAAEL;IAAM,CAAC,CAAC;IAE/C,IAAAM,gCAAgB,EAACmC,MAAM,EAAE,QAAQ,CAAC;;IAElC;IACA,MAAMlC,WAAW,GAAGjB,sBAAsB,CAAC,CAAC;IAC5CkB,OAAO,CAACC,GAAG,CAAC,YAAY,EAAEF,WAAW,CAAC;;IAEtC;IACAkC,MAAM,CAAC/B,QAAQ,GAAGH,WAAW;IAC7B,MAAMkC,MAAM,CAAC9B,IAAI,CAAC,CAAC;;IAEnB;IACA,MAAMC,WAAW,GAAGC,mBAAU,CAACC,eAAe,CAAC;MAC7CC,IAAI,EAAE,iBAAiB;MACvBC,IAAI,EAAE,GAAG;MACTC,MAAM,EAAE,IAAI;MACZC,IAAI,EAAE;QACJf,IAAI,EAAEgB,OAAO,CAACC,GAAG,CAACC,WAAW;QAC7BC,IAAI,EAAEH,OAAO,CAACC,GAAG,CAACG;MACpB,CAAC;MACDC,KAAK,EAAE,IAAI;MACXC,MAAM,EAAE;IACV,CAAC,CAAC;;IAEF;IACA,MAAMC,aAAa,GAAG;AAC1B;AACA;AACA;AACA;AACA;AACA,sDACUe,MAAM,CAACd,IAAI,IAAI,WAAW;AACpC;AACA;AACA,2EAC2EpB,WAAW;AACtF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;IAED,MAAMqB,WAAW,GAAG;MAClBC,IAAI,EAAE,iBAAiBV,OAAO,CAACC,GAAG,CAACC,WAAW,GAAG;MACjDS,EAAE,EAAE9B,KAAK;MACT+B,OAAO,EAAE,2BAA2B;MACpCC,IAAI,EAAEN;IACR,CAAC;;IAED;IACA,MAAMd,WAAW,CAACqB,QAAQ,CAACL,WAAW,CAAC;;IAEvC;IACA9B,GAAG,CACAoC,MAAM,CAAC,GAAG,CAAC,CACXC,IAAI,CAAC;MAAEC,OAAO,EAAE;IAA+C,CAAC,CAAC;EACtE,CAAC,CAAC,OAAOC,KAAK,EAAE;IACd7B,OAAO,CAAC6B,KAAK,CAACA,KAAK,CAAC;IACpBtC,IAAI,CACF,IAAIuC,iBAAQ,CACV,qDAAqD,EACrD,GAAG,EACH,mBACF,CACF,CAAC;EACH;AACF,CAAC;AAACC,OAAA,CAAAC,yBAAA,GAAAA,yBAAA","ignoreList":[]}},"mtime":1734443634302},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/seller.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst randomColorGenerator = () => {\n  return Math.floor(Math.random() * 16777215).toString(16);\n};\n// const DocumentsEnum = [\n//   \"vergi_levhasi\",\n//   \"isletme_kayit_belgesi\",\n//   \"sicil_gazetesi\",\n//   \"diger\",\n// ];\n\nconst DocumentSchema = new Schema({\n  sicil_gazetesi: {\n    type: String\n    // required: true,\n  },\n  vergi_levhasi: {\n    type: String\n    // required: true,\n  },\n  uploadedAt: {\n    type: Date,\n    default: Date.now\n  }\n}, {\n  _id: false\n});\nconst SellerSchema = new Schema({\n  locale: {\n    type: String,\n    default: \"tr\"\n  },\n  conversationId: {\n    type: String,\n    default: (0, _uuid.default)()\n  },\n  role: {\n    type: String,\n    // required: true,\n    default: \"seller\",\n    enum: [\"user\", \"admin\", \"seller\"]\n  },\n  subMerchantExternalId: {\n    type: String,\n    // required: true,\n    default: (0, _uuid.default)()\n  },\n  subMerchantType: {\n    type: String,\n    enum: [\"PRIVATE_COMPANY\", \"LIMITED_OR_JOINT_STOCK_COMPANY\"]\n    // default: \"PRIVATE_COMPANY\",\n    // required: true,\n  },\n  currency: {\n    type: String,\n    default: \"TRY\",\n    enum: [\"TRY\", \"USD\", \"EUR\", \"GBP\", \"RUB\", \"CHF\", \"NOK\"]\n  },\n  identityNumber: {\n    type: String,\n    // minlength: 11,\n    // maxlength: 11,\n    required: function () {\n      return this.subMerchantType === \"PRIVATE_COMPANY\";\n    },\n    unique: true\n  },\n  taxNumber: {\n    type: String,\n    required: function () {\n      return this.subMerchantType === \"LIMITED_OR_JOINT_STOCK_COMPANY\";\n    },\n    unique: true\n  },\n  name: {\n    type: String\n    // required: true,\n  },\n  gsmNumber: {\n    type: String\n    // minlength: 12,\n    // maxlength: 12,\n    // required: true,\n  },\n  email: {\n    type: String\n    // required: true,\n  },\n  password: {\n    type: String\n    // required: true,\n  },\n  taxOffice: {\n    type: String\n    // required: true,\n  },\n  legalCompanyTitle: {\n    type: String\n    // required: true,\n  },\n  iban: {\n    type: String,\n    // required: true,\n    unique: true\n    // minlength: 26,\n    // maxlength: 26,\n  },\n  address: {\n    type: String\n    // required: true,\n  },\n  avatarColor: {\n    type: String,\n    default: randomColorGenerator()\n    // required: true,\n  },\n  logo: {\n    type: String\n    // required: false,\n  },\n  products: {\n    type: ObjectId,\n    ref: \"Products\"\n  },\n  documents: {\n    type: [DocumentSchema]\n    // required: true,\n  },\n  isVerified: {\n    type: Boolean,\n    default: false\n  },\n  subMerchantKey: {\n    type: String,\n    unique: true\n  }\n}, {\n  _id: true,\n  collection: \"seller\",\n  timestamps: true,\n  toJSON: {\n    transform: (doc, ret) => {\n      delete ret.__v;\n      delete ret.password;\n      return {\n        ...ret\n      };\n    }\n  }\n});\nSellerSchema.pre(\"save\", async function (next) {\n  try {\n    if (!this.gsmNumber.startsWith(\"+90\") && !this.iban.startsWith(\"TR\")) {\n      this.iban = `TR${this.iban}`;\n      this.gsmNumber = `+90${this.gsmNumber}`;\n    }\n    // this.password = await bcrypt.hash(this.password, 10);\n    if (this.isModified(\"password\")) {\n      //password incorrect hatasını böyle çözdük\n      this.password = await _bcryptjs.default.hash(this.password, 10);\n    }\n    return next();\n  } catch (err) {\n    return next(err);\n  }\n  next();\n});\nconst Sellers = _mongoose.default.model(\"Sellers\", SellerSchema);\nvar _default = exports.default = Sellers;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYmNyeXB0anMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9tb25nb29zZSIsIl91dWlkIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiU2NoZW1hIiwibW9uZ29vc2UiLCJPYmplY3RJZCIsIlR5cGVzIiwicmFuZG9tQ29sb3JHZW5lcmF0b3IiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJ0b1N0cmluZyIsIkRvY3VtZW50U2NoZW1hIiwic2ljaWxfZ2F6ZXRlc2kiLCJ0eXBlIiwiU3RyaW5nIiwidmVyZ2lfbGV2aGFzaSIsInVwbG9hZGVkQXQiLCJEYXRlIiwibm93IiwiX2lkIiwiU2VsbGVyU2NoZW1hIiwibG9jYWxlIiwiY29udmVyc2F0aW9uSWQiLCJnZW5lcmF0ZWRJZCIsInJvbGUiLCJlbnVtIiwic3ViTWVyY2hhbnRFeHRlcm5hbElkIiwic3ViTWVyY2hhbnRUeXBlIiwiY3VycmVuY3kiLCJpZGVudGl0eU51bWJlciIsInJlcXVpcmVkIiwidW5pcXVlIiwidGF4TnVtYmVyIiwibmFtZSIsImdzbU51bWJlciIsImVtYWlsIiwicGFzc3dvcmQiLCJ0YXhPZmZpY2UiLCJsZWdhbENvbXBhbnlUaXRsZSIsImliYW4iLCJhZGRyZXNzIiwiYXZhdGFyQ29sb3IiLCJsb2dvIiwicHJvZHVjdHMiLCJyZWYiLCJkb2N1bWVudHMiLCJpc1ZlcmlmaWVkIiwiQm9vbGVhbiIsInN1Yk1lcmNoYW50S2V5IiwiY29sbGVjdGlvbiIsInRpbWVzdGFtcHMiLCJ0b0pTT04iLCJ0cmFuc2Zvcm0iLCJkb2MiLCJyZXQiLCJfX3YiLCJwcmUiLCJuZXh0Iiwic3RhcnRzV2l0aCIsImlzTW9kaWZpZWQiLCJiY3J5cHQiLCJoYXNoIiwiZXJyIiwiU2VsbGVycyIsIm1vZGVsIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvZGIvIiwic291cmNlcyI6WyJzZWxsZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGJjcnlwdCBmcm9tIFwiYmNyeXB0anNcIjtcbmltcG9ydCBtb25nb29zZSBmcm9tIFwibW9uZ29vc2VcIjtcbmltcG9ydCBnZW5lcmF0ZWRJZCBmcm9tIFwiLi4vdXRpbHMvdXVpZFwiO1xuXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWE7XG5jb25zdCB7IE9iamVjdElkIH0gPSBTY2hlbWEuVHlwZXM7XG5jb25zdCByYW5kb21Db2xvckdlbmVyYXRvciA9ICgpID0+IHtcbiAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDE2Nzc3MjE1KS50b1N0cmluZygxNik7XG59O1xuLy8gY29uc3QgRG9jdW1lbnRzRW51bSA9IFtcbi8vICAgXCJ2ZXJnaV9sZXZoYXNpXCIsXG4vLyAgIFwiaXNsZXRtZV9rYXlpdF9iZWxnZXNpXCIsXG4vLyAgIFwic2ljaWxfZ2F6ZXRlc2lcIixcbi8vICAgXCJkaWdlclwiLFxuLy8gXTtcblxuY29uc3QgRG9jdW1lbnRTY2hlbWEgPSBuZXcgU2NoZW1hKFxuICB7XG4gICAgc2ljaWxfZ2F6ZXRlc2k6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIC8vIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgdmVyZ2lfbGV2aGFzaToge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgLy8gcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICB1cGxvYWRlZEF0OiB7XG4gICAgICB0eXBlOiBEYXRlLFxuICAgICAgZGVmYXVsdDogRGF0ZS5ub3csXG4gICAgfSxcbiAgfSxcbiAgeyBfaWQ6IGZhbHNlIH1cbik7XG5jb25zdCBTZWxsZXJTY2hlbWEgPSBuZXcgU2NoZW1hKFxuICB7XG4gICAgbG9jYWxlOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICBkZWZhdWx0OiBcInRyXCIsXG4gICAgfSxcbiAgICBjb252ZXJzYXRpb25JZDoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgZGVmYXVsdDogZ2VuZXJhdGVkSWQoKSxcbiAgICB9LFxuICAgIHJvbGU6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIC8vIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgZGVmYXVsdDogXCJzZWxsZXJcIixcbiAgICAgIGVudW06IFtcInVzZXJcIiwgXCJhZG1pblwiLCBcInNlbGxlclwiXSxcbiAgICB9LFxuICAgIHN1Yk1lcmNoYW50RXh0ZXJuYWxJZDoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgLy8gcmVxdWlyZWQ6IHRydWUsXG4gICAgICBkZWZhdWx0OiBnZW5lcmF0ZWRJZCgpLFxuICAgIH0sXG4gICAgc3ViTWVyY2hhbnRUeXBlOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICBlbnVtOiBbXCJQUklWQVRFX0NPTVBBTllcIiwgXCJMSU1JVEVEX09SX0pPSU5UX1NUT0NLX0NPTVBBTllcIl0sXG4gICAgICAvLyBkZWZhdWx0OiBcIlBSSVZBVEVfQ09NUEFOWVwiLFxuICAgICAgLy8gcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBjdXJyZW5jeToge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgZGVmYXVsdDogXCJUUllcIixcbiAgICAgIGVudW06IFtcIlRSWVwiLCBcIlVTRFwiLCBcIkVVUlwiLCBcIkdCUFwiLCBcIlJVQlwiLCBcIkNIRlwiLCBcIk5PS1wiXSxcbiAgICB9LFxuICAgIGlkZW50aXR5TnVtYmVyOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAvLyBtaW5sZW5ndGg6IDExLFxuICAgICAgLy8gbWF4bGVuZ3RoOiAxMSxcbiAgICAgIHJlcXVpcmVkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN1Yk1lcmNoYW50VHlwZSA9PT0gXCJQUklWQVRFX0NPTVBBTllcIjtcbiAgICAgIH0sXG4gICAgICB1bmlxdWU6IHRydWUsXG4gICAgfSxcbiAgICB0YXhOdW1iZXI6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN1Yk1lcmNoYW50VHlwZSA9PT0gXCJMSU1JVEVEX09SX0pPSU5UX1NUT0NLX0NPTVBBTllcIjtcbiAgICAgIH0sXG4gICAgICB1bmlxdWU6IHRydWUsXG4gICAgfSxcbiAgICBuYW1lOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAvLyByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGdzbU51bWJlcjoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgLy8gbWlubGVuZ3RoOiAxMixcbiAgICAgIC8vIG1heGxlbmd0aDogMTIsXG4gICAgICAvLyByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGVtYWlsOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAvLyByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIHBhc3N3b3JkOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAvLyByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIHRheE9mZmljZToge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgLy8gcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBsZWdhbENvbXBhbnlUaXRsZToge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgLy8gcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBpYmFuOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAvLyByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIHVuaXF1ZTogdHJ1ZSxcbiAgICAgIC8vIG1pbmxlbmd0aDogMjYsXG4gICAgICAvLyBtYXhsZW5ndGg6IDI2LFxuICAgIH0sXG4gICAgYWRkcmVzczoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgLy8gcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBhdmF0YXJDb2xvcjoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgZGVmYXVsdDogcmFuZG9tQ29sb3JHZW5lcmF0b3IoKSxcbiAgICAgIC8vIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgbG9nbzoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgLy8gcmVxdWlyZWQ6IGZhbHNlLFxuICAgIH0sXG4gICAgcHJvZHVjdHM6IHtcbiAgICAgIHR5cGU6IE9iamVjdElkLFxuICAgICAgcmVmOiBcIlByb2R1Y3RzXCIsXG4gICAgfSxcbiAgICBkb2N1bWVudHM6IHtcbiAgICAgIHR5cGU6IFtEb2N1bWVudFNjaGVtYV0sXG4gICAgICAvLyByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGlzVmVyaWZpZWQ6IHtcbiAgICAgIHR5cGU6IEJvb2xlYW4sXG4gICAgICBkZWZhdWx0OiBmYWxzZSxcbiAgICB9LFxuICAgIHN1Yk1lcmNoYW50S2V5OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICB1bmlxdWU6IHRydWUsXG4gICAgfSxcbiAgfSxcbiAge1xuICAgIF9pZDogdHJ1ZSxcbiAgICBjb2xsZWN0aW9uOiBcInNlbGxlclwiLFxuICAgIHRpbWVzdGFtcHM6IHRydWUsXG4gICAgdG9KU09OOiB7XG4gICAgICB0cmFuc2Zvcm06IChkb2MsIHJldCkgPT4ge1xuICAgICAgICBkZWxldGUgcmV0Ll9fdjtcbiAgICAgICAgZGVsZXRlIHJldC5wYXNzd29yZDtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAuLi5yZXQsXG4gICAgICAgIH07XG4gICAgICB9LFxuICAgIH0sXG4gIH1cbik7XG5cblNlbGxlclNjaGVtYS5wcmUoXCJzYXZlXCIsIGFzeW5jIGZ1bmN0aW9uIChuZXh0KSB7XG4gIHRyeSB7XG4gICAgaWYgKCF0aGlzLmdzbU51bWJlci5zdGFydHNXaXRoKFwiKzkwXCIpICYmICF0aGlzLmliYW4uc3RhcnRzV2l0aChcIlRSXCIpKSB7XG4gICAgICB0aGlzLmliYW4gPSBgVFIke3RoaXMuaWJhbn1gO1xuICAgICAgdGhpcy5nc21OdW1iZXIgPSBgKzkwJHt0aGlzLmdzbU51bWJlcn1gO1xuICAgIH1cbiAgICAvLyB0aGlzLnBhc3N3b3JkID0gYXdhaXQgYmNyeXB0Lmhhc2godGhpcy5wYXNzd29yZCwgMTApO1xuICAgIGlmICh0aGlzLmlzTW9kaWZpZWQoXCJwYXNzd29yZFwiKSkge1xuICAgICAgLy9wYXNzd29yZCBpbmNvcnJlY3QgaGF0YXPEsW7EsSBiw7Z5bGUgw6fDtnpkw7xrXG4gICAgICB0aGlzLnBhc3N3b3JkID0gYXdhaXQgYmNyeXB0Lmhhc2godGhpcy5wYXNzd29yZCwgMTApO1xuICAgIH1cbiAgICByZXR1cm4gbmV4dCgpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICByZXR1cm4gbmV4dChlcnIpO1xuICB9XG4gIG5leHQoKTtcbn0pO1xuY29uc3QgU2VsbGVycyA9IG1vbmdvb3NlLm1vZGVsKFwiU2VsbGVyc1wiLCBTZWxsZXJTY2hlbWEpO1xuXG5leHBvcnQgZGVmYXVsdCBTZWxsZXJzO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxTQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxTQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxLQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFBd0MsU0FBQUQsdUJBQUFJLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFeEMsTUFBTUcsTUFBTSxHQUFHQyxpQkFBUSxDQUFDRCxNQUFNO0FBQzlCLE1BQU07RUFBRUU7QUFBUyxDQUFDLEdBQUdGLE1BQU0sQ0FBQ0csS0FBSztBQUNqQyxNQUFNQyxvQkFBb0IsR0FBR0EsQ0FBQSxLQUFNO0VBQ2pDLE9BQU9DLElBQUksQ0FBQ0MsS0FBSyxDQUFDRCxJQUFJLENBQUNFLE1BQU0sQ0FBQyxDQUFDLEdBQUcsUUFBUSxDQUFDLENBQUNDLFFBQVEsQ0FBQyxFQUFFLENBQUM7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","map":{"version":3,"names":["_bcryptjs","_interopRequireDefault","require","_mongoose","_uuid","e","__esModule","default","Schema","mongoose","ObjectId","Types","randomColorGenerator","Math","floor","random","toString","DocumentSchema","sicil_gazetesi","type","String","vergi_levhasi","uploadedAt","Date","now","_id","SellerSchema","locale","conversationId","generatedId","role","enum","subMerchantExternalId","subMerchantType","currency","identityNumber","required","unique","taxNumber","name","gsmNumber","email","password","taxOffice","legalCompanyTitle","iban","address","avatarColor","logo","products","ref","documents","isVerified","Boolean","subMerchantKey","collection","timestamps","toJSON","transform","doc","ret","__v","pre","next","startsWith","isModified","bcrypt","hash","err","Sellers","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["seller.js"],"sourcesContent":["import bcrypt from \"bcryptjs\";\nimport mongoose from \"mongoose\";\nimport generatedId from \"../utils/uuid\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\nconst randomColorGenerator = () => {\n  return Math.floor(Math.random() * 16777215).toString(16);\n};\n// const DocumentsEnum = [\n//   \"vergi_levhasi\",\n//   \"isletme_kayit_belgesi\",\n//   \"sicil_gazetesi\",\n//   \"diger\",\n// ];\n\nconst DocumentSchema = new Schema(\n  {\n    sicil_gazetesi: {\n      type: String,\n      // required: true,\n    },\n    vergi_levhasi: {\n      type: String,\n      // required: true,\n    },\n    uploadedAt: {\n      type: Date,\n      default: Date.now,\n    },\n  },\n  { _id: false }\n);\nconst SellerSchema = new Schema(\n  {\n    locale: {\n      type: String,\n      default: \"tr\",\n    },\n    conversationId: {\n      type: String,\n      default: generatedId(),\n    },\n    role: {\n      type: String,\n      // required: true,\n      default: \"seller\",\n      enum: [\"user\", \"admin\", \"seller\"],\n    },\n    subMerchantExternalId: {\n      type: String,\n      // required: true,\n      default: generatedId(),\n    },\n    subMerchantType: {\n      type: String,\n      enum: [\"PRIVATE_COMPANY\", \"LIMITED_OR_JOINT_STOCK_COMPANY\"],\n      // default: \"PRIVATE_COMPANY\",\n      // required: true,\n    },\n    currency: {\n      type: String,\n      default: \"TRY\",\n      enum: [\"TRY\", \"USD\", \"EUR\", \"GBP\", \"RUB\", \"CHF\", \"NOK\"],\n    },\n    identityNumber: {\n      type: String,\n      // minlength: 11,\n      // maxlength: 11,\n      required: function () {\n        return this.subMerchantType === \"PRIVATE_COMPANY\";\n      },\n      unique: true,\n    },\n    taxNumber: {\n      type: String,\n      required: function () {\n        return this.subMerchantType === \"LIMITED_OR_JOINT_STOCK_COMPANY\";\n      },\n      unique: true,\n    },\n    name: {\n      type: String,\n      // required: true,\n    },\n    gsmNumber: {\n      type: String,\n      // minlength: 12,\n      // maxlength: 12,\n      // required: true,\n    },\n    email: {\n      type: String,\n      // required: true,\n    },\n    password: {\n      type: String,\n      // required: true,\n    },\n    taxOffice: {\n      type: String,\n      // required: true,\n    },\n    legalCompanyTitle: {\n      type: String,\n      // required: true,\n    },\n    iban: {\n      type: String,\n      // required: true,\n      unique: true,\n      // minlength: 26,\n      // maxlength: 26,\n    },\n    address: {\n      type: String,\n      // required: true,\n    },\n    avatarColor: {\n      type: String,\n      default: randomColorGenerator(),\n      // required: true,\n    },\n    logo: {\n      type: String,\n      // required: false,\n    },\n    products: {\n      type: ObjectId,\n      ref: \"Products\",\n    },\n    documents: {\n      type: [DocumentSchema],\n      // required: true,\n    },\n    isVerified: {\n      type: Boolean,\n      default: false,\n    },\n    subMerchantKey: {\n      type: String,\n      unique: true,\n    },\n  },\n  {\n    _id: true,\n    collection: \"seller\",\n    timestamps: true,\n    toJSON: {\n      transform: (doc, ret) => {\n        delete ret.__v;\n        delete ret.password;\n        return {\n          ...ret,\n        };\n      },\n    },\n  }\n);\n\nSellerSchema.pre(\"save\", async function (next) {\n  try {\n    if (!this.gsmNumber.startsWith(\"+90\") && !this.iban.startsWith(\"TR\")) {\n      this.iban = `TR${this.iban}`;\n      this.gsmNumber = `+90${this.gsmNumber}`;\n    }\n    // this.password = await bcrypt.hash(this.password, 10);\n    if (this.isModified(\"password\")) {\n      //password incorrect hatasını böyle çözdük\n      this.password = await bcrypt.hash(this.password, 10);\n    }\n    return next();\n  } catch (err) {\n    return next(err);\n  }\n  next();\n});\nconst Sellers = mongoose.model(\"Sellers\", SellerSchema);\n\nexport default Sellers;\n"],"mappings":"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","ignoreList":[]}},"mtime":1734443678680},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/seller.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst randomColorGenerator = () => {\n  return Math.floor(Math.random() * 16777215).toString(16);\n};\n// const DocumentsEnum = [\n//   \"vergi_levhasi\",\n//   \"isletme_kayit_belgesi\",\n//   \"sicil_gazetesi\",\n//   \"diger\",\n// ];\n\nconst DocumentSchema = new Schema({\n  sicil_gazetesi: {\n    type: String\n    // required: true,\n  },\n  vergi_levhasi: {\n    type: String\n    // required: true,\n  },\n  uploadedAt: {\n    type: Date,\n    default: Date.now\n  }\n}, {\n  _id: false\n});\nconst SellerSchema = new Schema({\n  locale: {\n    type: String,\n    default: \"tr\"\n  },\n  conversationId: {\n    type: String,\n    default: (0, _uuid.default)()\n  },\n  role: {\n    type: String,\n    // required: true,\n    default: \"seller\",\n    enum: [\"user\", \"admin\", \"seller\"]\n  },\n  subMerchantExternalId: {\n    type: String,\n    // required: true,\n    default: (0, _uuid.default)()\n  },\n  subMerchantType: {\n    type: String,\n    enum: [\"PRIVATE_COMPANY\", \"LIMITED_OR_JOINT_STOCK_COMPANY\"]\n    // default: \"PRIVATE_COMPANY\",\n    // required: true,\n  },\n  currency: {\n    type: String,\n    default: \"TRY\",\n    enum: [\"TRY\", \"USD\", \"EUR\", \"GBP\", \"RUB\", \"CHF\", \"NOK\"]\n  },\n  identityNumber: {\n    type: String,\n    // minlength: 11,\n    // maxlength: 11,\n    required: function () {\n      return this.subMerchantType === \"PRIVATE_COMPANY\";\n    },\n    unique: true\n  },\n  taxNumber: {\n    type: String,\n    required: function () {\n      return this.subMerchantType === \"LIMITED_OR_JOINT_STOCK_COMPANY\";\n    },\n    unique: true\n  },\n  name: {\n    type: String\n    // required: true,\n  },\n  gsmNumber: {\n    type: String\n    // minlength: 12,\n    // maxlength: 12,\n    // required: true,\n  },\n  email: {\n    type: String\n    // required: true,\n  },\n  password: {\n    type: String\n    // required: true,\n  },\n  taxOffice: {\n    type: String\n    // required: true,\n  },\n  legalCompanyTitle: {\n    type: String\n    // required: true,\n  },\n  iban: {\n    type: String,\n    // required: true,\n    unique: true\n    // minlength: 26,\n    // maxlength: 26,\n  },\n  address: {\n    type: String\n    // required: true,\n  },\n  avatarColor: {\n    type: String,\n    default: randomColorGenerator()\n    // required: true,\n  },\n  logo: {\n    type: String\n    // required: false,\n  },\n  products: {\n    type: ObjectId,\n    ref: \"Products\"\n  },\n  documents: {\n    type: [DocumentSchema]\n    // required: true,\n  },\n  isVerified: {\n    type: Boolean,\n    default: false\n  },\n  subMerchantKey: {\n    type: String,\n    unique: true\n  }\n}, {\n  _id: true,\n  collection: \"seller\",\n  timestamps: true,\n  toJSON: {\n    transform: (doc, ret) => {\n      delete ret.__v;\n      delete ret.password;\n      return {\n        ...ret\n      };\n    }\n  }\n});\nSellerSchema.pre(\"save\", async function (next) {\n  try {\n    if (!this.gsmNumber.startsWith(\"+90\") && !this.iban.startsWith(\"TR\")) {\n      this.iban = `TR${this.iban}`;\n      this.gsmNumber = `+90${this.gsmNumber}`;\n    }\n    // this.password = await bcrypt.hash(this.password, 10);\n    if (this.isModified(\"password\")) {\n      //password incorrect hatasını böyle çözdük\n      this.password = await _bcryptjs.default.hash(this.password, 10);\n    }\n    return next();\n  } catch (err) {\n    return next(err);\n  }\n  next();\n});\nconst Sellers = _mongoose.default.model(\"Sellers\", SellerSchema);\nvar _default = exports.default = Sellers;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYmNyeXB0anMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9tb25nb29zZSIsIl91dWlkIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiU2NoZW1hIiwibW9uZ29vc2UiLCJPYmplY3RJZCIsIlR5cGVzIiwicmFuZG9tQ29sb3JHZW5lcmF0b3IiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJ0b1N0cmluZyIsIkRvY3VtZW50U2NoZW1hIiwic2ljaWxfZ2F6ZXRlc2kiLCJ0eXBlIiwiU3RyaW5nIiwidmVyZ2lfbGV2aGFzaSIsInVwbG9hZGVkQXQiLCJEYXRlIiwibm93IiwiX2lkIiwiU2VsbGVyU2NoZW1hIiwibG9jYWxlIiwiY29udmVyc2F0aW9uSWQiLCJnZW5lcmF0ZWRJZCIsInJvbGUiLCJlbnVtIiwic3ViTWVyY2hhbnRFeHRlcm5hbElkIiwic3ViTWVyY2hhbnRUeXBlIiwiY3VycmVuY3kiLCJpZGVudGl0eU51bWJlciIsInJlcXVpcmVkIiwidW5pcXVlIiwidGF4TnVtYmVyIiwibmFtZSIsImdzbU51bWJlciIsImVtYWlsIiwicGFzc3dvcmQiLCJ0YXhPZmZpY2UiLCJsZWdhbENvbXBhbnlUaXRsZSIsImliYW4iLCJhZGRyZXNzIiwiYXZhdGFyQ29sb3IiLCJsb2dvIiwicHJvZHVjdHMiLCJyZWYiLCJkb2N1bWVudHMiLCJpc1ZlcmlmaWVkIiwiQm9vbGVhbiIsInN1Yk1lcmNoYW50S2V5IiwiY29sbGVjdGlvbiIsInRpbWVzdGFtcHMiLCJ0b0pTT04iLCJ0cmFuc2Zvcm0iLCJkb2MiLCJyZXQiLCJfX3YiLCJwcmUiLCJuZXh0Iiwic3RhcnRzV2l0aCIsImlzTW9kaWZpZWQiLCJiY3J5cHQiLCJoYXNoIiwiZXJyIiwiU2VsbGVycyIsIm1vZGVsIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvZGIvIiwic291cmNlcyI6WyJzZWxsZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGJjcnlwdCBmcm9tIFwiYmNyeXB0anNcIjtcbmltcG9ydCBtb25nb29zZSBmcm9tIFwibW9uZ29vc2VcIjtcbmltcG9ydCBnZW5lcmF0ZWRJZCBmcm9tIFwiLi4vdXRpbHMvdXVpZFwiO1xuXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWE7XG5jb25zdCB7IE9iamVjdElkIH0gPSBTY2hlbWEuVHlwZXM7XG5jb25zdCByYW5kb21Db2xvckdlbmVyYXRvciA9ICgpID0+IHtcbiAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDE2Nzc3MjE1KS50b1N0cmluZygxNik7XG59O1xuLy8gY29uc3QgRG9jdW1lbnRzRW51bSA9IFtcbi8vICAgXCJ2ZXJnaV9sZXZoYXNpXCIsXG4vLyAgIFwiaXNsZXRtZV9rYXlpdF9iZWxnZXNpXCIsXG4vLyAgIFwic2ljaWxfZ2F6ZXRlc2lcIixcbi8vICAgXCJkaWdlclwiLFxuLy8gXTtcblxuY29uc3QgRG9jdW1lbnRTY2hlbWEgPSBuZXcgU2NoZW1hKFxuICB7XG4gICAgc2ljaWxfZ2F6ZXRlc2k6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIC8vIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgdmVyZ2lfbGV2aGFzaToge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgLy8gcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICB1cGxvYWRlZEF0OiB7XG4gICAgICB0eXBlOiBEYXRlLFxuICAgICAgZGVmYXVsdDogRGF0ZS5ub3csXG4gICAgfSxcbiAgfSxcbiAgeyBfaWQ6IGZhbHNlIH1cbik7XG5jb25zdCBTZWxsZXJTY2hlbWEgPSBuZXcgU2NoZW1hKFxuICB7XG4gICAgbG9jYWxlOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICBkZWZhdWx0OiBcInRyXCIsXG4gICAgfSxcbiAgICBjb252ZXJzYXRpb25JZDoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgZGVmYXVsdDogZ2VuZXJhdGVkSWQoKSxcbiAgICB9LFxuICAgIHJvbGU6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIC8vIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgZGVmYXVsdDogXCJzZWxsZXJcIixcbiAgICAgIGVudW06IFtcInVzZXJcIiwgXCJhZG1pblwiLCBcInNlbGxlclwiXSxcbiAgICB9LFxuICAgIHN1Yk1lcmNoYW50RXh0ZXJuYWxJZDoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgLy8gcmVxdWlyZWQ6IHRydWUsXG4gICAgICBkZWZhdWx0OiBnZW5lcmF0ZWRJZCgpLFxuICAgIH0sXG4gICAgc3ViTWVyY2hhbnRUeXBlOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICBlbnVtOiBbXCJQUklWQVRFX0NPTVBBTllcIiwgXCJMSU1JVEVEX09SX0pPSU5UX1NUT0NLX0NPTVBBTllcIl0sXG4gICAgICAvLyBkZWZhdWx0OiBcIlBSSVZBVEVfQ09NUEFOWVwiLFxuICAgICAgLy8gcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBjdXJyZW5jeToge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgZGVmYXVsdDogXCJUUllcIixcbiAgICAgIGVudW06IFtcIlRSWVwiLCBcIlVTRFwiLCBcIkVVUlwiLCBcIkdCUFwiLCBcIlJVQlwiLCBcIkNIRlwiLCBcIk5PS1wiXSxcbiAgICB9LFxuICAgIGlkZW50aXR5TnVtYmVyOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAvLyBtaW5sZW5ndGg6IDExLFxuICAgICAgLy8gbWF4bGVuZ3RoOiAxMSxcbiAgICAgIHJlcXVpcmVkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN1Yk1lcmNoYW50VHlwZSA9PT0gXCJQUklWQVRFX0NPTVBBTllcIjtcbiAgICAgIH0sXG4gICAgICB1bmlxdWU6IHRydWUsXG4gICAgfSxcbiAgICB0YXhOdW1iZXI6IHtcbiAgICAgIHR5cGU6IFN0cmluZyxcbiAgICAgIHJlcXVpcmVkOiBmdW5jdGlvbiAoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnN1Yk1lcmNoYW50VHlwZSA9PT0gXCJMSU1JVEVEX09SX0pPSU5UX1NUT0NLX0NPTVBBTllcIjtcbiAgICAgIH0sXG4gICAgICB1bmlxdWU6IHRydWUsXG4gICAgfSxcbiAgICBuYW1lOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAvLyByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGdzbU51bWJlcjoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgLy8gbWlubGVuZ3RoOiAxMixcbiAgICAgIC8vIG1heGxlbmd0aDogMTIsXG4gICAgICAvLyByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGVtYWlsOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAvLyByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIHBhc3N3b3JkOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAvLyByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIHRheE9mZmljZToge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgLy8gcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBsZWdhbENvbXBhbnlUaXRsZToge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgLy8gcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBpYmFuOiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICAvLyByZXF1aXJlZDogdHJ1ZSxcbiAgICAgIHVuaXF1ZTogdHJ1ZSxcbiAgICAgIC8vIG1pbmxlbmd0aDogMjYsXG4gICAgICAvLyBtYXhsZW5ndGg6IDI2LFxuICAgIH0sXG4gICAgYWRkcmVzczoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgLy8gcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBhdmF0YXJDb2xvcjoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgZGVmYXVsdDogcmFuZG9tQ29sb3JHZW5lcmF0b3IoKSxcbiAgICAgIC8vIHJlcXVpcmVkOiB0cnVlLFxuICAgIH0sXG4gICAgbG9nbzoge1xuICAgICAgdHlwZTogU3RyaW5nLFxuICAgICAgLy8gcmVxdWlyZWQ6IGZhbHNlLFxuICAgIH0sXG4gICAgcHJvZHVjdHM6IHtcbiAgICAgIHR5cGU6IE9iamVjdElkLFxuICAgICAgcmVmOiBcIlByb2R1Y3RzXCIsXG4gICAgfSxcbiAgICBkb2N1bWVudHM6IHtcbiAgICAgIHR5cGU6IFtEb2N1bWVudFNjaGVtYV0sXG4gICAgICAvLyByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGlzVmVyaWZpZWQ6IHtcbiAgICAgIHR5cGU6IEJvb2xlYW4sXG4gICAgICBkZWZhdWx0OiBmYWxzZSxcbiAgICB9LFxuICAgIHN1Yk1lcmNoYW50S2V5OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICB1bmlxdWU6IHRydWUsXG4gICAgfSxcbiAgfSxcbiAge1xuICAgIF9pZDogdHJ1ZSxcbiAgICBjb2xsZWN0aW9uOiBcInNlbGxlclwiLFxuICAgIHRpbWVzdGFtcHM6IHRydWUsXG4gICAgdG9KU09OOiB7XG4gICAgICB0cmFuc2Zvcm06IChkb2MsIHJldCkgPT4ge1xuICAgICAgICBkZWxldGUgcmV0Ll9fdjtcbiAgICAgICAgZGVsZXRlIHJldC5wYXNzd29yZDtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAuLi5yZXQsXG4gICAgICAgIH07XG4gICAgICB9LFxuICAgIH0sXG4gIH1cbik7XG5cblNlbGxlclNjaGVtYS5wcmUoXCJzYXZlXCIsIGFzeW5jIGZ1bmN0aW9uIChuZXh0KSB7XG4gIHRyeSB7XG4gICAgaWYgKCF0aGlzLmdzbU51bWJlci5zdGFydHNXaXRoKFwiKzkwXCIpICYmICF0aGlzLmliYW4uc3RhcnRzV2l0aChcIlRSXCIpKSB7XG4gICAgICB0aGlzLmliYW4gPSBgVFIke3RoaXMuaWJhbn1gO1xuICAgICAgdGhpcy5nc21OdW1iZXIgPSBgKzkwJHt0aGlzLmdzbU51bWJlcn1gO1xuICAgIH1cbiAgICAvLyB0aGlzLnBhc3N3b3JkID0gYXdhaXQgYmNyeXB0Lmhhc2godGhpcy5wYXNzd29yZCwgMTApO1xuICAgIGlmICh0aGlzLmlzTW9kaWZpZWQoXCJwYXNzd29yZFwiKSkge1xuICAgICAgLy9wYXNzd29yZCBpbmNvcnJlY3QgaGF0YXPEsW7EsSBiw7Z5bGUgw6fDtnpkw7xrXG4gICAgICB0aGlzLnBhc3N3b3JkID0gYXdhaXQgYmNyeXB0Lmhhc2godGhpcy5wYXNzd29yZCwgMTApO1xuICAgIH1cbiAgICByZXR1cm4gbmV4dCgpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICByZXR1cm4gbmV4dChlcnIpO1xuICB9XG4gIG5leHQoKTtcbn0pO1xuY29uc3QgU2VsbGVycyA9IG1vbmdvb3NlLm1vZGVsKFwiU2VsbGVyc1wiLCBTZWxsZXJTY2hlbWEpO1xuXG5leHBvcnQgZGVmYXVsdCBTZWxsZXJzO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxTQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxTQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxLQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFBd0MsU0FBQUQsdUJBQUFJLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFeEMsTUFBTUcsTUFBTSxHQUFHQyxpQkFBUSxDQUFDRCxNQUFNO0FBQzlCLE1BQU07RUFBRUU7QUFBUyxDQUFDLEdBQUdGLE1BQU0sQ0FBQ0csS0FBSztBQUNqQyxNQUFNQyxvQkFBb0IsR0FBR0EsQ0FBQSxLQUFNO0VBQ2pDLE9BQU9DLElBQUksQ0FBQ0MsS0FBSyxDQUFDRCxJQUFJLENBQUNFLE1BQU0sQ0FBQyxDQUFDLEdBQUcsUUFBUSxDQUFDLENBQUNDLFFBQVEsQ0FBQyxFQUFFLENBQUM7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","map":{"version":3,"names":["_bcryptjs","_interopRequireDefault","require","_mongoose","_uuid","e","__esModule","default","Schema","mongoose","ObjectId","Types","randomColorGenerator","Math","floor","random","toString","DocumentSchema","sicil_gazetesi","type","String","vergi_levhasi","uploadedAt","Date","now","_id","SellerSchema","locale","conversationId","generatedId","role","enum","subMerchantExternalId","subMerchantType","currency","identityNumber","required","unique","taxNumber","name","gsmNumber","email","password","taxOffice","legalCompanyTitle","iban","address","avatarColor","logo","products","ref","documents","isVerified","Boolean","subMerchantKey","collection","timestamps","toJSON","transform","doc","ret","__v","pre","next","startsWith","isModified","bcrypt","hash","err","Sellers","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["seller.js"],"sourcesContent":["import bcrypt from \"bcryptjs\";\nimport mongoose from \"mongoose\";\nimport generatedId from \"../utils/uuid\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\nconst randomColorGenerator = () => {\n  return Math.floor(Math.random() * 16777215).toString(16);\n};\n// const DocumentsEnum = [\n//   \"vergi_levhasi\",\n//   \"isletme_kayit_belgesi\",\n//   \"sicil_gazetesi\",\n//   \"diger\",\n// ];\n\nconst DocumentSchema = new Schema(\n  {\n    sicil_gazetesi: {\n      type: String,\n      // required: true,\n    },\n    vergi_levhasi: {\n      type: String,\n      // required: true,\n    },\n    uploadedAt: {\n      type: Date,\n      default: Date.now,\n    },\n  },\n  { _id: false }\n);\nconst SellerSchema = new Schema(\n  {\n    locale: {\n      type: String,\n      default: \"tr\",\n    },\n    conversationId: {\n      type: String,\n      default: generatedId(),\n    },\n    role: {\n      type: String,\n      // required: true,\n      default: \"seller\",\n      enum: [\"user\", \"admin\", \"seller\"],\n    },\n    subMerchantExternalId: {\n      type: String,\n      // required: true,\n      default: generatedId(),\n    },\n    subMerchantType: {\n      type: String,\n      enum: [\"PRIVATE_COMPANY\", \"LIMITED_OR_JOINT_STOCK_COMPANY\"],\n      // default: \"PRIVATE_COMPANY\",\n      // required: true,\n    },\n    currency: {\n      type: String,\n      default: \"TRY\",\n      enum: [\"TRY\", \"USD\", \"EUR\", \"GBP\", \"RUB\", \"CHF\", \"NOK\"],\n    },\n    identityNumber: {\n      type: String,\n      // minlength: 11,\n      // maxlength: 11,\n      required: function () {\n        return this.subMerchantType === \"PRIVATE_COMPANY\";\n      },\n      unique: true,\n    },\n    taxNumber: {\n      type: String,\n      required: function () {\n        return this.subMerchantType === \"LIMITED_OR_JOINT_STOCK_COMPANY\";\n      },\n      unique: true,\n    },\n    name: {\n      type: String,\n      // required: true,\n    },\n    gsmNumber: {\n      type: String,\n      // minlength: 12,\n      // maxlength: 12,\n      // required: true,\n    },\n    email: {\n      type: String,\n      // required: true,\n    },\n    password: {\n      type: String,\n      // required: true,\n    },\n    taxOffice: {\n      type: String,\n      // required: true,\n    },\n    legalCompanyTitle: {\n      type: String,\n      // required: true,\n    },\n    iban: {\n      type: String,\n      // required: true,\n      unique: true,\n      // minlength: 26,\n      // maxlength: 26,\n    },\n    address: {\n      type: String,\n      // required: true,\n    },\n    avatarColor: {\n      type: String,\n      default: randomColorGenerator(),\n      // required: true,\n    },\n    logo: {\n      type: String,\n      // required: false,\n    },\n    products: {\n      type: ObjectId,\n      ref: \"Products\",\n    },\n    documents: {\n      type: [DocumentSchema],\n      // required: true,\n    },\n    isVerified: {\n      type: Boolean,\n      default: false,\n    },\n    subMerchantKey: {\n      type: String,\n      unique: true,\n    },\n  },\n  {\n    _id: true,\n    collection: \"seller\",\n    timestamps: true,\n    toJSON: {\n      transform: (doc, ret) => {\n        delete ret.__v;\n        delete ret.password;\n        return {\n          ...ret,\n        };\n      },\n    },\n  }\n);\n\nSellerSchema.pre(\"save\", async function (next) {\n  try {\n    if (!this.gsmNumber.startsWith(\"+90\") && !this.iban.startsWith(\"TR\")) {\n      this.iban = `TR${this.iban}`;\n      this.gsmNumber = `+90${this.gsmNumber}`;\n    }\n    // this.password = await bcrypt.hash(this.password, 10);\n    if (this.isModified(\"password\")) {\n      //password incorrect hatasını böyle çözdük\n      this.password = await bcrypt.hash(this.password, 10);\n    }\n    return next();\n  } catch (err) {\n    return next(err);\n  }\n  next();\n});\nconst Sellers = mongoose.model(\"Sellers\", SellerSchema);\n\nexport default Sellers;\n"],"mappings":"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","ignoreList":[]}},"mtime":1734443678680},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/Sellers.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _cart = _interopRequireDefault(require(\"../db/cart\"));\nvar _products = _interopRequireDefault(require(\"../db/products\"));\nvar _seller = _interopRequireDefault(require(\"../db/seller\"));\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\nvar _multer = _interopRequireDefault(require(\"multer\"));\nvar _path = _interopRequireDefault(require(\"path\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _CheckExistence = require(\"../helpers/CheckExistence\");\nvar _RequiredCheck = require(\"../helpers/RequiredCheck\");\nvar _ForgotPasswordMail = require(\"../middlewares/ForgotPasswordMail\");\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nvar _getUserIP = _interopRequireDefault(require(\"../middlewares/getUserIP\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\n// import Users from \"../db/users\";\n\nconst upload = (0, _multer.default)({\n  storage: _multer.default.diskStorage({\n    destination: (req, file, cb) => {\n      cb(null, \"public/uploads\");\n    },\n    filename: (req, file, cb) => {\n      const originalName = file.originalname;\n      cb(null, originalName);\n    }\n  }),\n  fileFilter: (req, file, cb) => {\n    const fileTypes = /jpeg|jpg|png|pdf/;\n    const extname = fileTypes.test(_path.default.extname(file.originalname).toLowerCase());\n    const mimetype = fileTypes.test(file.mimetype);\n    if (mimetype && extname) {\n      return cb(null, true);\n    } else {\n      cb(new _ApiError.default(\"Invalid file type. Only JPEG, JPG, and PNG are allowed.\", 400, \"InvalidFileType\"));\n    }\n  }\n});\nconst uploadFields = [{\n  name: \"logo\",\n  maxCount: 1\n},\n// SellerLogo için 1 dosya\n{\n  name: \"vergi_levhasi\",\n  maxCount: 1\n}, {\n  name: \"sicil_gazetesi\",\n  maxCount: 1\n}];\nvar _default = router => {\n  router.post(\"/seller/register/private-company\", _getUserIP.default, upload.fields(uploadFields), async (req, res, next) => {\n    const {\n      email,\n      name,\n      logo,\n      gsmNumber,\n      password,\n      address,\n      identityNumber,\n      iban,\n      taxOffice,\n      legalCompanyTitle\n    } = req.body;\n    try {\n      (0, _RequiredCheck.checkLotsOfRequiredField)([{\n        field: email,\n        fieldName: \"E-Mail\"\n      }, {\n        field: name,\n        fieldName: \"Name\"\n      }, {\n        field: gsmNumber,\n        fieldName: \"Phone Number\"\n      }, {\n        field: address,\n        fieldName: \"Address\"\n      }, {\n        field: identityNumber,\n        fieldName: \"Identity Number\"\n      }, {\n        field: iban,\n        fieldName: \"IBAN\"\n      }, {\n        field: taxOffice,\n        fieldName: \"Tax Office\"\n      }, {\n        field: legalCompanyTitle,\n        fieldName: \"Legal Company Title\"\n      }]);\n      if (!req.files[\"vergi_levhasi\"] || !req.files[\"sicil_gazetesi\"]) {\n        return res.status(400).json({\n          error: \"Vergi levhası ve Sicil gazetesi zorunludur.\"\n        });\n      }\n    } catch (error) {\n      return res.status(400).send(error);\n    }\n    const existingSeller = await _seller.default.findOne({\n      email\n    });\n    if (existingSeller) {\n      return res.status(400).send(new _ApiError.default(400, \"Bu e-posta zaten kullanılıyor\"));\n    }\n    const documents = [{\n      vergi_levhasi: req.files[\"vergi_levhasi\"][0].path,\n      sicil_gazetesi: req.files[\"sicil_gazetesi\"][0].path,\n      uploadedAt: new Date()\n    }];\n    const seller = new _seller.default({\n      email,\n      name,\n      gsmNumber,\n      password,\n      logo: req.files[\"logo\"] ? req.files[\"logo\"][0].path : undefined,\n      documents,\n      address,\n      identityNumber,\n      subMerchantType: \"PRIVATE_COMPANY\",\n      iban,\n      taxOffice,\n      legalCompanyTitle\n    });\n    try {\n      await seller.save();\n      req.user = seller;\n      next();\n      res.status(200).json(\"Seller Oluşturuldu, onay bekleniyor.\");\n    } catch (error) {\n      console.log(error);\n      return res.status(500).send(new _ApiError.default(500, \"Kayıt işlemi sırasında hata oluştu\"));\n    }\n  });\n  router.post(\"/seller/register/limited-or-joint\", _getUserIP.default, upload.fields(uploadFields), async (req, res, next) => {\n    const {\n      email,\n      name,\n      logo,\n      gsmNumber,\n      password,\n      address,\n      taxNumber,\n      iban,\n      taxOffice,\n      legalCompanyTitle\n    } = req.body;\n    try {\n      (0, _RequiredCheck.checkLotsOfRequiredField)([{\n        field: email,\n        fieldName: \"E-Mail\"\n      }, {\n        field: name,\n        fieldName: \"Name\"\n      }, {\n        field: gsmNumber,\n        fieldName: \"Phone Number\"\n      }, {\n        field: address,\n        fieldName: \"Address\"\n      }, {\n        field: taxNumber,\n        fieldName: \"Tax Number\"\n      }, {\n        field: iban,\n        fieldName: \"IBAN\"\n      }, {\n        field: taxOffice,\n        fieldName: \"Tax Office\"\n      }, {\n        field: legalCompanyTitle,\n        fieldName: \"Legal Company Title\"\n      }]);\n      if (!req.files[\"vergi_levhasi\"] || !req.files[\"sicil_gazetesi\"]) {\n        return res.status(400).json({\n          error: \"Vergi levhası ve Sicil gazetesi zorunludur.\"\n        });\n      }\n    } catch (error) {\n      return res.status(400).send(error);\n    }\n    const existingSeller = await _seller.default.findOne({\n      email\n    });\n    if (existingSeller) {\n      return res.status(400).send(new _ApiError.default(400, \"Bu e-posta zaten kullanılıyor\"));\n    }\n    const documents = [{\n      vergi_levhasi: req.files[\"vergi_levhasi\"][0].path,\n      sicil_gazetesi: req.files[\"sicil_gazetesi\"][0].path,\n      uploadedAt: new Date()\n    }];\n    const seller = new _seller.default({\n      email,\n      name,\n      gsmNumber,\n      password,\n      logo: req.files[\"logo\"] ? req.files[\"logo\"][0].path : undefined,\n      documents,\n      address,\n      taxNumber,\n      subMerchantType: \"LIMITED_OR_JOINT_STOCK_COMPANY\",\n      iban,\n      taxOffice,\n      legalCompanyTitle\n    });\n    try {\n      await seller.save();\n      req.user = seller;\n      next();\n      res.status(200).json(\"Seller Oluşturuldu, onay bekleniyor.\");\n    } catch (error) {\n      console.log(error);\n      return res.status(500).send(new _ApiError.default(500, \"Kayıt işlemi sırasında hata oluştu\"));\n    }\n  });\n  router.post(\"/seller/login\", async (req, res) => {\n    const {\n      email,\n      password\n    } = req.body;\n    const seller = await _seller.default.findOne({\n      email\n    });\n    try {\n      (0, _RequiredCheck.checkLotsOfRequiredField)([{\n        field: email,\n        fieldName: \"E-Mail\"\n      }, {\n        field: password,\n        fieldName: \"Password\"\n      }]);\n    } catch (error) {\n      return res.status(400).json(error);\n    }\n    if (!seller) {\n      throw new _ApiError.default(\"Incorrect Password or email2\", 401, \"userOrPasswordIncorrect\");\n    }\n    if (seller.isVerified == false) {\n      throw new _ApiError.default(\"You have to verificate your account.\", 401, \"accountNotVerified\");\n    }\n    const passwordConfirmed = await _bcryptjs.default.compare(password, seller.password);\n    // console.log(\"kullanıcı girdisi:\", password); silinecekler\n    // console.log(\"hashlenmiş hali:\", user.password);\n\n    if (passwordConfirmed) {\n      const sellerJson = seller.toJSON();\n      const token = _jsonwebtoken.default.sign(sellerJson, process.env.JWT_SECRET);\n      res.json({\n        token: `Bearer ${token}`,\n        seller: sellerJson\n      });\n    } else {\n      throw new _ApiError.default(\"Incorrect Password or email\", 401, \"userOrPasswordIncorrect\");\n    }\n  });\n  router.get(\"/seller/products\", _Session.default, async (req, res, next) => {\n    try {\n      const sellerId = req.user._id;\n      const products = await _products.default.find({\n        seller: sellerId\n      });\n      if (!products || products.length === 0) {\n        return res.status(400).json({\n          message: \"There is no such products in this user\"\n        });\n      }\n      res.status(200).json(products);\n    } catch (error) {\n      console.log(error);\n      next(error);\n      throw new _ApiError.default(\"There is error\", 404, \"anError\");\n    }\n  });\n  router.put(\"/seller/update\", _Session.default, upload.single(\"SellerLogo\"), async (req, res) => {\n    const {\n      phoneNumber,\n      address,\n      city\n    } = req.body;\n    const seller = req.user;\n    const logoPath = req.file ? `/uploads/${req.file.filename}` : null;\n    try {\n      if (phoneNumber) {\n        const existingSeller = await _seller.default.findOne({\n          phoneNumber\n        });\n        if (existingSeller && existingSeller._id.toString() !== seller._id.toString()) {\n          throw new _ApiError.default(\"This phone number already using\", 400, \"phoneNumberAlreadyUsing\");\n        }\n      }\n      // Güncellenecek alanları dinamik olarak oluştur\n      const updateFields = {\n        ...(phoneNumber && {\n          phoneNumber\n        }),\n        ...(address && {\n          address\n        }),\n        ...(city && {\n          city\n        }),\n        ...(logoPath && {\n          SellerLogo: logoPath\n        }) // Eğer logo yüklendiyse ekle\n      };\n\n      // Satıcıyı güncelle\n      const updateSeller = await _seller.default.findByIdAndUpdate(seller._id, updateFields, {\n        new: true\n      });\n\n      // const updateSeller = await Seller.findByIdAndUpdate(\n      //   seller,\n      //   { phoneNumber, address, city },\n      //   { new: true }\n      // );\n\n      if (!updateSeller) {\n        throw new _ApiError.default(\"Seller not found\", 400, \"notFoundSeller\");\n      }\n      return res.status(200).json({\n        message: \"seller information has been changed\",\n        seller\n      });\n    } catch (error) {\n      console.log(error);\n      throw new _ApiError.default(\"Seller informations cannot change\", 500, \"cannotChangeSellerInformation\");\n    }\n  });\n  router.get(\"/seller-orders/pending\", _Session.default, async (req, res) => {\n    try {\n      const sellerId = req.user._id; // Satıcı ID'si\n\n      // 1. Satıcının ürünleri olan sepetleri ve ürünleri çekiyoruz\n      const carts = await _cart.default.find({\n        \"products.seller\": sellerId,\n        // Satıcının ürünü olanlar\n        \"products.status\": \"pending\",\n        // Beklemede olanlar\n        completed: true\n      }).populate(\"buyer\", \"name surname email address phoneNumber zipCode city country\").populate(\"products.productId\"); // Alıcı bilgilerini getiriyoruz\n\n      // 2. Sadece satıcının ürünlerini filtreliyoruz\n      const sellerOrders = carts.map(cart => {\n        const sellerItems = cart.products.filter(product => {\n          return product.seller.toString() === sellerId.toString() && product.status === \"pending\";\n        });\n        return {\n          cartId: cart._id,\n          buyer: cart.buyer,\n          items: sellerItems.map(item => {\n            if (!item.productId) {\n              // Eğer productId null ise, ürünü atlıyoruz\n              return null;\n            }\n            return {\n              productId: item.productId._id,\n              productName: item.productId.name,\n              productPrice: item.productId.price,\n              productImages: item.productId.images,\n              quantity: item.quantity,\n              status: item.status\n            };\n          }).filter(item => item !== null) // Null olan ürünleri filtreliyoruz\n        };\n      });\n\n      // Eğer satıcıya ait ürünler varsa döndürüyoruz\n      res.status(200).json(sellerOrders.filter(order => order.items.length > 0));\n    } catch (error) {\n      console.error(\"Error while getting seller orders:\", error);\n      res.status(500).json({\n        message: \"Can not get seller orders\",\n        errorCode: \"canNotGetSellerOrders\"\n      });\n    }\n  });\n  router.get(\"/seller-orders/processing\", _Session.default, async (req, res) => {\n    try {\n      const sellerId = req.user._id; // Satıcı ID'si\n\n      // 1. Satıcının ürünleri olan sepetleri ve ürünleri çekiyoruz\n      const carts = await _cart.default.find({\n        \"products.seller\": sellerId,\n        // Satıcının ürünü olanlar\n        \"products.status\": \"processing\",\n        // Beklemede olanlar\n        completed: true\n      }).populate(\"buyer\", \"name surname email address phoneNumber zipCode city country\").populate(\"products.productId\"); // Alıcı bilgilerini getiriyoruz\n\n      // 2. Sadece satıcının ürünlerini filtreliyoruz\n      const sellerOrders = carts.map(cart => {\n        const sellerItems = cart.products.filter(product => {\n          return product.seller.toString() === sellerId.toString() && product.status === \"processing\";\n        });\n        return {\n          cartId: cart._id,\n          buyer: cart.buyer,\n          items: sellerItems.map(item => {\n            if (!item.productId) {\n              // Eğer productId null ise, ürünü atlıyoruz\n              return null;\n            }\n            return {\n              productId: item.productId._id,\n              productName: item.productId.name,\n              productPrice: item.productId.price,\n              productImages: item.productId.images,\n              quantity: item.quantity,\n              status: item.status\n            };\n          }).filter(item => item !== null) // Null olan ürünleri filtreliyoruz\n        };\n      });\n\n      // Eğer satıcıya ait ürünler varsa döndürüyoruz\n      res.status(200).json(sellerOrders.filter(order => order.items.length > 0));\n    } catch (error) {\n      console.error(\"Error while getting seller orders:\", error);\n      res.status(500).json({\n        message: \"Can not get seller orders\",\n        errorCode: \"canNotGetSellerOrders\"\n      });\n    }\n  });\n  router.get(\"/seller-orders/completed\", _Session.default, async (req, res) => {\n    try {\n      const sellerId = req.user._id; // Satıcı ID'si\n\n      // 1. Satıcının ürünleri olan sepetleri ve ürünleri çekiyoruz\n      const carts = await _cart.default.find({\n        \"products.seller\": sellerId,\n        // Satıcının ürünü olanlar\n        \"products.status\": \"completed\",\n        // Beklemede olanlar\n        completed: true\n      }).populate(\"buyer\", \"name surname email address phoneNumber zipCode city country\").populate(\"products.productId\"); // Alıcı bilgilerini getiriyoruz\n\n      // 2. Sadece satıcının ürünlerini filtreliyoruz\n      const sellerOrders = carts.map(cart => {\n        const sellerItems = cart.products.filter(product => {\n          return product.seller.toString() === sellerId.toString() && product.status === \"completed\";\n        });\n        return {\n          cartId: cart._id,\n          buyer: cart.buyer,\n          items: sellerItems.map(item => {\n            if (!item.productId) {\n              // Eğer productId null ise, ürünü atlıyoruz\n              return null;\n            }\n            return {\n              productId: item.productId._id,\n              productName: item.productId.name,\n              productPrice: item.productId.price,\n              productImages: item.productId.images,\n              quantity: item.quantity,\n              status: item.status\n            };\n          }).filter(item => item !== null) // Null olan ürünleri filtreliyoruz\n        };\n      });\n\n      // Eğer satıcıya ait ürünler varsa döndürüyoruz\n      res.status(200).json(sellerOrders.filter(order => order.items.length > 0));\n    } catch (error) {\n      console.error(\"Error while getting seller orders:\", error);\n      res.status(500).json({\n        message: \"Can not get seller orders\",\n        errorCode: \"canNotGetSellerOrders\"\n      });\n    }\n  });\n  router.post(\"/seller-orders/:cartId/product/:productId/mark-processed\", _Session.default, async (req, res) => {\n    try {\n      const sellerId = req.user._id; // Satıcı ID'sini oturumdan alıyoruz\n      const {\n        cartId,\n        productId\n      } = req.params; // Ürün ID'si\n\n      // 1. Satıcının ürünlerini içeren sepette ilgili ürünü buluyoruz ve güncelliyoruz\n      const cart = await _cart.default.findOneAndUpdate({\n        _id: cartId,\n        \"products.productId\": productId,\n        // Sepette ürün ID'sine göre filtreleme\n        \"products.seller\": sellerId,\n        // Sadece satıcının ürünü olmalı\n        \"products.status\": \"pending\" // Beklemede olan ürünleri bul\n      }, {\n        $set: {\n          \"products.$[element].status\": \"processing\"\n        } // İlgili ürünün durumunu güncelle\n      }, {\n        arrayFilters: [{\n          \"element.productId\": productId,\n          \"element.seller\": sellerId\n        }],\n        // Sadece bu ürünü güncelle\n        new: true\n      });\n      if (!cart) {\n        return res.status(404).json({\n          message: \"No pending orders found for this seller's product.\"\n        });\n      }\n      res.status(200).json({\n        message: \"Product in the order has been marked as processed.\"\n      });\n    } catch (error) {\n      console.error(\"Error while marking product as processed:\", error);\n      res.status(500).json({\n        message: \"Error while processing the product in the order\"\n      });\n    }\n  });\n  router.post(\"/seller-orders/:cartId/product/:productId/mark-completed\", _Session.default, async (req, res) => {\n    try {\n      const sellerId = req.user._id; // Satıcı ID'si\n      const {\n        cartId,\n        productId\n      } = req.params;\n\n      // 1. Satıcının ürünlerini içeren sepeti buluyoruz ve durumu güncelliyoruz\n      const cart = await _cart.default.findOneAndUpdate({\n        _id: cartId,\n        \"products.productId\": productId,\n        \"products.seller\": sellerId,\n        \"products.status\": \"processing\" // İşlenmekte olanları tamamla\n      }, {\n        $set: {\n          \"products.$[element].status\": \"completed\"\n        }\n      }, {\n        arrayFilters: [{\n          \"element.productId\": productId,\n          \"element.seller\": sellerId\n        }],\n        new: true\n      });\n      if (!cart) {\n        return res.status(404).json({\n          message: \"No processing orders found for this seller's product.\"\n        });\n      }\n      res.status(200).json({\n        message: \"Product in the order has been marked as completed.\"\n      });\n    } catch (error) {\n      console.error(\"Error while marking product as completed:\", error);\n      res.status(500).json({\n        message: \"Error while completing the product in the order\"\n      });\n    }\n  });\n  router.put(\"/seller/change-password\", _Session.default, async (req, res) => {\n    const {\n      oldPassword,\n      newPassword,\n      confirmPassword\n    } = req.body;\n    const seller = req.user;\n    try {\n      const existingSeller = await _seller.default.findById(seller._id);\n      if (!existingSeller) {\n        throw new _ApiError.default(\"User Not Found\", 404, \"notFoundUser\");\n      }\n      const isMatchPassword = await _bcryptjs.default.compare(oldPassword, existingSeller.password);\n      if (!isMatchPassword) {\n        throw new _ApiError.default(\"Incorrect old password\", 404, \"incorrectOldPassword\");\n      }\n      if (newPassword !== confirmPassword) {\n        throw new _ApiError.default(\"New password and confirm password do not match\", 404, \"passwordsDoNotMatch\");\n      }\n      const isSamePassword = await _bcryptjs.default.compare(newPassword, existingSeller.password);\n      if (isSamePassword) {\n        throw new _ApiError.default(\"New Password cannot be the same as the old password\", 400, \"sameAsOldPassword\");\n      }\n      existingSeller.password = newPassword;\n      await existingSeller.save();\n      console.log(\"Old Password (unhashed):\", oldPassword);\n      console.log(\"New Password (unhashed):\", newPassword);\n      return res.status(200).json({\n        message: \"Password has been changed successfully\",\n        seller\n      });\n    } catch (error) {\n      console.log(error);\n      res.status(error.statusCode || 500).json({\n        message: error.message || \"Password change failed\",\n        code: error.code || \"passwordChangeFailed\"\n      });\n    }\n  });\n  router.post(\"/seller/forgot-password\", _ForgotPasswordMail.forgotSellerPasswordEmail, async (req, res) => {\n    const {\n      email\n    } = req.body;\n    const userEmail = await _seller.default.findOne({\n      email\n    });\n    (0, _CheckExistence.noExistVariable)(userEmail, \"Email\");\n    res.status(200).send(\"Link has been send\");\n  });\n  router.get(\"/seller/:id\", _Session.default, async (req, res) => {\n    const {\n      id\n    } = req.params;\n    try {\n      const sellerId = await _seller.default.findById(id);\n      (0, _CheckExistence.noExistVariable)(sellerId, \"Seller\");\n      res.status(200).json(sellerId);\n    } catch (error) {\n      console.log(error);\n      res.status(400).json(\"Error\");\n    }\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfY2FydCIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX3Byb2R1Y3RzIiwiX3NlbGxlciIsIl9iY3J5cHRqcyIsIl9qc29ud2VidG9rZW4iLCJfbXVsdGVyIiwiX3BhdGgiLCJfQXBpRXJyb3IiLCJfQ2hlY2tFeGlzdGVuY2UiLCJfUmVxdWlyZWRDaGVjayIsIl9Gb3Jnb3RQYXNzd29yZE1haWwiLCJfU2Vzc2lvbiIsIl9nZXRVc2VySVAiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJ1cGxvYWQiLCJtdWx0ZXIiLCJzdG9yYWdlIiwiZGlza1N0b3JhZ2UiLCJkZXN0aW5hdGlvbiIsInJlcSIsImZpbGUiLCJjYiIsImZpbGVuYW1lIiwib3JpZ2luYWxOYW1lIiwib3JpZ2luYWxuYW1lIiwiZmlsZUZpbHRlciIsImZpbGVUeXBlcyIsImV4dG5hbWUiLCJ0ZXN0IiwicGF0aCIsInRvTG93ZXJDYXNlIiwibWltZXR5cGUiLCJBcGlFcnJvciIsInVwbG9hZEZpZWxkcyIsIm5hbWUiLCJtYXhDb3VudCIsIl9kZWZhdWx0Iiwicm91dGVyIiwicG9zdCIsImdldFVzZXJJcCIsImZpZWxkcyIsInJlcyIsIm5leHQiLCJlbWFpbCIsImxvZ28iLCJnc21OdW1iZXIiLCJwYXNzd29yZCIsImFkZHJlc3MiLCJpZGVudGl0eU51bWJlciIsImliYW4iLCJ0YXhPZmZpY2UiLCJsZWdhbENvbXBhbnlUaXRsZSIsImJvZHkiLCJjaGVja0xvdHNPZlJlcXVpcmVkRmllbGQiLCJmaWVsZCIsImZpZWxkTmFtZSIsImZpbGVzIiwic3RhdHVzIiwianNvbiIsImVycm9yIiwic2VuZCIsImV4aXN0aW5nU2VsbGVyIiwiU2VsbGVyIiwiZmluZE9uZSIsImRvY3VtZW50cyIsInZlcmdpX2xldmhhc2kiLCJzaWNpbF9nYXpldGVzaSIsInVwbG9hZGVkQXQiLCJEYXRlIiwic2VsbGVyIiwidW5kZWZpbmVkIiwic3ViTWVyY2hhbnRUeXBlIiwic2F2ZSIsInVzZXIiLCJjb25zb2xlIiwibG9nIiwidGF4TnVtYmVyIiwiaXNWZXJpZmllZCIsInBhc3N3b3JkQ29uZmlybWVkIiwiYmNyeXB0IiwiY29tcGFyZSIsInNlbGxlckpzb24iLCJ0b0pTT04iLCJ0b2tlbiIsImp3dCIsInNpZ24iLCJwcm9jZXNzIiwiZW52IiwiSldUX1NFQ1JFVCIsImdldCIsIlNlc3Npb24iLCJzZWxsZXJJZCIsIl9pZCIsInByb2R1Y3RzIiwiUHJvZHVjdHMiLCJmaW5kIiwibGVuZ3RoIiwibWVzc2FnZSIsInB1dCIsInNpbmdsZSIsInBob25lTnVtYmVyIiwiY2l0eSIsImxvZ29QYXRoIiwidG9TdHJpbmciLCJ1cGRhdGVGaWVsZHMiLCJTZWxsZXJMb2dvIiwidXBkYXRlU2VsbGVyIiwiZmluZEJ5SWRBbmRVcGRhdGUiLCJuZXciLCJjYXJ0cyIsIkNhcnQiLCJjb21wbGV0ZWQiLCJwb3B1bGF0ZSIsInNlbGxlck9yZGVycyIsIm1hcCIsImNhcnQiLCJzZWxsZXJJdGVtcyIsImZpbHRlciIsInByb2R1Y3QiLCJjYXJ0SWQiLCJidXllciIsIml0ZW1zIiwiaXRlbSIsInByb2R1Y3RJZCIsInByb2R1Y3ROYW1lIiwicHJvZHVjdFByaWNlIiwicHJpY2UiLCJwcm9kdWN0SW1hZ2VzIiwiaW1hZ2VzIiwicXVhbnRpdHkiLCJvcmRlciIsImVycm9yQ29kZSIsInBhcmFtcyIsImZpbmRPbmVBbmRVcGRhdGUiLCIkc2V0IiwiYXJyYXlGaWx0ZXJzIiwib2xkUGFzc3dvcmQiLCJuZXdQYXNzd29yZCIsImNvbmZpcm1QYXNzd29yZCIsImZpbmRCeUlkIiwiaXNNYXRjaFBhc3N3b3JkIiwiaXNTYW1lUGFzc3dvcmQiLCJzdGF0dXNDb2RlIiwiY29kZSIsImZvcmdvdFNlbGxlclBhc3N3b3JkRW1haWwiLCJ1c2VyRW1haWwiLCJub0V4aXN0VmFyaWFibGUiLCJpZCIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9yb3V0ZXMvIiwic291cmNlcyI6WyJTZWxsZXJzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDYXJ0IGZyb20gXCIuLi9kYi9jYXJ0XCI7XG5pbXBvcnQgUHJvZHVjdHMgZnJvbSBcIi4uL2RiL3Byb2R1Y3RzXCI7XG5pbXBvcnQgU2VsbGVyIGZyb20gXCIuLi9kYi9zZWxsZXJcIjtcbi8vIGltcG9ydCBVc2VycyBmcm9tIFwiLi4vZGIvdXNlcnNcIjtcbmltcG9ydCBiY3J5cHQgZnJvbSBcImJjcnlwdGpzXCI7XG5pbXBvcnQgand0IGZyb20gXCJqc29ud2VidG9rZW5cIjtcbmltcG9ydCBtdWx0ZXIgZnJvbSBcIm11bHRlclwiO1xuaW1wb3J0IHBhdGggZnJvbSBcInBhdGhcIjtcbmltcG9ydCBBcGlFcnJvciBmcm9tIFwiLi4vZXJyb3JzL0FwaUVycm9yXCI7XG5pbXBvcnQgeyBub0V4aXN0VmFyaWFibGUgfSBmcm9tIFwiLi4vaGVscGVycy9DaGVja0V4aXN0ZW5jZVwiO1xuaW1wb3J0IHsgY2hlY2tMb3RzT2ZSZXF1aXJlZEZpZWxkIH0gZnJvbSBcIi4uL2hlbHBlcnMvUmVxdWlyZWRDaGVja1wiO1xuaW1wb3J0IHsgZm9yZ290U2VsbGVyUGFzc3dvcmRFbWFpbCB9IGZyb20gXCIuLi9taWRkbGV3YXJlcy9Gb3Jnb3RQYXNzd29yZE1haWxcIjtcbmltcG9ydCBTZXNzaW9uIGZyb20gXCIuLi9taWRkbGV3YXJlcy9TZXNzaW9uXCI7XG5pbXBvcnQgZ2V0VXNlcklwIGZyb20gXCIuLi9taWRkbGV3YXJlcy9nZXRVc2VySVBcIjtcblxuY29uc3QgdXBsb2FkID0gbXVsdGVyKHtcbiAgc3RvcmFnZTogbXVsdGVyLmRpc2tTdG9yYWdlKHtcbiAgICBkZXN0aW5hdGlvbjogKHJlcSwgZmlsZSwgY2IpID0+IHtcbiAgICAgIGNiKG51bGwsIFwicHVibGljL3VwbG9hZHNcIik7XG4gICAgfSxcbiAgICBmaWxlbmFtZTogKHJlcSwgZmlsZSwgY2IpID0+IHtcbiAgICAgIGNvbnN0IG9yaWdpbmFsTmFtZSA9IGZpbGUub3JpZ2luYWxuYW1lO1xuICAgICAgY2IobnVsbCwgb3JpZ2luYWxOYW1lKTtcbiAgICB9LFxuICB9KSxcbiAgZmlsZUZpbHRlcjogKHJlcSwgZmlsZSwgY2IpID0+IHtcbiAgICBjb25zdCBmaWxlVHlwZXMgPSAvanBlZ3xqcGd8cG5nfHBkZi87XG5cbiAgICBjb25zdCBleHRuYW1lID0gZmlsZVR5cGVzLnRlc3QoXG4gICAgICBwYXRoLmV4dG5hbWUoZmlsZS5vcmlnaW5hbG5hbWUpLnRvTG93ZXJDYXNlKClcbiAgICApO1xuXG4gICAgY29uc3QgbWltZXR5cGUgPSBmaWxlVHlwZXMudGVzdChmaWxlLm1pbWV0eXBlKTtcblxuICAgIGlmIChtaW1ldHlwZSAmJiBleHRuYW1lKSB7XG4gICAgICByZXR1cm4gY2IobnVsbCwgdHJ1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNiKFxuICAgICAgICBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgXCJJbnZhbGlkIGZpbGUgdHlwZS4gT25seSBKUEVHLCBKUEcsIGFuZCBQTkcgYXJlIGFsbG93ZWQuXCIsXG4gICAgICAgICAgNDAwLFxuICAgICAgICAgIFwiSW52YWxpZEZpbGVUeXBlXCJcbiAgICAgICAgKVxuICAgICAgKTtcbiAgICB9XG4gIH0sXG59KTtcblxuY29uc3QgdXBsb2FkRmllbGRzID0gW1xuICB7IG5hbWU6IFwibG9nb1wiLCBtYXhDb3VudDogMSB9LCAvLyBTZWxsZXJMb2dvIGnDp2luIDEgZG9zeWFcbiAgeyBuYW1lOiBcInZlcmdpX2xldmhhc2lcIiwgbWF4Q291bnQ6IDEgfSxcbiAgeyBuYW1lOiBcInNpY2lsX2dhemV0ZXNpXCIsIG1heENvdW50OiAxIH0sXG5dO1xuXG5leHBvcnQgZGVmYXVsdCAocm91dGVyKSA9PiB7XG4gIHJvdXRlci5wb3N0KFxuICAgIFwiL3NlbGxlci9yZWdpc3Rlci9wcml2YXRlLWNvbXBhbnlcIixcbiAgICBnZXRVc2VySXAsXG4gICAgdXBsb2FkLmZpZWxkcyh1cGxvYWRGaWVsZHMpLFxuICAgIGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICAgICAgY29uc3Qge1xuICAgICAgICBlbWFpbCxcbiAgICAgICAgbmFtZSxcbiAgICAgICAgbG9nbyxcbiAgICAgICAgZ3NtTnVtYmVyLFxuICAgICAgICBwYXNzd29yZCxcbiAgICAgICAgYWRkcmVzcyxcbiAgICAgICAgaWRlbnRpdHlOdW1iZXIsXG4gICAgICAgIGliYW4sXG4gICAgICAgIHRheE9mZmljZSxcbiAgICAgICAgbGVnYWxDb21wYW55VGl0bGUsXG4gICAgICB9ID0gcmVxLmJvZHk7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGNoZWNrTG90c09mUmVxdWlyZWRGaWVsZChbXG4gICAgICAgICAgeyBmaWVsZDogZW1haWwsIGZpZWxkTmFtZTogXCJFLU1haWxcIiB9LFxuICAgICAgICAgIHsgZmllbGQ6IG5hbWUsIGZpZWxkTmFtZTogXCJOYW1lXCIgfSxcbiAgICAgICAgICB7IGZpZWxkOiBnc21OdW1iZXIsIGZpZWxkTmFtZTogXCJQaG9uZSBOdW1iZXJcIiB9LFxuICAgICAgICAgIHsgZmllbGQ6IGFkZHJlc3MsIGZpZWxkTmFtZTogXCJBZGRyZXNzXCIgfSxcbiAgICAgICAgICB7IGZpZWxkOiBpZGVudGl0eU51bWJlciwgZmllbGROYW1lOiBcIklkZW50aXR5IE51bWJlclwiIH0sXG4gICAgICAgICAgeyBmaWVsZDogaWJhbiwgZmllbGROYW1lOiBcIklCQU5cIiB9LFxuICAgICAgICAgIHsgZmllbGQ6IHRheE9mZmljZSwgZmllbGROYW1lOiBcIlRheCBPZmZpY2VcIiB9LFxuICAgICAgICAgIHsgZmllbGQ6IGxlZ2FsQ29tcGFueVRpdGxlLCBmaWVsZE5hbWU6IFwiTGVnYWwgQ29tcGFueSBUaXRsZVwiIH0sXG4gICAgICAgIF0pO1xuXG4gICAgICAgIGlmICghcmVxLmZpbGVzW1widmVyZ2lfbGV2aGFzaVwiXSB8fCAhcmVxLmZpbGVzW1wic2ljaWxfZ2F6ZXRlc2lcIl0pIHtcbiAgICAgICAgICByZXR1cm4gcmVzXG4gICAgICAgICAgICAuc3RhdHVzKDQwMClcbiAgICAgICAgICAgIC5qc29uKHsgZXJyb3I6IFwiVmVyZ2kgbGV2aGFzxLEgdmUgU2ljaWwgZ2F6ZXRlc2kgem9ydW5sdWR1ci5cIiB9KTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5zZW5kKGVycm9yKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZXhpc3RpbmdTZWxsZXIgPSBhd2FpdCBTZWxsZXIuZmluZE9uZSh7IGVtYWlsIH0pO1xuICAgICAgaWYgKGV4aXN0aW5nU2VsbGVyKSB7XG4gICAgICAgIHJldHVybiByZXNcbiAgICAgICAgICAuc3RhdHVzKDQwMClcbiAgICAgICAgICAuc2VuZChuZXcgQXBpRXJyb3IoNDAwLCBcIkJ1IGUtcG9zdGEgemF0ZW4ga3VsbGFuxLFsxLF5b3JcIikpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBkb2N1bWVudHMgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICB2ZXJnaV9sZXZoYXNpOiByZXEuZmlsZXNbXCJ2ZXJnaV9sZXZoYXNpXCJdWzBdLnBhdGgsXG4gICAgICAgICAgc2ljaWxfZ2F6ZXRlc2k6IHJlcS5maWxlc1tcInNpY2lsX2dhemV0ZXNpXCJdWzBdLnBhdGgsXG4gICAgICAgICAgdXBsb2FkZWRBdDogbmV3IERhdGUoKSxcbiAgICAgICAgfSxcbiAgICAgIF07XG5cbiAgICAgIGNvbnN0IHNlbGxlciA9IG5ldyBTZWxsZXIoe1xuICAgICAgICBlbWFpbCxcbiAgICAgICAgbmFtZSxcbiAgICAgICAgZ3NtTnVtYmVyLFxuICAgICAgICBwYXNzd29yZCxcbiAgICAgICAgbG9nbzogcmVxLmZpbGVzW1wibG9nb1wiXSA/IHJlcS5maWxlc1tcImxvZ29cIl1bMF0ucGF0aCA6IHVuZGVmaW5lZCxcbiAgICAgICAgZG9jdW1lbnRzLFxuICAgICAgICBhZGRyZXNzLFxuICAgICAgICBpZGVudGl0eU51bWJlcixcbiAgICAgICAgc3ViTWVyY2hhbnRUeXBlOiBcIlBSSVZBVEVfQ09NUEFOWVwiLFxuICAgICAgICBpYmFuLFxuICAgICAgICB0YXhPZmZpY2UsXG4gICAgICAgIGxlZ2FsQ29tcGFueVRpdGxlLFxuICAgICAgfSk7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHNlbGxlci5zYXZlKCk7XG4gICAgICAgIHJlcS51c2VyID0gc2VsbGVyO1xuICAgICAgICBuZXh0KCk7XG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKFwiU2VsbGVyIE9sdcWfdHVydWxkdSwgb25heSBiZWtsZW5peW9yLlwiKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgcmV0dXJuIHJlc1xuICAgICAgICAgIC5zdGF0dXMoNTAwKVxuICAgICAgICAgIC5zZW5kKG5ldyBBcGlFcnJvcig1MDAsIFwiS2F5xLF0IGnFn2xlbWkgc8SxcmFzxLFuZGEgaGF0YSBvbHXFn3R1XCIpKTtcbiAgICAgIH1cbiAgICB9XG4gICk7XG4gIHJvdXRlci5wb3N0KFxuICAgIFwiL3NlbGxlci9yZWdpc3Rlci9saW1pdGVkLW9yLWpvaW50XCIsXG4gICAgZ2V0VXNlcklwLFxuICAgIHVwbG9hZC5maWVsZHModXBsb2FkRmllbGRzKSxcbiAgICBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgZW1haWwsXG4gICAgICAgIG5hbWUsXG4gICAgICAgIGxvZ28sXG4gICAgICAgIGdzbU51bWJlcixcbiAgICAgICAgcGFzc3dvcmQsXG4gICAgICAgIGFkZHJlc3MsXG4gICAgICAgIHRheE51bWJlcixcbiAgICAgICAgaWJhbixcbiAgICAgICAgdGF4T2ZmaWNlLFxuICAgICAgICBsZWdhbENvbXBhbnlUaXRsZSxcbiAgICAgIH0gPSByZXEuYm9keTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgY2hlY2tMb3RzT2ZSZXF1aXJlZEZpZWxkKFtcbiAgICAgICAgICB7IGZpZWxkOiBlbWFpbCwgZmllbGROYW1lOiBcIkUtTWFpbFwiIH0sXG4gICAgICAgICAgeyBmaWVsZDogbmFtZSwgZmllbGROYW1lOiBcIk5hbWVcIiB9LFxuICAgICAgICAgIHsgZmllbGQ6IGdzbU51bWJlciwgZmllbGROYW1lOiBcIlBob25lIE51bWJlclwiIH0sXG4gICAgICAgICAgeyBmaWVsZDogYWRkcmVzcywgZmllbGROYW1lOiBcIkFkZHJlc3NcIiB9LFxuICAgICAgICAgIHsgZmllbGQ6IHRheE51bWJlciwgZmllbGROYW1lOiBcIlRheCBOdW1iZXJcIiB9LFxuICAgICAgICAgIHsgZmllbGQ6IGliYW4sIGZpZWxkTmFtZTogXCJJQkFOXCIgfSxcbiAgICAgICAgICB7IGZpZWxkOiB0YXhPZmZpY2UsIGZpZWxkTmFtZTogXCJUYXggT2ZmaWNlXCIgfSxcbiAgICAgICAgICB7IGZpZWxkOiBsZWdhbENvbXBhbnlUaXRsZSwgZmllbGROYW1lOiBcIkxlZ2FsIENvbXBhbnkgVGl0bGVcIiB9LFxuICAgICAgICBdKTtcblxuICAgICAgICBpZiAoIXJlcS5maWxlc1tcInZlcmdpX2xldmhhc2lcIl0gfHwgIXJlcS5maWxlc1tcInNpY2lsX2dhemV0ZXNpXCJdKSB7XG4gICAgICAgICAgcmV0dXJuIHJlc1xuICAgICAgICAgICAgLnN0YXR1cyg0MDApXG4gICAgICAgICAgICAuanNvbih7IGVycm9yOiBcIlZlcmdpIGxldmhhc8SxIHZlIFNpY2lsIGdhemV0ZXNpIHpvcnVubHVkdXIuXCIgfSk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChlcnJvcik7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGV4aXN0aW5nU2VsbGVyID0gYXdhaXQgU2VsbGVyLmZpbmRPbmUoeyBlbWFpbCB9KTtcbiAgICAgIGlmIChleGlzdGluZ1NlbGxlcikge1xuICAgICAgICByZXR1cm4gcmVzXG4gICAgICAgICAgLnN0YXR1cyg0MDApXG4gICAgICAgICAgLnNlbmQobmV3IEFwaUVycm9yKDQwMCwgXCJCdSBlLXBvc3RhIHphdGVuIGt1bGxhbsSxbMSxeW9yXCIpKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZG9jdW1lbnRzID0gW1xuICAgICAgICB7XG4gICAgICAgICAgdmVyZ2lfbGV2aGFzaTogcmVxLmZpbGVzW1widmVyZ2lfbGV2aGFzaVwiXVswXS5wYXRoLFxuICAgICAgICAgIHNpY2lsX2dhemV0ZXNpOiByZXEuZmlsZXNbXCJzaWNpbF9nYXpldGVzaVwiXVswXS5wYXRoLFxuICAgICAgICAgIHVwbG9hZGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgIH0sXG4gICAgICBdO1xuXG4gICAgICBjb25zdCBzZWxsZXIgPSBuZXcgU2VsbGVyKHtcbiAgICAgICAgZW1haWwsXG4gICAgICAgIG5hbWUsXG4gICAgICAgIGdzbU51bWJlcixcbiAgICAgICAgcGFzc3dvcmQsXG4gICAgICAgIGxvZ286IHJlcS5maWxlc1tcImxvZ29cIl0gPyByZXEuZmlsZXNbXCJsb2dvXCJdWzBdLnBhdGggOiB1bmRlZmluZWQsXG4gICAgICAgIGRvY3VtZW50cyxcbiAgICAgICAgYWRkcmVzcyxcbiAgICAgICAgdGF4TnVtYmVyLFxuICAgICAgICBzdWJNZXJjaGFudFR5cGU6IFwiTElNSVRFRF9PUl9KT0lOVF9TVE9DS19DT01QQU5ZXCIsXG4gICAgICAgIGliYW4sXG4gICAgICAgIHRheE9mZmljZSxcbiAgICAgICAgbGVnYWxDb21wYW55VGl0bGUsXG4gICAgICB9KTtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgYXdhaXQgc2VsbGVyLnNhdmUoKTtcbiAgICAgICAgcmVxLnVzZXIgPSBzZWxsZXI7XG4gICAgICAgIG5leHQoKTtcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oXCJTZWxsZXIgT2x1xZ90dXJ1bGR1LCBvbmF5IGJla2xlbml5b3IuXCIpO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICByZXR1cm4gcmVzXG4gICAgICAgICAgLnN0YXR1cyg1MDApXG4gICAgICAgICAgLnNlbmQobmV3IEFwaUVycm9yKDUwMCwgXCJLYXnEsXQgacWfbGVtaSBzxLFyYXPEsW5kYSBoYXRhIG9sdcWfdHVcIikpO1xuICAgICAgfVxuICAgIH1cbiAgKTtcblxuICByb3V0ZXIucG9zdChcIi9zZWxsZXIvbG9naW5cIiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyBlbWFpbCwgcGFzc3dvcmQgfSA9IHJlcS5ib2R5O1xuICAgIGNvbnN0IHNlbGxlciA9IGF3YWl0IFNlbGxlci5maW5kT25lKHsgZW1haWwgfSk7XG5cbiAgICB0cnkge1xuICAgICAgY2hlY2tMb3RzT2ZSZXF1aXJlZEZpZWxkKFtcbiAgICAgICAgeyBmaWVsZDogZW1haWwsIGZpZWxkTmFtZTogXCJFLU1haWxcIiB9LFxuICAgICAgICB7IGZpZWxkOiBwYXNzd29yZCwgZmllbGROYW1lOiBcIlBhc3N3b3JkXCIgfSxcbiAgICAgIF0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oZXJyb3IpO1xuICAgIH1cblxuICAgIGlmICghc2VsbGVyKSB7XG4gICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgIFwiSW5jb3JyZWN0IFBhc3N3b3JkIG9yIGVtYWlsMlwiLFxuICAgICAgICA0MDEsXG4gICAgICAgIFwidXNlck9yUGFzc3dvcmRJbmNvcnJlY3RcIlxuICAgICAgKTtcbiAgICB9XG4gICAgaWYgKHNlbGxlci5pc1ZlcmlmaWVkID09IGZhbHNlKSB7XG4gICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgIFwiWW91IGhhdmUgdG8gdmVyaWZpY2F0ZSB5b3VyIGFjY291bnQuXCIsXG4gICAgICAgIDQwMSxcbiAgICAgICAgXCJhY2NvdW50Tm90VmVyaWZpZWRcIlxuICAgICAgKTtcbiAgICB9XG4gICAgY29uc3QgcGFzc3dvcmRDb25maXJtZWQgPSBhd2FpdCBiY3J5cHQuY29tcGFyZShwYXNzd29yZCwgc2VsbGVyLnBhc3N3b3JkKTtcbiAgICAvLyBjb25zb2xlLmxvZyhcImt1bGxhbsSxY8SxIGdpcmRpc2k6XCIsIHBhc3N3b3JkKTsgc2lsaW5lY2VrbGVyXG4gICAgLy8gY29uc29sZS5sb2coXCJoYXNobGVubWnFnyBoYWxpOlwiLCB1c2VyLnBhc3N3b3JkKTtcblxuICAgIGlmIChwYXNzd29yZENvbmZpcm1lZCkge1xuICAgICAgY29uc3Qgc2VsbGVySnNvbiA9IHNlbGxlci50b0pTT04oKTtcbiAgICAgIGNvbnN0IHRva2VuID0gand0LnNpZ24oc2VsbGVySnNvbiwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCk7XG4gICAgICByZXMuanNvbih7XG4gICAgICAgIHRva2VuOiBgQmVhcmVyICR7dG9rZW59YCxcbiAgICAgICAgc2VsbGVyOiBzZWxsZXJKc29uLFxuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgXCJJbmNvcnJlY3QgUGFzc3dvcmQgb3IgZW1haWxcIixcbiAgICAgICAgNDAxLFxuICAgICAgICBcInVzZXJPclBhc3N3b3JkSW5jb3JyZWN0XCJcbiAgICAgICk7XG4gICAgfVxuICB9KTtcblxuICByb3V0ZXIuZ2V0KFwiL3NlbGxlci9wcm9kdWN0c1wiLCBTZXNzaW9uLCBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc2VsbGVySWQgPSByZXEudXNlci5faWQ7XG4gICAgICBjb25zdCBwcm9kdWN0cyA9IGF3YWl0IFByb2R1Y3RzLmZpbmQoeyBzZWxsZXI6IHNlbGxlcklkIH0pO1xuICAgICAgaWYgKCFwcm9kdWN0cyB8fCBwcm9kdWN0cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgcmV0dXJuIHJlc1xuICAgICAgICAgIC5zdGF0dXMoNDAwKVxuICAgICAgICAgIC5qc29uKHsgbWVzc2FnZTogXCJUaGVyZSBpcyBubyBzdWNoIHByb2R1Y3RzIGluIHRoaXMgdXNlclwiIH0pO1xuICAgICAgfVxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24ocHJvZHVjdHMpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICBuZXh0KGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIlRoZXJlIGlzIGVycm9yXCIsIDQwNCwgXCJhbkVycm9yXCIpO1xuICAgIH1cbiAgfSk7XG5cbiAgcm91dGVyLnB1dChcbiAgICBcIi9zZWxsZXIvdXBkYXRlXCIsXG4gICAgU2Vzc2lvbixcbiAgICB1cGxvYWQuc2luZ2xlKFwiU2VsbGVyTG9nb1wiKSxcbiAgICBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICAgIGNvbnN0IHsgcGhvbmVOdW1iZXIsIGFkZHJlc3MsIGNpdHkgfSA9IHJlcS5ib2R5O1xuICAgICAgY29uc3Qgc2VsbGVyID0gcmVxLnVzZXI7XG4gICAgICBjb25zdCBsb2dvUGF0aCA9IHJlcS5maWxlID8gYC91cGxvYWRzLyR7cmVxLmZpbGUuZmlsZW5hbWV9YCA6IG51bGw7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGlmIChwaG9uZU51bWJlcikge1xuICAgICAgICAgIGNvbnN0IGV4aXN0aW5nU2VsbGVyID0gYXdhaXQgU2VsbGVyLmZpbmRPbmUoeyBwaG9uZU51bWJlciB9KTtcbiAgICAgICAgICBpZiAoXG4gICAgICAgICAgICBleGlzdGluZ1NlbGxlciAmJlxuICAgICAgICAgICAgZXhpc3RpbmdTZWxsZXIuX2lkLnRvU3RyaW5nKCkgIT09IHNlbGxlci5faWQudG9TdHJpbmcoKVxuICAgICAgICAgICkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgICAgICBcIlRoaXMgcGhvbmUgbnVtYmVyIGFscmVhZHkgdXNpbmdcIixcbiAgICAgICAgICAgICAgNDAwLFxuICAgICAgICAgICAgICBcInBob25lTnVtYmVyQWxyZWFkeVVzaW5nXCJcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIC8vIEfDvG5jZWxsZW5lY2VrIGFsYW5sYXLEsSBkaW5hbWlrIG9sYXJhayBvbHXFn3R1clxuICAgICAgICBjb25zdCB1cGRhdGVGaWVsZHMgPSB7XG4gICAgICAgICAgLi4uKHBob25lTnVtYmVyICYmIHsgcGhvbmVOdW1iZXIgfSksXG4gICAgICAgICAgLi4uKGFkZHJlc3MgJiYgeyBhZGRyZXNzIH0pLFxuICAgICAgICAgIC4uLihjaXR5ICYmIHsgY2l0eSB9KSxcbiAgICAgICAgICAuLi4obG9nb1BhdGggJiYgeyBTZWxsZXJMb2dvOiBsb2dvUGF0aCB9KSwgLy8gRcSfZXIgbG9nbyB5w7xrbGVuZGl5c2UgZWtsZVxuICAgICAgICB9O1xuXG4gICAgICAgIC8vIFNhdMSxY8SxecSxIGfDvG5jZWxsZVxuICAgICAgICBjb25zdCB1cGRhdGVTZWxsZXIgPSBhd2FpdCBTZWxsZXIuZmluZEJ5SWRBbmRVcGRhdGUoXG4gICAgICAgICAgc2VsbGVyLl9pZCxcbiAgICAgICAgICB1cGRhdGVGaWVsZHMsXG4gICAgICAgICAgeyBuZXc6IHRydWUgfVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIGNvbnN0IHVwZGF0ZVNlbGxlciA9IGF3YWl0IFNlbGxlci5maW5kQnlJZEFuZFVwZGF0ZShcbiAgICAgICAgLy8gICBzZWxsZXIsXG4gICAgICAgIC8vICAgeyBwaG9uZU51bWJlciwgYWRkcmVzcywgY2l0eSB9LFxuICAgICAgICAvLyAgIHsgbmV3OiB0cnVlIH1cbiAgICAgICAgLy8gKTtcblxuICAgICAgICBpZiAoIXVwZGF0ZVNlbGxlcikge1xuICAgICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIlNlbGxlciBub3QgZm91bmRcIiwgNDAwLCBcIm5vdEZvdW5kU2VsbGVyXCIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXNcbiAgICAgICAgICAuc3RhdHVzKDIwMClcbiAgICAgICAgICAuanNvbih7IG1lc3NhZ2U6IFwic2VsbGVyIGluZm9ybWF0aW9uIGhhcyBiZWVuIGNoYW5nZWRcIiwgc2VsbGVyIH0pO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgXCJTZWxsZXIgaW5mb3JtYXRpb25zIGNhbm5vdCBjaGFuZ2VcIixcbiAgICAgICAgICA1MDAsXG4gICAgICAgICAgXCJjYW5ub3RDaGFuZ2VTZWxsZXJJbmZvcm1hdGlvblwiXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuICApO1xuXG4gIHJvdXRlci5nZXQoXCIvc2VsbGVyLW9yZGVycy9wZW5kaW5nXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBzZWxsZXJJZCA9IHJlcS51c2VyLl9pZDsgLy8gU2F0xLFjxLEgSUQnc2lcblxuICAgICAgLy8gMS4gU2F0xLFjxLFuxLFuIMO8csO8bmxlcmkgb2xhbiBzZXBldGxlcmkgdmUgw7xyw7xubGVyaSDDp2VraXlvcnV6XG4gICAgICBjb25zdCBjYXJ0cyA9IGF3YWl0IENhcnQuZmluZCh7XG4gICAgICAgIFwicHJvZHVjdHMuc2VsbGVyXCI6IHNlbGxlcklkLCAvLyBTYXTEsWPEsW7EsW4gw7xyw7xuw7wgb2xhbmxhclxuICAgICAgICBcInByb2R1Y3RzLnN0YXR1c1wiOiBcInBlbmRpbmdcIiwgLy8gQmVrbGVtZWRlIG9sYW5sYXJcbiAgICAgICAgY29tcGxldGVkOiB0cnVlLFxuICAgICAgfSlcbiAgICAgICAgLnBvcHVsYXRlKFxuICAgICAgICAgIFwiYnV5ZXJcIixcbiAgICAgICAgICBcIm5hbWUgc3VybmFtZSBlbWFpbCBhZGRyZXNzIHBob25lTnVtYmVyIHppcENvZGUgY2l0eSBjb3VudHJ5XCJcbiAgICAgICAgKVxuICAgICAgICAucG9wdWxhdGUoXCJwcm9kdWN0cy5wcm9kdWN0SWRcIik7IC8vIEFsxLFjxLEgYmlsZ2lsZXJpbmkgZ2V0aXJpeW9ydXpcblxuICAgICAgLy8gMi4gU2FkZWNlIHNhdMSxY8SxbsSxbiDDvHLDvG5sZXJpbmkgZmlsdHJlbGl5b3J1elxuICAgICAgY29uc3Qgc2VsbGVyT3JkZXJzID0gY2FydHMubWFwKChjYXJ0KSA9PiB7XG4gICAgICAgIGNvbnN0IHNlbGxlckl0ZW1zID0gY2FydC5wcm9kdWN0cy5maWx0ZXIoKHByb2R1Y3QpID0+IHtcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgcHJvZHVjdC5zZWxsZXIudG9TdHJpbmcoKSA9PT0gc2VsbGVySWQudG9TdHJpbmcoKSAmJlxuICAgICAgICAgICAgcHJvZHVjdC5zdGF0dXMgPT09IFwicGVuZGluZ1wiXG4gICAgICAgICAgKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBjYXJ0SWQ6IGNhcnQuX2lkLFxuICAgICAgICAgIGJ1eWVyOiBjYXJ0LmJ1eWVyLFxuICAgICAgICAgIGl0ZW1zOiBzZWxsZXJJdGVtc1xuICAgICAgICAgICAgLm1hcCgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICBpZiAoIWl0ZW0ucHJvZHVjdElkKSB7XG4gICAgICAgICAgICAgICAgLy8gRcSfZXIgcHJvZHVjdElkIG51bGwgaXNlLCDDvHLDvG7DvCBhdGzEsXlvcnV6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHByb2R1Y3RJZDogaXRlbS5wcm9kdWN0SWQuX2lkLFxuICAgICAgICAgICAgICAgIHByb2R1Y3ROYW1lOiBpdGVtLnByb2R1Y3RJZC5uYW1lLFxuICAgICAgICAgICAgICAgIHByb2R1Y3RQcmljZTogaXRlbS5wcm9kdWN0SWQucHJpY2UsXG4gICAgICAgICAgICAgICAgcHJvZHVjdEltYWdlczogaXRlbS5wcm9kdWN0SWQuaW1hZ2VzLFxuICAgICAgICAgICAgICAgIHF1YW50aXR5OiBpdGVtLnF1YW50aXR5LFxuICAgICAgICAgICAgICAgIHN0YXR1czogaXRlbS5zdGF0dXMsXG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmZpbHRlcigoaXRlbSkgPT4gaXRlbSAhPT0gbnVsbCksIC8vIE51bGwgb2xhbiDDvHLDvG5sZXJpIGZpbHRyZWxpeW9ydXpcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBFxJ9lciBzYXTEsWPEsXlhIGFpdCDDvHLDvG5sZXIgdmFyc2EgZMO2bmTDvHLDvHlvcnV6XG4gICAgICByZXNcbiAgICAgICAgLnN0YXR1cygyMDApXG4gICAgICAgIC5qc29uKHNlbGxlck9yZGVycy5maWx0ZXIoKG9yZGVyKSA9PiBvcmRlci5pdGVtcy5sZW5ndGggPiAwKSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB3aGlsZSBnZXR0aW5nIHNlbGxlciBvcmRlcnM6XCIsIGVycm9yKTtcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcbiAgICAgICAgbWVzc2FnZTogXCJDYW4gbm90IGdldCBzZWxsZXIgb3JkZXJzXCIsXG4gICAgICAgIGVycm9yQ29kZTogXCJjYW5Ob3RHZXRTZWxsZXJPcmRlcnNcIixcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG4gIHJvdXRlci5nZXQoXCIvc2VsbGVyLW9yZGVycy9wcm9jZXNzaW5nXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBzZWxsZXJJZCA9IHJlcS51c2VyLl9pZDsgLy8gU2F0xLFjxLEgSUQnc2lcblxuICAgICAgLy8gMS4gU2F0xLFjxLFuxLFuIMO8csO8bmxlcmkgb2xhbiBzZXBldGxlcmkgdmUgw7xyw7xubGVyaSDDp2VraXlvcnV6XG4gICAgICBjb25zdCBjYXJ0cyA9IGF3YWl0IENhcnQuZmluZCh7XG4gICAgICAgIFwicHJvZHVjdHMuc2VsbGVyXCI6IHNlbGxlcklkLCAvLyBTYXTEsWPEsW7EsW4gw7xyw7xuw7wgb2xhbmxhclxuICAgICAgICBcInByb2R1Y3RzLnN0YXR1c1wiOiBcInByb2Nlc3NpbmdcIiwgLy8gQmVrbGVtZWRlIG9sYW5sYXJcbiAgICAgICAgY29tcGxldGVkOiB0cnVlLFxuICAgICAgfSlcbiAgICAgICAgLnBvcHVsYXRlKFxuICAgICAgICAgIFwiYnV5ZXJcIixcbiAgICAgICAgICBcIm5hbWUgc3VybmFtZSBlbWFpbCBhZGRyZXNzIHBob25lTnVtYmVyIHppcENvZGUgY2l0eSBjb3VudHJ5XCJcbiAgICAgICAgKVxuICAgICAgICAucG9wdWxhdGUoXCJwcm9kdWN0cy5wcm9kdWN0SWRcIik7IC8vIEFsxLFjxLEgYmlsZ2lsZXJpbmkgZ2V0aXJpeW9ydXpcblxuICAgICAgLy8gMi4gU2FkZWNlIHNhdMSxY8SxbsSxbiDDvHLDvG5sZXJpbmkgZmlsdHJlbGl5b3J1elxuICAgICAgY29uc3Qgc2VsbGVyT3JkZXJzID0gY2FydHMubWFwKChjYXJ0KSA9PiB7XG4gICAgICAgIGNvbnN0IHNlbGxlckl0ZW1zID0gY2FydC5wcm9kdWN0cy5maWx0ZXIoKHByb2R1Y3QpID0+IHtcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgcHJvZHVjdC5zZWxsZXIudG9TdHJpbmcoKSA9PT0gc2VsbGVySWQudG9TdHJpbmcoKSAmJlxuICAgICAgICAgICAgcHJvZHVjdC5zdGF0dXMgPT09IFwicHJvY2Vzc2luZ1wiXG4gICAgICAgICAgKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBjYXJ0SWQ6IGNhcnQuX2lkLFxuICAgICAgICAgIGJ1eWVyOiBjYXJ0LmJ1eWVyLFxuICAgICAgICAgIGl0ZW1zOiBzZWxsZXJJdGVtc1xuICAgICAgICAgICAgLm1hcCgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICBpZiAoIWl0ZW0ucHJvZHVjdElkKSB7XG4gICAgICAgICAgICAgICAgLy8gRcSfZXIgcHJvZHVjdElkIG51bGwgaXNlLCDDvHLDvG7DvCBhdGzEsXlvcnV6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHByb2R1Y3RJZDogaXRlbS5wcm9kdWN0SWQuX2lkLFxuICAgICAgICAgICAgICAgIHByb2R1Y3ROYW1lOiBpdGVtLnByb2R1Y3RJZC5uYW1lLFxuICAgICAgICAgICAgICAgIHByb2R1Y3RQcmljZTogaXRlbS5wcm9kdWN0SWQucHJpY2UsXG4gICAgICAgICAgICAgICAgcHJvZHVjdEltYWdlczogaXRlbS5wcm9kdWN0SWQuaW1hZ2VzLFxuICAgICAgICAgICAgICAgIHF1YW50aXR5OiBpdGVtLnF1YW50aXR5LFxuICAgICAgICAgICAgICAgIHN0YXR1czogaXRlbS5zdGF0dXMsXG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmZpbHRlcigoaXRlbSkgPT4gaXRlbSAhPT0gbnVsbCksIC8vIE51bGwgb2xhbiDDvHLDvG5sZXJpIGZpbHRyZWxpeW9ydXpcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBFxJ9lciBzYXTEsWPEsXlhIGFpdCDDvHLDvG5sZXIgdmFyc2EgZMO2bmTDvHLDvHlvcnV6XG4gICAgICByZXNcbiAgICAgICAgLnN0YXR1cygyMDApXG4gICAgICAgIC5qc29uKHNlbGxlck9yZGVycy5maWx0ZXIoKG9yZGVyKSA9PiBvcmRlci5pdGVtcy5sZW5ndGggPiAwKSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB3aGlsZSBnZXR0aW5nIHNlbGxlciBvcmRlcnM6XCIsIGVycm9yKTtcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcbiAgICAgICAgbWVzc2FnZTogXCJDYW4gbm90IGdldCBzZWxsZXIgb3JkZXJzXCIsXG4gICAgICAgIGVycm9yQ29kZTogXCJjYW5Ob3RHZXRTZWxsZXJPcmRlcnNcIixcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG4gIHJvdXRlci5nZXQoXCIvc2VsbGVyLW9yZGVycy9jb21wbGV0ZWRcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHNlbGxlcklkID0gcmVxLnVzZXIuX2lkOyAvLyBTYXTEsWPEsSBJRCdzaVxuXG4gICAgICAvLyAxLiBTYXTEsWPEsW7EsW4gw7xyw7xubGVyaSBvbGFuIHNlcGV0bGVyaSB2ZSDDvHLDvG5sZXJpIMOnZWtpeW9ydXpcbiAgICAgIGNvbnN0IGNhcnRzID0gYXdhaXQgQ2FydC5maW5kKHtcbiAgICAgICAgXCJwcm9kdWN0cy5zZWxsZXJcIjogc2VsbGVySWQsIC8vIFNhdMSxY8SxbsSxbiDDvHLDvG7DvCBvbGFubGFyXG4gICAgICAgIFwicHJvZHVjdHMuc3RhdHVzXCI6IFwiY29tcGxldGVkXCIsIC8vIEJla2xlbWVkZSBvbGFubGFyXG4gICAgICAgIGNvbXBsZXRlZDogdHJ1ZSxcbiAgICAgIH0pXG4gICAgICAgIC5wb3B1bGF0ZShcbiAgICAgICAgICBcImJ1eWVyXCIsXG4gICAgICAgICAgXCJuYW1lIHN1cm5hbWUgZW1haWwgYWRkcmVzcyBwaG9uZU51bWJlciB6aXBDb2RlIGNpdHkgY291bnRyeVwiXG4gICAgICAgIClcbiAgICAgICAgLnBvcHVsYXRlKFwicHJvZHVjdHMucHJvZHVjdElkXCIpOyAvLyBBbMSxY8SxIGJpbGdpbGVyaW5pIGdldGlyaXlvcnV6XG5cbiAgICAgIC8vIDIuIFNhZGVjZSBzYXTEsWPEsW7EsW4gw7xyw7xubGVyaW5pIGZpbHRyZWxpeW9ydXpcbiAgICAgIGNvbnN0IHNlbGxlck9yZGVycyA9IGNhcnRzLm1hcCgoY2FydCkgPT4ge1xuICAgICAgICBjb25zdCBzZWxsZXJJdGVtcyA9IGNhcnQucHJvZHVjdHMuZmlsdGVyKChwcm9kdWN0KSA9PiB7XG4gICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIHByb2R1Y3Quc2VsbGVyLnRvU3RyaW5nKCkgPT09IHNlbGxlcklkLnRvU3RyaW5nKCkgJiZcbiAgICAgICAgICAgIHByb2R1Y3Quc3RhdHVzID09PSBcImNvbXBsZXRlZFwiXG4gICAgICAgICAgKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBjYXJ0SWQ6IGNhcnQuX2lkLFxuICAgICAgICAgIGJ1eWVyOiBjYXJ0LmJ1eWVyLFxuICAgICAgICAgIGl0ZW1zOiBzZWxsZXJJdGVtc1xuICAgICAgICAgICAgLm1hcCgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICBpZiAoIWl0ZW0ucHJvZHVjdElkKSB7XG4gICAgICAgICAgICAgICAgLy8gRcSfZXIgcHJvZHVjdElkIG51bGwgaXNlLCDDvHLDvG7DvCBhdGzEsXlvcnV6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHByb2R1Y3RJZDogaXRlbS5wcm9kdWN0SWQuX2lkLFxuICAgICAgICAgICAgICAgIHByb2R1Y3ROYW1lOiBpdGVtLnByb2R1Y3RJZC5uYW1lLFxuICAgICAgICAgICAgICAgIHByb2R1Y3RQcmljZTogaXRlbS5wcm9kdWN0SWQucHJpY2UsXG4gICAgICAgICAgICAgICAgcHJvZHVjdEltYWdlczogaXRlbS5wcm9kdWN0SWQuaW1hZ2VzLFxuICAgICAgICAgICAgICAgIHF1YW50aXR5OiBpdGVtLnF1YW50aXR5LFxuICAgICAgICAgICAgICAgIHN0YXR1czogaXRlbS5zdGF0dXMsXG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmZpbHRlcigoaXRlbSkgPT4gaXRlbSAhPT0gbnVsbCksIC8vIE51bGwgb2xhbiDDvHLDvG5sZXJpIGZpbHRyZWxpeW9ydXpcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBFxJ9lciBzYXTEsWPEsXlhIGFpdCDDvHLDvG5sZXIgdmFyc2EgZMO2bmTDvHLDvHlvcnV6XG4gICAgICByZXNcbiAgICAgICAgLnN0YXR1cygyMDApXG4gICAgICAgIC5qc29uKHNlbGxlck9yZGVycy5maWx0ZXIoKG9yZGVyKSA9PiBvcmRlci5pdGVtcy5sZW5ndGggPiAwKSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB3aGlsZSBnZXR0aW5nIHNlbGxlciBvcmRlcnM6XCIsIGVycm9yKTtcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcbiAgICAgICAgbWVzc2FnZTogXCJDYW4gbm90IGdldCBzZWxsZXIgb3JkZXJzXCIsXG4gICAgICAgIGVycm9yQ29kZTogXCJjYW5Ob3RHZXRTZWxsZXJPcmRlcnNcIixcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgcm91dGVyLnBvc3QoXG4gICAgXCIvc2VsbGVyLW9yZGVycy86Y2FydElkL3Byb2R1Y3QvOnByb2R1Y3RJZC9tYXJrLXByb2Nlc3NlZFwiLFxuICAgIFNlc3Npb24sXG4gICAgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBzZWxsZXJJZCA9IHJlcS51c2VyLl9pZDsgLy8gU2F0xLFjxLEgSUQnc2luaSBvdHVydW1kYW4gYWzEsXlvcnV6XG4gICAgICAgIGNvbnN0IHsgY2FydElkLCBwcm9kdWN0SWQgfSA9IHJlcS5wYXJhbXM7IC8vIMOccsO8biBJRCdzaVxuXG4gICAgICAgIC8vIDEuIFNhdMSxY8SxbsSxbiDDvHLDvG5sZXJpbmkgacOnZXJlbiBzZXBldHRlIGlsZ2lsaSDDvHLDvG7DvCBidWx1eW9ydXogdmUgZ8O8bmNlbGxpeW9ydXpcbiAgICAgICAgY29uc3QgY2FydCA9IGF3YWl0IENhcnQuZmluZE9uZUFuZFVwZGF0ZShcbiAgICAgICAgICB7XG4gICAgICAgICAgICBfaWQ6IGNhcnRJZCxcbiAgICAgICAgICAgIFwicHJvZHVjdHMucHJvZHVjdElkXCI6IHByb2R1Y3RJZCwgLy8gU2VwZXR0ZSDDvHLDvG4gSUQnc2luZSBnw7ZyZSBmaWx0cmVsZW1lXG4gICAgICAgICAgICBcInByb2R1Y3RzLnNlbGxlclwiOiBzZWxsZXJJZCwgLy8gU2FkZWNlIHNhdMSxY8SxbsSxbiDDvHLDvG7DvCBvbG1hbMSxXG4gICAgICAgICAgICBcInByb2R1Y3RzLnN0YXR1c1wiOiBcInBlbmRpbmdcIiwgLy8gQmVrbGVtZWRlIG9sYW4gw7xyw7xubGVyaSBidWxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgICRzZXQ6IHsgXCJwcm9kdWN0cy4kW2VsZW1lbnRdLnN0YXR1c1wiOiBcInByb2Nlc3NpbmdcIiB9LCAvLyDEsGxnaWxpIMO8csO8bsO8biBkdXJ1bXVudSBnw7xuY2VsbGVcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGFycmF5RmlsdGVyczogW1xuICAgICAgICAgICAgICB7IFwiZWxlbWVudC5wcm9kdWN0SWRcIjogcHJvZHVjdElkLCBcImVsZW1lbnQuc2VsbGVyXCI6IHNlbGxlcklkIH0sXG4gICAgICAgICAgICBdLCAvLyBTYWRlY2UgYnUgw7xyw7xuw7wgZ8O8bmNlbGxlXG4gICAgICAgICAgICBuZXc6IHRydWUsXG4gICAgICAgICAgfVxuICAgICAgICApO1xuXG4gICAgICAgIGlmICghY2FydCkge1xuICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7XG4gICAgICAgICAgICBtZXNzYWdlOiBcIk5vIHBlbmRpbmcgb3JkZXJzIGZvdW5kIGZvciB0aGlzIHNlbGxlcidzIHByb2R1Y3QuXCIsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gICAgICAgICAgbWVzc2FnZTogXCJQcm9kdWN0IGluIHRoZSBvcmRlciBoYXMgYmVlbiBtYXJrZWQgYXMgcHJvY2Vzc2VkLlwiLFxuICAgICAgICB9KTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB3aGlsZSBtYXJraW5nIHByb2R1Y3QgYXMgcHJvY2Vzc2VkOlwiLCBlcnJvcik7XG4gICAgICAgIHJlc1xuICAgICAgICAgIC5zdGF0dXMoNTAwKVxuICAgICAgICAgIC5qc29uKHsgbWVzc2FnZTogXCJFcnJvciB3aGlsZSBwcm9jZXNzaW5nIHRoZSBwcm9kdWN0IGluIHRoZSBvcmRlclwiIH0pO1xuICAgICAgfVxuICAgIH1cbiAgKTtcblxuICByb3V0ZXIucG9zdChcbiAgICBcIi9zZWxsZXItb3JkZXJzLzpjYXJ0SWQvcHJvZHVjdC86cHJvZHVjdElkL21hcmstY29tcGxldGVkXCIsXG4gICAgU2Vzc2lvbixcbiAgICBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHNlbGxlcklkID0gcmVxLnVzZXIuX2lkOyAvLyBTYXTEsWPEsSBJRCdzaVxuICAgICAgICBjb25zdCB7IGNhcnRJZCwgcHJvZHVjdElkIH0gPSByZXEucGFyYW1zO1xuXG4gICAgICAgIC8vIDEuIFNhdMSxY8SxbsSxbiDDvHLDvG5sZXJpbmkgacOnZXJlbiBzZXBldGkgYnVsdXlvcnV6IHZlIGR1cnVtdSBnw7xuY2VsbGl5b3J1elxuICAgICAgICBjb25zdCBjYXJ0ID0gYXdhaXQgQ2FydC5maW5kT25lQW5kVXBkYXRlKFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIF9pZDogY2FydElkLFxuICAgICAgICAgICAgXCJwcm9kdWN0cy5wcm9kdWN0SWRcIjogcHJvZHVjdElkLFxuICAgICAgICAgICAgXCJwcm9kdWN0cy5zZWxsZXJcIjogc2VsbGVySWQsXG4gICAgICAgICAgICBcInByb2R1Y3RzLnN0YXR1c1wiOiBcInByb2Nlc3NpbmdcIiwgLy8gxLDFn2xlbm1la3RlIG9sYW5sYXLEsSB0YW1hbWxhXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICAkc2V0OiB7IFwicHJvZHVjdHMuJFtlbGVtZW50XS5zdGF0dXNcIjogXCJjb21wbGV0ZWRcIiB9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgYXJyYXlGaWx0ZXJzOiBbXG4gICAgICAgICAgICAgIHsgXCJlbGVtZW50LnByb2R1Y3RJZFwiOiBwcm9kdWN0SWQsIFwiZWxlbWVudC5zZWxsZXJcIjogc2VsbGVySWQgfSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBuZXc6IHRydWUsXG4gICAgICAgICAgfVxuICAgICAgICApO1xuXG4gICAgICAgIGlmICghY2FydCkge1xuICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7XG4gICAgICAgICAgICBtZXNzYWdlOiBcIk5vIHByb2Nlc3Npbmcgb3JkZXJzIGZvdW5kIGZvciB0aGlzIHNlbGxlcidzIHByb2R1Y3QuXCIsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gICAgICAgICAgbWVzc2FnZTogXCJQcm9kdWN0IGluIHRoZSBvcmRlciBoYXMgYmVlbiBtYXJrZWQgYXMgY29tcGxldGVkLlwiLFxuICAgICAgICB9KTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB3aGlsZSBtYXJraW5nIHByb2R1Y3QgYXMgY29tcGxldGVkOlwiLCBlcnJvcik7XG4gICAgICAgIHJlc1xuICAgICAgICAgIC5zdGF0dXMoNTAwKVxuICAgICAgICAgIC5qc29uKHsgbWVzc2FnZTogXCJFcnJvciB3aGlsZSBjb21wbGV0aW5nIHRoZSBwcm9kdWN0IGluIHRoZSBvcmRlclwiIH0pO1xuICAgICAgfVxuICAgIH1cbiAgKTtcblxuICByb3V0ZXIucHV0KFwiL3NlbGxlci9jaGFuZ2UtcGFzc3dvcmRcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyBvbGRQYXNzd29yZCwgbmV3UGFzc3dvcmQsIGNvbmZpcm1QYXNzd29yZCB9ID0gcmVxLmJvZHk7XG4gICAgY29uc3Qgc2VsbGVyID0gcmVxLnVzZXI7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGV4aXN0aW5nU2VsbGVyID0gYXdhaXQgU2VsbGVyLmZpbmRCeUlkKHNlbGxlci5faWQpO1xuICAgICAgaWYgKCFleGlzdGluZ1NlbGxlcikge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJVc2VyIE5vdCBGb3VuZFwiLCA0MDQsIFwibm90Rm91bmRVc2VyXCIpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBpc01hdGNoUGFzc3dvcmQgPSBhd2FpdCBiY3J5cHQuY29tcGFyZShcbiAgICAgICAgb2xkUGFzc3dvcmQsXG4gICAgICAgIGV4aXN0aW5nU2VsbGVyLnBhc3N3b3JkXG4gICAgICApO1xuICAgICAgaWYgKCFpc01hdGNoUGFzc3dvcmQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIFwiSW5jb3JyZWN0IG9sZCBwYXNzd29yZFwiLFxuICAgICAgICAgIDQwNCxcbiAgICAgICAgICBcImluY29ycmVjdE9sZFBhc3N3b3JkXCJcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgaWYgKG5ld1Bhc3N3b3JkICE9PSBjb25maXJtUGFzc3dvcmQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIFwiTmV3IHBhc3N3b3JkIGFuZCBjb25maXJtIHBhc3N3b3JkIGRvIG5vdCBtYXRjaFwiLFxuICAgICAgICAgIDQwNCxcbiAgICAgICAgICBcInBhc3N3b3Jkc0RvTm90TWF0Y2hcIlxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBpc1NhbWVQYXNzd29yZCA9IGF3YWl0IGJjcnlwdC5jb21wYXJlKFxuICAgICAgICBuZXdQYXNzd29yZCxcbiAgICAgICAgZXhpc3RpbmdTZWxsZXIucGFzc3dvcmRcbiAgICAgICk7XG4gICAgICBpZiAoaXNTYW1lUGFzc3dvcmQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIFwiTmV3IFBhc3N3b3JkIGNhbm5vdCBiZSB0aGUgc2FtZSBhcyB0aGUgb2xkIHBhc3N3b3JkXCIsXG4gICAgICAgICAgNDAwLFxuICAgICAgICAgIFwic2FtZUFzT2xkUGFzc3dvcmRcIlxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICBleGlzdGluZ1NlbGxlci5wYXNzd29yZCA9IG5ld1Bhc3N3b3JkO1xuICAgICAgYXdhaXQgZXhpc3RpbmdTZWxsZXIuc2F2ZSgpO1xuICAgICAgY29uc29sZS5sb2coXCJPbGQgUGFzc3dvcmQgKHVuaGFzaGVkKTpcIiwgb2xkUGFzc3dvcmQpO1xuICAgICAgY29uc29sZS5sb2coXCJOZXcgUGFzc3dvcmQgKHVuaGFzaGVkKTpcIiwgbmV3UGFzc3dvcmQpO1xuXG4gICAgICByZXR1cm4gcmVzXG4gICAgICAgIC5zdGF0dXMoMjAwKVxuICAgICAgICAuanNvbih7IG1lc3NhZ2U6IFwiUGFzc3dvcmQgaGFzIGJlZW4gY2hhbmdlZCBzdWNjZXNzZnVsbHlcIiwgc2VsbGVyIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICByZXMuc3RhdHVzKGVycm9yLnN0YXR1c0NvZGUgfHwgNTAwKS5qc29uKHtcbiAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSB8fCBcIlBhc3N3b3JkIGNoYW5nZSBmYWlsZWRcIixcbiAgICAgICAgY29kZTogZXJyb3IuY29kZSB8fCBcInBhc3N3b3JkQ2hhbmdlRmFpbGVkXCIsXG4gICAgICB9KTtcbiAgICB9XG4gIH0pO1xuXG4gIHJvdXRlci5wb3N0KFxuICAgIFwiL3NlbGxlci9mb3Jnb3QtcGFzc3dvcmRcIixcbiAgICBmb3Jnb3RTZWxsZXJQYXNzd29yZEVtYWlsLFxuICAgIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgICAgY29uc3QgeyBlbWFpbCB9ID0gcmVxLmJvZHk7XG5cbiAgICAgIGNvbnN0IHVzZXJFbWFpbCA9IGF3YWl0IFNlbGxlci5maW5kT25lKHsgZW1haWwgfSk7XG5cbiAgICAgIG5vRXhpc3RWYXJpYWJsZSh1c2VyRW1haWwsIFwiRW1haWxcIik7XG4gICAgICByZXMuc3RhdHVzKDIwMCkuc2VuZChcIkxpbmsgaGFzIGJlZW4gc2VuZFwiKTtcbiAgICB9XG4gICk7XG5cbiAgcm91dGVyLmdldChcIi9zZWxsZXIvOmlkXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGNvbnN0IHsgaWQgfSA9IHJlcS5wYXJhbXM7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHNlbGxlcklkID0gYXdhaXQgU2VsbGVyLmZpbmRCeUlkKGlkKTtcbiAgICAgIG5vRXhpc3RWYXJpYWJsZShzZWxsZXJJZCwgXCJTZWxsZXJcIik7XG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbihzZWxsZXJJZCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgIHJlcy5zdGF0dXMoNDAwKS5qc29uKFwiRXJyb3JcIik7XG4gICAgfVxuICB9KTtcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLEtBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFNBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLE9BQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUVBLElBQUFHLFNBQUEsR0FBQUosc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFJLGFBQUEsR0FBQUwsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFLLE9BQUEsR0FBQU4sc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFNLEtBQUEsR0FBQVAsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFPLFNBQUEsR0FBQVIsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElB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","map":{"version":3,"names":["_cart","_interopRequireDefault","require","_products","_seller","_bcryptjs","_jsonwebtoken","_multer","_path","_ApiError","_CheckExistence","_RequiredCheck","_ForgotPasswordMail","_Session","_getUserIP","e","__esModule","default","upload","multer","storage","diskStorage","destination","req","file","cb","filename","originalName","originalname","fileFilter","fileTypes","extname","test","path","toLowerCase","mimetype","ApiError","uploadFields","name","maxCount","_default","router","post","getUserIp","fields","res","next","email","logo","gsmNumber","password","address","identityNumber","iban","taxOffice","legalCompanyTitle","body","checkLotsOfRequiredField","field","fieldName","files","status","json","error","send","existingSeller","Seller","findOne","documents","vergi_levhasi","sicil_gazetesi","uploadedAt","Date","seller","undefined","subMerchantType","save","user","console","log","taxNumber","isVerified","passwordConfirmed","bcrypt","compare","sellerJson","toJSON","token","jwt","sign","process","env","JWT_SECRET","get","Session","sellerId","_id","products","Products","find","length","message","put","single","phoneNumber","city","logoPath","toString","updateFields","SellerLogo","updateSeller","findByIdAndUpdate","new","carts","Cart","completed","populate","sellerOrders","map","cart","sellerItems","filter","product","cartId","buyer","items","item","productId","productName","productPrice","price","productImages","images","quantity","order","errorCode","params","findOneAndUpdate","$set","arrayFilters","oldPassword","newPassword","confirmPassword","findById","isMatchPassword","isSamePassword","statusCode","code","forgotSellerPasswordEmail","userEmail","noExistVariable","id","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["Sellers.js"],"sourcesContent":["import Cart from \"../db/cart\";\nimport Products from \"../db/products\";\nimport Seller from \"../db/seller\";\n// import Users from \"../db/users\";\nimport bcrypt from \"bcryptjs\";\nimport jwt from \"jsonwebtoken\";\nimport multer from \"multer\";\nimport path from \"path\";\nimport ApiError from \"../errors/ApiError\";\nimport { noExistVariable } from \"../helpers/CheckExistence\";\nimport { checkLotsOfRequiredField } from \"../helpers/RequiredCheck\";\nimport { forgotSellerPasswordEmail } from \"../middlewares/ForgotPasswordMail\";\nimport Session from \"../middlewares/Session\";\nimport getUserIp from \"../middlewares/getUserIP\";\n\nconst upload = multer({\n  storage: multer.diskStorage({\n    destination: (req, file, cb) => {\n      cb(null, \"public/uploads\");\n    },\n    filename: (req, file, cb) => {\n      const originalName = file.originalname;\n      cb(null, originalName);\n    },\n  }),\n  fileFilter: (req, file, cb) => {\n    const fileTypes = /jpeg|jpg|png|pdf/;\n\n    const extname = fileTypes.test(\n      path.extname(file.originalname).toLowerCase()\n    );\n\n    const mimetype = fileTypes.test(file.mimetype);\n\n    if (mimetype && extname) {\n      return cb(null, true);\n    } else {\n      cb(\n        new ApiError(\n          \"Invalid file type. Only JPEG, JPG, and PNG are allowed.\",\n          400,\n          \"InvalidFileType\"\n        )\n      );\n    }\n  },\n});\n\nconst uploadFields = [\n  { name: \"logo\", maxCount: 1 }, // SellerLogo için 1 dosya\n  { name: \"vergi_levhasi\", maxCount: 1 },\n  { name: \"sicil_gazetesi\", maxCount: 1 },\n];\n\nexport default (router) => {\n  router.post(\n    \"/seller/register/private-company\",\n    getUserIp,\n    upload.fields(uploadFields),\n    async (req, res, next) => {\n      const {\n        email,\n        name,\n        logo,\n        gsmNumber,\n        password,\n        address,\n        identityNumber,\n        iban,\n        taxOffice,\n        legalCompanyTitle,\n      } = req.body;\n\n      try {\n        checkLotsOfRequiredField([\n          { field: email, fieldName: \"E-Mail\" },\n          { field: name, fieldName: \"Name\" },\n          { field: gsmNumber, fieldName: \"Phone Number\" },\n          { field: address, fieldName: \"Address\" },\n          { field: identityNumber, fieldName: \"Identity Number\" },\n          { field: iban, fieldName: \"IBAN\" },\n          { field: taxOffice, fieldName: \"Tax Office\" },\n          { field: legalCompanyTitle, fieldName: \"Legal Company Title\" },\n        ]);\n\n        if (!req.files[\"vergi_levhasi\"] || !req.files[\"sicil_gazetesi\"]) {\n          return res\n            .status(400)\n            .json({ error: \"Vergi levhası ve Sicil gazetesi zorunludur.\" });\n        }\n      } catch (error) {\n        return res.status(400).send(error);\n      }\n\n      const existingSeller = await Seller.findOne({ email });\n      if (existingSeller) {\n        return res\n          .status(400)\n          .send(new ApiError(400, \"Bu e-posta zaten kullanılıyor\"));\n      }\n\n      const documents = [\n        {\n          vergi_levhasi: req.files[\"vergi_levhasi\"][0].path,\n          sicil_gazetesi: req.files[\"sicil_gazetesi\"][0].path,\n          uploadedAt: new Date(),\n        },\n      ];\n\n      const seller = new Seller({\n        email,\n        name,\n        gsmNumber,\n        password,\n        logo: req.files[\"logo\"] ? req.files[\"logo\"][0].path : undefined,\n        documents,\n        address,\n        identityNumber,\n        subMerchantType: \"PRIVATE_COMPANY\",\n        iban,\n        taxOffice,\n        legalCompanyTitle,\n      });\n\n      try {\n        await seller.save();\n        req.user = seller;\n        next();\n        res.status(200).json(\"Seller Oluşturuldu, onay bekleniyor.\");\n      } catch (error) {\n        console.log(error);\n        return res\n          .status(500)\n          .send(new ApiError(500, \"Kayıt işlemi sırasında hata oluştu\"));\n      }\n    }\n  );\n  router.post(\n    \"/seller/register/limited-or-joint\",\n    getUserIp,\n    upload.fields(uploadFields),\n    async (req, res, next) => {\n      const {\n        email,\n        name,\n        logo,\n        gsmNumber,\n        password,\n        address,\n        taxNumber,\n        iban,\n        taxOffice,\n        legalCompanyTitle,\n      } = req.body;\n\n      try {\n        checkLotsOfRequiredField([\n          { field: email, fieldName: \"E-Mail\" },\n          { field: name, fieldName: \"Name\" },\n          { field: gsmNumber, fieldName: \"Phone Number\" },\n          { field: address, fieldName: \"Address\" },\n          { field: taxNumber, fieldName: \"Tax Number\" },\n          { field: iban, fieldName: \"IBAN\" },\n          { field: taxOffice, fieldName: \"Tax Office\" },\n          { field: legalCompanyTitle, fieldName: \"Legal Company Title\" },\n        ]);\n\n        if (!req.files[\"vergi_levhasi\"] || !req.files[\"sicil_gazetesi\"]) {\n          return res\n            .status(400)\n            .json({ error: \"Vergi levhası ve Sicil gazetesi zorunludur.\" });\n        }\n      } catch (error) {\n        return res.status(400).send(error);\n      }\n\n      const existingSeller = await Seller.findOne({ email });\n      if (existingSeller) {\n        return res\n          .status(400)\n          .send(new ApiError(400, \"Bu e-posta zaten kullanılıyor\"));\n      }\n\n      const documents = [\n        {\n          vergi_levhasi: req.files[\"vergi_levhasi\"][0].path,\n          sicil_gazetesi: req.files[\"sicil_gazetesi\"][0].path,\n          uploadedAt: new Date(),\n        },\n      ];\n\n      const seller = new Seller({\n        email,\n        name,\n        gsmNumber,\n        password,\n        logo: req.files[\"logo\"] ? req.files[\"logo\"][0].path : undefined,\n        documents,\n        address,\n        taxNumber,\n        subMerchantType: \"LIMITED_OR_JOINT_STOCK_COMPANY\",\n        iban,\n        taxOffice,\n        legalCompanyTitle,\n      });\n\n      try {\n        await seller.save();\n        req.user = seller;\n        next();\n        res.status(200).json(\"Seller Oluşturuldu, onay bekleniyor.\");\n      } catch (error) {\n        console.log(error);\n        return res\n          .status(500)\n          .send(new ApiError(500, \"Kayıt işlemi sırasında hata oluştu\"));\n      }\n    }\n  );\n\n  router.post(\"/seller/login\", async (req, res) => {\n    const { email, password } = req.body;\n    const seller = await Seller.findOne({ email });\n\n    try {\n      checkLotsOfRequiredField([\n        { field: email, fieldName: \"E-Mail\" },\n        { field: password, fieldName: \"Password\" },\n      ]);\n    } catch (error) {\n      return res.status(400).json(error);\n    }\n\n    if (!seller) {\n      throw new ApiError(\n        \"Incorrect Password or email2\",\n        401,\n        \"userOrPasswordIncorrect\"\n      );\n    }\n    if (seller.isVerified == false) {\n      throw new ApiError(\n        \"You have to verificate your account.\",\n        401,\n        \"accountNotVerified\"\n      );\n    }\n    const passwordConfirmed = await bcrypt.compare(password, seller.password);\n    // console.log(\"kullanıcı girdisi:\", password); silinecekler\n    // console.log(\"hashlenmiş hali:\", user.password);\n\n    if (passwordConfirmed) {\n      const sellerJson = seller.toJSON();\n      const token = jwt.sign(sellerJson, process.env.JWT_SECRET);\n      res.json({\n        token: `Bearer ${token}`,\n        seller: sellerJson,\n      });\n    } else {\n      throw new ApiError(\n        \"Incorrect Password or email\",\n        401,\n        \"userOrPasswordIncorrect\"\n      );\n    }\n  });\n\n  router.get(\"/seller/products\", Session, async (req, res, next) => {\n    try {\n      const sellerId = req.user._id;\n      const products = await Products.find({ seller: sellerId });\n      if (!products || products.length === 0) {\n        return res\n          .status(400)\n          .json({ message: \"There is no such products in this user\" });\n      }\n      res.status(200).json(products);\n    } catch (error) {\n      console.log(error);\n      next(error);\n      throw new ApiError(\"There is error\", 404, \"anError\");\n    }\n  });\n\n  router.put(\n    \"/seller/update\",\n    Session,\n    upload.single(\"SellerLogo\"),\n    async (req, res) => {\n      const { phoneNumber, address, city } = req.body;\n      const seller = req.user;\n      const logoPath = req.file ? `/uploads/${req.file.filename}` : null;\n\n      try {\n        if (phoneNumber) {\n          const existingSeller = await Seller.findOne({ phoneNumber });\n          if (\n            existingSeller &&\n            existingSeller._id.toString() !== seller._id.toString()\n          ) {\n            throw new ApiError(\n              \"This phone number already using\",\n              400,\n              \"phoneNumberAlreadyUsing\"\n            );\n          }\n        }\n        // Güncellenecek alanları dinamik olarak oluştur\n        const updateFields = {\n          ...(phoneNumber && { phoneNumber }),\n          ...(address && { address }),\n          ...(city && { city }),\n          ...(logoPath && { SellerLogo: logoPath }), // Eğer logo yüklendiyse ekle\n        };\n\n        // Satıcıyı güncelle\n        const updateSeller = await Seller.findByIdAndUpdate(\n          seller._id,\n          updateFields,\n          { new: true }\n        );\n\n        // const updateSeller = await Seller.findByIdAndUpdate(\n        //   seller,\n        //   { phoneNumber, address, city },\n        //   { new: true }\n        // );\n\n        if (!updateSeller) {\n          throw new ApiError(\"Seller not found\", 400, \"notFoundSeller\");\n        }\n        return res\n          .status(200)\n          .json({ message: \"seller information has been changed\", seller });\n      } catch (error) {\n        console.log(error);\n        throw new ApiError(\n          \"Seller informations cannot change\",\n          500,\n          \"cannotChangeSellerInformation\"\n        );\n      }\n    }\n  );\n\n  router.get(\"/seller-orders/pending\", Session, async (req, res) => {\n    try {\n      const sellerId = req.user._id; // Satıcı ID'si\n\n      // 1. Satıcının ürünleri olan sepetleri ve ürünleri çekiyoruz\n      const carts = await Cart.find({\n        \"products.seller\": sellerId, // Satıcının ürünü olanlar\n        \"products.status\": \"pending\", // Beklemede olanlar\n        completed: true,\n      })\n        .populate(\n          \"buyer\",\n          \"name surname email address phoneNumber zipCode city country\"\n        )\n        .populate(\"products.productId\"); // Alıcı bilgilerini getiriyoruz\n\n      // 2. Sadece satıcının ürünlerini filtreliyoruz\n      const sellerOrders = carts.map((cart) => {\n        const sellerItems = cart.products.filter((product) => {\n          return (\n            product.seller.toString() === sellerId.toString() &&\n            product.status === \"pending\"\n          );\n        });\n\n        return {\n          cartId: cart._id,\n          buyer: cart.buyer,\n          items: sellerItems\n            .map((item) => {\n              if (!item.productId) {\n                // Eğer productId null ise, ürünü atlıyoruz\n                return null;\n              }\n\n              return {\n                productId: item.productId._id,\n                productName: item.productId.name,\n                productPrice: item.productId.price,\n                productImages: item.productId.images,\n                quantity: item.quantity,\n                status: item.status,\n              };\n            })\n            .filter((item) => item !== null), // Null olan ürünleri filtreliyoruz\n        };\n      });\n\n      // Eğer satıcıya ait ürünler varsa döndürüyoruz\n      res\n        .status(200)\n        .json(sellerOrders.filter((order) => order.items.length > 0));\n    } catch (error) {\n      console.error(\"Error while getting seller orders:\", error);\n      res.status(500).json({\n        message: \"Can not get seller orders\",\n        errorCode: \"canNotGetSellerOrders\",\n      });\n    }\n  });\n  router.get(\"/seller-orders/processing\", Session, async (req, res) => {\n    try {\n      const sellerId = req.user._id; // Satıcı ID'si\n\n      // 1. Satıcının ürünleri olan sepetleri ve ürünleri çekiyoruz\n      const carts = await Cart.find({\n        \"products.seller\": sellerId, // Satıcının ürünü olanlar\n        \"products.status\": \"processing\", // Beklemede olanlar\n        completed: true,\n      })\n        .populate(\n          \"buyer\",\n          \"name surname email address phoneNumber zipCode city country\"\n        )\n        .populate(\"products.productId\"); // Alıcı bilgilerini getiriyoruz\n\n      // 2. Sadece satıcının ürünlerini filtreliyoruz\n      const sellerOrders = carts.map((cart) => {\n        const sellerItems = cart.products.filter((product) => {\n          return (\n            product.seller.toString() === sellerId.toString() &&\n            product.status === \"processing\"\n          );\n        });\n\n        return {\n          cartId: cart._id,\n          buyer: cart.buyer,\n          items: sellerItems\n            .map((item) => {\n              if (!item.productId) {\n                // Eğer productId null ise, ürünü atlıyoruz\n                return null;\n              }\n\n              return {\n                productId: item.productId._id,\n                productName: item.productId.name,\n                productPrice: item.productId.price,\n                productImages: item.productId.images,\n                quantity: item.quantity,\n                status: item.status,\n              };\n            })\n            .filter((item) => item !== null), // Null olan ürünleri filtreliyoruz\n        };\n      });\n\n      // Eğer satıcıya ait ürünler varsa döndürüyoruz\n      res\n        .status(200)\n        .json(sellerOrders.filter((order) => order.items.length > 0));\n    } catch (error) {\n      console.error(\"Error while getting seller orders:\", error);\n      res.status(500).json({\n        message: \"Can not get seller orders\",\n        errorCode: \"canNotGetSellerOrders\",\n      });\n    }\n  });\n  router.get(\"/seller-orders/completed\", Session, async (req, res) => {\n    try {\n      const sellerId = req.user._id; // Satıcı ID'si\n\n      // 1. Satıcının ürünleri olan sepetleri ve ürünleri çekiyoruz\n      const carts = await Cart.find({\n        \"products.seller\": sellerId, // Satıcının ürünü olanlar\n        \"products.status\": \"completed\", // Beklemede olanlar\n        completed: true,\n      })\n        .populate(\n          \"buyer\",\n          \"name surname email address phoneNumber zipCode city country\"\n        )\n        .populate(\"products.productId\"); // Alıcı bilgilerini getiriyoruz\n\n      // 2. Sadece satıcının ürünlerini filtreliyoruz\n      const sellerOrders = carts.map((cart) => {\n        const sellerItems = cart.products.filter((product) => {\n          return (\n            product.seller.toString() === sellerId.toString() &&\n            product.status === \"completed\"\n          );\n        });\n\n        return {\n          cartId: cart._id,\n          buyer: cart.buyer,\n          items: sellerItems\n            .map((item) => {\n              if (!item.productId) {\n                // Eğer productId null ise, ürünü atlıyoruz\n                return null;\n              }\n\n              return {\n                productId: item.productId._id,\n                productName: item.productId.name,\n                productPrice: item.productId.price,\n                productImages: item.productId.images,\n                quantity: item.quantity,\n                status: item.status,\n              };\n            })\n            .filter((item) => item !== null), // Null olan ürünleri filtreliyoruz\n        };\n      });\n\n      // Eğer satıcıya ait ürünler varsa döndürüyoruz\n      res\n        .status(200)\n        .json(sellerOrders.filter((order) => order.items.length > 0));\n    } catch (error) {\n      console.error(\"Error while getting seller orders:\", error);\n      res.status(500).json({\n        message: \"Can not get seller orders\",\n        errorCode: \"canNotGetSellerOrders\",\n      });\n    }\n  });\n\n  router.post(\n    \"/seller-orders/:cartId/product/:productId/mark-processed\",\n    Session,\n    async (req, res) => {\n      try {\n        const sellerId = req.user._id; // Satıcı ID'sini oturumdan alıyoruz\n        const { cartId, productId } = req.params; // Ürün ID'si\n\n        // 1. Satıcının ürünlerini içeren sepette ilgili ürünü buluyoruz ve güncelliyoruz\n        const cart = await Cart.findOneAndUpdate(\n          {\n            _id: cartId,\n            \"products.productId\": productId, // Sepette ürün ID'sine göre filtreleme\n            \"products.seller\": sellerId, // Sadece satıcının ürünü olmalı\n            \"products.status\": \"pending\", // Beklemede olan ürünleri bul\n          },\n          {\n            $set: { \"products.$[element].status\": \"processing\" }, // İlgili ürünün durumunu güncelle\n          },\n          {\n            arrayFilters: [\n              { \"element.productId\": productId, \"element.seller\": sellerId },\n            ], // Sadece bu ürünü güncelle\n            new: true,\n          }\n        );\n\n        if (!cart) {\n          return res.status(404).json({\n            message: \"No pending orders found for this seller's product.\",\n          });\n        }\n\n        res.status(200).json({\n          message: \"Product in the order has been marked as processed.\",\n        });\n      } catch (error) {\n        console.error(\"Error while marking product as processed:\", error);\n        res\n          .status(500)\n          .json({ message: \"Error while processing the product in the order\" });\n      }\n    }\n  );\n\n  router.post(\n    \"/seller-orders/:cartId/product/:productId/mark-completed\",\n    Session,\n    async (req, res) => {\n      try {\n        const sellerId = req.user._id; // Satıcı ID'si\n        const { cartId, productId } = req.params;\n\n        // 1. Satıcının ürünlerini içeren sepeti buluyoruz ve durumu güncelliyoruz\n        const cart = await Cart.findOneAndUpdate(\n          {\n            _id: cartId,\n            \"products.productId\": productId,\n            \"products.seller\": sellerId,\n            \"products.status\": \"processing\", // İşlenmekte olanları tamamla\n          },\n          {\n            $set: { \"products.$[element].status\": \"completed\" },\n          },\n          {\n            arrayFilters: [\n              { \"element.productId\": productId, \"element.seller\": sellerId },\n            ],\n            new: true,\n          }\n        );\n\n        if (!cart) {\n          return res.status(404).json({\n            message: \"No processing orders found for this seller's product.\",\n          });\n        }\n\n        res.status(200).json({\n          message: \"Product in the order has been marked as completed.\",\n        });\n      } catch (error) {\n        console.error(\"Error while marking product as completed:\", error);\n        res\n          .status(500)\n          .json({ message: \"Error while completing the product in the order\" });\n      }\n    }\n  );\n\n  router.put(\"/seller/change-password\", Session, async (req, res) => {\n    const { oldPassword, newPassword, confirmPassword } = req.body;\n    const seller = req.user;\n    try {\n      const existingSeller = await Seller.findById(seller._id);\n      if (!existingSeller) {\n        throw new ApiError(\"User Not Found\", 404, \"notFoundUser\");\n      }\n\n      const isMatchPassword = await bcrypt.compare(\n        oldPassword,\n        existingSeller.password\n      );\n      if (!isMatchPassword) {\n        throw new ApiError(\n          \"Incorrect old password\",\n          404,\n          \"incorrectOldPassword\"\n        );\n      }\n\n      if (newPassword !== confirmPassword) {\n        throw new ApiError(\n          \"New password and confirm password do not match\",\n          404,\n          \"passwordsDoNotMatch\"\n        );\n      }\n\n      const isSamePassword = await bcrypt.compare(\n        newPassword,\n        existingSeller.password\n      );\n      if (isSamePassword) {\n        throw new ApiError(\n          \"New Password cannot be the same as the old password\",\n          400,\n          \"sameAsOldPassword\"\n        );\n      }\n\n      existingSeller.password = newPassword;\n      await existingSeller.save();\n      console.log(\"Old Password (unhashed):\", oldPassword);\n      console.log(\"New Password (unhashed):\", newPassword);\n\n      return res\n        .status(200)\n        .json({ message: \"Password has been changed successfully\", seller });\n    } catch (error) {\n      console.log(error);\n      res.status(error.statusCode || 500).json({\n        message: error.message || \"Password change failed\",\n        code: error.code || \"passwordChangeFailed\",\n      });\n    }\n  });\n\n  router.post(\n    \"/seller/forgot-password\",\n    forgotSellerPasswordEmail,\n    async (req, res) => {\n      const { email } = req.body;\n\n      const userEmail = await Seller.findOne({ email });\n\n      noExistVariable(userEmail, \"Email\");\n      res.status(200).send(\"Link has been send\");\n    }\n  );\n\n  router.get(\"/seller/:id\", Session, async (req, res) => {\n    const { id } = req.params;\n    try {\n      const sellerId = await Seller.findById(id);\n      noExistVariable(sellerId, \"Seller\");\n      res.status(200).json(sellerId);\n    } catch (error) {\n      console.log(error);\n      res.status(400).json(\"Error\");\n    }\n  });\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1734362476978},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/Sellers.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _cart = _interopRequireDefault(require(\"../db/cart\"));\nvar _products = _interopRequireDefault(require(\"../db/products\"));\nvar _seller = _interopRequireDefault(require(\"../db/seller\"));\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _jsonwebtoken = _interopRequireDefault(require(\"jsonwebtoken\"));\nvar _multer = _interopRequireDefault(require(\"multer\"));\nvar _path = _interopRequireDefault(require(\"path\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _CheckExistence = require(\"../helpers/CheckExistence\");\nvar _Permissions = require(\"../helpers/Permissions\");\nvar _RequiredCheck = require(\"../helpers/RequiredCheck\");\nvar _ForgotPasswordMail = require(\"../middlewares/ForgotPasswordMail\");\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nvar _getUserIP = _interopRequireDefault(require(\"../middlewares/getUserIP\"));\nvar _seller_repository = require(\"../repositories/seller_repository\");\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\n// import Users from \"../db/users\";\n\nconst upload = (0, _multer.default)({\n  storage: _multer.default.diskStorage({\n    destination: (req, file, cb) => {\n      cb(null, \"public/uploads\");\n    },\n    filename: (req, file, cb) => {\n      const originalName = file.originalname;\n      cb(null, originalName);\n    }\n  }),\n  fileFilter: (req, file, cb) => {\n    const fileTypes = /jpeg|jpg|png|pdf/;\n    const extname = fileTypes.test(_path.default.extname(file.originalname).toLowerCase());\n    const mimetype = fileTypes.test(file.mimetype);\n    if (mimetype && extname) {\n      return cb(null, true);\n    } else {\n      cb(new _ApiError.default(\"Invalid file type. Only JPEG, JPG, and PNG are allowed.\", 400, \"InvalidFileType\"));\n    }\n  }\n});\nconst uploadFields = [{\n  name: \"logo\",\n  maxCount: 1\n},\n// SellerLogo için 1 dosya\n{\n  name: \"vergi_levhasi\",\n  maxCount: 1\n}, {\n  name: \"sicil_gazetesi\",\n  maxCount: 1\n}];\nvar _default = router => {\n  router.post(\"/seller/register/private-company\", _getUserIP.default, upload.fields(uploadFields), async (req, res, next) => {\n    const {\n      email,\n      name,\n      logo,\n      gsmNumber,\n      password,\n      address,\n      identityNumber,\n      iban,\n      taxOffice,\n      legalCompanyTitle\n    } = req.body;\n    try {\n      (0, _RequiredCheck.checkLotsOfRequiredField)([{\n        field: email,\n        fieldName: \"E-Mail\"\n      }, {\n        field: name,\n        fieldName: \"Name\"\n      }, {\n        field: gsmNumber,\n        fieldName: \"Phone Number\"\n      }, {\n        field: address,\n        fieldName: \"Address\"\n      }, {\n        field: identityNumber,\n        fieldName: \"Identity Number\"\n      }, {\n        field: iban,\n        fieldName: \"IBAN\"\n      }, {\n        field: taxOffice,\n        fieldName: \"Tax Office\"\n      }, {\n        field: legalCompanyTitle,\n        fieldName: \"Legal Company Title\"\n      }]);\n      if (!req.files[\"vergi_levhasi\"] || !req.files[\"sicil_gazetesi\"]) {\n        return res.status(400).json({\n          error: \"Vergi levhası ve Sicil gazetesi zorunludur.\"\n        });\n      }\n    } catch (error) {\n      return res.status(400).send(error);\n    }\n    const existingSeller = await _seller.default.findOne({\n      email\n    });\n    if (existingSeller) {\n      return res.status(400).send(new _ApiError.default(400, \"Bu e-posta zaten kullanılıyor\"));\n    }\n    const documents = [{\n      vergi_levhasi: req.files[\"vergi_levhasi\"][0].path,\n      sicil_gazetesi: req.files[\"sicil_gazetesi\"][0].path,\n      uploadedAt: new Date()\n    }];\n    const seller = new _seller.default({\n      email,\n      name,\n      gsmNumber,\n      password,\n      logo: req.files[\"logo\"] ? req.files[\"logo\"][0].path : undefined,\n      documents,\n      address,\n      identityNumber,\n      subMerchantType: \"PRIVATE_COMPANY\",\n      iban,\n      taxOffice,\n      legalCompanyTitle\n    });\n    try {\n      await seller.save();\n      req.user = seller;\n      next();\n      res.status(200).json(\"Seller Oluşturuldu, onay bekleniyor.\");\n    } catch (error) {\n      console.log(error);\n      return res.status(500).send(new _ApiError.default(500, \"Kayıt işlemi sırasında hata oluştu\"));\n    }\n  });\n  router.post(\"/seller/register/limited-or-joint\", _getUserIP.default, upload.fields(uploadFields), async (req, res, next) => {\n    const {\n      email,\n      name,\n      logo,\n      gsmNumber,\n      password,\n      address,\n      taxNumber,\n      iban,\n      taxOffice,\n      legalCompanyTitle\n    } = req.body;\n    try {\n      (0, _RequiredCheck.checkLotsOfRequiredField)([{\n        field: email,\n        fieldName: \"E-Mail\"\n      }, {\n        field: name,\n        fieldName: \"Name\"\n      }, {\n        field: gsmNumber,\n        fieldName: \"Phone Number\"\n      }, {\n        field: address,\n        fieldName: \"Address\"\n      }, {\n        field: taxNumber,\n        fieldName: \"Tax Number\"\n      }, {\n        field: iban,\n        fieldName: \"IBAN\"\n      }, {\n        field: taxOffice,\n        fieldName: \"Tax Office\"\n      }, {\n        field: legalCompanyTitle,\n        fieldName: \"Legal Company Title\"\n      }]);\n      if (!req.files[\"vergi_levhasi\"] || !req.files[\"sicil_gazetesi\"]) {\n        return res.status(400).json({\n          error: \"Vergi levhası ve Sicil gazetesi zorunludur.\"\n        });\n      }\n    } catch (error) {\n      return res.status(400).send(error);\n    }\n    const existingSeller = await _seller.default.findOne({\n      email\n    });\n    if (existingSeller) {\n      return res.status(400).send(new _ApiError.default(400, \"Bu e-posta zaten kullanılıyor\"));\n    }\n    const documents = [{\n      vergi_levhasi: req.files[\"vergi_levhasi\"][0].path,\n      sicil_gazetesi: req.files[\"sicil_gazetesi\"][0].path,\n      uploadedAt: new Date()\n    }];\n    const seller = new _seller.default({\n      email,\n      name,\n      gsmNumber,\n      password,\n      logo: req.files[\"logo\"] ? req.files[\"logo\"][0].path : undefined,\n      documents,\n      address,\n      taxNumber,\n      subMerchantType: \"LIMITED_OR_JOINT_STOCK_COMPANY\",\n      iban,\n      taxOffice,\n      legalCompanyTitle\n    });\n    try {\n      await seller.save();\n      req.user = seller;\n      next();\n      res.status(200).json(\"Seller Oluşturuldu, onay bekleniyor.\");\n    } catch (error) {\n      console.log(error);\n      return res.status(500).send(new _ApiError.default(500, \"Kayıt işlemi sırasında hata oluştu\"));\n    }\n  });\n  router.post(\"/seller/login\", async (req, res) => {\n    const {\n      email,\n      password\n    } = req.body;\n    const seller = await _seller.default.findOne({\n      email\n    });\n    try {\n      (0, _RequiredCheck.checkLotsOfRequiredField)([{\n        field: email,\n        fieldName: \"E-Mail\"\n      }, {\n        field: password,\n        fieldName: \"Password\"\n      }]);\n    } catch (error) {\n      return res.status(400).json(error);\n    }\n    if (!seller) {\n      throw new _ApiError.default(\"Incorrect Password or email2\", 401, \"userOrPasswordIncorrect\");\n    }\n    if (seller.isVerified == false) {\n      throw new _ApiError.default(\"You have to verificate your account.\", 401, \"accountNotVerified\");\n    }\n    const passwordConfirmed = await _bcryptjs.default.compare(password, seller.password);\n    // console.log(\"kullanıcı girdisi:\", password); silinecekler\n    // console.log(\"hashlenmiş hali:\", user.password);\n\n    if (passwordConfirmed) {\n      const sellerJson = seller.toJSON();\n      const token = _jsonwebtoken.default.sign(sellerJson, process.env.JWT_SECRET);\n      res.json({\n        token: `Bearer ${token}`,\n        seller: sellerJson\n      });\n    } else {\n      throw new _ApiError.default(\"Incorrect Password or email\", 401, \"userOrPasswordIncorrect\");\n    }\n  });\n  router.get(\"/seller/products\", _Session.default, async (req, res, next) => {\n    try {\n      const sellerId = req.user._id;\n      const products = await _products.default.find({\n        seller: sellerId\n      });\n      if (!products || products.length === 0) {\n        return res.status(400).json({\n          message: \"There is no such products in this user\"\n        });\n      }\n      res.status(200).json(products);\n    } catch (error) {\n      console.log(error);\n      next(error);\n      throw new _ApiError.default(\"There is error\", 404, \"anError\");\n    }\n  });\n  router.put(\"/seller/update\", _Session.default, upload.single(\"logo\"), async (req, res) => {\n    const {\n      name,\n      gsmNumber,\n      iban,\n      address\n    } = req.body;\n    const seller = req.user;\n    try {\n      const logoPath = req.file ? `/uploads/${req.file.filename}` : null;\n      const {\n        updateSeller,\n        iyzicoResponse\n      } = await (0, _seller_repository.updateSellerInDatabase)({\n        seller,\n        name,\n        gsmNumber,\n        iban,\n        address,\n        logoPath\n      });\n\n      // if (!updateSeller || iyzicoResponse.status !== \"success\") {\n      //   throw new ApiError(\n      //     \"Seller information update failed\",\n      //     400,\n      //     \"updateFailed\"\n      //   );\n      // }\n\n      return res.status(200).json({\n        seller: updateSeller,\n        iyzicoResponse\n      });\n    } catch (error) {\n      console.error(error);\n      const errorMessage = error.response && error.response.data ? error.response.data.errorMessage : \"Seller information could not be updated\";\n      throw new _ApiError.default(errorMessage, 500, \"updateFailed\");\n    }\n  });\n\n  // router.put(\n  //   \"/seller/update\",\n  //   Session,\n  //   upload.single(\"logo\"),\n  //   async (req, res) => {\n  //     const { name, gsmNumber, iban, address } = req.body;\n  //     const seller = req.user;\n\n  //     try {\n  //       const logoPath = req.file ? `/uploads/${req.file.filename}` : null;\n\n  //       if (gsmNumber) {\n  //         const existingSeller = await Seller.findOne({ gsmNumber });\n  //         if (\n  //           existingSeller &&\n  //           existingSeller._id.toString() !== seller._id.toString()\n  //         ) {\n  //           throw new ApiError(\n  //             \"This phone number already using\",\n  //             400,\n  //             \"phoneNumberAlreadyUsing\"\n  //           );\n  //         }\n  //       }\n  //       // Güncellenecek alanları dinamik olarak oluştur\n  //       const updateFields = {\n  //         ...(name && { name }),\n  //         ...(gsmNumber && { gsmNumber }),\n  //         ...(address && { address }),\n  //         ...(iban && { iban }),\n  //         ...(logoPath && { logo: logoPath }), // Eğer logo yüklendiyse ekle\n  //       };\n  //       console.log(logoPath);\n\n  //       // Satıcıyı güncelle\n  //       const updateSeller = await Seller.findByIdAndUpdate(\n  //         seller._id,\n  //         updateFields,\n  //         { new: true }\n  //       );\n\n  //       // const updateSeller = await Seller.findByIdAndUpdate(\n  //       //   seller,\n  //       //   { phoneNumber, address, city },\n  //       //   { new: true }\n  //       // );\n\n  //       if (!updateSeller) {\n  //         throw new ApiError(\"Seller not found\", 400, \"notFoundSeller\");\n  //       }\n  //       return res\n  //         .status(200)\n  //         .json({ message: \"seller information has been changed\", seller });\n  //     } catch (error) {\n  //       console.log(error);\n  //       throw new ApiError(\n  //         \"Seller informations cannot change\",\n  //         500,\n  //         \"cannotChangeSellerInformation\"\n  //       );\n  //     }\n  //   }\n  // );\n\n  router.get(\"/seller-orders/pending\", _Session.default, async (req, res) => {\n    try {\n      const sellerId = req.user._id; // Satıcı ID'si\n      (0, _Permissions.checkPermissions)(req.user, [\"seller\"]);\n\n      // 1. Satıcının ürünleri olan sepetleri ve ürünleri çekiyoruz\n      const carts = await _cart.default.find({\n        \"products.seller\": sellerId,\n        // Satıcının ürünü olanlar\n        \"products.status\": \"pending\",\n        // Beklemede olanlar\n        completed: true\n      }).populate(\"buyer\", \"name surname email address phoneNumber zipCode city country\").populate(\"products.productId\"); // Alıcı bilgilerini getiriyoruz\n\n      // 2. Sadece satıcının ürünlerini filtreliyoruz\n      const sellerOrders = carts.map(cart => {\n        const sellerItems = cart.products.filter(product => {\n          return product.seller.toString() === sellerId.toString() && product.status === \"pending\";\n        });\n        return {\n          cartId: cart._id,\n          buyer: cart.buyer,\n          items: sellerItems.map(item => {\n            if (!item.productId) {\n              // Eğer productId null ise, ürünü atlıyoruz\n              return null;\n            }\n            return {\n              productId: item.productId._id,\n              productName: item.productId.name,\n              productPrice: item.productId.price,\n              productImages: item.productId.images,\n              quantity: item.quantity,\n              status: item.status\n            };\n          }).filter(item => item !== null) // Null olan ürünleri filtreliyoruz\n        };\n      });\n\n      // Eğer satıcıya ait ürünler varsa döndürüyoruz\n      res.status(200).json(sellerOrders.filter(order => order.items.length > 0));\n    } catch (error) {\n      console.error(\"Error while getting seller orders:\", error);\n      res.status(500).json({\n        message: \"Can not get seller orders\",\n        errorCode: \"canNotGetSellerOrders\"\n      });\n    }\n  });\n  router.get(\"/seller-orders/processing\", _Session.default, async (req, res) => {\n    try {\n      const sellerId = req.user._id; // Satıcı ID'si\n      (0, _Permissions.checkPermissions)(req.user, [\"seller\"]);\n\n      // 1. Satıcının ürünleri olan sepetleri ve ürünleri çekiyoruz\n      const carts = await _cart.default.find({\n        \"products.seller\": sellerId,\n        // Satıcının ürünü olanlar\n        \"products.status\": \"processing\",\n        // Beklemede olanlar\n        completed: true\n      }).populate(\"buyer\", \"name surname email address phoneNumber zipCode city country\").populate(\"products.productId\"); // Alıcı bilgilerini getiriyoruz\n\n      // 2. Sadece satıcının ürünlerini filtreliyoruz\n      const sellerOrders = carts.map(cart => {\n        const sellerItems = cart.products.filter(product => {\n          return product.seller.toString() === sellerId.toString() && product.status === \"processing\";\n        });\n        return {\n          cartId: cart._id,\n          buyer: cart.buyer,\n          items: sellerItems.map(item => {\n            if (!item.productId) {\n              // Eğer productId null ise, ürünü atlıyoruz\n              return null;\n            }\n            return {\n              productId: item.productId._id,\n              productName: item.productId.name,\n              productPrice: item.productId.price,\n              productImages: item.productId.images,\n              quantity: item.quantity,\n              status: item.status\n            };\n          }).filter(item => item !== null) // Null olan ürünleri filtreliyoruz\n        };\n      });\n\n      // Eğer satıcıya ait ürünler varsa döndürüyoruz\n      res.status(200).json(sellerOrders.filter(order => order.items.length > 0));\n    } catch (error) {\n      console.error(\"Error while getting seller orders:\", error);\n      res.status(500).json({\n        message: \"Can not get seller orders\",\n        errorCode: \"canNotGetSellerOrders\"\n      });\n    }\n  });\n  router.get(\"/seller-orders/completed\", _Session.default, async (req, res) => {\n    try {\n      const sellerId = req.user._id; // Satıcı ID'si\n      (0, _Permissions.checkPermissions)(req.user, [\"seller\"]);\n\n      // 1. Satıcının ürünleri olan sepetleri ve ürünleri çekiyoruz\n      const carts = await _cart.default.find({\n        \"products.seller\": sellerId,\n        // Satıcının ürünü olanlar\n        \"products.status\": \"completed\",\n        // Beklemede olanlar\n        completed: true\n      }).populate(\"buyer\", \"name surname email address phoneNumber zipCode city country\").populate(\"products.productId\"); // Alıcı bilgilerini getiriyoruz\n\n      // 2. Sadece satıcının ürünlerini filtreliyoruz\n      const sellerOrders = carts.map(cart => {\n        const sellerItems = cart.products.filter(product => {\n          return product.seller.toString() === sellerId.toString() && product.status === \"completed\";\n        });\n        return {\n          cartId: cart._id,\n          buyer: cart.buyer,\n          items: sellerItems.map(item => {\n            if (!item.productId) {\n              // Eğer productId null ise, ürünü atlıyoruz\n              return null;\n            }\n            return {\n              productId: item.productId._id,\n              productName: item.productId.name,\n              productPrice: item.productId.price,\n              productImages: item.productId.images,\n              quantity: item.quantity,\n              status: item.status\n            };\n          }).filter(item => item !== null) // Null olan ürünleri filtreliyoruz\n        };\n      });\n\n      // Eğer satıcıya ait ürünler varsa döndürüyoruz\n      res.status(200).json(sellerOrders.filter(order => order.items.length > 0));\n    } catch (error) {\n      console.error(\"Error while getting seller orders:\", error);\n      res.status(500).json({\n        message: \"Can not get seller orders\",\n        errorCode: \"canNotGetSellerOrders\"\n      });\n    }\n  });\n  router.get(\"/seller-orders/canceled\", _Session.default, async (req, res) => {\n    try {\n      const sellerId = req.user._id; // Satıcı ID'si\n      (0, _Permissions.checkPermissions)(req.user, [\"seller\"]);\n\n      // 1. Satıcının ürünleri olan sepetleri ve ürünleri çekiyoruz\n      const carts = await _cart.default.find({\n        \"products.seller\": sellerId,\n        // Satıcının ürünü olanlar\n        \"products.status\": \"canceled\",\n        // Beklemede olanlar\n        completed: true\n      }).populate(\"buyer\", \"name surname email address phoneNumber zipCode city country\").populate(\"products.productId\"); // Alıcı bilgilerini getiriyoruz\n\n      // 2. Sadece satıcının ürünlerini filtreliyoruz\n      const sellerOrders = carts.map(cart => {\n        const sellerItems = cart.products.filter(product => {\n          return product.seller.toString() === sellerId.toString() && product.status === \"canceled\";\n        });\n        return {\n          cartId: cart._id,\n          buyer: cart.buyer,\n          items: sellerItems.map(item => {\n            if (!item.productId) {\n              // Eğer productId null ise, ürünü atlıyoruz\n              return null;\n            }\n            return {\n              productId: item.productId._id,\n              productName: item.productId.name,\n              productPrice: item.productId.price,\n              productImages: item.productId.images,\n              quantity: item.quantity,\n              status: item.status\n            };\n          }).filter(item => item !== null) // Null olan ürünleri filtreliyoruz\n        };\n      });\n\n      // Eğer satıcıya ait ürünler varsa döndürüyoruz\n      res.status(200).json(sellerOrders.filter(order => order.items.length > 0));\n    } catch (error) {\n      console.log(error);\n      res.status(500).json({\n        message: \"Can not get seller orders\",\n        errorCode: \"canNotGetSellerOrders\"\n      });\n    }\n  });\n  router.post(\"/seller-orders/:cartId/product/:productId/mark-processed\", _Session.default, async (req, res) => {\n    try {\n      const sellerId = req.user._id; // Satıcı ID'sini oturumdan alıyoruz\n      const {\n        cartId,\n        productId\n      } = req.params; // Ürün ID'si\n\n      // 1. Satıcının ürünlerini içeren sepette ilgili ürünü buluyoruz ve güncelliyoruz\n      const cart = await _cart.default.findOneAndUpdate({\n        _id: cartId,\n        \"products.productId\": productId,\n        // Sepette ürün ID'sine göre filtreleme\n        \"products.seller\": sellerId,\n        // Sadece satıcının ürünü olmalı\n        \"products.status\": \"pending\" // Beklemede olan ürünleri bul\n      }, {\n        $set: {\n          \"products.$[element].status\": \"processing\"\n        } // İlgili ürünün durumunu güncelle\n      }, {\n        arrayFilters: [{\n          \"element.productId\": productId,\n          \"element.seller\": sellerId\n        }],\n        // Sadece bu ürünü güncelle\n        new: true\n      });\n      if (!cart) {\n        return res.status(404).json({\n          message: \"No pending orders found for this seller's product.\"\n        });\n      }\n      res.status(200).json({\n        message: \"Product in the order has been marked as processed.\"\n      });\n    } catch (error) {\n      console.error(\"Error while marking product as processed:\", error);\n      res.status(500).json({\n        message: \"Error while processing the product in the order\"\n      });\n    }\n  });\n  router.post(\"/seller-orders/:cartId/product/:productId/mark-completed\", _Session.default, async (req, res) => {\n    try {\n      const sellerId = req.user._id; // Satıcı ID'si\n      const {\n        cartId,\n        productId\n      } = req.params;\n\n      // 1. Satıcının ürünlerini içeren sepeti buluyoruz ve durumu güncelliyoruz\n      const cart = await _cart.default.findOneAndUpdate({\n        _id: cartId,\n        \"products.productId\": productId,\n        \"products.seller\": sellerId,\n        \"products.status\": \"processing\" // İşlenmekte olanları tamamla\n      }, {\n        $set: {\n          \"products.$[element].status\": \"completed\"\n        }\n      }, {\n        arrayFilters: [{\n          \"element.productId\": productId,\n          \"element.seller\": sellerId\n        }],\n        new: true\n      });\n      if (!cart) {\n        return res.status(404).json({\n          message: \"No processing orders found for this seller's product.\"\n        });\n      }\n      res.status(200).json({\n        message: \"Product in the order has been marked as completed.\"\n      });\n    } catch (error) {\n      console.error(\"Error while marking product as completed:\", error);\n      res.status(500).json({\n        message: \"Error while completing the product in the order\"\n      });\n    }\n  });\n  router.put(\"/seller/change-password\", _Session.default, async (req, res) => {\n    const {\n      oldPassword,\n      newPassword,\n      confirmPassword\n    } = req.body;\n    const seller = req.user;\n    try {\n      const existingSeller = await _seller.default.findById(seller._id);\n      if (!existingSeller) {\n        throw new _ApiError.default(\"User Not Found\", 404, \"notFoundUser\");\n      }\n      const isMatchPassword = await _bcryptjs.default.compare(oldPassword, existingSeller.password);\n      if (!isMatchPassword) {\n        throw new _ApiError.default(\"Incorrect old password\", 404, \"incorrectOldPassword\");\n      }\n      if (newPassword !== confirmPassword) {\n        throw new _ApiError.default(\"New password and confirm password do not match\", 404, \"passwordsDoNotMatch\");\n      }\n      const isSamePassword = await _bcryptjs.default.compare(newPassword, existingSeller.password);\n      if (isSamePassword) {\n        throw new _ApiError.default(\"New Password cannot be the same as the old password\", 400, \"sameAsOldPassword\");\n      }\n      existingSeller.password = newPassword;\n      await existingSeller.save();\n      console.log(\"Old Password (unhashed):\", oldPassword);\n      console.log(\"New Password (unhashed):\", newPassword);\n      return res.status(200).json({\n        message: \"Password has been changed successfully\",\n        seller\n      });\n    } catch (error) {\n      console.log(error);\n      res.status(error.statusCode || 500).json({\n        message: error.message || \"Password change failed\",\n        code: error.code || \"passwordChangeFailed\"\n      });\n    }\n  });\n  router.post(\"/seller/forgot-password\", _ForgotPasswordMail.forgotSellerPasswordEmail, async (req, res) => {\n    const {\n      email\n    } = req.body;\n    const userEmail = await _seller.default.findOne({\n      email\n    });\n    (0, _CheckExistence.noExistVariable)(userEmail, \"Email\");\n    res.status(200).send(\"Link has been send\");\n  });\n  router.get(\"/seller/:id\", _Session.default, async (req, res) => {\n    const {\n      id\n    } = req.params;\n    try {\n      const sellerId = await _seller.default.findById(id);\n      (0, _CheckExistence.noExistVariable)(sellerId, \"Seller\");\n      res.status(200).json(sellerId);\n    } catch (error) {\n      console.log(error);\n      res.status(400).json(\"Error\");\n    }\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfY2FydCIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX3Byb2R1Y3RzIiwiX3NlbGxlciIsIl9iY3J5cHRqcyIsIl9qc29ud2VidG9rZW4iLCJfbXVsdGVyIiwiX3BhdGgiLCJfQXBpRXJyb3IiLCJfQ2hlY2tFeGlzdGVuY2UiLCJfUGVybWlzc2lvbnMiLCJfUmVxdWlyZWRDaGVjayIsIl9Gb3Jnb3RQYXNzd29yZE1haWwiLCJfU2Vzc2lvbiIsIl9nZXRVc2VySVAiLCJfc2VsbGVyX3JlcG9zaXRvcnkiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJ1cGxvYWQiLCJtdWx0ZXIiLCJzdG9yYWdlIiwiZGlza1N0b3JhZ2UiLCJkZXN0aW5hdGlvbiIsInJlcSIsImZpbGUiLCJjYiIsImZpbGVuYW1lIiwib3JpZ2luYWxOYW1lIiwib3JpZ2luYWxuYW1lIiwiZmlsZUZpbHRlciIsImZpbGVUeXBlcyIsImV4dG5hbWUiLCJ0ZXN0IiwicGF0aCIsInRvTG93ZXJDYXNlIiwibWltZXR5cGUiLCJBcGlFcnJvciIsInVwbG9hZEZpZWxkcyIsIm5hbWUiLCJtYXhDb3VudCIsIl9kZWZhdWx0Iiwicm91dGVyIiwicG9zdCIsImdldFVzZXJJcCIsImZpZWxkcyIsInJlcyIsIm5leHQiLCJlbWFpbCIsImxvZ28iLCJnc21OdW1iZXIiLCJwYXNzd29yZCIsImFkZHJlc3MiLCJpZGVudGl0eU51bWJlciIsImliYW4iLCJ0YXhPZmZpY2UiLCJsZWdhbENvbXBhbnlUaXRsZSIsImJvZHkiLCJjaGVja0xvdHNPZlJlcXVpcmVkRmllbGQiLCJmaWVsZCIsImZpZWxkTmFtZSIsImZpbGVzIiwic3RhdHVzIiwianNvbiIsImVycm9yIiwic2VuZCIsImV4aXN0aW5nU2VsbGVyIiwiU2VsbGVyIiwiZmluZE9uZSIsImRvY3VtZW50cyIsInZlcmdpX2xldmhhc2kiLCJzaWNpbF9nYXpldGVzaSIsInVwbG9hZGVkQXQiLCJEYXRlIiwic2VsbGVyIiwidW5kZWZpbmVkIiwic3ViTWVyY2hhbnRUeXBlIiwic2F2ZSIsInVzZXIiLCJjb25zb2xlIiwibG9nIiwidGF4TnVtYmVyIiwiaXNWZXJpZmllZCIsInBhc3N3b3JkQ29uZmlybWVkIiwiYmNyeXB0IiwiY29tcGFyZSIsInNlbGxlckpzb24iLCJ0b0pTT04iLCJ0b2tlbiIsImp3dCIsInNpZ24iLCJwcm9jZXNzIiwiZW52IiwiSldUX1NFQ1JFVCIsImdldCIsIlNlc3Npb24iLCJzZWxsZXJJZCIsIl9pZCIsInByb2R1Y3RzIiwiUHJvZHVjdHMiLCJmaW5kIiwibGVuZ3RoIiwibWVzc2FnZSIsInB1dCIsInNpbmdsZSIsImxvZ29QYXRoIiwidXBkYXRlU2VsbGVyIiwiaXl6aWNvUmVzcG9uc2UiLCJ1cGRhdGVTZWxsZXJJbkRhdGFiYXNlIiwiZXJyb3JNZXNzYWdlIiwicmVzcG9uc2UiLCJkYXRhIiwiY2hlY2tQZXJtaXNzaW9ucyIsImNhcnRzIiwiQ2FydCIsImNvbXBsZXRlZCIsInBvcHVsYXRlIiwic2VsbGVyT3JkZXJzIiwibWFwIiwiY2FydCIsInNlbGxlckl0ZW1zIiwiZmlsdGVyIiwicHJvZHVjdCIsInRvU3RyaW5nIiwiY2FydElkIiwiYnV5ZXIiLCJpdGVtcyIsIml0ZW0iLCJwcm9kdWN0SWQiLCJwcm9kdWN0TmFtZSIsInByb2R1Y3RQcmljZSIsInByaWNlIiwicHJvZHVjdEltYWdlcyIsImltYWdlcyIsInF1YW50aXR5Iiwib3JkZXIiLCJlcnJvckNvZGUiLCJwYXJhbXMiLCJmaW5kT25lQW5kVXBkYXRlIiwiJHNldCIsImFycmF5RmlsdGVycyIsIm5ldyIsIm9sZFBhc3N3b3JkIiwibmV3UGFzc3dvcmQiLCJjb25maXJtUGFzc3dvcmQiLCJmaW5kQnlJZCIsImlzTWF0Y2hQYXNzd29yZCIsImlzU2FtZVBhc3N3b3JkIiwic3RhdHVzQ29kZSIsImNvZGUiLCJmb3Jnb3RTZWxsZXJQYXNzd29yZEVtYWlsIiwidXNlckVtYWlsIiwibm9FeGlzdFZhcmlhYmxlIiwiaWQiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvcm91dGVzLyIsInNvdXJjZXMiOlsiU2VsbGVycy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQ2FydCBmcm9tIFwiLi4vZGIvY2FydFwiO1xuaW1wb3J0IFByb2R1Y3RzIGZyb20gXCIuLi9kYi9wcm9kdWN0c1wiO1xuaW1wb3J0IFNlbGxlciBmcm9tIFwiLi4vZGIvc2VsbGVyXCI7XG4vLyBpbXBvcnQgVXNlcnMgZnJvbSBcIi4uL2RiL3VzZXJzXCI7XG5pbXBvcnQgYmNyeXB0IGZyb20gXCJiY3J5cHRqc1wiO1xuaW1wb3J0IGp3dCBmcm9tIFwianNvbndlYnRva2VuXCI7XG5pbXBvcnQgbXVsdGVyIGZyb20gXCJtdWx0ZXJcIjtcbmltcG9ydCBwYXRoIGZyb20gXCJwYXRoXCI7XG5pbXBvcnQgQXBpRXJyb3IgZnJvbSBcIi4uL2Vycm9ycy9BcGlFcnJvclwiO1xuaW1wb3J0IHsgbm9FeGlzdFZhcmlhYmxlIH0gZnJvbSBcIi4uL2hlbHBlcnMvQ2hlY2tFeGlzdGVuY2VcIjtcbmltcG9ydCB7IGNoZWNrUGVybWlzc2lvbnMgfSBmcm9tIFwiLi4vaGVscGVycy9QZXJtaXNzaW9uc1wiO1xuaW1wb3J0IHsgY2hlY2tMb3RzT2ZSZXF1aXJlZEZpZWxkIH0gZnJvbSBcIi4uL2hlbHBlcnMvUmVxdWlyZWRDaGVja1wiO1xuaW1wb3J0IHsgZm9yZ290U2VsbGVyUGFzc3dvcmRFbWFpbCB9IGZyb20gXCIuLi9taWRkbGV3YXJlcy9Gb3Jnb3RQYXNzd29yZE1haWxcIjtcbmltcG9ydCBTZXNzaW9uIGZyb20gXCIuLi9taWRkbGV3YXJlcy9TZXNzaW9uXCI7XG5pbXBvcnQgZ2V0VXNlcklwIGZyb20gXCIuLi9taWRkbGV3YXJlcy9nZXRVc2VySVBcIjtcbmltcG9ydCB7IHVwZGF0ZVNlbGxlckluRGF0YWJhc2UgfSBmcm9tIFwiLi4vcmVwb3NpdG9yaWVzL3NlbGxlcl9yZXBvc2l0b3J5XCI7XG5cbmNvbnN0IHVwbG9hZCA9IG11bHRlcih7XG4gIHN0b3JhZ2U6IG11bHRlci5kaXNrU3RvcmFnZSh7XG4gICAgZGVzdGluYXRpb246IChyZXEsIGZpbGUsIGNiKSA9PiB7XG4gICAgICBjYihudWxsLCBcInB1YmxpYy91cGxvYWRzXCIpO1xuICAgIH0sXG4gICAgZmlsZW5hbWU6IChyZXEsIGZpbGUsIGNiKSA9PiB7XG4gICAgICBjb25zdCBvcmlnaW5hbE5hbWUgPSBmaWxlLm9yaWdpbmFsbmFtZTtcbiAgICAgIGNiKG51bGwsIG9yaWdpbmFsTmFtZSk7XG4gICAgfSxcbiAgfSksXG4gIGZpbGVGaWx0ZXI6IChyZXEsIGZpbGUsIGNiKSA9PiB7XG4gICAgY29uc3QgZmlsZVR5cGVzID0gL2pwZWd8anBnfHBuZ3xwZGYvO1xuXG4gICAgY29uc3QgZXh0bmFtZSA9IGZpbGVUeXBlcy50ZXN0KFxuICAgICAgcGF0aC5leHRuYW1lKGZpbGUub3JpZ2luYWxuYW1lKS50b0xvd2VyQ2FzZSgpXG4gICAgKTtcblxuICAgIGNvbnN0IG1pbWV0eXBlID0gZmlsZVR5cGVzLnRlc3QoZmlsZS5taW1ldHlwZSk7XG5cbiAgICBpZiAobWltZXR5cGUgJiYgZXh0bmFtZSkge1xuICAgICAgcmV0dXJuIGNiKG51bGwsIHRydWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICBjYihcbiAgICAgICAgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIFwiSW52YWxpZCBmaWxlIHR5cGUuIE9ubHkgSlBFRywgSlBHLCBhbmQgUE5HIGFyZSBhbGxvd2VkLlwiLFxuICAgICAgICAgIDQwMCxcbiAgICAgICAgICBcIkludmFsaWRGaWxlVHlwZVwiXG4gICAgICAgIClcbiAgICAgICk7XG4gICAgfVxuICB9LFxufSk7XG5cbmNvbnN0IHVwbG9hZEZpZWxkcyA9IFtcbiAgeyBuYW1lOiBcImxvZ29cIiwgbWF4Q291bnQ6IDEgfSwgLy8gU2VsbGVyTG9nbyBpw6dpbiAxIGRvc3lhXG4gIHsgbmFtZTogXCJ2ZXJnaV9sZXZoYXNpXCIsIG1heENvdW50OiAxIH0sXG4gIHsgbmFtZTogXCJzaWNpbF9nYXpldGVzaVwiLCBtYXhDb3VudDogMSB9LFxuXTtcblxuZXhwb3J0IGRlZmF1bHQgKHJvdXRlcikgPT4ge1xuICByb3V0ZXIucG9zdChcbiAgICBcIi9zZWxsZXIvcmVnaXN0ZXIvcHJpdmF0ZS1jb21wYW55XCIsXG4gICAgZ2V0VXNlcklwLFxuICAgIHVwbG9hZC5maWVsZHModXBsb2FkRmllbGRzKSxcbiAgICBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICAgIGNvbnN0IHtcbiAgICAgICAgZW1haWwsXG4gICAgICAgIG5hbWUsXG4gICAgICAgIGxvZ28sXG4gICAgICAgIGdzbU51bWJlcixcbiAgICAgICAgcGFzc3dvcmQsXG4gICAgICAgIGFkZHJlc3MsXG4gICAgICAgIGlkZW50aXR5TnVtYmVyLFxuICAgICAgICBpYmFuLFxuICAgICAgICB0YXhPZmZpY2UsXG4gICAgICAgIGxlZ2FsQ29tcGFueVRpdGxlLFxuICAgICAgfSA9IHJlcS5ib2R5O1xuXG4gICAgICB0cnkge1xuICAgICAgICBjaGVja0xvdHNPZlJlcXVpcmVkRmllbGQoW1xuICAgICAgICAgIHsgZmllbGQ6IGVtYWlsLCBmaWVsZE5hbWU6IFwiRS1NYWlsXCIgfSxcbiAgICAgICAgICB7IGZpZWxkOiBuYW1lLCBmaWVsZE5hbWU6IFwiTmFtZVwiIH0sXG4gICAgICAgICAgeyBmaWVsZDogZ3NtTnVtYmVyLCBmaWVsZE5hbWU6IFwiUGhvbmUgTnVtYmVyXCIgfSxcbiAgICAgICAgICB7IGZpZWxkOiBhZGRyZXNzLCBmaWVsZE5hbWU6IFwiQWRkcmVzc1wiIH0sXG4gICAgICAgICAgeyBmaWVsZDogaWRlbnRpdHlOdW1iZXIsIGZpZWxkTmFtZTogXCJJZGVudGl0eSBOdW1iZXJcIiB9LFxuICAgICAgICAgIHsgZmllbGQ6IGliYW4sIGZpZWxkTmFtZTogXCJJQkFOXCIgfSxcbiAgICAgICAgICB7IGZpZWxkOiB0YXhPZmZpY2UsIGZpZWxkTmFtZTogXCJUYXggT2ZmaWNlXCIgfSxcbiAgICAgICAgICB7IGZpZWxkOiBsZWdhbENvbXBhbnlUaXRsZSwgZmllbGROYW1lOiBcIkxlZ2FsIENvbXBhbnkgVGl0bGVcIiB9LFxuICAgICAgICBdKTtcblxuICAgICAgICBpZiAoIXJlcS5maWxlc1tcInZlcmdpX2xldmhhc2lcIl0gfHwgIXJlcS5maWxlc1tcInNpY2lsX2dhemV0ZXNpXCJdKSB7XG4gICAgICAgICAgcmV0dXJuIHJlc1xuICAgICAgICAgICAgLnN0YXR1cyg0MDApXG4gICAgICAgICAgICAuanNvbih7IGVycm9yOiBcIlZlcmdpIGxldmhhc8SxIHZlIFNpY2lsIGdhemV0ZXNpIHpvcnVubHVkdXIuXCIgfSk7XG4gICAgICAgIH1cbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZChlcnJvcik7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGV4aXN0aW5nU2VsbGVyID0gYXdhaXQgU2VsbGVyLmZpbmRPbmUoeyBlbWFpbCB9KTtcbiAgICAgIGlmIChleGlzdGluZ1NlbGxlcikge1xuICAgICAgICByZXR1cm4gcmVzXG4gICAgICAgICAgLnN0YXR1cyg0MDApXG4gICAgICAgICAgLnNlbmQobmV3IEFwaUVycm9yKDQwMCwgXCJCdSBlLXBvc3RhIHphdGVuIGt1bGxhbsSxbMSxeW9yXCIpKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgZG9jdW1lbnRzID0gW1xuICAgICAgICB7XG4gICAgICAgICAgdmVyZ2lfbGV2aGFzaTogcmVxLmZpbGVzW1widmVyZ2lfbGV2aGFzaVwiXVswXS5wYXRoLFxuICAgICAgICAgIHNpY2lsX2dhemV0ZXNpOiByZXEuZmlsZXNbXCJzaWNpbF9nYXpldGVzaVwiXVswXS5wYXRoLFxuICAgICAgICAgIHVwbG9hZGVkQXQ6IG5ldyBEYXRlKCksXG4gICAgICAgIH0sXG4gICAgICBdO1xuXG4gICAgICBjb25zdCBzZWxsZXIgPSBuZXcgU2VsbGVyKHtcbiAgICAgICAgZW1haWwsXG4gICAgICAgIG5hbWUsXG4gICAgICAgIGdzbU51bWJlcixcbiAgICAgICAgcGFzc3dvcmQsXG4gICAgICAgIGxvZ286IHJlcS5maWxlc1tcImxvZ29cIl0gPyByZXEuZmlsZXNbXCJsb2dvXCJdWzBdLnBhdGggOiB1bmRlZmluZWQsXG4gICAgICAgIGRvY3VtZW50cyxcbiAgICAgICAgYWRkcmVzcyxcbiAgICAgICAgaWRlbnRpdHlOdW1iZXIsXG4gICAgICAgIHN1Yk1lcmNoYW50VHlwZTogXCJQUklWQVRFX0NPTVBBTllcIixcbiAgICAgICAgaWJhbixcbiAgICAgICAgdGF4T2ZmaWNlLFxuICAgICAgICBsZWdhbENvbXBhbnlUaXRsZSxcbiAgICAgIH0pO1xuXG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCBzZWxsZXIuc2F2ZSgpO1xuICAgICAgICByZXEudXNlciA9IHNlbGxlcjtcbiAgICAgICAgbmV4dCgpO1xuICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbihcIlNlbGxlciBPbHXFn3R1cnVsZHUsIG9uYXkgYmVrbGVuaXlvci5cIik7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICAgIHJldHVybiByZXNcbiAgICAgICAgICAuc3RhdHVzKDUwMClcbiAgICAgICAgICAuc2VuZChuZXcgQXBpRXJyb3IoNTAwLCBcIkthecSxdCBpxZ9sZW1pIHPEsXJhc8SxbmRhIGhhdGEgb2x1xZ90dVwiKSk7XG4gICAgICB9XG4gICAgfVxuICApO1xuICByb3V0ZXIucG9zdChcbiAgICBcIi9zZWxsZXIvcmVnaXN0ZXIvbGltaXRlZC1vci1qb2ludFwiLFxuICAgIGdldFVzZXJJcCxcbiAgICB1cGxvYWQuZmllbGRzKHVwbG9hZEZpZWxkcyksXG4gICAgYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIGVtYWlsLFxuICAgICAgICBuYW1lLFxuICAgICAgICBsb2dvLFxuICAgICAgICBnc21OdW1iZXIsXG4gICAgICAgIHBhc3N3b3JkLFxuICAgICAgICBhZGRyZXNzLFxuICAgICAgICB0YXhOdW1iZXIsXG4gICAgICAgIGliYW4sXG4gICAgICAgIHRheE9mZmljZSxcbiAgICAgICAgbGVnYWxDb21wYW55VGl0bGUsXG4gICAgICB9ID0gcmVxLmJvZHk7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGNoZWNrTG90c09mUmVxdWlyZWRGaWVsZChbXG4gICAgICAgICAgeyBmaWVsZDogZW1haWwsIGZpZWxkTmFtZTogXCJFLU1haWxcIiB9LFxuICAgICAgICAgIHsgZmllbGQ6IG5hbWUsIGZpZWxkTmFtZTogXCJOYW1lXCIgfSxcbiAgICAgICAgICB7IGZpZWxkOiBnc21OdW1iZXIsIGZpZWxkTmFtZTogXCJQaG9uZSBOdW1iZXJcIiB9LFxuICAgICAgICAgIHsgZmllbGQ6IGFkZHJlc3MsIGZpZWxkTmFtZTogXCJBZGRyZXNzXCIgfSxcbiAgICAgICAgICB7IGZpZWxkOiB0YXhOdW1iZXIsIGZpZWxkTmFtZTogXCJUYXggTnVtYmVyXCIgfSxcbiAgICAgICAgICB7IGZpZWxkOiBpYmFuLCBmaWVsZE5hbWU6IFwiSUJBTlwiIH0sXG4gICAgICAgICAgeyBmaWVsZDogdGF4T2ZmaWNlLCBmaWVsZE5hbWU6IFwiVGF4IE9mZmljZVwiIH0sXG4gICAgICAgICAgeyBmaWVsZDogbGVnYWxDb21wYW55VGl0bGUsIGZpZWxkTmFtZTogXCJMZWdhbCBDb21wYW55IFRpdGxlXCIgfSxcbiAgICAgICAgXSk7XG5cbiAgICAgICAgaWYgKCFyZXEuZmlsZXNbXCJ2ZXJnaV9sZXZoYXNpXCJdIHx8ICFyZXEuZmlsZXNbXCJzaWNpbF9nYXpldGVzaVwiXSkge1xuICAgICAgICAgIHJldHVybiByZXNcbiAgICAgICAgICAgIC5zdGF0dXMoNDAwKVxuICAgICAgICAgICAgLmpzb24oeyBlcnJvcjogXCJWZXJnaSBsZXZoYXPEsSB2ZSBTaWNpbCBnYXpldGVzaSB6b3J1bmx1ZHVyLlwiIH0pO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLnNlbmQoZXJyb3IpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBleGlzdGluZ1NlbGxlciA9IGF3YWl0IFNlbGxlci5maW5kT25lKHsgZW1haWwgfSk7XG4gICAgICBpZiAoZXhpc3RpbmdTZWxsZXIpIHtcbiAgICAgICAgcmV0dXJuIHJlc1xuICAgICAgICAgIC5zdGF0dXMoNDAwKVxuICAgICAgICAgIC5zZW5kKG5ldyBBcGlFcnJvcig0MDAsIFwiQnUgZS1wb3N0YSB6YXRlbiBrdWxsYW7EsWzEsXlvclwiKSk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGRvY3VtZW50cyA9IFtcbiAgICAgICAge1xuICAgICAgICAgIHZlcmdpX2xldmhhc2k6IHJlcS5maWxlc1tcInZlcmdpX2xldmhhc2lcIl1bMF0ucGF0aCxcbiAgICAgICAgICBzaWNpbF9nYXpldGVzaTogcmVxLmZpbGVzW1wic2ljaWxfZ2F6ZXRlc2lcIl1bMF0ucGF0aCxcbiAgICAgICAgICB1cGxvYWRlZEF0OiBuZXcgRGF0ZSgpLFxuICAgICAgICB9LFxuICAgICAgXTtcblxuICAgICAgY29uc3Qgc2VsbGVyID0gbmV3IFNlbGxlcih7XG4gICAgICAgIGVtYWlsLFxuICAgICAgICBuYW1lLFxuICAgICAgICBnc21OdW1iZXIsXG4gICAgICAgIHBhc3N3b3JkLFxuICAgICAgICBsb2dvOiByZXEuZmlsZXNbXCJsb2dvXCJdID8gcmVxLmZpbGVzW1wibG9nb1wiXVswXS5wYXRoIDogdW5kZWZpbmVkLFxuICAgICAgICBkb2N1bWVudHMsXG4gICAgICAgIGFkZHJlc3MsXG4gICAgICAgIHRheE51bWJlcixcbiAgICAgICAgc3ViTWVyY2hhbnRUeXBlOiBcIkxJTUlURURfT1JfSk9JTlRfU1RPQ0tfQ09NUEFOWVwiLFxuICAgICAgICBpYmFuLFxuICAgICAgICB0YXhPZmZpY2UsXG4gICAgICAgIGxlZ2FsQ29tcGFueVRpdGxlLFxuICAgICAgfSk7XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IHNlbGxlci5zYXZlKCk7XG4gICAgICAgIHJlcS51c2VyID0gc2VsbGVyO1xuICAgICAgICBuZXh0KCk7XG4gICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKFwiU2VsbGVyIE9sdcWfdHVydWxkdSwgb25heSBiZWtsZW5peW9yLlwiKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgICAgcmV0dXJuIHJlc1xuICAgICAgICAgIC5zdGF0dXMoNTAwKVxuICAgICAgICAgIC5zZW5kKG5ldyBBcGlFcnJvcig1MDAsIFwiS2F5xLF0IGnFn2xlbWkgc8SxcmFzxLFuZGEgaGF0YSBvbHXFn3R1XCIpKTtcbiAgICAgIH1cbiAgICB9XG4gICk7XG5cbiAgcm91dGVyLnBvc3QoXCIvc2VsbGVyL2xvZ2luXCIsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGNvbnN0IHsgZW1haWwsIHBhc3N3b3JkIH0gPSByZXEuYm9keTtcbiAgICBjb25zdCBzZWxsZXIgPSBhd2FpdCBTZWxsZXIuZmluZE9uZSh7IGVtYWlsIH0pO1xuXG4gICAgdHJ5IHtcbiAgICAgIGNoZWNrTG90c09mUmVxdWlyZWRGaWVsZChbXG4gICAgICAgIHsgZmllbGQ6IGVtYWlsLCBmaWVsZE5hbWU6IFwiRS1NYWlsXCIgfSxcbiAgICAgICAgeyBmaWVsZDogcGFzc3dvcmQsIGZpZWxkTmFtZTogXCJQYXNzd29yZFwiIH0sXG4gICAgICBdKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKGVycm9yKTtcbiAgICB9XG5cbiAgICBpZiAoIXNlbGxlcikge1xuICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICBcIkluY29ycmVjdCBQYXNzd29yZCBvciBlbWFpbDJcIixcbiAgICAgICAgNDAxLFxuICAgICAgICBcInVzZXJPclBhc3N3b3JkSW5jb3JyZWN0XCJcbiAgICAgICk7XG4gICAgfVxuICAgIGlmIChzZWxsZXIuaXNWZXJpZmllZCA9PSBmYWxzZSkge1xuICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICBcIllvdSBoYXZlIHRvIHZlcmlmaWNhdGUgeW91ciBhY2NvdW50LlwiLFxuICAgICAgICA0MDEsXG4gICAgICAgIFwiYWNjb3VudE5vdFZlcmlmaWVkXCJcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IHBhc3N3b3JkQ29uZmlybWVkID0gYXdhaXQgYmNyeXB0LmNvbXBhcmUocGFzc3dvcmQsIHNlbGxlci5wYXNzd29yZCk7XG4gICAgLy8gY29uc29sZS5sb2coXCJrdWxsYW7EsWPEsSBnaXJkaXNpOlwiLCBwYXNzd29yZCk7IHNpbGluZWNla2xlclxuICAgIC8vIGNvbnNvbGUubG9nKFwiaGFzaGxlbm1pxZ8gaGFsaTpcIiwgdXNlci5wYXNzd29yZCk7XG5cbiAgICBpZiAocGFzc3dvcmRDb25maXJtZWQpIHtcbiAgICAgIGNvbnN0IHNlbGxlckpzb24gPSBzZWxsZXIudG9KU09OKCk7XG4gICAgICBjb25zdCB0b2tlbiA9IGp3dC5zaWduKHNlbGxlckpzb24sIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQpO1xuICAgICAgcmVzLmpzb24oe1xuICAgICAgICB0b2tlbjogYEJlYXJlciAke3Rva2VufWAsXG4gICAgICAgIHNlbGxlcjogc2VsbGVySnNvbixcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgIFwiSW5jb3JyZWN0IFBhc3N3b3JkIG9yIGVtYWlsXCIsXG4gICAgICAgIDQwMSxcbiAgICAgICAgXCJ1c2VyT3JQYXNzd29yZEluY29ycmVjdFwiXG4gICAgICApO1xuICAgIH1cbiAgfSk7XG5cbiAgcm91dGVyLmdldChcIi9zZWxsZXIvcHJvZHVjdHNcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHNlbGxlcklkID0gcmVxLnVzZXIuX2lkO1xuICAgICAgY29uc3QgcHJvZHVjdHMgPSBhd2FpdCBQcm9kdWN0cy5maW5kKHsgc2VsbGVyOiBzZWxsZXJJZCB9KTtcbiAgICAgIGlmICghcHJvZHVjdHMgfHwgcHJvZHVjdHMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgIHJldHVybiByZXNcbiAgICAgICAgICAuc3RhdHVzKDQwMClcbiAgICAgICAgICAuanNvbih7IG1lc3NhZ2U6IFwiVGhlcmUgaXMgbm8gc3VjaCBwcm9kdWN0cyBpbiB0aGlzIHVzZXJcIiB9KTtcbiAgICAgIH1cbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHByb2R1Y3RzKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgbmV4dChlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJUaGVyZSBpcyBlcnJvclwiLCA0MDQsIFwiYW5FcnJvclwiKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJvdXRlci5wdXQoXG4gICAgXCIvc2VsbGVyL3VwZGF0ZVwiLFxuICAgIFNlc3Npb24sXG4gICAgdXBsb2FkLnNpbmdsZShcImxvZ29cIiksXG4gICAgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgICBjb25zdCB7IG5hbWUsIGdzbU51bWJlciwgaWJhbiwgYWRkcmVzcyB9ID0gcmVxLmJvZHk7XG4gICAgICBjb25zdCBzZWxsZXIgPSByZXEudXNlcjtcblxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgbG9nb1BhdGggPSByZXEuZmlsZSA/IGAvdXBsb2Fkcy8ke3JlcS5maWxlLmZpbGVuYW1lfWAgOiBudWxsO1xuICAgICAgICBjb25zdCB7IHVwZGF0ZVNlbGxlciwgaXl6aWNvUmVzcG9uc2UgfSA9IGF3YWl0IHVwZGF0ZVNlbGxlckluRGF0YWJhc2Uoe1xuICAgICAgICAgIHNlbGxlcixcbiAgICAgICAgICBuYW1lLFxuICAgICAgICAgIGdzbU51bWJlcixcbiAgICAgICAgICBpYmFuLFxuICAgICAgICAgIGFkZHJlc3MsXG4gICAgICAgICAgbG9nb1BhdGgsXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIGlmICghdXBkYXRlU2VsbGVyIHx8IGl5emljb1Jlc3BvbnNlLnN0YXR1cyAhPT0gXCJzdWNjZXNzXCIpIHtcbiAgICAgICAgLy8gICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgIC8vICAgICBcIlNlbGxlciBpbmZvcm1hdGlvbiB1cGRhdGUgZmFpbGVkXCIsXG4gICAgICAgIC8vICAgICA0MDAsXG4gICAgICAgIC8vICAgICBcInVwZGF0ZUZhaWxlZFwiXG4gICAgICAgIC8vICAgKTtcbiAgICAgICAgLy8gfVxuXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gICAgICAgICAgc2VsbGVyOiB1cGRhdGVTZWxsZXIsXG4gICAgICAgICAgaXl6aWNvUmVzcG9uc2UsXG4gICAgICAgIH0pO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9XG4gICAgICAgICAgZXJyb3IucmVzcG9uc2UgJiYgZXJyb3IucmVzcG9uc2UuZGF0YVxuICAgICAgICAgICAgPyBlcnJvci5yZXNwb25zZS5kYXRhLmVycm9yTWVzc2FnZVxuICAgICAgICAgICAgOiBcIlNlbGxlciBpbmZvcm1hdGlvbiBjb3VsZCBub3QgYmUgdXBkYXRlZFwiO1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoZXJyb3JNZXNzYWdlLCA1MDAsIFwidXBkYXRlRmFpbGVkXCIpO1xuICAgICAgfVxuICAgIH1cbiAgKTtcblxuICAvLyByb3V0ZXIucHV0KFxuICAvLyAgIFwiL3NlbGxlci91cGRhdGVcIixcbiAgLy8gICBTZXNzaW9uLFxuICAvLyAgIHVwbG9hZC5zaW5nbGUoXCJsb2dvXCIpLFxuICAvLyAgIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAvLyAgICAgY29uc3QgeyBuYW1lLCBnc21OdW1iZXIsIGliYW4sIGFkZHJlc3MgfSA9IHJlcS5ib2R5O1xuICAvLyAgICAgY29uc3Qgc2VsbGVyID0gcmVxLnVzZXI7XG5cbiAgLy8gICAgIHRyeSB7XG4gIC8vICAgICAgIGNvbnN0IGxvZ29QYXRoID0gcmVxLmZpbGUgPyBgL3VwbG9hZHMvJHtyZXEuZmlsZS5maWxlbmFtZX1gIDogbnVsbDtcblxuICAvLyAgICAgICBpZiAoZ3NtTnVtYmVyKSB7XG4gIC8vICAgICAgICAgY29uc3QgZXhpc3RpbmdTZWxsZXIgPSBhd2FpdCBTZWxsZXIuZmluZE9uZSh7IGdzbU51bWJlciB9KTtcbiAgLy8gICAgICAgICBpZiAoXG4gIC8vICAgICAgICAgICBleGlzdGluZ1NlbGxlciAmJlxuICAvLyAgICAgICAgICAgZXhpc3RpbmdTZWxsZXIuX2lkLnRvU3RyaW5nKCkgIT09IHNlbGxlci5faWQudG9TdHJpbmcoKVxuICAvLyAgICAgICAgICkge1xuICAvLyAgICAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAvLyAgICAgICAgICAgICBcIlRoaXMgcGhvbmUgbnVtYmVyIGFscmVhZHkgdXNpbmdcIixcbiAgLy8gICAgICAgICAgICAgNDAwLFxuICAvLyAgICAgICAgICAgICBcInBob25lTnVtYmVyQWxyZWFkeVVzaW5nXCJcbiAgLy8gICAgICAgICAgICk7XG4gIC8vICAgICAgICAgfVxuICAvLyAgICAgICB9XG4gIC8vICAgICAgIC8vIEfDvG5jZWxsZW5lY2VrIGFsYW5sYXLEsSBkaW5hbWlrIG9sYXJhayBvbHXFn3R1clxuICAvLyAgICAgICBjb25zdCB1cGRhdGVGaWVsZHMgPSB7XG4gIC8vICAgICAgICAgLi4uKG5hbWUgJiYgeyBuYW1lIH0pLFxuICAvLyAgICAgICAgIC4uLihnc21OdW1iZXIgJiYgeyBnc21OdW1iZXIgfSksXG4gIC8vICAgICAgICAgLi4uKGFkZHJlc3MgJiYgeyBhZGRyZXNzIH0pLFxuICAvLyAgICAgICAgIC4uLihpYmFuICYmIHsgaWJhbiB9KSxcbiAgLy8gICAgICAgICAuLi4obG9nb1BhdGggJiYgeyBsb2dvOiBsb2dvUGF0aCB9KSwgLy8gRcSfZXIgbG9nbyB5w7xrbGVuZGl5c2UgZWtsZVxuICAvLyAgICAgICB9O1xuICAvLyAgICAgICBjb25zb2xlLmxvZyhsb2dvUGF0aCk7XG5cbiAgLy8gICAgICAgLy8gU2F0xLFjxLF5xLEgZ8O8bmNlbGxlXG4gIC8vICAgICAgIGNvbnN0IHVwZGF0ZVNlbGxlciA9IGF3YWl0IFNlbGxlci5maW5kQnlJZEFuZFVwZGF0ZShcbiAgLy8gICAgICAgICBzZWxsZXIuX2lkLFxuICAvLyAgICAgICAgIHVwZGF0ZUZpZWxkcyxcbiAgLy8gICAgICAgICB7IG5ldzogdHJ1ZSB9XG4gIC8vICAgICAgICk7XG5cbiAgLy8gICAgICAgLy8gY29uc3QgdXBkYXRlU2VsbGVyID0gYXdhaXQgU2VsbGVyLmZpbmRCeUlkQW5kVXBkYXRlKFxuICAvLyAgICAgICAvLyAgIHNlbGxlcixcbiAgLy8gICAgICAgLy8gICB7IHBob25lTnVtYmVyLCBhZGRyZXNzLCBjaXR5IH0sXG4gIC8vICAgICAgIC8vICAgeyBuZXc6IHRydWUgfVxuICAvLyAgICAgICAvLyApO1xuXG4gIC8vICAgICAgIGlmICghdXBkYXRlU2VsbGVyKSB7XG4gIC8vICAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiU2VsbGVyIG5vdCBmb3VuZFwiLCA0MDAsIFwibm90Rm91bmRTZWxsZXJcIik7XG4gIC8vICAgICAgIH1cbiAgLy8gICAgICAgcmV0dXJuIHJlc1xuICAvLyAgICAgICAgIC5zdGF0dXMoMjAwKVxuICAvLyAgICAgICAgIC5qc29uKHsgbWVzc2FnZTogXCJzZWxsZXIgaW5mb3JtYXRpb24gaGFzIGJlZW4gY2hhbmdlZFwiLCBzZWxsZXIgfSk7XG4gIC8vICAgICB9IGNhdGNoIChlcnJvcikge1xuICAvLyAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gIC8vICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgLy8gICAgICAgICBcIlNlbGxlciBpbmZvcm1hdGlvbnMgY2Fubm90IGNoYW5nZVwiLFxuICAvLyAgICAgICAgIDUwMCxcbiAgLy8gICAgICAgICBcImNhbm5vdENoYW5nZVNlbGxlckluZm9ybWF0aW9uXCJcbiAgLy8gICAgICAgKTtcbiAgLy8gICAgIH1cbiAgLy8gICB9XG4gIC8vICk7XG5cbiAgcm91dGVyLmdldChcIi9zZWxsZXItb3JkZXJzL3BlbmRpbmdcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHNlbGxlcklkID0gcmVxLnVzZXIuX2lkOyAvLyBTYXTEsWPEsSBJRCdzaVxuICAgICAgY2hlY2tQZXJtaXNzaW9ucyhyZXEudXNlciwgW1wic2VsbGVyXCJdKTtcblxuICAgICAgLy8gMS4gU2F0xLFjxLFuxLFuIMO8csO8bmxlcmkgb2xhbiBzZXBldGxlcmkgdmUgw7xyw7xubGVyaSDDp2VraXlvcnV6XG4gICAgICBjb25zdCBjYXJ0cyA9IGF3YWl0IENhcnQuZmluZCh7XG4gICAgICAgIFwicHJvZHVjdHMuc2VsbGVyXCI6IHNlbGxlcklkLCAvLyBTYXTEsWPEsW7EsW4gw7xyw7xuw7wgb2xhbmxhclxuICAgICAgICBcInByb2R1Y3RzLnN0YXR1c1wiOiBcInBlbmRpbmdcIiwgLy8gQmVrbGVtZWRlIG9sYW5sYXJcbiAgICAgICAgY29tcGxldGVkOiB0cnVlLFxuICAgICAgfSlcbiAgICAgICAgLnBvcHVsYXRlKFxuICAgICAgICAgIFwiYnV5ZXJcIixcbiAgICAgICAgICBcIm5hbWUgc3VybmFtZSBlbWFpbCBhZGRyZXNzIHBob25lTnVtYmVyIHppcENvZGUgY2l0eSBjb3VudHJ5XCJcbiAgICAgICAgKVxuICAgICAgICAucG9wdWxhdGUoXCJwcm9kdWN0cy5wcm9kdWN0SWRcIik7IC8vIEFsxLFjxLEgYmlsZ2lsZXJpbmkgZ2V0aXJpeW9ydXpcblxuICAgICAgLy8gMi4gU2FkZWNlIHNhdMSxY8SxbsSxbiDDvHLDvG5sZXJpbmkgZmlsdHJlbGl5b3J1elxuICAgICAgY29uc3Qgc2VsbGVyT3JkZXJzID0gY2FydHMubWFwKChjYXJ0KSA9PiB7XG4gICAgICAgIGNvbnN0IHNlbGxlckl0ZW1zID0gY2FydC5wcm9kdWN0cy5maWx0ZXIoKHByb2R1Y3QpID0+IHtcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgcHJvZHVjdC5zZWxsZXIudG9TdHJpbmcoKSA9PT0gc2VsbGVySWQudG9TdHJpbmcoKSAmJlxuICAgICAgICAgICAgcHJvZHVjdC5zdGF0dXMgPT09IFwicGVuZGluZ1wiXG4gICAgICAgICAgKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBjYXJ0SWQ6IGNhcnQuX2lkLFxuICAgICAgICAgIGJ1eWVyOiBjYXJ0LmJ1eWVyLFxuICAgICAgICAgIGl0ZW1zOiBzZWxsZXJJdGVtc1xuICAgICAgICAgICAgLm1hcCgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICBpZiAoIWl0ZW0ucHJvZHVjdElkKSB7XG4gICAgICAgICAgICAgICAgLy8gRcSfZXIgcHJvZHVjdElkIG51bGwgaXNlLCDDvHLDvG7DvCBhdGzEsXlvcnV6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHByb2R1Y3RJZDogaXRlbS5wcm9kdWN0SWQuX2lkLFxuICAgICAgICAgICAgICAgIHByb2R1Y3ROYW1lOiBpdGVtLnByb2R1Y3RJZC5uYW1lLFxuICAgICAgICAgICAgICAgIHByb2R1Y3RQcmljZTogaXRlbS5wcm9kdWN0SWQucHJpY2UsXG4gICAgICAgICAgICAgICAgcHJvZHVjdEltYWdlczogaXRlbS5wcm9kdWN0SWQuaW1hZ2VzLFxuICAgICAgICAgICAgICAgIHF1YW50aXR5OiBpdGVtLnF1YW50aXR5LFxuICAgICAgICAgICAgICAgIHN0YXR1czogaXRlbS5zdGF0dXMsXG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmZpbHRlcigoaXRlbSkgPT4gaXRlbSAhPT0gbnVsbCksIC8vIE51bGwgb2xhbiDDvHLDvG5sZXJpIGZpbHRyZWxpeW9ydXpcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBFxJ9lciBzYXTEsWPEsXlhIGFpdCDDvHLDvG5sZXIgdmFyc2EgZMO2bmTDvHLDvHlvcnV6XG4gICAgICByZXNcbiAgICAgICAgLnN0YXR1cygyMDApXG4gICAgICAgIC5qc29uKHNlbGxlck9yZGVycy5maWx0ZXIoKG9yZGVyKSA9PiBvcmRlci5pdGVtcy5sZW5ndGggPiAwKSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB3aGlsZSBnZXR0aW5nIHNlbGxlciBvcmRlcnM6XCIsIGVycm9yKTtcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcbiAgICAgICAgbWVzc2FnZTogXCJDYW4gbm90IGdldCBzZWxsZXIgb3JkZXJzXCIsXG4gICAgICAgIGVycm9yQ29kZTogXCJjYW5Ob3RHZXRTZWxsZXJPcmRlcnNcIixcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG4gIHJvdXRlci5nZXQoXCIvc2VsbGVyLW9yZGVycy9wcm9jZXNzaW5nXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBzZWxsZXJJZCA9IHJlcS51c2VyLl9pZDsgLy8gU2F0xLFjxLEgSUQnc2lcbiAgICAgIGNoZWNrUGVybWlzc2lvbnMocmVxLnVzZXIsIFtcInNlbGxlclwiXSk7XG5cbiAgICAgIC8vIDEuIFNhdMSxY8SxbsSxbiDDvHLDvG5sZXJpIG9sYW4gc2VwZXRsZXJpIHZlIMO8csO8bmxlcmkgw6dla2l5b3J1elxuICAgICAgY29uc3QgY2FydHMgPSBhd2FpdCBDYXJ0LmZpbmQoe1xuICAgICAgICBcInByb2R1Y3RzLnNlbGxlclwiOiBzZWxsZXJJZCwgLy8gU2F0xLFjxLFuxLFuIMO8csO8bsO8IG9sYW5sYXJcbiAgICAgICAgXCJwcm9kdWN0cy5zdGF0dXNcIjogXCJwcm9jZXNzaW5nXCIsIC8vIEJla2xlbWVkZSBvbGFubGFyXG4gICAgICAgIGNvbXBsZXRlZDogdHJ1ZSxcbiAgICAgIH0pXG4gICAgICAgIC5wb3B1bGF0ZShcbiAgICAgICAgICBcImJ1eWVyXCIsXG4gICAgICAgICAgXCJuYW1lIHN1cm5hbWUgZW1haWwgYWRkcmVzcyBwaG9uZU51bWJlciB6aXBDb2RlIGNpdHkgY291bnRyeVwiXG4gICAgICAgIClcbiAgICAgICAgLnBvcHVsYXRlKFwicHJvZHVjdHMucHJvZHVjdElkXCIpOyAvLyBBbMSxY8SxIGJpbGdpbGVyaW5pIGdldGlyaXlvcnV6XG5cbiAgICAgIC8vIDIuIFNhZGVjZSBzYXTEsWPEsW7EsW4gw7xyw7xubGVyaW5pIGZpbHRyZWxpeW9ydXpcbiAgICAgIGNvbnN0IHNlbGxlck9yZGVycyA9IGNhcnRzLm1hcCgoY2FydCkgPT4ge1xuICAgICAgICBjb25zdCBzZWxsZXJJdGVtcyA9IGNhcnQucHJvZHVjdHMuZmlsdGVyKChwcm9kdWN0KSA9PiB7XG4gICAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgIHByb2R1Y3Quc2VsbGVyLnRvU3RyaW5nKCkgPT09IHNlbGxlcklkLnRvU3RyaW5nKCkgJiZcbiAgICAgICAgICAgIHByb2R1Y3Quc3RhdHVzID09PSBcInByb2Nlc3NpbmdcIlxuICAgICAgICAgICk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgY2FydElkOiBjYXJ0Ll9pZCxcbiAgICAgICAgICBidXllcjogY2FydC5idXllcixcbiAgICAgICAgICBpdGVtczogc2VsbGVySXRlbXNcbiAgICAgICAgICAgIC5tYXAoKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgaWYgKCFpdGVtLnByb2R1Y3RJZCkge1xuICAgICAgICAgICAgICAgIC8vIEXEn2VyIHByb2R1Y3RJZCBudWxsIGlzZSwgw7xyw7xuw7wgYXRsxLF5b3J1elxuICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBwcm9kdWN0SWQ6IGl0ZW0ucHJvZHVjdElkLl9pZCxcbiAgICAgICAgICAgICAgICBwcm9kdWN0TmFtZTogaXRlbS5wcm9kdWN0SWQubmFtZSxcbiAgICAgICAgICAgICAgICBwcm9kdWN0UHJpY2U6IGl0ZW0ucHJvZHVjdElkLnByaWNlLFxuICAgICAgICAgICAgICAgIHByb2R1Y3RJbWFnZXM6IGl0ZW0ucHJvZHVjdElkLmltYWdlcyxcbiAgICAgICAgICAgICAgICBxdWFudGl0eTogaXRlbS5xdWFudGl0eSxcbiAgICAgICAgICAgICAgICBzdGF0dXM6IGl0ZW0uc3RhdHVzLFxuICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIC5maWx0ZXIoKGl0ZW0pID0+IGl0ZW0gIT09IG51bGwpLCAvLyBOdWxsIG9sYW4gw7xyw7xubGVyaSBmaWx0cmVsaXlvcnV6XG4gICAgICAgIH07XG4gICAgICB9KTtcblxuICAgICAgLy8gRcSfZXIgc2F0xLFjxLF5YSBhaXQgw7xyw7xubGVyIHZhcnNhIGTDtm5kw7xyw7x5b3J1elxuICAgICAgcmVzXG4gICAgICAgIC5zdGF0dXMoMjAwKVxuICAgICAgICAuanNvbihzZWxsZXJPcmRlcnMuZmlsdGVyKChvcmRlcikgPT4gb3JkZXIuaXRlbXMubGVuZ3RoID4gMCkpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3Igd2hpbGUgZ2V0dGluZyBzZWxsZXIgb3JkZXJzOlwiLCBlcnJvcik7XG4gICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XG4gICAgICAgIG1lc3NhZ2U6IFwiQ2FuIG5vdCBnZXQgc2VsbGVyIG9yZGVyc1wiLFxuICAgICAgICBlcnJvckNvZGU6IFwiY2FuTm90R2V0U2VsbGVyT3JkZXJzXCIsXG4gICAgICB9KTtcbiAgICB9XG4gIH0pO1xuICByb3V0ZXIuZ2V0KFwiL3NlbGxlci1vcmRlcnMvY29tcGxldGVkXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBzZWxsZXJJZCA9IHJlcS51c2VyLl9pZDsgLy8gU2F0xLFjxLEgSUQnc2lcbiAgICAgIGNoZWNrUGVybWlzc2lvbnMocmVxLnVzZXIsIFtcInNlbGxlclwiXSk7XG5cbiAgICAgIC8vIDEuIFNhdMSxY8SxbsSxbiDDvHLDvG5sZXJpIG9sYW4gc2VwZXRsZXJpIHZlIMO8csO8bmxlcmkgw6dla2l5b3J1elxuICAgICAgY29uc3QgY2FydHMgPSBhd2FpdCBDYXJ0LmZpbmQoe1xuICAgICAgICBcInByb2R1Y3RzLnNlbGxlclwiOiBzZWxsZXJJZCwgLy8gU2F0xLFjxLFuxLFuIMO8csO8bsO8IG9sYW5sYXJcbiAgICAgICAgXCJwcm9kdWN0cy5zdGF0dXNcIjogXCJjb21wbGV0ZWRcIiwgLy8gQmVrbGVtZWRlIG9sYW5sYXJcbiAgICAgICAgY29tcGxldGVkOiB0cnVlLFxuICAgICAgfSlcbiAgICAgICAgLnBvcHVsYXRlKFxuICAgICAgICAgIFwiYnV5ZXJcIixcbiAgICAgICAgICBcIm5hbWUgc3VybmFtZSBlbWFpbCBhZGRyZXNzIHBob25lTnVtYmVyIHppcENvZGUgY2l0eSBjb3VudHJ5XCJcbiAgICAgICAgKVxuICAgICAgICAucG9wdWxhdGUoXCJwcm9kdWN0cy5wcm9kdWN0SWRcIik7IC8vIEFsxLFjxLEgYmlsZ2lsZXJpbmkgZ2V0aXJpeW9ydXpcblxuICAgICAgLy8gMi4gU2FkZWNlIHNhdMSxY8SxbsSxbiDDvHLDvG5sZXJpbmkgZmlsdHJlbGl5b3J1elxuICAgICAgY29uc3Qgc2VsbGVyT3JkZXJzID0gY2FydHMubWFwKChjYXJ0KSA9PiB7XG4gICAgICAgIGNvbnN0IHNlbGxlckl0ZW1zID0gY2FydC5wcm9kdWN0cy5maWx0ZXIoKHByb2R1Y3QpID0+IHtcbiAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgcHJvZHVjdC5zZWxsZXIudG9TdHJpbmcoKSA9PT0gc2VsbGVySWQudG9TdHJpbmcoKSAmJlxuICAgICAgICAgICAgcHJvZHVjdC5zdGF0dXMgPT09IFwiY29tcGxldGVkXCJcbiAgICAgICAgICApO1xuICAgICAgICB9KTtcblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGNhcnRJZDogY2FydC5faWQsXG4gICAgICAgICAgYnV5ZXI6IGNhcnQuYnV5ZXIsXG4gICAgICAgICAgaXRlbXM6IHNlbGxlckl0ZW1zXG4gICAgICAgICAgICAubWFwKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgIGlmICghaXRlbS5wcm9kdWN0SWQpIHtcbiAgICAgICAgICAgICAgICAvLyBFxJ9lciBwcm9kdWN0SWQgbnVsbCBpc2UsIMO8csO8bsO8IGF0bMSxeW9ydXpcbiAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgcHJvZHVjdElkOiBpdGVtLnByb2R1Y3RJZC5faWQsXG4gICAgICAgICAgICAgICAgcHJvZHVjdE5hbWU6IGl0ZW0ucHJvZHVjdElkLm5hbWUsXG4gICAgICAgICAgICAgICAgcHJvZHVjdFByaWNlOiBpdGVtLnByb2R1Y3RJZC5wcmljZSxcbiAgICAgICAgICAgICAgICBwcm9kdWN0SW1hZ2VzOiBpdGVtLnByb2R1Y3RJZC5pbWFnZXMsXG4gICAgICAgICAgICAgICAgcXVhbnRpdHk6IGl0ZW0ucXVhbnRpdHksXG4gICAgICAgICAgICAgICAgc3RhdHVzOiBpdGVtLnN0YXR1cyxcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuZmlsdGVyKChpdGVtKSA9PiBpdGVtICE9PSBudWxsKSwgLy8gTnVsbCBvbGFuIMO8csO8bmxlcmkgZmlsdHJlbGl5b3J1elxuICAgICAgICB9O1xuICAgICAgfSk7XG5cbiAgICAgIC8vIEXEn2VyIHNhdMSxY8SxeWEgYWl0IMO8csO8bmxlciB2YXJzYSBkw7ZuZMO8csO8eW9ydXpcbiAgICAgIHJlc1xuICAgICAgICAuc3RhdHVzKDIwMClcbiAgICAgICAgLmpzb24oc2VsbGVyT3JkZXJzLmZpbHRlcigob3JkZXIpID0+IG9yZGVyLml0ZW1zLmxlbmd0aCA+IDApKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHdoaWxlIGdldHRpbmcgc2VsbGVyIG9yZGVyczpcIiwgZXJyb3IpO1xuICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgICAgICBtZXNzYWdlOiBcIkNhbiBub3QgZ2V0IHNlbGxlciBvcmRlcnNcIixcbiAgICAgICAgZXJyb3JDb2RlOiBcImNhbk5vdEdldFNlbGxlck9yZGVyc1wiLFxuICAgICAgfSk7XG4gICAgfVxuICB9KTtcbiAgcm91dGVyLmdldChcIi9zZWxsZXItb3JkZXJzL2NhbmNlbGVkXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBzZWxsZXJJZCA9IHJlcS51c2VyLl9pZDsgLy8gU2F0xLFjxLEgSUQnc2lcbiAgICAgIGNoZWNrUGVybWlzc2lvbnMocmVxLnVzZXIsIFtcInNlbGxlclwiXSk7XG5cbiAgICAgIC8vIDEuIFNhdMSxY8SxbsSxbiDDvHLDvG5sZXJpIG9sYW4gc2VwZXRsZXJpIHZlIMO8csO8bmxlcmkgw6dla2l5b3J1elxuICAgICAgY29uc3QgY2FydHMgPSBhd2FpdCBDYXJ0LmZpbmQoe1xuICAgICAgICBcInByb2R1Y3RzLnNlbGxlclwiOiBzZWxsZXJJZCwgLy8gU2F0xLFjxLFuxLFuIMO8csO8bsO8IG9sYW5sYXJcbiAgICAgICAgXCJwcm9kdWN0cy5zdGF0dXNcIjogXCJjYW5jZWxlZFwiLCAvLyBCZWtsZW1lZGUgb2xhbmxhclxuICAgICAgICBjb21wbGV0ZWQ6IHRydWUsXG4gICAgICB9KVxuICAgICAgICAucG9wdWxhdGUoXG4gICAgICAgICAgXCJidXllclwiLFxuICAgICAgICAgIFwibmFtZSBzdXJuYW1lIGVtYWlsIGFkZHJlc3MgcGhvbmVOdW1iZXIgemlwQ29kZSBjaXR5IGNvdW50cnlcIlxuICAgICAgICApXG4gICAgICAgIC5wb3B1bGF0ZShcInByb2R1Y3RzLnByb2R1Y3RJZFwiKTsgLy8gQWzEsWPEsSBiaWxnaWxlcmluaSBnZXRpcml5b3J1elxuXG4gICAgICAvLyAyLiBTYWRlY2Ugc2F0xLFjxLFuxLFuIMO8csO8bmxlcmluaSBmaWx0cmVsaXlvcnV6XG4gICAgICBjb25zdCBzZWxsZXJPcmRlcnMgPSBjYXJ0cy5tYXAoKGNhcnQpID0+IHtcbiAgICAgICAgY29uc3Qgc2VsbGVySXRlbXMgPSBjYXJ0LnByb2R1Y3RzLmZpbHRlcigocHJvZHVjdCkgPT4ge1xuICAgICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICBwcm9kdWN0LnNlbGxlci50b1N0cmluZygpID09PSBzZWxsZXJJZC50b1N0cmluZygpICYmXG4gICAgICAgICAgICBwcm9kdWN0LnN0YXR1cyA9PT0gXCJjYW5jZWxlZFwiXG4gICAgICAgICAgKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBjYXJ0SWQ6IGNhcnQuX2lkLFxuICAgICAgICAgIGJ1eWVyOiBjYXJ0LmJ1eWVyLFxuICAgICAgICAgIGl0ZW1zOiBzZWxsZXJJdGVtc1xuICAgICAgICAgICAgLm1hcCgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICBpZiAoIWl0ZW0ucHJvZHVjdElkKSB7XG4gICAgICAgICAgICAgICAgLy8gRcSfZXIgcHJvZHVjdElkIG51bGwgaXNlLCDDvHLDvG7DvCBhdGzEsXlvcnV6XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIHByb2R1Y3RJZDogaXRlbS5wcm9kdWN0SWQuX2lkLFxuICAgICAgICAgICAgICAgIHByb2R1Y3ROYW1lOiBpdGVtLnByb2R1Y3RJZC5uYW1lLFxuICAgICAgICAgICAgICAgIHByb2R1Y3RQcmljZTogaXRlbS5wcm9kdWN0SWQucHJpY2UsXG4gICAgICAgICAgICAgICAgcHJvZHVjdEltYWdlczogaXRlbS5wcm9kdWN0SWQuaW1hZ2VzLFxuICAgICAgICAgICAgICAgIHF1YW50aXR5OiBpdGVtLnF1YW50aXR5LFxuICAgICAgICAgICAgICAgIHN0YXR1czogaXRlbS5zdGF0dXMsXG4gICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgLmZpbHRlcigoaXRlbSkgPT4gaXRlbSAhPT0gbnVsbCksIC8vIE51bGwgb2xhbiDDvHLDvG5sZXJpIGZpbHRyZWxpeW9ydXpcbiAgICAgICAgfTtcbiAgICAgIH0pO1xuXG4gICAgICAvLyBFxJ9lciBzYXTEsWPEsXlhIGFpdCDDvHLDvG5sZXIgdmFyc2EgZMO2bmTDvHLDvHlvcnV6XG4gICAgICByZXNcbiAgICAgICAgLnN0YXR1cygyMDApXG4gICAgICAgIC5qc29uKHNlbGxlck9yZGVycy5maWx0ZXIoKG9yZGVyKSA9PiBvcmRlci5pdGVtcy5sZW5ndGggPiAwKSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHtcbiAgICAgICAgbWVzc2FnZTogXCJDYW4gbm90IGdldCBzZWxsZXIgb3JkZXJzXCIsXG4gICAgICAgIGVycm9yQ29kZTogXCJjYW5Ob3RHZXRTZWxsZXJPcmRlcnNcIixcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG5cbiAgcm91dGVyLnBvc3QoXG4gICAgXCIvc2VsbGVyLW9yZGVycy86Y2FydElkL3Byb2R1Y3QvOnByb2R1Y3RJZC9tYXJrLXByb2Nlc3NlZFwiLFxuICAgIFNlc3Npb24sXG4gICAgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBzZWxsZXJJZCA9IHJlcS51c2VyLl9pZDsgLy8gU2F0xLFjxLEgSUQnc2luaSBvdHVydW1kYW4gYWzEsXlvcnV6XG4gICAgICAgIGNvbnN0IHsgY2FydElkLCBwcm9kdWN0SWQgfSA9IHJlcS5wYXJhbXM7IC8vIMOccsO8biBJRCdzaVxuXG4gICAgICAgIC8vIDEuIFNhdMSxY8SxbsSxbiDDvHLDvG5sZXJpbmkgacOnZXJlbiBzZXBldHRlIGlsZ2lsaSDDvHLDvG7DvCBidWx1eW9ydXogdmUgZ8O8bmNlbGxpeW9ydXpcbiAgICAgICAgY29uc3QgY2FydCA9IGF3YWl0IENhcnQuZmluZE9uZUFuZFVwZGF0ZShcbiAgICAgICAgICB7XG4gICAgICAgICAgICBfaWQ6IGNhcnRJZCxcbiAgICAgICAgICAgIFwicHJvZHVjdHMucHJvZHVjdElkXCI6IHByb2R1Y3RJZCwgLy8gU2VwZXR0ZSDDvHLDvG4gSUQnc2luZSBnw7ZyZSBmaWx0cmVsZW1lXG4gICAgICAgICAgICBcInByb2R1Y3RzLnNlbGxlclwiOiBzZWxsZXJJZCwgLy8gU2FkZWNlIHNhdMSxY8SxbsSxbiDDvHLDvG7DvCBvbG1hbMSxXG4gICAgICAgICAgICBcInByb2R1Y3RzLnN0YXR1c1wiOiBcInBlbmRpbmdcIiwgLy8gQmVrbGVtZWRlIG9sYW4gw7xyw7xubGVyaSBidWxcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgICRzZXQ6IHsgXCJwcm9kdWN0cy4kW2VsZW1lbnRdLnN0YXR1c1wiOiBcInByb2Nlc3NpbmdcIiB9LCAvLyDEsGxnaWxpIMO8csO8bsO8biBkdXJ1bXVudSBnw7xuY2VsbGVcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGFycmF5RmlsdGVyczogW1xuICAgICAgICAgICAgICB7IFwiZWxlbWVudC5wcm9kdWN0SWRcIjogcHJvZHVjdElkLCBcImVsZW1lbnQuc2VsbGVyXCI6IHNlbGxlcklkIH0sXG4gICAgICAgICAgICBdLCAvLyBTYWRlY2UgYnUgw7xyw7xuw7wgZ8O8bmNlbGxlXG4gICAgICAgICAgICBuZXc6IHRydWUsXG4gICAgICAgICAgfVxuICAgICAgICApO1xuXG4gICAgICAgIGlmICghY2FydCkge1xuICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7XG4gICAgICAgICAgICBtZXNzYWdlOiBcIk5vIHBlbmRpbmcgb3JkZXJzIGZvdW5kIGZvciB0aGlzIHNlbGxlcidzIHByb2R1Y3QuXCIsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gICAgICAgICAgbWVzc2FnZTogXCJQcm9kdWN0IGluIHRoZSBvcmRlciBoYXMgYmVlbiBtYXJrZWQgYXMgcHJvY2Vzc2VkLlwiLFxuICAgICAgICB9KTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB3aGlsZSBtYXJraW5nIHByb2R1Y3QgYXMgcHJvY2Vzc2VkOlwiLCBlcnJvcik7XG4gICAgICAgIHJlc1xuICAgICAgICAgIC5zdGF0dXMoNTAwKVxuICAgICAgICAgIC5qc29uKHsgbWVzc2FnZTogXCJFcnJvciB3aGlsZSBwcm9jZXNzaW5nIHRoZSBwcm9kdWN0IGluIHRoZSBvcmRlclwiIH0pO1xuICAgICAgfVxuICAgIH1cbiAgKTtcblxuICByb3V0ZXIucG9zdChcbiAgICBcIi9zZWxsZXItb3JkZXJzLzpjYXJ0SWQvcHJvZHVjdC86cHJvZHVjdElkL21hcmstY29tcGxldGVkXCIsXG4gICAgU2Vzc2lvbixcbiAgICBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHNlbGxlcklkID0gcmVxLnVzZXIuX2lkOyAvLyBTYXTEsWPEsSBJRCdzaVxuICAgICAgICBjb25zdCB7IGNhcnRJZCwgcHJvZHVjdElkIH0gPSByZXEucGFyYW1zO1xuXG4gICAgICAgIC8vIDEuIFNhdMSxY8SxbsSxbiDDvHLDvG5sZXJpbmkgacOnZXJlbiBzZXBldGkgYnVsdXlvcnV6IHZlIGR1cnVtdSBnw7xuY2VsbGl5b3J1elxuICAgICAgICBjb25zdCBjYXJ0ID0gYXdhaXQgQ2FydC5maW5kT25lQW5kVXBkYXRlKFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIF9pZDogY2FydElkLFxuICAgICAgICAgICAgXCJwcm9kdWN0cy5wcm9kdWN0SWRcIjogcHJvZHVjdElkLFxuICAgICAgICAgICAgXCJwcm9kdWN0cy5zZWxsZXJcIjogc2VsbGVySWQsXG4gICAgICAgICAgICBcInByb2R1Y3RzLnN0YXR1c1wiOiBcInByb2Nlc3NpbmdcIiwgLy8gxLDFn2xlbm1la3RlIG9sYW5sYXLEsSB0YW1hbWxhXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICAkc2V0OiB7IFwicHJvZHVjdHMuJFtlbGVtZW50XS5zdGF0dXNcIjogXCJjb21wbGV0ZWRcIiB9LFxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgYXJyYXlGaWx0ZXJzOiBbXG4gICAgICAgICAgICAgIHsgXCJlbGVtZW50LnByb2R1Y3RJZFwiOiBwcm9kdWN0SWQsIFwiZWxlbWVudC5zZWxsZXJcIjogc2VsbGVySWQgfSxcbiAgICAgICAgICAgIF0sXG4gICAgICAgICAgICBuZXc6IHRydWUsXG4gICAgICAgICAgfVxuICAgICAgICApO1xuXG4gICAgICAgIGlmICghY2FydCkge1xuICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7XG4gICAgICAgICAgICBtZXNzYWdlOiBcIk5vIHByb2Nlc3Npbmcgb3JkZXJzIGZvdW5kIGZvciB0aGlzIHNlbGxlcidzIHByb2R1Y3QuXCIsXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7XG4gICAgICAgICAgbWVzc2FnZTogXCJQcm9kdWN0IGluIHRoZSBvcmRlciBoYXMgYmVlbiBtYXJrZWQgYXMgY29tcGxldGVkLlwiLFxuICAgICAgICB9KTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB3aGlsZSBtYXJraW5nIHByb2R1Y3QgYXMgY29tcGxldGVkOlwiLCBlcnJvcik7XG4gICAgICAgIHJlc1xuICAgICAgICAgIC5zdGF0dXMoNTAwKVxuICAgICAgICAgIC5qc29uKHsgbWVzc2FnZTogXCJFcnJvciB3aGlsZSBjb21wbGV0aW5nIHRoZSBwcm9kdWN0IGluIHRoZSBvcmRlclwiIH0pO1xuICAgICAgfVxuICAgIH1cbiAgKTtcblxuICByb3V0ZXIucHV0KFwiL3NlbGxlci9jaGFuZ2UtcGFzc3dvcmRcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyBvbGRQYXNzd29yZCwgbmV3UGFzc3dvcmQsIGNvbmZpcm1QYXNzd29yZCB9ID0gcmVxLmJvZHk7XG4gICAgY29uc3Qgc2VsbGVyID0gcmVxLnVzZXI7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGV4aXN0aW5nU2VsbGVyID0gYXdhaXQgU2VsbGVyLmZpbmRCeUlkKHNlbGxlci5faWQpO1xuICAgICAgaWYgKCFleGlzdGluZ1NlbGxlcikge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJVc2VyIE5vdCBGb3VuZFwiLCA0MDQsIFwibm90Rm91bmRVc2VyXCIpO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBpc01hdGNoUGFzc3dvcmQgPSBhd2FpdCBiY3J5cHQuY29tcGFyZShcbiAgICAgICAgb2xkUGFzc3dvcmQsXG4gICAgICAgIGV4aXN0aW5nU2VsbGVyLnBhc3N3b3JkXG4gICAgICApO1xuICAgICAgaWYgKCFpc01hdGNoUGFzc3dvcmQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIFwiSW5jb3JyZWN0IG9sZCBwYXNzd29yZFwiLFxuICAgICAgICAgIDQwNCxcbiAgICAgICAgICBcImluY29ycmVjdE9sZFBhc3N3b3JkXCJcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgaWYgKG5ld1Bhc3N3b3JkICE9PSBjb25maXJtUGFzc3dvcmQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIFwiTmV3IHBhc3N3b3JkIGFuZCBjb25maXJtIHBhc3N3b3JkIGRvIG5vdCBtYXRjaFwiLFxuICAgICAgICAgIDQwNCxcbiAgICAgICAgICBcInBhc3N3b3Jkc0RvTm90TWF0Y2hcIlxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICBjb25zdCBpc1NhbWVQYXNzd29yZCA9IGF3YWl0IGJjcnlwdC5jb21wYXJlKFxuICAgICAgICBuZXdQYXNzd29yZCxcbiAgICAgICAgZXhpc3RpbmdTZWxsZXIucGFzc3dvcmRcbiAgICAgICk7XG4gICAgICBpZiAoaXNTYW1lUGFzc3dvcmQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIFwiTmV3IFBhc3N3b3JkIGNhbm5vdCBiZSB0aGUgc2FtZSBhcyB0aGUgb2xkIHBhc3N3b3JkXCIsXG4gICAgICAgICAgNDAwLFxuICAgICAgICAgIFwic2FtZUFzT2xkUGFzc3dvcmRcIlxuICAgICAgICApO1xuICAgICAgfVxuXG4gICAgICBleGlzdGluZ1NlbGxlci5wYXNzd29yZCA9IG5ld1Bhc3N3b3JkO1xuICAgICAgYXdhaXQgZXhpc3RpbmdTZWxsZXIuc2F2ZSgpO1xuICAgICAgY29uc29sZS5sb2coXCJPbGQgUGFzc3dvcmQgKHVuaGFzaGVkKTpcIiwgb2xkUGFzc3dvcmQpO1xuICAgICAgY29uc29sZS5sb2coXCJOZXcgUGFzc3dvcmQgKHVuaGFzaGVkKTpcIiwgbmV3UGFzc3dvcmQpO1xuXG4gICAgICByZXR1cm4gcmVzXG4gICAgICAgIC5zdGF0dXMoMjAwKVxuICAgICAgICAuanNvbih7IG1lc3NhZ2U6IFwiUGFzc3dvcmQgaGFzIGJlZW4gY2hhbmdlZCBzdWNjZXNzZnVsbHlcIiwgc2VsbGVyIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICByZXMuc3RhdHVzKGVycm9yLnN0YXR1c0NvZGUgfHwgNTAwKS5qc29uKHtcbiAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSB8fCBcIlBhc3N3b3JkIGNoYW5nZSBmYWlsZWRcIixcbiAgICAgICAgY29kZTogZXJyb3IuY29kZSB8fCBcInBhc3N3b3JkQ2hhbmdlRmFpbGVkXCIsXG4gICAgICB9KTtcbiAgICB9XG4gIH0pO1xuXG4gIHJvdXRlci5wb3N0KFxuICAgIFwiL3NlbGxlci9mb3Jnb3QtcGFzc3dvcmRcIixcbiAgICBmb3Jnb3RTZWxsZXJQYXNzd29yZEVtYWlsLFxuICAgIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgICAgY29uc3QgeyBlbWFpbCB9ID0gcmVxLmJvZHk7XG5cbiAgICAgIGNvbnN0IHVzZXJFbWFpbCA9IGF3YWl0IFNlbGxlci5maW5kT25lKHsgZW1haWwgfSk7XG5cbiAgICAgIG5vRXhpc3RWYXJpYWJsZSh1c2VyRW1haWwsIFwiRW1haWxcIik7XG4gICAgICByZXMuc3RhdHVzKDIwMCkuc2VuZChcIkxpbmsgaGFzIGJlZW4gc2VuZFwiKTtcbiAgICB9XG4gICk7XG5cbiAgcm91dGVyLmdldChcIi9zZWxsZXIvOmlkXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGNvbnN0IHsgaWQgfSA9IHJlcS5wYXJhbXM7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHNlbGxlcklkID0gYXdhaXQgU2VsbGVyLmZpbmRCeUlkKGlkKTtcbiAgICAgIG5vRXhpc3RWYXJpYWJsZShzZWxsZXJJZCwgXCJTZWxsZXJcIik7XG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbihzZWxsZXJJZCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgIHJlcy5zdGF0dXMoNDAwKS5qc29uKFwiRXJyb3JcIik7XG4gICAgfVxuICB9KTtcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztB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","map":{"version":3,"names":["_cart","_interopRequireDefault","require","_products","_seller","_bcryptjs","_jsonwebtoken","_multer","_path","_ApiError","_CheckExistence","_Permissions","_RequiredCheck","_ForgotPasswordMail","_Session","_getUserIP","_seller_repository","e","__esModule","default","upload","multer","storage","diskStorage","destination","req","file","cb","filename","originalName","originalname","fileFilter","fileTypes","extname","test","path","toLowerCase","mimetype","ApiError","uploadFields","name","maxCount","_default","router","post","getUserIp","fields","res","next","email","logo","gsmNumber","password","address","identityNumber","iban","taxOffice","legalCompanyTitle","body","checkLotsOfRequiredField","field","fieldName","files","status","json","error","send","existingSeller","Seller","findOne","documents","vergi_levhasi","sicil_gazetesi","uploadedAt","Date","seller","undefined","subMerchantType","save","user","console","log","taxNumber","isVerified","passwordConfirmed","bcrypt","compare","sellerJson","toJSON","token","jwt","sign","process","env","JWT_SECRET","get","Session","sellerId","_id","products","Products","find","length","message","put","single","logoPath","updateSeller","iyzicoResponse","updateSellerInDatabase","errorMessage","response","data","checkPermissions","carts","Cart","completed","populate","sellerOrders","map","cart","sellerItems","filter","product","toString","cartId","buyer","items","item","productId","productName","productPrice","price","productImages","images","quantity","order","errorCode","params","findOneAndUpdate","$set","arrayFilters","new","oldPassword","newPassword","confirmPassword","findById","isMatchPassword","isSamePassword","statusCode","code","forgotSellerPasswordEmail","userEmail","noExistVariable","id","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["Sellers.js"],"sourcesContent":["import Cart from \"../db/cart\";\nimport Products from \"../db/products\";\nimport Seller from \"../db/seller\";\n// import Users from \"../db/users\";\nimport bcrypt from \"bcryptjs\";\nimport jwt from \"jsonwebtoken\";\nimport multer from \"multer\";\nimport path from \"path\";\nimport ApiError from \"../errors/ApiError\";\nimport { noExistVariable } from \"../helpers/CheckExistence\";\nimport { checkPermissions } from \"../helpers/Permissions\";\nimport { checkLotsOfRequiredField } from \"../helpers/RequiredCheck\";\nimport { forgotSellerPasswordEmail } from \"../middlewares/ForgotPasswordMail\";\nimport Session from \"../middlewares/Session\";\nimport getUserIp from \"../middlewares/getUserIP\";\nimport { updateSellerInDatabase } from \"../repositories/seller_repository\";\n\nconst upload = multer({\n  storage: multer.diskStorage({\n    destination: (req, file, cb) => {\n      cb(null, \"public/uploads\");\n    },\n    filename: (req, file, cb) => {\n      const originalName = file.originalname;\n      cb(null, originalName);\n    },\n  }),\n  fileFilter: (req, file, cb) => {\n    const fileTypes = /jpeg|jpg|png|pdf/;\n\n    const extname = fileTypes.test(\n      path.extname(file.originalname).toLowerCase()\n    );\n\n    const mimetype = fileTypes.test(file.mimetype);\n\n    if (mimetype && extname) {\n      return cb(null, true);\n    } else {\n      cb(\n        new ApiError(\n          \"Invalid file type. Only JPEG, JPG, and PNG are allowed.\",\n          400,\n          \"InvalidFileType\"\n        )\n      );\n    }\n  },\n});\n\nconst uploadFields = [\n  { name: \"logo\", maxCount: 1 }, // SellerLogo için 1 dosya\n  { name: \"vergi_levhasi\", maxCount: 1 },\n  { name: \"sicil_gazetesi\", maxCount: 1 },\n];\n\nexport default (router) => {\n  router.post(\n    \"/seller/register/private-company\",\n    getUserIp,\n    upload.fields(uploadFields),\n    async (req, res, next) => {\n      const {\n        email,\n        name,\n        logo,\n        gsmNumber,\n        password,\n        address,\n        identityNumber,\n        iban,\n        taxOffice,\n        legalCompanyTitle,\n      } = req.body;\n\n      try {\n        checkLotsOfRequiredField([\n          { field: email, fieldName: \"E-Mail\" },\n          { field: name, fieldName: \"Name\" },\n          { field: gsmNumber, fieldName: \"Phone Number\" },\n          { field: address, fieldName: \"Address\" },\n          { field: identityNumber, fieldName: \"Identity Number\" },\n          { field: iban, fieldName: \"IBAN\" },\n          { field: taxOffice, fieldName: \"Tax Office\" },\n          { field: legalCompanyTitle, fieldName: \"Legal Company Title\" },\n        ]);\n\n        if (!req.files[\"vergi_levhasi\"] || !req.files[\"sicil_gazetesi\"]) {\n          return res\n            .status(400)\n            .json({ error: \"Vergi levhası ve Sicil gazetesi zorunludur.\" });\n        }\n      } catch (error) {\n        return res.status(400).send(error);\n      }\n\n      const existingSeller = await Seller.findOne({ email });\n      if (existingSeller) {\n        return res\n          .status(400)\n          .send(new ApiError(400, \"Bu e-posta zaten kullanılıyor\"));\n      }\n\n      const documents = [\n        {\n          vergi_levhasi: req.files[\"vergi_levhasi\"][0].path,\n          sicil_gazetesi: req.files[\"sicil_gazetesi\"][0].path,\n          uploadedAt: new Date(),\n        },\n      ];\n\n      const seller = new Seller({\n        email,\n        name,\n        gsmNumber,\n        password,\n        logo: req.files[\"logo\"] ? req.files[\"logo\"][0].path : undefined,\n        documents,\n        address,\n        identityNumber,\n        subMerchantType: \"PRIVATE_COMPANY\",\n        iban,\n        taxOffice,\n        legalCompanyTitle,\n      });\n\n      try {\n        await seller.save();\n        req.user = seller;\n        next();\n        res.status(200).json(\"Seller Oluşturuldu, onay bekleniyor.\");\n      } catch (error) {\n        console.log(error);\n        return res\n          .status(500)\n          .send(new ApiError(500, \"Kayıt işlemi sırasında hata oluştu\"));\n      }\n    }\n  );\n  router.post(\n    \"/seller/register/limited-or-joint\",\n    getUserIp,\n    upload.fields(uploadFields),\n    async (req, res, next) => {\n      const {\n        email,\n        name,\n        logo,\n        gsmNumber,\n        password,\n        address,\n        taxNumber,\n        iban,\n        taxOffice,\n        legalCompanyTitle,\n      } = req.body;\n\n      try {\n        checkLotsOfRequiredField([\n          { field: email, fieldName: \"E-Mail\" },\n          { field: name, fieldName: \"Name\" },\n          { field: gsmNumber, fieldName: \"Phone Number\" },\n          { field: address, fieldName: \"Address\" },\n          { field: taxNumber, fieldName: \"Tax Number\" },\n          { field: iban, fieldName: \"IBAN\" },\n          { field: taxOffice, fieldName: \"Tax Office\" },\n          { field: legalCompanyTitle, fieldName: \"Legal Company Title\" },\n        ]);\n\n        if (!req.files[\"vergi_levhasi\"] || !req.files[\"sicil_gazetesi\"]) {\n          return res\n            .status(400)\n            .json({ error: \"Vergi levhası ve Sicil gazetesi zorunludur.\" });\n        }\n      } catch (error) {\n        return res.status(400).send(error);\n      }\n\n      const existingSeller = await Seller.findOne({ email });\n      if (existingSeller) {\n        return res\n          .status(400)\n          .send(new ApiError(400, \"Bu e-posta zaten kullanılıyor\"));\n      }\n\n      const documents = [\n        {\n          vergi_levhasi: req.files[\"vergi_levhasi\"][0].path,\n          sicil_gazetesi: req.files[\"sicil_gazetesi\"][0].path,\n          uploadedAt: new Date(),\n        },\n      ];\n\n      const seller = new Seller({\n        email,\n        name,\n        gsmNumber,\n        password,\n        logo: req.files[\"logo\"] ? req.files[\"logo\"][0].path : undefined,\n        documents,\n        address,\n        taxNumber,\n        subMerchantType: \"LIMITED_OR_JOINT_STOCK_COMPANY\",\n        iban,\n        taxOffice,\n        legalCompanyTitle,\n      });\n\n      try {\n        await seller.save();\n        req.user = seller;\n        next();\n        res.status(200).json(\"Seller Oluşturuldu, onay bekleniyor.\");\n      } catch (error) {\n        console.log(error);\n        return res\n          .status(500)\n          .send(new ApiError(500, \"Kayıt işlemi sırasında hata oluştu\"));\n      }\n    }\n  );\n\n  router.post(\"/seller/login\", async (req, res) => {\n    const { email, password } = req.body;\n    const seller = await Seller.findOne({ email });\n\n    try {\n      checkLotsOfRequiredField([\n        { field: email, fieldName: \"E-Mail\" },\n        { field: password, fieldName: \"Password\" },\n      ]);\n    } catch (error) {\n      return res.status(400).json(error);\n    }\n\n    if (!seller) {\n      throw new ApiError(\n        \"Incorrect Password or email2\",\n        401,\n        \"userOrPasswordIncorrect\"\n      );\n    }\n    if (seller.isVerified == false) {\n      throw new ApiError(\n        \"You have to verificate your account.\",\n        401,\n        \"accountNotVerified\"\n      );\n    }\n    const passwordConfirmed = await bcrypt.compare(password, seller.password);\n    // console.log(\"kullanıcı girdisi:\", password); silinecekler\n    // console.log(\"hashlenmiş hali:\", user.password);\n\n    if (passwordConfirmed) {\n      const sellerJson = seller.toJSON();\n      const token = jwt.sign(sellerJson, process.env.JWT_SECRET);\n      res.json({\n        token: `Bearer ${token}`,\n        seller: sellerJson,\n      });\n    } else {\n      throw new ApiError(\n        \"Incorrect Password or email\",\n        401,\n        \"userOrPasswordIncorrect\"\n      );\n    }\n  });\n\n  router.get(\"/seller/products\", Session, async (req, res, next) => {\n    try {\n      const sellerId = req.user._id;\n      const products = await Products.find({ seller: sellerId });\n      if (!products || products.length === 0) {\n        return res\n          .status(400)\n          .json({ message: \"There is no such products in this user\" });\n      }\n      res.status(200).json(products);\n    } catch (error) {\n      console.log(error);\n      next(error);\n      throw new ApiError(\"There is error\", 404, \"anError\");\n    }\n  });\n\n  router.put(\n    \"/seller/update\",\n    Session,\n    upload.single(\"logo\"),\n    async (req, res) => {\n      const { name, gsmNumber, iban, address } = req.body;\n      const seller = req.user;\n\n      try {\n        const logoPath = req.file ? `/uploads/${req.file.filename}` : null;\n        const { updateSeller, iyzicoResponse } = await updateSellerInDatabase({\n          seller,\n          name,\n          gsmNumber,\n          iban,\n          address,\n          logoPath,\n        });\n\n        // if (!updateSeller || iyzicoResponse.status !== \"success\") {\n        //   throw new ApiError(\n        //     \"Seller information update failed\",\n        //     400,\n        //     \"updateFailed\"\n        //   );\n        // }\n\n        return res.status(200).json({\n          seller: updateSeller,\n          iyzicoResponse,\n        });\n      } catch (error) {\n        console.error(error);\n        const errorMessage =\n          error.response && error.response.data\n            ? error.response.data.errorMessage\n            : \"Seller information could not be updated\";\n        throw new ApiError(errorMessage, 500, \"updateFailed\");\n      }\n    }\n  );\n\n  // router.put(\n  //   \"/seller/update\",\n  //   Session,\n  //   upload.single(\"logo\"),\n  //   async (req, res) => {\n  //     const { name, gsmNumber, iban, address } = req.body;\n  //     const seller = req.user;\n\n  //     try {\n  //       const logoPath = req.file ? `/uploads/${req.file.filename}` : null;\n\n  //       if (gsmNumber) {\n  //         const existingSeller = await Seller.findOne({ gsmNumber });\n  //         if (\n  //           existingSeller &&\n  //           existingSeller._id.toString() !== seller._id.toString()\n  //         ) {\n  //           throw new ApiError(\n  //             \"This phone number already using\",\n  //             400,\n  //             \"phoneNumberAlreadyUsing\"\n  //           );\n  //         }\n  //       }\n  //       // Güncellenecek alanları dinamik olarak oluştur\n  //       const updateFields = {\n  //         ...(name && { name }),\n  //         ...(gsmNumber && { gsmNumber }),\n  //         ...(address && { address }),\n  //         ...(iban && { iban }),\n  //         ...(logoPath && { logo: logoPath }), // Eğer logo yüklendiyse ekle\n  //       };\n  //       console.log(logoPath);\n\n  //       // Satıcıyı güncelle\n  //       const updateSeller = await Seller.findByIdAndUpdate(\n  //         seller._id,\n  //         updateFields,\n  //         { new: true }\n  //       );\n\n  //       // const updateSeller = await Seller.findByIdAndUpdate(\n  //       //   seller,\n  //       //   { phoneNumber, address, city },\n  //       //   { new: true }\n  //       // );\n\n  //       if (!updateSeller) {\n  //         throw new ApiError(\"Seller not found\", 400, \"notFoundSeller\");\n  //       }\n  //       return res\n  //         .status(200)\n  //         .json({ message: \"seller information has been changed\", seller });\n  //     } catch (error) {\n  //       console.log(error);\n  //       throw new ApiError(\n  //         \"Seller informations cannot change\",\n  //         500,\n  //         \"cannotChangeSellerInformation\"\n  //       );\n  //     }\n  //   }\n  // );\n\n  router.get(\"/seller-orders/pending\", Session, async (req, res) => {\n    try {\n      const sellerId = req.user._id; // Satıcı ID'si\n      checkPermissions(req.user, [\"seller\"]);\n\n      // 1. Satıcının ürünleri olan sepetleri ve ürünleri çekiyoruz\n      const carts = await Cart.find({\n        \"products.seller\": sellerId, // Satıcının ürünü olanlar\n        \"products.status\": \"pending\", // Beklemede olanlar\n        completed: true,\n      })\n        .populate(\n          \"buyer\",\n          \"name surname email address phoneNumber zipCode city country\"\n        )\n        .populate(\"products.productId\"); // Alıcı bilgilerini getiriyoruz\n\n      // 2. Sadece satıcının ürünlerini filtreliyoruz\n      const sellerOrders = carts.map((cart) => {\n        const sellerItems = cart.products.filter((product) => {\n          return (\n            product.seller.toString() === sellerId.toString() &&\n            product.status === \"pending\"\n          );\n        });\n\n        return {\n          cartId: cart._id,\n          buyer: cart.buyer,\n          items: sellerItems\n            .map((item) => {\n              if (!item.productId) {\n                // Eğer productId null ise, ürünü atlıyoruz\n                return null;\n              }\n\n              return {\n                productId: item.productId._id,\n                productName: item.productId.name,\n                productPrice: item.productId.price,\n                productImages: item.productId.images,\n                quantity: item.quantity,\n                status: item.status,\n              };\n            })\n            .filter((item) => item !== null), // Null olan ürünleri filtreliyoruz\n        };\n      });\n\n      // Eğer satıcıya ait ürünler varsa döndürüyoruz\n      res\n        .status(200)\n        .json(sellerOrders.filter((order) => order.items.length > 0));\n    } catch (error) {\n      console.error(\"Error while getting seller orders:\", error);\n      res.status(500).json({\n        message: \"Can not get seller orders\",\n        errorCode: \"canNotGetSellerOrders\",\n      });\n    }\n  });\n  router.get(\"/seller-orders/processing\", Session, async (req, res) => {\n    try {\n      const sellerId = req.user._id; // Satıcı ID'si\n      checkPermissions(req.user, [\"seller\"]);\n\n      // 1. Satıcının ürünleri olan sepetleri ve ürünleri çekiyoruz\n      const carts = await Cart.find({\n        \"products.seller\": sellerId, // Satıcının ürünü olanlar\n        \"products.status\": \"processing\", // Beklemede olanlar\n        completed: true,\n      })\n        .populate(\n          \"buyer\",\n          \"name surname email address phoneNumber zipCode city country\"\n        )\n        .populate(\"products.productId\"); // Alıcı bilgilerini getiriyoruz\n\n      // 2. Sadece satıcının ürünlerini filtreliyoruz\n      const sellerOrders = carts.map((cart) => {\n        const sellerItems = cart.products.filter((product) => {\n          return (\n            product.seller.toString() === sellerId.toString() &&\n            product.status === \"processing\"\n          );\n        });\n\n        return {\n          cartId: cart._id,\n          buyer: cart.buyer,\n          items: sellerItems\n            .map((item) => {\n              if (!item.productId) {\n                // Eğer productId null ise, ürünü atlıyoruz\n                return null;\n              }\n\n              return {\n                productId: item.productId._id,\n                productName: item.productId.name,\n                productPrice: item.productId.price,\n                productImages: item.productId.images,\n                quantity: item.quantity,\n                status: item.status,\n              };\n            })\n            .filter((item) => item !== null), // Null olan ürünleri filtreliyoruz\n        };\n      });\n\n      // Eğer satıcıya ait ürünler varsa döndürüyoruz\n      res\n        .status(200)\n        .json(sellerOrders.filter((order) => order.items.length > 0));\n    } catch (error) {\n      console.error(\"Error while getting seller orders:\", error);\n      res.status(500).json({\n        message: \"Can not get seller orders\",\n        errorCode: \"canNotGetSellerOrders\",\n      });\n    }\n  });\n  router.get(\"/seller-orders/completed\", Session, async (req, res) => {\n    try {\n      const sellerId = req.user._id; // Satıcı ID'si\n      checkPermissions(req.user, [\"seller\"]);\n\n      // 1. Satıcının ürünleri olan sepetleri ve ürünleri çekiyoruz\n      const carts = await Cart.find({\n        \"products.seller\": sellerId, // Satıcının ürünü olanlar\n        \"products.status\": \"completed\", // Beklemede olanlar\n        completed: true,\n      })\n        .populate(\n          \"buyer\",\n          \"name surname email address phoneNumber zipCode city country\"\n        )\n        .populate(\"products.productId\"); // Alıcı bilgilerini getiriyoruz\n\n      // 2. Sadece satıcının ürünlerini filtreliyoruz\n      const sellerOrders = carts.map((cart) => {\n        const sellerItems = cart.products.filter((product) => {\n          return (\n            product.seller.toString() === sellerId.toString() &&\n            product.status === \"completed\"\n          );\n        });\n\n        return {\n          cartId: cart._id,\n          buyer: cart.buyer,\n          items: sellerItems\n            .map((item) => {\n              if (!item.productId) {\n                // Eğer productId null ise, ürünü atlıyoruz\n                return null;\n              }\n\n              return {\n                productId: item.productId._id,\n                productName: item.productId.name,\n                productPrice: item.productId.price,\n                productImages: item.productId.images,\n                quantity: item.quantity,\n                status: item.status,\n              };\n            })\n            .filter((item) => item !== null), // Null olan ürünleri filtreliyoruz\n        };\n      });\n\n      // Eğer satıcıya ait ürünler varsa döndürüyoruz\n      res\n        .status(200)\n        .json(sellerOrders.filter((order) => order.items.length > 0));\n    } catch (error) {\n      console.error(\"Error while getting seller orders:\", error);\n      res.status(500).json({\n        message: \"Can not get seller orders\",\n        errorCode: \"canNotGetSellerOrders\",\n      });\n    }\n  });\n  router.get(\"/seller-orders/canceled\", Session, async (req, res) => {\n    try {\n      const sellerId = req.user._id; // Satıcı ID'si\n      checkPermissions(req.user, [\"seller\"]);\n\n      // 1. Satıcının ürünleri olan sepetleri ve ürünleri çekiyoruz\n      const carts = await Cart.find({\n        \"products.seller\": sellerId, // Satıcının ürünü olanlar\n        \"products.status\": \"canceled\", // Beklemede olanlar\n        completed: true,\n      })\n        .populate(\n          \"buyer\",\n          \"name surname email address phoneNumber zipCode city country\"\n        )\n        .populate(\"products.productId\"); // Alıcı bilgilerini getiriyoruz\n\n      // 2. Sadece satıcının ürünlerini filtreliyoruz\n      const sellerOrders = carts.map((cart) => {\n        const sellerItems = cart.products.filter((product) => {\n          return (\n            product.seller.toString() === sellerId.toString() &&\n            product.status === \"canceled\"\n          );\n        });\n\n        return {\n          cartId: cart._id,\n          buyer: cart.buyer,\n          items: sellerItems\n            .map((item) => {\n              if (!item.productId) {\n                // Eğer productId null ise, ürünü atlıyoruz\n                return null;\n              }\n\n              return {\n                productId: item.productId._id,\n                productName: item.productId.name,\n                productPrice: item.productId.price,\n                productImages: item.productId.images,\n                quantity: item.quantity,\n                status: item.status,\n              };\n            })\n            .filter((item) => item !== null), // Null olan ürünleri filtreliyoruz\n        };\n      });\n\n      // Eğer satıcıya ait ürünler varsa döndürüyoruz\n      res\n        .status(200)\n        .json(sellerOrders.filter((order) => order.items.length > 0));\n    } catch (error) {\n      console.log(error);\n      res.status(500).json({\n        message: \"Can not get seller orders\",\n        errorCode: \"canNotGetSellerOrders\",\n      });\n    }\n  });\n\n  router.post(\n    \"/seller-orders/:cartId/product/:productId/mark-processed\",\n    Session,\n    async (req, res) => {\n      try {\n        const sellerId = req.user._id; // Satıcı ID'sini oturumdan alıyoruz\n        const { cartId, productId } = req.params; // Ürün ID'si\n\n        // 1. Satıcının ürünlerini içeren sepette ilgili ürünü buluyoruz ve güncelliyoruz\n        const cart = await Cart.findOneAndUpdate(\n          {\n            _id: cartId,\n            \"products.productId\": productId, // Sepette ürün ID'sine göre filtreleme\n            \"products.seller\": sellerId, // Sadece satıcının ürünü olmalı\n            \"products.status\": \"pending\", // Beklemede olan ürünleri bul\n          },\n          {\n            $set: { \"products.$[element].status\": \"processing\" }, // İlgili ürünün durumunu güncelle\n          },\n          {\n            arrayFilters: [\n              { \"element.productId\": productId, \"element.seller\": sellerId },\n            ], // Sadece bu ürünü güncelle\n            new: true,\n          }\n        );\n\n        if (!cart) {\n          return res.status(404).json({\n            message: \"No pending orders found for this seller's product.\",\n          });\n        }\n\n        res.status(200).json({\n          message: \"Product in the order has been marked as processed.\",\n        });\n      } catch (error) {\n        console.error(\"Error while marking product as processed:\", error);\n        res\n          .status(500)\n          .json({ message: \"Error while processing the product in the order\" });\n      }\n    }\n  );\n\n  router.post(\n    \"/seller-orders/:cartId/product/:productId/mark-completed\",\n    Session,\n    async (req, res) => {\n      try {\n        const sellerId = req.user._id; // Satıcı ID'si\n        const { cartId, productId } = req.params;\n\n        // 1. Satıcının ürünlerini içeren sepeti buluyoruz ve durumu güncelliyoruz\n        const cart = await Cart.findOneAndUpdate(\n          {\n            _id: cartId,\n            \"products.productId\": productId,\n            \"products.seller\": sellerId,\n            \"products.status\": \"processing\", // İşlenmekte olanları tamamla\n          },\n          {\n            $set: { \"products.$[element].status\": \"completed\" },\n          },\n          {\n            arrayFilters: [\n              { \"element.productId\": productId, \"element.seller\": sellerId },\n            ],\n            new: true,\n          }\n        );\n\n        if (!cart) {\n          return res.status(404).json({\n            message: \"No processing orders found for this seller's product.\",\n          });\n        }\n\n        res.status(200).json({\n          message: \"Product in the order has been marked as completed.\",\n        });\n      } catch (error) {\n        console.error(\"Error while marking product as completed:\", error);\n        res\n          .status(500)\n          .json({ message: \"Error while completing the product in the order\" });\n      }\n    }\n  );\n\n  router.put(\"/seller/change-password\", Session, async (req, res) => {\n    const { oldPassword, newPassword, confirmPassword } = req.body;\n    const seller = req.user;\n    try {\n      const existingSeller = await Seller.findById(seller._id);\n      if (!existingSeller) {\n        throw new ApiError(\"User Not Found\", 404, \"notFoundUser\");\n      }\n\n      const isMatchPassword = await bcrypt.compare(\n        oldPassword,\n        existingSeller.password\n      );\n      if (!isMatchPassword) {\n        throw new ApiError(\n          \"Incorrect old password\",\n          404,\n          \"incorrectOldPassword\"\n        );\n      }\n\n      if (newPassword !== confirmPassword) {\n        throw new ApiError(\n          \"New password and confirm password do not match\",\n          404,\n          \"passwordsDoNotMatch\"\n        );\n      }\n\n      const isSamePassword = await bcrypt.compare(\n        newPassword,\n        existingSeller.password\n      );\n      if (isSamePassword) {\n        throw new ApiError(\n          \"New Password cannot be the same as the old password\",\n          400,\n          \"sameAsOldPassword\"\n        );\n      }\n\n      existingSeller.password = newPassword;\n      await existingSeller.save();\n      console.log(\"Old Password (unhashed):\", oldPassword);\n      console.log(\"New Password (unhashed):\", newPassword);\n\n      return res\n        .status(200)\n        .json({ message: \"Password has been changed successfully\", seller });\n    } catch (error) {\n      console.log(error);\n      res.status(error.statusCode || 500).json({\n        message: error.message || \"Password change failed\",\n        code: error.code || \"passwordChangeFailed\",\n      });\n    }\n  });\n\n  router.post(\n    \"/seller/forgot-password\",\n    forgotSellerPasswordEmail,\n    async (req, res) => {\n      const { email } = req.body;\n\n      const userEmail = await Seller.findOne({ email });\n\n      noExistVariable(userEmail, \"Email\");\n      res.status(200).send(\"Link has been send\");\n    }\n  );\n\n  router.get(\"/seller/:id\", Session, async (req, res) => {\n    const { id } = req.params;\n    try {\n      const sellerId = await Seller.findById(id);\n      noExistVariable(sellerId, \"Seller\");\n      res.status(200).json(sellerId);\n    } catch (error) {\n      console.log(error);\n      res.status(400).json(\"Error\");\n    }\n  });\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1735650629284},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/admin.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _approvalOrders = _interopRequireDefault(require(\"../db/approval-orders\"));\nvar _disapprovalOrders = _interopRequireDefault(require(\"../db/disapproval-orders\"));\nvar _paymentSuccess = _interopRequireDefault(require(\"../db/payment-success\"));\nvar _seller = _interopRequireDefault(require(\"../db/seller\"));\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _CheckExistence = require(\"../helpers/CheckExistence\");\nvar _Permissions = require(\"../helpers/Permissions\");\nvar _RequiredCheck = require(\"../helpers/RequiredCheck\");\nvar _ApproveMailToSeller = require(\"../middlewares/ApproveMailToSeller\");\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nvar _approval = require(\"../services/iyzico/methods/approval\");\nvar _submerchant = require(\"../services/iyzico/methods/submerchant\");\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = router => {\n  // Onay bekleyen seller'ları listeleme\n  router.get(\"/admin/seller/pending\", _Session.default, async (req, res) => {\n    (0, _Permissions.checkPermissions)(req.user, [\"admin\"]);\n    try {\n      const pendingSellers = await _seller.default.find({\n        isVerified: false\n      });\n      // if (!pendingSellers) {\n      //   throw new ApiError(\"Does not exist seller pending\");\n      // }\n      (0, _CheckExistence.noExistVariable)(pendingSellers, \"Seller\");\n      return res.status(200).json(pendingSellers);\n    } catch (error) {\n      console.log(error);\n      return res.status(500).send(new _ApiError.default(500, \"Satıcılar listelenirken hata oluştu.\"));\n    }\n  });\n  router.put(\"/admin/seller/verify/:id\", _Session.default, async (req, res, next) => {\n    const {\n      id\n    } = req.params;\n    const {\n      action,\n      response\n    } = req.body;\n    try {\n      (0, _Permissions.checkPermissions)(req.user, [\"admin\"]); // Yetki kontrolü\n      const seller = await _seller.default.findById(id);\n      (0, _CheckExistence.notFoundVariable)(seller, \"Seller\"); // Satıcı var mı kontrolü\n\n      if (seller.isVerified) {\n        return next(new _ApiError.default(\"This seller is already verified\", 404, \"alreadyVerified\"));\n      }\n      if (action === \"approve\") {\n        // Satıcı bilgilerini iyzico'ya uygun formata çevir\n        const subMerchantData = {\n          locale: seller.locale,\n          conversationId: seller.conversationId,\n          subMerchantExternalId: seller.subMerchantExternalId,\n          subMerchantType: seller.subMerchantType,\n          address: seller.address,\n          taxOffice: seller.taxOffice,\n          legalCompanyTitle: seller.legalCompanyTitle,\n          email: seller.email,\n          gsmNumber: seller.gsmNumber,\n          name: seller.name,\n          //şundan itibaren bakıver tax ve buna\n          identityNumber: seller.subMerchantType === \"PRIVATE_COMPANY\" ? seller.identityNumber : undefined,\n          taxNumber: seller.subMerchantType === \"LIMITED_OR_JOINT_STOCK_COMPANY\" ? seller.taxNumber : undefined,\n          iban: seller.iban.trim(),\n          currency: seller.currency\n        };\n        console.log(\"Kaydedilen IBAN:\", seller.iban);\n        console.log(\"Data = \", subMerchantData);\n        try {\n          const iyzicoResult = await (0, _submerchant.createSubMerchant)(subMerchantData);\n          if (iyzicoResult.status === \"success\") {\n            console.log(iyzicoResult);\n            seller.subMerchantKey = iyzicoResult.subMerchantKey;\n            seller.isVerified = true;\n            await seller.save();\n            await (0, _ApproveMailToSeller.ApproveMailToSeller)(req, res, next); // Onay e-postası gönder\n\n            return res.status(200).json({\n              message: \"Seller is verified and registered in iyzico\",\n              seller\n            });\n          } else {\n            // İyzico hatası loglanıyor\n            console.log(\"Iyzipay Error:\", iyzicoResult);\n            return res.status(500).json({\n              status: \"Failed to register seller in iyzico\",\n              rawResponse: iyzicoResult\n            });\n          }\n        } catch (error) {\n          console.log(\"Iyzipay API Error:\", error);\n          return res.status(500).json({\n            status: \"Failed to register seller in iyzico\",\n            error: error.message || \"An error occurred while contacting Iyzipay\"\n          });\n        }\n      }\n      if (action === \"reject\") {\n        await (0, _ApproveMailToSeller.RejectMailToSeller)(req, res, async () => {\n          // Mail başarılı bir şekilde gönderilirse satıcıyı sil\n          await _seller.default.findByIdAndDelete(id);\n          return res.status(200).json({\n            message: \"Seller is rejected and deleted\"\n          });\n        });\n\n        // Burada erken return yaparak hata olmasını engelliyoruz\n        return;\n      }\n      return res.status(400).json(new _ApiError.default(400, \"Invalid transaction\"));\n    } catch (error) {\n      console.error(error);\n      return next(new _ApiError.default(500, \"There is an error while processing the verification transaction\"));\n    }\n  });\n  router.get(\"/admin/get-all-users\", _Session.default, async (req, res) => {\n    (0, _Permissions.checkPermissions)(req.user, [\"admin\"]);\n    try {\n      const users = await _users.default.find();\n      res.status(200).json(users);\n    } catch (error) {\n      console.log(error);\n      throw new _ApiError.default(\"There must be error while get all users\", 404, \"errorGetAllUsers\");\n    }\n  });\n  router.get(\"/admin/get-all-sellers\", _Session.default, async (req, res) => {\n    (0, _Permissions.checkPermissions)(req.user, [\"admin\"]);\n    try {\n      const sellers = await _seller.default.find().select(\"-password\");\n      const sellersWithSubMerchants = await Promise.all(sellers.map(async seller => {\n        try {\n          const subMerchant = await (0, _submerchant.getSubMerchant)({\n            locale: seller.locale || \"tr\",\n            conversationId: seller.conversationId,\n            subMerchantExternalId: seller.subMerchantExternalId\n          });\n          return {\n            subMerchant\n          };\n        } catch (error) {\n          console.error(`SubMerchant data could not be retrieved for seller: ${seller._id}`, error);\n          return {\n            ...seller.toObject(),\n            subMerchant: null\n          };\n        }\n      }));\n      res.status(200).json({\n        sellers: sellersWithSubMerchants\n      });\n    } catch (error) {\n      console.log(error);\n      throw new _ApiError.default(\"There must be error while get all sellers\", 404, \"errorGetAllSellers\");\n    }\n  });\n  router.post(\"/admin/approve-order\", _Session.default, async (req, res) => {\n    const {\n      paymentTransactionId\n    } = req.body;\n    (0, _RequiredCheck.checkRequiredField)(paymentTransactionId, \"PaymentTransactionId\");\n    const data = {\n      paymentTransactionId\n    };\n    try {\n      const result = await (0, _approval.approvePayment)(data);\n      // Update isApprove field in payment-success collection\n      const updateResult = await _paymentSuccess.default.updateOne({\n        \"itemTransactions.paymentTransactionId\": paymentTransactionId\n      },\n      // Locate the document with the specified transaction ID\n      {\n        $set: {\n          \"itemTransactions.$.isApprove\": true\n        }\n      } // Set isApprove to true for the matching item\n      );\n\n      // Check if any document was modified\n      if (updateResult.modifiedCount === 0) {\n        throw new _ApiError.default(\"No matching transaction found or it was already approved\", 404, \"transactionNotFound\");\n      }\n      const payment = await _paymentSuccess.default.findOne({\n        \"itemTransactions.paymentTransactionId\": paymentTransactionId\n      }, \"itemTransactions cartId\").populate(\"itemTransactions.itemId\", \"name price\");\n      const transaction = payment.itemTransactions.find(item => item.paymentTransactionId === paymentTransactionId);\n      if (!transaction) {\n        throw new _ApiError.default(\"Transaction not found\", 404, \"transactionNotFound\");\n      }\n\n      // Create an ApprovedOrder record for the transaction\n      const approvedOrderData = {\n        paymentTransactionId: transaction.paymentTransactionId,\n        itemId: transaction.itemId._id,\n        name: transaction.itemId.name,\n        price: transaction.itemId.price,\n        paidPrice: transaction.paidPrice,\n        cartId: payment.cartId\n      };\n\n      // Save the approved order to ApprovedOrders collection\n      const approvedOrder = await _approvalOrders.default.create(approvedOrderData);\n      res.status(200).json({\n        result,\n        approvedOrder\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  });\n  router.post(\"/admin/disapprove-order\", _Session.default, async (req, res) => {\n    const {\n      paymentTransactionId\n    } = req.body;\n    (0, _RequiredCheck.checkRequiredField)(paymentTransactionId, \"PaymentTransactionId\");\n    const data = {\n      paymentTransactionId\n    };\n    try {\n      const result = await (0, _approval.disApprovePayment)(data);\n      // Update isApprove field in payment-success collection\n      const updateResult = await _paymentSuccess.default.updateOne({\n        \"itemTransactions.paymentTransactionId\": paymentTransactionId\n      },\n      // Locate the document with the specified transaction ID\n      {\n        $set: {\n          \"itemTransactions.$.isDisApprove\": true,\n          \"itemTransactions.$.isApprove\": false\n        }\n      } // Set isApprove to true for the matching item\n      );\n\n      // Check if any document was modified\n      if (updateResult.modifiedCount === 0) {\n        throw new _ApiError.default(\"No matching transaction found or it was already approved\", 404, \"transactionNotFound\");\n      }\n      const payment = await _paymentSuccess.default.findOne({\n        \"itemTransactions.paymentTransactionId\": paymentTransactionId\n      }, \"itemTransactions cartId\").populate(\"itemTransactions.itemId\", \"name price\");\n      const transaction = payment.itemTransactions.find(item => item.paymentTransactionId === paymentTransactionId);\n      if (!transaction) {\n        throw new _ApiError.default(\"Transaction not found\", 404, \"transactionNotFound\");\n      }\n\n      // Create an ApprovedOrder record for the transaction\n      const disApprovedOrderData = {\n        paymentTransactionId: transaction.paymentTransactionId,\n        itemId: transaction.itemId._id,\n        name: transaction.itemId.name,\n        price: transaction.itemId.price,\n        paidPrice: transaction.paidPrice,\n        cartId: payment.cartId\n      };\n\n      // Save the approved order to ApprovedOrders collection\n      const disApprovedOrder = await _disapprovalOrders.default.create(disApprovedOrderData);\n      res.status(200).json({\n        result,\n        disApprovedOrder\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  });\n  router.get(\"/admin/waiting-orders\", _Session.default, async (req, res, next) => {\n    try {\n      const payments = await _paymentSuccess.default.find({\n        status: \"success\",\n        itemTransactions: {\n          $elemMatch: {\n            isApprove: false,\n            isDisApprove: false\n          }\n        }\n      }, \"itemTransactions\").populate(\"itemTransactions.itemId\", \"name price\"); // Populate name and price from the product collection\n\n      console.log(\"Populated Payments:\", payments);\n\n      // Prepare an array of transaction details\n      const transactionDetails = payments.flatMap(payment => payment.itemTransactions.filter(transaction => !transaction.isApprove && !transaction.isDisApprove && transaction.itemId &&\n      // itemId mevcut mu?\n      transaction.itemId.name &&\n      // name alanı var mı?\n      transaction.price // price alanı var mı?\n      ).map(transaction => ({\n        paymentTransactionId: transaction.paymentTransactionId,\n        itemId: transaction.itemId._id,\n        // The ObjectId of the item\n        name: transaction.itemId.name,\n        // Populated name of the item\n        price: transaction.price // Populated price of the item\n      })));\n      if (transactionDetails.length === 0) {\n        console.log(\"there is no order to approve\");\n        throw new _ApiError.default(\"There is no order to approve\", 401, \"noOrderToApprove\");\n      }\n      res.status(200).json({\n        transactionDetails\n      });\n    } catch (error) {\n      console.log(error);\n      next(new _ApiError.default(\"Could not retrieve paymentTransactionIds\", 500, \"fetchError\"));\n    }\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYXBwcm92YWxPcmRlcnMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9kaXNhcHByb3ZhbE9yZGVycyIsIl9wYXltZW50U3VjY2VzcyIsIl9zZWxsZXIiLCJfdXNlcnMiLCJfQXBpRXJyb3IiLCJfQ2hlY2tFeGlzdGVuY2UiLCJfUGVybWlzc2lvbnMiLCJfUmVxdWlyZWRDaGVjayIsIl9BcHByb3ZlTWFpbFRvU2VsbGVyIiwiX1Nlc3Npb24iLCJfYXBwcm92YWwiLCJfc3VibWVyY2hhbnQiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfZGVmYXVsdCIsInJvdXRlciIsImdldCIsIlNlc3Npb24iLCJyZXEiLCJyZXMiLCJjaGVja1Blcm1pc3Npb25zIiwidXNlciIsInBlbmRpbmdTZWxsZXJzIiwiU2VsbGVyIiwiZmluZCIsImlzVmVyaWZpZWQiLCJub0V4aXN0VmFyaWFibGUiLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwic2VuZCIsIkFwaUVycm9yIiwicHV0IiwibmV4dCIsImlkIiwicGFyYW1zIiwiYWN0aW9uIiwicmVzcG9uc2UiLCJib2R5Iiwic2VsbGVyIiwiZmluZEJ5SWQiLCJub3RGb3VuZFZhcmlhYmxlIiwic3ViTWVyY2hhbnREYXRhIiwibG9jYWxlIiwiY29udmVyc2F0aW9uSWQiLCJzdWJNZXJjaGFudEV4dGVybmFsSWQiLCJzdWJNZXJjaGFudFR5cGUiLCJhZGRyZXNzIiwidGF4T2ZmaWNlIiwibGVnYWxDb21wYW55VGl0bGUiLCJlbWFpbCIsImdzbU51bWJlciIsIm5hbWUiLCJpZGVudGl0eU51bWJlciIsInVuZGVmaW5lZCIsInRheE51bWJlciIsImliYW4iLCJ0cmltIiwiY3VycmVuY3kiLCJpeXppY29SZXN1bHQiLCJjcmVhdGVTdWJNZXJjaGFudCIsInN1Yk1lcmNoYW50S2V5Iiwic2F2ZSIsIkFwcHJvdmVNYWlsVG9TZWxsZXIiLCJtZXNzYWdlIiwicmF3UmVzcG9uc2UiLCJSZWplY3RNYWlsVG9TZWxsZXIiLCJmaW5kQnlJZEFuZERlbGV0ZSIsInVzZXJzIiwiVXNlcnMiLCJzZWxsZXJzIiwic2VsZWN0Iiwic2VsbGVyc1dpdGhTdWJNZXJjaGFudHMiLCJQcm9taXNlIiwiYWxsIiwibWFwIiwic3ViTWVyY2hhbnQiLCJnZXRTdWJNZXJjaGFudCIsIl9pZCIsInRvT2JqZWN0IiwicG9zdCIsInBheW1lbnRUcmFuc2FjdGlvbklkIiwiY2hlY2tSZXF1aXJlZEZpZWxkIiwiZGF0YSIsInJlc3VsdCIsImFwcHJvdmVQYXltZW50IiwidXBkYXRlUmVzdWx0IiwiUGF5bWVudFN1Y2Nlc3MiLCJ1cGRhdGVPbmUiLCIkc2V0IiwibW9kaWZpZWRDb3VudCIsInBheW1lbnQiLCJmaW5kT25lIiwicG9wdWxhdGUiLCJ0cmFuc2FjdGlvbiIsIml0ZW1UcmFuc2FjdGlvbnMiLCJpdGVtIiwiYXBwcm92ZWRPcmRlckRhdGEiLCJpdGVtSWQiLCJwcmljZSIsInBhaWRQcmljZSIsImNhcnRJZCIsImFwcHJvdmVkT3JkZXIiLCJBcHByb3ZhbE9yZGVycyIsImNyZWF0ZSIsImRpc0FwcHJvdmVQYXltZW50IiwiZGlzQXBwcm92ZWRPcmRlckRhdGEiLCJkaXNBcHByb3ZlZE9yZGVyIiwiRGlzQXBwcm92YWxPcmRlcnMiLCJwYXltZW50cyIsIiRlbGVtTWF0Y2giLCJpc0FwcHJvdmUiLCJpc0Rpc0FwcHJvdmUiLCJ0cmFuc2FjdGlvbkRldGFpbHMiLCJmbGF0TWFwIiwiZmlsdGVyIiwibGVuZ3RoIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3JvdXRlcy8iLCJzb3VyY2VzIjpbImFkbWluLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBBcHByb3ZhbE9yZGVycyBmcm9tIFwiLi4vZGIvYXBwcm92YWwtb3JkZXJzXCI7XG5pbXBvcnQgRGlzQXBwcm92YWxPcmRlcnMgZnJvbSBcIi4uL2RiL2Rpc2FwcHJvdmFsLW9yZGVyc1wiO1xuaW1wb3J0IFBheW1lbnRTdWNjZXNzIGZyb20gXCIuLi9kYi9wYXltZW50LXN1Y2Nlc3NcIjtcbmltcG9ydCBTZWxsZXIgZnJvbSBcIi4uL2RiL3NlbGxlclwiO1xuaW1wb3J0IFVzZXJzIGZyb20gXCIuLi9kYi91c2Vyc1wiO1xuaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuLi9lcnJvcnMvQXBpRXJyb3JcIjtcbmltcG9ydCB7IG5vRXhpc3RWYXJpYWJsZSwgbm90Rm91bmRWYXJpYWJsZSB9IGZyb20gXCIuLi9oZWxwZXJzL0NoZWNrRXhpc3RlbmNlXCI7XG5pbXBvcnQgeyBjaGVja1Blcm1pc3Npb25zIH0gZnJvbSBcIi4uL2hlbHBlcnMvUGVybWlzc2lvbnNcIjtcbmltcG9ydCB7IGNoZWNrUmVxdWlyZWRGaWVsZCB9IGZyb20gXCIuLi9oZWxwZXJzL1JlcXVpcmVkQ2hlY2tcIjtcbmltcG9ydCB7XG4gIEFwcHJvdmVNYWlsVG9TZWxsZXIsXG4gIFJlamVjdE1haWxUb1NlbGxlcixcbn0gZnJvbSBcIi4uL21pZGRsZXdhcmVzL0FwcHJvdmVNYWlsVG9TZWxsZXJcIjtcbmltcG9ydCBTZXNzaW9uIGZyb20gXCIuLi9taWRkbGV3YXJlcy9TZXNzaW9uXCI7XG5pbXBvcnQge1xuICBhcHByb3ZlUGF5bWVudCxcbiAgZGlzQXBwcm92ZVBheW1lbnQsXG59IGZyb20gXCIuLi9zZXJ2aWNlcy9peXppY28vbWV0aG9kcy9hcHByb3ZhbFwiO1xuaW1wb3J0IHtcbiAgY3JlYXRlU3ViTWVyY2hhbnQsXG4gIGdldFN1Yk1lcmNoYW50LFxufSBmcm9tIFwiLi4vc2VydmljZXMvaXl6aWNvL21ldGhvZHMvc3VibWVyY2hhbnRcIjtcblxuZXhwb3J0IGRlZmF1bHQgKHJvdXRlcikgPT4ge1xuICAvLyBPbmF5IGJla2xleWVuIHNlbGxlcidsYXLEsSBsaXN0ZWxlbWVcbiAgcm91dGVyLmdldChcIi9hZG1pbi9zZWxsZXIvcGVuZGluZ1wiLCBTZXNzaW9uLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICBjaGVja1Blcm1pc3Npb25zKHJlcS51c2VyLCBbXCJhZG1pblwiXSk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHBlbmRpbmdTZWxsZXJzID0gYXdhaXQgU2VsbGVyLmZpbmQoeyBpc1ZlcmlmaWVkOiBmYWxzZSB9KTtcbiAgICAgIC8vIGlmICghcGVuZGluZ1NlbGxlcnMpIHtcbiAgICAgIC8vICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiRG9lcyBub3QgZXhpc3Qgc2VsbGVyIHBlbmRpbmdcIik7XG4gICAgICAvLyB9XG4gICAgICBub0V4aXN0VmFyaWFibGUocGVuZGluZ1NlbGxlcnMsIFwiU2VsbGVyXCIpO1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHBlbmRpbmdTZWxsZXJzKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgcmV0dXJuIHJlc1xuICAgICAgICAuc3RhdHVzKDUwMClcbiAgICAgICAgLnNlbmQobmV3IEFwaUVycm9yKDUwMCwgXCJTYXTEsWPEsWxhciBsaXN0ZWxlbmlya2VuIGhhdGEgb2x1xZ90dS5cIikpO1xuICAgIH1cbiAgfSk7XG5cbiAgcm91dGVyLnB1dChcIi9hZG1pbi9zZWxsZXIvdmVyaWZ5LzppZFwiLCBTZXNzaW9uLCBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICBjb25zdCB7IGlkIH0gPSByZXEucGFyYW1zO1xuICAgIGNvbnN0IHsgYWN0aW9uLCByZXNwb25zZSB9ID0gcmVxLmJvZHk7XG5cbiAgICB0cnkge1xuICAgICAgY2hlY2tQZXJtaXNzaW9ucyhyZXEudXNlciwgW1wiYWRtaW5cIl0pOyAvLyBZZXRraSBrb250cm9sw7xcbiAgICAgIGNvbnN0IHNlbGxlciA9IGF3YWl0IFNlbGxlci5maW5kQnlJZChpZCk7XG4gICAgICBub3RGb3VuZFZhcmlhYmxlKHNlbGxlciwgXCJTZWxsZXJcIik7IC8vIFNhdMSxY8SxIHZhciBtxLEga29udHJvbMO8XG5cbiAgICAgIGlmIChzZWxsZXIuaXNWZXJpZmllZCkge1xuICAgICAgICByZXR1cm4gbmV4dChcbiAgICAgICAgICBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgICBcIlRoaXMgc2VsbGVyIGlzIGFscmVhZHkgdmVyaWZpZWRcIixcbiAgICAgICAgICAgIDQwNCxcbiAgICAgICAgICAgIFwiYWxyZWFkeVZlcmlmaWVkXCJcbiAgICAgICAgICApXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGlmIChhY3Rpb24gPT09IFwiYXBwcm92ZVwiKSB7XG4gICAgICAgIC8vIFNhdMSxY8SxIGJpbGdpbGVyaW5pIGl5emljbyd5YSB1eWd1biBmb3JtYXRhIMOnZXZpclxuICAgICAgICBjb25zdCBzdWJNZXJjaGFudERhdGEgPSB7XG4gICAgICAgICAgbG9jYWxlOiBzZWxsZXIubG9jYWxlLFxuICAgICAgICAgIGNvbnZlcnNhdGlvbklkOiBzZWxsZXIuY29udmVyc2F0aW9uSWQsXG4gICAgICAgICAgc3ViTWVyY2hhbnRFeHRlcm5hbElkOiBzZWxsZXIuc3ViTWVyY2hhbnRFeHRlcm5hbElkLFxuICAgICAgICAgIHN1Yk1lcmNoYW50VHlwZTogc2VsbGVyLnN1Yk1lcmNoYW50VHlwZSxcbiAgICAgICAgICBhZGRyZXNzOiBzZWxsZXIuYWRkcmVzcyxcbiAgICAgICAgICB0YXhPZmZpY2U6IHNlbGxlci50YXhPZmZpY2UsXG4gICAgICAgICAgbGVnYWxDb21wYW55VGl0bGU6IHNlbGxlci5sZWdhbENvbXBhbnlUaXRsZSxcbiAgICAgICAgICBlbWFpbDogc2VsbGVyLmVtYWlsLFxuICAgICAgICAgIGdzbU51bWJlcjogc2VsbGVyLmdzbU51bWJlcixcbiAgICAgICAgICBuYW1lOiBzZWxsZXIubmFtZSxcbiAgICAgICAgICAvL8WfdW5kYW4gaXRpYmFyZW4gYmFrxLF2ZXIgdGF4IHZlIGJ1bmFcbiAgICAgICAgICBpZGVudGl0eU51bWJlcjpcbiAgICAgICAgICAgIHNlbGxlci5zdWJNZXJjaGFudFR5cGUgPT09IFwiUFJJVkFURV9DT01QQU5ZXCJcbiAgICAgICAgICAgICAgPyBzZWxsZXIuaWRlbnRpdHlOdW1iZXJcbiAgICAgICAgICAgICAgOiB1bmRlZmluZWQsXG4gICAgICAgICAgdGF4TnVtYmVyOlxuICAgICAgICAgICAgc2VsbGVyLnN1Yk1lcmNoYW50VHlwZSA9PT0gXCJMSU1JVEVEX09SX0pPSU5UX1NUT0NLX0NPTVBBTllcIlxuICAgICAgICAgICAgICA/IHNlbGxlci50YXhOdW1iZXJcbiAgICAgICAgICAgICAgOiB1bmRlZmluZWQsXG4gICAgICAgICAgaWJhbjogc2VsbGVyLmliYW4udHJpbSgpLFxuICAgICAgICAgIGN1cnJlbmN5OiBzZWxsZXIuY3VycmVuY3ksXG4gICAgICAgIH07XG4gICAgICAgIGNvbnNvbGUubG9nKFwiS2F5ZGVkaWxlbiBJQkFOOlwiLCBzZWxsZXIuaWJhbik7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiRGF0YSA9IFwiLCBzdWJNZXJjaGFudERhdGEpO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgaXl6aWNvUmVzdWx0ID0gYXdhaXQgY3JlYXRlU3ViTWVyY2hhbnQoc3ViTWVyY2hhbnREYXRhKTtcblxuICAgICAgICAgIGlmIChpeXppY29SZXN1bHQuc3RhdHVzID09PSBcInN1Y2Nlc3NcIikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coaXl6aWNvUmVzdWx0KTtcbiAgICAgICAgICAgIHNlbGxlci5zdWJNZXJjaGFudEtleSA9IGl5emljb1Jlc3VsdC5zdWJNZXJjaGFudEtleTtcbiAgICAgICAgICAgIHNlbGxlci5pc1ZlcmlmaWVkID0gdHJ1ZTtcbiAgICAgICAgICAgIGF3YWl0IHNlbGxlci5zYXZlKCk7XG4gICAgICAgICAgICBhd2FpdCBBcHByb3ZlTWFpbFRvU2VsbGVyKHJlcSwgcmVzLCBuZXh0KTsgLy8gT25heSBlLXBvc3Rhc8SxIGfDtm5kZXJcblxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogXCJTZWxsZXIgaXMgdmVyaWZpZWQgYW5kIHJlZ2lzdGVyZWQgaW4gaXl6aWNvXCIsXG4gICAgICAgICAgICAgIHNlbGxlcixcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyDEsHl6aWNvIGhhdGFzxLEgbG9nbGFuxLF5b3JcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiSXl6aXBheSBFcnJvcjpcIiwgaXl6aWNvUmVzdWx0KTtcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7XG4gICAgICAgICAgICAgIHN0YXR1czogXCJGYWlsZWQgdG8gcmVnaXN0ZXIgc2VsbGVyIGluIGl5emljb1wiLFxuICAgICAgICAgICAgICByYXdSZXNwb25zZTogaXl6aWNvUmVzdWx0LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwiSXl6aXBheSBBUEkgRXJyb3I6XCIsIGVycm9yKTtcbiAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgICAgICAgICAgc3RhdHVzOiBcIkZhaWxlZCB0byByZWdpc3RlciBzZWxsZXIgaW4gaXl6aWNvXCIsXG4gICAgICAgICAgICBlcnJvcjpcbiAgICAgICAgICAgICAgZXJyb3IubWVzc2FnZSB8fCBcIkFuIGVycm9yIG9jY3VycmVkIHdoaWxlIGNvbnRhY3RpbmcgSXl6aXBheVwiLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChhY3Rpb24gPT09IFwicmVqZWN0XCIpIHtcbiAgICAgICAgYXdhaXQgUmVqZWN0TWFpbFRvU2VsbGVyKHJlcSwgcmVzLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgLy8gTWFpbCBiYcWfYXLEsWzEsSBiaXIgxZ9la2lsZGUgZ8O2bmRlcmlsaXJzZSBzYXTEsWPEsXnEsSBzaWxcbiAgICAgICAgICBhd2FpdCBTZWxsZXIuZmluZEJ5SWRBbmREZWxldGUoaWQpO1xuICAgICAgICAgIHJldHVybiByZXNcbiAgICAgICAgICAgIC5zdGF0dXMoMjAwKVxuICAgICAgICAgICAgLmpzb24oeyBtZXNzYWdlOiBcIlNlbGxlciBpcyByZWplY3RlZCBhbmQgZGVsZXRlZFwiIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBCdXJhZGEgZXJrZW4gcmV0dXJuIHlhcGFyYWsgaGF0YSBvbG1hc8SxbsSxIGVuZ2VsbGl5b3J1elxuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbihuZXcgQXBpRXJyb3IoNDAwLCBcIkludmFsaWQgdHJhbnNhY3Rpb25cIikpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgIHJldHVybiBuZXh0KFxuICAgICAgICBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgNTAwLFxuICAgICAgICAgIFwiVGhlcmUgaXMgYW4gZXJyb3Igd2hpbGUgcHJvY2Vzc2luZyB0aGUgdmVyaWZpY2F0aW9uIHRyYW5zYWN0aW9uXCJcbiAgICAgICAgKVxuICAgICAgKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJvdXRlci5nZXQoXCIvYWRtaW4vZ2V0LWFsbC11c2Vyc1wiLCBTZXNzaW9uLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICBjaGVja1Blcm1pc3Npb25zKHJlcS51c2VyLCBbXCJhZG1pblwiXSk7XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgdXNlcnMgPSBhd2FpdCBVc2Vycy5maW5kKCk7XG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih1c2Vycyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgXCJUaGVyZSBtdXN0IGJlIGVycm9yIHdoaWxlIGdldCBhbGwgdXNlcnNcIixcbiAgICAgICAgNDA0LFxuICAgICAgICBcImVycm9yR2V0QWxsVXNlcnNcIlxuICAgICAgKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJvdXRlci5nZXQoXCIvYWRtaW4vZ2V0LWFsbC1zZWxsZXJzXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGNoZWNrUGVybWlzc2lvbnMocmVxLnVzZXIsIFtcImFkbWluXCJdKTtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc2VsbGVycyA9IGF3YWl0IFNlbGxlci5maW5kKCkuc2VsZWN0KFwiLXBhc3N3b3JkXCIpO1xuICAgICAgY29uc3Qgc2VsbGVyc1dpdGhTdWJNZXJjaGFudHMgPSBhd2FpdCBQcm9taXNlLmFsbChcbiAgICAgICAgc2VsbGVycy5tYXAoYXN5bmMgKHNlbGxlcikgPT4ge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBzdWJNZXJjaGFudCA9IGF3YWl0IGdldFN1Yk1lcmNoYW50KHtcbiAgICAgICAgICAgICAgbG9jYWxlOiBzZWxsZXIubG9jYWxlIHx8IFwidHJcIixcbiAgICAgICAgICAgICAgY29udmVyc2F0aW9uSWQ6IHNlbGxlci5jb252ZXJzYXRpb25JZCxcbiAgICAgICAgICAgICAgc3ViTWVyY2hhbnRFeHRlcm5hbElkOiBzZWxsZXIuc3ViTWVyY2hhbnRFeHRlcm5hbElkLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICBzdWJNZXJjaGFudCxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICAgICAgICAgIGBTdWJNZXJjaGFudCBkYXRhIGNvdWxkIG5vdCBiZSByZXRyaWV2ZWQgZm9yIHNlbGxlcjogJHtzZWxsZXIuX2lkfWAsXG4gICAgICAgICAgICAgIGVycm9yXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgLi4uc2VsbGVyLnRvT2JqZWN0KCksXG4gICAgICAgICAgICAgIHN1Yk1lcmNoYW50OiBudWxsLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICApO1xuXG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IHNlbGxlcnM6IHNlbGxlcnNXaXRoU3ViTWVyY2hhbnRzIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgIFwiVGhlcmUgbXVzdCBiZSBlcnJvciB3aGlsZSBnZXQgYWxsIHNlbGxlcnNcIixcbiAgICAgICAgNDA0LFxuICAgICAgICBcImVycm9yR2V0QWxsU2VsbGVyc1wiXG4gICAgICApO1xuICAgIH1cbiAgfSk7XG4gIHJvdXRlci5wb3N0KFwiL2FkbWluL2FwcHJvdmUtb3JkZXJcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyBwYXltZW50VHJhbnNhY3Rpb25JZCB9ID0gcmVxLmJvZHk7XG4gICAgY2hlY2tSZXF1aXJlZEZpZWxkKHBheW1lbnRUcmFuc2FjdGlvbklkLCBcIlBheW1lbnRUcmFuc2FjdGlvbklkXCIpO1xuXG4gICAgY29uc3QgZGF0YSA9IHtcbiAgICAgIHBheW1lbnRUcmFuc2FjdGlvbklkLFxuICAgIH07XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYXBwcm92ZVBheW1lbnQoZGF0YSk7XG4gICAgICAvLyBVcGRhdGUgaXNBcHByb3ZlIGZpZWxkIGluIHBheW1lbnQtc3VjY2VzcyBjb2xsZWN0aW9uXG4gICAgICBjb25zdCB1cGRhdGVSZXN1bHQgPSBhd2FpdCBQYXltZW50U3VjY2Vzcy51cGRhdGVPbmUoXG4gICAgICAgIHsgXCJpdGVtVHJhbnNhY3Rpb25zLnBheW1lbnRUcmFuc2FjdGlvbklkXCI6IHBheW1lbnRUcmFuc2FjdGlvbklkIH0sIC8vIExvY2F0ZSB0aGUgZG9jdW1lbnQgd2l0aCB0aGUgc3BlY2lmaWVkIHRyYW5zYWN0aW9uIElEXG4gICAgICAgIHsgJHNldDogeyBcIml0ZW1UcmFuc2FjdGlvbnMuJC5pc0FwcHJvdmVcIjogdHJ1ZSB9IH0gLy8gU2V0IGlzQXBwcm92ZSB0byB0cnVlIGZvciB0aGUgbWF0Y2hpbmcgaXRlbVxuICAgICAgKTtcblxuICAgICAgLy8gQ2hlY2sgaWYgYW55IGRvY3VtZW50IHdhcyBtb2RpZmllZFxuICAgICAgaWYgKHVwZGF0ZVJlc3VsdC5tb2RpZmllZENvdW50ID09PSAwKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgICBcIk5vIG1hdGNoaW5nIHRyYW5zYWN0aW9uIGZvdW5kIG9yIGl0IHdhcyBhbHJlYWR5IGFwcHJvdmVkXCIsXG4gICAgICAgICAgNDA0LFxuICAgICAgICAgIFwidHJhbnNhY3Rpb25Ob3RGb3VuZFwiXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCBQYXltZW50U3VjY2Vzcy5maW5kT25lKFxuICAgICAgICB7IFwiaXRlbVRyYW5zYWN0aW9ucy5wYXltZW50VHJhbnNhY3Rpb25JZFwiOiBwYXltZW50VHJhbnNhY3Rpb25JZCB9LFxuICAgICAgICBcIml0ZW1UcmFuc2FjdGlvbnMgY2FydElkXCJcbiAgICAgICkucG9wdWxhdGUoXCJpdGVtVHJhbnNhY3Rpb25zLml0ZW1JZFwiLCBcIm5hbWUgcHJpY2VcIik7XG5cbiAgICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gcGF5bWVudC5pdGVtVHJhbnNhY3Rpb25zLmZpbmQoXG4gICAgICAgIChpdGVtKSA9PiBpdGVtLnBheW1lbnRUcmFuc2FjdGlvbklkID09PSBwYXltZW50VHJhbnNhY3Rpb25JZFxuICAgICAgKTtcblxuICAgICAgaWYgKCF0cmFuc2FjdGlvbikge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJUcmFuc2FjdGlvbiBub3QgZm91bmRcIiwgNDA0LCBcInRyYW5zYWN0aW9uTm90Rm91bmRcIik7XG4gICAgICB9XG5cbiAgICAgIC8vIENyZWF0ZSBhbiBBcHByb3ZlZE9yZGVyIHJlY29yZCBmb3IgdGhlIHRyYW5zYWN0aW9uXG4gICAgICBjb25zdCBhcHByb3ZlZE9yZGVyRGF0YSA9IHtcbiAgICAgICAgcGF5bWVudFRyYW5zYWN0aW9uSWQ6IHRyYW5zYWN0aW9uLnBheW1lbnRUcmFuc2FjdGlvbklkLFxuICAgICAgICBpdGVtSWQ6IHRyYW5zYWN0aW9uLml0ZW1JZC5faWQsXG4gICAgICAgIG5hbWU6IHRyYW5zYWN0aW9uLml0ZW1JZC5uYW1lLFxuICAgICAgICBwcmljZTogdHJhbnNhY3Rpb24uaXRlbUlkLnByaWNlLFxuICAgICAgICBwYWlkUHJpY2U6IHRyYW5zYWN0aW9uLnBhaWRQcmljZSxcbiAgICAgICAgY2FydElkOiBwYXltZW50LmNhcnRJZCxcbiAgICAgIH07XG5cbiAgICAgIC8vIFNhdmUgdGhlIGFwcHJvdmVkIG9yZGVyIHRvIEFwcHJvdmVkT3JkZXJzIGNvbGxlY3Rpb25cbiAgICAgIGNvbnN0IGFwcHJvdmVkT3JkZXIgPSBhd2FpdCBBcHByb3ZhbE9yZGVycy5jcmVhdGUoYXBwcm92ZWRPcmRlckRhdGEpO1xuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyByZXN1bHQsIGFwcHJvdmVkT3JkZXIgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICB9XG4gIH0pO1xuICByb3V0ZXIucG9zdChcIi9hZG1pbi9kaXNhcHByb3ZlLW9yZGVyXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGNvbnN0IHsgcGF5bWVudFRyYW5zYWN0aW9uSWQgfSA9IHJlcS5ib2R5O1xuICAgIGNoZWNrUmVxdWlyZWRGaWVsZChwYXltZW50VHJhbnNhY3Rpb25JZCwgXCJQYXltZW50VHJhbnNhY3Rpb25JZFwiKTtcblxuICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICBwYXltZW50VHJhbnNhY3Rpb25JZCxcbiAgICB9O1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRpc0FwcHJvdmVQYXltZW50KGRhdGEpO1xuICAgICAgLy8gVXBkYXRlIGlzQXBwcm92ZSBmaWVsZCBpbiBwYXltZW50LXN1Y2Nlc3MgY29sbGVjdGlvblxuICAgICAgY29uc3QgdXBkYXRlUmVzdWx0ID0gYXdhaXQgUGF5bWVudFN1Y2Nlc3MudXBkYXRlT25lKFxuICAgICAgICB7IFwiaXRlbVRyYW5zYWN0aW9ucy5wYXltZW50VHJhbnNhY3Rpb25JZFwiOiBwYXltZW50VHJhbnNhY3Rpb25JZCB9LCAvLyBMb2NhdGUgdGhlIGRvY3VtZW50IHdpdGggdGhlIHNwZWNpZmllZCB0cmFuc2FjdGlvbiBJRFxuICAgICAgICB7XG4gICAgICAgICAgJHNldDoge1xuICAgICAgICAgICAgXCJpdGVtVHJhbnNhY3Rpb25zLiQuaXNEaXNBcHByb3ZlXCI6IHRydWUsXG4gICAgICAgICAgICBcIml0ZW1UcmFuc2FjdGlvbnMuJC5pc0FwcHJvdmVcIjogZmFsc2UsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSAvLyBTZXQgaXNBcHByb3ZlIHRvIHRydWUgZm9yIHRoZSBtYXRjaGluZyBpdGVtXG4gICAgICApO1xuXG4gICAgICAvLyBDaGVjayBpZiBhbnkgZG9jdW1lbnQgd2FzIG1vZGlmaWVkXG4gICAgICBpZiAodXBkYXRlUmVzdWx0Lm1vZGlmaWVkQ291bnQgPT09IDApIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIFwiTm8gbWF0Y2hpbmcgdHJhbnNhY3Rpb24gZm91bmQgb3IgaXQgd2FzIGFscmVhZHkgYXBwcm92ZWRcIixcbiAgICAgICAgICA0MDQsXG4gICAgICAgICAgXCJ0cmFuc2FjdGlvbk5vdEZvdW5kXCJcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcGF5bWVudCA9IGF3YWl0IFBheW1lbnRTdWNjZXNzLmZpbmRPbmUoXG4gICAgICAgIHsgXCJpdGVtVHJhbnNhY3Rpb25zLnBheW1lbnRUcmFuc2FjdGlvbklkXCI6IHBheW1lbnRUcmFuc2FjdGlvbklkIH0sXG4gICAgICAgIFwiaXRlbVRyYW5zYWN0aW9ucyBjYXJ0SWRcIlxuICAgICAgKS5wb3B1bGF0ZShcIml0ZW1UcmFuc2FjdGlvbnMuaXRlbUlkXCIsIFwibmFtZSBwcmljZVwiKTtcblxuICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBwYXltZW50Lml0ZW1UcmFuc2FjdGlvbnMuZmluZChcbiAgICAgICAgKGl0ZW0pID0+IGl0ZW0ucGF5bWVudFRyYW5zYWN0aW9uSWQgPT09IHBheW1lbnRUcmFuc2FjdGlvbklkXG4gICAgICApO1xuXG4gICAgICBpZiAoIXRyYW5zYWN0aW9uKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIlRyYW5zYWN0aW9uIG5vdCBmb3VuZFwiLCA0MDQsIFwidHJhbnNhY3Rpb25Ob3RGb3VuZFwiKTtcbiAgICAgIH1cblxuICAgICAgLy8gQ3JlYXRlIGFuIEFwcHJvdmVkT3JkZXIgcmVjb3JkIGZvciB0aGUgdHJhbnNhY3Rpb25cbiAgICAgIGNvbnN0IGRpc0FwcHJvdmVkT3JkZXJEYXRhID0ge1xuICAgICAgICBwYXltZW50VHJhbnNhY3Rpb25JZDogdHJhbnNhY3Rpb24ucGF5bWVudFRyYW5zYWN0aW9uSWQsXG4gICAgICAgIGl0ZW1JZDogdHJhbnNhY3Rpb24uaXRlbUlkLl9pZCxcbiAgICAgICAgbmFtZTogdHJhbnNhY3Rpb24uaXRlbUlkLm5hbWUsXG4gICAgICAgIHByaWNlOiB0cmFuc2FjdGlvbi5pdGVtSWQucHJpY2UsXG4gICAgICAgIHBhaWRQcmljZTogdHJhbnNhY3Rpb24ucGFpZFByaWNlLFxuICAgICAgICBjYXJ0SWQ6IHBheW1lbnQuY2FydElkLFxuICAgICAgfTtcblxuICAgICAgLy8gU2F2ZSB0aGUgYXBwcm92ZWQgb3JkZXIgdG8gQXBwcm92ZWRPcmRlcnMgY29sbGVjdGlvblxuICAgICAgY29uc3QgZGlzQXBwcm92ZWRPcmRlciA9IGF3YWl0IERpc0FwcHJvdmFsT3JkZXJzLmNyZWF0ZShcbiAgICAgICAgZGlzQXBwcm92ZWRPcmRlckRhdGFcbiAgICAgICk7XG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IHJlc3VsdCwgZGlzQXBwcm92ZWRPcmRlciB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgIH1cbiAgfSk7XG4gIHJvdXRlci5nZXQoXCIvYWRtaW4vd2FpdGluZy1vcmRlcnNcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHBheW1lbnRzID0gYXdhaXQgUGF5bWVudFN1Y2Nlc3MuZmluZChcbiAgICAgICAge1xuICAgICAgICAgIHN0YXR1czogXCJzdWNjZXNzXCIsXG4gICAgICAgICAgaXRlbVRyYW5zYWN0aW9uczoge1xuICAgICAgICAgICAgJGVsZW1NYXRjaDogeyBpc0FwcHJvdmU6IGZhbHNlLCBpc0Rpc0FwcHJvdmU6IGZhbHNlIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgXCJpdGVtVHJhbnNhY3Rpb25zXCJcbiAgICAgICkucG9wdWxhdGUoXCJpdGVtVHJhbnNhY3Rpb25zLml0ZW1JZFwiLCBcIm5hbWUgcHJpY2VcIik7IC8vIFBvcHVsYXRlIG5hbWUgYW5kIHByaWNlIGZyb20gdGhlIHByb2R1Y3QgY29sbGVjdGlvblxuXG4gICAgICBjb25zb2xlLmxvZyhcIlBvcHVsYXRlZCBQYXltZW50czpcIiwgcGF5bWVudHMpO1xuXG4gICAgICAvLyBQcmVwYXJlIGFuIGFycmF5IG9mIHRyYW5zYWN0aW9uIGRldGFpbHNcbiAgICAgIGNvbnN0IHRyYW5zYWN0aW9uRGV0YWlscyA9IHBheW1lbnRzLmZsYXRNYXAoKHBheW1lbnQpID0+XG4gICAgICAgIHBheW1lbnQuaXRlbVRyYW5zYWN0aW9uc1xuICAgICAgICAgIC5maWx0ZXIoXG4gICAgICAgICAgICAodHJhbnNhY3Rpb24pID0+XG4gICAgICAgICAgICAgICF0cmFuc2FjdGlvbi5pc0FwcHJvdmUgJiZcbiAgICAgICAgICAgICAgIXRyYW5zYWN0aW9uLmlzRGlzQXBwcm92ZSAmJlxuICAgICAgICAgICAgICB0cmFuc2FjdGlvbi5pdGVtSWQgJiYgLy8gaXRlbUlkIG1ldmN1dCBtdT9cbiAgICAgICAgICAgICAgdHJhbnNhY3Rpb24uaXRlbUlkLm5hbWUgJiYgLy8gbmFtZSBhbGFuxLEgdmFyIG3EsT9cbiAgICAgICAgICAgICAgdHJhbnNhY3Rpb24ucHJpY2UgLy8gcHJpY2UgYWxhbsSxIHZhciBtxLE/XG4gICAgICAgICAgKVxuICAgICAgICAgIC5tYXAoKHRyYW5zYWN0aW9uKSA9PiAoe1xuICAgICAgICAgICAgcGF5bWVudFRyYW5zYWN0aW9uSWQ6IHRyYW5zYWN0aW9uLnBheW1lbnRUcmFuc2FjdGlvbklkLFxuICAgICAgICAgICAgaXRlbUlkOiB0cmFuc2FjdGlvbi5pdGVtSWQuX2lkLCAvLyBUaGUgT2JqZWN0SWQgb2YgdGhlIGl0ZW1cbiAgICAgICAgICAgIG5hbWU6IHRyYW5zYWN0aW9uLml0ZW1JZC5uYW1lLCAvLyBQb3B1bGF0ZWQgbmFtZSBvZiB0aGUgaXRlbVxuICAgICAgICAgICAgcHJpY2U6IHRyYW5zYWN0aW9uLnByaWNlLCAvLyBQb3B1bGF0ZWQgcHJpY2Ugb2YgdGhlIGl0ZW1cbiAgICAgICAgICB9KSlcbiAgICAgICk7XG4gICAgICBpZiAodHJhbnNhY3Rpb25EZXRhaWxzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcInRoZXJlIGlzIG5vIG9yZGVyIHRvIGFwcHJvdmVcIik7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgICBcIlRoZXJlIGlzIG5vIG9yZGVyIHRvIGFwcHJvdmVcIixcbiAgICAgICAgICA0MDEsXG4gICAgICAgICAgXCJub09yZGVyVG9BcHByb3ZlXCJcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyB0cmFuc2FjdGlvbkRldGFpbHMgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgIG5leHQoXG4gICAgICAgIG5ldyBBcGlFcnJvcihcbiAgICAgICAgICBcIkNvdWxkIG5vdCByZXRyaWV2ZSBwYXltZW50VHJhbnNhY3Rpb25JZHNcIixcbiAgICAgICAgICA1MDAsXG4gICAgICAgICAgXCJmZXRjaEVycm9yXCJcbiAgICAgICAgKVxuICAgICAgKTtcbiAgICB9XG4gIH0pO1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsZUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsa0JBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLGVBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFHLE9BQUEsR0FBQUosc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFJLE1BQUEsR0FBQUwsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFLLFNBQUEsR0FBQU4sc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFNLGVBQUEsR0FBQU4sT0FBQTtBQUNBLElBQUFPLFlBQUEsR0FBQVAsT0FBQTtBQUNBLElBQUFRLGNBQUEsR0FBQVIsT0FBQTtBQUNBLElBQUFTLG9CQUFBLEdBQUFULE9BQUE7QUFJQSxJQUFBVSxRQUFBLEdBQUFYLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBVyxTQUFBLEdBQUFYLE9BQUE7QUFJQSxJQUFBWSxZQUFBLEdBQUFaLE9BQUE7QUFHZ0QsU0FBQUQsdUJBQUFjLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFBQSxJQUFBRyxRQUFBLEdBRWhDQyxNQUFNLElBQUs7RUFDekI7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","map":{"version":3,"names":["_approvalOrders","_interopRequireDefault","require","_disapprovalOrders","_paymentSuccess","_seller","_users","_ApiError","_CheckExistence","_Permissions","_RequiredCheck","_ApproveMailToSeller","_Session","_approval","_submerchant","e","__esModule","default","_default","router","get","Session","req","res","checkPermissions","user","pendingSellers","Seller","find","isVerified","noExistVariable","status","json","error","console","log","send","ApiError","put","next","id","params","action","response","body","seller","findById","notFoundVariable","subMerchantData","locale","conversationId","subMerchantExternalId","subMerchantType","address","taxOffice","legalCompanyTitle","email","gsmNumber","name","identityNumber","undefined","taxNumber","iban","trim","currency","iyzicoResult","createSubMerchant","subMerchantKey","save","ApproveMailToSeller","message","rawResponse","RejectMailToSeller","findByIdAndDelete","users","Users","sellers","select","sellersWithSubMerchants","Promise","all","map","subMerchant","getSubMerchant","_id","toObject","post","paymentTransactionId","checkRequiredField","data","result","approvePayment","updateResult","PaymentSuccess","updateOne","$set","modifiedCount","payment","findOne","populate","transaction","itemTransactions","item","approvedOrderData","itemId","price","paidPrice","cartId","approvedOrder","ApprovalOrders","create","disApprovePayment","disApprovedOrderData","disApprovedOrder","DisApprovalOrders","payments","$elemMatch","isApprove","isDisApprove","transactionDetails","flatMap","filter","length","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["admin.js"],"sourcesContent":["import ApprovalOrders from \"../db/approval-orders\";\nimport DisApprovalOrders from \"../db/disapproval-orders\";\nimport PaymentSuccess from \"../db/payment-success\";\nimport Seller from \"../db/seller\";\nimport Users from \"../db/users\";\nimport ApiError from \"../errors/ApiError\";\nimport { noExistVariable, notFoundVariable } from \"../helpers/CheckExistence\";\nimport { checkPermissions } from \"../helpers/Permissions\";\nimport { checkRequiredField } from \"../helpers/RequiredCheck\";\nimport {\n  ApproveMailToSeller,\n  RejectMailToSeller,\n} from \"../middlewares/ApproveMailToSeller\";\nimport Session from \"../middlewares/Session\";\nimport {\n  approvePayment,\n  disApprovePayment,\n} from \"../services/iyzico/methods/approval\";\nimport {\n  createSubMerchant,\n  getSubMerchant,\n} from \"../services/iyzico/methods/submerchant\";\n\nexport default (router) => {\n  // Onay bekleyen seller'ları listeleme\n  router.get(\"/admin/seller/pending\", Session, async (req, res) => {\n    checkPermissions(req.user, [\"admin\"]);\n    try {\n      const pendingSellers = await Seller.find({ isVerified: false });\n      // if (!pendingSellers) {\n      //   throw new ApiError(\"Does not exist seller pending\");\n      // }\n      noExistVariable(pendingSellers, \"Seller\");\n      return res.status(200).json(pendingSellers);\n    } catch (error) {\n      console.log(error);\n      return res\n        .status(500)\n        .send(new ApiError(500, \"Satıcılar listelenirken hata oluştu.\"));\n    }\n  });\n\n  router.put(\"/admin/seller/verify/:id\", Session, async (req, res, next) => {\n    const { id } = req.params;\n    const { action, response } = req.body;\n\n    try {\n      checkPermissions(req.user, [\"admin\"]); // Yetki kontrolü\n      const seller = await Seller.findById(id);\n      notFoundVariable(seller, \"Seller\"); // Satıcı var mı kontrolü\n\n      if (seller.isVerified) {\n        return next(\n          new ApiError(\n            \"This seller is already verified\",\n            404,\n            \"alreadyVerified\"\n          )\n        );\n      }\n\n      if (action === \"approve\") {\n        // Satıcı bilgilerini iyzico'ya uygun formata çevir\n        const subMerchantData = {\n          locale: seller.locale,\n          conversationId: seller.conversationId,\n          subMerchantExternalId: seller.subMerchantExternalId,\n          subMerchantType: seller.subMerchantType,\n          address: seller.address,\n          taxOffice: seller.taxOffice,\n          legalCompanyTitle: seller.legalCompanyTitle,\n          email: seller.email,\n          gsmNumber: seller.gsmNumber,\n          name: seller.name,\n          //şundan itibaren bakıver tax ve buna\n          identityNumber:\n            seller.subMerchantType === \"PRIVATE_COMPANY\"\n              ? seller.identityNumber\n              : undefined,\n          taxNumber:\n            seller.subMerchantType === \"LIMITED_OR_JOINT_STOCK_COMPANY\"\n              ? seller.taxNumber\n              : undefined,\n          iban: seller.iban.trim(),\n          currency: seller.currency,\n        };\n        console.log(\"Kaydedilen IBAN:\", seller.iban);\n        console.log(\"Data = \", subMerchantData);\n\n        try {\n          const iyzicoResult = await createSubMerchant(subMerchantData);\n\n          if (iyzicoResult.status === \"success\") {\n            console.log(iyzicoResult);\n            seller.subMerchantKey = iyzicoResult.subMerchantKey;\n            seller.isVerified = true;\n            await seller.save();\n            await ApproveMailToSeller(req, res, next); // Onay e-postası gönder\n\n            return res.status(200).json({\n              message: \"Seller is verified and registered in iyzico\",\n              seller,\n            });\n          } else {\n            // İyzico hatası loglanıyor\n            console.log(\"Iyzipay Error:\", iyzicoResult);\n            return res.status(500).json({\n              status: \"Failed to register seller in iyzico\",\n              rawResponse: iyzicoResult,\n            });\n          }\n        } catch (error) {\n          console.log(\"Iyzipay API Error:\", error);\n          return res.status(500).json({\n            status: \"Failed to register seller in iyzico\",\n            error:\n              error.message || \"An error occurred while contacting Iyzipay\",\n          });\n        }\n      }\n\n      if (action === \"reject\") {\n        await RejectMailToSeller(req, res, async () => {\n          // Mail başarılı bir şekilde gönderilirse satıcıyı sil\n          await Seller.findByIdAndDelete(id);\n          return res\n            .status(200)\n            .json({ message: \"Seller is rejected and deleted\" });\n        });\n\n        // Burada erken return yaparak hata olmasını engelliyoruz\n        return;\n      }\n\n      return res.status(400).json(new ApiError(400, \"Invalid transaction\"));\n    } catch (error) {\n      console.error(error);\n      return next(\n        new ApiError(\n          500,\n          \"There is an error while processing the verification transaction\"\n        )\n      );\n    }\n  });\n\n  router.get(\"/admin/get-all-users\", Session, async (req, res) => {\n    checkPermissions(req.user, [\"admin\"]);\n\n    try {\n      const users = await Users.find();\n      res.status(200).json(users);\n    } catch (error) {\n      console.log(error);\n      throw new ApiError(\n        \"There must be error while get all users\",\n        404,\n        \"errorGetAllUsers\"\n      );\n    }\n  });\n\n  router.get(\"/admin/get-all-sellers\", Session, async (req, res) => {\n    checkPermissions(req.user, [\"admin\"]);\n    try {\n      const sellers = await Seller.find().select(\"-password\");\n      const sellersWithSubMerchants = await Promise.all(\n        sellers.map(async (seller) => {\n          try {\n            const subMerchant = await getSubMerchant({\n              locale: seller.locale || \"tr\",\n              conversationId: seller.conversationId,\n              subMerchantExternalId: seller.subMerchantExternalId,\n            });\n            return {\n              subMerchant,\n            };\n          } catch (error) {\n            console.error(\n              `SubMerchant data could not be retrieved for seller: ${seller._id}`,\n              error\n            );\n            return {\n              ...seller.toObject(),\n              subMerchant: null,\n            };\n          }\n        })\n      );\n\n      res.status(200).json({ sellers: sellersWithSubMerchants });\n    } catch (error) {\n      console.log(error);\n      throw new ApiError(\n        \"There must be error while get all sellers\",\n        404,\n        \"errorGetAllSellers\"\n      );\n    }\n  });\n  router.post(\"/admin/approve-order\", Session, async (req, res) => {\n    const { paymentTransactionId } = req.body;\n    checkRequiredField(paymentTransactionId, \"PaymentTransactionId\");\n\n    const data = {\n      paymentTransactionId,\n    };\n\n    try {\n      const result = await approvePayment(data);\n      // Update isApprove field in payment-success collection\n      const updateResult = await PaymentSuccess.updateOne(\n        { \"itemTransactions.paymentTransactionId\": paymentTransactionId }, // Locate the document with the specified transaction ID\n        { $set: { \"itemTransactions.$.isApprove\": true } } // Set isApprove to true for the matching item\n      );\n\n      // Check if any document was modified\n      if (updateResult.modifiedCount === 0) {\n        throw new ApiError(\n          \"No matching transaction found or it was already approved\",\n          404,\n          \"transactionNotFound\"\n        );\n      }\n\n      const payment = await PaymentSuccess.findOne(\n        { \"itemTransactions.paymentTransactionId\": paymentTransactionId },\n        \"itemTransactions cartId\"\n      ).populate(\"itemTransactions.itemId\", \"name price\");\n\n      const transaction = payment.itemTransactions.find(\n        (item) => item.paymentTransactionId === paymentTransactionId\n      );\n\n      if (!transaction) {\n        throw new ApiError(\"Transaction not found\", 404, \"transactionNotFound\");\n      }\n\n      // Create an ApprovedOrder record for the transaction\n      const approvedOrderData = {\n        paymentTransactionId: transaction.paymentTransactionId,\n        itemId: transaction.itemId._id,\n        name: transaction.itemId.name,\n        price: transaction.itemId.price,\n        paidPrice: transaction.paidPrice,\n        cartId: payment.cartId,\n      };\n\n      // Save the approved order to ApprovedOrders collection\n      const approvedOrder = await ApprovalOrders.create(approvedOrderData);\n      res.status(200).json({ result, approvedOrder });\n    } catch (error) {\n      console.log(error);\n    }\n  });\n  router.post(\"/admin/disapprove-order\", Session, async (req, res) => {\n    const { paymentTransactionId } = req.body;\n    checkRequiredField(paymentTransactionId, \"PaymentTransactionId\");\n\n    const data = {\n      paymentTransactionId,\n    };\n\n    try {\n      const result = await disApprovePayment(data);\n      // Update isApprove field in payment-success collection\n      const updateResult = await PaymentSuccess.updateOne(\n        { \"itemTransactions.paymentTransactionId\": paymentTransactionId }, // Locate the document with the specified transaction ID\n        {\n          $set: {\n            \"itemTransactions.$.isDisApprove\": true,\n            \"itemTransactions.$.isApprove\": false,\n          },\n        } // Set isApprove to true for the matching item\n      );\n\n      // Check if any document was modified\n      if (updateResult.modifiedCount === 0) {\n        throw new ApiError(\n          \"No matching transaction found or it was already approved\",\n          404,\n          \"transactionNotFound\"\n        );\n      }\n\n      const payment = await PaymentSuccess.findOne(\n        { \"itemTransactions.paymentTransactionId\": paymentTransactionId },\n        \"itemTransactions cartId\"\n      ).populate(\"itemTransactions.itemId\", \"name price\");\n\n      const transaction = payment.itemTransactions.find(\n        (item) => item.paymentTransactionId === paymentTransactionId\n      );\n\n      if (!transaction) {\n        throw new ApiError(\"Transaction not found\", 404, \"transactionNotFound\");\n      }\n\n      // Create an ApprovedOrder record for the transaction\n      const disApprovedOrderData = {\n        paymentTransactionId: transaction.paymentTransactionId,\n        itemId: transaction.itemId._id,\n        name: transaction.itemId.name,\n        price: transaction.itemId.price,\n        paidPrice: transaction.paidPrice,\n        cartId: payment.cartId,\n      };\n\n      // Save the approved order to ApprovedOrders collection\n      const disApprovedOrder = await DisApprovalOrders.create(\n        disApprovedOrderData\n      );\n      res.status(200).json({ result, disApprovedOrder });\n    } catch (error) {\n      console.log(error);\n    }\n  });\n  router.get(\"/admin/waiting-orders\", Session, async (req, res, next) => {\n    try {\n      const payments = await PaymentSuccess.find(\n        {\n          status: \"success\",\n          itemTransactions: {\n            $elemMatch: { isApprove: false, isDisApprove: false },\n          },\n        },\n        \"itemTransactions\"\n      ).populate(\"itemTransactions.itemId\", \"name price\"); // Populate name and price from the product collection\n\n      console.log(\"Populated Payments:\", payments);\n\n      // Prepare an array of transaction details\n      const transactionDetails = payments.flatMap((payment) =>\n        payment.itemTransactions\n          .filter(\n            (transaction) =>\n              !transaction.isApprove &&\n              !transaction.isDisApprove &&\n              transaction.itemId && // itemId mevcut mu?\n              transaction.itemId.name && // name alanı var mı?\n              transaction.price // price alanı var mı?\n          )\n          .map((transaction) => ({\n            paymentTransactionId: transaction.paymentTransactionId,\n            itemId: transaction.itemId._id, // The ObjectId of the item\n            name: transaction.itemId.name, // Populated name of the item\n            price: transaction.price, // Populated price of the item\n          }))\n      );\n      if (transactionDetails.length === 0) {\n        console.log(\"there is no order to approve\");\n        throw new ApiError(\n          \"There is no order to approve\",\n          401,\n          \"noOrderToApprove\"\n        );\n      }\n\n      res.status(200).json({ transactionDetails });\n    } catch (error) {\n      console.log(error);\n      next(\n        new ApiError(\n          \"Could not retrieve paymentTransactionIds\",\n          500,\n          \"fetchError\"\n        )\n      );\n    }\n  });\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1734359439135},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/admin.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _approvalOrders = _interopRequireDefault(require(\"../db/approval-orders\"));\nvar _disapprovalOrders = _interopRequireDefault(require(\"../db/disapproval-orders\"));\nvar _paymentSuccess = _interopRequireDefault(require(\"../db/payment-success\"));\nvar _seller = _interopRequireDefault(require(\"../db/seller\"));\nvar _users = _interopRequireDefault(require(\"../db/users\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _CheckExistence = require(\"../helpers/CheckExistence\");\nvar _Permissions = require(\"../helpers/Permissions\");\nvar _RequiredCheck = require(\"../helpers/RequiredCheck\");\nvar _ApproveMailToSeller = require(\"../middlewares/ApproveMailToSeller\");\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nvar _approval = require(\"../services/iyzico/methods/approval\");\nvar _submerchant = require(\"../services/iyzico/methods/submerchant\");\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = router => {\n  // Onay bekleyen seller'ları listeleme\n  router.get(\"/admin/seller/pending\", _Session.default, async (req, res) => {\n    (0, _Permissions.checkPermissions)(req.user, [\"admin\"]);\n    try {\n      const pendingSellers = await _seller.default.find({\n        isVerified: false\n      });\n      // if (!pendingSellers) {\n      //   throw new ApiError(\"Does not exist seller pending\");\n      // }\n      (0, _CheckExistence.noExistVariable)(pendingSellers, \"Seller\");\n      return res.status(200).json(pendingSellers);\n    } catch (error) {\n      console.log(error);\n      return res.status(500).send(new _ApiError.default(500, \"Satıcılar listelenirken hata oluştu.\"));\n    }\n  });\n  router.put(\"/admin/seller/verify/:id\", _Session.default, async (req, res, next) => {\n    const {\n      id\n    } = req.params;\n    const {\n      action,\n      response\n    } = req.body;\n    try {\n      (0, _Permissions.checkPermissions)(req.user, [\"admin\"]); // Yetki kontrolü\n      const seller = await _seller.default.findById(id);\n      (0, _CheckExistence.notFoundVariable)(seller, \"Seller\"); // Satıcı var mı kontrolü\n\n      if (seller.isVerified) {\n        return next(new _ApiError.default(\"This seller is already verified\", 404, \"alreadyVerified\"));\n      }\n      if (action === \"approve\") {\n        // Satıcı bilgilerini iyzico'ya uygun formata çevir\n        const subMerchantData = {\n          locale: seller.locale,\n          conversationId: seller.conversationId,\n          subMerchantExternalId: seller.subMerchantExternalId,\n          subMerchantType: seller.subMerchantType,\n          address: seller.address,\n          taxOffice: seller.taxOffice,\n          legalCompanyTitle: seller.legalCompanyTitle,\n          email: seller.email,\n          gsmNumber: seller.gsmNumber,\n          name: seller.name,\n          //şundan itibaren bakıver tax ve buna\n          identityNumber: seller.subMerchantType === \"PRIVATE_COMPANY\" ? seller.identityNumber : undefined,\n          taxNumber: seller.subMerchantType === \"LIMITED_OR_JOINT_STOCK_COMPANY\" ? seller.taxNumber : undefined,\n          iban: seller.iban.trim(),\n          currency: seller.currency\n        };\n        console.log(\"Kaydedilen IBAN:\", seller.iban);\n        console.log(\"Data = \", subMerchantData);\n        try {\n          const iyzicoResult = await (0, _submerchant.createSubMerchant)(subMerchantData);\n          if (iyzicoResult.status === \"success\") {\n            console.log(iyzicoResult);\n            seller.subMerchantKey = iyzicoResult.subMerchantKey;\n            seller.isVerified = true;\n            await seller.save();\n            await (0, _ApproveMailToSeller.ApproveMailToSeller)(req, res, next); // Onay e-postası gönder\n\n            return res.status(200).json({\n              message: \"Seller is verified and registered in iyzico\",\n              seller\n            });\n          } else {\n            // İyzico hatası loglanıyor\n            console.log(\"Iyzipay Error:\", iyzicoResult);\n            return res.status(500).json({\n              status: \"Failed to register seller in iyzico\",\n              rawResponse: iyzicoResult\n            });\n          }\n        } catch (error) {\n          console.log(\"Iyzipay API Error:\", error);\n          return res.status(500).json({\n            status: \"Failed to register seller in iyzico\",\n            error: error.message || \"An error occurred while contacting Iyzipay\"\n          });\n        }\n      }\n      if (action === \"reject\") {\n        await (0, _ApproveMailToSeller.RejectMailToSeller)(req, res, async () => {\n          // Mail başarılı bir şekilde gönderilirse satıcıyı sil\n          await _seller.default.findByIdAndDelete(id);\n          return res.status(200).json({\n            message: \"Seller is rejected and deleted\"\n          });\n        });\n\n        // Burada erken return yaparak hata olmasını engelliyoruz\n        return;\n      }\n      return res.status(400).json(new _ApiError.default(400, \"Invalid transaction\"));\n    } catch (error) {\n      console.error(error);\n      return next(new _ApiError.default(500, \"There is an error while processing the verification transaction\"));\n    }\n  });\n  router.get(\"/admin/get-all-users\", _Session.default, async (req, res) => {\n    (0, _Permissions.checkPermissions)(req.user, [\"admin\"]);\n    try {\n      const users = await _users.default.find();\n      res.status(200).json(users);\n    } catch (error) {\n      console.log(error);\n      throw new _ApiError.default(\"There must be error while get all users\", 404, \"errorGetAllUsers\");\n    }\n  });\n  router.get(\"/admin/get-all-sellers\", _Session.default, async (req, res) => {\n    (0, _Permissions.checkPermissions)(req.user, [\"admin\"]);\n    try {\n      const sellers = await _seller.default.find().select(\"-password\");\n      const sellersWithSubMerchants = await Promise.all(sellers.map(async seller => {\n        try {\n          const subMerchant = await (0, _submerchant.getSubMerchant)({\n            locale: seller.locale || \"tr\",\n            conversationId: seller.conversationId,\n            subMerchantExternalId: seller.subMerchantExternalId\n          });\n          return {\n            subMerchant\n          };\n        } catch (error) {\n          console.error(`SubMerchant data could not be retrieved for seller: ${seller._id}`, error);\n          return {\n            ...seller.toObject(),\n            subMerchant: null\n          };\n        }\n      }));\n      res.status(200).json({\n        sellers: sellersWithSubMerchants\n      });\n    } catch (error) {\n      console.log(error);\n      throw new _ApiError.default(\"There must be error while get all sellers\", 404, \"errorGetAllSellers\");\n    }\n  });\n  router.post(\"/admin/approve-order\", _Session.default, async (req, res) => {\n    const {\n      paymentTransactionId\n    } = req.body;\n    (0, _RequiredCheck.checkRequiredField)(paymentTransactionId, \"PaymentTransactionId\");\n    const data = {\n      paymentTransactionId\n    };\n    try {\n      const result = await (0, _approval.approvePayment)(data);\n      // Update isApprove field in payment-success collection\n      const updateResult = await _paymentSuccess.default.updateOne({\n        \"itemTransactions.paymentTransactionId\": paymentTransactionId\n      },\n      // Locate the document with the specified transaction ID\n      {\n        $set: {\n          \"itemTransactions.$.isApprove\": true\n        }\n      } // Set isApprove to true for the matching item\n      );\n\n      // Check if any document was modified\n      if (updateResult.modifiedCount === 0) {\n        throw new _ApiError.default(\"No matching transaction found or it was already approved\", 404, \"transactionNotFound\");\n      }\n      const payment = await _paymentSuccess.default.findOne({\n        \"itemTransactions.paymentTransactionId\": paymentTransactionId\n      }, \"itemTransactions cartId\").populate(\"itemTransactions.itemId\", \"name price\");\n      const transaction = payment.itemTransactions.find(item => item.paymentTransactionId === paymentTransactionId);\n      if (!transaction) {\n        throw new _ApiError.default(\"Transaction not found\", 404, \"transactionNotFound\");\n      }\n\n      // Create an ApprovedOrder record for the transaction\n      const approvedOrderData = {\n        paymentTransactionId: transaction.paymentTransactionId,\n        itemId: transaction.itemId._id,\n        name: transaction.itemId.name,\n        price: transaction.itemId.price,\n        paidPrice: transaction.paidPrice,\n        cartId: payment.cartId\n      };\n\n      // Save the approved order to ApprovedOrders collection\n      const approvedOrder = await _approvalOrders.default.create(approvedOrderData);\n      res.status(200).json({\n        result,\n        approvedOrder\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  });\n  router.post(\"/admin/disapprove-order\", _Session.default, async (req, res) => {\n    const {\n      paymentTransactionId\n    } = req.body;\n    (0, _RequiredCheck.checkRequiredField)(paymentTransactionId, \"PaymentTransactionId\");\n    const data = {\n      paymentTransactionId\n    };\n    try {\n      const result = await (0, _approval.disApprovePayment)(data);\n      // Update isApprove field in payment-success collection\n      const updateResult = await _paymentSuccess.default.updateOne({\n        \"itemTransactions.paymentTransactionId\": paymentTransactionId\n      },\n      // Locate the document with the specified transaction ID\n      {\n        $set: {\n          \"itemTransactions.$.isDisApprove\": true,\n          \"itemTransactions.$.isApprove\": false\n        }\n      } // Set isApprove to true for the matching item\n      );\n\n      // Check if any document was modified\n      if (updateResult.modifiedCount === 0) {\n        throw new _ApiError.default(\"No matching transaction found or it was already approved\", 404, \"transactionNotFound\");\n      }\n      const payment = await _paymentSuccess.default.findOne({\n        \"itemTransactions.paymentTransactionId\": paymentTransactionId\n      }, \"itemTransactions cartId\").populate(\"itemTransactions.itemId\", \"name price\");\n      const transaction = payment.itemTransactions.find(item => item.paymentTransactionId === paymentTransactionId);\n      if (!transaction) {\n        throw new _ApiError.default(\"Transaction not found\", 404, \"transactionNotFound\");\n      }\n\n      // Create an ApprovedOrder record for the transaction\n      const disApprovedOrderData = {\n        paymentTransactionId: transaction.paymentTransactionId,\n        itemId: transaction.itemId._id,\n        name: transaction.itemId.name,\n        price: transaction.itemId.price,\n        paidPrice: transaction.paidPrice,\n        cartId: payment.cartId\n      };\n\n      // Save the approved order to ApprovedOrders collection\n      const disApprovedOrder = await _disapprovalOrders.default.create(disApprovedOrderData);\n      res.status(200).json({\n        result,\n        disApprovedOrder\n      });\n    } catch (error) {\n      console.log(error);\n    }\n  });\n  router.get(\"/admin/waiting-orders\", _Session.default, async (req, res, next) => {\n    try {\n      const payments = await _paymentSuccess.default.find({\n        status: \"success\",\n        itemTransactions: {\n          $elemMatch: {\n            isApprove: false,\n            isDisApprove: false\n          }\n        }\n      }, \"itemTransactions\").populate(\"itemTransactions.itemId\", \"name price\"); // Populate name and price from the product collection\n\n      console.log(\"Populated Payments:\", payments);\n\n      // Prepare an array of transaction details\n      const transactionDetails = payments.flatMap(payment => payment.itemTransactions.filter(transaction => !transaction.isApprove && !transaction.isDisApprove && transaction.itemId &&\n      // itemId mevcut mu?\n      transaction.itemId.name &&\n      // name alanı var mı?\n      transaction.price // price alanı var mı?\n      ).map(transaction => ({\n        paymentTransactionId: transaction.paymentTransactionId,\n        itemId: transaction.itemId._id,\n        // The ObjectId of the item\n        name: transaction.itemId.name,\n        // Populated name of the item\n        price: transaction.price // Populated price of the item\n      })));\n      if (transactionDetails.length === 0) {\n        console.log(\"there is no order to approve\");\n        throw new _ApiError.default(\"There is no order to approve\", 401, \"noOrderToApprove\");\n      }\n      res.status(200).json({\n        transactionDetails\n      });\n    } catch (error) {\n      console.log(error);\n      next(new _ApiError.default(\"Could not retrieve paymentTransactionIds\", 500, \"fetchError\"));\n    }\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYXBwcm92YWxPcmRlcnMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9kaXNhcHByb3ZhbE9yZGVycyIsIl9wYXltZW50U3VjY2VzcyIsIl9zZWxsZXIiLCJfdXNlcnMiLCJfQXBpRXJyb3IiLCJfQ2hlY2tFeGlzdGVuY2UiLCJfUGVybWlzc2lvbnMiLCJfUmVxdWlyZWRDaGVjayIsIl9BcHByb3ZlTWFpbFRvU2VsbGVyIiwiX1Nlc3Npb24iLCJfYXBwcm92YWwiLCJfc3VibWVyY2hhbnQiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfZGVmYXVsdCIsInJvdXRlciIsImdldCIsIlNlc3Npb24iLCJyZXEiLCJyZXMiLCJjaGVja1Blcm1pc3Npb25zIiwidXNlciIsInBlbmRpbmdTZWxsZXJzIiwiU2VsbGVyIiwiZmluZCIsImlzVmVyaWZpZWQiLCJub0V4aXN0VmFyaWFibGUiLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwic2VuZCIsIkFwaUVycm9yIiwicHV0IiwibmV4dCIsImlkIiwicGFyYW1zIiwiYWN0aW9uIiwicmVzcG9uc2UiLCJib2R5Iiwic2VsbGVyIiwiZmluZEJ5SWQiLCJub3RGb3VuZFZhcmlhYmxlIiwic3ViTWVyY2hhbnREYXRhIiwibG9jYWxlIiwiY29udmVyc2F0aW9uSWQiLCJzdWJNZXJjaGFudEV4dGVybmFsSWQiLCJzdWJNZXJjaGFudFR5cGUiLCJhZGRyZXNzIiwidGF4T2ZmaWNlIiwibGVnYWxDb21wYW55VGl0bGUiLCJlbWFpbCIsImdzbU51bWJlciIsIm5hbWUiLCJpZGVudGl0eU51bWJlciIsInVuZGVmaW5lZCIsInRheE51bWJlciIsImliYW4iLCJ0cmltIiwiY3VycmVuY3kiLCJpeXppY29SZXN1bHQiLCJjcmVhdGVTdWJNZXJjaGFudCIsInN1Yk1lcmNoYW50S2V5Iiwic2F2ZSIsIkFwcHJvdmVNYWlsVG9TZWxsZXIiLCJtZXNzYWdlIiwicmF3UmVzcG9uc2UiLCJSZWplY3RNYWlsVG9TZWxsZXIiLCJmaW5kQnlJZEFuZERlbGV0ZSIsInVzZXJzIiwiVXNlcnMiLCJzZWxsZXJzIiwic2VsZWN0Iiwic2VsbGVyc1dpdGhTdWJNZXJjaGFudHMiLCJQcm9taXNlIiwiYWxsIiwibWFwIiwic3ViTWVyY2hhbnQiLCJnZXRTdWJNZXJjaGFudCIsIl9pZCIsInRvT2JqZWN0IiwicG9zdCIsInBheW1lbnRUcmFuc2FjdGlvbklkIiwiY2hlY2tSZXF1aXJlZEZpZWxkIiwiZGF0YSIsInJlc3VsdCIsImFwcHJvdmVQYXltZW50IiwidXBkYXRlUmVzdWx0IiwiUGF5bWVudFN1Y2Nlc3MiLCJ1cGRhdGVPbmUiLCIkc2V0IiwibW9kaWZpZWRDb3VudCIsInBheW1lbnQiLCJmaW5kT25lIiwicG9wdWxhdGUiLCJ0cmFuc2FjdGlvbiIsIml0ZW1UcmFuc2FjdGlvbnMiLCJpdGVtIiwiYXBwcm92ZWRPcmRlckRhdGEiLCJpdGVtSWQiLCJwcmljZSIsInBhaWRQcmljZSIsImNhcnRJZCIsImFwcHJvdmVkT3JkZXIiLCJBcHByb3ZhbE9yZGVycyIsImNyZWF0ZSIsImRpc0FwcHJvdmVQYXltZW50IiwiZGlzQXBwcm92ZWRPcmRlckRhdGEiLCJkaXNBcHByb3ZlZE9yZGVyIiwiRGlzQXBwcm92YWxPcmRlcnMiLCJwYXltZW50cyIsIiRlbGVtTWF0Y2giLCJpc0FwcHJvdmUiLCJpc0Rpc0FwcHJvdmUiLCJ0cmFuc2FjdGlvbkRldGFpbHMiLCJmbGF0TWFwIiwiZmlsdGVyIiwibGVuZ3RoIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3JvdXRlcy8iLCJzb3VyY2VzIjpbImFkbWluLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBBcHByb3ZhbE9yZGVycyBmcm9tIFwiLi4vZGIvYXBwcm92YWwtb3JkZXJzXCI7XG5pbXBvcnQgRGlzQXBwcm92YWxPcmRlcnMgZnJvbSBcIi4uL2RiL2Rpc2FwcHJvdmFsLW9yZGVyc1wiO1xuaW1wb3J0IFBheW1lbnRTdWNjZXNzIGZyb20gXCIuLi9kYi9wYXltZW50LXN1Y2Nlc3NcIjtcbmltcG9ydCBTZWxsZXIgZnJvbSBcIi4uL2RiL3NlbGxlclwiO1xuaW1wb3J0IFVzZXJzIGZyb20gXCIuLi9kYi91c2Vyc1wiO1xuaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuLi9lcnJvcnMvQXBpRXJyb3JcIjtcbmltcG9ydCB7IG5vRXhpc3RWYXJpYWJsZSwgbm90Rm91bmRWYXJpYWJsZSB9IGZyb20gXCIuLi9oZWxwZXJzL0NoZWNrRXhpc3RlbmNlXCI7XG5pbXBvcnQgeyBjaGVja1Blcm1pc3Npb25zIH0gZnJvbSBcIi4uL2hlbHBlcnMvUGVybWlzc2lvbnNcIjtcbmltcG9ydCB7IGNoZWNrUmVxdWlyZWRGaWVsZCB9IGZyb20gXCIuLi9oZWxwZXJzL1JlcXVpcmVkQ2hlY2tcIjtcbmltcG9ydCB7XG4gIEFwcHJvdmVNYWlsVG9TZWxsZXIsXG4gIFJlamVjdE1haWxUb1NlbGxlcixcbn0gZnJvbSBcIi4uL21pZGRsZXdhcmVzL0FwcHJvdmVNYWlsVG9TZWxsZXJcIjtcbmltcG9ydCBTZXNzaW9uIGZyb20gXCIuLi9taWRkbGV3YXJlcy9TZXNzaW9uXCI7XG5pbXBvcnQge1xuICBhcHByb3ZlUGF5bWVudCxcbiAgZGlzQXBwcm92ZVBheW1lbnQsXG59IGZyb20gXCIuLi9zZXJ2aWNlcy9peXppY28vbWV0aG9kcy9hcHByb3ZhbFwiO1xuaW1wb3J0IHtcbiAgY3JlYXRlU3ViTWVyY2hhbnQsXG4gIGdldFN1Yk1lcmNoYW50LFxufSBmcm9tIFwiLi4vc2VydmljZXMvaXl6aWNvL21ldGhvZHMvc3VibWVyY2hhbnRcIjtcblxuZXhwb3J0IGRlZmF1bHQgKHJvdXRlcikgPT4ge1xuICAvLyBPbmF5IGJla2xleWVuIHNlbGxlcidsYXLEsSBsaXN0ZWxlbWVcbiAgcm91dGVyLmdldChcIi9hZG1pbi9zZWxsZXIvcGVuZGluZ1wiLCBTZXNzaW9uLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICBjaGVja1Blcm1pc3Npb25zKHJlcS51c2VyLCBbXCJhZG1pblwiXSk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHBlbmRpbmdTZWxsZXJzID0gYXdhaXQgU2VsbGVyLmZpbmQoeyBpc1ZlcmlmaWVkOiBmYWxzZSB9KTtcbiAgICAgIC8vIGlmICghcGVuZGluZ1NlbGxlcnMpIHtcbiAgICAgIC8vICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiRG9lcyBub3QgZXhpc3Qgc2VsbGVyIHBlbmRpbmdcIik7XG4gICAgICAvLyB9XG4gICAgICBub0V4aXN0VmFyaWFibGUocGVuZGluZ1NlbGxlcnMsIFwiU2VsbGVyXCIpO1xuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHBlbmRpbmdTZWxsZXJzKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgcmV0dXJuIHJlc1xuICAgICAgICAuc3RhdHVzKDUwMClcbiAgICAgICAgLnNlbmQobmV3IEFwaUVycm9yKDUwMCwgXCJTYXTEsWPEsWxhciBsaXN0ZWxlbmlya2VuIGhhdGEgb2x1xZ90dS5cIikpO1xuICAgIH1cbiAgfSk7XG5cbiAgcm91dGVyLnB1dChcIi9hZG1pbi9zZWxsZXIvdmVyaWZ5LzppZFwiLCBTZXNzaW9uLCBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgICBjb25zdCB7IGlkIH0gPSByZXEucGFyYW1zO1xuICAgIGNvbnN0IHsgYWN0aW9uLCByZXNwb25zZSB9ID0gcmVxLmJvZHk7XG5cbiAgICB0cnkge1xuICAgICAgY2hlY2tQZXJtaXNzaW9ucyhyZXEudXNlciwgW1wiYWRtaW5cIl0pOyAvLyBZZXRraSBrb250cm9sw7xcbiAgICAgIGNvbnN0IHNlbGxlciA9IGF3YWl0IFNlbGxlci5maW5kQnlJZChpZCk7XG4gICAgICBub3RGb3VuZFZhcmlhYmxlKHNlbGxlciwgXCJTZWxsZXJcIik7IC8vIFNhdMSxY8SxIHZhciBtxLEga29udHJvbMO8XG5cbiAgICAgIGlmIChzZWxsZXIuaXNWZXJpZmllZCkge1xuICAgICAgICByZXR1cm4gbmV4dChcbiAgICAgICAgICBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgICBcIlRoaXMgc2VsbGVyIGlzIGFscmVhZHkgdmVyaWZpZWRcIixcbiAgICAgICAgICAgIDQwNCxcbiAgICAgICAgICAgIFwiYWxyZWFkeVZlcmlmaWVkXCJcbiAgICAgICAgICApXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGlmIChhY3Rpb24gPT09IFwiYXBwcm92ZVwiKSB7XG4gICAgICAgIC8vIFNhdMSxY8SxIGJpbGdpbGVyaW5pIGl5emljbyd5YSB1eWd1biBmb3JtYXRhIMOnZXZpclxuICAgICAgICBjb25zdCBzdWJNZXJjaGFudERhdGEgPSB7XG4gICAgICAgICAgbG9jYWxlOiBzZWxsZXIubG9jYWxlLFxuICAgICAgICAgIGNvbnZlcnNhdGlvbklkOiBzZWxsZXIuY29udmVyc2F0aW9uSWQsXG4gICAgICAgICAgc3ViTWVyY2hhbnRFeHRlcm5hbElkOiBzZWxsZXIuc3ViTWVyY2hhbnRFeHRlcm5hbElkLFxuICAgICAgICAgIHN1Yk1lcmNoYW50VHlwZTogc2VsbGVyLnN1Yk1lcmNoYW50VHlwZSxcbiAgICAgICAgICBhZGRyZXNzOiBzZWxsZXIuYWRkcmVzcyxcbiAgICAgICAgICB0YXhPZmZpY2U6IHNlbGxlci50YXhPZmZpY2UsXG4gICAgICAgICAgbGVnYWxDb21wYW55VGl0bGU6IHNlbGxlci5sZWdhbENvbXBhbnlUaXRsZSxcbiAgICAgICAgICBlbWFpbDogc2VsbGVyLmVtYWlsLFxuICAgICAgICAgIGdzbU51bWJlcjogc2VsbGVyLmdzbU51bWJlcixcbiAgICAgICAgICBuYW1lOiBzZWxsZXIubmFtZSxcbiAgICAgICAgICAvL8WfdW5kYW4gaXRpYmFyZW4gYmFrxLF2ZXIgdGF4IHZlIGJ1bmFcbiAgICAgICAgICBpZGVudGl0eU51bWJlcjpcbiAgICAgICAgICAgIHNlbGxlci5zdWJNZXJjaGFudFR5cGUgPT09IFwiUFJJVkFURV9DT01QQU5ZXCJcbiAgICAgICAgICAgICAgPyBzZWxsZXIuaWRlbnRpdHlOdW1iZXJcbiAgICAgICAgICAgICAgOiB1bmRlZmluZWQsXG4gICAgICAgICAgdGF4TnVtYmVyOlxuICAgICAgICAgICAgc2VsbGVyLnN1Yk1lcmNoYW50VHlwZSA9PT0gXCJMSU1JVEVEX09SX0pPSU5UX1NUT0NLX0NPTVBBTllcIlxuICAgICAgICAgICAgICA/IHNlbGxlci50YXhOdW1iZXJcbiAgICAgICAgICAgICAgOiB1bmRlZmluZWQsXG4gICAgICAgICAgaWJhbjogc2VsbGVyLmliYW4udHJpbSgpLFxuICAgICAgICAgIGN1cnJlbmN5OiBzZWxsZXIuY3VycmVuY3ksXG4gICAgICAgIH07XG4gICAgICAgIGNvbnNvbGUubG9nKFwiS2F5ZGVkaWxlbiBJQkFOOlwiLCBzZWxsZXIuaWJhbik7XG4gICAgICAgIGNvbnNvbGUubG9nKFwiRGF0YSA9IFwiLCBzdWJNZXJjaGFudERhdGEpO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgaXl6aWNvUmVzdWx0ID0gYXdhaXQgY3JlYXRlU3ViTWVyY2hhbnQoc3ViTWVyY2hhbnREYXRhKTtcblxuICAgICAgICAgIGlmIChpeXppY29SZXN1bHQuc3RhdHVzID09PSBcInN1Y2Nlc3NcIikge1xuICAgICAgICAgICAgY29uc29sZS5sb2coaXl6aWNvUmVzdWx0KTtcbiAgICAgICAgICAgIHNlbGxlci5zdWJNZXJjaGFudEtleSA9IGl5emljb1Jlc3VsdC5zdWJNZXJjaGFudEtleTtcbiAgICAgICAgICAgIHNlbGxlci5pc1ZlcmlmaWVkID0gdHJ1ZTtcbiAgICAgICAgICAgIGF3YWl0IHNlbGxlci5zYXZlKCk7XG4gICAgICAgICAgICBhd2FpdCBBcHByb3ZlTWFpbFRvU2VsbGVyKHJlcSwgcmVzLCBuZXh0KTsgLy8gT25heSBlLXBvc3Rhc8SxIGfDtm5kZXJcblxuICAgICAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICAgICAgICAgICAgbWVzc2FnZTogXCJTZWxsZXIgaXMgdmVyaWZpZWQgYW5kIHJlZ2lzdGVyZWQgaW4gaXl6aWNvXCIsXG4gICAgICAgICAgICAgIHNlbGxlcixcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyDEsHl6aWNvIGhhdGFzxLEgbG9nbGFuxLF5b3JcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiSXl6aXBheSBFcnJvcjpcIiwgaXl6aWNvUmVzdWx0KTtcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7XG4gICAgICAgICAgICAgIHN0YXR1czogXCJGYWlsZWQgdG8gcmVnaXN0ZXIgc2VsbGVyIGluIGl5emljb1wiLFxuICAgICAgICAgICAgICByYXdSZXNwb25zZTogaXl6aWNvUmVzdWx0LFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGNvbnNvbGUubG9nKFwiSXl6aXBheSBBUEkgRXJyb3I6XCIsIGVycm9yKTtcbiAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgICAgICAgICAgc3RhdHVzOiBcIkZhaWxlZCB0byByZWdpc3RlciBzZWxsZXIgaW4gaXl6aWNvXCIsXG4gICAgICAgICAgICBlcnJvcjpcbiAgICAgICAgICAgICAgZXJyb3IubWVzc2FnZSB8fCBcIkFuIGVycm9yIG9jY3VycmVkIHdoaWxlIGNvbnRhY3RpbmcgSXl6aXBheVwiLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChhY3Rpb24gPT09IFwicmVqZWN0XCIpIHtcbiAgICAgICAgYXdhaXQgUmVqZWN0TWFpbFRvU2VsbGVyKHJlcSwgcmVzLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgLy8gTWFpbCBiYcWfYXLEsWzEsSBiaXIgxZ9la2lsZGUgZ8O2bmRlcmlsaXJzZSBzYXTEsWPEsXnEsSBzaWxcbiAgICAgICAgICBhd2FpdCBTZWxsZXIuZmluZEJ5SWRBbmREZWxldGUoaWQpO1xuICAgICAgICAgIHJldHVybiByZXNcbiAgICAgICAgICAgIC5zdGF0dXMoMjAwKVxuICAgICAgICAgICAgLmpzb24oeyBtZXNzYWdlOiBcIlNlbGxlciBpcyByZWplY3RlZCBhbmQgZGVsZXRlZFwiIH0pO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBCdXJhZGEgZXJrZW4gcmV0dXJuIHlhcGFyYWsgaGF0YSBvbG1hc8SxbsSxIGVuZ2VsbGl5b3J1elxuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbihuZXcgQXBpRXJyb3IoNDAwLCBcIkludmFsaWQgdHJhbnNhY3Rpb25cIikpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgIHJldHVybiBuZXh0KFxuICAgICAgICBuZXcgQXBpRXJyb3IoXG4gICAgICAgICAgNTAwLFxuICAgICAgICAgIFwiVGhlcmUgaXMgYW4gZXJyb3Igd2hpbGUgcHJvY2Vzc2luZyB0aGUgdmVyaWZpY2F0aW9uIHRyYW5zYWN0aW9uXCJcbiAgICAgICAgKVxuICAgICAgKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJvdXRlci5nZXQoXCIvYWRtaW4vZ2V0LWFsbC11c2Vyc1wiLCBTZXNzaW9uLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgICBjaGVja1Blcm1pc3Npb25zKHJlcS51c2VyLCBbXCJhZG1pblwiXSk7XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgdXNlcnMgPSBhd2FpdCBVc2Vycy5maW5kKCk7XG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih1c2Vycyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgXCJUaGVyZSBtdXN0IGJlIGVycm9yIHdoaWxlIGdldCBhbGwgdXNlcnNcIixcbiAgICAgICAgNDA0LFxuICAgICAgICBcImVycm9yR2V0QWxsVXNlcnNcIlxuICAgICAgKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJvdXRlci5nZXQoXCIvYWRtaW4vZ2V0LWFsbC1zZWxsZXJzXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGNoZWNrUGVybWlzc2lvbnMocmVxLnVzZXIsIFtcImFkbWluXCJdKTtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc2VsbGVycyA9IGF3YWl0IFNlbGxlci5maW5kKCkuc2VsZWN0KFwiLXBhc3N3b3JkXCIpO1xuICAgICAgY29uc3Qgc2VsbGVyc1dpdGhTdWJNZXJjaGFudHMgPSBhd2FpdCBQcm9taXNlLmFsbChcbiAgICAgICAgc2VsbGVycy5tYXAoYXN5bmMgKHNlbGxlcikgPT4ge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBzdWJNZXJjaGFudCA9IGF3YWl0IGdldFN1Yk1lcmNoYW50KHtcbiAgICAgICAgICAgICAgbG9jYWxlOiBzZWxsZXIubG9jYWxlIHx8IFwidHJcIixcbiAgICAgICAgICAgICAgY29udmVyc2F0aW9uSWQ6IHNlbGxlci5jb252ZXJzYXRpb25JZCxcbiAgICAgICAgICAgICAgc3ViTWVyY2hhbnRFeHRlcm5hbElkOiBzZWxsZXIuc3ViTWVyY2hhbnRFeHRlcm5hbElkLFxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICBzdWJNZXJjaGFudCxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoXG4gICAgICAgICAgICAgIGBTdWJNZXJjaGFudCBkYXRhIGNvdWxkIG5vdCBiZSByZXRyaWV2ZWQgZm9yIHNlbGxlcjogJHtzZWxsZXIuX2lkfWAsXG4gICAgICAgICAgICAgIGVycm9yXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgLi4uc2VsbGVyLnRvT2JqZWN0KCksXG4gICAgICAgICAgICAgIHN1Yk1lcmNoYW50OiBudWxsLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICApO1xuXG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IHNlbGxlcnM6IHNlbGxlcnNXaXRoU3ViTWVyY2hhbnRzIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgIFwiVGhlcmUgbXVzdCBiZSBlcnJvciB3aGlsZSBnZXQgYWxsIHNlbGxlcnNcIixcbiAgICAgICAgNDA0LFxuICAgICAgICBcImVycm9yR2V0QWxsU2VsbGVyc1wiXG4gICAgICApO1xuICAgIH1cbiAgfSk7XG4gIHJvdXRlci5wb3N0KFwiL2FkbWluL2FwcHJvdmUtb3JkZXJcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgeyBwYXltZW50VHJhbnNhY3Rpb25JZCB9ID0gcmVxLmJvZHk7XG4gICAgY2hlY2tSZXF1aXJlZEZpZWxkKHBheW1lbnRUcmFuc2FjdGlvbklkLCBcIlBheW1lbnRUcmFuc2FjdGlvbklkXCIpO1xuXG4gICAgY29uc3QgZGF0YSA9IHtcbiAgICAgIHBheW1lbnRUcmFuc2FjdGlvbklkLFxuICAgIH07XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYXBwcm92ZVBheW1lbnQoZGF0YSk7XG4gICAgICAvLyBVcGRhdGUgaXNBcHByb3ZlIGZpZWxkIGluIHBheW1lbnQtc3VjY2VzcyBjb2xsZWN0aW9uXG4gICAgICBjb25zdCB1cGRhdGVSZXN1bHQgPSBhd2FpdCBQYXltZW50U3VjY2Vzcy51cGRhdGVPbmUoXG4gICAgICAgIHsgXCJpdGVtVHJhbnNhY3Rpb25zLnBheW1lbnRUcmFuc2FjdGlvbklkXCI6IHBheW1lbnRUcmFuc2FjdGlvbklkIH0sIC8vIExvY2F0ZSB0aGUgZG9jdW1lbnQgd2l0aCB0aGUgc3BlY2lmaWVkIHRyYW5zYWN0aW9uIElEXG4gICAgICAgIHsgJHNldDogeyBcIml0ZW1UcmFuc2FjdGlvbnMuJC5pc0FwcHJvdmVcIjogdHJ1ZSB9IH0gLy8gU2V0IGlzQXBwcm92ZSB0byB0cnVlIGZvciB0aGUgbWF0Y2hpbmcgaXRlbVxuICAgICAgKTtcblxuICAgICAgLy8gQ2hlY2sgaWYgYW55IGRvY3VtZW50IHdhcyBtb2RpZmllZFxuICAgICAgaWYgKHVwZGF0ZVJlc3VsdC5tb2RpZmllZENvdW50ID09PSAwKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgICBcIk5vIG1hdGNoaW5nIHRyYW5zYWN0aW9uIGZvdW5kIG9yIGl0IHdhcyBhbHJlYWR5IGFwcHJvdmVkXCIsXG4gICAgICAgICAgNDA0LFxuICAgICAgICAgIFwidHJhbnNhY3Rpb25Ob3RGb3VuZFwiXG4gICAgICAgICk7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHBheW1lbnQgPSBhd2FpdCBQYXltZW50U3VjY2Vzcy5maW5kT25lKFxuICAgICAgICB7IFwiaXRlbVRyYW5zYWN0aW9ucy5wYXltZW50VHJhbnNhY3Rpb25JZFwiOiBwYXltZW50VHJhbnNhY3Rpb25JZCB9LFxuICAgICAgICBcIml0ZW1UcmFuc2FjdGlvbnMgY2FydElkXCJcbiAgICAgICkucG9wdWxhdGUoXCJpdGVtVHJhbnNhY3Rpb25zLml0ZW1JZFwiLCBcIm5hbWUgcHJpY2VcIik7XG5cbiAgICAgIGNvbnN0IHRyYW5zYWN0aW9uID0gcGF5bWVudC5pdGVtVHJhbnNhY3Rpb25zLmZpbmQoXG4gICAgICAgIChpdGVtKSA9PiBpdGVtLnBheW1lbnRUcmFuc2FjdGlvbklkID09PSBwYXltZW50VHJhbnNhY3Rpb25JZFxuICAgICAgKTtcblxuICAgICAgaWYgKCF0cmFuc2FjdGlvbikge1xuICAgICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJUcmFuc2FjdGlvbiBub3QgZm91bmRcIiwgNDA0LCBcInRyYW5zYWN0aW9uTm90Rm91bmRcIik7XG4gICAgICB9XG5cbiAgICAgIC8vIENyZWF0ZSBhbiBBcHByb3ZlZE9yZGVyIHJlY29yZCBmb3IgdGhlIHRyYW5zYWN0aW9uXG4gICAgICBjb25zdCBhcHByb3ZlZE9yZGVyRGF0YSA9IHtcbiAgICAgICAgcGF5bWVudFRyYW5zYWN0aW9uSWQ6IHRyYW5zYWN0aW9uLnBheW1lbnRUcmFuc2FjdGlvbklkLFxuICAgICAgICBpdGVtSWQ6IHRyYW5zYWN0aW9uLml0ZW1JZC5faWQsXG4gICAgICAgIG5hbWU6IHRyYW5zYWN0aW9uLml0ZW1JZC5uYW1lLFxuICAgICAgICBwcmljZTogdHJhbnNhY3Rpb24uaXRlbUlkLnByaWNlLFxuICAgICAgICBwYWlkUHJpY2U6IHRyYW5zYWN0aW9uLnBhaWRQcmljZSxcbiAgICAgICAgY2FydElkOiBwYXltZW50LmNhcnRJZCxcbiAgICAgIH07XG5cbiAgICAgIC8vIFNhdmUgdGhlIGFwcHJvdmVkIG9yZGVyIHRvIEFwcHJvdmVkT3JkZXJzIGNvbGxlY3Rpb25cbiAgICAgIGNvbnN0IGFwcHJvdmVkT3JkZXIgPSBhd2FpdCBBcHByb3ZhbE9yZGVycy5jcmVhdGUoYXBwcm92ZWRPcmRlckRhdGEpO1xuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyByZXN1bHQsIGFwcHJvdmVkT3JkZXIgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICB9XG4gIH0pO1xuICByb3V0ZXIucG9zdChcIi9hZG1pbi9kaXNhcHByb3ZlLW9yZGVyXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGNvbnN0IHsgcGF5bWVudFRyYW5zYWN0aW9uSWQgfSA9IHJlcS5ib2R5O1xuICAgIGNoZWNrUmVxdWlyZWRGaWVsZChwYXltZW50VHJhbnNhY3Rpb25JZCwgXCJQYXltZW50VHJhbnNhY3Rpb25JZFwiKTtcblxuICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICBwYXltZW50VHJhbnNhY3Rpb25JZCxcbiAgICB9O1xuXG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGRpc0FwcHJvdmVQYXltZW50KGRhdGEpO1xuICAgICAgLy8gVXBkYXRlIGlzQXBwcm92ZSBmaWVsZCBpbiBwYXltZW50LXN1Y2Nlc3MgY29sbGVjdGlvblxuICAgICAgY29uc3QgdXBkYXRlUmVzdWx0ID0gYXdhaXQgUGF5bWVudFN1Y2Nlc3MudXBkYXRlT25lKFxuICAgICAgICB7IFwiaXRlbVRyYW5zYWN0aW9ucy5wYXltZW50VHJhbnNhY3Rpb25JZFwiOiBwYXltZW50VHJhbnNhY3Rpb25JZCB9LCAvLyBMb2NhdGUgdGhlIGRvY3VtZW50IHdpdGggdGhlIHNwZWNpZmllZCB0cmFuc2FjdGlvbiBJRFxuICAgICAgICB7XG4gICAgICAgICAgJHNldDoge1xuICAgICAgICAgICAgXCJpdGVtVHJhbnNhY3Rpb25zLiQuaXNEaXNBcHByb3ZlXCI6IHRydWUsXG4gICAgICAgICAgICBcIml0ZW1UcmFuc2FjdGlvbnMuJC5pc0FwcHJvdmVcIjogZmFsc2UsXG4gICAgICAgICAgfSxcbiAgICAgICAgfSAvLyBTZXQgaXNBcHByb3ZlIHRvIHRydWUgZm9yIHRoZSBtYXRjaGluZyBpdGVtXG4gICAgICApO1xuXG4gICAgICAvLyBDaGVjayBpZiBhbnkgZG9jdW1lbnQgd2FzIG1vZGlmaWVkXG4gICAgICBpZiAodXBkYXRlUmVzdWx0Lm1vZGlmaWVkQ291bnQgPT09IDApIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgICAgIFwiTm8gbWF0Y2hpbmcgdHJhbnNhY3Rpb24gZm91bmQgb3IgaXQgd2FzIGFscmVhZHkgYXBwcm92ZWRcIixcbiAgICAgICAgICA0MDQsXG4gICAgICAgICAgXCJ0cmFuc2FjdGlvbk5vdEZvdW5kXCJcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgcGF5bWVudCA9IGF3YWl0IFBheW1lbnRTdWNjZXNzLmZpbmRPbmUoXG4gICAgICAgIHsgXCJpdGVtVHJhbnNhY3Rpb25zLnBheW1lbnRUcmFuc2FjdGlvbklkXCI6IHBheW1lbnRUcmFuc2FjdGlvbklkIH0sXG4gICAgICAgIFwiaXRlbVRyYW5zYWN0aW9ucyBjYXJ0SWRcIlxuICAgICAgKS5wb3B1bGF0ZShcIml0ZW1UcmFuc2FjdGlvbnMuaXRlbUlkXCIsIFwibmFtZSBwcmljZVwiKTtcblxuICAgICAgY29uc3QgdHJhbnNhY3Rpb24gPSBwYXltZW50Lml0ZW1UcmFuc2FjdGlvbnMuZmluZChcbiAgICAgICAgKGl0ZW0pID0+IGl0ZW0ucGF5bWVudFRyYW5zYWN0aW9uSWQgPT09IHBheW1lbnRUcmFuc2FjdGlvbklkXG4gICAgICApO1xuXG4gICAgICBpZiAoIXRyYW5zYWN0aW9uKSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIlRyYW5zYWN0aW9uIG5vdCBmb3VuZFwiLCA0MDQsIFwidHJhbnNhY3Rpb25Ob3RGb3VuZFwiKTtcbiAgICAgIH1cblxuICAgICAgLy8gQ3JlYXRlIGFuIEFwcHJvdmVkT3JkZXIgcmVjb3JkIGZvciB0aGUgdHJhbnNhY3Rpb25cbiAgICAgIGNvbnN0IGRpc0FwcHJvdmVkT3JkZXJEYXRhID0ge1xuICAgICAgICBwYXltZW50VHJhbnNhY3Rpb25JZDogdHJhbnNhY3Rpb24ucGF5bWVudFRyYW5zYWN0aW9uSWQsXG4gICAgICAgIGl0ZW1JZDogdHJhbnNhY3Rpb24uaXRlbUlkLl9pZCxcbiAgICAgICAgbmFtZTogdHJhbnNhY3Rpb24uaXRlbUlkLm5hbWUsXG4gICAgICAgIHByaWNlOiB0cmFuc2FjdGlvbi5pdGVtSWQucHJpY2UsXG4gICAgICAgIHBhaWRQcmljZTogdHJhbnNhY3Rpb24ucGFpZFByaWNlLFxuICAgICAgICBjYXJ0SWQ6IHBheW1lbnQuY2FydElkLFxuICAgICAgfTtcblxuICAgICAgLy8gU2F2ZSB0aGUgYXBwcm92ZWQgb3JkZXIgdG8gQXBwcm92ZWRPcmRlcnMgY29sbGVjdGlvblxuICAgICAgY29uc3QgZGlzQXBwcm92ZWRPcmRlciA9IGF3YWl0IERpc0FwcHJvdmFsT3JkZXJzLmNyZWF0ZShcbiAgICAgICAgZGlzQXBwcm92ZWRPcmRlckRhdGFcbiAgICAgICk7XG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IHJlc3VsdCwgZGlzQXBwcm92ZWRPcmRlciB9KTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgIH1cbiAgfSk7XG4gIHJvdXRlci5nZXQoXCIvYWRtaW4vd2FpdGluZy1vcmRlcnNcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzLCBuZXh0KSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHBheW1lbnRzID0gYXdhaXQgUGF5bWVudFN1Y2Nlc3MuZmluZChcbiAgICAgICAge1xuICAgICAgICAgIHN0YXR1czogXCJzdWNjZXNzXCIsXG4gICAgICAgICAgaXRlbVRyYW5zYWN0aW9uczoge1xuICAgICAgICAgICAgJGVsZW1NYXRjaDogeyBpc0FwcHJvdmU6IGZhbHNlLCBpc0Rpc0FwcHJvdmU6IGZhbHNlIH0sXG4gICAgICAgICAgfSxcbiAgICAgICAgfSxcbiAgICAgICAgXCJpdGVtVHJhbnNhY3Rpb25zXCJcbiAgICAgICkucG9wdWxhdGUoXCJpdGVtVHJhbnNhY3Rpb25zLml0ZW1JZFwiLCBcIm5hbWUgcHJpY2VcIik7IC8vIFBvcHVsYXRlIG5hbWUgYW5kIHByaWNlIGZyb20gdGhlIHByb2R1Y3QgY29sbGVjdGlvblxuXG4gICAgICBjb25zb2xlLmxvZyhcIlBvcHVsYXRlZCBQYXltZW50czpcIiwgcGF5bWVudHMpO1xuXG4gICAgICAvLyBQcmVwYXJlIGFuIGFycmF5IG9mIHRyYW5zYWN0aW9uIGRldGFpbHNcbiAgICAgIGNvbnN0IHRyYW5zYWN0aW9uRGV0YWlscyA9IHBheW1lbnRzLmZsYXRNYXAoKHBheW1lbnQpID0+XG4gICAgICAgIHBheW1lbnQuaXRlbVRyYW5zYWN0aW9uc1xuICAgICAgICAgIC5maWx0ZXIoXG4gICAgICAgICAgICAodHJhbnNhY3Rpb24pID0+XG4gICAgICAgICAgICAgICF0cmFuc2FjdGlvbi5pc0FwcHJvdmUgJiZcbiAgICAgICAgICAgICAgIXRyYW5zYWN0aW9uLmlzRGlzQXBwcm92ZSAmJlxuICAgICAgICAgICAgICB0cmFuc2FjdGlvbi5pdGVtSWQgJiYgLy8gaXRlbUlkIG1ldmN1dCBtdT9cbiAgICAgICAgICAgICAgdHJhbnNhY3Rpb24uaXRlbUlkLm5hbWUgJiYgLy8gbmFtZSBhbGFuxLEgdmFyIG3EsT9cbiAgICAgICAgICAgICAgdHJhbnNhY3Rpb24ucHJpY2UgLy8gcHJpY2UgYWxhbsSxIHZhciBtxLE/XG4gICAgICAgICAgKVxuICAgICAgICAgIC5tYXAoKHRyYW5zYWN0aW9uKSA9PiAoe1xuICAgICAgICAgICAgcGF5bWVudFRyYW5zYWN0aW9uSWQ6IHRyYW5zYWN0aW9uLnBheW1lbnRUcmFuc2FjdGlvbklkLFxuICAgICAgICAgICAgaXRlbUlkOiB0cmFuc2FjdGlvbi5pdGVtSWQuX2lkLCAvLyBUaGUgT2JqZWN0SWQgb2YgdGhlIGl0ZW1cbiAgICAgICAgICAgIG5hbWU6IHRyYW5zYWN0aW9uLml0ZW1JZC5uYW1lLCAvLyBQb3B1bGF0ZWQgbmFtZSBvZiB0aGUgaXRlbVxuICAgICAgICAgICAgcHJpY2U6IHRyYW5zYWN0aW9uLnByaWNlLCAvLyBQb3B1bGF0ZWQgcHJpY2Ugb2YgdGhlIGl0ZW1cbiAgICAgICAgICB9KSlcbiAgICAgICk7XG4gICAgICBpZiAodHJhbnNhY3Rpb25EZXRhaWxzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICBjb25zb2xlLmxvZyhcInRoZXJlIGlzIG5vIG9yZGVyIHRvIGFwcHJvdmVcIik7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgICBcIlRoZXJlIGlzIG5vIG9yZGVyIHRvIGFwcHJvdmVcIixcbiAgICAgICAgICA0MDEsXG4gICAgICAgICAgXCJub09yZGVyVG9BcHByb3ZlXCJcbiAgICAgICAgKTtcbiAgICAgIH1cblxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyB0cmFuc2FjdGlvbkRldGFpbHMgfSk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgIG5leHQoXG4gICAgICAgIG5ldyBBcGlFcnJvcihcbiAgICAgICAgICBcIkNvdWxkIG5vdCByZXRyaWV2ZSBwYXltZW50VHJhbnNhY3Rpb25JZHNcIixcbiAgICAgICAgICA1MDAsXG4gICAgICAgICAgXCJmZXRjaEVycm9yXCJcbiAgICAgICAgKVxuICAgICAgKTtcbiAgICB9XG4gIH0pO1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsZUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsa0JBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLGVBQUEsR0FBQUgsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFHLE9BQUEsR0FBQUosc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFJLE1BQUEsR0FBQUwsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFLLFNBQUEsR0FBQU4sc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFNLGVBQUEsR0FBQU4sT0FBQTtBQUNBLElBQUFPLFlBQUEsR0FBQVAsT0FBQTtBQUNBLElBQUFRLGNBQUEsR0FBQVIsT0FBQTtBQUNBLElBQUFTLG9CQUFBLEdBQUFULE9BQUE7QUFJQSxJQUFBVSxRQUFBLEdBQUFYLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBVyxTQUFBLEdBQUFYLE9BQUE7QUFJQSxJQUFBWSxZQUFBLEdBQUFaLE9BQUE7QUFHZ0QsU0FBQUQsdUJBQUFjLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFBQSxJQUFBRyxRQUFBLEdBRWhDQyxNQUFNLElBQUs7RUFDekI7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","map":{"version":3,"names":["_approvalOrders","_interopRequireDefault","require","_disapprovalOrders","_paymentSuccess","_seller","_users","_ApiError","_CheckExistence","_Permissions","_RequiredCheck","_ApproveMailToSeller","_Session","_approval","_submerchant","e","__esModule","default","_default","router","get","Session","req","res","checkPermissions","user","pendingSellers","Seller","find","isVerified","noExistVariable","status","json","error","console","log","send","ApiError","put","next","id","params","action","response","body","seller","findById","notFoundVariable","subMerchantData","locale","conversationId","subMerchantExternalId","subMerchantType","address","taxOffice","legalCompanyTitle","email","gsmNumber","name","identityNumber","undefined","taxNumber","iban","trim","currency","iyzicoResult","createSubMerchant","subMerchantKey","save","ApproveMailToSeller","message","rawResponse","RejectMailToSeller","findByIdAndDelete","users","Users","sellers","select","sellersWithSubMerchants","Promise","all","map","subMerchant","getSubMerchant","_id","toObject","post","paymentTransactionId","checkRequiredField","data","result","approvePayment","updateResult","PaymentSuccess","updateOne","$set","modifiedCount","payment","findOne","populate","transaction","itemTransactions","item","approvedOrderData","itemId","price","paidPrice","cartId","approvedOrder","ApprovalOrders","create","disApprovePayment","disApprovedOrderData","disApprovedOrder","DisApprovalOrders","payments","$elemMatch","isApprove","isDisApprove","transactionDetails","flatMap","filter","length","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["admin.js"],"sourcesContent":["import ApprovalOrders from \"../db/approval-orders\";\nimport DisApprovalOrders from \"../db/disapproval-orders\";\nimport PaymentSuccess from \"../db/payment-success\";\nimport Seller from \"../db/seller\";\nimport Users from \"../db/users\";\nimport ApiError from \"../errors/ApiError\";\nimport { noExistVariable, notFoundVariable } from \"../helpers/CheckExistence\";\nimport { checkPermissions } from \"../helpers/Permissions\";\nimport { checkRequiredField } from \"../helpers/RequiredCheck\";\nimport {\n  ApproveMailToSeller,\n  RejectMailToSeller,\n} from \"../middlewares/ApproveMailToSeller\";\nimport Session from \"../middlewares/Session\";\nimport {\n  approvePayment,\n  disApprovePayment,\n} from \"../services/iyzico/methods/approval\";\nimport {\n  createSubMerchant,\n  getSubMerchant,\n} from \"../services/iyzico/methods/submerchant\";\n\nexport default (router) => {\n  // Onay bekleyen seller'ları listeleme\n  router.get(\"/admin/seller/pending\", Session, async (req, res) => {\n    checkPermissions(req.user, [\"admin\"]);\n    try {\n      const pendingSellers = await Seller.find({ isVerified: false });\n      // if (!pendingSellers) {\n      //   throw new ApiError(\"Does not exist seller pending\");\n      // }\n      noExistVariable(pendingSellers, \"Seller\");\n      return res.status(200).json(pendingSellers);\n    } catch (error) {\n      console.log(error);\n      return res\n        .status(500)\n        .send(new ApiError(500, \"Satıcılar listelenirken hata oluştu.\"));\n    }\n  });\n\n  router.put(\"/admin/seller/verify/:id\", Session, async (req, res, next) => {\n    const { id } = req.params;\n    const { action, response } = req.body;\n\n    try {\n      checkPermissions(req.user, [\"admin\"]); // Yetki kontrolü\n      const seller = await Seller.findById(id);\n      notFoundVariable(seller, \"Seller\"); // Satıcı var mı kontrolü\n\n      if (seller.isVerified) {\n        return next(\n          new ApiError(\n            \"This seller is already verified\",\n            404,\n            \"alreadyVerified\"\n          )\n        );\n      }\n\n      if (action === \"approve\") {\n        // Satıcı bilgilerini iyzico'ya uygun formata çevir\n        const subMerchantData = {\n          locale: seller.locale,\n          conversationId: seller.conversationId,\n          subMerchantExternalId: seller.subMerchantExternalId,\n          subMerchantType: seller.subMerchantType,\n          address: seller.address,\n          taxOffice: seller.taxOffice,\n          legalCompanyTitle: seller.legalCompanyTitle,\n          email: seller.email,\n          gsmNumber: seller.gsmNumber,\n          name: seller.name,\n          //şundan itibaren bakıver tax ve buna\n          identityNumber:\n            seller.subMerchantType === \"PRIVATE_COMPANY\"\n              ? seller.identityNumber\n              : undefined,\n          taxNumber:\n            seller.subMerchantType === \"LIMITED_OR_JOINT_STOCK_COMPANY\"\n              ? seller.taxNumber\n              : undefined,\n          iban: seller.iban.trim(),\n          currency: seller.currency,\n        };\n        console.log(\"Kaydedilen IBAN:\", seller.iban);\n        console.log(\"Data = \", subMerchantData);\n\n        try {\n          const iyzicoResult = await createSubMerchant(subMerchantData);\n\n          if (iyzicoResult.status === \"success\") {\n            console.log(iyzicoResult);\n            seller.subMerchantKey = iyzicoResult.subMerchantKey;\n            seller.isVerified = true;\n            await seller.save();\n            await ApproveMailToSeller(req, res, next); // Onay e-postası gönder\n\n            return res.status(200).json({\n              message: \"Seller is verified and registered in iyzico\",\n              seller,\n            });\n          } else {\n            // İyzico hatası loglanıyor\n            console.log(\"Iyzipay Error:\", iyzicoResult);\n            return res.status(500).json({\n              status: \"Failed to register seller in iyzico\",\n              rawResponse: iyzicoResult,\n            });\n          }\n        } catch (error) {\n          console.log(\"Iyzipay API Error:\", error);\n          return res.status(500).json({\n            status: \"Failed to register seller in iyzico\",\n            error:\n              error.message || \"An error occurred while contacting Iyzipay\",\n          });\n        }\n      }\n\n      if (action === \"reject\") {\n        await RejectMailToSeller(req, res, async () => {\n          // Mail başarılı bir şekilde gönderilirse satıcıyı sil\n          await Seller.findByIdAndDelete(id);\n          return res\n            .status(200)\n            .json({ message: \"Seller is rejected and deleted\" });\n        });\n\n        // Burada erken return yaparak hata olmasını engelliyoruz\n        return;\n      }\n\n      return res.status(400).json(new ApiError(400, \"Invalid transaction\"));\n    } catch (error) {\n      console.error(error);\n      return next(\n        new ApiError(\n          500,\n          \"There is an error while processing the verification transaction\"\n        )\n      );\n    }\n  });\n\n  router.get(\"/admin/get-all-users\", Session, async (req, res) => {\n    checkPermissions(req.user, [\"admin\"]);\n\n    try {\n      const users = await Users.find();\n      res.status(200).json(users);\n    } catch (error) {\n      console.log(error);\n      throw new ApiError(\n        \"There must be error while get all users\",\n        404,\n        \"errorGetAllUsers\"\n      );\n    }\n  });\n\n  router.get(\"/admin/get-all-sellers\", Session, async (req, res) => {\n    checkPermissions(req.user, [\"admin\"]);\n    try {\n      const sellers = await Seller.find().select(\"-password\");\n      const sellersWithSubMerchants = await Promise.all(\n        sellers.map(async (seller) => {\n          try {\n            const subMerchant = await getSubMerchant({\n              locale: seller.locale || \"tr\",\n              conversationId: seller.conversationId,\n              subMerchantExternalId: seller.subMerchantExternalId,\n            });\n            return {\n              subMerchant,\n            };\n          } catch (error) {\n            console.error(\n              `SubMerchant data could not be retrieved for seller: ${seller._id}`,\n              error\n            );\n            return {\n              ...seller.toObject(),\n              subMerchant: null,\n            };\n          }\n        })\n      );\n\n      res.status(200).json({ sellers: sellersWithSubMerchants });\n    } catch (error) {\n      console.log(error);\n      throw new ApiError(\n        \"There must be error while get all sellers\",\n        404,\n        \"errorGetAllSellers\"\n      );\n    }\n  });\n  router.post(\"/admin/approve-order\", Session, async (req, res) => {\n    const { paymentTransactionId } = req.body;\n    checkRequiredField(paymentTransactionId, \"PaymentTransactionId\");\n\n    const data = {\n      paymentTransactionId,\n    };\n\n    try {\n      const result = await approvePayment(data);\n      // Update isApprove field in payment-success collection\n      const updateResult = await PaymentSuccess.updateOne(\n        { \"itemTransactions.paymentTransactionId\": paymentTransactionId }, // Locate the document with the specified transaction ID\n        { $set: { \"itemTransactions.$.isApprove\": true } } // Set isApprove to true for the matching item\n      );\n\n      // Check if any document was modified\n      if (updateResult.modifiedCount === 0) {\n        throw new ApiError(\n          \"No matching transaction found or it was already approved\",\n          404,\n          \"transactionNotFound\"\n        );\n      }\n\n      const payment = await PaymentSuccess.findOne(\n        { \"itemTransactions.paymentTransactionId\": paymentTransactionId },\n        \"itemTransactions cartId\"\n      ).populate(\"itemTransactions.itemId\", \"name price\");\n\n      const transaction = payment.itemTransactions.find(\n        (item) => item.paymentTransactionId === paymentTransactionId\n      );\n\n      if (!transaction) {\n        throw new ApiError(\"Transaction not found\", 404, \"transactionNotFound\");\n      }\n\n      // Create an ApprovedOrder record for the transaction\n      const approvedOrderData = {\n        paymentTransactionId: transaction.paymentTransactionId,\n        itemId: transaction.itemId._id,\n        name: transaction.itemId.name,\n        price: transaction.itemId.price,\n        paidPrice: transaction.paidPrice,\n        cartId: payment.cartId,\n      };\n\n      // Save the approved order to ApprovedOrders collection\n      const approvedOrder = await ApprovalOrders.create(approvedOrderData);\n      res.status(200).json({ result, approvedOrder });\n    } catch (error) {\n      console.log(error);\n    }\n  });\n  router.post(\"/admin/disapprove-order\", Session, async (req, res) => {\n    const { paymentTransactionId } = req.body;\n    checkRequiredField(paymentTransactionId, \"PaymentTransactionId\");\n\n    const data = {\n      paymentTransactionId,\n    };\n\n    try {\n      const result = await disApprovePayment(data);\n      // Update isApprove field in payment-success collection\n      const updateResult = await PaymentSuccess.updateOne(\n        { \"itemTransactions.paymentTransactionId\": paymentTransactionId }, // Locate the document with the specified transaction ID\n        {\n          $set: {\n            \"itemTransactions.$.isDisApprove\": true,\n            \"itemTransactions.$.isApprove\": false,\n          },\n        } // Set isApprove to true for the matching item\n      );\n\n      // Check if any document was modified\n      if (updateResult.modifiedCount === 0) {\n        throw new ApiError(\n          \"No matching transaction found or it was already approved\",\n          404,\n          \"transactionNotFound\"\n        );\n      }\n\n      const payment = await PaymentSuccess.findOne(\n        { \"itemTransactions.paymentTransactionId\": paymentTransactionId },\n        \"itemTransactions cartId\"\n      ).populate(\"itemTransactions.itemId\", \"name price\");\n\n      const transaction = payment.itemTransactions.find(\n        (item) => item.paymentTransactionId === paymentTransactionId\n      );\n\n      if (!transaction) {\n        throw new ApiError(\"Transaction not found\", 404, \"transactionNotFound\");\n      }\n\n      // Create an ApprovedOrder record for the transaction\n      const disApprovedOrderData = {\n        paymentTransactionId: transaction.paymentTransactionId,\n        itemId: transaction.itemId._id,\n        name: transaction.itemId.name,\n        price: transaction.itemId.price,\n        paidPrice: transaction.paidPrice,\n        cartId: payment.cartId,\n      };\n\n      // Save the approved order to ApprovedOrders collection\n      const disApprovedOrder = await DisApprovalOrders.create(\n        disApprovedOrderData\n      );\n      res.status(200).json({ result, disApprovedOrder });\n    } catch (error) {\n      console.log(error);\n    }\n  });\n  router.get(\"/admin/waiting-orders\", Session, async (req, res, next) => {\n    try {\n      const payments = await PaymentSuccess.find(\n        {\n          status: \"success\",\n          itemTransactions: {\n            $elemMatch: { isApprove: false, isDisApprove: false },\n          },\n        },\n        \"itemTransactions\"\n      ).populate(\"itemTransactions.itemId\", \"name price\"); // Populate name and price from the product collection\n\n      console.log(\"Populated Payments:\", payments);\n\n      // Prepare an array of transaction details\n      const transactionDetails = payments.flatMap((payment) =>\n        payment.itemTransactions\n          .filter(\n            (transaction) =>\n              !transaction.isApprove &&\n              !transaction.isDisApprove &&\n              transaction.itemId && // itemId mevcut mu?\n              transaction.itemId.name && // name alanı var mı?\n              transaction.price // price alanı var mı?\n          )\n          .map((transaction) => ({\n            paymentTransactionId: transaction.paymentTransactionId,\n            itemId: transaction.itemId._id, // The ObjectId of the item\n            name: transaction.itemId.name, // Populated name of the item\n            price: transaction.price, // Populated price of the item\n          }))\n      );\n      if (transactionDetails.length === 0) {\n        console.log(\"there is no order to approve\");\n        throw new ApiError(\n          \"There is no order to approve\",\n          401,\n          \"noOrderToApprove\"\n        );\n      }\n\n      res.status(200).json({ transactionDetails });\n    } catch (error) {\n      console.log(error);\n      next(\n        new ApiError(\n          \"Could not retrieve paymentTransactionIds\",\n          500,\n          \"fetchError\"\n        )\n      );\n    }\n  });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,eAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,kBAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,eAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,OAAA,GAAAJ,sBAAA,CAAAC,OAAA;AACA,IAAAI,MAAA,GAAAL,sBAAA,CAAAC,OAAA;AACA,IAAAK,SAAA,GAAAN,sBAAA,CAAAC,OAAA;AACA,IAAAM,eAAA,GAAAN,OAAA;AACA,IAAAO,YAAA,GAAAP,OAAA;AACA,IAAAQ,cAAA,GAAAR,OAAA;AACA,IAAAS,oBAAA,GAAAT,OAAA;AAIA,IAAAU,QAAA,GAAAX,sBAAA,CAAAC,OAAA;AACA,IAAAW,SAAA,GAAAX,OAAA;AAIA,IAAAY,YAAA,GAAAZ,OAAA;AAGgD,SAAAD,uBAAAc,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAAA,IAAAG,QAAA,GAEhCC,MAAM,IAAK;EACzB;EACAA,MAAM,CAACC,GAAG,CAAC,uBAAuB,EAAEC,gBAAO,EAAE,OAAOC,GAAG,EAAEC,GAAG,KAAK;IAC/D,IAAAC,6BAAgB,EAACF,GAAG,CAACG,IAAI,EAAE,CAAC,OAAO,CAAC,CAAC;IACrC,IAAI;MACF,MAAMC,cAAc,GAAG,MAAMC,eAAM,CAACC,IAAI,CAAC;QAAEC,UAAU,EAAE;MAAM,CAAC,CAAC;MAC/D;MACA;MACA;MACA,IAAAC,+BAAe,EAACJ,cAAc,EAAE,QAAQ,CAAC;MACzC,OAAOH,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAACN,cAAc,CAAC;IAC7C,CAAC,CAAC,OAAOO,KAAK,EAAE;MACdC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;MAClB,OAAOV,GAAG,CACPQ,MAAM,CAAC,GAAG,CAAC,CACXK,IAAI,CAAC,IAAIC,iBAAQ,CAAC,GAAG,EAAE,sCAAsC,CAAC,CAAC;IACpE;EACF,CAAC,CAAC;EAEFlB,MAAM,CAACmB,GAAG,CAAC,0BAA0B,EAAEjB,gBAAO,EAAE,OAAOC,GAAG,EAAEC,GAAG,EAAEgB,IAAI,KAAK;IACxE,MAAM;MAAEC;IAAG,CAAC,GAAGlB,GAAG,CAACmB,MAAM;IACzB,MAAM;MAAEC,MAAM;MAAEC;IAAS,CAAC,GAAGrB,GAAG,CAACsB,IAAI;IAErC,IAAI;MACF,IAAApB,6BAAgB,EAACF,GAAG,CAACG,IAAI,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC;MACvC,MAAMoB,MAAM,GAAG,MAAMlB,eAAM,CAACmB,QAAQ,CAACN,EAAE,CAAC;MACxC,IAAAO,gCAAgB,EAACF,MAAM,EAAE,QAAQ,CAAC,CAAC,CAAC;;MAEpC,IAAIA,MAAM,CAAChB,UAAU,EAAE;QACrB,OAAOU,IAAI,CACT,IAAIF,iBAAQ,CACV,iCAAiC,EACjC,GAAG,EACH,iBACF,CACF,CAAC;MACH;MAEA,IAAIK,MAAM,KAAK,SAAS,EAAE;QACxB;QACA,MAAMM,eAAe,GAAG;UACtBC,MAAM,EAAEJ,MAAM,CAACI,MAAM;UACrBC,cAAc,EAAEL,MAAM,CAACK,cAAc;UACrCC,qBAAqB,EAAEN,MAAM,CAACM,qBAAqB;UACnDC,eAAe,EAAEP,MAAM,CAACO,eAAe;UACvCC,OAAO,EAAER,MAAM,CAACQ,OAAO;UACvBC,SAAS,EAAET,MAAM,CAACS,SAAS;UAC3BC,iBAAiB,EAAEV,MAAM,CAACU,iBAAiB;UAC3CC,KAAK,EAAEX,MAAM,CAACW,KAAK;UACnBC,SAAS,EAAEZ,MAAM,CAACY,SAAS;UAC3BC,IAAI,EAAEb,MAAM,CAACa,IAAI;UACjB;UACAC,cAAc,EACZd,MAAM,CAACO,eAAe,KAAK,iBAAiB,GACxCP,MAAM,CAACc,cAAc,GACrBC,SAAS;UACfC,SAAS,EACPhB,MAAM,CAACO,eAAe,KAAK,gCAAgC,GACvDP,MAAM,CAACgB,SAAS,GAChBD,SAAS;UACfE,IAAI,EAAEjB,MAAM,CAACiB,IAAI,CAACC,IAAI,CAAC,CAAC;UACxBC,QAAQ,EAAEnB,MAAM,CAACmB;QACnB,CAAC;QACD9B,OAAO,CAACC,GAAG,CAAC,kBAAkB,EAAEU,MAAM,CAACiB,IAAI,CAAC;QAC5C5B,OAAO,CAACC,GAAG,CAAC,SAAS,EAAEa,eAAe,CAAC;QAEvC,IAAI;UACF,MAAMiB,YAAY,GAAG,MAAM,IAAAC,8BAAiB,EAAClB,eAAe,CAAC;UAE7D,IAAIiB,YAAY,CAAClC,MAAM,KAAK,SAAS,EAAE;YACrCG,OAAO,CAACC,GAAG,CAAC8B,YAAY,CAAC;YACzBpB,MAAM,CAACsB,cAAc,GAAGF,YAAY,CAACE,cAAc;YACnDtB,MAAM,CAAChB,UAAU,GAAG,IAAI;YACxB,MAAMgB,MAAM,CAACuB,IAAI,CAAC,CAAC;YACnB,MAAM,IAAAC,wCAAmB,EAAC/C,GAAG,EAAEC,GAAG,EAAEgB,IAAI,CAAC,CAAC,CAAC;;YAE3C,OAAOhB,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;cAC1BsC,OAAO,EAAE,6CAA6C;cACtDzB;YACF,CAAC,CAAC;UACJ,CAAC,MAAM;YACL;YACAX,OAAO,CAACC,GAAG,CAAC,gBAAgB,EAAE8B,YAAY,CAAC;YAC3C,OAAO1C,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;cAC1BD,MAAM,EAAE,qCAAqC;cAC7CwC,WAAW,EAAEN;YACf,CAAC,CAAC;UACJ;QACF,CAAC,CAAC,OAAOhC,KAAK,EAAE;UACdC,OAAO,CAACC,GAAG,CAAC,oBAAoB,EAAEF,KAAK,CAAC;UACxC,OAAOV,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;YAC1BD,MAAM,EAAE,qCAAqC;YAC7CE,KAAK,EACHA,KAAK,CAACqC,OAAO,IAAI;UACrB,CAAC,CAAC;QACJ;MACF;MAEA,IAAI5B,MAAM,KAAK,QAAQ,EAAE;QACvB,MAAM,IAAA8B,uCAAkB,EAAClD,GAAG,EAAEC,GAAG,EAAE,YAAY;UAC7C;UACA,MAAMI,eAAM,CAAC8C,iBAAiB,CAACjC,EAAE,CAAC;UAClC,OAAOjB,GAAG,CACPQ,MAAM,CAAC,GAAG,CAAC,CACXC,IAAI,CAAC;YAAEsC,OAAO,EAAE;UAAiC,CAAC,CAAC;QACxD,CAAC,CAAC;;QAEF;QACA;MACF;MAEA,OAAO/C,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC,IAAIK,iBAAQ,CAAC,GAAG,EAAE,qBAAqB,CAAC,CAAC;IACvE,CAAC,CAAC,OAAOJ,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;MACpB,OAAOM,IAAI,CACT,IAAIF,iBAAQ,CACV,GAAG,EACH,iEACF,CACF,CAAC;IACH;EACF,CAAC,CAAC;EAEFlB,MAAM,CAACC,GAAG,CAAC,sBAAsB,EAAEC,gBAAO,EAAE,OAAOC,GAAG,EAAEC,GAAG,KAAK;IAC9D,IAAAC,6BAAgB,EAACF,GAAG,CAACG,IAAI,EAAE,CAAC,OAAO,CAAC,CAAC;IAErC,IAAI;MACF,MAAMiD,KAAK,GAAG,MAAMC,cAAK,CAAC/C,IAAI,CAAC,CAAC;MAChCL,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC0C,KAAK,CAAC;IAC7B,CAAC,CAAC,OAAOzC,KAAK,EAAE;MACdC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;MAClB,MAAM,IAAII,iBAAQ,CAChB,yCAAyC,EACzC,GAAG,EACH,kBACF,CAAC;IACH;EACF,CAAC,CAAC;EAEFlB,MAAM,CAACC,GAAG,CAAC,wBAAwB,EAAEC,gBAAO,EAAE,OAAOC,GAAG,EAAEC,GAAG,KAAK;IAChE,IAAAC,6BAAgB,EAACF,GAAG,CAACG,IAAI,EAAE,CAAC,OAAO,CAAC,CAAC;IACrC,IAAI;MACF,MAAMmD,OAAO,GAAG,MAAMjD,eAAM,CAACC,IAAI,CAAC,CAAC,CAACiD,MAAM,CAAC,WAAW,CAAC;MACvD,MAAMC,uBAAuB,GAAG,MAAMC,OAAO,CAACC,GAAG,CAC/CJ,OAAO,CAACK,GAAG,CAAC,MAAOpC,MAAM,IAAK;QAC5B,IAAI;UACF,MAAMqC,WAAW,GAAG,MAAM,IAAAC,2BAAc,EAAC;YACvClC,MAAM,EAAEJ,MAAM,CAACI,MAAM,IAAI,IAAI;YAC7BC,cAAc,EAAEL,MAAM,CAACK,cAAc;YACrCC,qBAAqB,EAAEN,MAAM,CAACM;UAChC,CAAC,CAAC;UACF,OAAO;YACL+B;UACF,CAAC;QACH,CAAC,CAAC,OAAOjD,KAAK,EAAE;UACdC,OAAO,CAACD,KAAK,CACX,uDAAuDY,MAAM,CAACuC,GAAG,EAAE,EACnEnD,KACF,CAAC;UACD,OAAO;YACL,GAAGY,MAAM,CAACwC,QAAQ,CAAC,CAAC;YACpBH,WAAW,EAAE;UACf,CAAC;QACH;MACF,CAAC,CACH,CAAC;MAED3D,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAE4C,OAAO,EAAEE;MAAwB,CAAC,CAAC;IAC5D,CAAC,CAAC,OAAO7C,KAAK,EAAE;MACdC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;MAClB,MAAM,IAAII,iBAAQ,CAChB,2CAA2C,EAC3C,GAAG,EACH,oBACF,CAAC;IACH;EACF,CAAC,CAAC;EACFlB,MAAM,CAACmE,IAAI,CAAC,sBAAsB,EAAEjE,gBAAO,EAAE,OAAOC,GAAG,EAAEC,GAAG,KAAK;IAC/D,MAAM;MAAEgE;IAAqB,CAAC,GAAGjE,GAAG,CAACsB,IAAI;IACzC,IAAA4C,iCAAkB,EAACD,oBAAoB,EAAE,sBAAsB,CAAC;IAEhE,MAAME,IAAI,GAAG;MACXF;IACF,CAAC;IAED,IAAI;MACF,MAAMG,MAAM,GAAG,MAAM,IAAAC,wBAAc,EAACF,IAAI,CAAC;MACzC;MACA,MAAMG,YAAY,GAAG,MAAMC,uBAAc,CAACC,SAAS,CACjD;QAAE,uCAAuC,EAAEP;MAAqB,CAAC;MAAE;MACnE;QAAEQ,IAAI,EAAE;UAAE,8BAA8B,EAAE;QAAK;MAAE,CAAC,CAAC;MACrD,CAAC;;MAED;MACA,IAAIH,YAAY,CAACI,aAAa,KAAK,CAAC,EAAE;QACpC,MAAM,IAAI3D,iBAAQ,CAChB,0DAA0D,EAC1D,GAAG,EACH,qBACF,CAAC;MACH;MAEA,MAAM4D,OAAO,GAAG,MAAMJ,uBAAc,CAACK,OAAO,CAC1C;QAAE,uCAAuC,EAAEX;MAAqB,CAAC,EACjE,yBACF,CAAC,CAACY,QAAQ,CAAC,yBAAyB,EAAE,YAAY,CAAC;MAEnD,MAAMC,WAAW,GAAGH,OAAO,CAACI,gBAAgB,CAACzE,IAAI,CAC9C0E,IAAI,IAAKA,IAAI,CAACf,oBAAoB,KAAKA,oBAC1C,CAAC;MAED,IAAI,CAACa,WAAW,EAAE;QAChB,MAAM,IAAI/D,iBAAQ,CAAC,uBAAuB,EAAE,GAAG,EAAE,qBAAqB,CAAC;MACzE;;MAEA;MACA,MAAMkE,iBAAiB,GAAG;QACxBhB,oBAAoB,EAAEa,WAAW,CAACb,oBAAoB;QACtDiB,MAAM,EAAEJ,WAAW,CAACI,MAAM,CAACpB,GAAG;QAC9B1B,IAAI,EAAE0C,WAAW,CAACI,MAAM,CAAC9C,IAAI;QAC7B+C,KAAK,EAAEL,WAAW,CAACI,MAAM,CAACC,KAAK;QAC/BC,SAAS,EAAEN,WAAW,CAACM,SAAS;QAChCC,MAAM,EAAEV,OAAO,CAACU;MAClB,CAAC;;MAED;MACA,MAAMC,aAAa,GAAG,MAAMC,uBAAc,CAACC,MAAM,CAACP,iBAAiB,CAAC;MACpEhF,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAE0D,MAAM;QAAEkB;MAAc,CAAC,CAAC;IACjD,CAAC,CAAC,OAAO3E,KAAK,EAAE;MACdC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;IACpB;EACF,CAAC,CAAC;EACFd,MAAM,CAACmE,IAAI,CAAC,yBAAyB,EAAEjE,gBAAO,EAAE,OAAOC,GAAG,EAAEC,GAAG,KAAK;IAClE,MAAM;MAAEgE;IAAqB,CAAC,GAAGjE,GAAG,CAACsB,IAAI;IACzC,IAAA4C,iCAAkB,EAACD,oBAAoB,EAAE,sBAAsB,CAAC;IAEhE,MAAME,IAAI,GAAG;MACXF;IACF,CAAC;IAED,IAAI;MACF,MAAMG,MAAM,GAAG,MAAM,IAAAqB,2BAAiB,EAACtB,IAAI,CAAC;MAC5C;MACA,MAAMG,YAAY,GAAG,MAAMC,uBAAc,CAACC,SAAS,CACjD;QAAE,uCAAuC,EAAEP;MAAqB,CAAC;MAAE;MACnE;QACEQ,IAAI,EAAE;UACJ,iCAAiC,EAAE,IAAI;UACvC,8BAA8B,EAAE;QAClC;MACF,CAAC,CAAC;MACJ,CAAC;;MAED;MACA,IAAIH,YAAY,CAACI,aAAa,KAAK,CAAC,EAAE;QACpC,MAAM,IAAI3D,iBAAQ,CAChB,0DAA0D,EAC1D,GAAG,EACH,qBACF,CAAC;MACH;MAEA,MAAM4D,OAAO,GAAG,MAAMJ,uBAAc,CAACK,OAAO,CAC1C;QAAE,uCAAuC,EAAEX;MAAqB,CAAC,EACjE,yBACF,CAAC,CAACY,QAAQ,CAAC,yBAAyB,EAAE,YAAY,CAAC;MAEnD,MAAMC,WAAW,GAAGH,OAAO,CAACI,gBAAgB,CAACzE,IAAI,CAC9C0E,IAAI,IAAKA,IAAI,CAACf,oBAAoB,KAAKA,oBAC1C,CAAC;MAED,IAAI,CAACa,WAAW,EAAE;QAChB,MAAM,IAAI/D,iBAAQ,CAAC,uBAAuB,EAAE,GAAG,EAAE,qBAAqB,CAAC;MACzE;;MAEA;MACA,MAAM2E,oBAAoB,GAAG;QAC3BzB,oBAAoB,EAAEa,WAAW,CAACb,oBAAoB;QACtDiB,MAAM,EAAEJ,WAAW,CAACI,MAAM,CAACpB,GAAG;QAC9B1B,IAAI,EAAE0C,WAAW,CAACI,MAAM,CAAC9C,IAAI;QAC7B+C,KAAK,EAAEL,WAAW,CAACI,MAAM,CAACC,KAAK;QAC/BC,SAAS,EAAEN,WAAW,CAACM,SAAS;QAChCC,MAAM,EAAEV,OAAO,CAACU;MAClB,CAAC;;MAED;MACA,MAAMM,gBAAgB,GAAG,MAAMC,0BAAiB,CAACJ,MAAM,CACrDE,oBACF,CAAC;MACDzF,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAE0D,MAAM;QAAEuB;MAAiB,CAAC,CAAC;IACpD,CAAC,CAAC,OAAOhF,KAAK,EAAE;MACdC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;IACpB;EACF,CAAC,CAAC;EACFd,MAAM,CAACC,GAAG,CAAC,uBAAuB,EAAEC,gBAAO,EAAE,OAAOC,GAAG,EAAEC,GAAG,EAAEgB,IAAI,KAAK;IACrE,IAAI;MACF,MAAM4E,QAAQ,GAAG,MAAMtB,uBAAc,CAACjE,IAAI,CACxC;QACEG,MAAM,EAAE,SAAS;QACjBsE,gBAAgB,EAAE;UAChBe,UAAU,EAAE;YAAEC,SAAS,EAAE,KAAK;YAAEC,YAAY,EAAE;UAAM;QACtD;MACF,CAAC,EACD,kBACF,CAAC,CAACnB,QAAQ,CAAC,yBAAyB,EAAE,YAAY,CAAC,CAAC,CAAC;;MAErDjE,OAAO,CAACC,GAAG,CAAC,qBAAqB,EAAEgF,QAAQ,CAAC;;MAE5C;MACA,MAAMI,kBAAkB,GAAGJ,QAAQ,CAACK,OAAO,CAAEvB,OAAO,IAClDA,OAAO,CAACI,gBAAgB,CACrBoB,MAAM,CACJrB,WAAW,IACV,CAACA,WAAW,CAACiB,SAAS,IACtB,CAACjB,WAAW,CAACkB,YAAY,IACzBlB,WAAW,CAACI,MAAM;MAAI;MACtBJ,WAAW,CAACI,MAAM,CAAC9C,IAAI;MAAI;MAC3B0C,WAAW,CAACK,KAAK,CAAC;MACtB,CAAC,CACAxB,GAAG,CAAEmB,WAAW,KAAM;QACrBb,oBAAoB,EAAEa,WAAW,CAACb,oBAAoB;QACtDiB,MAAM,EAAEJ,WAAW,CAACI,MAAM,CAACpB,GAAG;QAAE;QAChC1B,IAAI,EAAE0C,WAAW,CAACI,MAAM,CAAC9C,IAAI;QAAE;QAC/B+C,KAAK,EAAEL,WAAW,CAACK,KAAK,CAAE;MAC5B,CAAC,CAAC,CACN,CAAC;MACD,IAAIc,kBAAkB,CAACG,MAAM,KAAK,CAAC,EAAE;QACnCxF,OAAO,CAACC,GAAG,CAAC,8BAA8B,CAAC;QAC3C,MAAM,IAAIE,iBAAQ,CAChB,8BAA8B,EAC9B,GAAG,EACH,kBACF,CAAC;MACH;MAEAd,GAAG,CAACQ,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QAAEuF;MAAmB,CAAC,CAAC;IAC9C,CAAC,CAAC,OAAOtF,KAAK,EAAE;MACdC,OAAO,CAACC,GAAG,CAACF,KAAK,CAAC;MAClBM,IAAI,CACF,IAAIF,iBAAQ,CACV,0CAA0C,EAC1C,GAAG,EACH,YACF,CACF,CAAC;IACH;EACF,CAAC,CAAC;AACJ,CAAC;AAAAsF,OAAA,CAAA1G,OAAA,GAAAC,QAAA","ignoreList":[]}},"mtime":1734359439135},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/ApproveMailToSeller.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.RejectMailToSeller = exports.ApproveMailToSeller = void 0;\nvar _nodemailer = _interopRequireDefault(require(\"nodemailer\"));\nvar _seller = _interopRequireDefault(require(\"../db/seller\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst ApproveMailToSeller = async (req, res, next) => {\n  const {\n    id\n  } = req.params; // middleware endpointe bağlı olduğu için endpointteki params'ı çekebiliyoruz\n  const seller = await _seller.default.findById(id);\n  if (!seller) {\n    throw new _ApiError.default(\"Seller not found\", 404, \"noExistSeller\");\n  }\n  const transporter = _nodemailer.default.createTransport({\n    host: \"smtp.yandex.com\",\n    port: 465,\n    secure: true,\n    auth: {\n      user: process.env.MAIL_SENDER,\n      pass: process.env.MAIL_SENDER_PASSWORD\n    },\n    debug: true,\n    logger: true\n  });\n  const mailOptions = {\n    from: `\"TURKOTREND\" <${process.env.MAIL_SENDER}>`,\n    to: seller.email,\n    subject: \"Hesabınız onaylandı\",\n    html: `\n    <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #f0f0f0; border-radius: 10px; background-color: #fafafa;\">\n      <div style=\"text-align: center; padding-bottom: 20px;\">\n        <img src=\"https://example.com/logo.png\" alt=\"Logo\" style=\"max-width: 150px;\">\n      </div>\n      <div style=\"background-color: #ffffff; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\">\n        <h2 style=\"color: #333333; text-align: center;\">Tebrikler, Hesabınız Onaylandı!</h2>\n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">Merhaba <strong>${seller.name}</strong>,</p>\n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">\n          Hesabınız başarıyla onaylanmıştır ve artık platformumuzu kullanabilirsiniz.\n        </p>\n        \n        <div style=\"background-color: #d4edda; color: #155724; padding: 15px; margin: 20px 0; border-left: 5px solid #c3e6cb; border-radius: 5px;\">\n          <p style=\"margin: 0; text-align: center;\"><strong>Hesabınız artık aktif!</strong> Platformda satış yapmaya başlayabilirsiniz.</p>\n        </div>\n        \n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">\n          Bizimle çalışmayı tercih ettiğiniz için teşekkür ederiz. Başarınız için buradayız.\n        </p>\n        \n        <div style=\"text-align: center; margin-top: 20px;\">\n          <a href=\"https://example.com/dashboard\" style=\"background-color: #28a745; color: #ffffff; padding: 10px 20px; text-decoration: none; border-radius: 5px;\">Kontrol Paneline Git</a>\n        </div>\n      </div>\n      <div style=\"text-align: center; margin-top: 20px;\">\n        <p style=\"font-size: 14px; color: #999999;\">Herhangi bir sorunuz varsa, bize ulaşmaktan çekinmeyin.</p>\n        <p style=\"font-size: 14px; color: #999999;\">© 2024 TURKOTREND. Tüm hakları saklıdır.</p>\n      </div>\n    </div>\n  `\n  };\n  try {\n    await transporter.sendMail(mailOptions);\n    return next();\n  } catch (error) {\n    console.log(error);\n    return json(new _ApiError.default(500, \"Doğrulama e postası gönderilemedi.\"));\n  }\n};\nexports.ApproveMailToSeller = ApproveMailToSeller;\nconst RejectMailToSeller = async (req, res, next) => {\n  const {\n    id\n  } = req.params; // middleware endpointe bağlı olduğu için endpointteki params'ı çekebiliyoruz\n  const {\n    response\n  } = req.body;\n  const seller = await _seller.default.findById(id);\n  if (!seller) {\n    throw new _ApiError.default(\"Seller not found\", 404, \"noExistSeller\");\n  }\n  const transporter = _nodemailer.default.createTransport({\n    host: \"smtp.yandex.com\",\n    port: 465,\n    secure: true,\n    auth: {\n      user: process.env.MAIL_SENDER,\n      pass: process.env.MAIL_SENDER_PASSWORD\n    },\n    debug: true,\n    logger: true\n  });\n  const mailOptions = {\n    from: `\"TURKOTREND\" <${process.env.MAIL_SENDER}>`,\n    to: seller.email,\n    subject: \"Hesabınız reddedildi\",\n    html: `\n    <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #f0f0f0; border-radius: 10px; background-color: #fafafa;\">\n      <div style=\"text-align: center; padding-bottom: 20px;\">\n        <img src=\"https://example.com/logo.png\" alt=\"Logo\" style=\"max-width: 150px;\">\n      </div>\n      <div style=\"background-color: #ffffff; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\">\n        <h2 style=\"color: #333333; text-align: center;\">Hesabınız Reddedildi</h2>\n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">Merhaba <strong>${seller.name}</strong>,</p>\n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">Hesabınızın reddedildiğini üzülerek bildiriyoruz.</p>\n        \n        <div style=\"background-color: #f8d7da; color: #721c24; padding: 15px; margin: 20px 0; border-left: 5px solid #f5c6cb; border-radius: 5px;\">\n          <p style=\"margin: 0;\"><strong>Reddetme Nedeni:</strong> ${response}</p> <!-- Dinamik response burada -->\n        </div>\n        \n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">\n          Eksik bilgilerinizi tamamladıktan sonra lütfen yeniden kayıt olun. Yardımcı olmaktan memnuniyet duyarız.\n        </p>\n        \n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">Bizimle çalıştığınız için teşekkür ederiz.</p>\n        \n        <div style=\"text-align: center; margin-top: 20px;\">\n          <a href=\"https://example.com/reapply\" style=\"background-color: #007bff; color: #ffffff; padding: 10px 20px; text-decoration: none; border-radius: 5px;\">Tekrar Başvur</a>\n        </div>\n      </div>\n      <div style=\"text-align: center; margin-top: 20px;\">\n        <p style=\"font-size: 14px; color: #999999;\">Bu e-postayı aldıysanız ancak başvuruda bulunmadıysanız lütfen bizimle iletişime geçin.</p>\n        <p style=\"font-size: 14px; color: #999999;\">© 2024 TURKOTREND. Tüm hakları saklıdır.</p>\n      </div>\n    </div>\n  `\n  };\n  try {\n    await transporter.sendMail(mailOptions);\n    return next();\n  } catch (error) {\n    console.log(error);\n    return json(new _ApiError.default(500, \"Doğrulama e postası gönderilemedi.\"));\n  }\n};\nexports.RejectMailToSeller = RejectMailToSeller;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbm9kZW1haWxlciIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX3NlbGxlciIsIl9BcGlFcnJvciIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIkFwcHJvdmVNYWlsVG9TZWxsZXIiLCJyZXEiLCJyZXMiLCJuZXh0IiwiaWQiLCJwYXJhbXMiLCJzZWxsZXIiLCJTZWxsZXIiLCJmaW5kQnlJZCIsIkFwaUVycm9yIiwidHJhbnNwb3J0ZXIiLCJub2RlbWFpbGVyIiwiY3JlYXRlVHJhbnNwb3J0IiwiaG9zdCIsInBvcnQiLCJzZWN1cmUiLCJhdXRoIiwidXNlciIsInByb2Nlc3MiLCJlbnYiLCJNQUlMX1NFTkRFUiIsInBhc3MiLCJNQUlMX1NFTkRFUl9QQVNTV09SRCIsImRlYnVnIiwibG9nZ2VyIiwibWFpbE9wdGlvbnMiLCJmcm9tIiwidG8iLCJlbWFpbCIsInN1YmplY3QiLCJodG1sIiwibmFtZSIsInNlbmRNYWlsIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwianNvbiIsImV4cG9ydHMiLCJSZWplY3RNYWlsVG9TZWxsZXIiLCJyZXNwb25zZSIsImJvZHkiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9taWRkbGV3YXJlcy8iLCJzb3VyY2VzIjpbIkFwcHJvdmVNYWlsVG9TZWxsZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG5vZGVtYWlsZXIgZnJvbSBcIm5vZGVtYWlsZXJcIjtcbmltcG9ydCBTZWxsZXIgZnJvbSBcIi4uL2RiL3NlbGxlclwiO1xuaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuLi9lcnJvcnMvQXBpRXJyb3JcIjtcblxuY29uc3QgQXBwcm92ZU1haWxUb1NlbGxlciA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICBjb25zdCB7IGlkIH0gPSByZXEucGFyYW1zOyAvLyBtaWRkbGV3YXJlIGVuZHBvaW50ZSBiYcSfbMSxIG9sZHXEn3UgacOnaW4gZW5kcG9pbnR0ZWtpIHBhcmFtcyfEsSDDp2VrZWJpbGl5b3J1elxuICBjb25zdCBzZWxsZXIgPSBhd2FpdCBTZWxsZXIuZmluZEJ5SWQoaWQpO1xuICBpZiAoIXNlbGxlcikge1xuICAgIHRocm93IG5ldyBBcGlFcnJvcihcIlNlbGxlciBub3QgZm91bmRcIiwgNDA0LCBcIm5vRXhpc3RTZWxsZXJcIik7XG4gIH1cbiAgY29uc3QgdHJhbnNwb3J0ZXIgPSBub2RlbWFpbGVyLmNyZWF0ZVRyYW5zcG9ydCh7XG4gICAgaG9zdDogXCJzbXRwLnlhbmRleC5jb21cIixcbiAgICBwb3J0OiA0NjUsXG4gICAgc2VjdXJlOiB0cnVlLFxuICAgIGF1dGg6IHtcbiAgICAgIHVzZXI6IHByb2Nlc3MuZW52Lk1BSUxfU0VOREVSLFxuICAgICAgcGFzczogcHJvY2Vzcy5lbnYuTUFJTF9TRU5ERVJfUEFTU1dPUkQsXG4gICAgfSxcbiAgICBkZWJ1ZzogdHJ1ZSxcbiAgICBsb2dnZXI6IHRydWUsXG4gIH0pO1xuXG4gIGNvbnN0IG1haWxPcHRpb25zID0ge1xuICAgIGZyb206IGBcIlRVUktPVFJFTkRcIiA8JHtwcm9jZXNzLmVudi5NQUlMX1NFTkRFUn0+YCxcbiAgICB0bzogc2VsbGVyLmVtYWlsLFxuICAgIHN1YmplY3Q6IFwiSGVzYWLEsW7EsXogb25heWxhbmTEsVwiLFxuICAgIGh0bWw6IGBcbiAgICA8ZGl2IHN0eWxlPVwiZm9udC1mYW1pbHk6IEFyaWFsLCBzYW5zLXNlcmlmOyBtYXgtd2lkdGg6IDYwMHB4OyBtYXJnaW46IDAgYXV0bzsgcGFkZGluZzogMjBweDsgYm9yZGVyOiAxcHggc29saWQgI2YwZjBmMDsgYm9yZGVyLXJhZGl1czogMTBweDsgYmFja2dyb3VuZC1jb2xvcjogI2ZhZmFmYTtcIj5cbiAgICAgIDxkaXYgc3R5bGU9XCJ0ZXh0LWFsaWduOiBjZW50ZXI7IHBhZGRpbmctYm90dG9tOiAyMHB4O1wiPlxuICAgICAgICA8aW1nIHNyYz1cImh0dHBzOi8vZXhhbXBsZS5jb20vbG9nby5wbmdcIiBhbHQ9XCJMb2dvXCIgc3R5bGU9XCJtYXgtd2lkdGg6IDE1MHB4O1wiPlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2IHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjogI2ZmZmZmZjsgcGFkZGluZzogMjBweDsgYm9yZGVyLXJhZGl1czogMTBweDsgYm94LXNoYWRvdzogMCAwIDEwcHggcmdiYSgwLCAwLCAwLCAwLjEpO1wiPlxuICAgICAgICA8aDIgc3R5bGU9XCJjb2xvcjogIzMzMzMzMzsgdGV4dC1hbGlnbjogY2VudGVyO1wiPlRlYnJpa2xlciwgSGVzYWLEsW7EsXogT25heWxhbmTEsSE8L2gyPlxuICAgICAgICA8cCBzdHlsZT1cImZvbnQtc2l6ZTogMTZweDsgY29sb3I6ICM1NTU1NTU7IHRleHQtYWxpZ246IGNlbnRlcjtcIj5NZXJoYWJhIDxzdHJvbmc+JHtzZWxsZXIubmFtZX08L3N0cm9uZz4sPC9wPlxuICAgICAgICA8cCBzdHlsZT1cImZvbnQtc2l6ZTogMTZweDsgY29sb3I6ICM1NTU1NTU7IHRleHQtYWxpZ246IGNlbnRlcjtcIj5cbiAgICAgICAgICBIZXNhYsSxbsSxeiBiYcWfYXLEsXlsYSBvbmF5bGFubcSxxZ90xLFyIHZlIGFydMSxayBwbGF0Zm9ybXVtdXp1IGt1bGxhbmFiaWxpcnNpbml6LlxuICAgICAgICA8L3A+XG4gICAgICAgIFxuICAgICAgICA8ZGl2IHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjogI2Q0ZWRkYTsgY29sb3I6ICMxNTU3MjQ7IHBhZGRpbmc6IDE1cHg7IG1hcmdpbjogMjBweCAwOyBib3JkZXItbGVmdDogNXB4IHNvbGlkICNjM2U2Y2I7IGJvcmRlci1yYWRpdXM6IDVweDtcIj5cbiAgICAgICAgICA8cCBzdHlsZT1cIm1hcmdpbjogMDsgdGV4dC1hbGlnbjogY2VudGVyO1wiPjxzdHJvbmc+SGVzYWLEsW7EsXogYXJ0xLFrIGFrdGlmITwvc3Ryb25nPiBQbGF0Zm9ybWRhIHNhdMSxxZ8geWFwbWF5YSBiYcWfbGF5YWJpbGlyc2luaXouPC9wPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgXG4gICAgICAgIDxwIHN0eWxlPVwiZm9udC1zaXplOiAxNnB4OyBjb2xvcjogIzU1NTU1NTsgdGV4dC1hbGlnbjogY2VudGVyO1wiPlxuICAgICAgICAgIEJpemltbGUgw6dhbMSxxZ9tYXnEsSB0ZXJjaWggZXR0acSfaW5peiBpw6dpbiB0ZcWfZWtrw7xyIGVkZXJpei4gQmHFn2FyxLFuxLF6IGnDp2luIGJ1cmFkYXnEsXouXG4gICAgICAgIDwvcD5cbiAgICAgICAgXG4gICAgICAgIDxkaXYgc3R5bGU9XCJ0ZXh0LWFsaWduOiBjZW50ZXI7IG1hcmdpbi10b3A6IDIwcHg7XCI+XG4gICAgICAgICAgPGEgaHJlZj1cImh0dHBzOi8vZXhhbXBsZS5jb20vZGFzaGJvYXJkXCIgc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiAjMjhhNzQ1OyBjb2xvcjogI2ZmZmZmZjsgcGFkZGluZzogMTBweCAyMHB4OyB0ZXh0LWRlY29yYXRpb246IG5vbmU7IGJvcmRlci1yYWRpdXM6IDVweDtcIj5Lb250cm9sIFBhbmVsaW5lIEdpdDwvYT5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICAgIDxkaXYgc3R5bGU9XCJ0ZXh0LWFsaWduOiBjZW50ZXI7IG1hcmdpbi10b3A6IDIwcHg7XCI+XG4gICAgICAgIDxwIHN0eWxlPVwiZm9udC1zaXplOiAxNHB4OyBjb2xvcjogIzk5OTk5OTtcIj5IZXJoYW5naSBiaXIgc29ydW51eiB2YXJzYSwgYml6ZSB1bGHFn21ha3RhbiDDp2VraW5tZXlpbi48L3A+XG4gICAgICAgIDxwIHN0eWxlPVwiZm9udC1zaXplOiAxNHB4OyBjb2xvcjogIzk5OTk5OTtcIj7CqSAyMDI0IFRVUktPVFJFTkQuIFTDvG0gaGFrbGFyxLEgc2FrbMSxZMSxci48L3A+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgYCxcbiAgfTtcblxuICB0cnkge1xuICAgIGF3YWl0IHRyYW5zcG9ydGVyLnNlbmRNYWlsKG1haWxPcHRpb25zKTtcbiAgICByZXR1cm4gbmV4dCgpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICByZXR1cm4ganNvbihuZXcgQXBpRXJyb3IoNTAwLCBcIkRvxJ9ydWxhbWEgZSBwb3N0YXPEsSBnw7ZuZGVyaWxlbWVkaS5cIikpO1xuICB9XG59O1xuXG5jb25zdCBSZWplY3RNYWlsVG9TZWxsZXIgPSBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgY29uc3QgeyBpZCB9ID0gcmVxLnBhcmFtczsgLy8gbWlkZGxld2FyZSBlbmRwb2ludGUgYmHEn2zEsSBvbGR1xJ91IGnDp2luIGVuZHBvaW50dGVraSBwYXJhbXMnxLEgw6dla2ViaWxpeW9ydXpcbiAgY29uc3QgeyByZXNwb25zZSB9ID0gcmVxLmJvZHk7XG4gIGNvbnN0IHNlbGxlciA9IGF3YWl0IFNlbGxlci5maW5kQnlJZChpZCk7XG4gIGlmICghc2VsbGVyKSB7XG4gICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiU2VsbGVyIG5vdCBmb3VuZFwiLCA0MDQsIFwibm9FeGlzdFNlbGxlclwiKTtcbiAgfVxuICBjb25zdCB0cmFuc3BvcnRlciA9IG5vZGVtYWlsZXIuY3JlYXRlVHJhbnNwb3J0KHtcbiAgICBob3N0OiBcInNtdHAueWFuZGV4LmNvbVwiLFxuICAgIHBvcnQ6IDQ2NSxcbiAgICBzZWN1cmU6IHRydWUsXG4gICAgYXV0aDoge1xuICAgICAgdXNlcjogcHJvY2Vzcy5lbnYuTUFJTF9TRU5ERVIsXG4gICAgICBwYXNzOiBwcm9jZXNzLmVudi5NQUlMX1NFTkRFUl9QQVNTV09SRCxcbiAgICB9LFxuICAgIGRlYnVnOiB0cnVlLFxuICAgIGxvZ2dlcjogdHJ1ZSxcbiAgfSk7XG5cbiAgY29uc3QgbWFpbE9wdGlvbnMgPSB7XG4gICAgZnJvbTogYFwiVFVSS09UUkVORFwiIDwke3Byb2Nlc3MuZW52Lk1BSUxfU0VOREVSfT5gLFxuICAgIHRvOiBzZWxsZXIuZW1haWwsXG4gICAgc3ViamVjdDogXCJIZXNhYsSxbsSxeiByZWRkZWRpbGRpXCIsXG4gICAgaHRtbDogYFxuICAgIDxkaXYgc3R5bGU9XCJmb250LWZhbWlseTogQXJpYWwsIHNhbnMtc2VyaWY7IG1heC13aWR0aDogNjAwcHg7IG1hcmdpbjogMCBhdXRvOyBwYWRkaW5nOiAyMHB4OyBib3JkZXI6IDFweCBzb2xpZCAjZjBmMGYwOyBib3JkZXItcmFkaXVzOiAxMHB4OyBiYWNrZ3JvdW5kLWNvbG9yOiAjZmFmYWZhO1wiPlxuICAgICAgPGRpdiBzdHlsZT1cInRleHQtYWxpZ246IGNlbnRlcjsgcGFkZGluZy1ib3R0b206IDIwcHg7XCI+XG4gICAgICAgIDxpbWcgc3JjPVwiaHR0cHM6Ly9leGFtcGxlLmNvbS9sb2dvLnBuZ1wiIGFsdD1cIkxvZ29cIiBzdHlsZT1cIm1heC13aWR0aDogMTUwcHg7XCI+XG4gICAgICA8L2Rpdj5cbiAgICAgIDxkaXYgc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmZmZmOyBwYWRkaW5nOiAyMHB4OyBib3JkZXItcmFkaXVzOiAxMHB4OyBib3gtc2hhZG93OiAwIDAgMTBweCByZ2JhKDAsIDAsIDAsIDAuMSk7XCI+XG4gICAgICAgIDxoMiBzdHlsZT1cImNvbG9yOiAjMzMzMzMzOyB0ZXh0LWFsaWduOiBjZW50ZXI7XCI+SGVzYWLEsW7EsXogUmVkZGVkaWxkaTwvaDI+XG4gICAgICAgIDxwIHN0eWxlPVwiZm9udC1zaXplOiAxNnB4OyBjb2xvcjogIzU1NTU1NTsgdGV4dC1hbGlnbjogY2VudGVyO1wiPk1lcmhhYmEgPHN0cm9uZz4ke3NlbGxlci5uYW1lfTwvc3Ryb25nPiw8L3A+XG4gICAgICAgIDxwIHN0eWxlPVwiZm9udC1zaXplOiAxNnB4OyBjb2xvcjogIzU1NTU1NTsgdGV4dC1hbGlnbjogY2VudGVyO1wiPkhlc2FixLFuxLF6xLFuIHJlZGRlZGlsZGnEn2luaSDDvHrDvGxlcmVrIGJpbGRpcml5b3J1ei48L3A+XG4gICAgICAgIFxuICAgICAgICA8ZGl2IHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjogI2Y4ZDdkYTsgY29sb3I6ICM3MjFjMjQ7IHBhZGRpbmc6IDE1cHg7IG1hcmdpbjogMjBweCAwOyBib3JkZXItbGVmdDogNXB4IHNvbGlkICNmNWM2Y2I7IGJvcmRlci1yYWRpdXM6IDVweDtcIj5cbiAgICAgICAgICA8cCBzdHlsZT1cIm1hcmdpbjogMDtcIj48c3Ryb25nPlJlZGRldG1lIE5lZGVuaTo8L3N0cm9uZz4gJHtyZXNwb25zZX08L3A+IDwhLS0gRGluYW1payByZXNwb25zZSBidXJhZGEgLS0+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICBcbiAgICAgICAgPHAgc3R5bGU9XCJmb250LXNpemU6IDE2cHg7IGNvbG9yOiAjNTU1NTU1OyB0ZXh0LWFsaWduOiBjZW50ZXI7XCI+XG4gICAgICAgICAgRWtzaWsgYmlsZ2lsZXJpbml6aSB0YW1hbWxhZMSxa3RhbiBzb25yYSBsw7x0ZmVuIHllbmlkZW4ga2F5xLF0IG9sdW4uIFlhcmTEsW1jxLEgb2xtYWt0YW4gbWVtbnVuaXlldCBkdXlhcsSxei5cbiAgICAgICAgPC9wPlxuICAgICAgICBcbiAgICAgICAgPHAgc3R5bGU9XCJmb250LXNpemU6IDE2cHg7IGNvbG9yOiAjNTU1NTU1OyB0ZXh0LWFsaWduOiBjZW50ZXI7XCI+Qml6aW1sZSDDp2FsxLHFn3TEscSfxLFuxLF6IGnDp2luIHRlxZ9la2vDvHIgZWRlcml6LjwvcD5cbiAgICAgICAgXG4gICAgICAgIDxkaXYgc3R5bGU9XCJ0ZXh0LWFsaWduOiBjZW50ZXI7IG1hcmdpbi10b3A6IDIwcHg7XCI+XG4gICAgICAgICAgPGEgaHJlZj1cImh0dHBzOi8vZXhhbXBsZS5jb20vcmVhcHBseVwiIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjogIzAwN2JmZjsgY29sb3I6ICNmZmZmZmY7IHBhZGRpbmc6IDEwcHggMjBweDsgdGV4dC1kZWNvcmF0aW9uOiBub25lOyBib3JkZXItcmFkaXVzOiA1cHg7XCI+VGVrcmFyIEJhxZ92dXI8L2E+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2IHN0eWxlPVwidGV4dC1hbGlnbjogY2VudGVyOyBtYXJnaW4tdG9wOiAyMHB4O1wiPlxuICAgICAgICA8cCBzdHlsZT1cImZvbnQtc2l6ZTogMTRweDsgY29sb3I6ICM5OTk5OTk7XCI+QnUgZS1wb3N0YXnEsSBhbGTEsXlzYW7EsXogYW5jYWsgYmHFn3Z1cnVkYSBidWx1bm1hZMSxeXNhbsSxeiBsw7x0ZmVuIGJpemltbGUgaWxldGnFn2ltZSBnZcOnaW4uPC9wPlxuICAgICAgICA8cCBzdHlsZT1cImZvbnQtc2l6ZTogMTRweDsgY29sb3I6ICM5OTk5OTk7XCI+wqkgMjAyNCBUVVJLT1RSRU5ELiBUw7xtIGhha2xhcsSxIHNha2zEsWTEsXIuPC9wPlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIGAsXG4gIH07XG4gIHRyeSB7XG4gICAgYXdhaXQgdHJhbnNwb3J0ZXIuc2VuZE1haWwobWFpbE9wdGlvbnMpO1xuICAgIHJldHVybiBuZXh0KCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgIHJldHVybiBqc29uKG5ldyBBcGlFcnJvcig1MDAsIFwiRG/En3J1bGFtYSBlIHBvc3Rhc8SxIGfDtm5kZXJpbGVtZWRpLlwiKSk7XG4gIH1cbn07XG5cbmV4cG9ydCB7IEFwcHJvdmVNYWlsVG9TZWxsZXIsIFJlamVjdE1haWxUb1NlbGxlciB9O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxXQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxPQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxTQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFBMEMsU0FBQUQsdUJBQUFJLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFMUMsTUFBTUcsbUJBQW1CLEdBQUcs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","map":{"version":3,"names":["_nodemailer","_interopRequireDefault","require","_seller","_ApiError","e","__esModule","default","ApproveMailToSeller","req","res","next","id","params","seller","Seller","findById","ApiError","transporter","nodemailer","createTransport","host","port","secure","auth","user","process","env","MAIL_SENDER","pass","MAIL_SENDER_PASSWORD","debug","logger","mailOptions","from","to","email","subject","html","name","sendMail","error","console","log","json","exports","RejectMailToSeller","response","body"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["ApproveMailToSeller.js"],"sourcesContent":["import nodemailer from \"nodemailer\";\nimport Seller from \"../db/seller\";\nimport ApiError from \"../errors/ApiError\";\n\nconst ApproveMailToSeller = async (req, res, next) => {\n  const { id } = req.params; // middleware endpointe bağlı olduğu için endpointteki params'ı çekebiliyoruz\n  const seller = await Seller.findById(id);\n  if (!seller) {\n    throw new ApiError(\"Seller not found\", 404, \"noExistSeller\");\n  }\n  const transporter = nodemailer.createTransport({\n    host: \"smtp.yandex.com\",\n    port: 465,\n    secure: true,\n    auth: {\n      user: process.env.MAIL_SENDER,\n      pass: process.env.MAIL_SENDER_PASSWORD,\n    },\n    debug: true,\n    logger: true,\n  });\n\n  const mailOptions = {\n    from: `\"TURKOTREND\" <${process.env.MAIL_SENDER}>`,\n    to: seller.email,\n    subject: \"Hesabınız onaylandı\",\n    html: `\n    <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #f0f0f0; border-radius: 10px; background-color: #fafafa;\">\n      <div style=\"text-align: center; padding-bottom: 20px;\">\n        <img src=\"https://example.com/logo.png\" alt=\"Logo\" style=\"max-width: 150px;\">\n      </div>\n      <div style=\"background-color: #ffffff; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\">\n        <h2 style=\"color: #333333; text-align: center;\">Tebrikler, Hesabınız Onaylandı!</h2>\n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">Merhaba <strong>${seller.name}</strong>,</p>\n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">\n          Hesabınız başarıyla onaylanmıştır ve artık platformumuzu kullanabilirsiniz.\n        </p>\n        \n        <div style=\"background-color: #d4edda; color: #155724; padding: 15px; margin: 20px 0; border-left: 5px solid #c3e6cb; border-radius: 5px;\">\n          <p style=\"margin: 0; text-align: center;\"><strong>Hesabınız artık aktif!</strong> Platformda satış yapmaya başlayabilirsiniz.</p>\n        </div>\n        \n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">\n          Bizimle çalışmayı tercih ettiğiniz için teşekkür ederiz. Başarınız için buradayız.\n        </p>\n        \n        <div style=\"text-align: center; margin-top: 20px;\">\n          <a href=\"https://example.com/dashboard\" style=\"background-color: #28a745; color: #ffffff; padding: 10px 20px; text-decoration: none; border-radius: 5px;\">Kontrol Paneline Git</a>\n        </div>\n      </div>\n      <div style=\"text-align: center; margin-top: 20px;\">\n        <p style=\"font-size: 14px; color: #999999;\">Herhangi bir sorunuz varsa, bize ulaşmaktan çekinmeyin.</p>\n        <p style=\"font-size: 14px; color: #999999;\">© 2024 TURKOTREND. Tüm hakları saklıdır.</p>\n      </div>\n    </div>\n  `,\n  };\n\n  try {\n    await transporter.sendMail(mailOptions);\n    return next();\n  } catch (error) {\n    console.log(error);\n    return json(new ApiError(500, \"Doğrulama e postası gönderilemedi.\"));\n  }\n};\n\nconst RejectMailToSeller = async (req, res, next) => {\n  const { id } = req.params; // middleware endpointe bağlı olduğu için endpointteki params'ı çekebiliyoruz\n  const { response } = req.body;\n  const seller = await Seller.findById(id);\n  if (!seller) {\n    throw new ApiError(\"Seller not found\", 404, \"noExistSeller\");\n  }\n  const transporter = nodemailer.createTransport({\n    host: \"smtp.yandex.com\",\n    port: 465,\n    secure: true,\n    auth: {\n      user: process.env.MAIL_SENDER,\n      pass: process.env.MAIL_SENDER_PASSWORD,\n    },\n    debug: true,\n    logger: true,\n  });\n\n  const mailOptions = {\n    from: `\"TURKOTREND\" <${process.env.MAIL_SENDER}>`,\n    to: seller.email,\n    subject: \"Hesabınız reddedildi\",\n    html: `\n    <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #f0f0f0; border-radius: 10px; background-color: #fafafa;\">\n      <div style=\"text-align: center; padding-bottom: 20px;\">\n        <img src=\"https://example.com/logo.png\" alt=\"Logo\" style=\"max-width: 150px;\">\n      </div>\n      <div style=\"background-color: #ffffff; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\">\n        <h2 style=\"color: #333333; text-align: center;\">Hesabınız Reddedildi</h2>\n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">Merhaba <strong>${seller.name}</strong>,</p>\n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">Hesabınızın reddedildiğini üzülerek bildiriyoruz.</p>\n        \n        <div style=\"background-color: #f8d7da; color: #721c24; padding: 15px; margin: 20px 0; border-left: 5px solid #f5c6cb; border-radius: 5px;\">\n          <p style=\"margin: 0;\"><strong>Reddetme Nedeni:</strong> ${response}</p> <!-- Dinamik response burada -->\n        </div>\n        \n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">\n          Eksik bilgilerinizi tamamladıktan sonra lütfen yeniden kayıt olun. Yardımcı olmaktan memnuniyet duyarız.\n        </p>\n        \n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">Bizimle çalıştığınız için teşekkür ederiz.</p>\n        \n        <div style=\"text-align: center; margin-top: 20px;\">\n          <a href=\"https://example.com/reapply\" style=\"background-color: #007bff; color: #ffffff; padding: 10px 20px; text-decoration: none; border-radius: 5px;\">Tekrar Başvur</a>\n        </div>\n      </div>\n      <div style=\"text-align: center; margin-top: 20px;\">\n        <p style=\"font-size: 14px; color: #999999;\">Bu e-postayı aldıysanız ancak başvuruda bulunmadıysanız lütfen bizimle iletişime geçin.</p>\n        <p style=\"font-size: 14px; color: #999999;\">© 2024 TURKOTREND. Tüm hakları saklıdır.</p>\n      </div>\n    </div>\n  `,\n  };\n  try {\n    await transporter.sendMail(mailOptions);\n    return next();\n  } catch (error) {\n    console.log(error);\n    return json(new ApiError(500, \"Doğrulama e postası gönderilemedi.\"));\n  }\n};\n\nexport { ApproveMailToSeller, RejectMailToSeller };\n"],"mappings":"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","ignoreList":[]}},"mtime":1732535678827},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/ApproveMailToSeller.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.RejectMailToSeller = exports.ApproveMailToSeller = void 0;\nvar _nodemailer = _interopRequireDefault(require(\"nodemailer\"));\nvar _seller = _interopRequireDefault(require(\"../db/seller\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst ApproveMailToSeller = async (req, res, next) => {\n  const {\n    id\n  } = req.params; // middleware endpointe bağlı olduğu için endpointteki params'ı çekebiliyoruz\n  const seller = await _seller.default.findById(id);\n  if (!seller) {\n    throw new _ApiError.default(\"Seller not found\", 404, \"noExistSeller\");\n  }\n  const transporter = _nodemailer.default.createTransport({\n    host: \"smtp.yandex.com\",\n    port: 465,\n    secure: true,\n    auth: {\n      user: process.env.MAIL_SENDER,\n      pass: process.env.MAIL_SENDER_PASSWORD\n    },\n    debug: true,\n    logger: true\n  });\n  const mailOptions = {\n    from: `\"TURKOTREND\" <${process.env.MAIL_SENDER}>`,\n    to: seller.email,\n    subject: \"Hesabınız onaylandı\",\n    html: `\n    <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #f0f0f0; border-radius: 10px; background-color: #fafafa;\">\n      <div style=\"text-align: center; padding-bottom: 20px;\">\n        <img src=\"https://example.com/logo.png\" alt=\"Logo\" style=\"max-width: 150px;\">\n      </div>\n      <div style=\"background-color: #ffffff; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\">\n        <h2 style=\"color: #333333; text-align: center;\">Tebrikler, Hesabınız Onaylandı!</h2>\n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">Merhaba <strong>${seller.name}</strong>,</p>\n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">\n          Hesabınız başarıyla onaylanmıştır ve artık platformumuzu kullanabilirsiniz.\n        </p>\n        \n        <div style=\"background-color: #d4edda; color: #155724; padding: 15px; margin: 20px 0; border-left: 5px solid #c3e6cb; border-radius: 5px;\">\n          <p style=\"margin: 0; text-align: center;\"><strong>Hesabınız artık aktif!</strong> Platformda satış yapmaya başlayabilirsiniz.</p>\n        </div>\n        \n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">\n          Bizimle çalışmayı tercih ettiğiniz için teşekkür ederiz. Başarınız için buradayız.\n        </p>\n        \n        <div style=\"text-align: center; margin-top: 20px;\">\n          <a href=\"https://example.com/dashboard\" style=\"background-color: #28a745; color: #ffffff; padding: 10px 20px; text-decoration: none; border-radius: 5px;\">Kontrol Paneline Git</a>\n        </div>\n      </div>\n      <div style=\"text-align: center; margin-top: 20px;\">\n        <p style=\"font-size: 14px; color: #999999;\">Herhangi bir sorunuz varsa, bize ulaşmaktan çekinmeyin.</p>\n        <p style=\"font-size: 14px; color: #999999;\">© 2024 TURKOTREND. Tüm hakları saklıdır.</p>\n      </div>\n    </div>\n  `\n  };\n  try {\n    await transporter.sendMail(mailOptions);\n    return next();\n  } catch (error) {\n    console.log(error);\n    return json(new _ApiError.default(500, \"Doğrulama e postası gönderilemedi.\"));\n  }\n};\nexports.ApproveMailToSeller = ApproveMailToSeller;\nconst RejectMailToSeller = async (req, res, next) => {\n  const {\n    id\n  } = req.params; // middleware endpointe bağlı olduğu için endpointteki params'ı çekebiliyoruz\n  const {\n    response\n  } = req.body;\n  const seller = await _seller.default.findById(id);\n  if (!seller) {\n    throw new _ApiError.default(\"Seller not found\", 404, \"noExistSeller\");\n  }\n  const transporter = _nodemailer.default.createTransport({\n    host: \"smtp.yandex.com\",\n    port: 465,\n    secure: true,\n    auth: {\n      user: process.env.MAIL_SENDER,\n      pass: process.env.MAIL_SENDER_PASSWORD\n    },\n    debug: true,\n    logger: true\n  });\n  const mailOptions = {\n    from: `\"TURKOTREND\" <${process.env.MAIL_SENDER}>`,\n    to: seller.email,\n    subject: \"Hesabınız reddedildi\",\n    html: `\n    <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #f0f0f0; border-radius: 10px; background-color: #fafafa;\">\n      <div style=\"text-align: center; padding-bottom: 20px;\">\n        <img src=\"https://example.com/logo.png\" alt=\"Logo\" style=\"max-width: 150px;\">\n      </div>\n      <div style=\"background-color: #ffffff; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\">\n        <h2 style=\"color: #333333; text-align: center;\">Hesabınız Reddedildi</h2>\n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">Merhaba <strong>${seller.name}</strong>,</p>\n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">Hesabınızın reddedildiğini üzülerek bildiriyoruz.</p>\n        \n        <div style=\"background-color: #f8d7da; color: #721c24; padding: 15px; margin: 20px 0; border-left: 5px solid #f5c6cb; border-radius: 5px;\">\n          <p style=\"margin: 0;\"><strong>Reddetme Nedeni:</strong> ${response}</p> <!-- Dinamik response burada -->\n        </div>\n        \n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">\n          Eksik bilgilerinizi tamamladıktan sonra lütfen yeniden kayıt olun. Yardımcı olmaktan memnuniyet duyarız.\n        </p>\n        \n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">Bizimle çalıştığınız için teşekkür ederiz.</p>\n        \n        <div style=\"text-align: center; margin-top: 20px;\">\n          <a href=\"https://example.com/reapply\" style=\"background-color: #007bff; color: #ffffff; padding: 10px 20px; text-decoration: none; border-radius: 5px;\">Tekrar Başvur</a>\n        </div>\n      </div>\n      <div style=\"text-align: center; margin-top: 20px;\">\n        <p style=\"font-size: 14px; color: #999999;\">Bu e-postayı aldıysanız ancak başvuruda bulunmadıysanız lütfen bizimle iletişime geçin.</p>\n        <p style=\"font-size: 14px; color: #999999;\">© 2024 TURKOTREND. Tüm hakları saklıdır.</p>\n      </div>\n    </div>\n  `\n  };\n  try {\n    await transporter.sendMail(mailOptions);\n    return next();\n  } catch (error) {\n    console.log(error);\n    return json(new _ApiError.default(500, \"Doğrulama e postası gönderilemedi.\"));\n  }\n};\nexports.RejectMailToSeller = RejectMailToSeller;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbm9kZW1haWxlciIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX3NlbGxlciIsIl9BcGlFcnJvciIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIkFwcHJvdmVNYWlsVG9TZWxsZXIiLCJyZXEiLCJyZXMiLCJuZXh0IiwiaWQiLCJwYXJhbXMiLCJzZWxsZXIiLCJTZWxsZXIiLCJmaW5kQnlJZCIsIkFwaUVycm9yIiwidHJhbnNwb3J0ZXIiLCJub2RlbWFpbGVyIiwiY3JlYXRlVHJhbnNwb3J0IiwiaG9zdCIsInBvcnQiLCJzZWN1cmUiLCJhdXRoIiwidXNlciIsInByb2Nlc3MiLCJlbnYiLCJNQUlMX1NFTkRFUiIsInBhc3MiLCJNQUlMX1NFTkRFUl9QQVNTV09SRCIsImRlYnVnIiwibG9nZ2VyIiwibWFpbE9wdGlvbnMiLCJmcm9tIiwidG8iLCJlbWFpbCIsInN1YmplY3QiLCJodG1sIiwibmFtZSIsInNlbmRNYWlsIiwiZXJyb3IiLCJjb25zb2xlIiwibG9nIiwianNvbiIsImV4cG9ydHMiLCJSZWplY3RNYWlsVG9TZWxsZXIiLCJyZXNwb25zZSIsImJvZHkiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9taWRkbGV3YXJlcy8iLCJzb3VyY2VzIjpbIkFwcHJvdmVNYWlsVG9TZWxsZXIuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG5vZGVtYWlsZXIgZnJvbSBcIm5vZGVtYWlsZXJcIjtcbmltcG9ydCBTZWxsZXIgZnJvbSBcIi4uL2RiL3NlbGxlclwiO1xuaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuLi9lcnJvcnMvQXBpRXJyb3JcIjtcblxuY29uc3QgQXBwcm92ZU1haWxUb1NlbGxlciA9IGFzeW5jIChyZXEsIHJlcywgbmV4dCkgPT4ge1xuICBjb25zdCB7IGlkIH0gPSByZXEucGFyYW1zOyAvLyBtaWRkbGV3YXJlIGVuZHBvaW50ZSBiYcSfbMSxIG9sZHXEn3UgacOnaW4gZW5kcG9pbnR0ZWtpIHBhcmFtcyfEsSDDp2VrZWJpbGl5b3J1elxuICBjb25zdCBzZWxsZXIgPSBhd2FpdCBTZWxsZXIuZmluZEJ5SWQoaWQpO1xuICBpZiAoIXNlbGxlcikge1xuICAgIHRocm93IG5ldyBBcGlFcnJvcihcIlNlbGxlciBub3QgZm91bmRcIiwgNDA0LCBcIm5vRXhpc3RTZWxsZXJcIik7XG4gIH1cbiAgY29uc3QgdHJhbnNwb3J0ZXIgPSBub2RlbWFpbGVyLmNyZWF0ZVRyYW5zcG9ydCh7XG4gICAgaG9zdDogXCJzbXRwLnlhbmRleC5jb21cIixcbiAgICBwb3J0OiA0NjUsXG4gICAgc2VjdXJlOiB0cnVlLFxuICAgIGF1dGg6IHtcbiAgICAgIHVzZXI6IHByb2Nlc3MuZW52Lk1BSUxfU0VOREVSLFxuICAgICAgcGFzczogcHJvY2Vzcy5lbnYuTUFJTF9TRU5ERVJfUEFTU1dPUkQsXG4gICAgfSxcbiAgICBkZWJ1ZzogdHJ1ZSxcbiAgICBsb2dnZXI6IHRydWUsXG4gIH0pO1xuXG4gIGNvbnN0IG1haWxPcHRpb25zID0ge1xuICAgIGZyb206IGBcIlRVUktPVFJFTkRcIiA8JHtwcm9jZXNzLmVudi5NQUlMX1NFTkRFUn0+YCxcbiAgICB0bzogc2VsbGVyLmVtYWlsLFxuICAgIHN1YmplY3Q6IFwiSGVzYWLEsW7EsXogb25heWxhbmTEsVwiLFxuICAgIGh0bWw6IGBcbiAgICA8ZGl2IHN0eWxlPVwiZm9udC1mYW1pbHk6IEFyaWFsLCBzYW5zLXNlcmlmOyBtYXgtd2lkdGg6IDYwMHB4OyBtYXJnaW46IDAgYXV0bzsgcGFkZGluZzogMjBweDsgYm9yZGVyOiAxcHggc29saWQgI2YwZjBmMDsgYm9yZGVyLXJhZGl1czogMTBweDsgYmFja2dyb3VuZC1jb2xvcjogI2ZhZmFmYTtcIj5cbiAgICAgIDxkaXYgc3R5bGU9XCJ0ZXh0LWFsaWduOiBjZW50ZXI7IHBhZGRpbmctYm90dG9tOiAyMHB4O1wiPlxuICAgICAgICA8aW1nIHNyYz1cImh0dHBzOi8vZXhhbXBsZS5jb20vbG9nby5wbmdcIiBhbHQ9XCJMb2dvXCIgc3R5bGU9XCJtYXgtd2lkdGg6IDE1MHB4O1wiPlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2IHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjogI2ZmZmZmZjsgcGFkZGluZzogMjBweDsgYm9yZGVyLXJhZGl1czogMTBweDsgYm94LXNoYWRvdzogMCAwIDEwcHggcmdiYSgwLCAwLCAwLCAwLjEpO1wiPlxuICAgICAgICA8aDIgc3R5bGU9XCJjb2xvcjogIzMzMzMzMzsgdGV4dC1hbGlnbjogY2VudGVyO1wiPlRlYnJpa2xlciwgSGVzYWLEsW7EsXogT25heWxhbmTEsSE8L2gyPlxuICAgICAgICA8cCBzdHlsZT1cImZvbnQtc2l6ZTogMTZweDsgY29sb3I6ICM1NTU1NTU7IHRleHQtYWxpZ246IGNlbnRlcjtcIj5NZXJoYWJhIDxzdHJvbmc+JHtzZWxsZXIubmFtZX08L3N0cm9uZz4sPC9wPlxuICAgICAgICA8cCBzdHlsZT1cImZvbnQtc2l6ZTogMTZweDsgY29sb3I6ICM1NTU1NTU7IHRleHQtYWxpZ246IGNlbnRlcjtcIj5cbiAgICAgICAgICBIZXNhYsSxbsSxeiBiYcWfYXLEsXlsYSBvbmF5bGFubcSxxZ90xLFyIHZlIGFydMSxayBwbGF0Zm9ybXVtdXp1IGt1bGxhbmFiaWxpcnNpbml6LlxuICAgICAgICA8L3A+XG4gICAgICAgIFxuICAgICAgICA8ZGl2IHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjogI2Q0ZWRkYTsgY29sb3I6ICMxNTU3MjQ7IHBhZGRpbmc6IDE1cHg7IG1hcmdpbjogMjBweCAwOyBib3JkZXItbGVmdDogNXB4IHNvbGlkICNjM2U2Y2I7IGJvcmRlci1yYWRpdXM6IDVweDtcIj5cbiAgICAgICAgICA8cCBzdHlsZT1cIm1hcmdpbjogMDsgdGV4dC1hbGlnbjogY2VudGVyO1wiPjxzdHJvbmc+SGVzYWLEsW7EsXogYXJ0xLFrIGFrdGlmITwvc3Ryb25nPiBQbGF0Zm9ybWRhIHNhdMSxxZ8geWFwbWF5YSBiYcWfbGF5YWJpbGlyc2luaXouPC9wPlxuICAgICAgICA8L2Rpdj5cbiAgICAgICAgXG4gICAgICAgIDxwIHN0eWxlPVwiZm9udC1zaXplOiAxNnB4OyBjb2xvcjogIzU1NTU1NTsgdGV4dC1hbGlnbjogY2VudGVyO1wiPlxuICAgICAgICAgIEJpemltbGUgw6dhbMSxxZ9tYXnEsSB0ZXJjaWggZXR0acSfaW5peiBpw6dpbiB0ZcWfZWtrw7xyIGVkZXJpei4gQmHFn2FyxLFuxLF6IGnDp2luIGJ1cmFkYXnEsXouXG4gICAgICAgIDwvcD5cbiAgICAgICAgXG4gICAgICAgIDxkaXYgc3R5bGU9XCJ0ZXh0LWFsaWduOiBjZW50ZXI7IG1hcmdpbi10b3A6IDIwcHg7XCI+XG4gICAgICAgICAgPGEgaHJlZj1cImh0dHBzOi8vZXhhbXBsZS5jb20vZGFzaGJvYXJkXCIgc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiAjMjhhNzQ1OyBjb2xvcjogI2ZmZmZmZjsgcGFkZGluZzogMTBweCAyMHB4OyB0ZXh0LWRlY29yYXRpb246IG5vbmU7IGJvcmRlci1yYWRpdXM6IDVweDtcIj5Lb250cm9sIFBhbmVsaW5lIEdpdDwvYT5cbiAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgICAgIDxkaXYgc3R5bGU9XCJ0ZXh0LWFsaWduOiBjZW50ZXI7IG1hcmdpbi10b3A6IDIwcHg7XCI+XG4gICAgICAgIDxwIHN0eWxlPVwiZm9udC1zaXplOiAxNHB4OyBjb2xvcjogIzk5OTk5OTtcIj5IZXJoYW5naSBiaXIgc29ydW51eiB2YXJzYSwgYml6ZSB1bGHFn21ha3RhbiDDp2VraW5tZXlpbi48L3A+XG4gICAgICAgIDxwIHN0eWxlPVwiZm9udC1zaXplOiAxNHB4OyBjb2xvcjogIzk5OTk5OTtcIj7CqSAyMDI0IFRVUktPVFJFTkQuIFTDvG0gaGFrbGFyxLEgc2FrbMSxZMSxci48L3A+XG4gICAgICA8L2Rpdj5cbiAgICA8L2Rpdj5cbiAgYCxcbiAgfTtcblxuICB0cnkge1xuICAgIGF3YWl0IHRyYW5zcG9ydGVyLnNlbmRNYWlsKG1haWxPcHRpb25zKTtcbiAgICByZXR1cm4gbmV4dCgpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICByZXR1cm4ganNvbihuZXcgQXBpRXJyb3IoNTAwLCBcIkRvxJ9ydWxhbWEgZSBwb3N0YXPEsSBnw7ZuZGVyaWxlbWVkaS5cIikpO1xuICB9XG59O1xuXG5jb25zdCBSZWplY3RNYWlsVG9TZWxsZXIgPSBhc3luYyAocmVxLCByZXMsIG5leHQpID0+IHtcbiAgY29uc3QgeyBpZCB9ID0gcmVxLnBhcmFtczsgLy8gbWlkZGxld2FyZSBlbmRwb2ludGUgYmHEn2zEsSBvbGR1xJ91IGnDp2luIGVuZHBvaW50dGVraSBwYXJhbXMnxLEgw6dla2ViaWxpeW9ydXpcbiAgY29uc3QgeyByZXNwb25zZSB9ID0gcmVxLmJvZHk7XG4gIGNvbnN0IHNlbGxlciA9IGF3YWl0IFNlbGxlci5maW5kQnlJZChpZCk7XG4gIGlmICghc2VsbGVyKSB7XG4gICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiU2VsbGVyIG5vdCBmb3VuZFwiLCA0MDQsIFwibm9FeGlzdFNlbGxlclwiKTtcbiAgfVxuICBjb25zdCB0cmFuc3BvcnRlciA9IG5vZGVtYWlsZXIuY3JlYXRlVHJhbnNwb3J0KHtcbiAgICBob3N0OiBcInNtdHAueWFuZGV4LmNvbVwiLFxuICAgIHBvcnQ6IDQ2NSxcbiAgICBzZWN1cmU6IHRydWUsXG4gICAgYXV0aDoge1xuICAgICAgdXNlcjogcHJvY2Vzcy5lbnYuTUFJTF9TRU5ERVIsXG4gICAgICBwYXNzOiBwcm9jZXNzLmVudi5NQUlMX1NFTkRFUl9QQVNTV09SRCxcbiAgICB9LFxuICAgIGRlYnVnOiB0cnVlLFxuICAgIGxvZ2dlcjogdHJ1ZSxcbiAgfSk7XG5cbiAgY29uc3QgbWFpbE9wdGlvbnMgPSB7XG4gICAgZnJvbTogYFwiVFVSS09UUkVORFwiIDwke3Byb2Nlc3MuZW52Lk1BSUxfU0VOREVSfT5gLFxuICAgIHRvOiBzZWxsZXIuZW1haWwsXG4gICAgc3ViamVjdDogXCJIZXNhYsSxbsSxeiByZWRkZWRpbGRpXCIsXG4gICAgaHRtbDogYFxuICAgIDxkaXYgc3R5bGU9XCJmb250LWZhbWlseTogQXJpYWwsIHNhbnMtc2VyaWY7IG1heC13aWR0aDogNjAwcHg7IG1hcmdpbjogMCBhdXRvOyBwYWRkaW5nOiAyMHB4OyBib3JkZXI6IDFweCBzb2xpZCAjZjBmMGYwOyBib3JkZXItcmFkaXVzOiAxMHB4OyBiYWNrZ3JvdW5kLWNvbG9yOiAjZmFmYWZhO1wiPlxuICAgICAgPGRpdiBzdHlsZT1cInRleHQtYWxpZ246IGNlbnRlcjsgcGFkZGluZy1ib3R0b206IDIwcHg7XCI+XG4gICAgICAgIDxpbWcgc3JjPVwiaHR0cHM6Ly9leGFtcGxlLmNvbS9sb2dvLnBuZ1wiIGFsdD1cIkxvZ29cIiBzdHlsZT1cIm1heC13aWR0aDogMTUwcHg7XCI+XG4gICAgICA8L2Rpdj5cbiAgICAgIDxkaXYgc3R5bGU9XCJiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmZmZmOyBwYWRkaW5nOiAyMHB4OyBib3JkZXItcmFkaXVzOiAxMHB4OyBib3gtc2hhZG93OiAwIDAgMTBweCByZ2JhKDAsIDAsIDAsIDAuMSk7XCI+XG4gICAgICAgIDxoMiBzdHlsZT1cImNvbG9yOiAjMzMzMzMzOyB0ZXh0LWFsaWduOiBjZW50ZXI7XCI+SGVzYWLEsW7EsXogUmVkZGVkaWxkaTwvaDI+XG4gICAgICAgIDxwIHN0eWxlPVwiZm9udC1zaXplOiAxNnB4OyBjb2xvcjogIzU1NTU1NTsgdGV4dC1hbGlnbjogY2VudGVyO1wiPk1lcmhhYmEgPHN0cm9uZz4ke3NlbGxlci5uYW1lfTwvc3Ryb25nPiw8L3A+XG4gICAgICAgIDxwIHN0eWxlPVwiZm9udC1zaXplOiAxNnB4OyBjb2xvcjogIzU1NTU1NTsgdGV4dC1hbGlnbjogY2VudGVyO1wiPkhlc2FixLFuxLF6xLFuIHJlZGRlZGlsZGnEn2luaSDDvHrDvGxlcmVrIGJpbGRpcml5b3J1ei48L3A+XG4gICAgICAgIFxuICAgICAgICA8ZGl2IHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjogI2Y4ZDdkYTsgY29sb3I6ICM3MjFjMjQ7IHBhZGRpbmc6IDE1cHg7IG1hcmdpbjogMjBweCAwOyBib3JkZXItbGVmdDogNXB4IHNvbGlkICNmNWM2Y2I7IGJvcmRlci1yYWRpdXM6IDVweDtcIj5cbiAgICAgICAgICA8cCBzdHlsZT1cIm1hcmdpbjogMDtcIj48c3Ryb25nPlJlZGRldG1lIE5lZGVuaTo8L3N0cm9uZz4gJHtyZXNwb25zZX08L3A+IDwhLS0gRGluYW1payByZXNwb25zZSBidXJhZGEgLS0+XG4gICAgICAgIDwvZGl2PlxuICAgICAgICBcbiAgICAgICAgPHAgc3R5bGU9XCJmb250LXNpemU6IDE2cHg7IGNvbG9yOiAjNTU1NTU1OyB0ZXh0LWFsaWduOiBjZW50ZXI7XCI+XG4gICAgICAgICAgRWtzaWsgYmlsZ2lsZXJpbml6aSB0YW1hbWxhZMSxa3RhbiBzb25yYSBsw7x0ZmVuIHllbmlkZW4ga2F5xLF0IG9sdW4uIFlhcmTEsW1jxLEgb2xtYWt0YW4gbWVtbnVuaXlldCBkdXlhcsSxei5cbiAgICAgICAgPC9wPlxuICAgICAgICBcbiAgICAgICAgPHAgc3R5bGU9XCJmb250LXNpemU6IDE2cHg7IGNvbG9yOiAjNTU1NTU1OyB0ZXh0LWFsaWduOiBjZW50ZXI7XCI+Qml6aW1sZSDDp2FsxLHFn3TEscSfxLFuxLF6IGnDp2luIHRlxZ9la2vDvHIgZWRlcml6LjwvcD5cbiAgICAgICAgXG4gICAgICAgIDxkaXYgc3R5bGU9XCJ0ZXh0LWFsaWduOiBjZW50ZXI7IG1hcmdpbi10b3A6IDIwcHg7XCI+XG4gICAgICAgICAgPGEgaHJlZj1cImh0dHBzOi8vZXhhbXBsZS5jb20vcmVhcHBseVwiIHN0eWxlPVwiYmFja2dyb3VuZC1jb2xvcjogIzAwN2JmZjsgY29sb3I6ICNmZmZmZmY7IHBhZGRpbmc6IDEwcHggMjBweDsgdGV4dC1kZWNvcmF0aW9uOiBub25lOyBib3JkZXItcmFkaXVzOiA1cHg7XCI+VGVrcmFyIEJhxZ92dXI8L2E+XG4gICAgICAgIDwvZGl2PlxuICAgICAgPC9kaXY+XG4gICAgICA8ZGl2IHN0eWxlPVwidGV4dC1hbGlnbjogY2VudGVyOyBtYXJnaW4tdG9wOiAyMHB4O1wiPlxuICAgICAgICA8cCBzdHlsZT1cImZvbnQtc2l6ZTogMTRweDsgY29sb3I6ICM5OTk5OTk7XCI+QnUgZS1wb3N0YXnEsSBhbGTEsXlzYW7EsXogYW5jYWsgYmHFn3Z1cnVkYSBidWx1bm1hZMSxeXNhbsSxeiBsw7x0ZmVuIGJpemltbGUgaWxldGnFn2ltZSBnZcOnaW4uPC9wPlxuICAgICAgICA8cCBzdHlsZT1cImZvbnQtc2l6ZTogMTRweDsgY29sb3I6ICM5OTk5OTk7XCI+wqkgMjAyNCBUVVJLT1RSRU5ELiBUw7xtIGhha2xhcsSxIHNha2zEsWTEsXIuPC9wPlxuICAgICAgPC9kaXY+XG4gICAgPC9kaXY+XG4gIGAsXG4gIH07XG4gIHRyeSB7XG4gICAgYXdhaXQgdHJhbnNwb3J0ZXIuc2VuZE1haWwobWFpbE9wdGlvbnMpO1xuICAgIHJldHVybiBuZXh0KCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgIHJldHVybiBqc29uKG5ldyBBcGlFcnJvcig1MDAsIFwiRG/En3J1bGFtYSBlIHBvc3Rhc8SxIGfDtm5kZXJpbGVtZWRpLlwiKSk7XG4gIH1cbn07XG5cbmV4cG9ydCB7IEFwcHJvdmVNYWlsVG9TZWxsZXIsIFJlamVjdE1haWxUb1NlbGxlciB9O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxXQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxPQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxTQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFBMEMsU0FBQUQsdUJBQUFJLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFMUMsTUFBTUcsbUJBQW1CLEdBQUcs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","map":{"version":3,"names":["_nodemailer","_interopRequireDefault","require","_seller","_ApiError","e","__esModule","default","ApproveMailToSeller","req","res","next","id","params","seller","Seller","findById","ApiError","transporter","nodemailer","createTransport","host","port","secure","auth","user","process","env","MAIL_SENDER","pass","MAIL_SENDER_PASSWORD","debug","logger","mailOptions","from","to","email","subject","html","name","sendMail","error","console","log","json","exports","RejectMailToSeller","response","body"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/middlewares/","sources":["ApproveMailToSeller.js"],"sourcesContent":["import nodemailer from \"nodemailer\";\nimport Seller from \"../db/seller\";\nimport ApiError from \"../errors/ApiError\";\n\nconst ApproveMailToSeller = async (req, res, next) => {\n  const { id } = req.params; // middleware endpointe bağlı olduğu için endpointteki params'ı çekebiliyoruz\n  const seller = await Seller.findById(id);\n  if (!seller) {\n    throw new ApiError(\"Seller not found\", 404, \"noExistSeller\");\n  }\n  const transporter = nodemailer.createTransport({\n    host: \"smtp.yandex.com\",\n    port: 465,\n    secure: true,\n    auth: {\n      user: process.env.MAIL_SENDER,\n      pass: process.env.MAIL_SENDER_PASSWORD,\n    },\n    debug: true,\n    logger: true,\n  });\n\n  const mailOptions = {\n    from: `\"TURKOTREND\" <${process.env.MAIL_SENDER}>`,\n    to: seller.email,\n    subject: \"Hesabınız onaylandı\",\n    html: `\n    <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #f0f0f0; border-radius: 10px; background-color: #fafafa;\">\n      <div style=\"text-align: center; padding-bottom: 20px;\">\n        <img src=\"https://example.com/logo.png\" alt=\"Logo\" style=\"max-width: 150px;\">\n      </div>\n      <div style=\"background-color: #ffffff; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\">\n        <h2 style=\"color: #333333; text-align: center;\">Tebrikler, Hesabınız Onaylandı!</h2>\n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">Merhaba <strong>${seller.name}</strong>,</p>\n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">\n          Hesabınız başarıyla onaylanmıştır ve artık platformumuzu kullanabilirsiniz.\n        </p>\n        \n        <div style=\"background-color: #d4edda; color: #155724; padding: 15px; margin: 20px 0; border-left: 5px solid #c3e6cb; border-radius: 5px;\">\n          <p style=\"margin: 0; text-align: center;\"><strong>Hesabınız artık aktif!</strong> Platformda satış yapmaya başlayabilirsiniz.</p>\n        </div>\n        \n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">\n          Bizimle çalışmayı tercih ettiğiniz için teşekkür ederiz. Başarınız için buradayız.\n        </p>\n        \n        <div style=\"text-align: center; margin-top: 20px;\">\n          <a href=\"https://example.com/dashboard\" style=\"background-color: #28a745; color: #ffffff; padding: 10px 20px; text-decoration: none; border-radius: 5px;\">Kontrol Paneline Git</a>\n        </div>\n      </div>\n      <div style=\"text-align: center; margin-top: 20px;\">\n        <p style=\"font-size: 14px; color: #999999;\">Herhangi bir sorunuz varsa, bize ulaşmaktan çekinmeyin.</p>\n        <p style=\"font-size: 14px; color: #999999;\">© 2024 TURKOTREND. Tüm hakları saklıdır.</p>\n      </div>\n    </div>\n  `,\n  };\n\n  try {\n    await transporter.sendMail(mailOptions);\n    return next();\n  } catch (error) {\n    console.log(error);\n    return json(new ApiError(500, \"Doğrulama e postası gönderilemedi.\"));\n  }\n};\n\nconst RejectMailToSeller = async (req, res, next) => {\n  const { id } = req.params; // middleware endpointe bağlı olduğu için endpointteki params'ı çekebiliyoruz\n  const { response } = req.body;\n  const seller = await Seller.findById(id);\n  if (!seller) {\n    throw new ApiError(\"Seller not found\", 404, \"noExistSeller\");\n  }\n  const transporter = nodemailer.createTransport({\n    host: \"smtp.yandex.com\",\n    port: 465,\n    secure: true,\n    auth: {\n      user: process.env.MAIL_SENDER,\n      pass: process.env.MAIL_SENDER_PASSWORD,\n    },\n    debug: true,\n    logger: true,\n  });\n\n  const mailOptions = {\n    from: `\"TURKOTREND\" <${process.env.MAIL_SENDER}>`,\n    to: seller.email,\n    subject: \"Hesabınız reddedildi\",\n    html: `\n    <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; border: 1px solid #f0f0f0; border-radius: 10px; background-color: #fafafa;\">\n      <div style=\"text-align: center; padding-bottom: 20px;\">\n        <img src=\"https://example.com/logo.png\" alt=\"Logo\" style=\"max-width: 150px;\">\n      </div>\n      <div style=\"background-color: #ffffff; padding: 20px; border-radius: 10px; box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);\">\n        <h2 style=\"color: #333333; text-align: center;\">Hesabınız Reddedildi</h2>\n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">Merhaba <strong>${seller.name}</strong>,</p>\n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">Hesabınızın reddedildiğini üzülerek bildiriyoruz.</p>\n        \n        <div style=\"background-color: #f8d7da; color: #721c24; padding: 15px; margin: 20px 0; border-left: 5px solid #f5c6cb; border-radius: 5px;\">\n          <p style=\"margin: 0;\"><strong>Reddetme Nedeni:</strong> ${response}</p> <!-- Dinamik response burada -->\n        </div>\n        \n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">\n          Eksik bilgilerinizi tamamladıktan sonra lütfen yeniden kayıt olun. Yardımcı olmaktan memnuniyet duyarız.\n        </p>\n        \n        <p style=\"font-size: 16px; color: #555555; text-align: center;\">Bizimle çalıştığınız için teşekkür ederiz.</p>\n        \n        <div style=\"text-align: center; margin-top: 20px;\">\n          <a href=\"https://example.com/reapply\" style=\"background-color: #007bff; color: #ffffff; padding: 10px 20px; text-decoration: none; border-radius: 5px;\">Tekrar Başvur</a>\n        </div>\n      </div>\n      <div style=\"text-align: center; margin-top: 20px;\">\n        <p style=\"font-size: 14px; color: #999999;\">Bu e-postayı aldıysanız ancak başvuruda bulunmadıysanız lütfen bizimle iletişime geçin.</p>\n        <p style=\"font-size: 14px; color: #999999;\">© 2024 TURKOTREND. Tüm hakları saklıdır.</p>\n      </div>\n    </div>\n  `,\n  };\n  try {\n    await transporter.sendMail(mailOptions);\n    return next();\n  } catch (error) {\n    console.log(error);\n    return json(new ApiError(500, \"Doğrulama e postası gönderilemedi.\"));\n  }\n};\n\nexport { ApproveMailToSeller, RejectMailToSeller };\n"],"mappings":"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","ignoreList":[]}},"mtime":1732535678827},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/helpers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/helpers/Permissions.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst checkPermissions = (user, roles) => {\n  if (!roles.includes(user.role)) {\n    throw new _ApiError.default(\"Forbidden: Insufficient permissions\", 403, \"insufficientPermissions\");\n  }\n};\nconst checkProductOwnerShip = (user, product) => {\n  if (user.role === \"seller\" && product.seller.toString() !== user._id.toString()) {\n    throw new _ApiError.default(\"Forbidden: You are not authorized to delete this product\", 403, \"unauthorized ProductDelete\");\n  }\n};\nconst checkCommentOwnerShip = (user, comment) => {\n  if (user.role === \"user\" && comment.users.toString() !== users._id.toString()) {\n    throw new _ApiError.default(\"Forbidden: You are not authorized to delete this product\", 403, \"unauthorized ProductDelete\");\n  }\n};\n// Satıcının ürününe gelen yorumu kontrol eder\nconst checkCommentForProductOwner = (user, comment, product) => {\n  if (user.role === \"seller\" && product.seller.toString() !== user._id.toString()) {\n    throw new _ApiError.default(\"Forbidden: You are not authorized to reply to this comment\", 403, \"unauthorizedCommentReply\");\n  }\n};\nmodule.exports = {\n  checkPermissions,\n  checkProductOwnerShip,\n  checkCommentOwnerShip,\n  checkCommentForProductOwner\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQXBpRXJyb3IiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImNoZWNrUGVybWlzc2lvbnMiLCJ1c2VyIiwicm9sZXMiLCJpbmNsdWRlcyIsInJvbGUiLCJBcGlFcnJvciIsImNoZWNrUHJvZHVjdE93bmVyU2hpcCIsInByb2R1Y3QiLCJzZWxsZXIiLCJ0b1N0cmluZyIsIl9pZCIsImNoZWNrQ29tbWVudE93bmVyU2hpcCIsImNvbW1lbnQiLCJ1c2VycyIsImNoZWNrQ29tbWVudEZvclByb2R1Y3RPd25lciIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9oZWxwZXJzLyIsInNvdXJjZXMiOlsiUGVybWlzc2lvbnMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuLi9lcnJvcnMvQXBpRXJyb3JcIjtcblxuY29uc3QgY2hlY2tQZXJtaXNzaW9ucyA9ICh1c2VyLCByb2xlcykgPT4ge1xuICBpZiAoIXJvbGVzLmluY2x1ZGVzKHVzZXIucm9sZSkpIHtcbiAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICBcIkZvcmJpZGRlbjogSW5zdWZmaWNpZW50IHBlcm1pc3Npb25zXCIsXG4gICAgICA0MDMsXG4gICAgICBcImluc3VmZmljaWVudFBlcm1pc3Npb25zXCJcbiAgICApO1xuICB9XG59O1xuXG5jb25zdCBjaGVja1Byb2R1Y3RPd25lclNoaXAgPSAodXNlciwgcHJvZHVjdCkgPT4ge1xuICBpZiAoXG4gICAgdXNlci5yb2xlID09PSBcInNlbGxlclwiICYmXG4gICAgcHJvZHVjdC5zZWxsZXIudG9TdHJpbmcoKSAhPT0gdXNlci5faWQudG9TdHJpbmcoKVxuICApIHtcbiAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICBcIkZvcmJpZGRlbjogWW91IGFyZSBub3QgYXV0aG9yaXplZCB0byBkZWxldGUgdGhpcyBwcm9kdWN0XCIsXG4gICAgICA0MDMsXG4gICAgICBcInVuYXV0aG9yaXplZCBQcm9kdWN0RGVsZXRlXCJcbiAgICApO1xuICB9XG59O1xuY29uc3QgY2hlY2tDb21tZW50T3duZXJTaGlwID0gKHVzZXIsIGNvbW1lbnQpID0+IHtcbiAgaWYgKFxuICAgIHVzZXIucm9sZSA9PT0gXCJ1c2VyXCIgJiZcbiAgICBjb21tZW50LnVzZXJzLnRvU3RyaW5nKCkgIT09IHVzZXJzLl9pZC50b1N0cmluZygpXG4gICkge1xuICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgIFwiRm9yYmlkZGVuOiBZb3UgYXJlIG5vdCBhdXRob3JpemVkIHRvIGRlbGV0ZSB0aGlzIHByb2R1Y3RcIixcbiAgICAgIDQwMyxcbiAgICAgIFwidW5hdXRob3JpemVkIFByb2R1Y3REZWxldGVcIlxuICAgICk7XG4gIH1cbn07XG4vLyBTYXTEsWPEsW7EsW4gw7xyw7xuw7xuZSBnZWxlbiB5b3J1bXUga29udHJvbCBlZGVyXG5jb25zdCBjaGVja0NvbW1lbnRGb3JQcm9kdWN0T3duZXIgPSAodXNlciwgY29tbWVudCwgcHJvZHVjdCkgPT4ge1xuICBpZiAoXG4gICAgdXNlci5yb2xlID09PSBcInNlbGxlclwiICYmXG4gICAgcHJvZHVjdC5zZWxsZXIudG9TdHJpbmcoKSAhPT0gdXNlci5faWQudG9TdHJpbmcoKVxuICApIHtcbiAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICBcIkZvcmJpZGRlbjogWW91IGFyZSBub3QgYXV0aG9yaXplZCB0byByZXBseSB0byB0aGlzIGNvbW1lbnRcIixcbiAgICAgIDQwMyxcbiAgICAgIFwidW5hdXRob3JpemVkQ29tbWVudFJlcGx5XCJcbiAgICApO1xuICB9XG59O1xubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGNoZWNrUGVybWlzc2lvbnMsXG4gIGNoZWNrUHJvZHVjdE93bmVyU2hpcCxcbiAgY2hlY2tDb21tZW50T3duZXJTaGlwLFxuICBjaGVja0NvbW1lbnRGb3JQcm9kdWN0T3duZXIsXG59O1xuIl0sIm1hcHBpbmdzIjoiOztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUEwQyxTQUFBRCx1QkFBQUUsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUUxQyxNQUFNRyxnQkFBZ0IsR0FBR0EsQ0FBQ0MsSUFBSSxFQUFFQyxLQUFLLEtBQUs7RUFDeEMsSUFBSSxDQUFDQSxLQUFLLENBQUNDLFFBQVEsQ0FBQ0YsSUFBSSxDQUFDRyxJQUFJLENBQUMsRUFBRTtJQUM5QixNQUFNLElBQUlDLGlCQUFRLENBQ2hCLHFDQUFxQyxFQUNyQyxHQUFHLEVBQ0gseUJBQ0YsQ0FBQztFQUNIO0FBQ0YsQ0FBQztBQUVELE1BQU1DLHFCQUFxQixHQUFHQSxDQUFDTCxJQUFJLEVBQUVNLE9BQU8sS0FBSztFQUMvQyxJQUNFTixJQUFJLENBQUNHLElBQUksS0FBSyxRQUFRLElBQ3RCRyxPQUFPLENBQUNDLE1BQU0sQ0FBQ0MsUUFBUSxDQUFDLENBQUMsS0FBS1IsSUFBSSxDQUFDUyxHQUFHLENBQUNELFFBQVEsQ0FBQyxDQUFDLEVBQ2pEO0lBQ0EsTUFBTSxJQUFJSixpQkFBUSxDQUNoQiwwREFBMEQsRUFDMUQsR0FBRyxFQUNILDRCQUNGLENBQUM7RUFDSDtBQUNGLENBQUM7QUFDRCxNQUFNTSxxQkFBcUIsR0FBR0EsQ0FBQ1YsSUFBSSxFQUFFVyxPQUFPLEtBQUs7RUFDL0MsSUFDRVgsSUFBSSxDQUFDRyxJQUFJLEtBQUssTUFBTSxJQUNwQlEsT0FBTyxDQUFDQyxLQUFLLENBQUNKLFFBQVEsQ0FBQyxDQUFDLEtBQUtJLEtBQUssQ0FBQ0gsR0FBRyxDQUFDRCxRQUFRLENBQUMsQ0FBQyxFQUNqRDtJQUNBLE1BQU0sSUFBSUosaUJBQVEsQ0FDaEIsMERBQTBELEVBQzFELEdBQUcsRUFDSCw0QkFDRixDQUFDO0VBQ0g7QUFDRixDQUFDO0FBQ0Q7QUFDQSxNQUFNUywyQkFBMkIsR0FBR0EsQ0FBQ2IsSUFBSSxFQUFFVyxPQUFPLEVBQUVMLE9BQU8sS0FBSztFQUM5RCxJQUNFTixJQUFJLENBQUNHLElBQUksS0FBSyxRQUFRLElBQ3RCRyxPQUFPLENBQUNDLE1BQU0sQ0FBQ0MsUUFBUSxDQUFDLENBQUMsS0FBS1IsSUFBSSxDQUFDUyxHQUFHLENBQUNELFFBQVEsQ0FBQyxDQUFDLEVBQ2pEO0lBQ0EsTUFBTSxJQUFJSixpQkFBUSxDQUNoQiw0REFBNEQsRUFDNUQsR0FBRyxFQUNILDBCQUNGLENBQUM7RUFDSDtBQUNGLENBQUM7QUFDRFUsTUFBTSxDQUFDQyxPQUFPLEdBQUc7RUFDZmhCLGdCQUFnQjtFQUNoQk0scUJBQXFCO0VBQ3JCSyxxQkFBcUI7RUFDckJHO0FBQ0YsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_ApiError","_interopRequireDefault","require","e","__esModule","default","checkPermissions","user","roles","includes","role","ApiError","checkProductOwnerShip","product","seller","toString","_id","checkCommentOwnerShip","comment","users","checkCommentForProductOwner","module","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/helpers/","sources":["Permissions.js"],"sourcesContent":["import ApiError from \"../errors/ApiError\";\n\nconst checkPermissions = (user, roles) => {\n  if (!roles.includes(user.role)) {\n    throw new ApiError(\n      \"Forbidden: Insufficient permissions\",\n      403,\n      \"insufficientPermissions\"\n    );\n  }\n};\n\nconst checkProductOwnerShip = (user, product) => {\n  if (\n    user.role === \"seller\" &&\n    product.seller.toString() !== user._id.toString()\n  ) {\n    throw new ApiError(\n      \"Forbidden: You are not authorized to delete this product\",\n      403,\n      \"unauthorized ProductDelete\"\n    );\n  }\n};\nconst checkCommentOwnerShip = (user, comment) => {\n  if (\n    user.role === \"user\" &&\n    comment.users.toString() !== users._id.toString()\n  ) {\n    throw new ApiError(\n      \"Forbidden: You are not authorized to delete this product\",\n      403,\n      \"unauthorized ProductDelete\"\n    );\n  }\n};\n// Satıcının ürününe gelen yorumu kontrol eder\nconst checkCommentForProductOwner = (user, comment, product) => {\n  if (\n    user.role === \"seller\" &&\n    product.seller.toString() !== user._id.toString()\n  ) {\n    throw new ApiError(\n      \"Forbidden: You are not authorized to reply to this comment\",\n      403,\n      \"unauthorizedCommentReply\"\n    );\n  }\n};\nmodule.exports = {\n  checkPermissions,\n  checkProductOwnerShip,\n  checkCommentOwnerShip,\n  checkCommentForProductOwner,\n};\n"],"mappings":";;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA0C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE1C,MAAMG,gBAAgB,GAAGA,CAACC,IAAI,EAAEC,KAAK,KAAK;EACxC,IAAI,CAACA,KAAK,CAACC,QAAQ,CAACF,IAAI,CAACG,IAAI,CAAC,EAAE;IAC9B,MAAM,IAAIC,iBAAQ,CAChB,qCAAqC,EACrC,GAAG,EACH,yBACF,CAAC;EACH;AACF,CAAC;AAED,MAAMC,qBAAqB,GAAGA,CAACL,IAAI,EAAEM,OAAO,KAAK;EAC/C,IACEN,IAAI,CAACG,IAAI,KAAK,QAAQ,IACtBG,OAAO,CAACC,MAAM,CAACC,QAAQ,CAAC,CAAC,KAAKR,IAAI,CAACS,GAAG,CAACD,QAAQ,CAAC,CAAC,EACjD;IACA,MAAM,IAAIJ,iBAAQ,CAChB,0DAA0D,EAC1D,GAAG,EACH,4BACF,CAAC;EACH;AACF,CAAC;AACD,MAAMM,qBAAqB,GAAGA,CAACV,IAAI,EAAEW,OAAO,KAAK;EAC/C,IACEX,IAAI,CAACG,IAAI,KAAK,MAAM,IACpBQ,OAAO,CAACC,KAAK,CAACJ,QAAQ,CAAC,CAAC,KAAKI,KAAK,CAACH,GAAG,CAACD,QAAQ,CAAC,CAAC,EACjD;IACA,MAAM,IAAIJ,iBAAQ,CAChB,0DAA0D,EAC1D,GAAG,EACH,4BACF,CAAC;EACH;AACF,CAAC;AACD;AACA,MAAMS,2BAA2B,GAAGA,CAACb,IAAI,EAAEW,OAAO,EAAEL,OAAO,KAAK;EAC9D,IACEN,IAAI,CAACG,IAAI,KAAK,QAAQ,IACtBG,OAAO,CAACC,MAAM,CAACC,QAAQ,CAAC,CAAC,KAAKR,IAAI,CAACS,GAAG,CAACD,QAAQ,CAAC,CAAC,EACjD;IACA,MAAM,IAAIJ,iBAAQ,CAChB,4DAA4D,EAC5D,GAAG,EACH,0BACF,CAAC;EACH;AACF,CAAC;AACDU,MAAM,CAACC,OAAO,GAAG;EACfhB,gBAAgB;EAChBM,qBAAqB;EACrBK,qBAAqB;EACrBG;AACF,CAAC","ignoreList":[]}},"mtime":1734614242787},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/helpers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/helpers/Permissions.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst checkPermissions = (user, roles) => {\n  if (!roles.includes(user.role)) {\n    throw new _ApiError.default(\"Forbidden: Insufficient permissions\", 403, \"insufficientPermissions\");\n  }\n};\nconst checkProductOwnerShip = (user, product) => {\n  if (user.role === \"seller\" && product.seller.toString() !== user._id.toString()) {\n    throw new _ApiError.default(\"Forbidden: You are not authorized to delete this product\", 403, \"unauthorized ProductDelete\");\n  }\n};\nconst checkCommentOwnerShip = (user, comment) => {\n  if (user.role === \"user\" && comment.users.toString() !== users._id.toString()) {\n    throw new _ApiError.default(\"Forbidden: You are not authorized to delete this product\", 403, \"unauthorized ProductDelete\");\n  }\n};\n// Satıcının ürününe gelen yorumu kontrol eder\nconst checkCommentForProductOwner = (user, comment, product) => {\n  if (user.role === \"seller\" && product.seller.toString() !== user._id.toString()) {\n    throw new _ApiError.default(\"Forbidden: You are not authorized to reply to this comment\", 403, \"unauthorizedCommentReply\");\n  }\n};\nmodule.exports = {\n  checkPermissions,\n  checkProductOwnerShip,\n  checkCommentOwnerShip,\n  checkCommentForProductOwner\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQXBpRXJyb3IiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImNoZWNrUGVybWlzc2lvbnMiLCJ1c2VyIiwicm9sZXMiLCJpbmNsdWRlcyIsInJvbGUiLCJBcGlFcnJvciIsImNoZWNrUHJvZHVjdE93bmVyU2hpcCIsInByb2R1Y3QiLCJzZWxsZXIiLCJ0b1N0cmluZyIsIl9pZCIsImNoZWNrQ29tbWVudE93bmVyU2hpcCIsImNvbW1lbnQiLCJ1c2VycyIsImNoZWNrQ29tbWVudEZvclByb2R1Y3RPd25lciIsIm1vZHVsZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9oZWxwZXJzLyIsInNvdXJjZXMiOlsiUGVybWlzc2lvbnMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuLi9lcnJvcnMvQXBpRXJyb3JcIjtcblxuY29uc3QgY2hlY2tQZXJtaXNzaW9ucyA9ICh1c2VyLCByb2xlcykgPT4ge1xuICBpZiAoIXJvbGVzLmluY2x1ZGVzKHVzZXIucm9sZSkpIHtcbiAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICBcIkZvcmJpZGRlbjogSW5zdWZmaWNpZW50IHBlcm1pc3Npb25zXCIsXG4gICAgICA0MDMsXG4gICAgICBcImluc3VmZmljaWVudFBlcm1pc3Npb25zXCJcbiAgICApO1xuICB9XG59O1xuXG5jb25zdCBjaGVja1Byb2R1Y3RPd25lclNoaXAgPSAodXNlciwgcHJvZHVjdCkgPT4ge1xuICBpZiAoXG4gICAgdXNlci5yb2xlID09PSBcInNlbGxlclwiICYmXG4gICAgcHJvZHVjdC5zZWxsZXIudG9TdHJpbmcoKSAhPT0gdXNlci5faWQudG9TdHJpbmcoKVxuICApIHtcbiAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICBcIkZvcmJpZGRlbjogWW91IGFyZSBub3QgYXV0aG9yaXplZCB0byBkZWxldGUgdGhpcyBwcm9kdWN0XCIsXG4gICAgICA0MDMsXG4gICAgICBcInVuYXV0aG9yaXplZCBQcm9kdWN0RGVsZXRlXCJcbiAgICApO1xuICB9XG59O1xuY29uc3QgY2hlY2tDb21tZW50T3duZXJTaGlwID0gKHVzZXIsIGNvbW1lbnQpID0+IHtcbiAgaWYgKFxuICAgIHVzZXIucm9sZSA9PT0gXCJ1c2VyXCIgJiZcbiAgICBjb21tZW50LnVzZXJzLnRvU3RyaW5nKCkgIT09IHVzZXJzLl9pZC50b1N0cmluZygpXG4gICkge1xuICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgIFwiRm9yYmlkZGVuOiBZb3UgYXJlIG5vdCBhdXRob3JpemVkIHRvIGRlbGV0ZSB0aGlzIHByb2R1Y3RcIixcbiAgICAgIDQwMyxcbiAgICAgIFwidW5hdXRob3JpemVkIFByb2R1Y3REZWxldGVcIlxuICAgICk7XG4gIH1cbn07XG4vLyBTYXTEsWPEsW7EsW4gw7xyw7xuw7xuZSBnZWxlbiB5b3J1bXUga29udHJvbCBlZGVyXG5jb25zdCBjaGVja0NvbW1lbnRGb3JQcm9kdWN0T3duZXIgPSAodXNlciwgY29tbWVudCwgcHJvZHVjdCkgPT4ge1xuICBpZiAoXG4gICAgdXNlci5yb2xlID09PSBcInNlbGxlclwiICYmXG4gICAgcHJvZHVjdC5zZWxsZXIudG9TdHJpbmcoKSAhPT0gdXNlci5faWQudG9TdHJpbmcoKVxuICApIHtcbiAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICBcIkZvcmJpZGRlbjogWW91IGFyZSBub3QgYXV0aG9yaXplZCB0byByZXBseSB0byB0aGlzIGNvbW1lbnRcIixcbiAgICAgIDQwMyxcbiAgICAgIFwidW5hdXRob3JpemVkQ29tbWVudFJlcGx5XCJcbiAgICApO1xuICB9XG59O1xubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGNoZWNrUGVybWlzc2lvbnMsXG4gIGNoZWNrUHJvZHVjdE93bmVyU2hpcCxcbiAgY2hlY2tDb21tZW50T3duZXJTaGlwLFxuICBjaGVja0NvbW1lbnRGb3JQcm9kdWN0T3duZXIsXG59O1xuIl0sIm1hcHBpbmdzIjoiOztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUEwQyxTQUFBRCx1QkFBQUUsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUUxQyxNQUFNRyxnQkFBZ0IsR0FBR0EsQ0FBQ0MsSUFBSSxFQUFFQyxLQUFLLEtBQUs7RUFDeEMsSUFBSSxDQUFDQSxLQUFLLENBQUNDLFFBQVEsQ0FBQ0YsSUFBSSxDQUFDRyxJQUFJLENBQUMsRUFBRTtJQUM5QixNQUFNLElBQUlDLGlCQUFRLENBQ2hCLHFDQUFxQyxFQUNyQyxHQUFHLEVBQ0gseUJBQ0YsQ0FBQztFQUNIO0FBQ0YsQ0FBQztBQUVELE1BQU1DLHFCQUFxQixHQUFHQSxDQUFDTCxJQUFJLEVBQUVNLE9BQU8sS0FBSztFQUMvQyxJQUNFTixJQUFJLENBQUNHLElBQUksS0FBSyxRQUFRLElBQ3RCRyxPQUFPLENBQUNDLE1BQU0sQ0FBQ0MsUUFBUSxDQUFDLENBQUMsS0FBS1IsSUFBSSxDQUFDUyxHQUFHLENBQUNELFFBQVEsQ0FBQyxDQUFDLEVBQ2pEO0lBQ0EsTUFBTSxJQUFJSixpQkFBUSxDQUNoQiwwREFBMEQsRUFDMUQsR0FBRyxFQUNILDRCQUNGLENBQUM7RUFDSDtBQUNGLENBQUM7QUFDRCxNQUFNTSxxQkFBcUIsR0FBR0EsQ0FBQ1YsSUFBSSxFQUFFVyxPQUFPLEtBQUs7RUFDL0MsSUFDRVgsSUFBSSxDQUFDRyxJQUFJLEtBQUssTUFBTSxJQUNwQlEsT0FBTyxDQUFDQyxLQUFLLENBQUNKLFFBQVEsQ0FBQyxDQUFDLEtBQUtJLEtBQUssQ0FBQ0gsR0FBRyxDQUFDRCxRQUFRLENBQUMsQ0FBQyxFQUNqRDtJQUNBLE1BQU0sSUFBSUosaUJBQVEsQ0FDaEIsMERBQTBELEVBQzFELEdBQUcsRUFDSCw0QkFDRixDQUFDO0VBQ0g7QUFDRixDQUFDO0FBQ0Q7QUFDQSxNQUFNUywyQkFBMkIsR0FBR0EsQ0FBQ2IsSUFBSSxFQUFFVyxPQUFPLEVBQUVMLE9BQU8sS0FBSztFQUM5RCxJQUNFTixJQUFJLENBQUNHLElBQUksS0FBSyxRQUFRLElBQ3RCRyxPQUFPLENBQUNDLE1BQU0sQ0FBQ0MsUUFBUSxDQUFDLENBQUMsS0FBS1IsSUFBSSxDQUFDUyxHQUFHLENBQUNELFFBQVEsQ0FBQyxDQUFDLEVBQ2pEO0lBQ0EsTUFBTSxJQUFJSixpQkFBUSxDQUNoQiw0REFBNEQsRUFDNUQsR0FBRyxFQUNILDBCQUNGLENBQUM7RUFDSDtBQUNGLENBQUM7QUFDRFUsTUFBTSxDQUFDQyxPQUFPLEdBQUc7RUFDZmhCLGdCQUFnQjtFQUNoQk0scUJBQXFCO0VBQ3JCSyxxQkFBcUI7RUFDckJHO0FBQ0YsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_ApiError","_interopRequireDefault","require","e","__esModule","default","checkPermissions","user","roles","includes","role","ApiError","checkProductOwnerShip","product","seller","toString","_id","checkCommentOwnerShip","comment","users","checkCommentForProductOwner","module","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/helpers/","sources":["Permissions.js"],"sourcesContent":["import ApiError from \"../errors/ApiError\";\n\nconst checkPermissions = (user, roles) => {\n  if (!roles.includes(user.role)) {\n    throw new ApiError(\n      \"Forbidden: Insufficient permissions\",\n      403,\n      \"insufficientPermissions\"\n    );\n  }\n};\n\nconst checkProductOwnerShip = (user, product) => {\n  if (\n    user.role === \"seller\" &&\n    product.seller.toString() !== user._id.toString()\n  ) {\n    throw new ApiError(\n      \"Forbidden: You are not authorized to delete this product\",\n      403,\n      \"unauthorized ProductDelete\"\n    );\n  }\n};\nconst checkCommentOwnerShip = (user, comment) => {\n  if (\n    user.role === \"user\" &&\n    comment.users.toString() !== users._id.toString()\n  ) {\n    throw new ApiError(\n      \"Forbidden: You are not authorized to delete this product\",\n      403,\n      \"unauthorized ProductDelete\"\n    );\n  }\n};\n// Satıcının ürününe gelen yorumu kontrol eder\nconst checkCommentForProductOwner = (user, comment, product) => {\n  if (\n    user.role === \"seller\" &&\n    product.seller.toString() !== user._id.toString()\n  ) {\n    throw new ApiError(\n      \"Forbidden: You are not authorized to reply to this comment\",\n      403,\n      \"unauthorizedCommentReply\"\n    );\n  }\n};\nmodule.exports = {\n  checkPermissions,\n  checkProductOwnerShip,\n  checkCommentOwnerShip,\n  checkCommentForProductOwner,\n};\n"],"mappings":";;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA0C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE1C,MAAMG,gBAAgB,GAAGA,CAACC,IAAI,EAAEC,KAAK,KAAK;EACxC,IAAI,CAACA,KAAK,CAACC,QAAQ,CAACF,IAAI,CAACG,IAAI,CAAC,EAAE;IAC9B,MAAM,IAAIC,iBAAQ,CAChB,qCAAqC,EACrC,GAAG,EACH,yBACF,CAAC;EACH;AACF,CAAC;AAED,MAAMC,qBAAqB,GAAGA,CAACL,IAAI,EAAEM,OAAO,KAAK;EAC/C,IACEN,IAAI,CAACG,IAAI,KAAK,QAAQ,IACtBG,OAAO,CAACC,MAAM,CAACC,QAAQ,CAAC,CAAC,KAAKR,IAAI,CAACS,GAAG,CAACD,QAAQ,CAAC,CAAC,EACjD;IACA,MAAM,IAAIJ,iBAAQ,CAChB,0DAA0D,EAC1D,GAAG,EACH,4BACF,CAAC;EACH;AACF,CAAC;AACD,MAAMM,qBAAqB,GAAGA,CAACV,IAAI,EAAEW,OAAO,KAAK;EAC/C,IACEX,IAAI,CAACG,IAAI,KAAK,MAAM,IACpBQ,OAAO,CAACC,KAAK,CAACJ,QAAQ,CAAC,CAAC,KAAKI,KAAK,CAACH,GAAG,CAACD,QAAQ,CAAC,CAAC,EACjD;IACA,MAAM,IAAIJ,iBAAQ,CAChB,0DAA0D,EAC1D,GAAG,EACH,4BACF,CAAC;EACH;AACF,CAAC;AACD;AACA,MAAMS,2BAA2B,GAAGA,CAACb,IAAI,EAAEW,OAAO,EAAEL,OAAO,KAAK;EAC9D,IACEN,IAAI,CAACG,IAAI,KAAK,QAAQ,IACtBG,OAAO,CAACC,MAAM,CAACC,QAAQ,CAAC,CAAC,KAAKR,IAAI,CAACS,GAAG,CAACD,QAAQ,CAAC,CAAC,EACjD;IACA,MAAM,IAAIJ,iBAAQ,CAChB,4DAA4D,EAC5D,GAAG,EACH,0BACF,CAAC;EACH;AACF,CAAC;AACDU,MAAM,CAACC,OAAO,GAAG;EACfhB,gBAAgB;EAChBM,qBAAqB;EACrBK,qBAAqB;EACrBG;AACF,CAAC","ignoreList":[]}},"mtime":1734614242787},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/helpers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/helpers/RequiredCheck.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst checkLotsOfRequiredField = fields => {\n  fields.forEach(({\n    field,\n    fieldName\n  }) => {\n    if (!field) {\n      throw new _ApiError.default(`${fieldName} Required`, 400, `${fieldName} Required`);\n    }\n  });\n};\nconst checkRequiredField = (field, fieldName) => {\n  if (!field) {\n    throw new _ApiError.default(`${fieldName} Required`, 400, `${fieldName} Required`);\n  }\n};\nmodule.exports = {\n  checkLotsOfRequiredField,\n  checkRequiredField\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQXBpRXJyb3IiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImNoZWNrTG90c09mUmVxdWlyZWRGaWVsZCIsImZpZWxkcyIsImZvckVhY2giLCJmaWVsZCIsImZpZWxkTmFtZSIsIkFwaUVycm9yIiwiY2hlY2tSZXF1aXJlZEZpZWxkIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL2hlbHBlcnMvIiwic291cmNlcyI6WyJSZXF1aXJlZENoZWNrLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBBcGlFcnJvciBmcm9tIFwiLi4vZXJyb3JzL0FwaUVycm9yXCI7XG5cbmNvbnN0IGNoZWNrTG90c09mUmVxdWlyZWRGaWVsZCA9IChmaWVsZHMpID0+IHtcbiAgZmllbGRzLmZvckVhY2goKHsgZmllbGQsIGZpZWxkTmFtZSB9KSA9PiB7XG4gICAgaWYgKCFmaWVsZCkge1xuICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKGAke2ZpZWxkTmFtZX0gUmVxdWlyZWRgLCA0MDAsIGAke2ZpZWxkTmFtZX0gUmVxdWlyZWRgKTtcbiAgICB9XG4gIH0pO1xufTtcblxuY29uc3QgY2hlY2tSZXF1aXJlZEZpZWxkID0gKGZpZWxkLCBmaWVsZE5hbWUpID0+IHtcbiAgaWYgKCFmaWVsZCkge1xuICAgIHRocm93IG5ldyBBcGlFcnJvcihgJHtmaWVsZE5hbWV9IFJlcXVpcmVkYCwgNDAwLCBgJHtmaWVsZE5hbWV9IFJlcXVpcmVkYCk7XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0geyBjaGVja0xvdHNPZlJlcXVpcmVkRmllbGQsIGNoZWNrUmVxdWlyZWRGaWVsZCB9O1xuIl0sIm1hcHBpbmdzIjoiOztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUEwQyxTQUFBRCx1QkFBQUUsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUUxQyxNQUFNRyx3QkFBd0IsR0FBSUMsTUFBTSxJQUFLO0VBQzNDQSxNQUFNLENBQUNDLE9BQU8sQ0FBQyxDQUFDO0lBQUVDLEtBQUs7SUFBRUM7RUFBVSxDQUFDLEtBQUs7SUFDdkMsSUFBSSxDQUFDRCxLQUFLLEVBQUU7TUFDVixNQUFNLElBQUlFLGlCQUFRLENBQUMsR0FBR0QsU0FBUyxXQUFXLEVBQUUsR0FBRyxFQUFFLEdBQUdBLFNBQVMsV0FBVyxDQUFDO0lBQzNFO0VBQ0YsQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUVELE1BQU1FLGtCQUFrQixHQUFHQSxDQUFDSCxLQUFLLEVBQUVDLFNBQVMsS0FBSztFQUMvQyxJQUFJLENBQUNELEtBQUssRUFBRTtJQUNWLE1BQU0sSUFBSUUsaUJBQVEsQ0FBQyxHQUFHRCxTQUFTLFdBQVcsRUFBRSxHQUFHLEVBQUUsR0FBR0EsU0FBUyxXQUFXLENBQUM7RUFDM0U7QUFDRixDQUFDO0FBRURHLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHO0VBQUVSLHdCQUF3QjtFQUFFTTtBQUFtQixDQUFDIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["_ApiError","_interopRequireDefault","require","e","__esModule","default","checkLotsOfRequiredField","fields","forEach","field","fieldName","ApiError","checkRequiredField","module","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/helpers/","sources":["RequiredCheck.js"],"sourcesContent":["import ApiError from \"../errors/ApiError\";\n\nconst checkLotsOfRequiredField = (fields) => {\n  fields.forEach(({ field, fieldName }) => {\n    if (!field) {\n      throw new ApiError(`${fieldName} Required`, 400, `${fieldName} Required`);\n    }\n  });\n};\n\nconst checkRequiredField = (field, fieldName) => {\n  if (!field) {\n    throw new ApiError(`${fieldName} Required`, 400, `${fieldName} Required`);\n  }\n};\n\nmodule.exports = { checkLotsOfRequiredField, checkRequiredField };\n"],"mappings":";;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA0C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE1C,MAAMG,wBAAwB,GAAIC,MAAM,IAAK;EAC3CA,MAAM,CAACC,OAAO,CAAC,CAAC;IAAEC,KAAK;IAAEC;EAAU,CAAC,KAAK;IACvC,IAAI,CAACD,KAAK,EAAE;MACV,MAAM,IAAIE,iBAAQ,CAAC,GAAGD,SAAS,WAAW,EAAE,GAAG,EAAE,GAAGA,SAAS,WAAW,CAAC;IAC3E;EACF,CAAC,CAAC;AACJ,CAAC;AAED,MAAME,kBAAkB,GAAGA,CAACH,KAAK,EAAEC,SAAS,KAAK;EAC/C,IAAI,CAACD,KAAK,EAAE;IACV,MAAM,IAAIE,iBAAQ,CAAC,GAAGD,SAAS,WAAW,EAAE,GAAG,EAAE,GAAGA,SAAS,WAAW,CAAC;EAC3E;AACF,CAAC;AAEDG,MAAM,CAACC,OAAO,GAAG;EAAER,wBAAwB;EAAEM;AAAmB,CAAC","ignoreList":[]}},"mtime":1728753332141},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/helpers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/helpers/RequiredCheck.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst checkLotsOfRequiredField = fields => {\n  fields.forEach(({\n    field,\n    fieldName\n  }) => {\n    if (!field) {\n      throw new _ApiError.default(`${fieldName} Required`, 400, `${fieldName} Required`);\n    }\n  });\n};\nconst checkRequiredField = (field, fieldName) => {\n  if (!field) {\n    throw new _ApiError.default(`${fieldName} Required`, 400, `${fieldName} Required`);\n  }\n};\nmodule.exports = {\n  checkLotsOfRequiredField,\n  checkRequiredField\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQXBpRXJyb3IiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImNoZWNrTG90c09mUmVxdWlyZWRGaWVsZCIsImZpZWxkcyIsImZvckVhY2giLCJmaWVsZCIsImZpZWxkTmFtZSIsIkFwaUVycm9yIiwiY2hlY2tSZXF1aXJlZEZpZWxkIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL2hlbHBlcnMvIiwic291cmNlcyI6WyJSZXF1aXJlZENoZWNrLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBBcGlFcnJvciBmcm9tIFwiLi4vZXJyb3JzL0FwaUVycm9yXCI7XG5cbmNvbnN0IGNoZWNrTG90c09mUmVxdWlyZWRGaWVsZCA9IChmaWVsZHMpID0+IHtcbiAgZmllbGRzLmZvckVhY2goKHsgZmllbGQsIGZpZWxkTmFtZSB9KSA9PiB7XG4gICAgaWYgKCFmaWVsZCkge1xuICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKGAke2ZpZWxkTmFtZX0gUmVxdWlyZWRgLCA0MDAsIGAke2ZpZWxkTmFtZX0gUmVxdWlyZWRgKTtcbiAgICB9XG4gIH0pO1xufTtcblxuY29uc3QgY2hlY2tSZXF1aXJlZEZpZWxkID0gKGZpZWxkLCBmaWVsZE5hbWUpID0+IHtcbiAgaWYgKCFmaWVsZCkge1xuICAgIHRocm93IG5ldyBBcGlFcnJvcihgJHtmaWVsZE5hbWV9IFJlcXVpcmVkYCwgNDAwLCBgJHtmaWVsZE5hbWV9IFJlcXVpcmVkYCk7XG4gIH1cbn07XG5cbm1vZHVsZS5leHBvcnRzID0geyBjaGVja0xvdHNPZlJlcXVpcmVkRmllbGQsIGNoZWNrUmVxdWlyZWRGaWVsZCB9O1xuIl0sIm1hcHBpbmdzIjoiOztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUEwQyxTQUFBRCx1QkFBQUUsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUUxQyxNQUFNRyx3QkFBd0IsR0FBSUMsTUFBTSxJQUFLO0VBQzNDQSxNQUFNLENBQUNDLE9BQU8sQ0FBQyxDQUFDO0lBQUVDLEtBQUs7SUFBRUM7RUFBVSxDQUFDLEtBQUs7SUFDdkMsSUFBSSxDQUFDRCxLQUFLLEVBQUU7TUFDVixNQUFNLElBQUlFLGlCQUFRLENBQUMsR0FBR0QsU0FBUyxXQUFXLEVBQUUsR0FBRyxFQUFFLEdBQUdBLFNBQVMsV0FBVyxDQUFDO0lBQzNFO0VBQ0YsQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUVELE1BQU1FLGtCQUFrQixHQUFHQSxDQUFDSCxLQUFLLEVBQUVDLFNBQVMsS0FBSztFQUMvQyxJQUFJLENBQUNELEtBQUssRUFBRTtJQUNWLE1BQU0sSUFBSUUsaUJBQVEsQ0FBQyxHQUFHRCxTQUFTLFdBQVcsRUFBRSxHQUFHLEVBQUUsR0FBR0EsU0FBUyxXQUFXLENBQUM7RUFDM0U7QUFDRixDQUFDO0FBRURHLE1BQU0sQ0FBQ0MsT0FBTyxHQUFHO0VBQUVSLHdCQUF3QjtFQUFFTTtBQUFtQixDQUFDIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["_ApiError","_interopRequireDefault","require","e","__esModule","default","checkLotsOfRequiredField","fields","forEach","field","fieldName","ApiError","checkRequiredField","module","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/helpers/","sources":["RequiredCheck.js"],"sourcesContent":["import ApiError from \"../errors/ApiError\";\n\nconst checkLotsOfRequiredField = (fields) => {\n  fields.forEach(({ field, fieldName }) => {\n    if (!field) {\n      throw new ApiError(`${fieldName} Required`, 400, `${fieldName} Required`);\n    }\n  });\n};\n\nconst checkRequiredField = (field, fieldName) => {\n  if (!field) {\n    throw new ApiError(`${fieldName} Required`, 400, `${fieldName} Required`);\n  }\n};\n\nmodule.exports = { checkLotsOfRequiredField, checkRequiredField };\n"],"mappings":";;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA0C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE1C,MAAMG,wBAAwB,GAAIC,MAAM,IAAK;EAC3CA,MAAM,CAACC,OAAO,CAAC,CAAC;IAAEC,KAAK;IAAEC;EAAU,CAAC,KAAK;IACvC,IAAI,CAACD,KAAK,EAAE;MACV,MAAM,IAAIE,iBAAQ,CAAC,GAAGD,SAAS,WAAW,EAAE,GAAG,EAAE,GAAGA,SAAS,WAAW,CAAC;IAC3E;EACF,CAAC,CAAC;AACJ,CAAC;AAED,MAAME,kBAAkB,GAAGA,CAACH,KAAK,EAAEC,SAAS,KAAK;EAC/C,IAAI,CAACD,KAAK,EAAE;IACV,MAAM,IAAIE,iBAAQ,CAAC,GAAGD,SAAS,WAAW,EAAE,GAAG,EAAE,GAAGA,SAAS,WAAW,CAAC;EAC3E;AACF,CAAC;AAEDG,MAAM,CAACC,OAAO,GAAG;EAAER,wBAAwB;EAAEM;AAAmB,CAAC","ignoreList":[]}},"mtime":1728753332141},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/helpers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/helpers/NoExist.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst noExistVariable = (variable, variableName) => {\n  if (!variable) {\n    throw new _ApiError.default(400, `${variableName} Not Found.`);\n  }\n};\nmodule.exports = {\n  noExistVariable\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQXBpRXJyb3IiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIm5vRXhpc3RWYXJpYWJsZSIsInZhcmlhYmxlIiwidmFyaWFibGVOYW1lIiwiQXBpRXJyb3IiLCJtb2R1bGUiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvaGVscGVycy8iLCJzb3VyY2VzIjpbIk5vRXhpc3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuLi9lcnJvcnMvQXBpRXJyb3JcIjtcblxuY29uc3Qgbm9FeGlzdFZhcmlhYmxlID0gKHZhcmlhYmxlLCB2YXJpYWJsZU5hbWUpID0+IHtcbiAgaWYgKCF2YXJpYWJsZSkge1xuICAgIHRocm93IG5ldyBBcGlFcnJvcig0MDAsIGAke3ZhcmlhYmxlTmFtZX0gTm90IEZvdW5kLmApO1xuICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHsgbm9FeGlzdFZhcmlhYmxlIH07XG4iXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBQUEsU0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQTBDLFNBQUFELHVCQUFBRSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBRTFDLE1BQU1HLGVBQWUsR0FBR0EsQ0FBQ0MsUUFBUSxFQUFFQyxZQUFZLEtBQUs7RUFDbEQsSUFBSSxDQUFDRCxRQUFRLEVBQUU7SUFDYixNQUFNLElBQUlFLGlCQUFRLENBQUMsR0FBRyxFQUFFLEdBQUdELFlBQVksYUFBYSxDQUFDO0VBQ3ZEO0FBQ0YsQ0FBQztBQUVERSxNQUFNLENBQUNDLE9BQU8sR0FBRztFQUFFTDtBQUFnQixDQUFDIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["_ApiError","_interopRequireDefault","require","e","__esModule","default","noExistVariable","variable","variableName","ApiError","module","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/helpers/","sources":["NoExist.js"],"sourcesContent":["import ApiError from \"../errors/ApiError\";\n\nconst noExistVariable = (variable, variableName) => {\n  if (!variable) {\n    throw new ApiError(400, `${variableName} Not Found.`);\n  }\n};\n\nmodule.exports = { noExistVariable };\n"],"mappings":";;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA0C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE1C,MAAMG,eAAe,GAAGA,CAACC,QAAQ,EAAEC,YAAY,KAAK;EAClD,IAAI,CAACD,QAAQ,EAAE;IACb,MAAM,IAAIE,iBAAQ,CAAC,GAAG,EAAE,GAAGD,YAAY,aAAa,CAAC;EACvD;AACF,CAAC;AAEDE,MAAM,CAACC,OAAO,GAAG;EAAEL;AAAgB,CAAC","ignoreList":[]}},"mtime":1728728595148},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/helpers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/helpers/CheckExistence.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst notFoundVariable = (variable, variableName) => {\n  if (!variable) {\n    throw new _ApiError.default(`Not Found ${variableName}`, 400, `${variableName} Not Found.`);\n  }\n};\nconst noExistVariable = (variable, variableName) => {\n  if (!variable) {\n    throw new _ApiError.default(`Does not exist ${variableName}`, 400, `${variableName} does not exist.`);\n  }\n};\nmodule.exports = {\n  noExistVariable,\n  notFoundVariable\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQXBpRXJyb3IiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIm5vdEZvdW5kVmFyaWFibGUiLCJ2YXJpYWJsZSIsInZhcmlhYmxlTmFtZSIsIkFwaUVycm9yIiwibm9FeGlzdFZhcmlhYmxlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL2hlbHBlcnMvIiwic291cmNlcyI6WyJDaGVja0V4aXN0ZW5jZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQXBpRXJyb3IgZnJvbSBcIi4uL2Vycm9ycy9BcGlFcnJvclwiO1xuXG5jb25zdCBub3RGb3VuZFZhcmlhYmxlID0gKHZhcmlhYmxlLCB2YXJpYWJsZU5hbWUpID0+IHtcbiAgaWYgKCF2YXJpYWJsZSkge1xuICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgIGBOb3QgRm91bmQgJHt2YXJpYWJsZU5hbWV9YCxcbiAgICAgIDQwMCxcbiAgICAgIGAke3ZhcmlhYmxlTmFtZX0gTm90IEZvdW5kLmBcbiAgICApO1xuICB9XG59O1xuXG5jb25zdCBub0V4aXN0VmFyaWFibGUgPSAodmFyaWFibGUsIHZhcmlhYmxlTmFtZSkgPT4ge1xuICBpZiAoIXZhcmlhYmxlKSB7XG4gICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgYERvZXMgbm90IGV4aXN0ICR7dmFyaWFibGVOYW1lfWAsXG4gICAgICA0MDAsXG4gICAgICBgJHt2YXJpYWJsZU5hbWV9IGRvZXMgbm90IGV4aXN0LmBcbiAgICApO1xuICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHsgbm9FeGlzdFZhcmlhYmxlLCBub3RGb3VuZFZhcmlhYmxlIH07XG4iXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBQUEsU0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQTBDLFNBQUFELHVCQUFBRSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBRTFDLE1BQU1HLGdCQUFnQixHQUFHQSxDQUFDQyxRQUFRLEVBQUVDLFlBQVksS0FBSztFQUNuRCxJQUFJLENBQUNELFFBQVEsRUFBRTtJQUNiLE1BQU0sSUFBSUUsaUJBQVEsQ0FDaEIsYUFBYUQsWUFBWSxFQUFFLEVBQzNCLEdBQUcsRUFDSCxHQUFHQSxZQUFZLGFBQ2pCLENBQUM7RUFDSDtBQUNGLENBQUM7QUFFRCxNQUFNRSxlQUFlLEdBQUdBLENBQUNILFFBQVEsRUFBRUMsWUFBWSxLQUFLO0VBQ2xELElBQUksQ0FBQ0QsUUFBUSxFQUFFO0lBQ2IsTUFBTSxJQUFJRSxpQkFBUSxDQUNoQixrQkFBa0JELFlBQVksRUFBRSxFQUNoQyxHQUFHLEVBQ0gsR0FBR0EsWUFBWSxrQkFDakIsQ0FBQztFQUNIO0FBQ0YsQ0FBQztBQUVERyxNQUFNLENBQUNDLE9BQU8sR0FBRztFQUFFRixlQUFlO0VBQUVKO0FBQWlCLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_ApiError","_interopRequireDefault","require","e","__esModule","default","notFoundVariable","variable","variableName","ApiError","noExistVariable","module","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/helpers/","sources":["CheckExistence.js"],"sourcesContent":["import ApiError from \"../errors/ApiError\";\n\nconst notFoundVariable = (variable, variableName) => {\n  if (!variable) {\n    throw new ApiError(\n      `Not Found ${variableName}`,\n      400,\n      `${variableName} Not Found.`\n    );\n  }\n};\n\nconst noExistVariable = (variable, variableName) => {\n  if (!variable) {\n    throw new ApiError(\n      `Does not exist ${variableName}`,\n      400,\n      `${variableName} does not exist.`\n    );\n  }\n};\n\nmodule.exports = { noExistVariable, notFoundVariable };\n"],"mappings":";;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA0C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE1C,MAAMG,gBAAgB,GAAGA,CAACC,QAAQ,EAAEC,YAAY,KAAK;EACnD,IAAI,CAACD,QAAQ,EAAE;IACb,MAAM,IAAIE,iBAAQ,CAChB,aAAaD,YAAY,EAAE,EAC3B,GAAG,EACH,GAAGA,YAAY,aACjB,CAAC;EACH;AACF,CAAC;AAED,MAAME,eAAe,GAAGA,CAACH,QAAQ,EAAEC,YAAY,KAAK;EAClD,IAAI,CAACD,QAAQ,EAAE;IACb,MAAM,IAAIE,iBAAQ,CAChB,kBAAkBD,YAAY,EAAE,EAChC,GAAG,EACH,GAAGA,YAAY,kBACjB,CAAC;EACH;AACF,CAAC;AAEDG,MAAM,CAACC,OAAO,GAAG;EAAEF,eAAe;EAAEJ;AAAiB,CAAC","ignoreList":[]}},"mtime":1728729655993},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/helpers/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/helpers/CheckExistence.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst notFoundVariable = (variable, variableName) => {\n  if (!variable) {\n    throw new _ApiError.default(`Not Found ${variableName}`, 400, `${variableName} Not Found.`);\n  }\n};\nconst noExistVariable = (variable, variableName) => {\n  if (!variable) {\n    throw new _ApiError.default(`Does not exist ${variableName}`, 400, `${variableName} does not exist.`);\n  }\n};\nmodule.exports = {\n  noExistVariable,\n  notFoundVariable\n};\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQXBpRXJyb3IiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIm5vdEZvdW5kVmFyaWFibGUiLCJ2YXJpYWJsZSIsInZhcmlhYmxlTmFtZSIsIkFwaUVycm9yIiwibm9FeGlzdFZhcmlhYmxlIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL2hlbHBlcnMvIiwic291cmNlcyI6WyJDaGVja0V4aXN0ZW5jZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQXBpRXJyb3IgZnJvbSBcIi4uL2Vycm9ycy9BcGlFcnJvclwiO1xuXG5jb25zdCBub3RGb3VuZFZhcmlhYmxlID0gKHZhcmlhYmxlLCB2YXJpYWJsZU5hbWUpID0+IHtcbiAgaWYgKCF2YXJpYWJsZSkge1xuICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgIGBOb3QgRm91bmQgJHt2YXJpYWJsZU5hbWV9YCxcbiAgICAgIDQwMCxcbiAgICAgIGAke3ZhcmlhYmxlTmFtZX0gTm90IEZvdW5kLmBcbiAgICApO1xuICB9XG59O1xuXG5jb25zdCBub0V4aXN0VmFyaWFibGUgPSAodmFyaWFibGUsIHZhcmlhYmxlTmFtZSkgPT4ge1xuICBpZiAoIXZhcmlhYmxlKSB7XG4gICAgdGhyb3cgbmV3IEFwaUVycm9yKFxuICAgICAgYERvZXMgbm90IGV4aXN0ICR7dmFyaWFibGVOYW1lfWAsXG4gICAgICA0MDAsXG4gICAgICBgJHt2YXJpYWJsZU5hbWV9IGRvZXMgbm90IGV4aXN0LmBcbiAgICApO1xuICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHsgbm9FeGlzdFZhcmlhYmxlLCBub3RGb3VuZFZhcmlhYmxlIH07XG4iXSwibWFwcGluZ3MiOiI7O0FBQUEsSUFBQUEsU0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQTBDLFNBQUFELHVCQUFBRSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBRTFDLE1BQU1HLGdCQUFnQixHQUFHQSxDQUFDQyxRQUFRLEVBQUVDLFlBQVksS0FBSztFQUNuRCxJQUFJLENBQUNELFFBQVEsRUFBRTtJQUNiLE1BQU0sSUFBSUUsaUJBQVEsQ0FDaEIsYUFBYUQsWUFBWSxFQUFFLEVBQzNCLEdBQUcsRUFDSCxHQUFHQSxZQUFZLGFBQ2pCLENBQUM7RUFDSDtBQUNGLENBQUM7QUFFRCxNQUFNRSxlQUFlLEdBQUdBLENBQUNILFFBQVEsRUFBRUMsWUFBWSxLQUFLO0VBQ2xELElBQUksQ0FBQ0QsUUFBUSxFQUFFO0lBQ2IsTUFBTSxJQUFJRSxpQkFBUSxDQUNoQixrQkFBa0JELFlBQVksRUFBRSxFQUNoQyxHQUFHLEVBQ0gsR0FBR0EsWUFBWSxrQkFDakIsQ0FBQztFQUNIO0FBQ0YsQ0FBQztBQUVERyxNQUFNLENBQUNDLE9BQU8sR0FBRztFQUFFRixlQUFlO0VBQUVKO0FBQWlCLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_ApiError","_interopRequireDefault","require","e","__esModule","default","notFoundVariable","variable","variableName","ApiError","noExistVariable","module","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/helpers/","sources":["CheckExistence.js"],"sourcesContent":["import ApiError from \"../errors/ApiError\";\n\nconst notFoundVariable = (variable, variableName) => {\n  if (!variable) {\n    throw new ApiError(\n      `Not Found ${variableName}`,\n      400,\n      `${variableName} Not Found.`\n    );\n  }\n};\n\nconst noExistVariable = (variable, variableName) => {\n  if (!variable) {\n    throw new ApiError(\n      `Does not exist ${variableName}`,\n      400,\n      `${variableName} does not exist.`\n    );\n  }\n};\n\nmodule.exports = { noExistVariable, notFoundVariable };\n"],"mappings":";;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA0C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE1C,MAAMG,gBAAgB,GAAGA,CAACC,QAAQ,EAAEC,YAAY,KAAK;EACnD,IAAI,CAACD,QAAQ,EAAE;IACb,MAAM,IAAIE,iBAAQ,CAChB,aAAaD,YAAY,EAAE,EAC3B,GAAG,EACH,GAAGA,YAAY,aACjB,CAAC;EACH;AACF,CAAC;AAED,MAAME,eAAe,GAAGA,CAACH,QAAQ,EAAEC,YAAY,KAAK;EAClD,IAAI,CAACD,QAAQ,EAAE;IACb,MAAM,IAAIE,iBAAQ,CAChB,kBAAkBD,YAAY,EAAE,EAChC,GAAG,EACH,GAAGA,YAAY,kBACjB,CAAC;EACH;AACF,CAAC;AAEDG,MAAM,CAACC,OAAO,GAAG;EAAEF,eAAe;EAAEJ;AAAiB,CAAC","ignoreList":[]}},"mtime":1728729655993},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/private-company.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst mongoose = require(\"mongoose\");\nconst Schema = mongoose.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst randomColorGenerator = () => {\n  return Math.floor(Math.random() * 16777215).toString(16);\n};\nconst privateCompanySellerSchema = new Schema({\n  locale: {\n    type: String,\n    default: \"tr\"\n  },\n  conversationId: {\n    type: String,\n    default: (0, _uuid.default)()\n  },\n  role: {\n    type: String,\n    required: true,\n    default: \"seller\",\n    enum: [\"user\", \"admin\", \"seller\"]\n  },\n  subMerchantExternalId: {\n    type: String,\n    required: true,\n    default: (0, _uuid.default)()\n  },\n  subMerchantType: {\n    type: String,\n    enum: [\"PRIVATE_COMPANY\", \"LIMITED_OR_JOINT_STOCK_COMPANY\"],\n    // default: \"PRIVATE_COMPANY\",\n    required: true\n  },\n  currency: {\n    type: String,\n    default: \"TRY\",\n    enum: [\"TRY\", \"USD\", \"EUR\", \"GBP\", \"RUB\", \"CHF\", \"NOK\"]\n  },\n  identityNumber: {\n    type: String,\n    minlength: 11,\n    maxlength: 11,\n    required: function () {\n      return this.subMerchantType === \"PRIVATE_COMPANY\";\n    }\n  },\n  taxNumber: {\n    type: String,\n    required: function () {\n      return this.subMerchantType === \"LIMITED_OR_JOINT_STOCK_COMPANY\";\n    }\n  },\n  name: {\n    type: String,\n    required: true\n  },\n  gsmNumber: {\n    type: String,\n    required: true\n  },\n  email: {\n    type: String,\n    required: true\n  },\n  password: {\n    type: String,\n    required: true\n  },\n  taxOffice: {\n    type: String,\n    required: true\n  },\n  legalCompanyTitle: {\n    type: String,\n    required: true\n  },\n  iban: {\n    type: String,\n    required: true\n  },\n  address: {\n    type: String,\n    required: true\n  },\n  avatarColor: {\n    type: String,\n    default: randomColorGenerator(),\n    required: true\n  },\n  logo: {\n    type: String,\n    required: false\n  },\n  products: {\n    type: ObjectId,\n    ref: \"Products\"\n  },\n  documents: {\n    type: [String],\n    required: true\n  },\n  isVerified: {\n    type: Boolean,\n    default: false\n  }\n});\nprivateCompanySellerSchema.pre(\"save\", async function (next) {\n  try {\n    // this.password = await bcrypt.hash(this.password, 10);\n    if (this.isModified(\"password\")) {\n      //password incorrect hatasını böyle çözdük\n      this.password = await _bcryptjs.default.hash(this.password, 10);\n    }\n    return next();\n  } catch (err) {\n    return next(err);\n  }\n  next();\n});\nconst PrivateCompanySeller = mongoose.model(\"PrivateCompanySeller\", privateCompanySellerSchema);\nmodule.exports = PrivateCompanySeller;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYmNyeXB0anMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl91dWlkIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwibW9uZ29vc2UiLCJTY2hlbWEiLCJPYmplY3RJZCIsIlR5cGVzIiwicmFuZG9tQ29sb3JHZW5lcmF0b3IiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJ0b1N0cmluZyIsInByaXZhdGVDb21wYW55U2VsbGVyU2NoZW1hIiwibG9jYWxlIiwidHlwZSIsIlN0cmluZyIsImNvbnZlcnNhdGlvbklkIiwiZ2VuZXJhdGVkSWQiLCJyb2xlIiwicmVxdWlyZWQiLCJlbnVtIiwic3ViTWVyY2hhbnRFeHRlcm5hbElkIiwic3ViTWVyY2hhbnRUeXBlIiwiY3VycmVuY3kiLCJpZGVudGl0eU51bWJlciIsIm1pbmxlbmd0aCIsIm1heGxlbmd0aCIsInRheE51bWJlciIsIm5hbWUiLCJnc21OdW1iZXIiLCJlbWFpbCIsInBhc3N3b3JkIiwidGF4T2ZmaWNlIiwibGVnYWxDb21wYW55VGl0bGUiLCJpYmFuIiwiYWRkcmVzcyIsImF2YXRhckNvbG9yIiwibG9nbyIsInByb2R1Y3RzIiwicmVmIiwiZG9jdW1lbnRzIiwiaXNWZXJpZmllZCIsIkJvb2xlYW4iLCJwcmUiLCJuZXh0IiwiaXNNb2RpZmllZCIsImJjcnlwdCIsImhhc2giLCJlcnIiLCJQcml2YXRlQ29tcGFueVNlbGxlciIsIm1vZGVsIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL2RiLyIsInNvdXJjZXMiOlsicHJpdmF0ZS1jb21wYW55LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZShcIm1vbmdvb3NlXCIpO1xuaW1wb3J0IGJjcnlwdCBmcm9tIFwiYmNyeXB0anNcIjtcbmltcG9ydCBnZW5lcmF0ZWRJZCBmcm9tIFwiLi4vdXRpbHMvdXVpZFwiO1xuXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWE7XG5jb25zdCB7IE9iamVjdElkIH0gPSBTY2hlbWEuVHlwZXM7XG5jb25zdCByYW5kb21Db2xvckdlbmVyYXRvciA9ICgpID0+IHtcbiAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDE2Nzc3MjE1KS50b1N0cmluZygxNik7XG59O1xuXG5jb25zdCBwcml2YXRlQ29tcGFueVNlbGxlclNjaGVtYSA9IG5ldyBTY2hlbWEoe1xuICBsb2NhbGU6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgZGVmYXVsdDogXCJ0clwiLFxuICB9LFxuICBjb252ZXJzYXRpb25JZDoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICBkZWZhdWx0OiBnZW5lcmF0ZWRJZCgpLFxuICB9LFxuICByb2xlOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIGRlZmF1bHQ6IFwic2VsbGVyXCIsXG4gICAgZW51bTogW1widXNlclwiLCBcImFkbWluXCIsIFwic2VsbGVyXCJdLFxuICB9LFxuICBzdWJNZXJjaGFudEV4dGVybmFsSWQ6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgZGVmYXVsdDogZ2VuZXJhdGVkSWQoKSxcbiAgfSxcbiAgc3ViTWVyY2hhbnRUeXBlOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGVudW06IFtcIlBSSVZBVEVfQ09NUEFOWVwiLCBcIkxJTUlURURfT1JfSk9JTlRfU1RPQ0tfQ09NUEFOWVwiXSxcbiAgICAvLyBkZWZhdWx0OiBcIlBSSVZBVEVfQ09NUEFOWVwiLFxuICAgIHJlcXVpcmVkOiB0cnVlLFxuICB9LFxuICBjdXJyZW5jeToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICBkZWZhdWx0OiBcIlRSWVwiLFxuICAgIGVudW06IFtcIlRSWVwiLCBcIlVTRFwiLCBcIkVVUlwiLCBcIkdCUFwiLCBcIlJVQlwiLCBcIkNIRlwiLCBcIk5PS1wiXSxcbiAgfSxcbiAgaWRlbnRpdHlOdW1iZXI6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgbWlubGVuZ3RoOiAxMSxcbiAgICBtYXhsZW5ndGg6IDExLFxuICAgIHJlcXVpcmVkOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5zdWJNZXJjaGFudFR5cGUgPT09IFwiUFJJVkFURV9DT01QQU5ZXCI7XG4gICAgfSxcbiAgfSxcbiAgdGF4TnVtYmVyOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHJlcXVpcmVkOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5zdWJNZXJjaGFudFR5cGUgPT09IFwiTElNSVRFRF9PUl9KT0lOVF9TVE9DS19DT01QQU5ZXCI7XG4gICAgfSxcbiAgfSxcbiAgbmFtZToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgZ3NtTnVtYmVyOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHJlcXVpcmVkOiB0cnVlLFxuICB9LFxuICBlbWFpbDoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgcGFzc3dvcmQ6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gIH0sXG4gIHRheE9mZmljZToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgbGVnYWxDb21wYW55VGl0bGU6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gIH0sXG4gIGliYW46IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gIH0sXG4gIGFkZHJlc3M6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gIH0sXG4gIGF2YXRhckNvbG9yOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGRlZmF1bHQ6IHJhbmRvbUNvbG9yR2VuZXJhdG9yKCksXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gIH0sXG4gIGxvZ286IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IGZhbHNlLFxuICB9LFxuICBwcm9kdWN0czoge1xuICAgIHR5cGU6IE9iamVjdElkLFxuICAgIHJlZjogXCJQcm9kdWN0c1wiLFxuICB9LFxuICBkb2N1bWVudHM6IHtcbiAgICB0eXBlOiBbU3RyaW5nXSxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgaXNWZXJpZmllZDoge1xuICAgIHR5cGU6IEJvb2xlYW4sXG4gICAgZGVmYXVsdDogZmFsc2UsXG4gIH0sXG59KTtcblxucHJpdmF0ZUNvbXBhbnlTZWxsZXJTY2hlbWEucHJlKFwic2F2ZVwiLCBhc3luYyBmdW5jdGlvbiAobmV4dCkge1xuICB0cnkge1xuICAgIC8vIHRoaXMucGFzc3dvcmQgPSBhd2FpdCBiY3J5cHQuaGFzaCh0aGlzLnBhc3N3b3JkLCAxMCk7XG4gICAgaWYgKHRoaXMuaXNNb2RpZmllZChcInBhc3N3b3JkXCIpKSB7XG4gICAgICAvL3Bhc3N3b3JkIGluY29ycmVjdCBoYXRhc8SxbsSxIGLDtnlsZSDDp8O2emTDvGtcbiAgICAgIHRoaXMucGFzc3dvcmQgPSBhd2FpdCBiY3J5cHQuaGFzaCh0aGlzLnBhc3N3b3JkLCAxMCk7XG4gICAgfVxuICAgIHJldHVybiBuZXh0KCk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIHJldHVybiBuZXh0KGVycik7XG4gIH1cbiAgbmV4dCgpO1xufSk7XG5cbmNvbnN0IFByaXZhdGVDb21wYW55U2VsbGVyID0gbW9uZ29vc2UubW9kZWwoXG4gIFwiUHJpdmF0ZUNvbXBhbnlTZWxsZXJcIixcbiAgcHJpdmF0ZUNvbXBhbnlTZWxsZXJTY2hlbWFcbik7XG5cbm1vZHVsZS5leHBvcnRzID0gUHJpdmF0ZUNvbXBhbnlTZWxsZXI7XG4iXSwibWFwcGluZ3MiOiI7O0FBQ0EsSUFBQUEsU0FBQSxHQUFBQyxzQkFB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","map":{"version":3,"names":["_bcryptjs","_interopRequireDefault","require","_uuid","e","__esModule","default","mongoose","Schema","ObjectId","Types","randomColorGenerator","Math","floor","random","toString","privateCompanySellerSchema","locale","type","String","conversationId","generatedId","role","required","enum","subMerchantExternalId","subMerchantType","currency","identityNumber","minlength","maxlength","taxNumber","name","gsmNumber","email","password","taxOffice","legalCompanyTitle","iban","address","avatarColor","logo","products","ref","documents","isVerified","Boolean","pre","next","isModified","bcrypt","hash","err","PrivateCompanySeller","model","module","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["private-company.js"],"sourcesContent":["const mongoose = require(\"mongoose\");\nimport bcrypt from \"bcryptjs\";\nimport generatedId from \"../utils/uuid\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\nconst randomColorGenerator = () => {\n  return Math.floor(Math.random() * 16777215).toString(16);\n};\n\nconst privateCompanySellerSchema = new Schema({\n  locale: {\n    type: String,\n    default: \"tr\",\n  },\n  conversationId: {\n    type: String,\n    default: generatedId(),\n  },\n  role: {\n    type: String,\n    required: true,\n    default: \"seller\",\n    enum: [\"user\", \"admin\", \"seller\"],\n  },\n  subMerchantExternalId: {\n    type: String,\n    required: true,\n    default: generatedId(),\n  },\n  subMerchantType: {\n    type: String,\n    enum: [\"PRIVATE_COMPANY\", \"LIMITED_OR_JOINT_STOCK_COMPANY\"],\n    // default: \"PRIVATE_COMPANY\",\n    required: true,\n  },\n  currency: {\n    type: String,\n    default: \"TRY\",\n    enum: [\"TRY\", \"USD\", \"EUR\", \"GBP\", \"RUB\", \"CHF\", \"NOK\"],\n  },\n  identityNumber: {\n    type: String,\n    minlength: 11,\n    maxlength: 11,\n    required: function () {\n      return this.subMerchantType === \"PRIVATE_COMPANY\";\n    },\n  },\n  taxNumber: {\n    type: String,\n    required: function () {\n      return this.subMerchantType === \"LIMITED_OR_JOINT_STOCK_COMPANY\";\n    },\n  },\n  name: {\n    type: String,\n    required: true,\n  },\n  gsmNumber: {\n    type: String,\n    required: true,\n  },\n  email: {\n    type: String,\n    required: true,\n  },\n  password: {\n    type: String,\n    required: true,\n  },\n  taxOffice: {\n    type: String,\n    required: true,\n  },\n  legalCompanyTitle: {\n    type: String,\n    required: true,\n  },\n  iban: {\n    type: String,\n    required: true,\n  },\n  address: {\n    type: String,\n    required: true,\n  },\n  avatarColor: {\n    type: String,\n    default: randomColorGenerator(),\n    required: true,\n  },\n  logo: {\n    type: String,\n    required: false,\n  },\n  products: {\n    type: ObjectId,\n    ref: \"Products\",\n  },\n  documents: {\n    type: [String],\n    required: true,\n  },\n  isVerified: {\n    type: Boolean,\n    default: false,\n  },\n});\n\nprivateCompanySellerSchema.pre(\"save\", async function (next) {\n  try {\n    // this.password = await bcrypt.hash(this.password, 10);\n    if (this.isModified(\"password\")) {\n      //password incorrect hatasını böyle çözdük\n      this.password = await bcrypt.hash(this.password, 10);\n    }\n    return next();\n  } catch (err) {\n    return next(err);\n  }\n  next();\n});\n\nconst PrivateCompanySeller = mongoose.model(\n  \"PrivateCompanySeller\",\n  privateCompanySellerSchema\n);\n\nmodule.exports = PrivateCompanySeller;\n"],"mappings":"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","ignoreList":[]}},"mtime":1731316713752},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/private-company.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst mongoose = require(\"mongoose\");\nconst Schema = mongoose.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst randomColorGenerator = () => {\n  return Math.floor(Math.random() * 16777215).toString(16);\n};\nconst privateCompanySellerSchema = new Schema({\n  locale: {\n    type: String,\n    default: \"tr\"\n  },\n  conversationId: {\n    type: String,\n    default: (0, _uuid.default)()\n  },\n  role: {\n    type: String,\n    required: true,\n    default: \"seller\",\n    enum: [\"user\", \"admin\", \"seller\"]\n  },\n  subMerchantExternalId: {\n    type: String,\n    required: true,\n    default: (0, _uuid.default)()\n  },\n  subMerchantType: {\n    type: String,\n    enum: [\"PRIVATE_COMPANY\", \"LIMITED_OR_JOINT_STOCK_COMPANY\"],\n    // default: \"PRIVATE_COMPANY\",\n    required: true\n  },\n  currency: {\n    type: String,\n    default: \"TRY\",\n    enum: [\"TRY\", \"USD\", \"EUR\", \"GBP\", \"RUB\", \"CHF\", \"NOK\"]\n  },\n  identityNumber: {\n    type: String,\n    minlength: 11,\n    maxlength: 11,\n    required: function () {\n      return this.subMerchantType === \"PRIVATE_COMPANY\";\n    }\n  },\n  taxNumber: {\n    type: String,\n    required: function () {\n      return this.subMerchantType === \"LIMITED_OR_JOINT_STOCK_COMPANY\";\n    }\n  },\n  name: {\n    type: String,\n    required: true\n  },\n  gsmNumber: {\n    type: String,\n    required: true\n  },\n  email: {\n    type: String,\n    required: true\n  },\n  password: {\n    type: String,\n    required: true\n  },\n  taxOffice: {\n    type: String,\n    required: true\n  },\n  legalCompanyTitle: {\n    type: String,\n    required: true\n  },\n  iban: {\n    type: String,\n    required: true\n  },\n  address: {\n    type: String,\n    required: true\n  },\n  avatarColor: {\n    type: String,\n    default: randomColorGenerator(),\n    required: true\n  },\n  logo: {\n    type: String,\n    required: false\n  },\n  products: {\n    type: ObjectId,\n    ref: \"Products\"\n  },\n  documents: {\n    type: [String],\n    required: true\n  },\n  isVerified: {\n    type: Boolean,\n    default: false\n  }\n});\nprivateCompanySellerSchema.pre(\"save\", async function (next) {\n  try {\n    // this.password = await bcrypt.hash(this.password, 10);\n    if (this.isModified(\"password\")) {\n      //password incorrect hatasını böyle çözdük\n      this.password = await _bcryptjs.default.hash(this.password, 10);\n    }\n    return next();\n  } catch (err) {\n    return next(err);\n  }\n  next();\n});\nconst PrivateCompanySeller = mongoose.model(\"PrivateCompanySeller\", privateCompanySellerSchema);\nmodule.exports = PrivateCompanySeller;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYmNyeXB0anMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl91dWlkIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwibW9uZ29vc2UiLCJTY2hlbWEiLCJPYmplY3RJZCIsIlR5cGVzIiwicmFuZG9tQ29sb3JHZW5lcmF0b3IiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJ0b1N0cmluZyIsInByaXZhdGVDb21wYW55U2VsbGVyU2NoZW1hIiwibG9jYWxlIiwidHlwZSIsIlN0cmluZyIsImNvbnZlcnNhdGlvbklkIiwiZ2VuZXJhdGVkSWQiLCJyb2xlIiwicmVxdWlyZWQiLCJlbnVtIiwic3ViTWVyY2hhbnRFeHRlcm5hbElkIiwic3ViTWVyY2hhbnRUeXBlIiwiY3VycmVuY3kiLCJpZGVudGl0eU51bWJlciIsIm1pbmxlbmd0aCIsIm1heGxlbmd0aCIsInRheE51bWJlciIsIm5hbWUiLCJnc21OdW1iZXIiLCJlbWFpbCIsInBhc3N3b3JkIiwidGF4T2ZmaWNlIiwibGVnYWxDb21wYW55VGl0bGUiLCJpYmFuIiwiYWRkcmVzcyIsImF2YXRhckNvbG9yIiwibG9nbyIsInByb2R1Y3RzIiwicmVmIiwiZG9jdW1lbnRzIiwiaXNWZXJpZmllZCIsIkJvb2xlYW4iLCJwcmUiLCJuZXh0IiwiaXNNb2RpZmllZCIsImJjcnlwdCIsImhhc2giLCJlcnIiLCJQcml2YXRlQ29tcGFueVNlbGxlciIsIm1vZGVsIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL2RiLyIsInNvdXJjZXMiOlsicHJpdmF0ZS1jb21wYW55LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZShcIm1vbmdvb3NlXCIpO1xuaW1wb3J0IGJjcnlwdCBmcm9tIFwiYmNyeXB0anNcIjtcbmltcG9ydCBnZW5lcmF0ZWRJZCBmcm9tIFwiLi4vdXRpbHMvdXVpZFwiO1xuXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWE7XG5jb25zdCB7IE9iamVjdElkIH0gPSBTY2hlbWEuVHlwZXM7XG5jb25zdCByYW5kb21Db2xvckdlbmVyYXRvciA9ICgpID0+IHtcbiAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDE2Nzc3MjE1KS50b1N0cmluZygxNik7XG59O1xuXG5jb25zdCBwcml2YXRlQ29tcGFueVNlbGxlclNjaGVtYSA9IG5ldyBTY2hlbWEoe1xuICBsb2NhbGU6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgZGVmYXVsdDogXCJ0clwiLFxuICB9LFxuICBjb252ZXJzYXRpb25JZDoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICBkZWZhdWx0OiBnZW5lcmF0ZWRJZCgpLFxuICB9LFxuICByb2xlOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIGRlZmF1bHQ6IFwic2VsbGVyXCIsXG4gICAgZW51bTogW1widXNlclwiLCBcImFkbWluXCIsIFwic2VsbGVyXCJdLFxuICB9LFxuICBzdWJNZXJjaGFudEV4dGVybmFsSWQ6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgZGVmYXVsdDogZ2VuZXJhdGVkSWQoKSxcbiAgfSxcbiAgc3ViTWVyY2hhbnRUeXBlOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGVudW06IFtcIlBSSVZBVEVfQ09NUEFOWVwiLCBcIkxJTUlURURfT1JfSk9JTlRfU1RPQ0tfQ09NUEFOWVwiXSxcbiAgICAvLyBkZWZhdWx0OiBcIlBSSVZBVEVfQ09NUEFOWVwiLFxuICAgIHJlcXVpcmVkOiB0cnVlLFxuICB9LFxuICBjdXJyZW5jeToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICBkZWZhdWx0OiBcIlRSWVwiLFxuICAgIGVudW06IFtcIlRSWVwiLCBcIlVTRFwiLCBcIkVVUlwiLCBcIkdCUFwiLCBcIlJVQlwiLCBcIkNIRlwiLCBcIk5PS1wiXSxcbiAgfSxcbiAgaWRlbnRpdHlOdW1iZXI6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgbWlubGVuZ3RoOiAxMSxcbiAgICBtYXhsZW5ndGg6IDExLFxuICAgIHJlcXVpcmVkOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5zdWJNZXJjaGFudFR5cGUgPT09IFwiUFJJVkFURV9DT01QQU5ZXCI7XG4gICAgfSxcbiAgfSxcbiAgdGF4TnVtYmVyOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHJlcXVpcmVkOiBmdW5jdGlvbiAoKSB7XG4gICAgICByZXR1cm4gdGhpcy5zdWJNZXJjaGFudFR5cGUgPT09IFwiTElNSVRFRF9PUl9KT0lOVF9TVE9DS19DT01QQU5ZXCI7XG4gICAgfSxcbiAgfSxcbiAgbmFtZToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgZ3NtTnVtYmVyOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHJlcXVpcmVkOiB0cnVlLFxuICB9LFxuICBlbWFpbDoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgcGFzc3dvcmQ6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gIH0sXG4gIHRheE9mZmljZToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgbGVnYWxDb21wYW55VGl0bGU6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gIH0sXG4gIGliYW46IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gIH0sXG4gIGFkZHJlc3M6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gIH0sXG4gIGF2YXRhckNvbG9yOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGRlZmF1bHQ6IHJhbmRvbUNvbG9yR2VuZXJhdG9yKCksXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gIH0sXG4gIGxvZ286IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IGZhbHNlLFxuICB9LFxuICBwcm9kdWN0czoge1xuICAgIHR5cGU6IE9iamVjdElkLFxuICAgIHJlZjogXCJQcm9kdWN0c1wiLFxuICB9LFxuICBkb2N1bWVudHM6IHtcbiAgICB0eXBlOiBbU3RyaW5nXSxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgaXNWZXJpZmllZDoge1xuICAgIHR5cGU6IEJvb2xlYW4sXG4gICAgZGVmYXVsdDogZmFsc2UsXG4gIH0sXG59KTtcblxucHJpdmF0ZUNvbXBhbnlTZWxsZXJTY2hlbWEucHJlKFwic2F2ZVwiLCBhc3luYyBmdW5jdGlvbiAobmV4dCkge1xuICB0cnkge1xuICAgIC8vIHRoaXMucGFzc3dvcmQgPSBhd2FpdCBiY3J5cHQuaGFzaCh0aGlzLnBhc3N3b3JkLCAxMCk7XG4gICAgaWYgKHRoaXMuaXNNb2RpZmllZChcInBhc3N3b3JkXCIpKSB7XG4gICAgICAvL3Bhc3N3b3JkIGluY29ycmVjdCBoYXRhc8SxbsSxIGLDtnlsZSDDp8O2emTDvGtcbiAgICAgIHRoaXMucGFzc3dvcmQgPSBhd2FpdCBiY3J5cHQuaGFzaCh0aGlzLnBhc3N3b3JkLCAxMCk7XG4gICAgfVxuICAgIHJldHVybiBuZXh0KCk7XG4gIH0gY2F0Y2ggKGVycikge1xuICAgIHJldHVybiBuZXh0KGVycik7XG4gIH1cbiAgbmV4dCgpO1xufSk7XG5cbmNvbnN0IFByaXZhdGVDb21wYW55U2VsbGVyID0gbW9uZ29vc2UubW9kZWwoXG4gIFwiUHJpdmF0ZUNvbXBhbnlTZWxsZXJcIixcbiAgcHJpdmF0ZUNvbXBhbnlTZWxsZXJTY2hlbWFcbik7XG5cbm1vZHVsZS5leHBvcnRzID0gUHJpdmF0ZUNvbXBhbnlTZWxsZXI7XG4iXSwibWFwcGluZ3MiOiI7O0FBQ0EsSUFBQUEsU0FBQSxHQUFBQyxzQkFB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","map":{"version":3,"names":["_bcryptjs","_interopRequireDefault","require","_uuid","e","__esModule","default","mongoose","Schema","ObjectId","Types","randomColorGenerator","Math","floor","random","toString","privateCompanySellerSchema","locale","type","String","conversationId","generatedId","role","required","enum","subMerchantExternalId","subMerchantType","currency","identityNumber","minlength","maxlength","taxNumber","name","gsmNumber","email","password","taxOffice","legalCompanyTitle","iban","address","avatarColor","logo","products","ref","documents","isVerified","Boolean","pre","next","isModified","bcrypt","hash","err","PrivateCompanySeller","model","module","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["private-company.js"],"sourcesContent":["const mongoose = require(\"mongoose\");\nimport bcrypt from \"bcryptjs\";\nimport generatedId from \"../utils/uuid\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\nconst randomColorGenerator = () => {\n  return Math.floor(Math.random() * 16777215).toString(16);\n};\n\nconst privateCompanySellerSchema = new Schema({\n  locale: {\n    type: String,\n    default: \"tr\",\n  },\n  conversationId: {\n    type: String,\n    default: generatedId(),\n  },\n  role: {\n    type: String,\n    required: true,\n    default: \"seller\",\n    enum: [\"user\", \"admin\", \"seller\"],\n  },\n  subMerchantExternalId: {\n    type: String,\n    required: true,\n    default: generatedId(),\n  },\n  subMerchantType: {\n    type: String,\n    enum: [\"PRIVATE_COMPANY\", \"LIMITED_OR_JOINT_STOCK_COMPANY\"],\n    // default: \"PRIVATE_COMPANY\",\n    required: true,\n  },\n  currency: {\n    type: String,\n    default: \"TRY\",\n    enum: [\"TRY\", \"USD\", \"EUR\", \"GBP\", \"RUB\", \"CHF\", \"NOK\"],\n  },\n  identityNumber: {\n    type: String,\n    minlength: 11,\n    maxlength: 11,\n    required: function () {\n      return this.subMerchantType === \"PRIVATE_COMPANY\";\n    },\n  },\n  taxNumber: {\n    type: String,\n    required: function () {\n      return this.subMerchantType === \"LIMITED_OR_JOINT_STOCK_COMPANY\";\n    },\n  },\n  name: {\n    type: String,\n    required: true,\n  },\n  gsmNumber: {\n    type: String,\n    required: true,\n  },\n  email: {\n    type: String,\n    required: true,\n  },\n  password: {\n    type: String,\n    required: true,\n  },\n  taxOffice: {\n    type: String,\n    required: true,\n  },\n  legalCompanyTitle: {\n    type: String,\n    required: true,\n  },\n  iban: {\n    type: String,\n    required: true,\n  },\n  address: {\n    type: String,\n    required: true,\n  },\n  avatarColor: {\n    type: String,\n    default: randomColorGenerator(),\n    required: true,\n  },\n  logo: {\n    type: String,\n    required: false,\n  },\n  products: {\n    type: ObjectId,\n    ref: \"Products\",\n  },\n  documents: {\n    type: [String],\n    required: true,\n  },\n  isVerified: {\n    type: Boolean,\n    default: false,\n  },\n});\n\nprivateCompanySellerSchema.pre(\"save\", async function (next) {\n  try {\n    // this.password = await bcrypt.hash(this.password, 10);\n    if (this.isModified(\"password\")) {\n      //password incorrect hatasını böyle çözdük\n      this.password = await bcrypt.hash(this.password, 10);\n    }\n    return next();\n  } catch (err) {\n    return next(err);\n  }\n  next();\n});\n\nconst PrivateCompanySeller = mongoose.model(\n  \"PrivateCompanySeller\",\n  privateCompanySellerSchema\n);\n\nmodule.exports = PrivateCompanySeller;\n"],"mappings":";;AACA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,KAAA,GAAAF,sBAAA,CAAAC,OAAA;AAAwC,SAAAD,uBAAAG,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAFxC,MAAMG,QAAQ,GAAGL,OAAO,CAAC,UAAU,CAAC;AAIpC,MAAMM,MAAM,GAAGD,QAAQ,CAACC,MAAM;AAC9B,MAAM;EAAEC;AAAS,CAAC,GAAGD,MAAM,CAACE,KAAK;AACjC,MAAMC,oBAAoB,GAAGA,CAAA,KAAM;EACjC,OAAOC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,CAAC,CAAC,GAAG,QAAQ,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC;AAC1D,CAAC;AAED,MAAMC,0BAA0B,GAAG,IAAIR,MAAM,CAAC;EAC5CS,MAAM,EAAE;IACNC,IAAI,EAAEC,MAAM;IACZb,OAAO,EAAE;EACX,CAAC;EACDc,cAAc,EAAE;IACdF,IAAI,EAAEC,MAAM;IACZb,OAAO,EAAE,IAAAe,aAAW,EAAC;EACvB,CAAC;EACDC,IAAI,EAAE;IACJJ,IAAI,EAAEC,MAAM;IACZI,QAAQ,EAAE,IAAI;IACdjB,OAAO,EAAE,QAAQ;IACjBkB,IAAI,EAAE,CAAC,MAAM,EAAE,OAAO,EAAE,QAAQ;EAClC,CAAC;EACDC,qBAAqB,EAAE;IACrBP,IAAI,EAAEC,MAAM;IACZI,QAAQ,EAAE,IAAI;IACdjB,OAAO,EAAE,IAAAe,aAAW,EAAC;EACvB,CAAC;EACDK,eAAe,EAAE;IACfR,IAAI,EAAEC,MAAM;IACZK,IAAI,EAAE,CAAC,iBAAiB,EAAE,gCAAgC,CAAC;IAC3D;IACAD,QAAQ,EAAE;EACZ,CAAC;EACDI,QAAQ,EAAE;IACRT,IAAI,EAAEC,MAAM;IACZb,OAAO,EAAE,KAAK;IACdkB,IAAI,EAAE,CAAC,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK,EAAE,KAAK;EACxD,CAAC;EACDI,cAAc,EAAE;IACdV,IAAI,EAAEC,MAAM;IACZU,SAAS,EAAE,EAAE;IACbC,SAAS,EAAE,EAAE;IACbP,QAAQ,EAAE,SAAAA,CAAA,EAAY;MACpB,OAAO,IAAI,CAACG,eAAe,KAAK,iBAAiB;IACnD;EACF,CAAC;EACDK,SAAS,EAAE;IACTb,IAAI,EAAEC,MAAM;IACZI,QAAQ,EAAE,SAAAA,CAAA,EAAY;MACpB,OAAO,IAAI,CAACG,eAAe,KAAK,gCAAgC;IAClE;EACF,CAAC;EACDM,IAAI,EAAE;IACJd,IAAI,EAAEC,MAAM;IACZI,QAAQ,EAAE;EACZ,CAAC;EACDU,SAAS,EAAE;IACTf,IAAI,EAAEC,MAAM;IACZI,QAAQ,EAAE;EACZ,CAAC;EACDW,KAAK,EAAE;IACLhB,IAAI,EAAEC,MAAM;IACZI,QAAQ,EAAE;EACZ,CAAC;EACDY,QAAQ,EAAE;IACRjB,IAAI,EAAEC,MAAM;IACZI,QAAQ,EAAE;EACZ,CAAC;EACDa,SAAS,EAAE;IACTlB,IAAI,EAAEC,MAAM;IACZI,QAAQ,EAAE;EACZ,CAAC;EACDc,iBAAiB,EAAE;IACjBnB,IAAI,EAAEC,MAAM;IACZI,QAAQ,EAAE;EACZ,CAAC;EACDe,IAAI,EAAE;IACJpB,IAAI,EAAEC,MAAM;IACZI,QAAQ,EAAE;EACZ,CAAC;EACDgB,OAAO,EAAE;IACPrB,IAAI,EAAEC,MAAM;IACZI,QAAQ,EAAE;EACZ,CAAC;EACDiB,WAAW,EAAE;IACXtB,IAAI,EAAEC,MAAM;IACZb,OAAO,EAAEK,oBAAoB,CAAC,CAAC;IAC/BY,QAAQ,EAAE;EACZ,CAAC;EACDkB,IAAI,EAAE;IACJvB,IAAI,EAAEC,MAAM;IACZI,QAAQ,EAAE;EACZ,CAAC;EACDmB,QAAQ,EAAE;IACRxB,IAAI,EAAET,QAAQ;IACdkC,GAAG,EAAE;EACP,CAAC;EACDC,SAAS,EAAE;IACT1B,IAAI,EAAE,CAACC,MAAM,CAAC;IACdI,QAAQ,EAAE;EACZ,CAAC;EACDsB,UAAU,EAAE;IACV3B,IAAI,EAAE4B,OAAO;IACbxC,OAAO,EAAE;EACX;AACF,CAAC,CAAC;AAEFU,0BAA0B,CAAC+B,GAAG,CAAC,MAAM,EAAE,gBAAgBC,IAAI,EAAE;EAC3D,IAAI;IACF;IACA,IAAI,IAAI,CAACC,UAAU,CAAC,UAAU,CAAC,EAAE;MAC/B;MACA,IAAI,CAACd,QAAQ,GAAG,MAAMe,iBAAM,CAACC,IAAI,CAAC,IAAI,CAAChB,QAAQ,EAAE,EAAE,CAAC;IACtD;IACA,OAAOa,IAAI,CAAC,CAAC;EACf,CAAC,CAAC,OAAOI,GAAG,EAAE;IACZ,OAAOJ,IAAI,CAACI,GAAG,CAAC;EAClB;EACAJ,IAAI,CAAC,CAAC;AACR,CAAC,CAAC;AAEF,MAAMK,oBAAoB,GAAG9C,QAAQ,CAAC+C,KAAK,CACzC,sBAAsB,EACtBtC,0BACF,CAAC;AAEDuC,MAAM,CAACC,OAAO,GAAGH,oBAAoB","ignoreList":[]}},"mtime":1730974081345},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/limited-or-joint-company.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst mongoose = require(\"mongoose\");\nconst Schema = mongoose.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst randomColorGenerator = () => {\n  return Math.floor(Math.random() * 16777215).toString(16);\n};\nconst limitedOrJointCompanySellerSchema = new Schema({\n  locale: {\n    type: String,\n    default: \"tr\"\n  },\n  conversationId: {\n    type: String,\n    default: (0, _uuid.default)()\n  },\n  role: {\n    type: String,\n    required: true,\n    default: \"seller\",\n    enum: [\"user\", \"admin\", \"seller\"]\n  },\n  subMerchantExternalId: {\n    type: String,\n    required: true,\n    default: (0, _uuid.default)()\n  },\n  subMerchantType: {\n    type: String,\n    enum: [\"LIMITED_OR_JOINT_STOCK_COMPANY\"],\n    default: \"LIMITED_OR_JOINT_STOCK_COMPANY\"\n  },\n  currency: {\n    type: String,\n    default: \"TRY\",\n    enum: [\"TRY\", \"USD\", \"EUR\", \"GBP\", \"RUB\", \"CHF\", \"NOK\"]\n  },\n  taxNumber: {\n    type: String,\n    required: true\n  },\n  name: {\n    type: String,\n    required: true\n  },\n  gsmNumber: {\n    type: String,\n    required: true\n  },\n  email: {\n    type: String,\n    required: true,\n    required: true\n  },\n  password: {\n    type: String,\n    required: true\n  },\n  taxOffice: {\n    type: String,\n    required: true\n  },\n  legalCompanyTitle: {\n    type: String,\n    required: true\n  },\n  iban: {\n    type: String,\n    required: true\n  },\n  address: {\n    type: String,\n    required: true\n  },\n  avatarColor: {\n    type: String,\n    default: randomColorGenerator(),\n    required: true\n  },\n  logo: {\n    type: String,\n    required: false\n  },\n  products: {\n    type: ObjectId,\n    ref: \"Products\"\n  },\n  documents: {\n    type: [String],\n    required: true\n  },\n  isVerified: {\n    type: Boolean,\n    default: false\n  }\n});\nlimitedOrJointCompanySellerSchema.pre(\"save\", async function (next) {\n  try {\n    // this.password = await bcrypt.hash(this.password, 10);\n    if (this.isModified(\"password\")) {\n      //password incorrect hatasını böyle çözdük\n      this.password = await _bcryptjs.default.hash(this.password, 10);\n    }\n    return next();\n  } catch (err) {\n    return next(err);\n  }\n  next();\n});\nconst LimitedOrJointCompanySeller = mongoose.model(\"LimitedOrJointCompanySeller\", limitedOrJointCompanySellerSchema);\nmodule.exports = LimitedOrJointCompanySeller;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYmNyeXB0anMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl91dWlkIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwibW9uZ29vc2UiLCJTY2hlbWEiLCJPYmplY3RJZCIsIlR5cGVzIiwicmFuZG9tQ29sb3JHZW5lcmF0b3IiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJ0b1N0cmluZyIsImxpbWl0ZWRPckpvaW50Q29tcGFueVNlbGxlclNjaGVtYSIsImxvY2FsZSIsInR5cGUiLCJTdHJpbmciLCJjb252ZXJzYXRpb25JZCIsImdlbmVyYXRlZElkIiwicm9sZSIsInJlcXVpcmVkIiwiZW51bSIsInN1Yk1lcmNoYW50RXh0ZXJuYWxJZCIsInN1Yk1lcmNoYW50VHlwZSIsImN1cnJlbmN5IiwidGF4TnVtYmVyIiwibmFtZSIsImdzbU51bWJlciIsImVtYWlsIiwicGFzc3dvcmQiLCJ0YXhPZmZpY2UiLCJsZWdhbENvbXBhbnlUaXRsZSIsImliYW4iLCJhZGRyZXNzIiwiYXZhdGFyQ29sb3IiLCJsb2dvIiwicHJvZHVjdHMiLCJyZWYiLCJkb2N1bWVudHMiLCJpc1ZlcmlmaWVkIiwiQm9vbGVhbiIsInByZSIsIm5leHQiLCJpc01vZGlmaWVkIiwiYmNyeXB0IiwiaGFzaCIsImVyciIsIkxpbWl0ZWRPckpvaW50Q29tcGFueVNlbGxlciIsIm1vZGVsIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL2RiLyIsInNvdXJjZXMiOlsibGltaXRlZC1vci1qb2ludC1jb21wYW55LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZShcIm1vbmdvb3NlXCIpO1xuaW1wb3J0IGJjcnlwdCBmcm9tIFwiYmNyeXB0anNcIjtcbmltcG9ydCBnZW5lcmF0ZWRJZCBmcm9tIFwiLi4vdXRpbHMvdXVpZFwiO1xuXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWE7XG5jb25zdCB7IE9iamVjdElkIH0gPSBTY2hlbWEuVHlwZXM7XG5jb25zdCByYW5kb21Db2xvckdlbmVyYXRvciA9ICgpID0+IHtcbiAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDE2Nzc3MjE1KS50b1N0cmluZygxNik7XG59O1xuXG5jb25zdCBsaW1pdGVkT3JKb2ludENvbXBhbnlTZWxsZXJTY2hlbWEgPSBuZXcgU2NoZW1hKHtcbiAgbG9jYWxlOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGRlZmF1bHQ6IFwidHJcIixcbiAgfSxcbiAgY29udmVyc2F0aW9uSWQ6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgZGVmYXVsdDogZ2VuZXJhdGVkSWQoKSxcbiAgfSxcbiAgcm9sZToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICBkZWZhdWx0OiBcInNlbGxlclwiLFxuICAgIGVudW06IFtcInVzZXJcIiwgXCJhZG1pblwiLCBcInNlbGxlclwiXSxcbiAgfSxcbiAgc3ViTWVyY2hhbnRFeHRlcm5hbElkOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIGRlZmF1bHQ6IGdlbmVyYXRlZElkKCksXG4gIH0sXG4gIHN1Yk1lcmNoYW50VHlwZToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICBlbnVtOiBbXCJMSU1JVEVEX09SX0pPSU5UX1NUT0NLX0NPTVBBTllcIl0sXG4gICAgZGVmYXVsdDogXCJMSU1JVEVEX09SX0pPSU5UX1NUT0NLX0NPTVBBTllcIixcbiAgfSxcbiAgY3VycmVuY3k6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgZGVmYXVsdDogXCJUUllcIixcbiAgICBlbnVtOiBbXCJUUllcIiwgXCJVU0RcIiwgXCJFVVJcIiwgXCJHQlBcIiwgXCJSVUJcIiwgXCJDSEZcIiwgXCJOT0tcIl0sXG4gIH0sXG4gIHRheE51bWJlcjoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgbmFtZToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgZ3NtTnVtYmVyOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHJlcXVpcmVkOiB0cnVlLFxuICB9LFxuICBlbWFpbDoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgcGFzc3dvcmQ6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gIH0sXG4gIHRheE9mZmljZToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgbGVnYWxDb21wYW55VGl0bGU6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gIH0sXG4gIGliYW46IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gIH0sXG4gIGFkZHJlc3M6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gIH0sXG4gIGF2YXRhckNvbG9yOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGRlZmF1bHQ6IHJhbmRvbUNvbG9yR2VuZXJhdG9yKCksXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gIH0sXG4gIGxvZ286IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IGZhbHNlLFxuICB9LFxuICBwcm9kdWN0czoge1xuICAgIHR5cGU6IE9iamVjdElkLFxuICAgIHJlZjogXCJQcm9kdWN0c1wiLFxuICB9LFxuICBkb2N1bWVudHM6IHtcbiAgICB0eXBlOiBbU3RyaW5nXSxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgaXNWZXJpZmllZDoge1xuICAgIHR5cGU6IEJvb2xlYW4sXG4gICAgZGVmYXVsdDogZmFsc2UsXG4gIH0sXG59KTtcblxubGltaXRlZE9ySm9pbnRDb21wYW55U2VsbGVyU2NoZW1hLnByZShcInNhdmVcIiwgYXN5bmMgZnVuY3Rpb24gKG5leHQpIHtcbiAgdHJ5IHtcbiAgICAvLyB0aGlzLnBhc3N3b3JkID0gYXdhaXQgYmNyeXB0Lmhhc2godGhpcy5wYXNzd29yZCwgMTApO1xuICAgIGlmICh0aGlzLmlzTW9kaWZpZWQoXCJwYXNzd29yZFwiKSkge1xuICAgICAgLy9wYXNzd29yZCBpbmNvcnJlY3QgaGF0YXPEsW7EsSBiw7Z5bGUgw6fDtnpkw7xrXG4gICAgICB0aGlzLnBhc3N3b3JkID0gYXdhaXQgYmNyeXB0Lmhhc2godGhpcy5wYXNzd29yZCwgMTApO1xuICAgIH1cbiAgICByZXR1cm4gbmV4dCgpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICByZXR1cm4gbmV4dChlcnIpO1xuICB9XG4gIG5leHQoKTtcbn0pO1xuXG5jb25zdCBMaW1pdGVkT3JKb2ludENvbXBhbnlTZWxsZXIgPSBtb25nb29zZS5tb2RlbChcbiAgXCJMaW1pdGVkT3JKb2ludENvbXBhbnlTZWxsZXJcIixcbiAgbGltaXRlZE9ySm9pbnRDb21wYW55U2VsbGVyU2NoZW1hXG4pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IExpbWl0ZWRPckpvaW50Q29tcGFueVNlbGxlcjtcbiJdLCJtYXBwaW5ncyI6Ijs7QUFDQSxJQUFBQSxTQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxLQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFBd0MsU0FBQUQsdUJBQUFHLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFGeEMsTUFBTUcsUUFBUSxHQUFHTCxPQUFPLENBQUMsVUFBVSxDQUFDO0FBSXBDLE1BQU1NLE1BQU0sR0FBR0QsUUFBUSxDQUFDQyxNQUFNO0FBQzlCLE1BQU07RUFBRUM7QUFBUyxDQUFDLEdBQUdELE1B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","map":{"version":3,"names":["_bcryptjs","_interopRequireDefault","require","_uuid","e","__esModule","default","mongoose","Schema","ObjectId","Types","randomColorGenerator","Math","floor","random","toString","limitedOrJointCompanySellerSchema","locale","type","String","conversationId","generatedId","role","required","enum","subMerchantExternalId","subMerchantType","currency","taxNumber","name","gsmNumber","email","password","taxOffice","legalCompanyTitle","iban","address","avatarColor","logo","products","ref","documents","isVerified","Boolean","pre","next","isModified","bcrypt","hash","err","LimitedOrJointCompanySeller","model","module","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["limited-or-joint-company.js"],"sourcesContent":["const mongoose = require(\"mongoose\");\nimport bcrypt from \"bcryptjs\";\nimport generatedId from \"../utils/uuid\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\nconst randomColorGenerator = () => {\n  return Math.floor(Math.random() * 16777215).toString(16);\n};\n\nconst limitedOrJointCompanySellerSchema = new Schema({\n  locale: {\n    type: String,\n    default: \"tr\",\n  },\n  conversationId: {\n    type: String,\n    default: generatedId(),\n  },\n  role: {\n    type: String,\n    required: true,\n    default: \"seller\",\n    enum: [\"user\", \"admin\", \"seller\"],\n  },\n  subMerchantExternalId: {\n    type: String,\n    required: true,\n    default: generatedId(),\n  },\n  subMerchantType: {\n    type: String,\n    enum: [\"LIMITED_OR_JOINT_STOCK_COMPANY\"],\n    default: \"LIMITED_OR_JOINT_STOCK_COMPANY\",\n  },\n  currency: {\n    type: String,\n    default: \"TRY\",\n    enum: [\"TRY\", \"USD\", \"EUR\", \"GBP\", \"RUB\", \"CHF\", \"NOK\"],\n  },\n  taxNumber: {\n    type: String,\n    required: true,\n  },\n  name: {\n    type: String,\n    required: true,\n  },\n  gsmNumber: {\n    type: String,\n    required: true,\n  },\n  email: {\n    type: String,\n    required: true,\n    required: true,\n  },\n  password: {\n    type: String,\n    required: true,\n  },\n  taxOffice: {\n    type: String,\n    required: true,\n  },\n  legalCompanyTitle: {\n    type: String,\n    required: true,\n  },\n  iban: {\n    type: String,\n    required: true,\n  },\n  address: {\n    type: String,\n    required: true,\n  },\n  avatarColor: {\n    type: String,\n    default: randomColorGenerator(),\n    required: true,\n  },\n  logo: {\n    type: String,\n    required: false,\n  },\n  products: {\n    type: ObjectId,\n    ref: \"Products\",\n  },\n  documents: {\n    type: [String],\n    required: true,\n  },\n  isVerified: {\n    type: Boolean,\n    default: false,\n  },\n});\n\nlimitedOrJointCompanySellerSchema.pre(\"save\", async function (next) {\n  try {\n    // this.password = await bcrypt.hash(this.password, 10);\n    if (this.isModified(\"password\")) {\n      //password incorrect hatasını böyle çözdük\n      this.password = await bcrypt.hash(this.password, 10);\n    }\n    return next();\n  } catch (err) {\n    return next(err);\n  }\n  next();\n});\n\nconst LimitedOrJointCompanySeller = mongoose.model(\n  \"LimitedOrJointCompanySeller\",\n  limitedOrJointCompanySellerSchema\n);\n\nmodule.exports = LimitedOrJointCompanySeller;\n"],"mappings":"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","ignoreList":[]}},"mtime":1730722738285},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/limited-or-joint-company.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nvar _bcryptjs = _interopRequireDefault(require(\"bcryptjs\"));\nvar _uuid = _interopRequireDefault(require(\"../utils/uuid\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst mongoose = require(\"mongoose\");\nconst Schema = mongoose.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst randomColorGenerator = () => {\n  return Math.floor(Math.random() * 16777215).toString(16);\n};\nconst limitedOrJointCompanySellerSchema = new Schema({\n  locale: {\n    type: String,\n    default: \"tr\"\n  },\n  conversationId: {\n    type: String,\n    default: (0, _uuid.default)()\n  },\n  role: {\n    type: String,\n    required: true,\n    default: \"seller\",\n    enum: [\"user\", \"admin\", \"seller\"]\n  },\n  subMerchantExternalId: {\n    type: String,\n    required: true,\n    default: (0, _uuid.default)()\n  },\n  subMerchantType: {\n    type: String,\n    enum: [\"LIMITED_OR_JOINT_STOCK_COMPANY\"],\n    default: \"LIMITED_OR_JOINT_STOCK_COMPANY\"\n  },\n  currency: {\n    type: String,\n    default: \"TRY\",\n    enum: [\"TRY\", \"USD\", \"EUR\", \"GBP\", \"RUB\", \"CHF\", \"NOK\"]\n  },\n  taxNumber: {\n    type: String,\n    required: true\n  },\n  name: {\n    type: String,\n    required: true\n  },\n  gsmNumber: {\n    type: String,\n    required: true\n  },\n  email: {\n    type: String,\n    required: true,\n    required: true\n  },\n  password: {\n    type: String,\n    required: true\n  },\n  taxOffice: {\n    type: String,\n    required: true\n  },\n  legalCompanyTitle: {\n    type: String,\n    required: true\n  },\n  iban: {\n    type: String,\n    required: true\n  },\n  address: {\n    type: String,\n    required: true\n  },\n  avatarColor: {\n    type: String,\n    default: randomColorGenerator(),\n    required: true\n  },\n  logo: {\n    type: String,\n    required: false\n  },\n  products: {\n    type: ObjectId,\n    ref: \"Products\"\n  },\n  documents: {\n    type: [String],\n    required: true\n  },\n  isVerified: {\n    type: Boolean,\n    default: false\n  }\n});\nlimitedOrJointCompanySellerSchema.pre(\"save\", async function (next) {\n  try {\n    // this.password = await bcrypt.hash(this.password, 10);\n    if (this.isModified(\"password\")) {\n      //password incorrect hatasını böyle çözdük\n      this.password = await _bcryptjs.default.hash(this.password, 10);\n    }\n    return next();\n  } catch (err) {\n    return next(err);\n  }\n  next();\n});\nconst LimitedOrJointCompanySeller = mongoose.model(\"LimitedOrJointCompanySeller\", limitedOrJointCompanySellerSchema);\nmodule.exports = LimitedOrJointCompanySeller;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYmNyeXB0anMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl91dWlkIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwibW9uZ29vc2UiLCJTY2hlbWEiLCJPYmplY3RJZCIsIlR5cGVzIiwicmFuZG9tQ29sb3JHZW5lcmF0b3IiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJ0b1N0cmluZyIsImxpbWl0ZWRPckpvaW50Q29tcGFueVNlbGxlclNjaGVtYSIsImxvY2FsZSIsInR5cGUiLCJTdHJpbmciLCJjb252ZXJzYXRpb25JZCIsImdlbmVyYXRlZElkIiwicm9sZSIsInJlcXVpcmVkIiwiZW51bSIsInN1Yk1lcmNoYW50RXh0ZXJuYWxJZCIsInN1Yk1lcmNoYW50VHlwZSIsImN1cnJlbmN5IiwidGF4TnVtYmVyIiwibmFtZSIsImdzbU51bWJlciIsImVtYWlsIiwicGFzc3dvcmQiLCJ0YXhPZmZpY2UiLCJsZWdhbENvbXBhbnlUaXRsZSIsImliYW4iLCJhZGRyZXNzIiwiYXZhdGFyQ29sb3IiLCJsb2dvIiwicHJvZHVjdHMiLCJyZWYiLCJkb2N1bWVudHMiLCJpc1ZlcmlmaWVkIiwiQm9vbGVhbiIsInByZSIsIm5leHQiLCJpc01vZGlmaWVkIiwiYmNyeXB0IiwiaGFzaCIsImVyciIsIkxpbWl0ZWRPckpvaW50Q29tcGFueVNlbGxlciIsIm1vZGVsIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL2RiLyIsInNvdXJjZXMiOlsibGltaXRlZC1vci1qb2ludC1jb21wYW55LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZShcIm1vbmdvb3NlXCIpO1xuaW1wb3J0IGJjcnlwdCBmcm9tIFwiYmNyeXB0anNcIjtcbmltcG9ydCBnZW5lcmF0ZWRJZCBmcm9tIFwiLi4vdXRpbHMvdXVpZFwiO1xuXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWE7XG5jb25zdCB7IE9iamVjdElkIH0gPSBTY2hlbWEuVHlwZXM7XG5jb25zdCByYW5kb21Db2xvckdlbmVyYXRvciA9ICgpID0+IHtcbiAgcmV0dXJuIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDE2Nzc3MjE1KS50b1N0cmluZygxNik7XG59O1xuXG5jb25zdCBsaW1pdGVkT3JKb2ludENvbXBhbnlTZWxsZXJTY2hlbWEgPSBuZXcgU2NoZW1hKHtcbiAgbG9jYWxlOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGRlZmF1bHQ6IFwidHJcIixcbiAgfSxcbiAgY29udmVyc2F0aW9uSWQ6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgZGVmYXVsdDogZ2VuZXJhdGVkSWQoKSxcbiAgfSxcbiAgcm9sZToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICBkZWZhdWx0OiBcInNlbGxlclwiLFxuICAgIGVudW06IFtcInVzZXJcIiwgXCJhZG1pblwiLCBcInNlbGxlclwiXSxcbiAgfSxcbiAgc3ViTWVyY2hhbnRFeHRlcm5hbElkOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgIGRlZmF1bHQ6IGdlbmVyYXRlZElkKCksXG4gIH0sXG4gIHN1Yk1lcmNoYW50VHlwZToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICBlbnVtOiBbXCJMSU1JVEVEX09SX0pPSU5UX1NUT0NLX0NPTVBBTllcIl0sXG4gICAgZGVmYXVsdDogXCJMSU1JVEVEX09SX0pPSU5UX1NUT0NLX0NPTVBBTllcIixcbiAgfSxcbiAgY3VycmVuY3k6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgZGVmYXVsdDogXCJUUllcIixcbiAgICBlbnVtOiBbXCJUUllcIiwgXCJVU0RcIiwgXCJFVVJcIiwgXCJHQlBcIiwgXCJSVUJcIiwgXCJDSEZcIiwgXCJOT0tcIl0sXG4gIH0sXG4gIHRheE51bWJlcjoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgbmFtZToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgZ3NtTnVtYmVyOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIHJlcXVpcmVkOiB0cnVlLFxuICB9LFxuICBlbWFpbDoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgcGFzc3dvcmQ6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gIH0sXG4gIHRheE9mZmljZToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgbGVnYWxDb21wYW55VGl0bGU6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gIH0sXG4gIGliYW46IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gIH0sXG4gIGFkZHJlc3M6IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gIH0sXG4gIGF2YXRhckNvbG9yOiB7XG4gICAgdHlwZTogU3RyaW5nLFxuICAgIGRlZmF1bHQ6IHJhbmRvbUNvbG9yR2VuZXJhdG9yKCksXG4gICAgcmVxdWlyZWQ6IHRydWUsXG4gIH0sXG4gIGxvZ286IHtcbiAgICB0eXBlOiBTdHJpbmcsXG4gICAgcmVxdWlyZWQ6IGZhbHNlLFxuICB9LFxuICBwcm9kdWN0czoge1xuICAgIHR5cGU6IE9iamVjdElkLFxuICAgIHJlZjogXCJQcm9kdWN0c1wiLFxuICB9LFxuICBkb2N1bWVudHM6IHtcbiAgICB0eXBlOiBbU3RyaW5nXSxcbiAgICByZXF1aXJlZDogdHJ1ZSxcbiAgfSxcbiAgaXNWZXJpZmllZDoge1xuICAgIHR5cGU6IEJvb2xlYW4sXG4gICAgZGVmYXVsdDogZmFsc2UsXG4gIH0sXG59KTtcblxubGltaXRlZE9ySm9pbnRDb21wYW55U2VsbGVyU2NoZW1hLnByZShcInNhdmVcIiwgYXN5bmMgZnVuY3Rpb24gKG5leHQpIHtcbiAgdHJ5IHtcbiAgICAvLyB0aGlzLnBhc3N3b3JkID0gYXdhaXQgYmNyeXB0Lmhhc2godGhpcy5wYXNzd29yZCwgMTApO1xuICAgIGlmICh0aGlzLmlzTW9kaWZpZWQoXCJwYXNzd29yZFwiKSkge1xuICAgICAgLy9wYXNzd29yZCBpbmNvcnJlY3QgaGF0YXPEsW7EsSBiw7Z5bGUgw6fDtnpkw7xrXG4gICAgICB0aGlzLnBhc3N3b3JkID0gYXdhaXQgYmNyeXB0Lmhhc2godGhpcy5wYXNzd29yZCwgMTApO1xuICAgIH1cbiAgICByZXR1cm4gbmV4dCgpO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICByZXR1cm4gbmV4dChlcnIpO1xuICB9XG4gIG5leHQoKTtcbn0pO1xuXG5jb25zdCBMaW1pdGVkT3JKb2ludENvbXBhbnlTZWxsZXIgPSBtb25nb29zZS5tb2RlbChcbiAgXCJMaW1pdGVkT3JKb2ludENvbXBhbnlTZWxsZXJcIixcbiAgbGltaXRlZE9ySm9pbnRDb21wYW55U2VsbGVyU2NoZW1hXG4pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IExpbWl0ZWRPckpvaW50Q29tcGFueVNlbGxlcjtcbiJdLCJtYXBwaW5ncyI6Ijs7QUFDQSxJQUFBQSxTQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxLQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFBd0MsU0FBQUQsdUJBQUFHLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFGeEMsTUFBTUcsUUFBUSxHQUFHTCxPQUFPLENBQUMsVUFBVSxDQUFDO0FBSXBDLE1BQU1NLE1BQU0sR0FBR0QsUUFBUSxDQUFDQyxNQUFNO0FBQzlCLE1BQU07RUFBRUM7QUFBUyxDQUFDLEdBQUdELE1B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","map":{"version":3,"names":["_bcryptjs","_interopRequireDefault","require","_uuid","e","__esModule","default","mongoose","Schema","ObjectId","Types","randomColorGenerator","Math","floor","random","toString","limitedOrJointCompanySellerSchema","locale","type","String","conversationId","generatedId","role","required","enum","subMerchantExternalId","subMerchantType","currency","taxNumber","name","gsmNumber","email","password","taxOffice","legalCompanyTitle","iban","address","avatarColor","logo","products","ref","documents","isVerified","Boolean","pre","next","isModified","bcrypt","hash","err","LimitedOrJointCompanySeller","model","module","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["limited-or-joint-company.js"],"sourcesContent":["const mongoose = require(\"mongoose\");\nimport bcrypt from \"bcryptjs\";\nimport generatedId from \"../utils/uuid\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\nconst randomColorGenerator = () => {\n  return Math.floor(Math.random() * 16777215).toString(16);\n};\n\nconst limitedOrJointCompanySellerSchema = new Schema({\n  locale: {\n    type: String,\n    default: \"tr\",\n  },\n  conversationId: {\n    type: String,\n    default: generatedId(),\n  },\n  role: {\n    type: String,\n    required: true,\n    default: \"seller\",\n    enum: [\"user\", \"admin\", \"seller\"],\n  },\n  subMerchantExternalId: {\n    type: String,\n    required: true,\n    default: generatedId(),\n  },\n  subMerchantType: {\n    type: String,\n    enum: [\"LIMITED_OR_JOINT_STOCK_COMPANY\"],\n    default: \"LIMITED_OR_JOINT_STOCK_COMPANY\",\n  },\n  currency: {\n    type: String,\n    default: \"TRY\",\n    enum: [\"TRY\", \"USD\", \"EUR\", \"GBP\", \"RUB\", \"CHF\", \"NOK\"],\n  },\n  taxNumber: {\n    type: String,\n    required: true,\n  },\n  name: {\n    type: String,\n    required: true,\n  },\n  gsmNumber: {\n    type: String,\n    required: true,\n  },\n  email: {\n    type: String,\n    required: true,\n    required: true,\n  },\n  password: {\n    type: String,\n    required: true,\n  },\n  taxOffice: {\n    type: String,\n    required: true,\n  },\n  legalCompanyTitle: {\n    type: String,\n    required: true,\n  },\n  iban: {\n    type: String,\n    required: true,\n  },\n  address: {\n    type: String,\n    required: true,\n  },\n  avatarColor: {\n    type: String,\n    default: randomColorGenerator(),\n    required: true,\n  },\n  logo: {\n    type: String,\n    required: false,\n  },\n  products: {\n    type: ObjectId,\n    ref: \"Products\",\n  },\n  documents: {\n    type: [String],\n    required: true,\n  },\n  isVerified: {\n    type: Boolean,\n    default: false,\n  },\n});\n\nlimitedOrJointCompanySellerSchema.pre(\"save\", async function (next) {\n  try {\n    // this.password = await bcrypt.hash(this.password, 10);\n    if (this.isModified(\"password\")) {\n      //password incorrect hatasını böyle çözdük\n      this.password = await bcrypt.hash(this.password, 10);\n    }\n    return next();\n  } catch (err) {\n    return next(err);\n  }\n  next();\n});\n\nconst LimitedOrJointCompanySeller = mongoose.model(\n  \"LimitedOrJointCompanySeller\",\n  limitedOrJointCompanySellerSchema\n);\n\nmodule.exports = LimitedOrJointCompanySeller;\n"],"mappings":"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","ignoreList":[]}},"mtime":1730722738285},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/submerchant.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.updatePrivateSubMerchant = exports.updateLimitedOrJointSubMerchant = exports.getSubMerchant = exports.createSubMerchant = void 0;\nvar _iyzipay = _interopRequireDefault(require(\"../connection/iyzipay\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst createSubMerchant = data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.subMerchant.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.createSubMerchant = createSubMerchant;\nconst getSubMerchant = data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.subMerchant.retrieve(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.getSubMerchant = getSubMerchant;\nconst updatePrivateSubMerchant = data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.subMerchant.update(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.updatePrivateSubMerchant = updatePrivateSubMerchant;\nconst updateLimitedOrJointSubMerchant = data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.subMerchant.update(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.updateLimitedOrJointSubMerchant = updateLimitedOrJointSubMerchant;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaXl6aXBheSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiY3JlYXRlU3ViTWVyY2hhbnQiLCJkYXRhIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJpeXppcGF5Iiwic3ViTWVyY2hhbnQiLCJjcmVhdGUiLCJlcnIiLCJyZXN1bHQiLCJleHBvcnRzIiwiZ2V0U3ViTWVyY2hhbnQiLCJyZXRyaWV2ZSIsInVwZGF0ZVByaXZhdGVTdWJNZXJjaGFudCIsInVwZGF0ZSIsInVwZGF0ZUxpbWl0ZWRPckpvaW50U3ViTWVyY2hhbnQiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9zZXJ2aWNlcy9peXppY28vbWV0aG9kcy8iLCJzb3VyY2VzIjpbInN1Ym1lcmNoYW50LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBpeXppcGF5IGZyb20gXCIuLi9jb25uZWN0aW9uL2l5emlwYXlcIjtcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZVN1Yk1lcmNoYW50ID0gKGRhdGEpID0+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBpeXppcGF5LnN1Yk1lcmNoYW50LmNyZWF0ZShkYXRhLCAoZXJyLCByZXN1bHQpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufTtcblxuZXhwb3J0IGNvbnN0IGdldFN1Yk1lcmNoYW50ID0gKGRhdGEpID0+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBpeXppcGF5LnN1Yk1lcmNoYW50LnJldHJpZXZlKGRhdGEsIChlcnIsIHJlc3VsdCkgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59O1xuXG5leHBvcnQgY29uc3QgdXBkYXRlUHJpdmF0ZVN1Yk1lcmNoYW50ID0gKGRhdGEpID0+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBpeXppcGF5LnN1Yk1lcmNoYW50LnVwZGF0ZShkYXRhLCAoZXJyLCByZXN1bHQpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufTtcblxuZXhwb3J0IGNvbnN0IHVwZGF0ZUxpbWl0ZWRPckpvaW50U3ViTWVyY2hhbnQgPSAoZGF0YSkgPT4ge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGl5emlwYXkuc3ViTWVyY2hhbnQudXBkYXRlKGRhdGEsIChlcnIsIHJlc3VsdCkgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxRQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFBNEMsU0FBQUQsdUJBQUFFLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFckMsTUFBTUcsaUJBQWlCLEdBQUlDLElBQUksSUFBSztFQUN6QyxPQUFPLElBQUlDLE9BQU8sQ0FBQyxDQUFDQyxPQUFPLEVBQUVDLE1BQU0sS0FBSztJQUN0Q0MsZ0JBQU8sQ0FBQ0MsV0FBVyxDQUFDQyxNQUFNLENBQUNOLElBQUksRUFBRSxDQUFDTyxHQUFHLEVBQUVDLE1BQU0sS0FBSztNQUNoRCxJQUFJRCxHQUFHLEVBQUU7UUFDUEosTUFBTSxDQUFDSSxHQUFHLENBQUM7TUFDYixDQUFDLE1BQU07UUFDTEwsT0FBTyxDQUFDTSxNQUFNLENBQUM7TUFDakI7SUFDRixDQUFDLENBQUM7RUFDSixDQUFDLENBQUM7QUFDSixDQUFDO0FBQUNDLE9BQUEsQ0FBQVYsaUJBQUEsR0FBQUEsaUJBQUE7QUFFSyxNQUFNVyxjQUFjLEdBQUlWLElBQUksSUFBSztFQUN0QyxPQUFPLElBQUlDLE9BQU8sQ0FBQyxDQUFDQyxPQUFPLEVBQUVDLE1BQU0sS0FBSztJQUN0Q0MsZ0JBQU8sQ0FBQ0MsV0FBVyxDQUFDTSxRQUFRLENBQUNYLElBQUksRUFBRSxDQUFDTyxHQUFHLEVBQUVDLE1BQU0sS0FBSztNQUNsRCxJQUFJRCxHQUFHLEVBQUU7UUFDUEosTUFBTSxDQUFDSSxHQUFHLENBQUM7TUFDYixDQUFDLE1BQU07UUFDTEwsT0FBTyxDQUFDTSxNQUFNLENBQUM7TUFDakI7SUFDRixDQUFDLENBQUM7RUFDSixDQUFDLENBQUM7QUFDSixDQUFDO0FBQUNDLE9BQUEsQ0FBQUMsY0FBQSxHQUFBQSxjQUFBO0FBRUssTUFBTUUsd0JBQXdCLEdBQUlaLElBQUksSUFBSztFQUNoRCxPQUFPLElBQUlDLE9BQU8sQ0FBQyxDQUFDQyxPQUFPLEVBQUVDLE1BQU0sS0FBSztJQUN0Q0MsZ0JBQU8sQ0FBQ0MsV0FBVyxDQUFDUSxNQUFNLENBQUNiLElBQUksRUFBRSxDQUFDTyxHQUFHLEVBQUVDLE1BQU0sS0FBSztNQUNoRCxJQUFJRCxHQUFHLEVBQUU7UUFDUEosTUFBTSxDQUFDSSxHQUFHLENBQUM7TUFDYixDQUFDLE1BQU07UUFDTEwsT0FBTyxDQUFDTSxNQUFNLENBQUM7TUFDakI7SUFDRixDQUFDLENBQUM7RUFDSixDQUFDLENBQUM7QUFDSixDQUFDO0FBQUNDLE9BQUEsQ0FBQUcsd0JBQUEsR0FBQUEsd0JBQUE7QUFFSyxNQUFNRSwrQkFBK0IsR0FBSWQsSUFBSSxJQUFLO0VBQ3ZELE9BQU8sSUFBSUMsT0FBTyxDQUFDLENBQUNDLE9BQU8sRUFBRUMsTUFBTSxLQUFLO0lBQ3RDQyxnQkFBTyxDQUFDQyxXQUFXLENBQUNRLE1BQU0sQ0FBQ2IsSUFBSSxFQUFFLENBQUNPLEdBQUcsRUFBRUMsTUFBTSxLQUFLO01BQ2hELElBQUlELEdBQUcsRUFBRTtRQUNQSixNQUFNLENBQUNJLEdBQUcsQ0FBQztNQUNiLENBQUMsTUFBTTtRQUNMTCxPQUFPLENBQUNNLE1BQU0sQ0FBQztNQUNqQjtJQUNGLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztBQUNKLENBQUM7QUFBQ0MsT0FBQSxDQUFBSywrQkFBQSxHQUFBQSwrQkFBQSIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_iyzipay","_interopRequireDefault","require","e","__esModule","default","createSubMerchant","data","Promise","resolve","reject","iyzipay","subMerchant","create","err","result","exports","getSubMerchant","retrieve","updatePrivateSubMerchant","update","updateLimitedOrJointSubMerchant"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/","sources":["submerchant.js"],"sourcesContent":["import iyzipay from \"../connection/iyzipay\";\n\nexport const createSubMerchant = (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.subMerchant.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n\nexport const getSubMerchant = (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.subMerchant.retrieve(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n\nexport const updatePrivateSubMerchant = (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.subMerchant.update(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n\nexport const updateLimitedOrJointSubMerchant = (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.subMerchant.update(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA4C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAErC,MAAMG,iBAAiB,GAAIC,IAAI,IAAK;EACzC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,WAAW,CAACC,MAAM,CAACN,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MAChD,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAV,iBAAA,GAAAA,iBAAA;AAEK,MAAMW,cAAc,GAAIV,IAAI,IAAK;EACtC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,WAAW,CAACM,QAAQ,CAACX,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MAClD,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAC,cAAA,GAAAA,cAAA;AAEK,MAAME,wBAAwB,GAAIZ,IAAI,IAAK;EAChD,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,WAAW,CAACQ,MAAM,CAACb,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MAChD,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAG,wBAAA,GAAAA,wBAAA;AAEK,MAAME,+BAA+B,GAAId,IAAI,IAAK;EACvD,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,WAAW,CAACQ,MAAM,CAACb,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MAChD,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAK,+BAAA,GAAAA,+BAAA","ignoreList":[]}},"mtime":1735137100475},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/submerchant.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.updatePrivateSubMerchant = exports.updateLimitedOrJointSubMerchant = exports.getSubMerchant = exports.createSubMerchant = void 0;\nvar _iyzipay = _interopRequireDefault(require(\"../connection/iyzipay\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst createSubMerchant = data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.subMerchant.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.createSubMerchant = createSubMerchant;\nconst getSubMerchant = data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.subMerchant.retrieve(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.getSubMerchant = getSubMerchant;\nconst updatePrivateSubMerchant = data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.subMerchant.update(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.updatePrivateSubMerchant = updatePrivateSubMerchant;\nconst updateLimitedOrJointSubMerchant = data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.subMerchant.update(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.updateLimitedOrJointSubMerchant = updateLimitedOrJointSubMerchant;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaXl6aXBheSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiY3JlYXRlU3ViTWVyY2hhbnQiLCJkYXRhIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJpeXppcGF5Iiwic3ViTWVyY2hhbnQiLCJjcmVhdGUiLCJlcnIiLCJyZXN1bHQiLCJleHBvcnRzIiwiZ2V0U3ViTWVyY2hhbnQiLCJyZXRyaWV2ZSIsInVwZGF0ZVByaXZhdGVTdWJNZXJjaGFudCIsInVwZGF0ZSIsInVwZGF0ZUxpbWl0ZWRPckpvaW50U3ViTWVyY2hhbnQiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9zZXJ2aWNlcy9peXppY28vbWV0aG9kcy8iLCJzb3VyY2VzIjpbInN1Ym1lcmNoYW50LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBpeXppcGF5IGZyb20gXCIuLi9jb25uZWN0aW9uL2l5emlwYXlcIjtcblxuZXhwb3J0IGNvbnN0IGNyZWF0ZVN1Yk1lcmNoYW50ID0gKGRhdGEpID0+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBpeXppcGF5LnN1Yk1lcmNoYW50LmNyZWF0ZShkYXRhLCAoZXJyLCByZXN1bHQpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufTtcblxuZXhwb3J0IGNvbnN0IGdldFN1Yk1lcmNoYW50ID0gKGRhdGEpID0+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBpeXppcGF5LnN1Yk1lcmNoYW50LnJldHJpZXZlKGRhdGEsIChlcnIsIHJlc3VsdCkgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59O1xuXG5leHBvcnQgY29uc3QgdXBkYXRlUHJpdmF0ZVN1Yk1lcmNoYW50ID0gKGRhdGEpID0+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBpeXppcGF5LnN1Yk1lcmNoYW50LnVwZGF0ZShkYXRhLCAoZXJyLCByZXN1bHQpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNvbHZlKHJlc3VsdCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufTtcblxuZXhwb3J0IGNvbnN0IHVwZGF0ZUxpbWl0ZWRPckpvaW50U3ViTWVyY2hhbnQgPSAoZGF0YSkgPT4ge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGl5emlwYXkuc3ViTWVyY2hhbnQudXBkYXRlKGRhdGEsIChlcnIsIHJlc3VsdCkgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxRQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFBNEMsU0FBQUQsdUJBQUFFLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFckMsTUFBTUcsaUJBQWlCLEdBQUlDLElBQUksSUFBSztFQUN6QyxPQUFPLElBQUlDLE9BQU8sQ0FBQyxDQUFDQyxPQUFPLEVBQUVDLE1BQU0sS0FBSztJQUN0Q0MsZ0JBQU8sQ0FBQ0MsV0FBVyxDQUFDQyxNQUFNLENBQUNOLElBQUksRUFBRSxDQUFDTyxHQUFHLEVBQUVDLE1BQU0sS0FBSztNQUNoRCxJQUFJRCxHQUFHLEVBQUU7UUFDUEosTUFBTSxDQUFDSSxHQUFHLENBQUM7TUFDYixDQUFDLE1BQU07UUFDTEwsT0FBTyxDQUFDTSxNQUFNLENBQUM7TUFDakI7SUFDRixDQUFDLENBQUM7RUFDSixDQUFDLENBQUM7QUFDSixDQUFDO0FBQUNDLE9BQUEsQ0FBQVYsaUJBQUEsR0FBQUEsaUJBQUE7QUFFSyxNQUFNVyxjQUFjLEdBQUlWLElBQUksSUFBSztFQUN0QyxPQUFPLElBQUlDLE9BQU8sQ0FBQyxDQUFDQyxPQUFPLEVBQUVDLE1BQU0sS0FBSztJQUN0Q0MsZ0JBQU8sQ0FBQ0MsV0FBVyxDQUFDTSxRQUFRLENBQUNYLElBQUksRUFBRSxDQUFDTyxHQUFHLEVBQUVDLE1BQU0sS0FBSztNQUNsRCxJQUFJRCxHQUFHLEVBQUU7UUFDUEosTUFBTSxDQUFDSSxHQUFHLENBQUM7TUFDYixDQUFDLE1BQU07UUFDTEwsT0FBTyxDQUFDTSxNQUFNLENBQUM7TUFDakI7SUFDRixDQUFDLENBQUM7RUFDSixDQUFDLENBQUM7QUFDSixDQUFDO0FBQUNDLE9BQUEsQ0FBQUMsY0FBQSxHQUFBQSxjQUFBO0FBRUssTUFBTUUsd0JBQXdCLEdBQUlaLElBQUksSUFBSztFQUNoRCxPQUFPLElBQUlDLE9BQU8sQ0FBQyxDQUFDQyxPQUFPLEVBQUVDLE1BQU0sS0FBSztJQUN0Q0MsZ0JBQU8sQ0FBQ0MsV0FBVyxDQUFDUSxNQUFNLENBQUNiLElBQUksRUFBRSxDQUFDTyxHQUFHLEVBQUVDLE1BQU0sS0FBSztNQUNoRCxJQUFJRCxHQUFHLEVBQUU7UUFDUEosTUFBTSxDQUFDSSxHQUFHLENBQUM7TUFDYixDQUFDLE1BQU07UUFDTEwsT0FBTyxDQUFDTSxNQUFNLENBQUM7TUFDakI7SUFDRixDQUFDLENBQUM7RUFDSixDQUFDLENBQUM7QUFDSixDQUFDO0FBQUNDLE9BQUEsQ0FBQUcsd0JBQUEsR0FBQUEsd0JBQUE7QUFFSyxNQUFNRSwrQkFBK0IsR0FBSWQsSUFBSSxJQUFLO0VBQ3ZELE9BQU8sSUFBSUMsT0FBTyxDQUFDLENBQUNDLE9BQU8sRUFBRUMsTUFBTSxLQUFLO0lBQ3RDQyxnQkFBTyxDQUFDQyxXQUFXLENBQUNRLE1BQU0sQ0FBQ2IsSUFBSSxFQUFFLENBQUNPLEdBQUcsRUFBRUMsTUFBTSxLQUFLO01BQ2hELElBQUlELEdBQUcsRUFBRTtRQUNQSixNQUFNLENBQUNJLEdBQUcsQ0FBQztNQUNiLENBQUMsTUFBTTtRQUNMTCxPQUFPLENBQUNNLE1BQU0sQ0FBQztNQUNqQjtJQUNGLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztBQUNKLENBQUM7QUFBQ0MsT0FBQSxDQUFBSywrQkFBQSxHQUFBQSwrQkFBQSIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_iyzipay","_interopRequireDefault","require","e","__esModule","default","createSubMerchant","data","Promise","resolve","reject","iyzipay","subMerchant","create","err","result","exports","getSubMerchant","retrieve","updatePrivateSubMerchant","update","updateLimitedOrJointSubMerchant"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/","sources":["submerchant.js"],"sourcesContent":["import iyzipay from \"../connection/iyzipay\";\n\nexport const createSubMerchant = (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.subMerchant.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n\nexport const getSubMerchant = (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.subMerchant.retrieve(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n\nexport const updatePrivateSubMerchant = (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.subMerchant.update(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n\nexport const updateLimitedOrJointSubMerchant = (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.subMerchant.update(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA4C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAErC,MAAMG,iBAAiB,GAAIC,IAAI,IAAK;EACzC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,WAAW,CAACC,MAAM,CAACN,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MAChD,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAV,iBAAA,GAAAA,iBAAA;AAEK,MAAMW,cAAc,GAAIV,IAAI,IAAK;EACtC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,WAAW,CAACM,QAAQ,CAACX,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MAClD,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAC,cAAA,GAAAA,cAAA;AAEK,MAAME,wBAAwB,GAAIZ,IAAI,IAAK;EAChD,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,WAAW,CAACQ,MAAM,CAACb,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MAChD,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAG,wBAAA,GAAAA,wBAAA;AAEK,MAAME,+BAA+B,GAAId,IAAI,IAAK;EACvD,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,WAAW,CAACQ,MAAM,CAACb,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MAChD,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAK,+BAAA,GAAAA,+BAAA","ignoreList":[]}},"mtime":1735137100475},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/approval.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.disApprovePayment = exports.approvePayment = void 0;\nvar _iyzipay = _interopRequireDefault(require(\"../connection/iyzipay\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst approvePayment = data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.approval.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.approvePayment = approvePayment;\nconst disApprovePayment = data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.disapproval.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.disApprovePayment = disApprovePayment;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaXl6aXBheSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiYXBwcm92ZVBheW1lbnQiLCJkYXRhIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJpeXppcGF5IiwiYXBwcm92YWwiLCJjcmVhdGUiLCJlcnIiLCJyZXN1bHQiLCJleHBvcnRzIiwiZGlzQXBwcm92ZVBheW1lbnQiLCJkaXNhcHByb3ZhbCJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3NlcnZpY2VzL2l5emljby9tZXRob2RzLyIsInNvdXJjZXMiOlsiYXBwcm92YWwuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGl5emlwYXkgZnJvbSBcIi4uL2Nvbm5lY3Rpb24vaXl6aXBheVwiO1xuXG5leHBvcnQgY29uc3QgYXBwcm92ZVBheW1lbnQgPSAoZGF0YSkgPT4ge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGl5emlwYXkuYXBwcm92YWwuY3JlYXRlKGRhdGEsIChlcnIsIHJlc3VsdCkgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59O1xuXG5leHBvcnQgY29uc3QgZGlzQXBwcm92ZVBheW1lbnQgPSAoZGF0YSkgPT4ge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGl5emlwYXkuZGlzYXBwcm92YWwuY3JlYXRlKGRhdGEsIChlcnIsIHJlc3VsdCkgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxRQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFBNEMsU0FBQUQsdUJBQUFFLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFckMsTUFBTUcsY0FBYyxHQUFJQyxJQUFJLElBQUs7RUFDdEMsT0FBTyxJQUFJQyxPQUFPLENBQUMsQ0FBQ0MsT0FBTyxFQUFFQyxNQUFNLEtBQUs7SUFDdENDLGdCQUFPLENBQUNDLFFBQVEsQ0FBQ0MsTUFBTSxDQUFDTixJQUFJLEVBQUUsQ0FBQ08sR0FBRyxFQUFFQyxNQUFNLEtBQUs7TUFDN0MsSUFBSUQsR0FBRyxFQUFFO1FBQ1BKLE1BQU0sQ0FBQ0ksR0FBRyxDQUFDO01BQ2IsQ0FBQyxNQUFNO1FBQ0xMLE9BQU8sQ0FBQ00sTUFBTSxDQUFDO01BQ2pCO0lBQ0YsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUFDQyxPQUFBLENBQUFWLGNBQUEsR0FBQUEsY0FBQTtBQUVLLE1BQU1XLGlCQUFpQixHQUFJVixJQUFJLElBQUs7RUFDekMsT0FBTyxJQUFJQyxPQUFPLENBQUMsQ0FBQ0MsT0FBTyxFQUFFQyxNQUFNLEtBQUs7SUFDdENDLGdCQUFPLENBQUNPLFdBQVcsQ0FBQ0wsTUFBTSxDQUFDTixJQUFJLEVBQUUsQ0FBQ08sR0FBRyxFQUFFQyxNQUFNLEtBQUs7TUFDaEQsSUFBSUQsR0FBRyxFQUFFO1FBQ1BKLE1BQU0sQ0FBQ0ksR0FBRyxDQUFDO01BQ2IsQ0FBQyxNQUFNO1FBQ0xMLE9BQU8sQ0FBQ00sTUFBTSxDQUFDO01BQ2pCO0lBQ0YsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUFDQyxPQUFBLENBQUFDLGlCQUFBLEdBQUFBLGlCQUFBIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["_iyzipay","_interopRequireDefault","require","e","__esModule","default","approvePayment","data","Promise","resolve","reject","iyzipay","approval","create","err","result","exports","disApprovePayment","disapproval"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/","sources":["approval.js"],"sourcesContent":["import iyzipay from \"../connection/iyzipay\";\n\nexport const approvePayment = (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.approval.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n\nexport const disApprovePayment = (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.disapproval.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA4C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAErC,MAAMG,cAAc,GAAIC,IAAI,IAAK;EACtC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,QAAQ,CAACC,MAAM,CAACN,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MAC7C,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAV,cAAA,GAAAA,cAAA;AAEK,MAAMW,iBAAiB,GAAIV,IAAI,IAAK;EACzC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACO,WAAW,CAACL,MAAM,CAACN,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MAChD,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAC,iBAAA,GAAAA,iBAAA","ignoreList":[]}},"mtime":1731407223004},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/approval.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.disApprovePayment = exports.approvePayment = void 0;\nvar _iyzipay = _interopRequireDefault(require(\"../connection/iyzipay\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst approvePayment = data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.approval.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.approvePayment = approvePayment;\nconst disApprovePayment = data => {\n  return new Promise((resolve, reject) => {\n    _iyzipay.default.disapproval.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\nexports.disApprovePayment = disApprovePayment;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfaXl6aXBheSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiYXBwcm92ZVBheW1lbnQiLCJkYXRhIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJpeXppcGF5IiwiYXBwcm92YWwiLCJjcmVhdGUiLCJlcnIiLCJyZXN1bHQiLCJleHBvcnRzIiwiZGlzQXBwcm92ZVBheW1lbnQiLCJkaXNhcHByb3ZhbCJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3NlcnZpY2VzL2l5emljby9tZXRob2RzLyIsInNvdXJjZXMiOlsiYXBwcm92YWwuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGl5emlwYXkgZnJvbSBcIi4uL2Nvbm5lY3Rpb24vaXl6aXBheVwiO1xuXG5leHBvcnQgY29uc3QgYXBwcm92ZVBheW1lbnQgPSAoZGF0YSkgPT4ge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGl5emlwYXkuYXBwcm92YWwuY3JlYXRlKGRhdGEsIChlcnIsIHJlc3VsdCkgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59O1xuXG5leHBvcnQgY29uc3QgZGlzQXBwcm92ZVBheW1lbnQgPSAoZGF0YSkgPT4ge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGl5emlwYXkuZGlzYXBwcm92YWwuY3JlYXRlKGRhdGEsIChlcnIsIHJlc3VsdCkgPT4ge1xuICAgICAgaWYgKGVycikge1xuICAgICAgICByZWplY3QoZXJyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc29sdmUocmVzdWx0KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxRQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFBNEMsU0FBQUQsdUJBQUFFLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFckMsTUFBTUcsY0FBYyxHQUFJQyxJQUFJLElBQUs7RUFDdEMsT0FBTyxJQUFJQyxPQUFPLENBQUMsQ0FBQ0MsT0FBTyxFQUFFQyxNQUFNLEtBQUs7SUFDdENDLGdCQUFPLENBQUNDLFFBQVEsQ0FBQ0MsTUFBTSxDQUFDTixJQUFJLEVBQUUsQ0FBQ08sR0FBRyxFQUFFQyxNQUFNLEtBQUs7TUFDN0MsSUFBSUQsR0FBRyxFQUFFO1FBQ1BKLE1BQU0sQ0FBQ0ksR0FBRyxDQUFDO01BQ2IsQ0FBQyxNQUFNO1FBQ0xMLE9BQU8sQ0FBQ00sTUFBTSxDQUFDO01BQ2pCO0lBQ0YsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUFDQyxPQUFBLENBQUFWLGNBQUEsR0FBQUEsY0FBQTtBQUVLLE1BQU1XLGlCQUFpQixHQUFJVixJQUFJLElBQUs7RUFDekMsT0FBTyxJQUFJQyxPQUFPLENBQUMsQ0FBQ0MsT0FBTyxFQUFFQyxNQUFNLEtBQUs7SUFDdENDLGdCQUFPLENBQUNPLFdBQVcsQ0FBQ0wsTUFBTSxDQUFDTixJQUFJLEVBQUUsQ0FBQ08sR0FBRyxFQUFFQyxNQUFNLEtBQUs7TUFDaEQsSUFBSUQsR0FBRyxFQUFFO1FBQ1BKLE1BQU0sQ0FBQ0ksR0FBRyxDQUFDO01BQ2IsQ0FBQyxNQUFNO1FBQ0xMLE9BQU8sQ0FBQ00sTUFBTSxDQUFDO01BQ2pCO0lBQ0YsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUFDQyxPQUFBLENBQUFDLGlCQUFBLEdBQUFBLGlCQUFBIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["_iyzipay","_interopRequireDefault","require","e","__esModule","default","approvePayment","data","Promise","resolve","reject","iyzipay","approval","create","err","result","exports","disApprovePayment","disapproval"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/","sources":["approval.js"],"sourcesContent":["import iyzipay from \"../connection/iyzipay\";\n\nexport const approvePayment = (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.approval.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n\nexport const disApprovePayment = (data) => {\n  return new Promise((resolve, reject) => {\n    iyzipay.disapproval.create(data, (err, result) => {\n      if (err) {\n        reject(err);\n      } else {\n        resolve(result);\n      }\n    });\n  });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,sBAAA,CAAAC,OAAA;AAA4C,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAErC,MAAMG,cAAc,GAAIC,IAAI,IAAK;EACtC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACC,QAAQ,CAACC,MAAM,CAACN,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MAC7C,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAV,cAAA,GAAAA,cAAA;AAEK,MAAMW,iBAAiB,GAAIV,IAAI,IAAK;EACzC,OAAO,IAAIC,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCC,gBAAO,CAACO,WAAW,CAACL,MAAM,CAACN,IAAI,EAAE,CAACO,GAAG,EAAEC,MAAM,KAAK;MAChD,IAAID,GAAG,EAAE;QACPJ,MAAM,CAACI,GAAG,CAAC;MACb,CAAC,MAAM;QACLL,OAAO,CAACM,MAAM,CAAC;MACjB;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACC,OAAA,CAAAC,iBAAA,GAAAA,iBAAA","ignoreList":[]}},"mtime":1731407223004},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/approval-orders.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst ApprovalOrdersSchema = new Schema({\n  paymentTransactionId: {\n    type: String\n  },\n  cartId: {\n    type: ObjectId,\n    ref: \"Carts\"\n  },\n  price: {\n    type: Number\n  },\n  itemId: {\n    type: ObjectId,\n    ref: \"Products\"\n  },\n  name: {\n    type: String\n  },\n  paidPrice: {\n    type: Number\n  }\n});\nconst ApprovalOrders = _mongoose.default.model(\"ApprovalOrders\", ApprovalOrdersSchema);\nvar _default = exports.default = ApprovalOrders;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIlNjaGVtYSIsIm1vbmdvb3NlIiwiT2JqZWN0SWQiLCJUeXBlcyIsIkFwcHJvdmFsT3JkZXJzU2NoZW1hIiwicGF5bWVudFRyYW5zYWN0aW9uSWQiLCJ0eXBlIiwiU3RyaW5nIiwiY2FydElkIiwicmVmIiwicHJpY2UiLCJOdW1iZXIiLCJpdGVtSWQiLCJuYW1lIiwicGFpZFByaWNlIiwiQXBwcm92YWxPcmRlcnMiLCJtb2RlbCIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL2RiLyIsInNvdXJjZXMiOlsiYXBwcm92YWwtb3JkZXJzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSBmcm9tIFwibW9uZ29vc2VcIjtcblxuY29uc3QgU2NoZW1hID0gbW9uZ29vc2UuU2NoZW1hO1xuY29uc3QgeyBPYmplY3RJZCB9ID0gU2NoZW1hLlR5cGVzO1xuXG5jb25zdCBBcHByb3ZhbE9yZGVyc1NjaGVtYSA9IG5ldyBTY2hlbWEoe1xuICBwYXltZW50VHJhbnNhY3Rpb25JZDoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgfSxcbiAgY2FydElkOiB7XG4gICAgdHlwZTogT2JqZWN0SWQsXG4gICAgcmVmOiBcIkNhcnRzXCIsXG4gIH0sXG4gIHByaWNlOiB7XG4gICAgdHlwZTogTnVtYmVyLFxuICB9LFxuICBpdGVtSWQ6IHtcbiAgICB0eXBlOiBPYmplY3RJZCxcbiAgICByZWY6IFwiUHJvZHVjdHNcIixcbiAgfSxcbiAgbmFtZToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgfSxcbiAgcGFpZFByaWNlOiB7XG4gICAgdHlwZTogTnVtYmVyLFxuICB9LFxufSk7XG5cbmNvbnN0IEFwcHJvdmFsT3JkZXJzID0gbW9uZ29vc2UubW9kZWwoXCJBcHByb3ZhbE9yZGVyc1wiLCBBcHByb3ZhbE9yZGVyc1NjaGVtYSk7XG5cbmV4cG9ydCBkZWZhdWx0IEFwcHJvdmFsT3JkZXJzO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxTQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFBZ0MsU0FBQUQsdUJBQUFFLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFaEMsTUFBTUcsTUFBTSxHQUFHQyxpQkFBUSxDQUFDRCxNQUFNO0FBQzlCLE1BQU07RUFBRUU7QUFBUyxDQUFDLEdBQUdGLE1BQU0sQ0FBQ0csS0FBSztBQUVqQyxNQUFNQyxvQkFBb0IsR0FBRyxJQUFJSixNQUFNLENBQUM7RUFDdENLLG9CQUFvQixFQUFFO0lBQ3BCQyxJQUFJLEVBQUVDO0VBQ1IsQ0FBQztFQUNEQyxNQUFNLEVBQUU7SUFDTkYsSUFBSSxFQUFFSixRQUFRO0lBQ2RPLEdBQUcsRUFBRTtFQUNQLENBQUM7RUFDREMsS0FBSyxFQUFFO0lBQ0xKLElBQUksRUFBRUs7RUFDUixDQUFDO0VBQ0RDLE1BQU0sRUFBRTtJQUNOTixJQUFJLEVBQUVKLFFBQVE7SUFDZE8sR0FBRyxFQUFFO0VBQ1AsQ0FBQztFQUNESSxJQUFJLEVBQUU7SUFDSlAsSUFBSSxFQUFFQztFQUNSLENBQUM7RUFDRE8sU0FBUyxFQUFFO0lBQ1RSLElBQUksRUFBRUs7RUFDUjtBQUNGLENBQUMsQ0FBQztBQUVGLE1BQU1JLGNBQWMsR0FBR2QsaUJBQVEsQ0FBQ2UsS0FBSyxDQUFDLGdCQUFnQixFQUFFWixvQkFBb0IsQ0FBQztBQUFDLElBQUFhLFFBQUEsR0FBQUMsT0FBQSxDQUFBbkIsT0FBQSxHQUUvRGdCLGNBQWMiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","e","__esModule","default","Schema","mongoose","ObjectId","Types","ApprovalOrdersSchema","paymentTransactionId","type","String","cartId","ref","price","Number","itemId","name","paidPrice","ApprovalOrders","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["approval-orders.js"],"sourcesContent":["import mongoose from \"mongoose\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\n\nconst ApprovalOrdersSchema = new Schema({\n  paymentTransactionId: {\n    type: String,\n  },\n  cartId: {\n    type: ObjectId,\n    ref: \"Carts\",\n  },\n  price: {\n    type: Number,\n  },\n  itemId: {\n    type: ObjectId,\n    ref: \"Products\",\n  },\n  name: {\n    type: String,\n  },\n  paidPrice: {\n    type: Number,\n  },\n});\n\nconst ApprovalOrders = mongoose.model(\"ApprovalOrders\", ApprovalOrdersSchema);\n\nexport default ApprovalOrders;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AAAgC,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEhC,MAAMG,MAAM,GAAGC,iBAAQ,CAACD,MAAM;AAC9B,MAAM;EAAEE;AAAS,CAAC,GAAGF,MAAM,CAACG,KAAK;AAEjC,MAAMC,oBAAoB,GAAG,IAAIJ,MAAM,CAAC;EACtCK,oBAAoB,EAAE;IACpBC,IAAI,EAAEC;EACR,CAAC;EACDC,MAAM,EAAE;IACNF,IAAI,EAAEJ,QAAQ;IACdO,GAAG,EAAE;EACP,CAAC;EACDC,KAAK,EAAE;IACLJ,IAAI,EAAEK;EACR,CAAC;EACDC,MAAM,EAAE;IACNN,IAAI,EAAEJ,QAAQ;IACdO,GAAG,EAAE;EACP,CAAC;EACDI,IAAI,EAAE;IACJP,IAAI,EAAEC;EACR,CAAC;EACDO,SAAS,EAAE;IACTR,IAAI,EAAEK;EACR;AACF,CAAC,CAAC;AAEF,MAAMI,cAAc,GAAGd,iBAAQ,CAACe,KAAK,CAAC,gBAAgB,EAAEZ,oBAAoB,CAAC;AAAC,IAAAa,QAAA,GAAAC,OAAA,CAAAnB,OAAA,GAE/DgB,cAAc","ignoreList":[]}},"mtime":1731487214714},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/approval-orders.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst ApprovalOrdersSchema = new Schema({\n  paymentTransactionId: {\n    type: String\n  },\n  cartId: {\n    type: ObjectId,\n    ref: \"Carts\"\n  },\n  price: {\n    type: Number\n  },\n  itemId: {\n    type: ObjectId,\n    ref: \"Products\"\n  },\n  name: {\n    type: String\n  },\n  paidPrice: {\n    type: Number\n  }\n});\nconst ApprovalOrders = _mongoose.default.model(\"ApprovalOrders\", ApprovalOrdersSchema);\nvar _default = exports.default = ApprovalOrders;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIlNjaGVtYSIsIm1vbmdvb3NlIiwiT2JqZWN0SWQiLCJUeXBlcyIsIkFwcHJvdmFsT3JkZXJzU2NoZW1hIiwicGF5bWVudFRyYW5zYWN0aW9uSWQiLCJ0eXBlIiwiU3RyaW5nIiwiY2FydElkIiwicmVmIiwicHJpY2UiLCJOdW1iZXIiLCJpdGVtSWQiLCJuYW1lIiwicGFpZFByaWNlIiwiQXBwcm92YWxPcmRlcnMiLCJtb2RlbCIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL2RiLyIsInNvdXJjZXMiOlsiYXBwcm92YWwtb3JkZXJzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSBmcm9tIFwibW9uZ29vc2VcIjtcblxuY29uc3QgU2NoZW1hID0gbW9uZ29vc2UuU2NoZW1hO1xuY29uc3QgeyBPYmplY3RJZCB9ID0gU2NoZW1hLlR5cGVzO1xuXG5jb25zdCBBcHByb3ZhbE9yZGVyc1NjaGVtYSA9IG5ldyBTY2hlbWEoe1xuICBwYXltZW50VHJhbnNhY3Rpb25JZDoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgfSxcbiAgY2FydElkOiB7XG4gICAgdHlwZTogT2JqZWN0SWQsXG4gICAgcmVmOiBcIkNhcnRzXCIsXG4gIH0sXG4gIHByaWNlOiB7XG4gICAgdHlwZTogTnVtYmVyLFxuICB9LFxuICBpdGVtSWQ6IHtcbiAgICB0eXBlOiBPYmplY3RJZCxcbiAgICByZWY6IFwiUHJvZHVjdHNcIixcbiAgfSxcbiAgbmFtZToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgfSxcbiAgcGFpZFByaWNlOiB7XG4gICAgdHlwZTogTnVtYmVyLFxuICB9LFxufSk7XG5cbmNvbnN0IEFwcHJvdmFsT3JkZXJzID0gbW9uZ29vc2UubW9kZWwoXCJBcHByb3ZhbE9yZGVyc1wiLCBBcHByb3ZhbE9yZGVyc1NjaGVtYSk7XG5cbmV4cG9ydCBkZWZhdWx0IEFwcHJvdmFsT3JkZXJzO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxTQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFBZ0MsU0FBQUQsdUJBQUFFLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFaEMsTUFBTUcsTUFBTSxHQUFHQyxpQkFBUSxDQUFDRCxNQUFNO0FBQzlCLE1BQU07RUFBRUU7QUFBUyxDQUFDLEdBQUdGLE1BQU0sQ0FBQ0csS0FBSztBQUVqQyxNQUFNQyxvQkFBb0IsR0FBRyxJQUFJSixNQUFNLENBQUM7RUFDdENLLG9CQUFvQixFQUFFO0lBQ3BCQyxJQUFJLEVBQUVDO0VBQ1IsQ0FBQztFQUNEQyxNQUFNLEVBQUU7SUFDTkYsSUFBSSxFQUFFSixRQUFRO0lBQ2RPLEdBQUcsRUFBRTtFQUNQLENBQUM7RUFDREMsS0FBSyxFQUFFO0lBQ0xKLElBQUksRUFBRUs7RUFDUixDQUFDO0VBQ0RDLE1BQU0sRUFBRTtJQUNOTixJQUFJLEVBQUVKLFFBQVE7SUFDZE8sR0FBRyxFQUFFO0VBQ1AsQ0FBQztFQUNESSxJQUFJLEVBQUU7SUFDSlAsSUFBSSxFQUFFQztFQUNSLENBQUM7RUFDRE8sU0FBUyxFQUFFO0lBQ1RSLElBQUksRUFBRUs7RUFDUjtBQUNGLENBQUMsQ0FBQztBQUVGLE1BQU1JLGNBQWMsR0FBR2QsaUJBQVEsQ0FBQ2UsS0FBSyxDQUFDLGdCQUFnQixFQUFFWixvQkFBb0IsQ0FBQztBQUFDLElBQUFhLFFBQUEsR0FBQUMsT0FBQSxDQUFBbkIsT0FBQSxHQUUvRGdCLGNBQWMiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","e","__esModule","default","Schema","mongoose","ObjectId","Types","ApprovalOrdersSchema","paymentTransactionId","type","String","cartId","ref","price","Number","itemId","name","paidPrice","ApprovalOrders","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["approval-orders.js"],"sourcesContent":["import mongoose from \"mongoose\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\n\nconst ApprovalOrdersSchema = new Schema({\n  paymentTransactionId: {\n    type: String,\n  },\n  cartId: {\n    type: ObjectId,\n    ref: \"Carts\",\n  },\n  price: {\n    type: Number,\n  },\n  itemId: {\n    type: ObjectId,\n    ref: \"Products\",\n  },\n  name: {\n    type: String,\n  },\n  paidPrice: {\n    type: Number,\n  },\n});\n\nconst ApprovalOrders = mongoose.model(\"ApprovalOrders\", ApprovalOrdersSchema);\n\nexport default ApprovalOrders;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AAAgC,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEhC,MAAMG,MAAM,GAAGC,iBAAQ,CAACD,MAAM;AAC9B,MAAM;EAAEE;AAAS,CAAC,GAAGF,MAAM,CAACG,KAAK;AAEjC,MAAMC,oBAAoB,GAAG,IAAIJ,MAAM,CAAC;EACtCK,oBAAoB,EAAE;IACpBC,IAAI,EAAEC;EACR,CAAC;EACDC,MAAM,EAAE;IACNF,IAAI,EAAEJ,QAAQ;IACdO,GAAG,EAAE;EACP,CAAC;EACDC,KAAK,EAAE;IACLJ,IAAI,EAAEK;EACR,CAAC;EACDC,MAAM,EAAE;IACNN,IAAI,EAAEJ,QAAQ;IACdO,GAAG,EAAE;EACP,CAAC;EACDI,IAAI,EAAE;IACJP,IAAI,EAAEC;EACR,CAAC;EACDO,SAAS,EAAE;IACTR,IAAI,EAAEK;EACR;AACF,CAAC,CAAC;AAEF,MAAMI,cAAc,GAAGd,iBAAQ,CAACe,KAAK,CAAC,gBAAgB,EAAEZ,oBAAoB,CAAC;AAAC,IAAAa,QAAA,GAAAC,OAAA,CAAAnB,OAAA,GAE/DgB,cAAc","ignoreList":[]}},"mtime":1731487214714},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/disapproval-orders.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst DisApprovalOrdersSchema = new Schema({\n  paymentTransactionId: {\n    type: String\n  },\n  cartId: {\n    type: ObjectId,\n    ref: \"Carts\"\n  },\n  price: {\n    type: Number\n  },\n  itemId: {\n    type: ObjectId,\n    ref: \"Products\"\n  },\n  name: {\n    type: String\n  },\n  paidPrice: {\n    type: Number\n  }\n});\nconst DisApprovalOrders = _mongoose.default.model(\"DisApprovalOrders\", DisApprovalOrdersSchema);\nvar _default = exports.default = DisApprovalOrders;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIlNjaGVtYSIsIm1vbmdvb3NlIiwiT2JqZWN0SWQiLCJUeXBlcyIsIkRpc0FwcHJvdmFsT3JkZXJzU2NoZW1hIiwicGF5bWVudFRyYW5zYWN0aW9uSWQiLCJ0eXBlIiwiU3RyaW5nIiwiY2FydElkIiwicmVmIiwicHJpY2UiLCJOdW1iZXIiLCJpdGVtSWQiLCJuYW1lIiwicGFpZFByaWNlIiwiRGlzQXBwcm92YWxPcmRlcnMiLCJtb2RlbCIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL2RiLyIsInNvdXJjZXMiOlsiZGlzYXBwcm92YWwtb3JkZXJzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSBmcm9tIFwibW9uZ29vc2VcIjtcblxuY29uc3QgU2NoZW1hID0gbW9uZ29vc2UuU2NoZW1hO1xuY29uc3QgeyBPYmplY3RJZCB9ID0gU2NoZW1hLlR5cGVzO1xuXG5jb25zdCBEaXNBcHByb3ZhbE9yZGVyc1NjaGVtYSA9IG5ldyBTY2hlbWEoe1xuICBwYXltZW50VHJhbnNhY3Rpb25JZDoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgfSxcbiAgY2FydElkOiB7XG4gICAgdHlwZTogT2JqZWN0SWQsXG4gICAgcmVmOiBcIkNhcnRzXCIsXG4gIH0sXG4gIHByaWNlOiB7XG4gICAgdHlwZTogTnVtYmVyLFxuICB9LFxuICBpdGVtSWQ6IHtcbiAgICB0eXBlOiBPYmplY3RJZCxcbiAgICByZWY6IFwiUHJvZHVjdHNcIixcbiAgfSxcbiAgbmFtZToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgfSxcbiAgcGFpZFByaWNlOiB7XG4gICAgdHlwZTogTnVtYmVyLFxuICB9LFxufSk7XG5cbmNvbnN0IERpc0FwcHJvdmFsT3JkZXJzID0gbW9uZ29vc2UubW9kZWwoXG4gIFwiRGlzQXBwcm92YWxPcmRlcnNcIixcbiAgRGlzQXBwcm92YWxPcmRlcnNTY2hlbWFcbik7XG5cbmV4cG9ydCBkZWZhdWx0IERpc0FwcHJvdmFsT3JkZXJzO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxTQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFBZ0MsU0FBQUQsdUJBQUFFLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFaEMsTUFBTUcsTUFBTSxHQUFHQyxpQkFBUSxDQUFDRCxNQUFNO0FBQzlCLE1BQU07RUFBRUU7QUFBUyxDQUFDLEdBQUdGLE1BQU0sQ0FBQ0csS0FBSztBQUVqQyxNQUFNQyx1QkFBdUIsR0FBRyxJQUFJSixNQUFNLENBQUM7RUFDekNLLG9CQUFvQixFQUFFO0lBQ3BCQyxJQUFJLEVBQUVDO0VBQ1IsQ0FBQztFQUNEQyxNQUFNLEVBQUU7SUFDTkYsSUFBSSxFQUFFSixRQUFRO0lBQ2RPLEdBQUcsRUFBRTtFQUNQLENBQUM7RUFDREMsS0FBSyxFQUFFO0lBQ0xKLElBQUksRUFBRUs7RUFDUixDQUFDO0VBQ0RDLE1BQU0sRUFBRTtJQUNOTixJQUFJLEVBQUVKLFFBQVE7SUFDZE8sR0FBRyxFQUFFO0VBQ1AsQ0FBQztFQUNESSxJQUFJLEVBQUU7SUFDSlAsSUFBSSxFQUFFQztFQUNSLENBQUM7RUFDRE8sU0FBUyxFQUFFO0lBQ1RSLElBQUksRUFBRUs7RUFDUjtBQUNGLENBQUMsQ0FBQztBQUVGLE1BQU1JLGlCQUFpQixHQUFHZCxpQkFBUSxDQUFDZSxLQUFLLENBQ3RDLG1CQUFtQixFQUNuQlosdUJBQ0YsQ0FBQztBQUFDLElBQUFhLFFBQUEsR0FBQUMsT0FBQSxDQUFBbkIsT0FBQSxHQUVhZ0IsaUJBQWlCIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","e","__esModule","default","Schema","mongoose","ObjectId","Types","DisApprovalOrdersSchema","paymentTransactionId","type","String","cartId","ref","price","Number","itemId","name","paidPrice","DisApprovalOrders","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["disapproval-orders.js"],"sourcesContent":["import mongoose from \"mongoose\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\n\nconst DisApprovalOrdersSchema = new Schema({\n  paymentTransactionId: {\n    type: String,\n  },\n  cartId: {\n    type: ObjectId,\n    ref: \"Carts\",\n  },\n  price: {\n    type: Number,\n  },\n  itemId: {\n    type: ObjectId,\n    ref: \"Products\",\n  },\n  name: {\n    type: String,\n  },\n  paidPrice: {\n    type: Number,\n  },\n});\n\nconst DisApprovalOrders = mongoose.model(\n  \"DisApprovalOrders\",\n  DisApprovalOrdersSchema\n);\n\nexport default DisApprovalOrders;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AAAgC,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEhC,MAAMG,MAAM,GAAGC,iBAAQ,CAACD,MAAM;AAC9B,MAAM;EAAEE;AAAS,CAAC,GAAGF,MAAM,CAACG,KAAK;AAEjC,MAAMC,uBAAuB,GAAG,IAAIJ,MAAM,CAAC;EACzCK,oBAAoB,EAAE;IACpBC,IAAI,EAAEC;EACR,CAAC;EACDC,MAAM,EAAE;IACNF,IAAI,EAAEJ,QAAQ;IACdO,GAAG,EAAE;EACP,CAAC;EACDC,KAAK,EAAE;IACLJ,IAAI,EAAEK;EACR,CAAC;EACDC,MAAM,EAAE;IACNN,IAAI,EAAEJ,QAAQ;IACdO,GAAG,EAAE;EACP,CAAC;EACDI,IAAI,EAAE;IACJP,IAAI,EAAEC;EACR,CAAC;EACDO,SAAS,EAAE;IACTR,IAAI,EAAEK;EACR;AACF,CAAC,CAAC;AAEF,MAAMI,iBAAiB,GAAGd,iBAAQ,CAACe,KAAK,CACtC,mBAAmB,EACnBZ,uBACF,CAAC;AAAC,IAAAa,QAAA,GAAAC,OAAA,CAAAnB,OAAA,GAEagB,iBAAiB","ignoreList":[]}},"mtime":1731495253805},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/disapproval-orders.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst DisApprovalOrdersSchema = new Schema({\n  paymentTransactionId: {\n    type: String\n  },\n  cartId: {\n    type: ObjectId,\n    ref: \"Carts\"\n  },\n  price: {\n    type: Number\n  },\n  itemId: {\n    type: ObjectId,\n    ref: \"Products\"\n  },\n  name: {\n    type: String\n  },\n  paidPrice: {\n    type: Number\n  }\n});\nconst DisApprovalOrders = _mongoose.default.model(\"DisApprovalOrders\", DisApprovalOrdersSchema);\nvar _default = exports.default = DisApprovalOrders;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIlNjaGVtYSIsIm1vbmdvb3NlIiwiT2JqZWN0SWQiLCJUeXBlcyIsIkRpc0FwcHJvdmFsT3JkZXJzU2NoZW1hIiwicGF5bWVudFRyYW5zYWN0aW9uSWQiLCJ0eXBlIiwiU3RyaW5nIiwiY2FydElkIiwicmVmIiwicHJpY2UiLCJOdW1iZXIiLCJpdGVtSWQiLCJuYW1lIiwicGFpZFByaWNlIiwiRGlzQXBwcm92YWxPcmRlcnMiLCJtb2RlbCIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL2RiLyIsInNvdXJjZXMiOlsiZGlzYXBwcm92YWwtb3JkZXJzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBtb25nb29zZSBmcm9tIFwibW9uZ29vc2VcIjtcblxuY29uc3QgU2NoZW1hID0gbW9uZ29vc2UuU2NoZW1hO1xuY29uc3QgeyBPYmplY3RJZCB9ID0gU2NoZW1hLlR5cGVzO1xuXG5jb25zdCBEaXNBcHByb3ZhbE9yZGVyc1NjaGVtYSA9IG5ldyBTY2hlbWEoe1xuICBwYXltZW50VHJhbnNhY3Rpb25JZDoge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgfSxcbiAgY2FydElkOiB7XG4gICAgdHlwZTogT2JqZWN0SWQsXG4gICAgcmVmOiBcIkNhcnRzXCIsXG4gIH0sXG4gIHByaWNlOiB7XG4gICAgdHlwZTogTnVtYmVyLFxuICB9LFxuICBpdGVtSWQ6IHtcbiAgICB0eXBlOiBPYmplY3RJZCxcbiAgICByZWY6IFwiUHJvZHVjdHNcIixcbiAgfSxcbiAgbmFtZToge1xuICAgIHR5cGU6IFN0cmluZyxcbiAgfSxcbiAgcGFpZFByaWNlOiB7XG4gICAgdHlwZTogTnVtYmVyLFxuICB9LFxufSk7XG5cbmNvbnN0IERpc0FwcHJvdmFsT3JkZXJzID0gbW9uZ29vc2UubW9kZWwoXG4gIFwiRGlzQXBwcm92YWxPcmRlcnNcIixcbiAgRGlzQXBwcm92YWxPcmRlcnNTY2hlbWFcbik7XG5cbmV4cG9ydCBkZWZhdWx0IERpc0FwcHJvdmFsT3JkZXJzO1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxTQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFBZ0MsU0FBQUQsdUJBQUFFLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFFaEMsTUFBTUcsTUFBTSxHQUFHQyxpQkFBUSxDQUFDRCxNQUFNO0FBQzlCLE1BQU07RUFBRUU7QUFBUyxDQUFDLEdBQUdGLE1BQU0sQ0FBQ0csS0FBSztBQUVqQyxNQUFNQyx1QkFBdUIsR0FBRyxJQUFJSixNQUFNLENBQUM7RUFDekNLLG9CQUFvQixFQUFFO0lBQ3BCQyxJQUFJLEVBQUVDO0VBQ1IsQ0FBQztFQUNEQyxNQUFNLEVBQUU7SUFDTkYsSUFBSSxFQUFFSixRQUFRO0lBQ2RPLEdBQUcsRUFBRTtFQUNQLENBQUM7RUFDREMsS0FBSyxFQUFFO0lBQ0xKLElBQUksRUFBRUs7RUFDUixDQUFDO0VBQ0RDLE1BQU0sRUFBRTtJQUNOTixJQUFJLEVBQUVKLFFBQVE7SUFDZE8sR0FBRyxFQUFFO0VBQ1AsQ0FBQztFQUNESSxJQUFJLEVBQUU7SUFDSlAsSUFBSSxFQUFFQztFQUNSLENBQUM7RUFDRE8sU0FBUyxFQUFFO0lBQ1RSLElBQUksRUFBRUs7RUFDUjtBQUNGLENBQUMsQ0FBQztBQUVGLE1BQU1JLGlCQUFpQixHQUFHZCxpQkFBUSxDQUFDZSxLQUFLLENBQ3RDLG1CQUFtQixFQUNuQlosdUJBQ0YsQ0FBQztBQUFDLElBQUFhLFFBQUEsR0FBQUMsT0FBQSxDQUFBbkIsT0FBQSxHQUVhZ0IsaUJBQWlCIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","e","__esModule","default","Schema","mongoose","ObjectId","Types","DisApprovalOrdersSchema","paymentTransactionId","type","String","cartId","ref","price","Number","itemId","name","paidPrice","DisApprovalOrders","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["disapproval-orders.js"],"sourcesContent":["import mongoose from \"mongoose\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\n\nconst DisApprovalOrdersSchema = new Schema({\n  paymentTransactionId: {\n    type: String,\n  },\n  cartId: {\n    type: ObjectId,\n    ref: \"Carts\",\n  },\n  price: {\n    type: Number,\n  },\n  itemId: {\n    type: ObjectId,\n    ref: \"Products\",\n  },\n  name: {\n    type: String,\n  },\n  paidPrice: {\n    type: Number,\n  },\n});\n\nconst DisApprovalOrders = mongoose.model(\n  \"DisApprovalOrders\",\n  DisApprovalOrdersSchema\n);\n\nexport default DisApprovalOrders;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AAAgC,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEhC,MAAMG,MAAM,GAAGC,iBAAQ,CAACD,MAAM;AAC9B,MAAM;EAAEE;AAAS,CAAC,GAAGF,MAAM,CAACG,KAAK;AAEjC,MAAMC,uBAAuB,GAAG,IAAIJ,MAAM,CAAC;EACzCK,oBAAoB,EAAE;IACpBC,IAAI,EAAEC;EACR,CAAC;EACDC,MAAM,EAAE;IACNF,IAAI,EAAEJ,QAAQ;IACdO,GAAG,EAAE;EACP,CAAC;EACDC,KAAK,EAAE;IACLJ,IAAI,EAAEK;EACR,CAAC;EACDC,MAAM,EAAE;IACNN,IAAI,EAAEJ,QAAQ;IACdO,GAAG,EAAE;EACP,CAAC;EACDI,IAAI,EAAE;IACJP,IAAI,EAAEC;EACR,CAAC;EACDO,SAAS,EAAE;IACTR,IAAI,EAAEK;EACR;AACF,CAAC,CAAC;AAEF,MAAMI,iBAAiB,GAAGd,iBAAQ,CAACe,KAAK,CACtC,mBAAmB,EACnBZ,uBACF,CAAC;AAAC,IAAAa,QAAA,GAAAC,OAAA,CAAAnB,OAAA,GAEagB,iBAAiB","ignoreList":[]}},"mtime":1731495253805},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/comments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst commentSchema = new _mongoose.default.Schema({\n  productId: {\n    type: ObjectId,\n    ref: \"Products\",\n    required: true\n  },\n  userId: {\n    type: ObjectId,\n    ref: \"Users\",\n    required: true\n  },\n  rating: {\n    type: Number,\n    min: 1,\n    max: 5,\n    required: true\n  },\n  comment: {\n    type: String,\n    maxLength: 500\n  },\n  createdAt: {\n    type: Date,\n    default: Date.now\n  },\n  updatedAt: {\n    type: Date\n  }\n}, {\n  _id: true,\n  collection: \"comments\",\n  timestamps: true,\n  toJSON: {\n    transform: (doc, ret) => {\n      delete ret.__v;\n      return {\n        ...ret\n      };\n    }\n  }\n});\nconst Comments = _mongoose.default.model(\"CommentSchema\", commentSchema);\nvar _default = exports.default = Comments;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIlNjaGVtYSIsIm1vbmdvb3NlIiwiT2JqZWN0SWQiLCJUeXBlcyIsImNvbW1lbnRTY2hlbWEiLCJwcm9kdWN0SWQiLCJ0eXBlIiwicmVmIiwicmVxdWlyZWQiLCJ1c2VySWQiLCJyYXRpbmciLCJOdW1iZXIiLCJtaW4iLCJtYXgiLCJjb21tZW50IiwiU3RyaW5nIiwibWF4TGVuZ3RoIiwiY3JlYXRlZEF0IiwiRGF0ZSIsIm5vdyIsInVwZGF0ZWRBdCIsIl9pZCIsImNvbGxlY3Rpb24iLCJ0aW1lc3RhbXBzIiwidG9KU09OIiwidHJhbnNmb3JtIiwiZG9jIiwicmV0IiwiX192IiwiQ29tbWVudHMiLCJtb2RlbCIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL2RiLyIsInNvdXJjZXMiOlsiY29tbWVudHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlIGZyb20gXCJtb25nb29zZVwiO1xuXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWE7XG5jb25zdCB7IE9iamVjdElkIH0gPSBTY2hlbWEuVHlwZXM7XG5cbmNvbnN0IGNvbW1lbnRTY2hlbWEgPSBuZXcgbW9uZ29vc2UuU2NoZW1hKFxuICB7XG4gICAgcHJvZHVjdElkOiB7XG4gICAgICB0eXBlOiBPYmplY3RJZCxcbiAgICAgIHJlZjogXCJQcm9kdWN0c1wiLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICB1c2VySWQ6IHtcbiAgICAgIHR5cGU6IE9iamVjdElkLFxuICAgICAgcmVmOiBcIlVzZXJzXCIsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIHJhdGluZzoge1xuICAgICAgdHlwZTogTnVtYmVyLFxuICAgICAgbWluOiAxLFxuICAgICAgbWF4OiA1LFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBjb21tZW50OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICBtYXhMZW5ndGg6IDUwMCxcbiAgICB9LFxuICAgIGNyZWF0ZWRBdDoge1xuICAgICAgdHlwZTogRGF0ZSxcbiAgICAgIGRlZmF1bHQ6IERhdGUubm93LFxuICAgIH0sXG4gICAgdXBkYXRlZEF0OiB7XG4gICAgICB0eXBlOiBEYXRlLFxuICAgIH0sXG4gIH0sXG4gIHtcbiAgICBfaWQ6IHRydWUsXG4gICAgY29sbGVjdGlvbjogXCJjb21tZW50c1wiLFxuICAgIHRpbWVzdGFtcHM6IHRydWUsXG4gICAgdG9KU09OOiB7XG4gICAgICB0cmFuc2Zvcm06IChkb2MsIHJldCkgPT4ge1xuICAgICAgICBkZWxldGUgcmV0Ll9fdjtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAuLi5yZXQsXG4gICAgICAgIH07XG4gICAgICB9LFxuICAgIH0sXG4gIH1cbik7XG5cbmNvbnN0IENvbW1lbnRzID0gbW9uZ29vc2UubW9kZWwoXCJDb21tZW50U2NoZW1hXCIsIGNvbW1lbnRTY2hlbWEpO1xuZXhwb3J0IGRlZmF1bHQgQ29tbWVudHM7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUFnQyxTQUFBRCx1QkFBQUUsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUVoQyxNQUFNRyxNQUFNLEdBQUdDLGlCQUFRLENBQUNELE1BQU07QUFDOUIsTUFBTTtFQUFFRTtBQUFTLENBQUMsR0FBR0YsTUFBTSxDQUFDRyxLQUFLO0FBRWpDLE1BQU1DLGFBQWEsR0FBRyxJQUFJSCxpQkFBUSxDQUFDRCxNQUFNLENBQ3ZDO0VBQ0VLLFNBQVMsRUFBRTtJQUNUQyxJQUFJLEVBQUVKLFFBQVE7SUFDZEssR0FBRyxFQUFFLFVBQVU7SUFDZkMsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNEQyxNQUFNLEVBQUU7SUFDTkgsSUFBSSxFQUFFSixRQUFRO0lBQ2RLLEdBQUcsRUFBRSxPQUFPO0lBQ1pDLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDREUsTUFBTSxFQUFFO0lBQ05KLElBQUksRUFBRUssTUFBTTtJQUNaQyxHQUFHLEVBQUUsQ0FBQztJQUNOQyxHQUFHLEVBQUUsQ0FBQztJQUNOTCxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RNLE9BQU8sRUFBRTtJQUNQUixJQUFJLEVBQUVTLE1BQU07SUFDWkMsU0FBUyxFQUFFO0VBQ2IsQ0FBQztFQUNEQyxTQUFTLEVBQUU7SUFDVFgsSUFBSSxFQUFFWSxJQUFJO0lBQ1ZuQixPQUFPLEVBQUVtQixJQUFJLENBQUNDO0VBQ2hCLENBQUM7RUFDREMsU0FBUyxFQUFFO0lBQ1RkLElBQUksRUFBRVk7RUFDUjtBQUNGLENBQUMsRUFDRDtFQUNFRyxHQUFHLEVBQUUsSUFBSTtFQUNUQyxVQUFVLEVBQUUsVUFBVTtFQUN0QkMsVUFBVSxFQUFFLElBQUk7RUFDaEJDLE1BQU0sRUFBRTtJQUNOQyxTQUFTLEVBQUVBLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxLQUFLO01BQ3ZCLE9BQU9BLEdBQUcsQ0FBQ0MsR0FBRztNQUNkLE9BQU87UUFDTCxHQUFHRDtNQUNMLENBQUM7SUFDSDtFQUNGO0FBQ0YsQ0FDRixDQUFDO0FBRUQsTUFBTUUsUUFBUSxHQUFHNUIsaUJBQVEsQ0FBQzZCLEtBQUssQ0FBQyxlQUFlLEVBQUUxQixhQUFhLENBQUM7QUFBQyxJQUFBMkIsUUFBQSxHQUFBQyxPQUFBLENBQUFqQyxPQUFBLEdBQ2pEOEIsUUFBUSIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","e","__esModule","default","Schema","mongoose","ObjectId","Types","commentSchema","productId","type","ref","required","userId","rating","Number","min","max","comment","String","maxLength","createdAt","Date","now","updatedAt","_id","collection","timestamps","toJSON","transform","doc","ret","__v","Comments","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["comments.js"],"sourcesContent":["import mongoose from \"mongoose\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\n\nconst commentSchema = new mongoose.Schema(\n  {\n    productId: {\n      type: ObjectId,\n      ref: \"Products\",\n      required: true,\n    },\n    userId: {\n      type: ObjectId,\n      ref: \"Users\",\n      required: true,\n    },\n    rating: {\n      type: Number,\n      min: 1,\n      max: 5,\n      required: true,\n    },\n    comment: {\n      type: String,\n      maxLength: 500,\n    },\n    createdAt: {\n      type: Date,\n      default: Date.now,\n    },\n    updatedAt: {\n      type: Date,\n    },\n  },\n  {\n    _id: true,\n    collection: \"comments\",\n    timestamps: true,\n    toJSON: {\n      transform: (doc, ret) => {\n        delete ret.__v;\n        return {\n          ...ret,\n        };\n      },\n    },\n  }\n);\n\nconst Comments = mongoose.model(\"CommentSchema\", commentSchema);\nexport default Comments;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AAAgC,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEhC,MAAMG,MAAM,GAAGC,iBAAQ,CAACD,MAAM;AAC9B,MAAM;EAAEE;AAAS,CAAC,GAAGF,MAAM,CAACG,KAAK;AAEjC,MAAMC,aAAa,GAAG,IAAIH,iBAAQ,CAACD,MAAM,CACvC;EACEK,SAAS,EAAE;IACTC,IAAI,EAAEJ,QAAQ;IACdK,GAAG,EAAE,UAAU;IACfC,QAAQ,EAAE;EACZ,CAAC;EACDC,MAAM,EAAE;IACNH,IAAI,EAAEJ,QAAQ;IACdK,GAAG,EAAE,OAAO;IACZC,QAAQ,EAAE;EACZ,CAAC;EACDE,MAAM,EAAE;IACNJ,IAAI,EAAEK,MAAM;IACZC,GAAG,EAAE,CAAC;IACNC,GAAG,EAAE,CAAC;IACNL,QAAQ,EAAE;EACZ,CAAC;EACDM,OAAO,EAAE;IACPR,IAAI,EAAES,MAAM;IACZC,SAAS,EAAE;EACb,CAAC;EACDC,SAAS,EAAE;IACTX,IAAI,EAAEY,IAAI;IACVnB,OAAO,EAAEmB,IAAI,CAACC;EAChB,CAAC;EACDC,SAAS,EAAE;IACTd,IAAI,EAAEY;EACR;AACF,CAAC,EACD;EACEG,GAAG,EAAE,IAAI;EACTC,UAAU,EAAE,UAAU;EACtBC,UAAU,EAAE,IAAI;EAChBC,MAAM,EAAE;IACNC,SAAS,EAAEA,CAACC,GAAG,EAAEC,GAAG,KAAK;MACvB,OAAOA,GAAG,CAACC,GAAG;MACd,OAAO;QACL,GAAGD;MACL,CAAC;IACH;EACF;AACF,CACF,CAAC;AAED,MAAME,QAAQ,GAAG5B,iBAAQ,CAAC6B,KAAK,CAAC,eAAe,EAAE1B,aAAa,CAAC;AAAC,IAAA2B,QAAA,GAAAC,OAAA,CAAAjC,OAAA,GACjD8B,QAAQ","ignoreList":[]}},"mtime":1734704511971},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/comments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _mongoose = _interopRequireDefault(require(\"mongoose\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst Schema = _mongoose.default.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst commentSchema = new _mongoose.default.Schema({\n  productId: {\n    type: ObjectId,\n    ref: \"Products\",\n    required: true\n  },\n  userId: {\n    type: ObjectId,\n    ref: \"Users\",\n    required: true\n  },\n  rating: {\n    type: Number,\n    min: 1,\n    max: 5,\n    required: true\n  },\n  comment: {\n    type: String,\n    maxLength: 500\n  },\n  createdAt: {\n    type: Date,\n    default: Date.now\n  },\n  updatedAt: {\n    type: Date\n  }\n}, {\n  _id: true,\n  collection: \"comments\",\n  timestamps: true,\n  toJSON: {\n    transform: (doc, ret) => {\n      delete ret.__v;\n      return {\n        ...ret\n      };\n    }\n  }\n});\nconst Comments = _mongoose.default.model(\"CommentSchema\", commentSchema);\nvar _default = exports.default = Comments;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbW9uZ29vc2UiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsImUiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsIlNjaGVtYSIsIm1vbmdvb3NlIiwiT2JqZWN0SWQiLCJUeXBlcyIsImNvbW1lbnRTY2hlbWEiLCJwcm9kdWN0SWQiLCJ0eXBlIiwicmVmIiwicmVxdWlyZWQiLCJ1c2VySWQiLCJyYXRpbmciLCJOdW1iZXIiLCJtaW4iLCJtYXgiLCJjb21tZW50IiwiU3RyaW5nIiwibWF4TGVuZ3RoIiwiY3JlYXRlZEF0IiwiRGF0ZSIsIm5vdyIsInVwZGF0ZWRBdCIsIl9pZCIsImNvbGxlY3Rpb24iLCJ0aW1lc3RhbXBzIiwidG9KU09OIiwidHJhbnNmb3JtIiwiZG9jIiwicmV0IiwiX192IiwiQ29tbWVudHMiLCJtb2RlbCIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL2RiLyIsInNvdXJjZXMiOlsiY29tbWVudHMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG1vbmdvb3NlIGZyb20gXCJtb25nb29zZVwiO1xuXG5jb25zdCBTY2hlbWEgPSBtb25nb29zZS5TY2hlbWE7XG5jb25zdCB7IE9iamVjdElkIH0gPSBTY2hlbWEuVHlwZXM7XG5cbmNvbnN0IGNvbW1lbnRTY2hlbWEgPSBuZXcgbW9uZ29vc2UuU2NoZW1hKFxuICB7XG4gICAgcHJvZHVjdElkOiB7XG4gICAgICB0eXBlOiBPYmplY3RJZCxcbiAgICAgIHJlZjogXCJQcm9kdWN0c1wiLFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICB1c2VySWQ6IHtcbiAgICAgIHR5cGU6IE9iamVjdElkLFxuICAgICAgcmVmOiBcIlVzZXJzXCIsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIHJhdGluZzoge1xuICAgICAgdHlwZTogTnVtYmVyLFxuICAgICAgbWluOiAxLFxuICAgICAgbWF4OiA1LFxuICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgfSxcbiAgICBjb21tZW50OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICBtYXhMZW5ndGg6IDUwMCxcbiAgICB9LFxuICAgIGNyZWF0ZWRBdDoge1xuICAgICAgdHlwZTogRGF0ZSxcbiAgICAgIGRlZmF1bHQ6IERhdGUubm93LFxuICAgIH0sXG4gICAgdXBkYXRlZEF0OiB7XG4gICAgICB0eXBlOiBEYXRlLFxuICAgIH0sXG4gIH0sXG4gIHtcbiAgICBfaWQ6IHRydWUsXG4gICAgY29sbGVjdGlvbjogXCJjb21tZW50c1wiLFxuICAgIHRpbWVzdGFtcHM6IHRydWUsXG4gICAgdG9KU09OOiB7XG4gICAgICB0cmFuc2Zvcm06IChkb2MsIHJldCkgPT4ge1xuICAgICAgICBkZWxldGUgcmV0Ll9fdjtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAuLi5yZXQsXG4gICAgICAgIH07XG4gICAgICB9LFxuICAgIH0sXG4gIH1cbik7XG5cbmNvbnN0IENvbW1lbnRzID0gbW9uZ29vc2UubW9kZWwoXCJDb21tZW50U2NoZW1hXCIsIGNvbW1lbnRTY2hlbWEpO1xuZXhwb3J0IGRlZmF1bHQgQ29tbWVudHM7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUFnQyxTQUFBRCx1QkFBQUUsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUVoQyxNQUFNRyxNQUFNLEdBQUdDLGlCQUFRLENBQUNELE1BQU07QUFDOUIsTUFBTTtFQUFFRTtBQUFTLENBQUMsR0FBR0YsTUFBTSxDQUFDRyxLQUFLO0FBRWpDLE1BQU1DLGFBQWEsR0FBRyxJQUFJSCxpQkFBUSxDQUFDRCxNQUFNLENBQ3ZDO0VBQ0VLLFNBQVMsRUFBRTtJQUNUQyxJQUFJLEVBQUVKLFFBQVE7SUFDZEssR0FBRyxFQUFFLFVBQVU7SUFDZkMsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNEQyxNQUFNLEVBQUU7SUFDTkgsSUFBSSxFQUFFSixRQUFRO0lBQ2RLLEdBQUcsRUFBRSxPQUFPO0lBQ1pDLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDREUsTUFBTSxFQUFFO0lBQ05KLElBQUksRUFBRUssTUFBTTtJQUNaQyxHQUFHLEVBQUUsQ0FBQztJQUNOQyxHQUFHLEVBQUUsQ0FBQztJQUNOTCxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RNLE9BQU8sRUFBRTtJQUNQUixJQUFJLEVBQUVTLE1BQU07SUFDWkMsU0FBUyxFQUFFO0VBQ2IsQ0FBQztFQUNEQyxTQUFTLEVBQUU7SUFDVFgsSUFBSSxFQUFFWSxJQUFJO0lBQ1ZuQixPQUFPLEVBQUVtQixJQUFJLENBQUNDO0VBQ2hCLENBQUM7RUFDREMsU0FBUyxFQUFFO0lBQ1RkLElBQUksRUFBRVk7RUFDUjtBQUNGLENBQUMsRUFDRDtFQUNFRyxHQUFHLEVBQUUsSUFBSTtFQUNUQyxVQUFVLEVBQUUsVUFBVTtFQUN0QkMsVUFBVSxFQUFFLElBQUk7RUFDaEJDLE1BQU0sRUFBRTtJQUNOQyxTQUFTLEVBQUVBLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxLQUFLO01BQ3ZCLE9BQU9BLEdBQUcsQ0FBQ0MsR0FBRztNQUNkLE9BQU87UUFDTCxHQUFHRDtNQUNMLENBQUM7SUFDSDtFQUNGO0FBQ0YsQ0FDRixDQUFDO0FBRUQsTUFBTUUsUUFBUSxHQUFHNUIsaUJBQVEsQ0FBQzZCLEtBQUssQ0FBQyxlQUFlLEVBQUUxQixhQUFhLENBQUM7QUFBQyxJQUFBMkIsUUFBQSxHQUFBQyxPQUFBLENBQUFqQyxPQUFBLEdBQ2pEOEIsUUFBUSIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_mongoose","_interopRequireDefault","require","e","__esModule","default","Schema","mongoose","ObjectId","Types","commentSchema","productId","type","ref","required","userId","rating","Number","min","max","comment","String","maxLength","createdAt","Date","now","updatedAt","_id","collection","timestamps","toJSON","transform","doc","ret","__v","Comments","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["comments.js"],"sourcesContent":["import mongoose from \"mongoose\";\n\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\n\nconst commentSchema = new mongoose.Schema(\n  {\n    productId: {\n      type: ObjectId,\n      ref: \"Products\",\n      required: true,\n    },\n    userId: {\n      type: ObjectId,\n      ref: \"Users\",\n      required: true,\n    },\n    rating: {\n      type: Number,\n      min: 1,\n      max: 5,\n      required: true,\n    },\n    comment: {\n      type: String,\n      maxLength: 500,\n    },\n    createdAt: {\n      type: Date,\n      default: Date.now,\n    },\n    updatedAt: {\n      type: Date,\n    },\n  },\n  {\n    _id: true,\n    collection: \"comments\",\n    timestamps: true,\n    toJSON: {\n      transform: (doc, ret) => {\n        delete ret.__v;\n        return {\n          ...ret,\n        };\n      },\n    },\n  }\n);\n\nconst Comments = mongoose.model(\"CommentSchema\", commentSchema);\nexport default Comments;\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AAAgC,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEhC,MAAMG,MAAM,GAAGC,iBAAQ,CAACD,MAAM;AAC9B,MAAM;EAAEE;AAAS,CAAC,GAAGF,MAAM,CAACG,KAAK;AAEjC,MAAMC,aAAa,GAAG,IAAIH,iBAAQ,CAACD,MAAM,CACvC;EACEK,SAAS,EAAE;IACTC,IAAI,EAAEJ,QAAQ;IACdK,GAAG,EAAE,UAAU;IACfC,QAAQ,EAAE;EACZ,CAAC;EACDC,MAAM,EAAE;IACNH,IAAI,EAAEJ,QAAQ;IACdK,GAAG,EAAE,OAAO;IACZC,QAAQ,EAAE;EACZ,CAAC;EACDE,MAAM,EAAE;IACNJ,IAAI,EAAEK,MAAM;IACZC,GAAG,EAAE,CAAC;IACNC,GAAG,EAAE,CAAC;IACNL,QAAQ,EAAE;EACZ,CAAC;EACDM,OAAO,EAAE;IACPR,IAAI,EAAES,MAAM;IACZC,SAAS,EAAE;EACb,CAAC;EACDC,SAAS,EAAE;IACTX,IAAI,EAAEY,IAAI;IACVnB,OAAO,EAAEmB,IAAI,CAACC;EAChB,CAAC;EACDC,SAAS,EAAE;IACTd,IAAI,EAAEY;EACR;AACF,CAAC,EACD;EACEG,GAAG,EAAE,IAAI;EACTC,UAAU,EAAE,UAAU;EACtBC,UAAU,EAAE,IAAI;EAChBC,MAAM,EAAE;IACNC,SAAS,EAAEA,CAACC,GAAG,EAAEC,GAAG,KAAK;MACvB,OAAOA,GAAG,CAACC,GAAG;MACd,OAAO;QACL,GAAGD;MACL,CAAC;IACH;EACF;AACF,CACF,CAAC;AAED,MAAME,QAAQ,GAAG5B,iBAAQ,CAAC6B,KAAK,CAAC,eAAe,EAAE1B,aAAa,CAAC;AAAC,IAAA2B,QAAA,GAAAC,OAAA,CAAAjC,OAAA,GACjD8B,QAAQ","ignoreList":[]}},"mtime":1734704511971},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/Comments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _comments = _interopRequireDefault(require(\"../db/comments\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _Permissions = require(\"../helpers/Permissions\");\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = router => {\n  router.post(\"/create-comment\", _Session.default, async (req, res) => {\n    (0, _Permissions.checkPermissions)(req.user, [\"user\"]);\n    try {\n      const {\n        productId,\n        rating,\n        comment\n      } = req.body;\n      const user = req.user._id;\n      const comments = new _comments.default({\n        userId: user,\n        comment,\n        rating,\n        productId: productId\n      });\n      await comments.save();\n      res.status(200).json(comments);\n    } catch (error) {\n      console.log(error);\n      throw new _ApiError.default(\"Comments could not sending\", 400, \"CouldNotSendingComments\");\n    }\n  });\n  router.get(\"/comments\", _Session.default, async (req, res) => {\n    (0, _Permissions.checkPermissions)(req.user, [\"user\"]);\n    try {\n      const {\n        productId,\n        userId\n      } = req.query;\n      const filter = {};\n\n      // productId varsa filtreye ekle\n      if (productId) {\n        filter.productId = productId;\n      }\n\n      // userId varsa filtreye ekle\n      if (userId) {\n        filter.userId = userId;\n      }\n      //   checkRequiredField(productId, \"Product Id\");\n\n      const comment = await _comments.default.find(filter).populate(\"userId\", \"name email\").sort({\n        createdAt: -1\n      });\n      res.status(200).json(comment);\n    } catch (error) {\n      console.log(error);\n      throw new _ApiError.default(\"Can not get Comments by productId\", 400, \"CanNotGetComments\");\n    }\n  });\n  router.delete(\"/delete-comment/:id\", _Session.default, async (req, res) => {\n    const id = req.params.id;\n    try {\n      const comment = await _comments.default.findOneAndDelete({\n        _id: id\n      });\n      // checkCommentOwnerShip(req.user, comment);\n      if (!comment) {\n        throw new _ApiError.default(\"It was already deleted\", 400, \"AlreadyDeleted\");\n      }\n      if (comment) {\n        res.status(200).json(`Comment number ${id} was deleted`);\n      } else {\n        res.status(404).json(`Product with ID ${id} not found`);\n      }\n    } catch (error) {\n      console.log(error);\n      throw new _ApiError.default(\"Cannot delete comment\", 400, \"CanNotDeleteComment\");\n    }\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfY29tbWVudHMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9BcGlFcnJvciIsIl9QZXJtaXNzaW9ucyIsIl9TZXNzaW9uIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiX2RlZmF1bHQiLCJyb3V0ZXIiLCJwb3N0IiwiU2Vzc2lvbiIsInJlcSIsInJlcyIsImNoZWNrUGVybWlzc2lvbnMiLCJ1c2VyIiwicHJvZHVjdElkIiwicmF0aW5nIiwiY29tbWVudCIsImJvZHkiLCJfaWQiLCJjb21tZW50cyIsIkNvbW1lbnRzIiwidXNlcklkIiwic2F2ZSIsInN0YXR1cyIsImpzb24iLCJlcnJvciIsImNvbnNvbGUiLCJsb2ciLCJBcGlFcnJvciIsImdldCIsInF1ZXJ5IiwiZmlsdGVyIiwiZmluZCIsInBvcHVsYXRlIiwic29ydCIsImNyZWF0ZWRBdCIsImRlbGV0ZSIsImlkIiwicGFyYW1zIiwiZmluZE9uZUFuZERlbGV0ZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9yb3V0ZXMvIiwic291cmNlcyI6WyJDb21tZW50cy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgQ29tbWVudHMgZnJvbSBcIi4uL2RiL2NvbW1lbnRzXCI7XG5pbXBvcnQgQXBpRXJyb3IgZnJvbSBcIi4uL2Vycm9ycy9BcGlFcnJvclwiO1xuaW1wb3J0IHsgY2hlY2tQZXJtaXNzaW9ucyB9IGZyb20gXCIuLi9oZWxwZXJzL1Blcm1pc3Npb25zXCI7XG5pbXBvcnQgU2Vzc2lvbiBmcm9tIFwiLi4vbWlkZGxld2FyZXMvU2Vzc2lvblwiO1xuXG5leHBvcnQgZGVmYXVsdCAocm91dGVyKSA9PiB7XG4gIHJvdXRlci5wb3N0KFwiL2NyZWF0ZS1jb21tZW50XCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGNoZWNrUGVybWlzc2lvbnMocmVxLnVzZXIsIFtcInVzZXJcIl0pO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IHByb2R1Y3RJZCwgcmF0aW5nLCBjb21tZW50IH0gPSByZXEuYm9keTtcbiAgICAgIGNvbnN0IHVzZXIgPSByZXEudXNlci5faWQ7XG5cbiAgICAgIGNvbnN0IGNvbW1lbnRzID0gbmV3IENvbW1lbnRzKHtcbiAgICAgICAgdXNlcklkOiB1c2VyLFxuICAgICAgICBjb21tZW50LFxuICAgICAgICByYXRpbmcsXG4gICAgICAgIHByb2R1Y3RJZDogcHJvZHVjdElkLFxuICAgICAgfSk7XG4gICAgICBhd2FpdCBjb21tZW50cy5zYXZlKCk7XG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbihjb21tZW50cyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgXCJDb21tZW50cyBjb3VsZCBub3Qgc2VuZGluZ1wiLFxuICAgICAgICA0MDAsXG4gICAgICAgIFwiQ291bGROb3RTZW5kaW5nQ29tbWVudHNcIlxuICAgICAgKTtcbiAgICB9XG4gIH0pO1xuICByb3V0ZXIuZ2V0KFwiL2NvbW1lbnRzXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGNoZWNrUGVybWlzc2lvbnMocmVxLnVzZXIsIFtcInVzZXJcIl0pO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IHByb2R1Y3RJZCwgdXNlcklkIH0gPSByZXEucXVlcnk7XG4gICAgICBjb25zdCBmaWx0ZXIgPSB7fTtcblxuICAgICAgLy8gcHJvZHVjdElkIHZhcnNhIGZpbHRyZXllIGVrbGVcbiAgICAgIGlmIChwcm9kdWN0SWQpIHtcbiAgICAgICAgZmlsdGVyLnByb2R1Y3RJZCA9IHByb2R1Y3RJZDtcbiAgICAgIH1cblxuICAgICAgLy8gdXNlcklkIHZhcnNhIGZpbHRyZXllIGVrbGVcbiAgICAgIGlmICh1c2VySWQpIHtcbiAgICAgICAgZmlsdGVyLnVzZXJJZCA9IHVzZXJJZDtcbiAgICAgIH1cbiAgICAgIC8vICAgY2hlY2tSZXF1aXJlZEZpZWxkKHByb2R1Y3RJZCwgXCJQcm9kdWN0IElkXCIpO1xuXG4gICAgICBjb25zdCBjb21tZW50ID0gYXdhaXQgQ29tbWVudHMuZmluZChmaWx0ZXIpXG4gICAgICAgIC5wb3B1bGF0ZShcInVzZXJJZFwiLCBcIm5hbWUgZW1haWxcIilcbiAgICAgICAgLnNvcnQoeyBjcmVhdGVkQXQ6IC0xIH0pO1xuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oY29tbWVudCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgXCJDYW4gbm90IGdldCBDb21tZW50cyBieSBwcm9kdWN0SWRcIixcbiAgICAgICAgNDAwLFxuICAgICAgICBcIkNhbk5vdEdldENvbW1lbnRzXCJcbiAgICAgICk7XG4gICAgfVxuICB9KTtcbiAgcm91dGVyLmRlbGV0ZShcIi9kZWxldGUtY29tbWVudC86aWRcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgaWQgPSByZXEucGFyYW1zLmlkO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBjb21tZW50ID0gYXdhaXQgQ29tbWVudHMuZmluZE9uZUFuZERlbGV0ZSh7IF9pZDogaWQgfSk7XG4gICAgICAvLyBjaGVja0NvbW1lbnRPd25lclNoaXAocmVxLnVzZXIsIGNvbW1lbnQpO1xuICAgICAgaWYgKCFjb21tZW50KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkl0IHdhcyBhbHJlYWR5IGRlbGV0ZWRcIiwgNDAwLCBcIkFscmVhZHlEZWxldGVkXCIpO1xuICAgICAgfVxuICAgICAgaWYgKGNvbW1lbnQpIHtcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oYENvbW1lbnQgbnVtYmVyICR7aWR9IHdhcyBkZWxldGVkYCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXMuc3RhdHVzKDQwNCkuanNvbihgUHJvZHVjdCB3aXRoIElEICR7aWR9IG5vdCBmb3VuZGApO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYW5ub3QgZGVsZXRlIGNvbW1lbnRcIiwgNDAwLCBcIkNhbk5vdERlbGV0ZUNvbW1lbnRcIik7XG4gICAgfVxuICB9KTtcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFNBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLFNBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFFLFlBQUEsR0FBQUYsT0FBQTtBQUNBLElBQUFHLFFBQUEsR0FBQUosc0JBQUEsQ0FBQUMsT0FBQTtBQUE2QyxTQUFBRCx1QkFBQUssQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUFBLElBQUFHLFFBQUEsR0FFN0JDLE1BQU0sSUFBSztFQUN6QkEsTUFBTSxDQUFDQyxJQUFJLENBQUMsaUJBQWlCLEVBQUVDLGdCQUFPLEVBQUUsT0FBT0MsR0FBRyxFQUFFQyxHQUFHLEtBQUs7SUFDMUQsSUFBQUMsNkJBQWdCLEVBQUNGLEdBQUcsQ0FBQ0csSUFBSSxFQUFFLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDcEMsSUFBSTtNQUNGLE1BQU07UUFBRUMsU0FBUztRQUFFQyxNQUFNO1FBQUVDO01BQVEsQ0FBQyxHQUFHTixHQUFHLENBQUNPLElBQUk7TUFDL0MsTUFBTUosSUFBSSxHQUFHSCxHQUFHLENBQUNHLElBQUksQ0FBQ0ssR0FBRztNQUV6QixNQUFNQyxRQUFRLEdBQUcsSUFBSUMsaUJBQVEsQ0FBQztRQUM1QkMsTUFBTSxFQUFFUixJQUFJO1FBQ1pHLE9BQU87UUFDUEQsTUFBTTtRQUNORCxT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","map":{"version":3,"names":["_comments","_interopRequireDefault","require","_ApiError","_Permissions","_Session","e","__esModule","default","_default","router","post","Session","req","res","checkPermissions","user","productId","rating","comment","body","_id","comments","Comments","userId","save","status","json","error","console","log","ApiError","get","query","filter","find","populate","sort","createdAt","delete","id","params","findOneAndDelete","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["Comments.js"],"sourcesContent":["import Comments from \"../db/comments\";\nimport ApiError from \"../errors/ApiError\";\nimport { checkPermissions } from \"../helpers/Permissions\";\nimport Session from \"../middlewares/Session\";\n\nexport default (router) => {\n  router.post(\"/create-comment\", Session, async (req, res) => {\n    checkPermissions(req.user, [\"user\"]);\n    try {\n      const { productId, rating, comment } = req.body;\n      const user = req.user._id;\n\n      const comments = new Comments({\n        userId: user,\n        comment,\n        rating,\n        productId: productId,\n      });\n      await comments.save();\n      res.status(200).json(comments);\n    } catch (error) {\n      console.log(error);\n      throw new ApiError(\n        \"Comments could not sending\",\n        400,\n        \"CouldNotSendingComments\"\n      );\n    }\n  });\n  router.get(\"/comments\", Session, async (req, res) => {\n    checkPermissions(req.user, [\"user\"]);\n    try {\n      const { productId, userId } = req.query;\n      const filter = {};\n\n      // productId varsa filtreye ekle\n      if (productId) {\n        filter.productId = productId;\n      }\n\n      // userId varsa filtreye ekle\n      if (userId) {\n        filter.userId = userId;\n      }\n      //   checkRequiredField(productId, \"Product Id\");\n\n      const comment = await Comments.find(filter)\n        .populate(\"userId\", \"name email\")\n        .sort({ createdAt: -1 });\n      res.status(200).json(comment);\n    } catch (error) {\n      console.log(error);\n      throw new ApiError(\n        \"Can not get Comments by productId\",\n        400,\n        \"CanNotGetComments\"\n      );\n    }\n  });\n  router.delete(\"/delete-comment/:id\", Session, async (req, res) => {\n    const id = req.params.id;\n    try {\n      const comment = await Comments.findOneAndDelete({ _id: id });\n      // checkCommentOwnerShip(req.user, comment);\n      if (!comment) {\n        throw new ApiError(\"It was already deleted\", 400, \"AlreadyDeleted\");\n      }\n      if (comment) {\n        res.status(200).json(`Comment number ${id} was deleted`);\n      } else {\n        res.status(404).json(`Product with ID ${id} not found`);\n      }\n    } catch (error) {\n      console.log(error);\n      throw new ApiError(\"Cannot delete comment\", 400, \"CanNotDeleteComment\");\n    }\n  });\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1734609971531},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/Comments.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _comments = _interopRequireDefault(require(\"../db/comments\"));\nvar _replies = _interopRequireDefault(require(\"../db/replies\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _Permissions = require(\"../helpers/Permissions\");\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = router => {\n  router.post(\"/create-comment\", _Session.default, async (req, res) => {\n    (0, _Permissions.checkPermissions)(req.user, [\"user\"]);\n    try {\n      const {\n        productId,\n        rating,\n        comment\n      } = req.body;\n      const user = req.user._id;\n      const comments = new _comments.default({\n        userId: user,\n        comment,\n        rating,\n        productId: productId\n      });\n      await comments.save();\n      res.status(200).json(comments);\n    } catch (error) {\n      console.log(error);\n      throw new _ApiError.default(\"Comments could not sending\", 400, \"CouldNotSendingComments\");\n    }\n  });\n  router.get(\"/comments\", _Session.default, async (req, res) => {\n    (0, _Permissions.checkPermissions)(req.user, [\"user\"]);\n    try {\n      const {\n        productId,\n        userId\n      } = req.query;\n      const filter = {};\n\n      // productId varsa filtreye ekle\n      if (productId) {\n        filter.productId = productId;\n      }\n\n      // userId varsa filtreye ekle\n      if (userId) {\n        filter.userId = userId;\n      }\n      //   checkRequiredField(productId, \"Product Id\");\n\n      const comment = await _comments.default.find(filter).populate(\"userId\", \"name email\").sort({\n        createdAt: -1\n      });\n      res.status(200).json(comment);\n    } catch (error) {\n      console.log(error);\n      throw new _ApiError.default(\"Can not get Comments by productId\", 400, \"CanNotGetComments\");\n    }\n  });\n  router.delete(\"/delete-comment/:id\", _Session.default, async (req, res) => {\n    const id = req.params.id;\n    try {\n      const comment = await _comments.default.findOneAndDelete({\n        _id: id\n      });\n      // checkCommentOwnerShip(req.user, comment);\n      if (!comment) {\n        throw new _ApiError.default(\"It was already deleted\", 400, \"AlreadyDeleted\");\n      }\n      if (comment) {\n        res.status(200).json(`Comment number ${id} was deleted`);\n      } else {\n        res.status(404).json(`Product with ID ${id} not found`);\n      }\n    } catch (error) {\n      console.log(error);\n      throw new _ApiError.default(\"Cannot delete comment\", 400, \"CanNotDeleteComment\");\n    }\n  });\n  router.get(\"/comments-with-replies\", _Session.default, async (req, res) => {\n    (0, _Permissions.checkPermissions)(req.user, [\"user\", \"seller\"]);\n    try {\n      const {\n        productId\n      } = req.query;\n      const comments = await _comments.default.find({\n        productId\n      }).populate(\"userId\", \"name email\").sort({\n        createdAt: -1\n      });\n      const commentsWithReplies = await Promise.all(comments.map(async comment => {\n        const replies = await _replies.default.find({\n          commentId: comment._id\n        }).populate(\"sellerId\", \"name email\");\n        return {\n          ...comment._doc,\n          // Yoruma ait tüm veriler\n          replies // Dinamik olarak eklenen yanıtlar\n        };\n      }));\n      res.status(200).json(commentsWithReplies);\n    } catch (error) {\n      console.error(error);\n      res.status(400).json({\n        message: \"Cannot get comments with replies\",\n        errorCode: \"CannotGetCommentsWithReplies\",\n        error: error.message\n      });\n    }\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfY29tbWVudHMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9yZXBsaWVzIiwiX0FwaUVycm9yIiwiX1Blcm1pc3Npb25zIiwiX1Nlc3Npb24iLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfZGVmYXVsdCIsInJvdXRlciIsInBvc3QiLCJTZXNzaW9uIiwicmVxIiwicmVzIiwiY2hlY2tQZXJtaXNzaW9ucyIsInVzZXIiLCJwcm9kdWN0SWQiLCJyYXRpbmciLCJjb21tZW50IiwiYm9keSIsIl9pZCIsImNvbW1lbnRzIiwiQ29tbWVudHMiLCJ1c2VySWQiLCJzYXZlIiwic3RhdHVzIiwianNvbiIsImVycm9yIiwiY29uc29sZSIsImxvZyIsIkFwaUVycm9yIiwiZ2V0IiwicXVlcnkiLCJmaWx0ZXIiLCJmaW5kIiwicG9wdWxhdGUiLCJzb3J0IiwiY3JlYXRlZEF0IiwiZGVsZXRlIiwiaWQiLCJwYXJhbXMiLCJmaW5kT25lQW5kRGVsZXRlIiwiY29tbWVudHNXaXRoUmVwbGllcyIsIlByb21pc2UiLCJhbGwiLCJtYXAiLCJyZXBsaWVzIiwiUmVwbGllcyIsImNvbW1lbnRJZCIsIl9kb2MiLCJtZXNzYWdlIiwiZXJyb3JDb2RlIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3JvdXRlcy8iLCJzb3VyY2VzIjpbIkNvbW1lbnRzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDb21tZW50cyBmcm9tIFwiLi4vZGIvY29tbWVudHNcIjtcbmltcG9ydCBSZXBsaWVzIGZyb20gXCIuLi9kYi9yZXBsaWVzXCI7XG5pbXBvcnQgQXBpRXJyb3IgZnJvbSBcIi4uL2Vycm9ycy9BcGlFcnJvclwiO1xuaW1wb3J0IHsgY2hlY2tQZXJtaXNzaW9ucyB9IGZyb20gXCIuLi9oZWxwZXJzL1Blcm1pc3Npb25zXCI7XG5pbXBvcnQgU2Vzc2lvbiBmcm9tIFwiLi4vbWlkZGxld2FyZXMvU2Vzc2lvblwiO1xuXG5leHBvcnQgZGVmYXVsdCAocm91dGVyKSA9PiB7XG4gIHJvdXRlci5wb3N0KFwiL2NyZWF0ZS1jb21tZW50XCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGNoZWNrUGVybWlzc2lvbnMocmVxLnVzZXIsIFtcInVzZXJcIl0pO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IHByb2R1Y3RJZCwgcmF0aW5nLCBjb21tZW50IH0gPSByZXEuYm9keTtcbiAgICAgIGNvbnN0IHVzZXIgPSByZXEudXNlci5faWQ7XG5cbiAgICAgIGNvbnN0IGNvbW1lbnRzID0gbmV3IENvbW1lbnRzKHtcbiAgICAgICAgdXNlcklkOiB1c2VyLFxuICAgICAgICBjb21tZW50LFxuICAgICAgICByYXRpbmcsXG4gICAgICAgIHByb2R1Y3RJZDogcHJvZHVjdElkLFxuICAgICAgfSk7XG4gICAgICBhd2FpdCBjb21tZW50cy5zYXZlKCk7XG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbihjb21tZW50cyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgXCJDb21tZW50cyBjb3VsZCBub3Qgc2VuZGluZ1wiLFxuICAgICAgICA0MDAsXG4gICAgICAgIFwiQ291bGROb3RTZW5kaW5nQ29tbWVudHNcIlxuICAgICAgKTtcbiAgICB9XG4gIH0pO1xuICByb3V0ZXIuZ2V0KFwiL2NvbW1lbnRzXCIsIFNlc3Npb24sIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICAgIGNoZWNrUGVybWlzc2lvbnMocmVxLnVzZXIsIFtcInVzZXJcIl0pO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IHByb2R1Y3RJZCwgdXNlcklkIH0gPSByZXEucXVlcnk7XG4gICAgICBjb25zdCBmaWx0ZXIgPSB7fTtcblxuICAgICAgLy8gcHJvZHVjdElkIHZhcnNhIGZpbHRyZXllIGVrbGVcbiAgICAgIGlmIChwcm9kdWN0SWQpIHtcbiAgICAgICAgZmlsdGVyLnByb2R1Y3RJZCA9IHByb2R1Y3RJZDtcbiAgICAgIH1cblxuICAgICAgLy8gdXNlcklkIHZhcnNhIGZpbHRyZXllIGVrbGVcbiAgICAgIGlmICh1c2VySWQpIHtcbiAgICAgICAgZmlsdGVyLnVzZXJJZCA9IHVzZXJJZDtcbiAgICAgIH1cbiAgICAgIC8vICAgY2hlY2tSZXF1aXJlZEZpZWxkKHByb2R1Y3RJZCwgXCJQcm9kdWN0IElkXCIpO1xuXG4gICAgICBjb25zdCBjb21tZW50ID0gYXdhaXQgQ29tbWVudHMuZmluZChmaWx0ZXIpXG4gICAgICAgIC5wb3B1bGF0ZShcInVzZXJJZFwiLCBcIm5hbWUgZW1haWxcIilcbiAgICAgICAgLnNvcnQoeyBjcmVhdGVkQXQ6IC0xIH0pO1xuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oY29tbWVudCk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcbiAgICAgICAgXCJDYW4gbm90IGdldCBDb21tZW50cyBieSBwcm9kdWN0SWRcIixcbiAgICAgICAgNDAwLFxuICAgICAgICBcIkNhbk5vdEdldENvbW1lbnRzXCJcbiAgICAgICk7XG4gICAgfVxuICB9KTtcbiAgcm91dGVyLmRlbGV0ZShcIi9kZWxldGUtY29tbWVudC86aWRcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY29uc3QgaWQgPSByZXEucGFyYW1zLmlkO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBjb21tZW50ID0gYXdhaXQgQ29tbWVudHMuZmluZE9uZUFuZERlbGV0ZSh7IF9pZDogaWQgfSk7XG4gICAgICAvLyBjaGVja0NvbW1lbnRPd25lclNoaXAocmVxLnVzZXIsIGNvbW1lbnQpO1xuICAgICAgaWYgKCFjb21tZW50KSB7XG4gICAgICAgIHRocm93IG5ldyBBcGlFcnJvcihcIkl0IHdhcyBhbHJlYWR5IGRlbGV0ZWRcIiwgNDAwLCBcIkFscmVhZHlEZWxldGVkXCIpO1xuICAgICAgfVxuICAgICAgaWYgKGNvbW1lbnQpIHtcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oYENvbW1lbnQgbnVtYmVyICR7aWR9IHdhcyBkZWxldGVkYCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXMuc3RhdHVzKDQwNCkuanNvbihgUHJvZHVjdCB3aXRoIElEICR7aWR9IG5vdCBmb3VuZGApO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmxvZyhlcnJvcik7XG4gICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXCJDYW5ub3QgZGVsZXRlIGNvbW1lbnRcIiwgNDAwLCBcIkNhbk5vdERlbGV0ZUNvbW1lbnRcIik7XG4gICAgfVxuICB9KTtcbiAgcm91dGVyLmdldChcIi9jb21tZW50cy13aXRoLXJlcGxpZXNcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY2hlY2tQZXJtaXNzaW9ucyhyZXEudXNlciwgW1widXNlclwiLCBcInNlbGxlclwiXSk7XG5cbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBwcm9kdWN0SWQgfSA9IHJlcS5xdWVyeTtcblxuICAgICAgY29uc3QgY29tbWVudHMgPSBhd2FpdCBDb21tZW50cy5maW5kKHsgcHJvZHVjdElkIH0pXG4gICAgICAgIC5wb3B1bGF0ZShcInVzZXJJZFwiLCBcIm5hbWUgZW1haWxcIilcbiAgICAgICAgLnNvcnQoeyBjcmVhdGVkQXQ6IC0xIH0pO1xuXG4gICAgICBjb25zdCBjb21tZW50c1dpdGhSZXBsaWVzID0gYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICAgIGNvbW1lbnRzLm1hcChhc3luYyAoY29tbWVudCkgPT4ge1xuICAgICAgICAgIGNvbnN0IHJlcGxpZXMgPSBhd2FpdCBSZXBsaWVzLmZpbmQoeyBjb21tZW50SWQ6IGNvbW1lbnQuX2lkIH0pXG4gICAgICAgICAgLnBvcHVsYXRlKFwic2VsbGVySWRcIiwgXCJuYW1lIGVtYWlsXCIpO1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAuLi5jb21tZW50Ll9kb2MsIC8vIFlvcnVtYSBhaXQgdMO8bSB2ZXJpbGVyXG4gICAgICAgICAgICByZXBsaWVzLCAvLyBEaW5hbWlrIG9sYXJhayBla2xlbmVuIHlhbsSxdGxhclxuICAgICAgICAgIH07XG4gICAgICAgIH0pXG4gICAgICApO1xuXG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbihjb21tZW50c1dpdGhSZXBsaWVzKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICByZXMuc3RhdHVzKDQwMCkuanNvbih7XG4gICAgICAgIG1lc3NhZ2U6IFwiQ2Fubm90IGdldCBjb21tZW50cyB3aXRoIHJlcGxpZXNcIixcbiAgICAgICAgZXJyb3JDb2RlOiBcIkNhbm5vdEdldENvbW1lbnRzV2l0aFJlcGxpZXNcIixcbiAgICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UsXG4gICAgICB9KTtcbiAgICB9XG4gIH0pO1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsU0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsUUFBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsU0FBQSxHQUFBSCxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUcsWUFBQSxHQUFBSCxPQUFBO0FBQ0EsSUFBQUksUUFBQSxHQUFBTCxzQkFBQSxDQUFBQyxPQUFBO0FBQTZDLFNBQUFELHVCQUFBTSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBQUEsSUFBQUcsUUFBQSxHQUU3QkMsTUFBTSxJQUFLO0VBQ3pCQSxNQUFNLENBQUNDLElBQUksQ0FBQyxpQkFBaUIsRUFBRUMsZ0JBQU8sRUFBRSxPQUFPQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztJQUMxRCxJQUFBQyw2QkFBZ0IsRUFBQ0YsR0FBRyxDQUFDRyxJQUFJLEVBQUUsQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUNwQyxJQUFJO01BQ0YsTUFBTTtRQUFFQyxTQUFTO1FBQUVDLE1BQU07UUFBRUM7TUFBUSxDQUFDLEdBQUdOLEdBQUcsQ0FBQ08sSUFBSTtNQUMvQyxNQUFNSixJQUFJLEdBQUdILEdBQUcsQ0FBQ0csSUFBSSxDQUFDSyxHQUFHO01BRXpCLE1BQU1DLFFBQVEsR0FBRyxJQUFJQyxpQkFBUSxDQUFDO1FBQzVCQyxNQUFNLEVBQUVSLElBQUk7UUFDWkcsT0FBTztRQUNQRCxNQUFNO1FBQ05ELFNBQVMsRUFBRUE7TUFDYixDQUFDLENBQUM7TUFDRixNQUFNSyxRQUFRLENBQUNHLElBQUksQ0FBQyxDQUFDO01BQ3JCWCxHQUFHLENBQUNZLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDTCxRQUFRLENBQUM7SUFDaEMsQ0FBQyxDQUFDLE9BQU9NLEtBQUssRUFBRTtNQUNkQyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0YsS0FBSyxDQUFDO01BQ2xCLE1BQU0sSUFBSUcsaUJBQVEsQ0FDaEIsNEJBQTRCLEVBQzVCLEdBQUcsRUFDSCx5QkFDRixDQUFDO0lBQ0g7RUFDRixDQUFDLENBQUM7RUFDRnJCLE1BQU0sQ0FBQ3NCLEdBQUcsQ0FBQyxXQUFXLEVBQUVwQixnQkFBTyxFQUFFLE9BQU9DLEdBQUcsRUFBRUMsR0FBRyxLQUFLO0lBQ25ELElBQUFDLDZCQUFnQixFQUFDRixHQUFHLENBQUNHLElBQUksRUFBRSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ3BDLElBQUk7TUFDRixNQUFNO1FBQUVDLFNBQVM7UUFBRU87TUFBTyxDQUFDLEdBQUdYLEdBQUcsQ0FBQ29CLEtBQUs7TUFDdkMsTUFBTUMsTUFBTSxHQUFHLENBQUMsQ0FBQzs7TUFFakI7TUFDQSxJQUFJakIsU0FBUyxFQUFFO1FBQ2JpQixNQUFNLENBQUNqQixTQUFTLEdBQUdBLFNBQVM7TUFDOUI7O01BRUE7TUFDQSxJQUFJTyxNQUFNLEVBQUU7UUFDVlUsTUFBTSxDQUFDVixNQUFNLEdBQUdBLE1BQU07TUFDeEI7TUFDQTs7TUFFQSxNQUFNTCxPQUFPLEdBQUcsTUFBTUksaUJBQVEsQ0FBQ1ksSUFBSSxDQUFDRCxNQUFNLENBQUMsQ0FDeENFLFFBQVEsQ0FBQyxRQUFRLEVBQUUsWUFBWSxDQUFDLENBQ2hDQyxJQUFJLENBQUM7UUFBRUMsU0FBUyxFQUFFLENBQUM7TUFBRSxDQUFDLENBQUM7TUFDMUJ4QixHQUFHLENBQUNZLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDUixPQUFPLENBQUM7SUFDL0IsQ0FBQyxDQUFDLE9BQU9TLEtBQUssRUFBRTtNQUNkQyxPQUFPLENBQUNDLEdBQUcsQ0FBQ0YsS0FBSyxDQUFDO01BQ2xCLE1BQU0sSUFBSUcsaUJBQVEsQ0FDaEIsbUNBQW1DLEVBQ25DLEdBQUcsRUFDSCxtQkFDRixDQUFDO0lBQ0g7RUFDRixDQUFDLENBQUM7RUFDRnJCLE1BQU0sQ0FBQzZCLE1BQU0sQ0FBQyxxQkFBcUIsRUFBRTNCLGdCQUFPLEVBQUUsT0FBT0MsR0FBRyxFQUFFQyxHQUFHLEtBQUs7SUFDaEUsTUFBTTBCLEVBQUUsR0FBRzNCLEdBQUcsQ0FBQzRCLE1BQU0sQ0FBQ0QsRUFBRTtJQUN4QixJQUFJO01BQ0YsTUFBTXJCLE9BQU8sR0FBRyxNQUFNSSxpQkFBUSxDQUFDbUIsZ0JBQWdCLENBQUM7UUFBRXJCLEdBQUcsRUFBRW1CO01BQUcsQ0FBQyxDQUFDO01BQzVEO01BQ0EsSUFBSSxDQUFDckIsT0FBTyxFQUFFO1FBQ1osTUFBTSxJQUFJWSxpQkFBUSxDQUFDLHdCQUF3QixFQUFFLEdBQUcsRUFBRSxnQkFBZ0IsQ0FBQztNQUNyRTtNQUNBLElBQUlaLE9BQU8sRUFBRTtRQUNYTCxHQUFHLENBQUNZLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLGtCQUFrQmEsRUFBRSxjQUFjLENBQUM7TUFDMUQsQ0FBQyxNQUFNO1FBQ0wxQixHQUFHLENBQUNZLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDLG1CQUFtQmEsRUFBRSxZQUFZLENBQUM7TUFDekQ7SUFDRixDQUFDLENBQUMsT0FBT1osS0FBSyxFQUFFO01BQ2RDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDRixLQUFLLENBQUM7TUFDbEIsTUFBTSxJQUFJRyxpQkFBUSxDQUFDLHVCQUF1QixFQUFFLEdBQUcsRUFBRSxxQkFBcUIsQ0FBQztJQUN6RTtFQUNGLENBQUMsQ0FBQztFQUNGckIsTUFBTSxDQUFDc0IsR0FBRyxDQUFDLHdCQUF3QixFQUFFcEIsZ0JBQU8sRUFBRSxPQUFPQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztJQUNoRSxJQUFBQyw2QkFBZ0IsRUFBQ0YsR0FBRyxDQUFDRyxJQUFJLEVBQUUsQ0FBQyxNQUFNLEVBQUUsUUFBUSxDQUFDLENBQUM7SUFFOUMsSUFBSTtNQUNGLE1BQU07UUFBRUM7TUFBVSxDQUFDLEdBQUdKLEdBQUcsQ0FBQ29CLEtBQUs7TUFFL0IsTUFBTVgsUUFBUSxHQUFHLE1BQU1DLGlCQUFRLENBQUNZLElBQUksQ0FBQztRQUFFbEI7TUFBVSxDQUFDLENBQUMsQ0FDaERtQixRQUFRLENBQUMsUUFBUSxFQUFFLFlBQVksQ0FBQyxDQUNoQ0MsSUFBSSxDQUFDO1FBQUVDLFNBQVMsRUFBRSxDQUFDO01BQUUsQ0FBQyxDQUFDO01BRTFCLE1BQU1LLG1CQUFtQixHQUFHLE1BQU1DLE9BQU8sQ0FBQ0MsR0FBRyxDQUMzQ3ZCLFFBQVEsQ0FBQ3dCLEdBQUcsQ0FBQyxNQUFPM0IsT0FBTyxJQUFLO1FBQzlCLE1BQU00QixPQUFPLEdBQUcsTUFBTUMsZ0JBQU8sQ0FBQ2IsSUFBSSxDQUFDO1VBQUVjLFNBQVMsRUFBRTlCLE9BQU8sQ0FBQ0U7UUFBSSxDQUFDLENBQUMsQ0FDN0RlLFFBQVEsQ0FBQyxVQUFVLEVBQUUsWUFBWSxDQUFDO1FBQ25DLE9BQU87VUFDTCxHQUFHakIsT0FBTyxDQUFDK0IsSUFBSTtVQUFFO1VBQ2pCSCxPQUFPLENBQUU7UUFDWCxDQUFDO01BQ0gsQ0FBQyxDQUNILENBQUM7TUFFRGpDLEdBQUcsQ0FBQ1ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUNnQixtQkFBbUIsQ0FBQztJQUMzQyxDQUFDLENBQUMsT0FBT2YsS0FBSyxFQUFFO01BQ2RDLE9BQU8sQ0FBQ0QsS0FBSyxDQUFDQSxLQUFLLENBQUM7TUFDcEJkLEdBQUcsQ0FBQ1ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7UUFDbkJ3QixPQUFPLEVBQUUsa0NBQWtDO1FBQzNDQyxTQUFTLEVBQUUsOEJBQThCO1FBQ3pDeEIsS0FBSyxFQUFFQSxLQUFLLENBQUN1QjtNQUNmLENBQUMsQ0FBQztJQUNKO0VBQ0YsQ0FBQyxDQUFDO0FBQ0osQ0FBQztBQUFBRSxPQUFBLENBQUE3QyxPQUFBLEdBQUFDLFFBQUEiLCJpZ25vcmVMaXN0IjpbXX0=","map":{"version":3,"names":["_comments","_interopRequireDefault","require","_replies","_ApiError","_Permissions","_Session","e","__esModule","default","_default","router","post","Session","req","res","checkPermissions","user","productId","rating","comment","body","_id","comments","Comments","userId","save","status","json","error","console","log","ApiError","get","query","filter","find","populate","sort","createdAt","delete","id","params","findOneAndDelete","commentsWithReplies","Promise","all","map","replies","Replies","commentId","_doc","message","errorCode","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["Comments.js"],"sourcesContent":["import Comments from \"../db/comments\";\nimport Replies from \"../db/replies\";\nimport ApiError from \"../errors/ApiError\";\nimport { checkPermissions } from \"../helpers/Permissions\";\nimport Session from \"../middlewares/Session\";\n\nexport default (router) => {\n  router.post(\"/create-comment\", Session, async (req, res) => {\n    checkPermissions(req.user, [\"user\"]);\n    try {\n      const { productId, rating, comment } = req.body;\n      const user = req.user._id;\n\n      const comments = new Comments({\n        userId: user,\n        comment,\n        rating,\n        productId: productId,\n      });\n      await comments.save();\n      res.status(200).json(comments);\n    } catch (error) {\n      console.log(error);\n      throw new ApiError(\n        \"Comments could not sending\",\n        400,\n        \"CouldNotSendingComments\"\n      );\n    }\n  });\n  router.get(\"/comments\", Session, async (req, res) => {\n    checkPermissions(req.user, [\"user\"]);\n    try {\n      const { productId, userId } = req.query;\n      const filter = {};\n\n      // productId varsa filtreye ekle\n      if (productId) {\n        filter.productId = productId;\n      }\n\n      // userId varsa filtreye ekle\n      if (userId) {\n        filter.userId = userId;\n      }\n      //   checkRequiredField(productId, \"Product Id\");\n\n      const comment = await Comments.find(filter)\n        .populate(\"userId\", \"name email\")\n        .sort({ createdAt: -1 });\n      res.status(200).json(comment);\n    } catch (error) {\n      console.log(error);\n      throw new ApiError(\n        \"Can not get Comments by productId\",\n        400,\n        \"CanNotGetComments\"\n      );\n    }\n  });\n  router.delete(\"/delete-comment/:id\", Session, async (req, res) => {\n    const id = req.params.id;\n    try {\n      const comment = await Comments.findOneAndDelete({ _id: id });\n      // checkCommentOwnerShip(req.user, comment);\n      if (!comment) {\n        throw new ApiError(\"It was already deleted\", 400, \"AlreadyDeleted\");\n      }\n      if (comment) {\n        res.status(200).json(`Comment number ${id} was deleted`);\n      } else {\n        res.status(404).json(`Product with ID ${id} not found`);\n      }\n    } catch (error) {\n      console.log(error);\n      throw new ApiError(\"Cannot delete comment\", 400, \"CanNotDeleteComment\");\n    }\n  });\n  router.get(\"/comments-with-replies\", Session, async (req, res) => {\n    checkPermissions(req.user, [\"user\", \"seller\"]);\n\n    try {\n      const { productId } = req.query;\n\n      const comments = await Comments.find({ productId })\n        .populate(\"userId\", \"name email\")\n        .sort({ createdAt: -1 });\n\n      const commentsWithReplies = await Promise.all(\n        comments.map(async (comment) => {\n          const replies = await Replies.find({ commentId: comment._id })\n          .populate(\"sellerId\", \"name email\");\n          return {\n            ...comment._doc, // Yoruma ait tüm veriler\n            replies, // Dinamik olarak eklenen yanıtlar\n          };\n        })\n      );\n\n      res.status(200).json(commentsWithReplies);\n    } catch (error) {\n      console.error(error);\n      res.status(400).json({\n        message: \"Cannot get comments with replies\",\n        errorCode: \"CannotGetCommentsWithReplies\",\n        error: error.message,\n      });\n    }\n  });\n};\n"],"mappings":"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","ignoreList":[]}},"mtime":1734705566199},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/replies.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nconst mongoose = require(\"mongoose\");\nconst Schema = mongoose.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst RepliesSchema = new mongoose.Schema({\n  commentId: {\n    type: ObjectId,\n    ref: \"Comments\",\n    required: true\n  },\n  sellerId: {\n    type: ObjectId,\n    ref: \"Sellers\",\n    required: true\n  },\n  reply: {\n    type: String,\n    required: true\n  },\n  createdAt: {\n    type: Date,\n    default: Date.now\n  }\n}, {\n  _id: true,\n  collection: \"replies\",\n  timestamps: true,\n  toJSON: {\n    transform: (doc, ret) => {\n      delete ret.__v;\n      return {\n        ...ret\n      };\n    }\n  }\n});\nconst Replies = mongoose.model(\"Replies\", RepliesSchema);\nvar _default = exports.default = Replies;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJTY2hlbWEiLCJPYmplY3RJZCIsIlR5cGVzIiwiUmVwbGllc1NjaGVtYSIsImNvbW1lbnRJZCIsInR5cGUiLCJyZWYiLCJyZXF1aXJlZCIsInNlbGxlcklkIiwicmVwbHkiLCJTdHJpbmciLCJjcmVhdGVkQXQiLCJEYXRlIiwiZGVmYXVsdCIsIm5vdyIsIl9pZCIsImNvbGxlY3Rpb24iLCJ0aW1lc3RhbXBzIiwidG9KU09OIiwidHJhbnNmb3JtIiwiZG9jIiwicmV0IiwiX192IiwiUmVwbGllcyIsIm1vZGVsIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvZGIvIiwic291cmNlcyI6WyJyZXBsaWVzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZShcIm1vbmdvb3NlXCIpO1xuY29uc3QgU2NoZW1hID0gbW9uZ29vc2UuU2NoZW1hO1xuY29uc3QgeyBPYmplY3RJZCB9ID0gU2NoZW1hLlR5cGVzO1xuY29uc3QgUmVwbGllc1NjaGVtYSA9IG5ldyBtb25nb29zZS5TY2hlbWEoXG4gIHtcbiAgICBjb21tZW50SWQ6IHtcbiAgICAgIHR5cGU6IE9iamVjdElkLFxuICAgICAgcmVmOiBcIkNvbW1lbnRzXCIsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIHNlbGxlcklkOiB7XG4gICAgICB0eXBlOiBPYmplY3RJZCxcbiAgICAgIHJlZjogXCJTZWxsZXJzXCIsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIHJlcGx5OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGNyZWF0ZWRBdDoge1xuICAgICAgdHlwZTogRGF0ZSxcbiAgICAgIGRlZmF1bHQ6IERhdGUubm93LFxuICAgIH0sXG4gIH0sXG4gIHtcbiAgICBfaWQ6IHRydWUsXG4gICAgY29sbGVjdGlvbjogXCJyZXBsaWVzXCIsXG4gICAgdGltZXN0YW1wczogdHJ1ZSxcbiAgICB0b0pTT046IHtcbiAgICAgIHRyYW5zZm9ybTogKGRvYywgcmV0KSA9PiB7XG4gICAgICAgIGRlbGV0ZSByZXQuX192O1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLnJldCxcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgfSxcbiAgfVxuKTtcblxuY29uc3QgUmVwbGllcyA9IG1vbmdvb3NlLm1vZGVsKFwiUmVwbGllc1wiLCBSZXBsaWVzU2NoZW1hKTtcbmV4cG9ydCBkZWZhdWx0IFJlcGxpZXM7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLFVBQVUsQ0FBQztBQUNwQyxNQUFNQyxNQUFNLEdBQUdGLFFBQVEsQ0FBQ0UsTUFBTTtBQUM5QixNQUFNO0VBQUVDO0FBQVMsQ0FBQyxHQUFHRCxNQUFNLENBQUNFLEtBQUs7QUFDakMsTUFBTUMsYUFBYSxHQUFHLElBQUlMLFFBQVEsQ0FBQ0UsTUFBTSxDQUN2QztFQUNFSSxTQUFTLEVBQUU7SUFDVEMsSUFBSSxFQUFFSixRQUFRO0lBQ2RLLEdBQUcsRUFBRSxVQUFVO0lBQ2ZDLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDREMsUUFBUSxFQUFFO0lBQ1JILElBQUksRUFBRUosUUFBUTtJQUNkSyxHQUFHLEVBQUUsU0FBUztJQUNkQyxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RFLEtBQUssRUFBRTtJQUNMSixJQUFJLEVBQUVLLE1BQU07SUFDWkgsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNESSxTQUFTLEVBQUU7SUFDVE4sSUFBSSxFQUFFTyxJQUFJO0lBQ1ZDLE9BQU8sRUFBRUQsSUFBSSxDQUFDRTtFQUNoQjtBQUNGLENBQUMsRUFDRDtFQUNFQyxHQUFHLEVBQUUsSUFBSTtFQUNUQyxVQUFVLEVBQUUsU0FBUztFQUNyQkMsVUFBVSxFQUFFLElBQUk7RUFDaEJDLE1BQU0sRUFBRTtJQUNOQyxTQUFTLEVBQUVBLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxLQUFLO01BQ3ZCLE9BQU9BLEdBQUcsQ0FBQ0MsR0FBRztNQUNkLE9BQU87UUFDTCxHQUFHRDtNQUNMLENBQUM7SUFDSDtFQUNGO0FBQ0YsQ0FDRixDQUFDO0FBRUQsTUFBTUUsT0FBTyxHQUFHekIsUUFBUSxDQUFDMEIsS0FBSyxDQUFDLFNBQVMsRUFBRXJCLGFBQWEsQ0FBQztBQUFDLElBQUFzQixRQUFBLEdBQUFDLE9BQUEsQ0FBQWIsT0FBQSxHQUMxQ1UsT0FBTyIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["mongoose","require","Schema","ObjectId","Types","RepliesSchema","commentId","type","ref","required","sellerId","reply","String","createdAt","Date","default","now","_id","collection","timestamps","toJSON","transform","doc","ret","__v","Replies","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["replies.js"],"sourcesContent":["const mongoose = require(\"mongoose\");\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\nconst RepliesSchema = new mongoose.Schema(\n  {\n    commentId: {\n      type: ObjectId,\n      ref: \"Comments\",\n      required: true,\n    },\n    sellerId: {\n      type: ObjectId,\n      ref: \"Sellers\",\n      required: true,\n    },\n    reply: {\n      type: String,\n      required: true,\n    },\n    createdAt: {\n      type: Date,\n      default: Date.now,\n    },\n  },\n  {\n    _id: true,\n    collection: \"replies\",\n    timestamps: true,\n    toJSON: {\n      transform: (doc, ret) => {\n        delete ret.__v;\n        return {\n          ...ret,\n        };\n      },\n    },\n  }\n);\n\nconst Replies = mongoose.model(\"Replies\", RepliesSchema);\nexport default Replies;\n"],"mappings":";;;;;;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAU,CAAC;AACpC,MAAMC,MAAM,GAAGF,QAAQ,CAACE,MAAM;AAC9B,MAAM;EAAEC;AAAS,CAAC,GAAGD,MAAM,CAACE,KAAK;AACjC,MAAMC,aAAa,GAAG,IAAIL,QAAQ,CAACE,MAAM,CACvC;EACEI,SAAS,EAAE;IACTC,IAAI,EAAEJ,QAAQ;IACdK,GAAG,EAAE,UAAU;IACfC,QAAQ,EAAE;EACZ,CAAC;EACDC,QAAQ,EAAE;IACRH,IAAI,EAAEJ,QAAQ;IACdK,GAAG,EAAE,SAAS;IACdC,QAAQ,EAAE;EACZ,CAAC;EACDE,KAAK,EAAE;IACLJ,IAAI,EAAEK,MAAM;IACZH,QAAQ,EAAE;EACZ,CAAC;EACDI,SAAS,EAAE;IACTN,IAAI,EAAEO,IAAI;IACVC,OAAO,EAAED,IAAI,CAACE;EAChB;AACF,CAAC,EACD;EACEC,GAAG,EAAE,IAAI;EACTC,UAAU,EAAE,SAAS;EACrBC,UAAU,EAAE,IAAI;EAChBC,MAAM,EAAE;IACNC,SAAS,EAAEA,CAACC,GAAG,EAAEC,GAAG,KAAK;MACvB,OAAOA,GAAG,CAACC,GAAG;MACd,OAAO;QACL,GAAGD;MACL,CAAC;IACH;EACF;AACF,CACF,CAAC;AAED,MAAME,OAAO,GAAGzB,QAAQ,CAAC0B,KAAK,CAAC,SAAS,EAAErB,aAAa,CAAC;AAAC,IAAAsB,QAAA,GAAAC,OAAA,CAAAb,OAAA,GAC1CU,OAAO","ignoreList":[]}},"mtime":1734619052938},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/replies.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nconst mongoose = require(\"mongoose\");\nconst Schema = mongoose.Schema;\nconst {\n  ObjectId\n} = Schema.Types;\nconst RepliesSchema = new mongoose.Schema({\n  commentId: {\n    type: ObjectId,\n    ref: \"Comments\",\n    required: true\n  },\n  sellerId: {\n    type: ObjectId,\n    ref: \"Sellers\",\n    required: true\n  },\n  reply: {\n    type: String,\n    required: true\n  },\n  createdAt: {\n    type: Date,\n    default: Date.now\n  }\n}, {\n  _id: true,\n  collection: \"replies\",\n  timestamps: true,\n  toJSON: {\n    transform: (doc, ret) => {\n      delete ret.__v;\n      return {\n        ...ret\n      };\n    }\n  }\n});\nconst Replies = mongoose.model(\"Replies\", RepliesSchema);\nvar _default = exports.default = Replies;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJtb25nb29zZSIsInJlcXVpcmUiLCJTY2hlbWEiLCJPYmplY3RJZCIsIlR5cGVzIiwiUmVwbGllc1NjaGVtYSIsImNvbW1lbnRJZCIsInR5cGUiLCJyZWYiLCJyZXF1aXJlZCIsInNlbGxlcklkIiwicmVwbHkiLCJTdHJpbmciLCJjcmVhdGVkQXQiLCJEYXRlIiwiZGVmYXVsdCIsIm5vdyIsIl9pZCIsImNvbGxlY3Rpb24iLCJ0aW1lc3RhbXBzIiwidG9KU09OIiwidHJhbnNmb3JtIiwiZG9jIiwicmV0IiwiX192IiwiUmVwbGllcyIsIm1vZGVsIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZVJvb3QiOiIvVXNlcnMvYXRrL0Rlc2t0b3AvQVBQL05vZGVKUy9aZXlkYWxfQmFja2VuZF9EZXZlbG9wbWVudC9zcmMvZGIvIiwic291cmNlcyI6WyJyZXBsaWVzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IG1vbmdvb3NlID0gcmVxdWlyZShcIm1vbmdvb3NlXCIpO1xuY29uc3QgU2NoZW1hID0gbW9uZ29vc2UuU2NoZW1hO1xuY29uc3QgeyBPYmplY3RJZCB9ID0gU2NoZW1hLlR5cGVzO1xuY29uc3QgUmVwbGllc1NjaGVtYSA9IG5ldyBtb25nb29zZS5TY2hlbWEoXG4gIHtcbiAgICBjb21tZW50SWQ6IHtcbiAgICAgIHR5cGU6IE9iamVjdElkLFxuICAgICAgcmVmOiBcIkNvbW1lbnRzXCIsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIHNlbGxlcklkOiB7XG4gICAgICB0eXBlOiBPYmplY3RJZCxcbiAgICAgIHJlZjogXCJTZWxsZXJzXCIsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIHJlcGx5OiB7XG4gICAgICB0eXBlOiBTdHJpbmcsXG4gICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICB9LFxuICAgIGNyZWF0ZWRBdDoge1xuICAgICAgdHlwZTogRGF0ZSxcbiAgICAgIGRlZmF1bHQ6IERhdGUubm93LFxuICAgIH0sXG4gIH0sXG4gIHtcbiAgICBfaWQ6IHRydWUsXG4gICAgY29sbGVjdGlvbjogXCJyZXBsaWVzXCIsXG4gICAgdGltZXN0YW1wczogdHJ1ZSxcbiAgICB0b0pTT046IHtcbiAgICAgIHRyYW5zZm9ybTogKGRvYywgcmV0KSA9PiB7XG4gICAgICAgIGRlbGV0ZSByZXQuX192O1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIC4uLnJldCxcbiAgICAgICAgfTtcbiAgICAgIH0sXG4gICAgfSxcbiAgfVxuKTtcblxuY29uc3QgUmVwbGllcyA9IG1vbmdvb3NlLm1vZGVsKFwiUmVwbGllc1wiLCBSZXBsaWVzU2NoZW1hKTtcbmV4cG9ydCBkZWZhdWx0IFJlcGxpZXM7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLE1BQU1BLFFBQVEsR0FBR0MsT0FBTyxDQUFDLFVBQVUsQ0FBQztBQUNwQyxNQUFNQyxNQUFNLEdBQUdGLFFBQVEsQ0FBQ0UsTUFBTTtBQUM5QixNQUFNO0VBQUVDO0FBQVMsQ0FBQyxHQUFHRCxNQUFNLENBQUNFLEtBQUs7QUFDakMsTUFBTUMsYUFBYSxHQUFHLElBQUlMLFFBQVEsQ0FBQ0UsTUFBTSxDQUN2QztFQUNFSSxTQUFTLEVBQUU7SUFDVEMsSUFBSSxFQUFFSixRQUFRO0lBQ2RLLEdBQUcsRUFBRSxVQUFVO0lBQ2ZDLFFBQVEsRUFBRTtFQUNaLENBQUM7RUFDREMsUUFBUSxFQUFFO0lBQ1JILElBQUksRUFBRUosUUFBUTtJQUNkSyxHQUFHLEVBQUUsU0FBUztJQUNkQyxRQUFRLEVBQUU7RUFDWixDQUFDO0VBQ0RFLEtBQUssRUFBRTtJQUNMSixJQUFJLEVBQUVLLE1BQU07SUFDWkgsUUFBUSxFQUFFO0VBQ1osQ0FBQztFQUNESSxTQUFTLEVBQUU7SUFDVE4sSUFBSSxFQUFFTyxJQUFJO0lBQ1ZDLE9BQU8sRUFBRUQsSUFBSSxDQUFDRTtFQUNoQjtBQUNGLENBQUMsRUFDRDtFQUNFQyxHQUFHLEVBQUUsSUFBSTtFQUNUQyxVQUFVLEVBQUUsU0FBUztFQUNyQkMsVUFBVSxFQUFFLElBQUk7RUFDaEJDLE1BQU0sRUFBRTtJQUNOQyxTQUFTLEVBQUVBLENBQUNDLEdBQUcsRUFBRUMsR0FBRyxLQUFLO01BQ3ZCLE9BQU9BLEdBQUcsQ0FBQ0MsR0FBRztNQUNkLE9BQU87UUFDTCxHQUFHRDtNQUNMLENBQUM7SUFDSDtFQUNGO0FBQ0YsQ0FDRixDQUFDO0FBRUQsTUFBTUUsT0FBTyxHQUFHekIsUUFBUSxDQUFDMEIsS0FBSyxDQUFDLFNBQVMsRUFBRXJCLGFBQWEsQ0FBQztBQUFDLElBQUFzQixRQUFBLEdBQUFDLE9BQUEsQ0FBQWIsT0FBQSxHQUMxQ1UsT0FBTyIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["mongoose","require","Schema","ObjectId","Types","RepliesSchema","commentId","type","ref","required","sellerId","reply","String","createdAt","Date","default","now","_id","collection","timestamps","toJSON","transform","doc","ret","__v","Replies","model","_default","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/db/","sources":["replies.js"],"sourcesContent":["const mongoose = require(\"mongoose\");\nconst Schema = mongoose.Schema;\nconst { ObjectId } = Schema.Types;\nconst RepliesSchema = new mongoose.Schema(\n  {\n    commentId: {\n      type: ObjectId,\n      ref: \"Comments\",\n      required: true,\n    },\n    sellerId: {\n      type: ObjectId,\n      ref: \"Sellers\",\n      required: true,\n    },\n    reply: {\n      type: String,\n      required: true,\n    },\n    createdAt: {\n      type: Date,\n      default: Date.now,\n    },\n  },\n  {\n    _id: true,\n    collection: \"replies\",\n    timestamps: true,\n    toJSON: {\n      transform: (doc, ret) => {\n        delete ret.__v;\n        return {\n          ...ret,\n        };\n      },\n    },\n  }\n);\n\nconst Replies = mongoose.model(\"Replies\", RepliesSchema);\nexport default Replies;\n"],"mappings":";;;;;;AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAAC,UAAU,CAAC;AACpC,MAAMC,MAAM,GAAGF,QAAQ,CAACE,MAAM;AAC9B,MAAM;EAAEC;AAAS,CAAC,GAAGD,MAAM,CAACE,KAAK;AACjC,MAAMC,aAAa,GAAG,IAAIL,QAAQ,CAACE,MAAM,CACvC;EACEI,SAAS,EAAE;IACTC,IAAI,EAAEJ,QAAQ;IACdK,GAAG,EAAE,UAAU;IACfC,QAAQ,EAAE;EACZ,CAAC;EACDC,QAAQ,EAAE;IACRH,IAAI,EAAEJ,QAAQ;IACdK,GAAG,EAAE,SAAS;IACdC,QAAQ,EAAE;EACZ,CAAC;EACDE,KAAK,EAAE;IACLJ,IAAI,EAAEK,MAAM;IACZH,QAAQ,EAAE;EACZ,CAAC;EACDI,SAAS,EAAE;IACTN,IAAI,EAAEO,IAAI;IACVC,OAAO,EAAED,IAAI,CAACE;EAChB;AACF,CAAC,EACD;EACEC,GAAG,EAAE,IAAI;EACTC,UAAU,EAAE,SAAS;EACrBC,UAAU,EAAE,IAAI;EAChBC,MAAM,EAAE;IACNC,SAAS,EAAEA,CAACC,GAAG,EAAEC,GAAG,KAAK;MACvB,OAAOA,GAAG,CAACC,GAAG;MACd,OAAO;QACL,GAAGD;MACL,CAAC;IACH;EACF;AACF,CACF,CAAC;AAED,MAAME,OAAO,GAAGzB,QAAQ,CAAC0B,KAAK,CAAC,SAAS,EAAErB,aAAa,CAAC;AAAC,IAAAsB,QAAA,GAAAC,OAAA,CAAAb,OAAA,GAC1CU,OAAO","ignoreList":[]}},"mtime":1734619052938},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/Replies.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _comments = _interopRequireDefault(require(\"../db/comments\"));\nvar _products = _interopRequireDefault(require(\"../db/products\"));\nvar _replies = _interopRequireDefault(require(\"../db/replies\"));\nvar _Permissions = require(\"../helpers/Permissions\");\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = router => {\n  router.post(\"/replies\", _Session.default, async (req, res) => {\n    (0, _Permissions.checkPermissions)(req.user, [\"seller\"]); // Sadece satıcılar yanıt verebilir\n\n    try {\n      const {\n        commentId,\n        reply\n      } = req.body;\n      const sellerId = req.user._id; // Giriş yapan satıcı\n\n      // Yorumun varlığını kontrol et\n      const comment = await _comments.default.findById(commentId).populate(\"productId\");\n      if (!comment) {\n        return res.status(404).json({\n          message: \"Comment not found\",\n          errorCode: \"CommentNotFound\"\n        });\n      }\n      const product = await _products.default.findById(comment.productId);\n      if (!product) {\n        throw new ApiError(\"Product not found\", 404, \"productNotFound\");\n      }\n      (0, _Permissions.checkCommentForProductOwner)(req.user, comment, product);\n\n      // Yanıtı kaydet\n      const newReply = new _replies.default({\n        commentId,\n        sellerId,\n        reply\n      });\n      await newReply.save();\n      res.status(201).json({\n        message: \"Reply successfully added\",\n        reply: newReply\n      });\n    } catch (error) {\n      console.error(error);\n      res.status(400).json({\n        message: \"Cannot add reply\",\n        errorCode: \"CannotAddReply\",\n        error: error.message\n      });\n    }\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfY29tbWVudHMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9wcm9kdWN0cyIsIl9yZXBsaWVzIiwiX1Blcm1pc3Npb25zIiwiX1Nlc3Npb24iLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfZGVmYXVsdCIsInJvdXRlciIsInBvc3QiLCJTZXNzaW9uIiwicmVxIiwicmVzIiwiY2hlY2tQZXJtaXNzaW9ucyIsInVzZXIiLCJjb21tZW50SWQiLCJyZXBseSIsImJvZHkiLCJzZWxsZXJJZCIsIl9pZCIsImNvbW1lbnQiLCJDb21tZW50cyIsImZpbmRCeUlkIiwicG9wdWxhdGUiLCJzdGF0dXMiLCJqc29uIiwibWVzc2FnZSIsImVycm9yQ29kZSIsInByb2R1Y3QiLCJQcm9kdWN0cyIsInByb2R1Y3RJZCIsIkFwaUVycm9yIiwiY2hlY2tDb21tZW50Rm9yUHJvZHVjdE93bmVyIiwibmV3UmVwbHkiLCJSZXBsaWVzIiwic2F2ZSIsImVycm9yIiwiY29uc29sZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9yb3V0ZXMvIiwic291cmNlcyI6WyJSZXBsaWVzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDb21tZW50cyBmcm9tIFwiLi4vZGIvY29tbWVudHNcIjtcbmltcG9ydCBQcm9kdWN0cyBmcm9tIFwiLi4vZGIvcHJvZHVjdHNcIjtcbmltcG9ydCBSZXBsaWVzIGZyb20gXCIuLi9kYi9yZXBsaWVzXCI7XG5pbXBvcnQge1xuICBjaGVja0NvbW1lbnRGb3JQcm9kdWN0T3duZXIsXG4gIGNoZWNrUGVybWlzc2lvbnMsXG59IGZyb20gXCIuLi9oZWxwZXJzL1Blcm1pc3Npb25zXCI7XG5pbXBvcnQgU2Vzc2lvbiBmcm9tIFwiLi4vbWlkZGxld2FyZXMvU2Vzc2lvblwiO1xuXG5leHBvcnQgZGVmYXVsdCAocm91dGVyKSA9PiB7XG4gIHJvdXRlci5wb3N0KFwiL3JlcGxpZXNcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY2hlY2tQZXJtaXNzaW9ucyhyZXEudXNlciwgW1wic2VsbGVyXCJdKTsgLy8gU2FkZWNlIHNhdMSxY8SxbGFyIHlhbsSxdCB2ZXJlYmlsaXJcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGNvbW1lbnRJZCwgcmVwbHkgfSA9IHJlcS5ib2R5O1xuICAgICAgY29uc3Qgc2VsbGVySWQgPSByZXEudXNlci5faWQ7IC8vIEdpcmnFnyB5YXBhbiBzYXTEsWPEsVxuXG4gICAgICAvLyBZb3J1bXVuIHZhcmzEscSfxLFuxLEga29udHJvbCBldFxuICAgICAgY29uc3QgY29tbWVudCA9IGF3YWl0IENvbW1lbnRzLmZpbmRCeUlkKGNvbW1lbnRJZCkucG9wdWxhdGUoXCJwcm9kdWN0SWRcIik7XG4gICAgICBpZiAoIWNvbW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHtcbiAgICAgICAgICBtZXNzYWdlOiBcIkNvbW1lbnQgbm90IGZvdW5kXCIsXG4gICAgICAgICAgZXJyb3JDb2RlOiBcIkNvbW1lbnROb3RGb3VuZFwiLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBQcm9kdWN0cy5maW5kQnlJZChjb21tZW50LnByb2R1Y3RJZCk7XG4gICAgICBpZiAoIXByb2R1Y3QpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiUHJvZHVjdCBub3QgZm91bmRcIiwgNDA0LCBcInByb2R1Y3ROb3RGb3VuZFwiKTtcbiAgICAgIH1cblxuICAgICAgY2hlY2tDb21tZW50Rm9yUHJvZHVjdE93bmVyKHJlcS51c2VyLCBjb21tZW50LCBwcm9kdWN0KTtcblxuICAgICAgLy8gWWFuxLF0xLEga2F5ZGV0XG4gICAgICBjb25zdCBuZXdSZXBseSA9IG5ldyBSZXBsaWVzKHtcbiAgICAgICAgY29tbWVudElkLFxuICAgICAgICBzZWxsZXJJZCxcbiAgICAgICAgcmVwbHksXG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgbmV3UmVwbHkuc2F2ZSgpO1xuXG4gICAgICByZXMuc3RhdHVzKDIwMSkuanNvbih7XG4gICAgICAgIG1lc3NhZ2U6IFwiUmVwbHkgc3VjY2Vzc2Z1bGx5IGFkZGVkXCIsXG4gICAgICAgIHJlcGx5OiBuZXdSZXBseSxcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcbiAgICAgICAgbWVzc2FnZTogXCJDYW5ub3QgYWRkIHJlcGx5XCIsXG4gICAgICAgIGVycm9yQ29kZTogXCJDYW5ub3RBZGRSZXBseVwiLFxuICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG59O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxTQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxTQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxRQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRyxZQUFBLEdBQUFILE9BQUE7QUFJQSxJQUFBSSxRQUFBLEdBQUFMLHNCQUFBLENBQUFDLE9BQUE7QUFBNkMsU0FBQUQsdUJBQUFNLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFBQSxJQUFBRyxRQUFBLEdBRTdCQyxNQUFNLElBQUs7RUFDekJBLE1BQU0sQ0FBQ0MsSUFBSSxDQUFDLFVBQVUsRUFBRUMsZ0JBQU8sRUFBRSxPQUFPQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztJQUNuRCxJQUFBQyw2QkFBZ0IsRUFBQ0YsR0FBRyxDQUFDRyxJQUFJLEVBQUUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUM7O0lBRXhDLElBQUk7TUFDRixNQUFNO1FBQUVDLFNBQVM7UUFBRUM7TUFBTSxDQUFDLEdBQUdMLEdBQUcsQ0FBQ00sSUFBSTtNQUNyQyxNQUFNQyxRQUFRLEdBQUdQLEdBQUcsQ0FBQ0csSUFBSSxDQUFDSyxHQUFHLENBQUMsQ0FBQzs7TUFFL0I7TUFDQSxNQUFNQyxPQUFPLEdBQUcsTUFBTUMsaUJBQVEsQ0FBQ0MsUUFBUSxDQUFDUCxTQUFTLENBQUMsQ0FBQ1EsUUFBUSxDQUFDLFdBQVcsQ0FBQztNQUN4RSxJQUFJLENBQUNILE9BQU8sRUFBRTtRQUNaLE9BQU9SLEdBQUcsQ0FBQ1ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7VUFDMUJDLE9BQU8sRUFBRSxtQkFBbUI7VUFDNUJDLFNBQVMsRUFBRTtRQUNiLENBQUMsQ0FBQztNQUNKO01BQ0EsTUFBTUMsT0FBTyxHQUFHLE1BQU1DLGlCQUFRLENBQUNQLFFBQVEsQ0FBQ0YsT0FBTyxDQUFDVSxTQUFTLENBQUM7TUFDMUQsSUFBSSxDQUFDRixPQUFPLEVBQUU7UUFDWixNQUFNLElBQUlHLFFBQVEsQ0FBQyxtQkFBbUIsRUFBRSxHQUFHLEVBQUUsaUJBQWlCLENBQUM7TUFDakU7TUFFQSxJQUFBQyx3Q0FBMkIsRUFBQ3JCLEdBQUcsQ0FBQ0csSUFBSSxFQUFFTSxPQUFPLEVBQUVRLE9BQU8sQ0FBQzs7TUFFdkQ7TUFDQSxNQUFNSyxRQUFRLEdBQUcsSUFBSUMsZ0JBQU8sQ0FBQztRQUMzQm5CLFNBQVM7UUFDVEcsUUFBUTtRQUNSRjtNQUNGLENBQUMsQ0FBQztNQUVGLE1BQU1pQixRQUFRLENBQUNFLElBQUksQ0FBQyxDQUFDO01BRXJCdkIsR0FBRyxDQUFDWSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztRQUNuQkMsT0FBTyxFQUFFLDBCQUEwQjtRQUNuQ1YsS0FBSyxFQUFFaUI7TUFDVCxDQUFDLENBQUM7SUFDSixDQUFDLENBQUMsT0FBT0csS0FBSyxFQUFFO01BQ2RDLE9BQU8sQ0FBQ0QsS0FBSyxDQUFDQSxLQUFLLENBQUM7TUFDcEJ4QixHQUFHLENBQUNZLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO1FBQ25CQyxPQUFPLEVBQUUsa0JBQWtCO1FBQzNCQyxTQUFTLEVBQUUsZ0JBQWdCO1FBQzNCUyxLQUFLLEVBQUVBLEtBQUssQ0FBQ1Y7TUFDZixDQUFDLENBQUM7SUFDSjtFQUNGLENBQUMsQ0FBQztBQUNKLENBQUM7QUFBQVksT0FBQSxDQUFBaEMsT0FBQSxHQUFBQyxRQUFBIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["_comments","_interopRequireDefault","require","_products","_replies","_Permissions","_Session","e","__esModule","default","_default","router","post","Session","req","res","checkPermissions","user","commentId","reply","body","sellerId","_id","comment","Comments","findById","populate","status","json","message","errorCode","product","Products","productId","ApiError","checkCommentForProductOwner","newReply","Replies","save","error","console","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["Replies.js"],"sourcesContent":["import Comments from \"../db/comments\";\nimport Products from \"../db/products\";\nimport Replies from \"../db/replies\";\nimport {\n  checkCommentForProductOwner,\n  checkPermissions,\n} from \"../helpers/Permissions\";\nimport Session from \"../middlewares/Session\";\n\nexport default (router) => {\n  router.post(\"/replies\", Session, async (req, res) => {\n    checkPermissions(req.user, [\"seller\"]); // Sadece satıcılar yanıt verebilir\n\n    try {\n      const { commentId, reply } = req.body;\n      const sellerId = req.user._id; // Giriş yapan satıcı\n\n      // Yorumun varlığını kontrol et\n      const comment = await Comments.findById(commentId).populate(\"productId\");\n      if (!comment) {\n        return res.status(404).json({\n          message: \"Comment not found\",\n          errorCode: \"CommentNotFound\",\n        });\n      }\n      const product = await Products.findById(comment.productId);\n      if (!product) {\n        throw new ApiError(\"Product not found\", 404, \"productNotFound\");\n      }\n\n      checkCommentForProductOwner(req.user, comment, product);\n\n      // Yanıtı kaydet\n      const newReply = new Replies({\n        commentId,\n        sellerId,\n        reply,\n      });\n\n      await newReply.save();\n\n      res.status(201).json({\n        message: \"Reply successfully added\",\n        reply: newReply,\n      });\n    } catch (error) {\n      console.error(error);\n      res.status(400).json({\n        message: \"Cannot add reply\",\n        errorCode: \"CannotAddReply\",\n        error: error.message,\n      });\n    }\n  });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,QAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,YAAA,GAAAH,OAAA;AAIA,IAAAI,QAAA,GAAAL,sBAAA,CAAAC,OAAA;AAA6C,SAAAD,uBAAAM,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAAA,IAAAG,QAAA,GAE7BC,MAAM,IAAK;EACzBA,MAAM,CAACC,IAAI,CAAC,UAAU,EAAEC,gBAAO,EAAE,OAAOC,GAAG,EAAEC,GAAG,KAAK;IACnD,IAAAC,6BAAgB,EAACF,GAAG,CAACG,IAAI,EAAE,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;;IAExC,IAAI;MACF,MAAM;QAAEC,SAAS;QAAEC;MAAM,CAAC,GAAGL,GAAG,CAACM,IAAI;MACrC,MAAMC,QAAQ,GAAGP,GAAG,CAACG,IAAI,CAACK,GAAG,CAAC,CAAC;;MAE/B;MACA,MAAMC,OAAO,GAAG,MAAMC,iBAAQ,CAACC,QAAQ,CAACP,SAAS,CAAC,CAACQ,QAAQ,CAAC,WAAW,CAAC;MACxE,IAAI,CAACH,OAAO,EAAE;QACZ,OAAOR,GAAG,CAACY,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAC1BC,OAAO,EAAE,mBAAmB;UAC5BC,SAAS,EAAE;QACb,CAAC,CAAC;MACJ;MACA,MAAMC,OAAO,GAAG,MAAMC,iBAAQ,CAACP,QAAQ,CAACF,OAAO,CAACU,SAAS,CAAC;MAC1D,IAAI,CAACF,OAAO,EAAE;QACZ,MAAM,IAAIG,QAAQ,CAAC,mBAAmB,EAAE,GAAG,EAAE,iBAAiB,CAAC;MACjE;MAEA,IAAAC,wCAA2B,EAACrB,GAAG,CAACG,IAAI,EAAEM,OAAO,EAAEQ,OAAO,CAAC;;MAEvD;MACA,MAAMK,QAAQ,GAAG,IAAIC,gBAAO,CAAC;QAC3BnB,SAAS;QACTG,QAAQ;QACRF;MACF,CAAC,CAAC;MAEF,MAAMiB,QAAQ,CAACE,IAAI,CAAC,CAAC;MAErBvB,GAAG,CAACY,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QACnBC,OAAO,EAAE,0BAA0B;QACnCV,KAAK,EAAEiB;MACT,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOG,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;MACpBxB,GAAG,CAACY,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QACnBC,OAAO,EAAE,kBAAkB;QAC3BC,SAAS,EAAE,gBAAgB;QAC3BS,KAAK,EAAEA,KAAK,CAACV;MACf,CAAC,CAAC;IACJ;EACF,CAAC,CAAC;AACJ,CAAC;AAAAY,OAAA,CAAAhC,OAAA,GAAAC,QAAA","ignoreList":[]}},"mtime":1734614370468},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/Replies.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _comments = _interopRequireDefault(require(\"../db/comments\"));\nvar _products = _interopRequireDefault(require(\"../db/products\"));\nvar _replies = _interopRequireDefault(require(\"../db/replies\"));\nvar _Permissions = require(\"../helpers/Permissions\");\nvar _Session = _interopRequireDefault(require(\"../middlewares/Session\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nvar _default = router => {\n  router.post(\"/replies\", _Session.default, async (req, res) => {\n    (0, _Permissions.checkPermissions)(req.user, [\"seller\"]); // Sadece satıcılar yanıt verebilir\n\n    try {\n      const {\n        commentId,\n        reply\n      } = req.body;\n      const sellerId = req.user._id; // Giriş yapan satıcı\n\n      // Yorumun varlığını kontrol et\n      const comment = await _comments.default.findById(commentId).populate(\"productId\");\n      if (!comment) {\n        return res.status(404).json({\n          message: \"Comment not found\",\n          errorCode: \"CommentNotFound\"\n        });\n      }\n      const product = await _products.default.findById(comment.productId);\n      if (!product) {\n        throw new ApiError(\"Product not found\", 404, \"productNotFound\");\n      }\n      (0, _Permissions.checkCommentForProductOwner)(req.user, comment, product);\n\n      // Yanıtı kaydet\n      const newReply = new _replies.default({\n        commentId,\n        sellerId,\n        reply\n      });\n      await newReply.save();\n      res.status(201).json({\n        message: \"Reply successfully added\",\n        reply: newReply\n      });\n    } catch (error) {\n      console.error(error);\n      res.status(400).json({\n        message: \"Cannot add reply\",\n        errorCode: \"CannotAddReply\",\n        error: error.message\n      });\n    }\n  });\n};\nexports.default = _default;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfY29tbWVudHMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9wcm9kdWN0cyIsIl9yZXBsaWVzIiwiX1Blcm1pc3Npb25zIiwiX1Nlc3Npb24iLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfZGVmYXVsdCIsInJvdXRlciIsInBvc3QiLCJTZXNzaW9uIiwicmVxIiwicmVzIiwiY2hlY2tQZXJtaXNzaW9ucyIsInVzZXIiLCJjb21tZW50SWQiLCJyZXBseSIsImJvZHkiLCJzZWxsZXJJZCIsIl9pZCIsImNvbW1lbnQiLCJDb21tZW50cyIsImZpbmRCeUlkIiwicG9wdWxhdGUiLCJzdGF0dXMiLCJqc29uIiwibWVzc2FnZSIsImVycm9yQ29kZSIsInByb2R1Y3QiLCJQcm9kdWN0cyIsInByb2R1Y3RJZCIsIkFwaUVycm9yIiwiY2hlY2tDb21tZW50Rm9yUHJvZHVjdE93bmVyIiwibmV3UmVwbHkiLCJSZXBsaWVzIiwic2F2ZSIsImVycm9yIiwiY29uc29sZSIsImV4cG9ydHMiXSwic291cmNlUm9vdCI6Ii9Vc2Vycy9hdGsvRGVza3RvcC9BUFAvTm9kZUpTL1pleWRhbF9CYWNrZW5kX0RldmVsb3BtZW50L3NyYy9yb3V0ZXMvIiwic291cmNlcyI6WyJSZXBsaWVzLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDb21tZW50cyBmcm9tIFwiLi4vZGIvY29tbWVudHNcIjtcbmltcG9ydCBQcm9kdWN0cyBmcm9tIFwiLi4vZGIvcHJvZHVjdHNcIjtcbmltcG9ydCBSZXBsaWVzIGZyb20gXCIuLi9kYi9yZXBsaWVzXCI7XG5pbXBvcnQge1xuICBjaGVja0NvbW1lbnRGb3JQcm9kdWN0T3duZXIsXG4gIGNoZWNrUGVybWlzc2lvbnMsXG59IGZyb20gXCIuLi9oZWxwZXJzL1Blcm1pc3Npb25zXCI7XG5pbXBvcnQgU2Vzc2lvbiBmcm9tIFwiLi4vbWlkZGxld2FyZXMvU2Vzc2lvblwiO1xuXG5leHBvcnQgZGVmYXVsdCAocm91dGVyKSA9PiB7XG4gIHJvdXRlci5wb3N0KFwiL3JlcGxpZXNcIiwgU2Vzc2lvbiwgYXN5bmMgKHJlcSwgcmVzKSA9PiB7XG4gICAgY2hlY2tQZXJtaXNzaW9ucyhyZXEudXNlciwgW1wic2VsbGVyXCJdKTsgLy8gU2FkZWNlIHNhdMSxY8SxbGFyIHlhbsSxdCB2ZXJlYmlsaXJcblxuICAgIHRyeSB7XG4gICAgICBjb25zdCB7IGNvbW1lbnRJZCwgcmVwbHkgfSA9IHJlcS5ib2R5O1xuICAgICAgY29uc3Qgc2VsbGVySWQgPSByZXEudXNlci5faWQ7IC8vIEdpcmnFnyB5YXBhbiBzYXTEsWPEsVxuXG4gICAgICAvLyBZb3J1bXVuIHZhcmzEscSfxLFuxLEga29udHJvbCBldFxuICAgICAgY29uc3QgY29tbWVudCA9IGF3YWl0IENvbW1lbnRzLmZpbmRCeUlkKGNvbW1lbnRJZCkucG9wdWxhdGUoXCJwcm9kdWN0SWRcIik7XG4gICAgICBpZiAoIWNvbW1lbnQpIHtcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHtcbiAgICAgICAgICBtZXNzYWdlOiBcIkNvbW1lbnQgbm90IGZvdW5kXCIsXG4gICAgICAgICAgZXJyb3JDb2RlOiBcIkNvbW1lbnROb3RGb3VuZFwiLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHByb2R1Y3QgPSBhd2FpdCBQcm9kdWN0cy5maW5kQnlJZChjb21tZW50LnByb2R1Y3RJZCk7XG4gICAgICBpZiAoIXByb2R1Y3QpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiUHJvZHVjdCBub3QgZm91bmRcIiwgNDA0LCBcInByb2R1Y3ROb3RGb3VuZFwiKTtcbiAgICAgIH1cblxuICAgICAgY2hlY2tDb21tZW50Rm9yUHJvZHVjdE93bmVyKHJlcS51c2VyLCBjb21tZW50LCBwcm9kdWN0KTtcblxuICAgICAgLy8gWWFuxLF0xLEga2F5ZGV0XG4gICAgICBjb25zdCBuZXdSZXBseSA9IG5ldyBSZXBsaWVzKHtcbiAgICAgICAgY29tbWVudElkLFxuICAgICAgICBzZWxsZXJJZCxcbiAgICAgICAgcmVwbHksXG4gICAgICB9KTtcblxuICAgICAgYXdhaXQgbmV3UmVwbHkuc2F2ZSgpO1xuXG4gICAgICByZXMuc3RhdHVzKDIwMSkuanNvbih7XG4gICAgICAgIG1lc3NhZ2U6IFwiUmVwbHkgc3VjY2Vzc2Z1bGx5IGFkZGVkXCIsXG4gICAgICAgIHJlcGx5OiBuZXdSZXBseSxcbiAgICAgIH0pO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICAgIHJlcy5zdGF0dXMoNDAwKS5qc29uKHtcbiAgICAgICAgbWVzc2FnZTogXCJDYW5ub3QgYWRkIHJlcGx5XCIsXG4gICAgICAgIGVycm9yQ29kZTogXCJDYW5ub3RBZGRSZXBseVwiLFxuICAgICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSxcbiAgICAgIH0pO1xuICAgIH1cbiAgfSk7XG59O1xuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxTQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxTQUFBLEdBQUFGLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRSxRQUFBLEdBQUFILHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBRyxZQUFBLEdBQUFILE9BQUE7QUFJQSxJQUFBSSxRQUFBLEdBQUFMLHNCQUFBLENBQUFDLE9BQUE7QUFBNkMsU0FBQUQsdUJBQUFNLENBQUEsV0FBQUEsQ0FBQSxJQUFBQSxDQUFBLENBQUFDLFVBQUEsR0FBQUQsQ0FBQSxLQUFBRSxPQUFBLEVBQUFGLENBQUE7QUFBQSxJQUFBRyxRQUFBLEdBRTdCQyxNQUFNLElBQUs7RUFDekJBLE1BQU0sQ0FBQ0MsSUFBSSxDQUFDLFVBQVUsRUFBRUMsZ0JBQU8sRUFBRSxPQUFPQyxHQUFHLEVBQUVDLEdBQUcsS0FBSztJQUNuRCxJQUFBQyw2QkFBZ0IsRUFBQ0YsR0FBRyxDQUFDRyxJQUFJLEVBQUUsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLENBQUM7O0lBRXhDLElBQUk7TUFDRixNQUFNO1FBQUVDLFNBQVM7UUFBRUM7TUFBTSxDQUFDLEdBQUdMLEdBQUcsQ0FBQ00sSUFBSTtNQUNyQyxNQUFNQyxRQUFRLEdBQUdQLEdBQUcsQ0FBQ0csSUFBSSxDQUFDSyxHQUFHLENBQUMsQ0FBQzs7TUFFL0I7TUFDQSxNQUFNQyxPQUFPLEdBQUcsTUFBTUMsaUJBQVEsQ0FBQ0MsUUFBUSxDQUFDUCxTQUFTLENBQUMsQ0FBQ1EsUUFBUSxDQUFDLFdBQVcsQ0FBQztNQUN4RSxJQUFJLENBQUNILE9BQU8sRUFBRTtRQUNaLE9BQU9SLEdBQUcsQ0FBQ1ksTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7VUFDMUJDLE9BQU8sRUFBRSxtQkFBbUI7VUFDNUJDLFNBQVMsRUFBRTtRQUNiLENBQUMsQ0FBQztNQUNKO01BQ0EsTUFBTUMsT0FBTyxHQUFHLE1BQU1DLGlCQUFRLENBQUNQLFFBQVEsQ0FBQ0YsT0FBTyxDQUFDVSxTQUFTLENBQUM7TUFDMUQsSUFBSSxDQUFDRixPQUFPLEVBQUU7UUFDWixNQUFNLElBQUlHLFFBQVEsQ0FBQyxtQkFBbUIsRUFBRSxHQUFHLEVBQUUsaUJBQWlCLENBQUM7TUFDakU7TUFFQSxJQUFBQyx3Q0FBMkIsRUFBQ3JCLEdBQUcsQ0FBQ0csSUFBSSxFQUFFTSxPQUFPLEVBQUVRLE9BQU8sQ0FBQzs7TUFFdkQ7TUFDQSxNQUFNSyxRQUFRLEdBQUcsSUFBSUMsZ0JBQU8sQ0FBQztRQUMzQm5CLFNBQVM7UUFDVEcsUUFBUTtRQUNSRjtNQUNGLENBQUMsQ0FBQztNQUVGLE1BQU1pQixRQUFRLENBQUNFLElBQUksQ0FBQyxDQUFDO01BRXJCdkIsR0FBRyxDQUFDWSxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztRQUNuQkMsT0FBTyxFQUFFLDBCQUEwQjtRQUNuQ1YsS0FBSyxFQUFFaUI7TUFDVCxDQUFDLENBQUM7SUFDSixDQUFDLENBQUMsT0FBT0csS0FBSyxFQUFFO01BQ2RDLE9BQU8sQ0FBQ0QsS0FBSyxDQUFDQSxLQUFLLENBQUM7TUFDcEJ4QixHQUFHLENBQUNZLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQ0MsSUFBSSxDQUFDO1FBQ25CQyxPQUFPLEVBQUUsa0JBQWtCO1FBQzNCQyxTQUFTLEVBQUUsZ0JBQWdCO1FBQzNCUyxLQUFLLEVBQUVBLEtBQUssQ0FBQ1Y7TUFDZixDQUFDLENBQUM7SUFDSjtFQUNGLENBQUMsQ0FBQztBQUNKLENBQUM7QUFBQVksT0FBQSxDQUFBaEMsT0FBQSxHQUFBQyxRQUFBIiwiaWdub3JlTGlzdCI6W119","map":{"version":3,"names":["_comments","_interopRequireDefault","require","_products","_replies","_Permissions","_Session","e","__esModule","default","_default","router","post","Session","req","res","checkPermissions","user","commentId","reply","body","sellerId","_id","comment","Comments","findById","populate","status","json","message","errorCode","product","Products","productId","ApiError","checkCommentForProductOwner","newReply","Replies","save","error","console","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/routes/","sources":["Replies.js"],"sourcesContent":["import Comments from \"../db/comments\";\nimport Products from \"../db/products\";\nimport Replies from \"../db/replies\";\nimport {\n  checkCommentForProductOwner,\n  checkPermissions,\n} from \"../helpers/Permissions\";\nimport Session from \"../middlewares/Session\";\n\nexport default (router) => {\n  router.post(\"/replies\", Session, async (req, res) => {\n    checkPermissions(req.user, [\"seller\"]); // Sadece satıcılar yanıt verebilir\n\n    try {\n      const { commentId, reply } = req.body;\n      const sellerId = req.user._id; // Giriş yapan satıcı\n\n      // Yorumun varlığını kontrol et\n      const comment = await Comments.findById(commentId).populate(\"productId\");\n      if (!comment) {\n        return res.status(404).json({\n          message: \"Comment not found\",\n          errorCode: \"CommentNotFound\",\n        });\n      }\n      const product = await Products.findById(comment.productId);\n      if (!product) {\n        throw new ApiError(\"Product not found\", 404, \"productNotFound\");\n      }\n\n      checkCommentForProductOwner(req.user, comment, product);\n\n      // Yanıtı kaydet\n      const newReply = new Replies({\n        commentId,\n        sellerId,\n        reply,\n      });\n\n      await newReply.save();\n\n      res.status(201).json({\n        message: \"Reply successfully added\",\n        reply: newReply,\n      });\n    } catch (error) {\n      console.error(error);\n      res.status(400).json({\n        message: \"Cannot add reply\",\n        errorCode: \"CannotAddReply\",\n        error: error.message,\n      });\n    }\n  });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,SAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,QAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,YAAA,GAAAH,OAAA;AAIA,IAAAI,QAAA,GAAAL,sBAAA,CAAAC,OAAA;AAA6C,SAAAD,uBAAAM,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAAA,IAAAG,QAAA,GAE7BC,MAAM,IAAK;EACzBA,MAAM,CAACC,IAAI,CAAC,UAAU,EAAEC,gBAAO,EAAE,OAAOC,GAAG,EAAEC,GAAG,KAAK;IACnD,IAAAC,6BAAgB,EAACF,GAAG,CAACG,IAAI,EAAE,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC;;IAExC,IAAI;MACF,MAAM;QAAEC,SAAS;QAAEC;MAAM,CAAC,GAAGL,GAAG,CAACM,IAAI;MACrC,MAAMC,QAAQ,GAAGP,GAAG,CAACG,IAAI,CAACK,GAAG,CAAC,CAAC;;MAE/B;MACA,MAAMC,OAAO,GAAG,MAAMC,iBAAQ,CAACC,QAAQ,CAACP,SAAS,CAAC,CAACQ,QAAQ,CAAC,WAAW,CAAC;MACxE,IAAI,CAACH,OAAO,EAAE;QACZ,OAAOR,GAAG,CAACY,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;UAC1BC,OAAO,EAAE,mBAAmB;UAC5BC,SAAS,EAAE;QACb,CAAC,CAAC;MACJ;MACA,MAAMC,OAAO,GAAG,MAAMC,iBAAQ,CAACP,QAAQ,CAACF,OAAO,CAACU,SAAS,CAAC;MAC1D,IAAI,CAACF,OAAO,EAAE;QACZ,MAAM,IAAIG,QAAQ,CAAC,mBAAmB,EAAE,GAAG,EAAE,iBAAiB,CAAC;MACjE;MAEA,IAAAC,wCAA2B,EAACrB,GAAG,CAACG,IAAI,EAAEM,OAAO,EAAEQ,OAAO,CAAC;;MAEvD;MACA,MAAMK,QAAQ,GAAG,IAAIC,gBAAO,CAAC;QAC3BnB,SAAS;QACTG,QAAQ;QACRF;MACF,CAAC,CAAC;MAEF,MAAMiB,QAAQ,CAACE,IAAI,CAAC,CAAC;MAErBvB,GAAG,CAACY,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QACnBC,OAAO,EAAE,0BAA0B;QACnCV,KAAK,EAAEiB;MACT,CAAC,CAAC;IACJ,CAAC,CAAC,OAAOG,KAAK,EAAE;MACdC,OAAO,CAACD,KAAK,CAACA,KAAK,CAAC;MACpBxB,GAAG,CAACY,MAAM,CAAC,GAAG,CAAC,CAACC,IAAI,CAAC;QACnBC,OAAO,EAAE,kBAAkB;QAC3BC,SAAS,EAAE,gBAAgB;QAC3BS,KAAK,EAAEA,KAAK,CAACV;MACf,CAAC,CAAC;IACJ;EACF,CAAC,CAAC;AACJ,CAAC;AAAAY,OAAA,CAAAhC,OAAA,GAAAC,QAAA","ignoreList":[]}},"mtime":1734614370468},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/status_chart.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getStatusSummaryForSeller = void 0;\nvar _cart = _interopRequireDefault(require(\"../../../db/cart\"));\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\n// Durum özet fonksiyonu\nconst getStatusSummaryForSeller = async sellerId => {\n  const orders = await _cart.default.find({\n    \"products.seller\": sellerId\n  });\n  const statusCounts = {\n    pending: 0,\n    processing: 0,\n    completed: 0\n  };\n  orders.forEach(order => {\n    order.products.forEach(product => {\n      if (product.seller.toString() === sellerId.toString()) {\n        if (statusCounts[product.status] !== undefined) {\n          statusCounts[product.status]++;\n        }\n      }\n    });\n  });\n  return statusCounts;\n};\nexports.getStatusSummaryForSeller = getStatusSummaryForSeller;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfY2FydCIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiZSIsIl9fZXNNb2R1bGUiLCJkZWZhdWx0IiwiZ2V0U3RhdHVzU3VtbWFyeUZvclNlbGxlciIsInNlbGxlcklkIiwib3JkZXJzIiwiQ2FydCIsImZpbmQiLCJzdGF0dXNDb3VudHMiLCJwZW5kaW5nIiwicHJvY2Vzc2luZyIsImNvbXBsZXRlZCIsImZvckVhY2giLCJvcmRlciIsInByb2R1Y3RzIiwicHJvZHVjdCIsInNlbGxlciIsInRvU3RyaW5nIiwic3RhdHVzIiwidW5kZWZpbmVkIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3NlcnZpY2VzL2l5emljby9tZXRob2RzLyIsInNvdXJjZXMiOlsic3RhdHVzX2NoYXJ0LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDYXJ0IGZyb20gXCIuLi8uLi8uLi9kYi9jYXJ0XCI7XG5cbi8vIER1cnVtIMO2emV0IGZvbmtzaXlvbnVcbmV4cG9ydCBjb25zdCBnZXRTdGF0dXNTdW1tYXJ5Rm9yU2VsbGVyID0gYXN5bmMgKHNlbGxlcklkKSA9PiB7XG4gIGNvbnN0IG9yZGVycyA9IGF3YWl0IENhcnQuZmluZCh7IFwicHJvZHVjdHMuc2VsbGVyXCI6IHNlbGxlcklkIH0pO1xuXG4gIGNvbnN0IHN0YXR1c0NvdW50cyA9IHtcbiAgICBwZW5kaW5nOiAwLFxuICAgIHByb2Nlc3Npbmc6IDAsXG4gICAgY29tcGxldGVkOiAwLFxuICB9O1xuXG4gIG9yZGVycy5mb3JFYWNoKChvcmRlcikgPT4ge1xuICAgIG9yZGVyLnByb2R1Y3RzLmZvckVhY2goKHByb2R1Y3QpID0+IHtcbiAgICAgIGlmIChwcm9kdWN0LnNlbGxlci50b1N0cmluZygpID09PSBzZWxsZXJJZC50b1N0cmluZygpKSB7XG4gICAgICAgIGlmIChzdGF0dXNDb3VudHNbcHJvZHVjdC5zdGF0dXNdICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICBzdGF0dXNDb3VudHNbcHJvZHVjdC5zdGF0dXNdKys7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG5cbiAgcmV0dXJuIHN0YXR1c0NvdW50cztcbn07XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLEtBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUFvQyxTQUFBRCx1QkFBQUUsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUVwQztBQUNPLE1BQU1HLHlCQUF5QixHQUFHLE1BQU9DLFFBQVEsSUFBSztFQUMzRCxNQUFNQyxNQUFNLEdBQUcsTUFBTUMsYUFBSSxDQUFDQyxJQUFJLENBQUM7SUFBRSxpQkFBaUIsRUFBRUg7RUFBUyxDQUFDLENBQUM7RUFFL0QsTUFBTUksWUFBWSxHQUFHO0lBQ25CQyxPQUFPLEVBQUUsQ0FBQztJQUNWQyxVQUFVLEVBQUUsQ0FBQztJQUNiQyxTQUFTLEVBQUU7RUFDYixDQUFDO0VBRUROLE1BQU0sQ0FBQ08sT0FBTyxDQUFFQyxLQUFLLElBQUs7SUFDeEJBLEtBQUssQ0FBQ0MsUUFBUSxDQUFDRixPQUFPLENBQUVHLE9BQU8sSUFBSztNQUNsQyxJQUFJQSxPQUFPLENBQUNDLE1BQU0sQ0FBQ0MsUUFBUSxDQUFDLENBQUMsS0FBS2IsUUFBUSxDQUFDYSxRQUFRLENBQUMsQ0FBQyxFQUFFO1FBQ3JELElBQUlULFlBQVksQ0FBQ08sT0FBTyxDQUFDRyxNQUFNLENBQUMsS0FBS0MsU0FBUyxFQUFFO1VBQzlDWCxZQUFZLENBQUNPLE9BQU8sQ0FBQ0csTUFBTSxDQUFDLEVBQUU7UUFDaEM7TUFDRjtJQUNGLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQztFQUVGLE9BQU9WLFlBQVk7QUFDckIsQ0FBQztBQUFDWSxPQUFBLENBQUFqQix5QkFBQSxHQUFBQSx5QkFBQSIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_cart","_interopRequireDefault","require","e","__esModule","default","getStatusSummaryForSeller","sellerId","orders","Cart","find","statusCounts","pending","processing","completed","forEach","order","products","product","seller","toString","status","undefined","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/services/iyzico/methods/","sources":["status_chart.js"],"sourcesContent":["import Cart from \"../../../db/cart\";\n\n// Durum özet fonksiyonu\nexport const getStatusSummaryForSeller = async (sellerId) => {\n  const orders = await Cart.find({ \"products.seller\": sellerId });\n\n  const statusCounts = {\n    pending: 0,\n    processing: 0,\n    completed: 0,\n  };\n\n  orders.forEach((order) => {\n    order.products.forEach((product) => {\n      if (product.seller.toString() === sellerId.toString()) {\n        if (statusCounts[product.status] !== undefined) {\n          statusCounts[product.status]++;\n        }\n      }\n    });\n  });\n\n  return statusCounts;\n};\n"],"mappings":";;;;;;AAAA,IAAAA,KAAA,GAAAC,sBAAA,CAAAC,OAAA;AAAoC,SAAAD,uBAAAE,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEpC;AACO,MAAMG,yBAAyB,GAAG,MAAOC,QAAQ,IAAK;EAC3D,MAAMC,MAAM,GAAG,MAAMC,aAAI,CAACC,IAAI,CAAC;IAAE,iBAAiB,EAAEH;EAAS,CAAC,CAAC;EAE/D,MAAMI,YAAY,GAAG;IACnBC,OAAO,EAAE,CAAC;IACVC,UAAU,EAAE,CAAC;IACbC,SAAS,EAAE;EACb,CAAC;EAEDN,MAAM,CAACO,OAAO,CAAEC,KAAK,IAAK;IACxBA,KAAK,CAACC,QAAQ,CAACF,OAAO,CAAEG,OAAO,IAAK;MAClC,IAAIA,OAAO,CAACC,MAAM,CAACC,QAAQ,CAAC,CAAC,KAAKb,QAAQ,CAACa,QAAQ,CAAC,CAAC,EAAE;QACrD,IAAIT,YAAY,CAACO,OAAO,CAACG,MAAM,CAAC,KAAKC,SAAS,EAAE;UAC9CX,YAAY,CAACO,OAAO,CAACG,MAAM,CAAC,EAAE;QAChC;MACF;IACF,CAAC,CAAC;EACJ,CAAC,CAAC;EAEF,OAAOV,YAAY;AACrB,CAAC;AAACY,OAAA,CAAAjB,yBAAA,GAAAA,yBAAA","ignoreList":[]}},"mtime":1734871091416},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/repositories/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/repositories/seller_repository.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]},\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{\"_exploded\":true,\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.updateSellerInDatabase = void 0;\nvar _seller = _interopRequireDefault(require(\"../db/seller\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _submerchant = require(\"../services/iyzico/methods/submerchant\");\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst updateSellerInDatabase = async ({\n  seller,\n  name,\n  gsmNumber,\n  iban,\n  address,\n  logoPath\n}) => {\n  const {\n    subMerchantType,\n    subMerchantKey,\n    email,\n    legalCompanyTitle,\n    taxOffice,\n    taxNumber,\n    identityNumber\n  } = seller;\n  if (!subMerchantType) {\n    throw new _ApiError.default(\"Merchant type not found\", 400, \"missingSubMerchantType\");\n  }\n\n  // gsmNumber kontrolü\n  if (gsmNumber) {\n    const existingSeller = await _seller.default.findOne({\n      gsmNumber\n    });\n    if (existingSeller && existingSeller._id.toString() !== seller._id.toString()) {\n      throw new _ApiError.default(\"This phone number is already in use\", 400, \"phoneNumberAlreadyUsing\");\n    }\n  }\n\n  // Güncellenecek alanlar\n  const updateFields = {\n    ...(name && {\n      name\n    }),\n    ...(gsmNumber && {\n      gsmNumber\n    }),\n    ...(iban && {\n      iban\n    }),\n    ...(address && {\n      address\n    }),\n    subMerchantKey,\n    email,\n    legalCompanyTitle,\n    taxNumber,\n    taxOffice,\n    identityNumber\n  };\n  if (logoPath) {\n    updateFields.logo = logoPath;\n  }\n\n  // İyzico API çağrısı: Şirket tipine göre uygun method\n  let iyzicoResponse;\n  let updateSeller = null;\n  if (subMerchantType === \"PRIVATE_COMPANY\") {\n    iyzicoResponse = await (0, _submerchant.updatePrivateSubMerchant)(updateFields);\n  } else if (subMerchantType === \"LIMITED_OR_JOINT_STOCK_COMPANY\") {\n    iyzicoResponse = await (0, _submerchant.updateLimitedOrJointSubMerchant)(updateFields);\n  } else {\n    throw new _ApiError.default(\"Invalid company type\", 400, \"invalidCompanyType\");\n  }\n\n  // Yerel veritabanında satıcıyı güncelle\n  if (iyzicoResponse.status === \"success\") {\n    const updateSeller = await _seller.default.findByIdAndUpdate(seller._id, updateFields, {\n      new: true\n    });\n    if (!updateSeller) {\n      throw new _ApiError.default(\"Seller not found\", 400, \"notFoundSeller\");\n    }\n  } else {\n    console.log(\"iyzico tarafında success olmadığı için veritabanında güncelleme olmamıştır.\");\n  }\n  return {\n    updateSeller,\n    iyzicoResponse\n  };\n};\nexports.updateSellerInDatabase = updateSellerInDatabase;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfc2VsbGVyIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfQXBpRXJyb3IiLCJfc3VibWVyY2hhbnQiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJ1cGRhdGVTZWxsZXJJbkRhdGFiYXNlIiwic2VsbGVyIiwibmFtZSIsImdzbU51bWJlciIsImliYW4iLCJhZGRyZXNzIiwibG9nb1BhdGgiLCJzdWJNZXJjaGFudFR5cGUiLCJzdWJNZXJjaGFudEtleSIsImVtYWlsIiwibGVnYWxDb21wYW55VGl0bGUiLCJ0YXhPZmZpY2UiLCJ0YXhOdW1iZXIiLCJpZGVudGl0eU51bWJlciIsIkFwaUVycm9yIiwiZXhpc3RpbmdTZWxsZXIiLCJTZWxsZXIiLCJmaW5kT25lIiwiX2lkIiwidG9TdHJpbmciLCJ1cGRhdGVGaWVsZHMiLCJsb2dvIiwiaXl6aWNvUmVzcG9uc2UiLCJ1cGRhdGVTZWxsZXIiLCJ1cGRhdGVQcml2YXRlU3ViTWVyY2hhbnQiLCJ1cGRhdGVMaW1pdGVkT3JKb2ludFN1Yk1lcmNoYW50Iiwic3RhdHVzIiwiZmluZEJ5SWRBbmRVcGRhdGUiLCJuZXciLCJjb25zb2xlIiwibG9nIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3JlcG9zaXRvcmllcy8iLCJzb3VyY2VzIjpbInNlbGxlcl9yZXBvc2l0b3J5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBTZWxsZXIgZnJvbSBcIi4uL2RiL3NlbGxlclwiO1xuaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuLi9lcnJvcnMvQXBpRXJyb3JcIjtcbmltcG9ydCB7XG4gIHVwZGF0ZUxpbWl0ZWRPckpvaW50U3ViTWVyY2hhbnQsXG4gIHVwZGF0ZVByaXZhdGVTdWJNZXJjaGFudCxcbn0gZnJvbSBcIi4uL3NlcnZpY2VzL2l5emljby9tZXRob2RzL3N1Ym1lcmNoYW50XCI7XG5cbmV4cG9ydCBjb25zdCB1cGRhdGVTZWxsZXJJbkRhdGFiYXNlID0gYXN5bmMgKHtcbiAgc2VsbGVyLFxuICBuYW1lLFxuICBnc21OdW1iZXIsXG4gIGliYW4sXG4gIGFkZHJlc3MsXG4gIGxvZ29QYXRoLFxufSkgPT4ge1xuICBjb25zdCB7XG4gICAgc3ViTWVyY2hhbnRUeXBlLFxuICAgIHN1Yk1lcmNoYW50S2V5LFxuICAgIGVtYWlsLFxuICAgIGxlZ2FsQ29tcGFueVRpdGxlLFxuICAgIHRheE9mZmljZSxcbiAgICB0YXhOdW1iZXIsXG4gICAgaWRlbnRpdHlOdW1iZXIsXG4gIH0gPSBzZWxsZXI7XG5cbiAgaWYgKCFzdWJNZXJjaGFudFR5cGUpIHtcbiAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICBcIk1lcmNoYW50IHR5cGUgbm90IGZvdW5kXCIsXG4gICAgICA0MDAsXG4gICAgICBcIm1pc3NpbmdTdWJNZXJjaGFudFR5cGVcIlxuICAgICk7XG4gIH1cblxuICAvLyBnc21OdW1iZXIga29udHJvbMO8XG4gIGlmIChnc21OdW1iZXIpIHtcbiAgICBjb25zdCBleGlzdGluZ1NlbGxlciA9IGF3YWl0IFNlbGxlci5maW5kT25lKHsgZ3NtTnVtYmVyIH0pO1xuICAgIGlmIChcbiAgICAgIGV4aXN0aW5nU2VsbGVyICYmXG4gICAgICBleGlzdGluZ1NlbGxlci5faWQudG9TdHJpbmcoKSAhPT0gc2VsbGVyLl9pZC50b1N0cmluZygpXG4gICAgKSB7XG4gICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgIFwiVGhpcyBwaG9uZSBudW1iZXIgaXMgYWxyZWFkeSBpbiB1c2VcIixcbiAgICAgICAgNDAwLFxuICAgICAgICBcInBob25lTnVtYmVyQWxyZWFkeVVzaW5nXCJcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgLy8gR8O8bmNlbGxlbmVjZWsgYWxhbmxhclxuICBjb25zdCB1cGRhdGVGaWVsZHMgPSB7XG4gICAgLi4uKG5hbWUgJiYgeyBuYW1lIH0pLFxuICAgIC4uLihnc21OdW1iZXIgJiYgeyBnc21OdW1iZXIgfSksXG4gICAgLi4uKGliYW4gJiYgeyBpYmFuIH0pLFxuICAgIC4uLihhZGRyZXNzICYmIHsgYWRkcmVzcyB9KSxcbiAgICBzdWJNZXJjaGFudEtleSxcbiAgICBlbWFpbCxcbiAgICBsZWdhbENvbXBhbnlUaXRsZSxcbiAgICB0YXhOdW1iZXIsXG4gICAgdGF4T2ZmaWNlLFxuICAgIGlkZW50aXR5TnVtYmVyLFxuICB9O1xuXG4gIGlmIChsb2dvUGF0aCkge1xuICAgIHVwZGF0ZUZpZWxkcy5sb2dvID0gbG9nb1BhdGg7XG4gIH1cblxuICAvLyDEsHl6aWNvIEFQSSDDp2HEn3LEsXPEsTogxZ5pcmtldCB0aXBpbmUgZ8O2cmUgdXlndW4gbWV0aG9kXG4gIGxldCBpeXppY29SZXNwb25zZTtcbiAgbGV0IHVwZGF0ZVNlbGxlciA9IG51bGw7XG5cbiAgaWYgKHN1Yk1lcmNoYW50VHlwZSA9PT0gXCJQUklWQVRFX0NPTVBBTllcIikge1xuICAgIGl5emljb1Jlc3BvbnNlID0gYXdhaXQgdXBkYXRlUHJpdmF0ZVN1Yk1lcmNoYW50KHVwZGF0ZUZpZWxkcyk7XG4gIH0gZWxzZSBpZiAoc3ViTWVyY2hhbnRUeXBlID09PSBcIkxJTUlURURfT1JfSk9JTlRfU1RPQ0tfQ09NUEFOWVwiKSB7XG4gICAgaXl6aWNvUmVzcG9uc2UgPSBhd2FpdCB1cGRhdGVMaW1pdGVkT3JKb2ludFN1Yk1lcmNoYW50KHVwZGF0ZUZpZWxkcyk7XG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiSW52YWxpZCBjb21wYW55IHR5cGVcIiwgNDAwLCBcImludmFsaWRDb21wYW55VHlwZVwiKTtcbiAgfVxuXG4gIC8vIFllcmVsIHZlcml0YWJhbsSxbmRhIHNhdMSxY8SxecSxIGfDvG5jZWxsZVxuICBpZiAoaXl6aWNvUmVzcG9uc2Uuc3RhdHVzID09PSBcInN1Y2Nlc3NcIikge1xuICAgIGNvbnN0IHVwZGF0ZVNlbGxlciA9IGF3YWl0IFNlbGxlci5maW5kQnlJZEFuZFVwZGF0ZShcbiAgICAgIHNlbGxlci5faWQsXG4gICAgICB1cGRhdGVGaWVsZHMsXG4gICAgICB7IG5ldzogdHJ1ZSB9XG4gICAgKTtcbiAgICBpZiAoIXVwZGF0ZVNlbGxlcikge1xuICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiU2VsbGVyIG5vdCBmb3VuZFwiLCA0MDAsIFwibm90Rm91bmRTZWxsZXJcIik7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGNvbnNvbGUubG9nKFxuICAgICAgXCJpeXppY28gdGFyYWbEsW5kYSBzdWNjZXNzIG9sbWFkxLHEn8SxIGnDp2luIHZlcml0YWJhbsSxbmRhIGfDvG5jZWxsZW1lIG9sbWFtxLHFn3TEsXIuXCJcbiAgICApO1xuICB9XG5cbiAgcmV0dXJuIHsgdXBkYXRlU2VsbGVyLCBpeXppY29SZXNwb25zZSB9O1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsT0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsU0FBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsWUFBQSxHQUFBRixPQUFBO0FBR2dELFNBQUFELHVCQUFBSSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBRXpDLE1BQU1HLHNCQUFzQixHQUFHLE1BQUFBLENBQU87RUFDM0NDLE1BQU07RUFDTkMsSUFBSTtFQUNKQyxTQUFTO0VBQ1RDLElBQUk7RUFDSkMsT0FBTztFQUNQQztBQUNGLENBQUMsS0FBSztFQUNKLE1BQU07SUFDSkMsZUFBZTtJQUNmQyxjQUFjO0lBQ2RDLEtBQUs7SUFDTEMsaUJBQWlCO0lBQ2pCQyxTQUFTO0lBQ1RDLFNBQVM7SUFDVEM7RUFDRixDQUFDLEdBQUdaLE1BQU07RUFFVixJQUFJLENBQUNNLGVBQWUsRUFBRTtJQUNwQixNQUFNLElBQUlPLGlCQUFRLENBQ2hCLHlCQUF5QixFQUN6QixHQUFHLEVBQ0gsd0JBQ0YsQ0FBQztFQUNIOztFQUVBO0VBQ0EsSUFBSVgsU0FBUyxFQUFFO0lBQ2IsTUFBTVksY0FBYyxHQUFHLE1BQU1DLGVBQU0sQ0FBQ0MsT0FBTyxDQUFDO01BQUVkO0lBQVUsQ0FBQyxDQUFDO0lBQzFELElBQ0VZLGNBQWMsSUFDZEEsY0FBYyxDQUFDRyxHQUFHLENBQUNDLFFBQVEsQ0FBQyxDQUFDLEtBQUtsQixNQUFNLENBQUNpQixHQUFHLENBQUNDLFFBQVEsQ0FBQyxDQUFDLEVBQ3ZEO01BQ0EsTUFBTSxJQUFJTCxpQkFBUSxDQUNoQixxQ0FBcUMsRUFDckMsR0FBRyxFQUNILHlCQUNGLENBQUM7SUFDSDtFQUNGOztFQUVBO0VBQ0EsTUFBTU0sWUFBWSxHQUFHO0lBQ25CLElBQUlsQixJQUFJLElBQUk7TUFBRUE7SUFBSyxDQUFDLENBQUM7SUFDckIsSUFBSUMsU0FBUyxJQUFJO01BQUVBO0lBQVUsQ0FBQyxDQUFDO0lBQy9CLElBQUlDLElBQUksSUFBSTtNQUFFQTtJQUFLLENBQUMsQ0FBQztJQUNyQixJQUFJQyxPQUFPLElBQUk7TUFBRUE7SUFBUSxDQUFDLENBQUM7SUFDM0JHLGNBQWM7SUFDZEMsS0FBSztJQUNMQyxpQkFBaUI7SUFDakJFLFNBQVM7SUFDVEQsU0FBUztJQUNURTtFQUNGLENBQUM7RUFFRCxJQUFJUCxRQUFRLEVBQUU7SUFDWmMsWUFBWSxDQUFDQyxJQUFJLEdBQUdmLFFBQVE7RUFDOUI7O0VBRUE7RUFDQSxJQUFJZ0IsY0FBYztFQUNsQixJQUFJQyxZQUFZLEdBQUcsSUFBSTtFQUV2QixJQUFJaEIsZUFBZSxLQUFLLGlCQUFpQixFQUFFO0lBQ3pDZSxjQUFjLEdBQUcsTUFBTSxJQUFBRSxxQ0FBd0IsRUFBQ0osWUFBWSxDQUFDO0VBQy9ELENBQUMsTUFBTSxJQUFJYixlQUFlLEtBQUssZ0NBQWdDLEVBQUU7SUFDL0RlLGNBQWMsR0FBRyxNQUFNLElBQUFHLDRDQUErQixFQUFDTCxZQUFZLENBQUM7RUFDdEUsQ0FBQyxNQUFNO0lBQ0wsTUFBTSxJQUFJTixpQkFBUSxDQUFDLHNCQUFzQixFQUFFLEdBQUcsRUFBRSxvQkFBb0IsQ0FBQztFQUN2RTs7RUFFQTtFQUNBLElBQUlRLGNBQWMsQ0FBQ0ksTUFBTSxLQUFLLFNBQVMsRUFBRTtJQUN2QyxNQUFNSCxZQUFZLEdBQUcsTUFBTVAsZUFBTSxDQUFDVyxpQkFBaUIsQ0FDakQxQixNQUFNLENBQUNpQixHQUFHLEVBQ1ZFLFlBQVksRUFDWjtNQUFFUSxHQUFHLEVBQUU7SUFBSyxDQUNkLENBQUM7SUFDRCxJQUFJLENBQUNMLFlBQVksRUFBRTtNQUNqQixNQUFNLElBQUlULGlCQUFRLENBQUMsa0JBQWtCLEVBQUUsR0FBRyxFQUFFLGdCQUFnQixDQUFDO0lBQy9EO0VBQ0YsQ0FBQyxNQUFNO0lBQ0xlLE9BQU8sQ0FBQ0MsR0FBRyxDQUNULDZFQUNGLENBQUM7RUFDSDtFQUVBLE9BQU87SUFBRVAsWUFBWTtJQUFFRDtFQUFlLENBQUM7QUFDekMsQ0FBQztBQUFDUyxPQUFBLENBQUEvQixzQkFBQSxHQUFBQSxzQkFBQSIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_seller","_interopRequireDefault","require","_ApiError","_submerchant","e","__esModule","default","updateSellerInDatabase","seller","name","gsmNumber","iban","address","logoPath","subMerchantType","subMerchantKey","email","legalCompanyTitle","taxOffice","taxNumber","identityNumber","ApiError","existingSeller","Seller","findOne","_id","toString","updateFields","logo","iyzicoResponse","updateSeller","updatePrivateSubMerchant","updateLimitedOrJointSubMerchant","status","findByIdAndUpdate","new","console","log","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/repositories/","sources":["seller_repository.js"],"sourcesContent":["import Seller from \"../db/seller\";\nimport ApiError from \"../errors/ApiError\";\nimport {\n  updateLimitedOrJointSubMerchant,\n  updatePrivateSubMerchant,\n} from \"../services/iyzico/methods/submerchant\";\n\nexport const updateSellerInDatabase = async ({\n  seller,\n  name,\n  gsmNumber,\n  iban,\n  address,\n  logoPath,\n}) => {\n  const {\n    subMerchantType,\n    subMerchantKey,\n    email,\n    legalCompanyTitle,\n    taxOffice,\n    taxNumber,\n    identityNumber,\n  } = seller;\n\n  if (!subMerchantType) {\n    throw new ApiError(\n      \"Merchant type not found\",\n      400,\n      \"missingSubMerchantType\"\n    );\n  }\n\n  // gsmNumber kontrolü\n  if (gsmNumber) {\n    const existingSeller = await Seller.findOne({ gsmNumber });\n    if (\n      existingSeller &&\n      existingSeller._id.toString() !== seller._id.toString()\n    ) {\n      throw new ApiError(\n        \"This phone number is already in use\",\n        400,\n        \"phoneNumberAlreadyUsing\"\n      );\n    }\n  }\n\n  // Güncellenecek alanlar\n  const updateFields = {\n    ...(name && { name }),\n    ...(gsmNumber && { gsmNumber }),\n    ...(iban && { iban }),\n    ...(address && { address }),\n    subMerchantKey,\n    email,\n    legalCompanyTitle,\n    taxNumber,\n    taxOffice,\n    identityNumber,\n  };\n\n  if (logoPath) {\n    updateFields.logo = logoPath;\n  }\n\n  // İyzico API çağrısı: Şirket tipine göre uygun method\n  let iyzicoResponse;\n  let updateSeller = null;\n\n  if (subMerchantType === \"PRIVATE_COMPANY\") {\n    iyzicoResponse = await updatePrivateSubMerchant(updateFields);\n  } else if (subMerchantType === \"LIMITED_OR_JOINT_STOCK_COMPANY\") {\n    iyzicoResponse = await updateLimitedOrJointSubMerchant(updateFields);\n  } else {\n    throw new ApiError(\"Invalid company type\", 400, \"invalidCompanyType\");\n  }\n\n  // Yerel veritabanında satıcıyı güncelle\n  if (iyzicoResponse.status === \"success\") {\n    const updateSeller = await Seller.findByIdAndUpdate(\n      seller._id,\n      updateFields,\n      { new: true }\n    );\n    if (!updateSeller) {\n      throw new ApiError(\"Seller not found\", 400, \"notFoundSeller\");\n    }\n  } else {\n    console.log(\n      \"iyzico tarafında success olmadığı için veritabanında güncelleme olmamıştır.\"\n    );\n  }\n\n  return { updateSeller, iyzicoResponse };\n};\n"],"mappings":";;;;;;AAAA,IAAAA,OAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,YAAA,GAAAF,OAAA;AAGgD,SAAAD,uBAAAI,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEzC,MAAMG,sBAAsB,GAAG,MAAAA,CAAO;EAC3CC,MAAM;EACNC,IAAI;EACJC,SAAS;EACTC,IAAI;EACJC,OAAO;EACPC;AACF,CAAC,KAAK;EACJ,MAAM;IACJC,eAAe;IACfC,cAAc;IACdC,KAAK;IACLC,iBAAiB;IACjBC,SAAS;IACTC,SAAS;IACTC;EACF,CAAC,GAAGZ,MAAM;EAEV,IAAI,CAACM,eAAe,EAAE;IACpB,MAAM,IAAIO,iBAAQ,CAChB,yBAAyB,EACzB,GAAG,EACH,wBACF,CAAC;EACH;;EAEA;EACA,IAAIX,SAAS,EAAE;IACb,MAAMY,cAAc,GAAG,MAAMC,eAAM,CAACC,OAAO,CAAC;MAAEd;IAAU,CAAC,CAAC;IAC1D,IACEY,cAAc,IACdA,cAAc,CAACG,GAAG,CAACC,QAAQ,CAAC,CAAC,KAAKlB,MAAM,CAACiB,GAAG,CAACC,QAAQ,CAAC,CAAC,EACvD;MACA,MAAM,IAAIL,iBAAQ,CAChB,qCAAqC,EACrC,GAAG,EACH,yBACF,CAAC;IACH;EACF;;EAEA;EACA,MAAMM,YAAY,GAAG;IACnB,IAAIlB,IAAI,IAAI;MAAEA;IAAK,CAAC,CAAC;IACrB,IAAIC,SAAS,IAAI;MAAEA;IAAU,CAAC,CAAC;IAC/B,IAAIC,IAAI,IAAI;MAAEA;IAAK,CAAC,CAAC;IACrB,IAAIC,OAAO,IAAI;MAAEA;IAAQ,CAAC,CAAC;IAC3BG,cAAc;IACdC,KAAK;IACLC,iBAAiB;IACjBE,SAAS;IACTD,SAAS;IACTE;EACF,CAAC;EAED,IAAIP,QAAQ,EAAE;IACZc,YAAY,CAACC,IAAI,GAAGf,QAAQ;EAC9B;;EAEA;EACA,IAAIgB,cAAc;EAClB,IAAIC,YAAY,GAAG,IAAI;EAEvB,IAAIhB,eAAe,KAAK,iBAAiB,EAAE;IACzCe,cAAc,GAAG,MAAM,IAAAE,qCAAwB,EAACJ,YAAY,CAAC;EAC/D,CAAC,MAAM,IAAIb,eAAe,KAAK,gCAAgC,EAAE;IAC/De,cAAc,GAAG,MAAM,IAAAG,4CAA+B,EAACL,YAAY,CAAC;EACtE,CAAC,MAAM;IACL,MAAM,IAAIN,iBAAQ,CAAC,sBAAsB,EAAE,GAAG,EAAE,oBAAoB,CAAC;EACvE;;EAEA;EACA,IAAIQ,cAAc,CAACI,MAAM,KAAK,SAAS,EAAE;IACvC,MAAMH,YAAY,GAAG,MAAMP,eAAM,CAACW,iBAAiB,CACjD1B,MAAM,CAACiB,GAAG,EACVE,YAAY,EACZ;MAAEQ,GAAG,EAAE;IAAK,CACd,CAAC;IACD,IAAI,CAACL,YAAY,EAAE;MACjB,MAAM,IAAIT,iBAAQ,CAAC,kBAAkB,EAAE,GAAG,EAAE,gBAAgB,CAAC;IAC/D;EACF,CAAC,MAAM;IACLe,OAAO,CAACC,GAAG,CACT,6EACF,CAAC;EACH;EAEA,OAAO;IAAEP,YAAY;IAAED;EAAe,CAAC;AACzC,CAAC;AAACS,OAAA,CAAA/B,sBAAA,GAAAA,sBAAA","ignoreList":[]}},"mtime":1735643162424},"{\"assumptions\":{},\"sourceRoot\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/repositories/\",\"caller\":{\"name\":\"@babel/node\"},\"cwd\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"filename\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/repositories/seller_repository.js\",\"targets\":{},\"cloneInputAst\":true,\"babelrc\":false,\"configFile\":false,\"browserslistConfigFile\":false,\"passPerPreset\":false,\"envName\":\"development\",\"root\":\"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development\",\"rootMode\":\"root\",\"plugins\":[{\"key\":\"syntax-class-static-block\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-private-property-in-object\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-class-properties\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-numeric-separator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-nullish-coalescing-operator\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-chaining\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-json-strings\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-optional-catch-binding\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-async-generators\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-object-rest-spread\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-export-namespace-from\",\"visitor\":{\"ExportNamedDeclaration\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-modules-commonjs\",\"visitor\":{\"Program\":{\"exit\":[null]},\"_exploded\":true,\"CallExpression\":{\"enter\":[null]},\"ImportExpression\":{\"enter\":[null]},\"_verified\":true},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"transform-dynamic-import\",\"visitor\":{\"Program\":{\"enter\":[null]}},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-top-level-await\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]},{\"key\":\"syntax-import-meta\",\"visitor\":{},\"options\":{\"spec\":false,\"useBuiltIns\":false},\"externalDependencies\":[]}],\"presets\":[]}:7.24.9:development":{"value":{"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.updateSellerInDatabase = void 0;\nvar _seller = _interopRequireDefault(require(\"../db/seller\"));\nvar _ApiError = _interopRequireDefault(require(\"../errors/ApiError\"));\nvar _submerchant = require(\"../services/iyzico/methods/submerchant\");\nfunction _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }\nconst updateSellerInDatabase = async ({\n  seller,\n  name,\n  gsmNumber,\n  iban,\n  address,\n  logoPath\n}) => {\n  const {\n    subMerchantType,\n    subMerchantKey,\n    email,\n    legalCompanyTitle,\n    taxOffice,\n    taxNumber,\n    identityNumber\n  } = seller;\n  if (!subMerchantType) {\n    throw new _ApiError.default(\"Merchant type not found\", 400, \"missingSubMerchantType\");\n  }\n\n  // gsmNumber kontrolü\n  if (gsmNumber) {\n    const existingSeller = await _seller.default.findOne({\n      gsmNumber\n    });\n    if (existingSeller && existingSeller._id.toString() !== seller._id.toString()) {\n      throw new _ApiError.default(\"This phone number is already in use\", 400, \"phoneNumberAlreadyUsing\");\n    }\n  }\n\n  // Güncellenecek alanlar\n  const updateFields = {\n    ...(name && {\n      name\n    }),\n    ...(gsmNumber && {\n      gsmNumber\n    }),\n    ...(iban && {\n      iban\n    }),\n    ...(address && {\n      address\n    }),\n    subMerchantKey,\n    email,\n    legalCompanyTitle,\n    taxNumber,\n    taxOffice,\n    identityNumber\n  };\n  if (logoPath) {\n    updateFields.logo = logoPath;\n  }\n\n  // İyzico API çağrısı: Şirket tipine göre uygun method\n  let iyzicoResponse;\n  let updateSeller = null;\n  if (subMerchantType === \"PRIVATE_COMPANY\") {\n    iyzicoResponse = await (0, _submerchant.updatePrivateSubMerchant)(updateFields);\n  } else if (subMerchantType === \"LIMITED_OR_JOINT_STOCK_COMPANY\") {\n    iyzicoResponse = await (0, _submerchant.updateLimitedOrJointSubMerchant)(updateFields);\n  } else {\n    throw new _ApiError.default(\"Invalid company type\", 400, \"invalidCompanyType\");\n  }\n\n  // Yerel veritabanında satıcıyı güncelle\n  if (iyzicoResponse.status === \"success\") {\n    const updateSeller = await _seller.default.findByIdAndUpdate(seller._id, updateFields, {\n      new: true\n    });\n    if (!updateSeller) {\n      throw new _ApiError.default(\"Seller not found\", 400, \"notFoundSeller\");\n    }\n  } else {\n    console.log(\"iyzico tarafında success olmadığı için veritabanında güncelleme olmamıştır.\");\n  }\n  return {\n    updateSeller,\n    iyzicoResponse\n  };\n};\nexports.updateSellerInDatabase = updateSellerInDatabase;\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfc2VsbGVyIiwiX2ludGVyb3BSZXF1aXJlRGVmYXVsdCIsInJlcXVpcmUiLCJfQXBpRXJyb3IiLCJfc3VibWVyY2hhbnQiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJ1cGRhdGVTZWxsZXJJbkRhdGFiYXNlIiwic2VsbGVyIiwibmFtZSIsImdzbU51bWJlciIsImliYW4iLCJhZGRyZXNzIiwibG9nb1BhdGgiLCJzdWJNZXJjaGFudFR5cGUiLCJzdWJNZXJjaGFudEtleSIsImVtYWlsIiwibGVnYWxDb21wYW55VGl0bGUiLCJ0YXhPZmZpY2UiLCJ0YXhOdW1iZXIiLCJpZGVudGl0eU51bWJlciIsIkFwaUVycm9yIiwiZXhpc3RpbmdTZWxsZXIiLCJTZWxsZXIiLCJmaW5kT25lIiwiX2lkIiwidG9TdHJpbmciLCJ1cGRhdGVGaWVsZHMiLCJsb2dvIiwiaXl6aWNvUmVzcG9uc2UiLCJ1cGRhdGVTZWxsZXIiLCJ1cGRhdGVQcml2YXRlU3ViTWVyY2hhbnQiLCJ1cGRhdGVMaW1pdGVkT3JKb2ludFN1Yk1lcmNoYW50Iiwic3RhdHVzIiwiZmluZEJ5SWRBbmRVcGRhdGUiLCJuZXciLCJjb25zb2xlIiwibG9nIiwiZXhwb3J0cyJdLCJzb3VyY2VSb290IjoiL1VzZXJzL2F0ay9EZXNrdG9wL0FQUC9Ob2RlSlMvWmV5ZGFsX0JhY2tlbmRfRGV2ZWxvcG1lbnQvc3JjL3JlcG9zaXRvcmllcy8iLCJzb3VyY2VzIjpbInNlbGxlcl9yZXBvc2l0b3J5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBTZWxsZXIgZnJvbSBcIi4uL2RiL3NlbGxlclwiO1xuaW1wb3J0IEFwaUVycm9yIGZyb20gXCIuLi9lcnJvcnMvQXBpRXJyb3JcIjtcbmltcG9ydCB7XG4gIHVwZGF0ZUxpbWl0ZWRPckpvaW50U3ViTWVyY2hhbnQsXG4gIHVwZGF0ZVByaXZhdGVTdWJNZXJjaGFudCxcbn0gZnJvbSBcIi4uL3NlcnZpY2VzL2l5emljby9tZXRob2RzL3N1Ym1lcmNoYW50XCI7XG5cbmV4cG9ydCBjb25zdCB1cGRhdGVTZWxsZXJJbkRhdGFiYXNlID0gYXN5bmMgKHtcbiAgc2VsbGVyLFxuICBuYW1lLFxuICBnc21OdW1iZXIsXG4gIGliYW4sXG4gIGFkZHJlc3MsXG4gIGxvZ29QYXRoLFxufSkgPT4ge1xuICBjb25zdCB7XG4gICAgc3ViTWVyY2hhbnRUeXBlLFxuICAgIHN1Yk1lcmNoYW50S2V5LFxuICAgIGVtYWlsLFxuICAgIGxlZ2FsQ29tcGFueVRpdGxlLFxuICAgIHRheE9mZmljZSxcbiAgICB0YXhOdW1iZXIsXG4gICAgaWRlbnRpdHlOdW1iZXIsXG4gIH0gPSBzZWxsZXI7XG5cbiAgaWYgKCFzdWJNZXJjaGFudFR5cGUpIHtcbiAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICBcIk1lcmNoYW50IHR5cGUgbm90IGZvdW5kXCIsXG4gICAgICA0MDAsXG4gICAgICBcIm1pc3NpbmdTdWJNZXJjaGFudFR5cGVcIlxuICAgICk7XG4gIH1cblxuICAvLyBnc21OdW1iZXIga29udHJvbMO8XG4gIGlmIChnc21OdW1iZXIpIHtcbiAgICBjb25zdCBleGlzdGluZ1NlbGxlciA9IGF3YWl0IFNlbGxlci5maW5kT25lKHsgZ3NtTnVtYmVyIH0pO1xuICAgIGlmIChcbiAgICAgIGV4aXN0aW5nU2VsbGVyICYmXG4gICAgICBleGlzdGluZ1NlbGxlci5faWQudG9TdHJpbmcoKSAhPT0gc2VsbGVyLl9pZC50b1N0cmluZygpXG4gICAgKSB7XG4gICAgICB0aHJvdyBuZXcgQXBpRXJyb3IoXG4gICAgICAgIFwiVGhpcyBwaG9uZSBudW1iZXIgaXMgYWxyZWFkeSBpbiB1c2VcIixcbiAgICAgICAgNDAwLFxuICAgICAgICBcInBob25lTnVtYmVyQWxyZWFkeVVzaW5nXCJcbiAgICAgICk7XG4gICAgfVxuICB9XG5cbiAgLy8gR8O8bmNlbGxlbmVjZWsgYWxhbmxhclxuICBjb25zdCB1cGRhdGVGaWVsZHMgPSB7XG4gICAgLi4uKG5hbWUgJiYgeyBuYW1lIH0pLFxuICAgIC4uLihnc21OdW1iZXIgJiYgeyBnc21OdW1iZXIgfSksXG4gICAgLi4uKGliYW4gJiYgeyBpYmFuIH0pLFxuICAgIC4uLihhZGRyZXNzICYmIHsgYWRkcmVzcyB9KSxcbiAgICBzdWJNZXJjaGFudEtleSxcbiAgICBlbWFpbCxcbiAgICBsZWdhbENvbXBhbnlUaXRsZSxcbiAgICB0YXhOdW1iZXIsXG4gICAgdGF4T2ZmaWNlLFxuICAgIGlkZW50aXR5TnVtYmVyLFxuICB9O1xuXG4gIGlmIChsb2dvUGF0aCkge1xuICAgIHVwZGF0ZUZpZWxkcy5sb2dvID0gbG9nb1BhdGg7XG4gIH1cblxuICAvLyDEsHl6aWNvIEFQSSDDp2HEn3LEsXPEsTogxZ5pcmtldCB0aXBpbmUgZ8O2cmUgdXlndW4gbWV0aG9kXG4gIGxldCBpeXppY29SZXNwb25zZTtcbiAgbGV0IHVwZGF0ZVNlbGxlciA9IG51bGw7XG5cbiAgaWYgKHN1Yk1lcmNoYW50VHlwZSA9PT0gXCJQUklWQVRFX0NPTVBBTllcIikge1xuICAgIGl5emljb1Jlc3BvbnNlID0gYXdhaXQgdXBkYXRlUHJpdmF0ZVN1Yk1lcmNoYW50KHVwZGF0ZUZpZWxkcyk7XG4gIH0gZWxzZSBpZiAoc3ViTWVyY2hhbnRUeXBlID09PSBcIkxJTUlURURfT1JfSk9JTlRfU1RPQ0tfQ09NUEFOWVwiKSB7XG4gICAgaXl6aWNvUmVzcG9uc2UgPSBhd2FpdCB1cGRhdGVMaW1pdGVkT3JKb2ludFN1Yk1lcmNoYW50KHVwZGF0ZUZpZWxkcyk7XG4gIH0gZWxzZSB7XG4gICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiSW52YWxpZCBjb21wYW55IHR5cGVcIiwgNDAwLCBcImludmFsaWRDb21wYW55VHlwZVwiKTtcbiAgfVxuXG4gIC8vIFllcmVsIHZlcml0YWJhbsSxbmRhIHNhdMSxY8SxecSxIGfDvG5jZWxsZVxuICBpZiAoaXl6aWNvUmVzcG9uc2Uuc3RhdHVzID09PSBcInN1Y2Nlc3NcIikge1xuICAgIGNvbnN0IHVwZGF0ZVNlbGxlciA9IGF3YWl0IFNlbGxlci5maW5kQnlJZEFuZFVwZGF0ZShcbiAgICAgIHNlbGxlci5faWQsXG4gICAgICB1cGRhdGVGaWVsZHMsXG4gICAgICB7IG5ldzogdHJ1ZSB9XG4gICAgKTtcbiAgICBpZiAoIXVwZGF0ZVNlbGxlcikge1xuICAgICAgdGhyb3cgbmV3IEFwaUVycm9yKFwiU2VsbGVyIG5vdCBmb3VuZFwiLCA0MDAsIFwibm90Rm91bmRTZWxsZXJcIik7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIGNvbnNvbGUubG9nKFxuICAgICAgXCJpeXppY28gdGFyYWbEsW5kYSBzdWNjZXNzIG9sbWFkxLHEn8SxIGnDp2luIHZlcml0YWJhbsSxbmRhIGfDvG5jZWxsZW1lIG9sbWFtxLHFn3TEsXIuXCJcbiAgICApO1xuICB9XG5cbiAgcmV0dXJuIHsgdXBkYXRlU2VsbGVyLCBpeXppY29SZXNwb25zZSB9O1xufTtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUEsSUFBQUEsT0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsU0FBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUUsWUFBQSxHQUFBRixPQUFBO0FBR2dELFNBQUFELHVCQUFBSSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBRXpDLE1BQU1HLHNCQUFzQixHQUFHLE1BQUFBLENBQU87RUFDM0NDLE1BQU07RUFDTkMsSUFBSTtFQUNKQyxTQUFTO0VBQ1RDLElBQUk7RUFDSkMsT0FBTztFQUNQQztBQUNGLENBQUMsS0FBSztFQUNKLE1BQU07SUFDSkMsZUFBZTtJQUNmQyxjQUFjO0lBQ2RDLEtBQUs7SUFDTEMsaUJBQWlCO0lBQ2pCQyxTQUFTO0lBQ1RDLFNBQVM7SUFDVEM7RUFDRixDQUFDLEdBQUdaLE1BQU07RUFFVixJQUFJLENBQUNNLGVBQWUsRUFBRTtJQUNwQixNQUFNLElBQUlPLGlCQUFRLENBQ2hCLHlCQUF5QixFQUN6QixHQUFHLEVBQ0gsd0JBQ0YsQ0FBQztFQUNIOztFQUVBO0VBQ0EsSUFBSVgsU0FBUyxFQUFFO0lBQ2IsTUFBTVksY0FBYyxHQUFHLE1BQU1DLGVBQU0sQ0FBQ0MsT0FBTyxDQUFDO01BQUVkO0lBQVUsQ0FBQyxDQUFDO0lBQzFELElBQ0VZLGNBQWMsSUFDZEEsY0FBYyxDQUFDRyxHQUFHLENBQUNDLFFBQVEsQ0FBQyxDQUFDLEtBQUtsQixNQUFNLENBQUNpQixHQUFHLENBQUNDLFFBQVEsQ0FBQyxDQUFDLEVBQ3ZEO01BQ0EsTUFBTSxJQUFJTCxpQkFBUSxDQUNoQixxQ0FBcUMsRUFDckMsR0FBRyxFQUNILHlCQUNGLENBQUM7SUFDSDtFQUNGOztFQUVBO0VBQ0EsTUFBTU0sWUFBWSxHQUFHO0lBQ25CLElBQUlsQixJQUFJLElBQUk7TUFBRUE7SUFBSyxDQUFDLENBQUM7SUFDckIsSUFBSUMsU0FBUyxJQUFJO01BQUVBO0lBQVUsQ0FBQyxDQUFDO0lBQy9CLElBQUlDLElBQUksSUFBSTtNQUFFQTtJQUFLLENBQUMsQ0FBQztJQUNyQixJQUFJQyxPQUFPLElBQUk7TUFBRUE7SUFBUSxDQUFDLENBQUM7SUFDM0JHLGNBQWM7SUFDZEMsS0FBSztJQUNMQyxpQkFBaUI7SUFDakJFLFNBQVM7SUFDVEQsU0FBUztJQUNURTtFQUNGLENBQUM7RUFFRCxJQUFJUCxRQUFRLEVBQUU7SUFDWmMsWUFBWSxDQUFDQyxJQUFJLEdBQUdmLFFBQVE7RUFDOUI7O0VBRUE7RUFDQSxJQUFJZ0IsY0FBYztFQUNsQixJQUFJQyxZQUFZLEdBQUcsSUFBSTtFQUV2QixJQUFJaEIsZUFBZSxLQUFLLGlCQUFpQixFQUFFO0lBQ3pDZSxjQUFjLEdBQUcsTUFBTSxJQUFBRSxxQ0FBd0IsRUFBQ0osWUFBWSxDQUFDO0VBQy9ELENBQUMsTUFBTSxJQUFJYixlQUFlLEtBQUssZ0NBQWdDLEVBQUU7SUFDL0RlLGNBQWMsR0FBRyxNQUFNLElBQUFHLDRDQUErQixFQUFDTCxZQUFZLENBQUM7RUFDdEUsQ0FBQyxNQUFNO0lBQ0wsTUFBTSxJQUFJTixpQkFBUSxDQUFDLHNCQUFzQixFQUFFLEdBQUcsRUFBRSxvQkFBb0IsQ0FBQztFQUN2RTs7RUFFQTtFQUNBLElBQUlRLGNBQWMsQ0FBQ0ksTUFBTSxLQUFLLFNBQVMsRUFBRTtJQUN2QyxNQUFNSCxZQUFZLEdBQUcsTUFBTVAsZUFBTSxDQUFDVyxpQkFBaUIsQ0FDakQxQixNQUFNLENBQUNpQixHQUFHLEVBQ1ZFLFlBQVksRUFDWjtNQUFFUSxHQUFHLEVBQUU7SUFBSyxDQUNkLENBQUM7SUFDRCxJQUFJLENBQUNMLFlBQVksRUFBRTtNQUNqQixNQUFNLElBQUlULGlCQUFRLENBQUMsa0JBQWtCLEVBQUUsR0FBRyxFQUFFLGdCQUFnQixDQUFDO0lBQy9EO0VBQ0YsQ0FBQyxNQUFNO0lBQ0xlLE9BQU8sQ0FBQ0MsR0FBRyxDQUNULDZFQUNGLENBQUM7RUFDSDtFQUVBLE9BQU87SUFBRVAsWUFBWTtJQUFFRDtFQUFlLENBQUM7QUFDekMsQ0FBQztBQUFDUyxPQUFBLENBQUEvQixzQkFBQSxHQUFBQSxzQkFBQSIsImlnbm9yZUxpc3QiOltdfQ==","map":{"version":3,"names":["_seller","_interopRequireDefault","require","_ApiError","_submerchant","e","__esModule","default","updateSellerInDatabase","seller","name","gsmNumber","iban","address","logoPath","subMerchantType","subMerchantKey","email","legalCompanyTitle","taxOffice","taxNumber","identityNumber","ApiError","existingSeller","Seller","findOne","_id","toString","updateFields","logo","iyzicoResponse","updateSeller","updatePrivateSubMerchant","updateLimitedOrJointSubMerchant","status","findByIdAndUpdate","new","console","log","exports"],"sourceRoot":"/Users/atk/Desktop/APP/NodeJS/Zeydal_Backend_Development/src/repositories/","sources":["seller_repository.js"],"sourcesContent":["import Seller from \"../db/seller\";\nimport ApiError from \"../errors/ApiError\";\nimport {\n  updateLimitedOrJointSubMerchant,\n  updatePrivateSubMerchant,\n} from \"../services/iyzico/methods/submerchant\";\n\nexport const updateSellerInDatabase = async ({\n  seller,\n  name,\n  gsmNumber,\n  iban,\n  address,\n  logoPath,\n}) => {\n  const {\n    subMerchantType,\n    subMerchantKey,\n    email,\n    legalCompanyTitle,\n    taxOffice,\n    taxNumber,\n    identityNumber,\n  } = seller;\n\n  if (!subMerchantType) {\n    throw new ApiError(\n      \"Merchant type not found\",\n      400,\n      \"missingSubMerchantType\"\n    );\n  }\n\n  // gsmNumber kontrolü\n  if (gsmNumber) {\n    const existingSeller = await Seller.findOne({ gsmNumber });\n    if (\n      existingSeller &&\n      existingSeller._id.toString() !== seller._id.toString()\n    ) {\n      throw new ApiError(\n        \"This phone number is already in use\",\n        400,\n        \"phoneNumberAlreadyUsing\"\n      );\n    }\n  }\n\n  // Güncellenecek alanlar\n  const updateFields = {\n    ...(name && { name }),\n    ...(gsmNumber && { gsmNumber }),\n    ...(iban && { iban }),\n    ...(address && { address }),\n    subMerchantKey,\n    email,\n    legalCompanyTitle,\n    taxNumber,\n    taxOffice,\n    identityNumber,\n  };\n\n  if (logoPath) {\n    updateFields.logo = logoPath;\n  }\n\n  // İyzico API çağrısı: Şirket tipine göre uygun method\n  let iyzicoResponse;\n  let updateSeller = null;\n\n  if (subMerchantType === \"PRIVATE_COMPANY\") {\n    iyzicoResponse = await updatePrivateSubMerchant(updateFields);\n  } else if (subMerchantType === \"LIMITED_OR_JOINT_STOCK_COMPANY\") {\n    iyzicoResponse = await updateLimitedOrJointSubMerchant(updateFields);\n  } else {\n    throw new ApiError(\"Invalid company type\", 400, \"invalidCompanyType\");\n  }\n\n  // Yerel veritabanında satıcıyı güncelle\n  if (iyzicoResponse.status === \"success\") {\n    const updateSeller = await Seller.findByIdAndUpdate(\n      seller._id,\n      updateFields,\n      { new: true }\n    );\n    if (!updateSeller) {\n      throw new ApiError(\"Seller not found\", 400, \"notFoundSeller\");\n    }\n  } else {\n    console.log(\n      \"iyzico tarafında success olmadığı için veritabanında güncelleme olmamıştır.\"\n    );\n  }\n\n  return { updateSeller, iyzicoResponse };\n};\n"],"mappings":";;;;;;AAAA,IAAAA,OAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,SAAA,GAAAF,sBAAA,CAAAC,OAAA;AACA,IAAAE,YAAA,GAAAF,OAAA;AAGgD,SAAAD,uBAAAI,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEzC,MAAMG,sBAAsB,GAAG,MAAAA,CAAO;EAC3CC,MAAM;EACNC,IAAI;EACJC,SAAS;EACTC,IAAI;EACJC,OAAO;EACPC;AACF,CAAC,KAAK;EACJ,MAAM;IACJC,eAAe;IACfC,cAAc;IACdC,KAAK;IACLC,iBAAiB;IACjBC,SAAS;IACTC,SAAS;IACTC;EACF,CAAC,GAAGZ,MAAM;EAEV,IAAI,CAACM,eAAe,EAAE;IACpB,MAAM,IAAIO,iBAAQ,CAChB,yBAAyB,EACzB,GAAG,EACH,wBACF,CAAC;EACH;;EAEA;EACA,IAAIX,SAAS,EAAE;IACb,MAAMY,cAAc,GAAG,MAAMC,eAAM,CAACC,OAAO,CAAC;MAAEd;IAAU,CAAC,CAAC;IAC1D,IACEY,cAAc,IACdA,cAAc,CAACG,GAAG,CAACC,QAAQ,CAAC,CAAC,KAAKlB,MAAM,CAACiB,GAAG,CAACC,QAAQ,CAAC,CAAC,EACvD;MACA,MAAM,IAAIL,iBAAQ,CAChB,qCAAqC,EACrC,GAAG,EACH,yBACF,CAAC;IACH;EACF;;EAEA;EACA,MAAMM,YAAY,GAAG;IACnB,IAAIlB,IAAI,IAAI;MAAEA;IAAK,CAAC,CAAC;IACrB,IAAIC,SAAS,IAAI;MAAEA;IAAU,CAAC,CAAC;IAC/B,IAAIC,IAAI,IAAI;MAAEA;IAAK,CAAC,CAAC;IACrB,IAAIC,OAAO,IAAI;MAAEA;IAAQ,CAAC,CAAC;IAC3BG,cAAc;IACdC,KAAK;IACLC,iBAAiB;IACjBE,SAAS;IACTD,SAAS;IACTE;EACF,CAAC;EAED,IAAIP,QAAQ,EAAE;IACZc,YAAY,CAACC,IAAI,GAAGf,QAAQ;EAC9B;;EAEA;EACA,IAAIgB,cAAc;EAClB,IAAIC,YAAY,GAAG,IAAI;EAEvB,IAAIhB,eAAe,KAAK,iBAAiB,EAAE;IACzCe,cAAc,GAAG,MAAM,IAAAE,qCAAwB,EAACJ,YAAY,CAAC;EAC/D,CAAC,MAAM,IAAIb,eAAe,KAAK,gCAAgC,EAAE;IAC/De,cAAc,GAAG,MAAM,IAAAG,4CAA+B,EAACL,YAAY,CAAC;EACtE,CAAC,MAAM;IACL,MAAM,IAAIN,iBAAQ,CAAC,sBAAsB,EAAE,GAAG,EAAE,oBAAoB,CAAC;EACvE;;EAEA;EACA,IAAIQ,cAAc,CAACI,MAAM,KAAK,SAAS,EAAE;IACvC,MAAMH,YAAY,GAAG,MAAMP,eAAM,CAACW,iBAAiB,CACjD1B,MAAM,CAACiB,GAAG,EACVE,YAAY,EACZ;MAAEQ,GAAG,EAAE;IAAK,CACd,CAAC;IACD,IAAI,CAACL,YAAY,EAAE;MACjB,MAAM,IAAIT,iBAAQ,CAAC,kBAAkB,EAAE,GAAG,EAAE,gBAAgB,CAAC;IAC/D;EACF,CAAC,MAAM;IACLe,OAAO,CAACC,GAAG,CACT,6EACF,CAAC;EACH;EAEA,OAAO;IAAEP,YAAY;IAAED;EAAe,CAAC;AACzC,CAAC;AAACS,OAAA,CAAA/B,sBAAA,GAAAA,sBAAA","ignoreList":[]}},"mtime":1735643162424}}